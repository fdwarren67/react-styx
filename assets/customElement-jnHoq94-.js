const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/time-zones-Ddu0PvRY.js","assets/index-p4VH55K1-e5RoWDws.js","assets/index-DFrluMIY.js","assets/index-mL0evDQ4.js","assets/region-BWroGId0.js","assets/index-g4YtFzIU.js"])))=>i.map(i=>d[i]);
import{e as M,f as g,k as V,n as $,x as y,i as k,j as U,_ as f,S as A}from"./index-5Uv45sI4.js";import{n as N}from"./ref-DqiYxcul.js";import{c as B}from"./repeat-DNu6ss-q.js";import{i as G}from"./keyed-Dd7AOvr1.js";import{v as W,T as j}from"./label-BznrxY5W.js";import{m as q,p as Q}from"./interactive-BKbZm5P7.js";import{m as H}from"./component-Dxbaltlt.js";import{D as J,O as K,W as X,B as Y}from"./form-DXrdUm2C.js";import{s as ee}from"./useT9n-Cwowg6_C.js";import{Q as te}from"./locale-s9NCZ3Zl.js";import"./dom-DJEv2Q-P.js";import"./guid-BDWAkmkV.js";import"./logger-CuHV5ymd.js";import"./key-ak3_eHKH.js";/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.1.0 */const ae={offset:"offset"},ie=60;function x(a){return a.replace(":15",".25").replace(":30",".5").replace(":45",".75").replace("âˆ’","-")}function oe(a,e){const t=w(a,"en-US",e).replace("GMT","");return t===""?0:Number(x(t))*ie}function se(){return new Date().getTimezoneOffset()*-1}function ne(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}async function le(a){if(a==="offset")return t=>t;const{normalize:e}=await f(async()=>{const{normalize:t}=await import("./time-zones-Ddu0PvRY.js");return{normalize:t}},__vite__mapDeps([0,1]));return e}async function re(a,e,t,i,l){if(t==="name"){const{groupByName:n}=await f(async()=>{const{groupByName:o}=await import("./index-DFrluMIY.js");return{groupByName:o}},__vite__mapDeps([2,0,1]));return(await n()).map(({label:o})=>({label:o,value:o,metadata:{filterValue:o}})).filter(o=>!!o).sort()}const u=l==="user"?a:l==="utc"?"fr":"en-GB",d=i.getTime();if(t==="region"){const[{groupByRegion:n},{getCountry:o,global:m}]=await Promise.all([f(()=>import("./index-mL0evDQ4.js"),__vite__mapDeps([3,0,1,4])),f(()=>import("./region-BWroGId0.js"),__vite__mapDeps([4,1]))]);return(await n()).map(({label:s,tzs:c})=>(c.sort((r,h)=>{const T=I(r,e),C=I(h,e),p="Etc/GMT";if(r.startsWith(p)&&h.startsWith(p)){const b=r.substring(p.length),P=h.substring(p.length),F=b===""?0:parseInt(b);return(P===""?0:parseInt(P))-F}return T.localeCompare(C)}),{label:_(e,s),items:c.map(r=>{const h=x(w(r,u,d)),T=I(r,e),C=s===m?`${I(m,e)} Etc`:L(r),p=o(r),b=_(e,p);return{label:T,value:r,metadata:{country:b===T?void 0:b,filterValue:C,offset:h}}})})).sort((s,c)=>s.label===m?-1:c.label===m?1:s.label.localeCompare(c.label))}const[{groupByOffset:Z},{DateEngine:R}]=await Promise.all([f(()=>import("./index-g4YtFzIU.js"),__vite__mapDeps([5,0,1,4])),f(()=>import("./index-Bx95W_6e.js"),[])]),E=await Z({dateEngine:new R,groupDateRange:1,startDate:new Date(d).toISOString()}),S=new Intl.ListFormat(a,{style:"long",type:"conjunction"}),D=["Factory","Etc/UTC"];return E.forEach(n=>{const o=[];let m=0;n.tzs.forEach((s,c)=>{D.includes(s)&&m++,o[c]=m}),n.tzs=n.tzs.filter(s=>!D.includes(s)),n.labelTzIdx=n.labelTzIdx.map(s=>s-o[s]).filter(s=>s>=0&&s<n.tzs.length)}),E.map(({labelTzIdx:n,tzs:o})=>{const m=o[0],s=x(w(m,u,d)),c=oe(m,d),r=n.map(h=>I(o[h],e));return{label:he(e,s,S.format(r)),value:c,metadata:{filterValue:o.map(h=>L(h))}}}).filter(n=>!!n).sort((n,o)=>n.value-o.value)}function I(a,e){return e[a]||ce(a)}function me(a,e,t){return t.timeZoneRegionLabel.replace("{city}",a).replace("{country}",_(t,e))}function _(a,e){return a[e]||e}function ce(a){return a.split("/").pop()}function L(a){return a.replace(/_/g," ")}function he(a,e,t){return a.timeZoneLabel.replace("{offset}",e).replace("{cities}",t)}function w(a,e,t=Date.now()){return a==="Factory"&&(a="Etc/GMT"),te(e,{timeZone:a,timeZoneName:"shortOffset"}).formatToParts(t).find(({type:i})=>i==="timeZoneName").value}function de(a){return a.items!==void 0}function ue(a){return de(a[0])?a.flatMap(e=>e.items):a}function z(a,e,t){return t==null?null:ue(a).find(i=>i[e]==t)}const pe=U`:host([disabled]){cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-opacity-disabled)}:host([disabled]) *,:host([disabled]) ::slotted(*){pointer-events:none}:host{display:block}.offset{white-space:nowrap}:host([hidden]){display:none}[hidden]{display:none}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}.interaction-container{display:contents}::slotted(input[slot=hidden-form-input]){margin:0!important;opacity:0!important;outline:none!important;padding:0!important;position:absolute!important;inset:0!important;transform:none!important;-webkit-appearance:none!important;z-index:-1!important}`,v=class v extends M{constructor(){super(...arguments),this.clearable=!1,this.disabled=!1,this.maxItems=0,this.messages=ee({blocking:!0}),this.mode="offset",this.offsetStyle="user",this.open=!1,this.overlayPositioning="absolute",this.readOnly=!1,this.required=!1,this.scale="m",this.status="idle",this.validity={valid:!1,badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1},this.calciteInputTimeZoneBeforeClose=g({cancelable:!1}),this.calciteInputTimeZoneBeforeOpen=g({cancelable:!1}),this.calciteInputTimeZoneChange=g({cancelable:!1}),this.calciteInputTimeZoneClose=g({cancelable:!1}),this.calciteInputTimeZoneOpen=g({cancelable:!1})}get value(){return this._value}set value(e){this._value=e}async setFocus(){await H(this),await this.comboboxEl.setFocus()}connectedCallback(){super.connectedCallback(),J(this),W(this)}async load(){this.normalizer=await le(this.mode),await this.updateTimeZoneItems();const e=this.value,t=this.normalizeValue(e);this.value=t||(e===""?t:void 0),this.updateTimeZoneSelection();const i=this.selectedTimeZoneItem?`${this.selectedTimeZoneItem.value}`:"";K(this,i),this.value=i}willUpdate(e){e.has("value")&&this.hasUpdated&&this.handleValueChange(this.value,e.get("value")),(e.has("messages")||e.has("mode")&&(this.hasUpdated||this.mode!=="offset")||e.has("referenceDate"))&&this.handleTimeZoneItemPropsChange(),e.has("open")&&(this.hasUpdated||this.open!==!1)&&this.openChanged()}updated(){q(this)}loaded(){this.overrideSelectedLabelForRegion(this.open),this.openChanged()}disconnectedCallback(){super.disconnectedCallback(),X(this),j(this)}async handleTimeZoneItemPropsChange(){!this.timeZoneItems||!this.hasUpdated||(await this.updateTimeZoneItems(),this.updateTimeZoneSelection())}openChanged(){this.comboboxEl&&(this.comboboxEl.open=this.open)}async handleValueChange(e,t){const i=this.normalizeValue(e);if(!i){if(this.clearable){this._value=i,this.selectedTimeZoneItem=null;return}this._value=t,this.selectedTimeZoneItem=this.findTimeZoneItem(t);return}const l=this.findTimeZoneItem(i);if(!l){this._value=t;return}this._value=i,this.selectedTimeZoneItem=l,i!==e&&(await this.updateComplete,this.overrideSelectedLabelForRegion(this.open))}onLabelClick(){this.setFocus()}setComboboxRef(e){this.comboboxEl=e}overrideSelectedLabelForRegion(e){if(this.mode!=="region"||!this.selectedTimeZoneItem)return;const{label:t,metadata:i}=this.selectedTimeZoneItem;this.comboboxEl.selectedItems[0].textLabel=!i.country||e?t:me(t,i.country,this.messages)}onComboboxBeforeClose(e){e.stopPropagation(),this.overrideSelectedLabelForRegion(!1),this.calciteInputTimeZoneBeforeClose.emit()}onComboboxBeforeOpen(e){e.stopPropagation(),this.overrideSelectedLabelForRegion(!0),this.calciteInputTimeZoneBeforeOpen.emit()}onComboboxChange(e){e.stopPropagation();const t=e.target.selectedItems[0];if(!t){this._value="",this.selectedTimeZoneItem=null,this.calciteInputTimeZoneChange.emit();return}const i=this.findTimeZoneItemByLabel(t.getAttribute("data-label")),l=`${i.value}`;this.value===l&&i.label===this.selectedTimeZoneItem.label||(this._value=l,this.selectedTimeZoneItem=i,this.calciteInputTimeZoneChange.emit())}onComboboxClose(e){e.stopPropagation(),this.open=!1,this.calciteInputTimeZoneClose.emit()}onComboboxOpen(e){this.open=!0,e.stopPropagation(),this.calciteInputTimeZoneOpen.emit()}findTimeZoneItem(e){return z(this.timeZoneItems,"value",e)}findTimeZoneItemByLabel(e){return z(this.timeZoneItems,"label",e)}async updateTimeZoneItems(){this.timeZoneItems=await this.createTimeZoneItems()}updateTimeZoneSelection(){if(this.value===""&&this.clearable){this.selectedTimeZoneItem=null;return}const e=this.mode==="offset"?se():ne(),t=this.value===""||!this.value?e:this.value;this.selectedTimeZoneItem=this.findTimeZoneItem(t)||this.findTimeZoneItem(e)}async createTimeZoneItems(){return!this.messages._lang||!this.messages?[]:re(this.messages._lang,this.messages,this.mode,this.referenceDate instanceof Date?this.referenceDate:new Date(this.referenceDate??Date.now()),this.offsetStyle)}normalizeValue(e){return e=e===void 0?"":e,e&&this.normalizer(e)}render(){return Q({disabled:this.disabled,children:y`<calcite-combobox .clearDisabled=${!this.clearable} .disabled=${this.disabled} .label=${this.messages.chooseTimeZone} lang=${this.messages._lang??$} .maxItems=${this.maxItems} @calciteComboboxBeforeClose=${this.onComboboxBeforeClose} @calciteComboboxBeforeOpen=${this.onComboboxBeforeOpen} @calciteComboboxChange=${this.onComboboxChange} @calciteComboboxClose=${this.onComboboxClose} @calciteComboboxOpen=${this.onComboboxOpen} .overlayPositioning=${this.overlayPositioning} .placeholder=${this.mode==="name"?this.messages.namePlaceholder:this.mode==="offset"?this.messages.offsetPlaceholder:this.messages.regionPlaceholder} placeholder-icon=search .readOnly=${this.readOnly} .scale=${this.scale} .selectionMode=${this.clearable?"single":"single-persist"} .status=${this.status} .validationIcon=${this.validationIcon} .validationMessage=${this.validationMessage} ${N(this.setComboboxRef)}>${this.renderItems()}</calcite-combobox>${Y({component:this})}`})}renderItems(){return this.mode==="region"?this.renderRegionItems():B(this.timeZoneItems,({label:e})=>e,e=>{const t=this.selectedTimeZoneItem===e,{label:i,metadata:l,value:u}=e;return y`<calcite-combobox-item data-label=${i??$} .metadata=${l} .selected=${t} .textLabel=${i} .value=${u}></calcite-combobox-item>`})}renderRegionItems(){return this.timeZoneItems.flatMap(({label:e,items:t})=>G(e,y`<calcite-combobox-item-group .label=${e}>${B(t,({label:i})=>i,i=>{const l=this.selectedTimeZoneItem===i,{label:u,metadata:d,value:Z}=i;return y`<calcite-combobox-item data-label=${u??$} .description=${d.country} .metadata=${d} .selected=${l} .textLabel=${u} .value=${Z}><span class=${k(ae.offset)} slot=content-end>${d.offset}</span></calcite-combobox-item>`})}</calcite-combobox-item-group>`))}};v.properties={clearable:7,disabled:7,form:3,maxItems:11,messageOverrides:0,mode:3,name:3,offsetStyle:3,open:7,overlayPositioning:3,readOnly:7,referenceDate:1,required:7,scale:3,status:3,validationIcon:[3,{converter:V}],validationMessage:1,validity:0,value:1},v.shadowRootOptions={mode:"open",delegatesFocus:!0},v.styles=pe;let O=v;A("calcite-input-time-zone",O);export{O as InputTimeZone};
