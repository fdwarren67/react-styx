const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/IdentityManager-DpB67qwJ.js","assets/substitute-Ha_AMd4t.js","assets/pe-wasm-Co3DzcyP.js","assets/_commonjsHelpers-DCkdB7M8.js","assets/WhereClauseCache-COsvhKay.js","assets/WhereClause-DkrydB0a.js","assets/TimeOnly-BBieZGV_.js","assets/arcadeUtils-BbybX28j.js","assets/arcade-D3-YN0hH.js","assets/unitConversion-Dz5oTiaW.js","assets/ImmutableArray-BPVd6ESQ.js","assets/shared-90NgXidA.js","assets/number-Dcxfl-Vi.js","assets/featureConversionUtils-9uqthz89.js","assets/OptimizedFeature-BaGJiUPG.js","assets/memoryEstimations-DjQAVVIt.js","assets/OptimizedFeatureSet-Blu9Ckm7.js","assets/ElevationLayer-D7OJeUVI.js","assets/ArcGISCachedService-BFo7SvLu.js","assets/TileInfoTilemapCache-CcPcWhe6.js","assets/TilemapCache-CD9f74IT.js","assets/ByteSizeUnit-BsxeN7wM.js","assets/WorkerHandle-CvE_2JLs.js","assets/webStyleSymbolUtils-dlSXqXJ_.js","assets/devEnvironmentUtils-CnNDiFMM.js","assets/webStyleAcceptedFormats-CG7ZQ6BV.js","assets/portalLayers-B-VUsDwp.js","assets/associatedFeatureServiceUtils-vdHMGZdf.js","assets/fetchService-xmpz7qtB.js","assets/loadUtils-CTFM5lL1.js","assets/lazyLayerLoader-CoJ5ORCO.js","assets/arcgisLayers-CFljMN4J.js","assets/statsWorker-Bot70LcP.js","assets/utils-DiloKDvx.js","assets/quantizationUtils-DjygVgdr.js","assets/utils-BpTzWUfO.js","assets/utils-KyhmT9ei.js","assets/ClassBreaksDefinition-B6T7kxoL.js","assets/geometryEngineWorker-CA-tZxOm.js","assets/geometryEngineJSON-Bvf5zUh7.js","assets/geometryEngineBase-B0ZyeKAX.js","assets/json-Wa8cmqdu.js","assets/CSVSourceWorker-5OYCfj1m.js","assets/date-Ctp1FiBW.js","assets/executeQueryForSnapping-CuCkOqaX.js","assets/queryUtils-DnrHBOJE.js","assets/QueryEngine-Dm30zzUI.js","assets/timeSupport-D48tvLp_.js","assets/QueryEngineCapabilities-B_pTbIiR.js","assets/SnappingCandidate-DGkpYqI6.js","assets/FixedIntervalBinParameters-CDWurxEO.js","assets/FeatureStore-p_hPc6Li.js","assets/BoundsStore-3M1N2vdu.js","assets/PooledRBush-CpfSLtBb.js","assets/optimizedFeatureQueryEngineAdapter-BJUHfZwL.js","assets/clientSideDefaults-DOp2-Zx2.js","assets/EdgeProcessingWorker-CxUe3CDB.js","assets/workerHelper-pJhHaGvW.js","assets/InterleavedLayout-DpJOx6iL.js","assets/BufferView-CbSE4D9I.js","assets/types-D0PSWh4d.js","assets/edgeProcessing-Dcqo5PmX.js","assets/deduplicate-DmEYbXIY.js","assets/Indices-D3r8dB4N.js","assets/VertexAttribute-Cq4MnHjR.js","assets/glUtil-BRsh-eDO.js","assets/VertexElementDescriptor-BLyltQyJ.js","assets/Normals-0ETes4Qp.js","assets/ElevationSamplerWorker-Wg5ER-8c.js","assets/MeshLocalVertexSpace-DgK43vZA.js","assets/vertexSpaceConversion-DEtDr1dE.js","assets/mat3f64-q3fE-ZOt.js","assets/mat4f64-Dk4dwAN8.js","assets/spatialReferenceEllipsoidUtils-BkXVqBJw.js","assets/computeTranslationToOriginAndRotation-Bbvn0XWt.js","assets/projectPointToVector-BYRPP7er.js","assets/meshVertexSpaceUtils-D_km3sEg.js","assets/vec3-iAinBP56.js","assets/vec4-xkXYFXVM.js","assets/FeatureServiceSnappingSourceWorker-DXcayeQH.js","assets/symbologySnappingCandidates-B8-O8vyi.js","assets/pbfQueryUtils-DexIpoqM.js","assets/pbf-D1fxcXwN.js","assets/query-e6gQ6su2.js","assets/GeoJSONSourceWorker-iA62Vnw-.js","assets/geojson-5F_PgWAc.js","assets/sourceUtils-BaGdBhDF.js","assets/MemorySourceWorker-B9spVyMG.js","assets/objectIdUtils-4dd1rf9p.js","assets/PBFDecoderWorker-DlFQG2QU.js","assets/dehydratedFeatures-BmvRfaaI.js","assets/FeaturePipelineWorker-yg_aETey.js","assets/AttributeStore-D2t7nLYb.js","assets/Utils-BpNJYV3c.js","assets/UpdateTracking2D-r6w-8RU7.js","assets/BidiEngine-QXap_35O.js","assets/GeometryUtils-s3hHCpKg.js","assets/rasterizingUtils-D5qeIAk-.js","assets/floatRGBA-DV28AZMY.js","assets/Rect-CUzevAry.js","assets/streamLayerUtils-CKwt2uXH.js","assets/MeshWriterRegistry-BI2xAnNJ.js","assets/TechniqueType-uMFRS8dR.js","assets/PieChartMeshWriter-CtRFanDs.js","assets/TurboLine-BGkEOL6m.js","assets/utils-gzSyT1C6.js","assets/earcut-D9gy186-.js","assets/grouping-eEy_Q6F-.js","assets/QueueProcessor-iTAW5oVl.js","assets/operatorGeodeticDensify-DnFJpqvM.js","assets/geodeticCurveType-CirnHLSB.js","assets/normalizeUtilsSync-B1UKnH3i.js","assets/ogcFeatureUtils-BrFacu2H.js","assets/parquet-ChiV5wWO.js","assets/CircularArray-CujHzHWW.js","assets/createConnection-DG5PNy99.js","assets/PointCloudWorker-CyFZ9WDp.js","assets/quat-CuPUV5vH.js","assets/quatf64-aQ5IuZRd.js","assets/vec3f32-nZdmKIgz.js","assets/PointCloudUniqueValueRenderer-BWInVgzm.js","assets/I3SBinaryReader-Di2_KeTL.js","assets/orientedBoundingBox-BgmqSY0B.js","assets/plane-BYWDLMMQ.js","assets/RasterWorker-B5QJBw3D.js","assets/dataUtils-BH6RUDp7.js","assets/RasterSymbolizer-CCrtP_Cg.js","assets/colorUtils-DTSMSziH.js","assets/rasterFunctionHelper-B6LD9J7P.js","assets/rasterProjectionHelper-DCExB7v9.js","assets/PolynomialTransform-o8oUBiad.js","assets/SceneLayerSnappingSourceWorker-p_9uzbEP.js","assets/lineSegment-BZ9EZfhN.js","assets/sphere-j9I49-VW.js","assets/Octree-BmuM5Grr.js","assets/SceneLayerWorker-BqoqeTTV.js","assets/projectVectorToVector-CsbWrWYf.js","assets/I3SUtil-BB8wkhLR.js","assets/edgeUtils-YpcNGumC.js","assets/NormalAttribute.glsl-DLmKZOdI.js","assets/glsl-BH37Aalp.js","assets/ShaderOutput-DnYY5J1_.js","assets/BindType-BBwFZqyN.js","assets/WFSSourceWorker-BqgH2uB7.js","assets/wfsUtils-BW8rVqZL.js","assets/xmlUtils-CtUoQO7q.js","assets/WorkerTileHandler-C0NHhH7s.js","assets/enums-BRzLM11V.js","assets/config-BOD8--da.js","assets/StyleDefinition-B0742vx-.js","assets/SourceLayerData-DkifLFUI.js","assets/StyleRepository-CSCdKNS1.js","assets/Feature3DPipelineWorker-CFK5R_Vx.js","assets/HUDMaterial.glsl-DOb2Qlst.js","assets/Geometry-C2ufuNdB.js","assets/renderState-DlFbn4Ki.js","assets/basicInterfaces-CZwQPxTp.js","assets/boundedPlane-aM0NiYyQ.js","assets/requestImageUtils-5nqP_N6O.js","assets/TextureFormat-1mYWTFa-.js","assets/triangle-Dg0xSv4f.js","assets/HUDMaterial-Dc8LqWsq.js","assets/VertexArrayObject-DxUN4vEu.js","assets/dehydratedFeatureUtils-D0zGZjm_.js","assets/doublePrecisionUtils-B0owpBza.js","assets/hydratedFeatures-U6D26k2G.js","assets/ShaderBuilder-CPoXfokl.js","assets/IntersectorInterfaces-CmNINbyF.js","assets/DefaultMaterial-nhOL_wcX.js","assets/LodResources-DWVYO8th.js","assets/TextureCompressionWorker-DdNw54I_.js","assets/Popup-Cj_jW6aW.js","assets/unitFormatUtils-C6EJqS6C.js","assets/quantityUtils-BK7XlIag.js","assets/AttachmentInfo-_NCUyj1r.js","assets/featureUtils-sTpFvq4B.js","assets/utils-B6Z_utWc.js","assets/cimSymbolUtils-BTTTpfen.js","assets/executeQueryJSON-ApTS-w_m.js","assets/NetworkElement--AiA6aP5.js","assets/ReactiveSet-BolVXuFQ.js","assets/layerViewUtils-B0kOYXog.js","assets/layersCreator-jvB-7Yhr.js","assets/geometryServiceUtils-F-KSGsY-.js","assets/project-BUJVRGxe.js","assets/webglDeps-BX2hQHdt.js","assets/FramebufferObject-Dk39BZ5e.js","assets/ProgramTemplate-DR4sA5bY.js","assets/NestedMap-GuqgquCN.js","assets/mapViewDeps-B8Sv5yJ7.js","assets/FeatureCommandQueue-BSkvAlgQ.js","assets/GraphShaderModule-H3HMgvoc.js","assets/WGLContainer-ClsbWyjY.js","assets/Container-U8LexM-O.js","assets/SDFHelper-DmM2H_ca.js","assets/OverrideHelper-BZUnkwZ3.js","assets/GridShader-CCuxd_2F.js","assets/testSVGPremultipliedAlpha-upl34B-i.js","assets/RenderingContext-D6cd-OXC.js","assets/CIMResourceManager-BKQZhkNj.js","assets/utils-Ck3Dfbes.js","assets/VertexStream-BH8akTIB.js","assets/utils-ehcGqGxa.js","assets/GraphicsView2D-BLNnsu-s.js","assets/GraphicContainer--nBBxV7E.js","assets/AGraphicContainer-CfrpyX9X.js","assets/TechniqueInstance-D0uiQ9Um.js","assets/TileContainer-CqHxH8Q3.js","assets/gridUtils-DijYXUuw.js","assets/TileLayerView2D-BxGm8bHx.js","assets/imageUtils-DzEzKwEN.js","assets/BitmapTechnique-COcRckpP.js","assets/LayerView-SH3gyaJp.js","assets/HighlightGraphicContainer-COYPGFXk.js","assets/RefreshableLayerView-BmgW1bGN.js","assets/MapServiceLayerViewHelper-xdp3VECe.js","assets/floorFilterUtils-DZ5C6FQv.js","assets/drapedUtils-QisFCYJC.js","assets/sublayerUtils-EvP7aJLS.js","assets/popupUtils-wVVu1cg2.js","assets/FeatureLayerView2D-CfEplTLd.js","assets/timeSupport-CweISOl9.js","assets/AttributeBinsFeatureSet-uAJp-9Zg.js","assets/AttributeBinsQuery-BiuNQ2A0.js","assets/constants-B4mRqufT.js","assets/BaseDynamicLayerView2D-CYXEpEWM.js","assets/BitmapContainer-CHM630n7.js","assets/ExportStrategy-Cl7_7dph.js","assets/CatalogLayerView2D-DCSCu9eM.js","assets/CatalogDynamicGroupLayerView2D-BPe3gET7.js","assets/CatalogFootprintLayerView2D-BuQriAiO.js","assets/GeoRSSLayerView2D-CRO-MX_X.js","assets/GraphicsLayerView2D-D1ho31HK.js","assets/GroupLayerView2D-BahE_3fb.js","assets/ImageryLayerView2D-oMWw0PLx.js","assets/RasterVFDisplayObject-BP8TpwLA.js","assets/ImageryTileLayerView2D-DqGx-3ZA.js","assets/rasterFieldUtils-CB_WJDk1.js","assets/rasterUtils-CgbRtJ11.js","assets/RawBlockCache-C_ctmySQ.js","assets/KMLLayerView2D-DTGtfYJt.js","assets/kmlUtils-CQzQB0du.js","assets/KnowledgeGraphLayerView2D-BG3iVlX0.js","assets/MapImageLayerView2D-C-AptPTT.js","assets/ExportImageParameters-DH5O44kV.js","assets/MapNotesLayerView2D-Bw8DJ6hY.js","assets/MediaLayerView2D-BSwb8WEm.js","assets/mediaLayerUtils-DQeBg9ip.js","assets/OverlayContainer-CeflGJmT.js","assets/OGCFeatureLayerView2D-D82TqbPM.js","assets/RouteLayerView2D-CIqMvkVy.js","assets/Stop-g2JjhMOv.js","assets/networkEnums-Cey3tj3Q.js","assets/StreamLayerView2D-BvAbnBmE.js","assets/SubtypeGroupLayerView2D-BIWR-RgE.js","assets/VectorTileLayerView2D-BzWQqGmd.js","assets/VideoLayerView2D-Cmqt-Bc1.js","assets/TelemetryDisplay-C8fSOWvF.js","assets/WMSLayerView2D-oaZeh1hD.js","assets/ExportWMSImageParameters-BPUSQVkj.js","assets/WMTSLayerView2D-DU7T3HEv.js","assets/apng-B0YKKZ4U.js","assets/index-APTdSFoz.js","assets/index-ByThslJp.js","assets/guid-BDWAkmkV.js","assets/useT9n-Cwowg6_C.js","assets/index-B2mHmePf.js","assets/dom-DJEv2Q-P.js","assets/observers-CKvzzITU.js","assets/logger-CuHV5ymd.js","assets/customElement-DtaX0itU.js","assets/ref-DqiYxcul.js","assets/static-CprjLi9A.js","assets/form-DXrdUm2C.js","assets/interactive-BKbZm5P7.js","assets/label-BznrxY5W.js","assets/component-Dxbaltlt.js","assets/layersLoader-Bcl2Dpj-.js","assets/jsonContext-4QGD55mS.js","assets/featureLayerUtils-CztLS3i_.js","assets/originUtils-D69mHv66.js","assets/multiOriginJSONSupportUtils-C0wm8_Yw.js","assets/utils-WOJnci6d.js","assets/saveUtils-Cm_VEsdB.js","assets/FeatureLayerSource-CCk7ZwTi.js","assets/External-DH839mxB.js","assets/MeshTransform-rDTZ9CqM.js","assets/axisAngleDegrees-BO2rbGyb.js","assets/editingSupport-DtprcNhQ.js","assets/QueryTask-5BI1o_c5.js","assets/executeForIds-D3GkNrSM.js","assets/customElement-CgMorMaW.js","assets/customElement-BlWHRNLK.js","assets/keyed-Dd7AOvr1.js","assets/customElement-DTGpm0km.js","assets/customElement-DFHwCj0R.js","assets/ExpandToggle-AMWWDxtj.js","assets/resources7-BlIPMGGt.js","assets/resources2-C0GO_l0j.js","assets/debounce-DbkufipY.js","assets/customElement-D0n3wHTl.js","assets/customElement-CCHfs5Wg.js","assets/array-CItZ4bXf.js","assets/key-ak3_eHKH.js","assets/customElement-fn84Utza.js","assets/customElement-CCBjuIro.js","assets/locale-s9NCZ3Zl.js","assets/openCloseComponent-CXfE4Mb2.js","assets/resources4-CS_NtZ-4.js","assets/customElement-Ch3aFRkR.js","assets/repeat-DNu6ss-q.js","assets/floating-ui-DK3Xyc5X.js","assets/floating-ui.utils.dom-BUW1h90u.js","assets/Validation-DOPF2XYi.js","assets/escapeRegExp-CdLjXKbf.js","assets/customElement-CLpT4TXO.js","assets/text-C_Biu-k6.js","assets/customElement-Bq0XUq7G.js","assets/utils4-IIbCIJHB.js","assets/global-BPDJypNs.js","assets/customElement-DS5IEYjY.js","assets/Heading-C4QZw2W0.js","assets/customElement-Z3P_BTgj.js","assets/sortableComponent-DcctxQH5.js","assets/customElement-BCpjNOYM.js","assets/customElement-BSaSTrDW.js","assets/customElement-CZeGza0-.js","assets/customElement-CMKyTXd3.js","assets/responsive-BwNbrFTK.js","assets/customElement-B2YV5XZJ.js","assets/customElement-ziTCZoCg.js","assets/customElement-D-go6cM5.js","assets/customElement-DReingST.js","assets/customElement-Dz3sAqBP.js","assets/math-xemqatnM.js","assets/throttle-CQXZGPS6.js","assets/customElement-Cs2qK68d.js","assets/customElement-C68BrKiC.js","assets/customElement-C2ylg09N.js","assets/live-DL9x-QLl.js","assets/core-Cxbbqyjy.js","assets/filter-l9EctlAf.js","assets/utils3-DAq5_fs0.js","assets/customElement-D9M48WYW.js","assets/customElement-D3JpAJB7.js","assets/customElement-BtBX9xi2.js","assets/date-vPLQ79tU.js","assets/utils2-CtF2ROfq.js","assets/customElement-axAlP8Gu.js","assets/customElement-Dvy_dOqm.js","assets/customElement-DYPMtHd7.js","assets/customElement-D6RJx0Zk.js","assets/interact.min-iNRM8XgC.js","assets/dynamicClasses-Dlk4kLaw.js","assets/resources3-DRKYpY8O.js","assets/useFocusTrap-DYgZ-yqo.js","assets/index-CDuxeKTe.js","assets/index-Cjtbbwve.js","assets/resources6-C-XXGpuo.js","assets/customElement-B4s55E5r.js","assets/customElement-BQNSROUc.js","assets/customElement-DSJabRxZ.js","assets/index-Bwspjnwr.js","assets/customElement-CtS-sP_r.js","assets/customElement-DBUVFmrV.js","assets/customElement-CtHuQL5w.js","assets/customElement-oIUM3g5A.js","assets/customElement-ePn5nvF1.js","assets/input-Ceuqybnm.js","assets/customElement-V0T1ZYeW.js","assets/customElement-DdyJSEpv.js","assets/customElement-B5WUgAYJ.js","assets/customElement-BWfvbLf3.js","assets/customElement-DLZMJKtD.js","assets/time-DBz8t9a5.js","assets/customElement-jnHoq94-.js","assets/index-C1Er7W-g.js","assets/customElement-CrSwFn5r.js","assets/customElement-ByX6J9uM.js","assets/utils-B19IB7gH.js","assets/resources-DodJkxAw.js","assets/customElement-TXWxc97e.js","assets/resources5-B_fF8ZZV.js","assets/index-DnkLIP2d.js","assets/customElement-DnueI8Ae.js","assets/customElement-NiXo7aHg.js","assets/customElement-DO0vbq6D.js","assets/customElement-CDMoLhq3.js","assets/customElement-CQSH61c2.js","assets/customElement-_jqU-XOl.js","assets/customElement-WSB341dj.js","assets/customElement-C9saBoPe.js","assets/customElement-Q82Jcscn.js","assets/customElement-CfEAJuFv.js","assets/customElement-H6Q5okC-.js","assets/customElement-CwS5qx96.js","assets/FloatingArrow-DDYZkwNl.js","assets/customElement-Bmh7Su2J.js","assets/customElement-vJ0c-PAu.js","assets/customElement-K-uCxDfa.js","assets/customElement-D_YMIMSA.js","assets/customElement-C-VQTuUh.js","assets/customElement-CtMz5cpf.js","assets/customElement-C5HyMSUN.js","assets/customElement-_FojWzL8.js","assets/customElement-CLtKaUYM.js","assets/customElement-CWQbrT2Q.js","assets/customElement-IhT3zrHU.js","assets/customElement-ClGqISpx.js","assets/customElement-hVt-bkMR.js","assets/customElement-Bzi6rZRj.js","assets/customElement-DV5JjLQP.js","assets/customElement-BjMhP9i8.js","assets/customElement-BElpJGpk.js","assets/customElement-Bdd4oJzt.js","assets/customElement-i1dmsapE.js","assets/customElement-FCL_5RS0.js","assets/customElement-CNRkeZ0k.js","assets/customElement-CrNd-Yv6.js","assets/customElement-CHnS_JmU.js","assets/customElement-H4SmhlzG.js","assets/customElement-DkZweSwJ.js","assets/customElement-BAtnbfY7.js","assets/customElement-Bz7c1FX_.js","assets/customElement-0zaPMBoq.js","assets/customElement-uP6lCP8q.js","assets/customElement-Dwg1FIJ5.js","assets/customElement-DV9CMoYo.js","assets/customElement-BksUVrNH.js","assets/customElement-CMA_pTJq.js","assets/customElement-B43FRdz6.js","assets/customElement-7yDP6OB-.js","assets/customElement-DvDjJfXC.js","assets/customElement-CcKhteDh.js","assets/index-XfTTzDdH.js","assets/customElement-CQsBGuAz.js","assets/customElement-8uMsXBhx.js"])))=>i.map(i=>d[i]);
var HSe=Object.defineProperty;var jSe=(t,e,i)=>e in t?HSe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var Lt=(t,e,i)=>jSe(t,typeof e!="symbol"?e+"":e,i);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function i(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=i(n);fetch(n.href,r)}})();function YSe(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function XSe(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var i=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};i.prototype=e.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var n=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(i,s,n.get?n:{enumerable:!0,get:function(){return t[s]}})}),i}var H$={exports:{}},b2={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VZ;function WSe(){if(VZ)return b2;VZ=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function i(s,n,r){var o=null;if(r!==void 0&&(o=""+r),n.key!==void 0&&(o=""+n.key),"key"in n){r={};for(var a in n)a!=="key"&&(r[a]=n[a])}else r=n;return n=r.ref,{$$typeof:t,type:s,key:o,ref:n!==void 0?n:null,props:r}}return b2.Fragment=e,b2.jsx=i,b2.jsxs=i,b2}var zZ;function ZSe(){return zZ||(zZ=1,H$.exports=WSe()),H$.exports}var ri=ZSe(),j$={exports:{}},w2={},Y$={exports:{}},X$={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GZ;function KSe(){return GZ||(GZ=1,function(t){function e(Y,W){var ee=Y.length;Y.push(W);e:for(;0<ee;){var ne=ee-1>>>1,j=Y[ne];if(0<n(j,W))Y[ne]=W,Y[ee]=j,ee=ne;else break e}}function i(Y){return Y.length===0?null:Y[0]}function s(Y){if(Y.length===0)return null;var W=Y[0],ee=Y.pop();if(ee!==W){Y[0]=ee;e:for(var ne=0,j=Y.length,oe=j>>>1;ne<oe;){var ve=2*(ne+1)-1,Ye=Y[ve],de=ve+1,fe=Y[de];if(0>n(Ye,ee))de<j&&0>n(fe,Ye)?(Y[ne]=fe,Y[de]=ee,ne=de):(Y[ne]=Ye,Y[ve]=ee,ne=ve);else if(de<j&&0>n(fe,ee))Y[ne]=fe,Y[de]=ee,ne=de;else break e}}return W}function n(Y,W){var ee=Y.sortIndex-W.sortIndex;return ee!==0?ee:Y.id-W.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var r=performance;t.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,h=null,d=3,m=!1,f=!1,_=!1,v=!1,x=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function C(Y){for(var W=i(u);W!==null;){if(W.callback===null)s(u);else if(W.startTime<=Y)s(u),W.sortIndex=W.expirationTime,e(l,W);else break;W=i(u)}}function M(Y){if(_=!1,C(Y),!f)if(i(l)!==null)f=!0,A||(A=!0,$());else{var W=i(u);W!==null&&H(M,W.startTime-Y)}}var A=!1,I=-1,L=5,D=-1;function O(){return v?!0:!(t.unstable_now()-D<L)}function U(){if(v=!1,A){var Y=t.unstable_now();D=Y;var W=!0;try{e:{f=!1,_&&(_=!1,w(I),I=-1),m=!0;var ee=d;try{t:{for(C(Y),h=i(l);h!==null&&!(h.expirationTime>Y&&O());){var ne=h.callback;if(typeof ne=="function"){h.callback=null,d=h.priorityLevel;var j=ne(h.expirationTime<=Y);if(Y=t.unstable_now(),typeof j=="function"){h.callback=j,C(Y),W=!0;break t}h===i(l)&&s(l),C(Y)}else s(l);h=i(l)}if(h!==null)W=!0;else{var oe=i(u);oe!==null&&H(M,oe.startTime-Y),W=!1}}break e}finally{h=null,d=ee,m=!1}W=void 0}}finally{W?$():A=!1}}}var $;if(typeof T=="function")$=function(){T(U)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,V=B.port2;B.port1.onmessage=U,$=function(){V.postMessage(null)}}else $=function(){x(U,0)};function H(Y,W){I=x(function(){Y(t.unstable_now())},W)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Y){Y.callback=null},t.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<Y?Math.floor(1e3/Y):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_next=function(Y){switch(d){case 1:case 2:case 3:var W=3;break;default:W=d}var ee=d;d=W;try{return Y()}finally{d=ee}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(Y,W){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var ee=d;d=Y;try{return W()}finally{d=ee}},t.unstable_scheduleCallback=function(Y,W,ee){var ne=t.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?ne+ee:ne):ee=ne,Y){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=ee+j,Y={id:c++,callback:W,priorityLevel:Y,startTime:ee,expirationTime:j,sortIndex:-1},ee>ne?(Y.sortIndex=ee,e(u,Y),i(l)===null&&Y===i(u)&&(_?(w(I),I=-1):_=!0,H(M,ee-ne))):(Y.sortIndex=j,e(l,Y),f||m||(f=!0,A||(A=!0,$()))),Y},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(Y){var W=d;return function(){var ee=d;d=W;try{return Y.apply(this,arguments)}finally{d=ee}}}}(X$)),X$}var BZ;function QSe(){return BZ||(BZ=1,Y$.exports=KSe()),Y$.exports}var W$={exports:{}},us={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qZ;function JSe(){if(qZ)return us;qZ=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),r=Symbol.for("react.consumer"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),c=Symbol.for("react.lazy"),h=Symbol.iterator;function d(j){return j===null||typeof j!="object"?null:(j=h&&j[h]||j["@@iterator"],typeof j=="function"?j:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f=Object.assign,_={};function v(j,oe,ve){this.props=j,this.context=oe,this.refs=_,this.updater=ve||m}v.prototype.isReactComponent={},v.prototype.setState=function(j,oe){if(typeof j!="object"&&typeof j!="function"&&j!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,j,oe,"setState")},v.prototype.forceUpdate=function(j){this.updater.enqueueForceUpdate(this,j,"forceUpdate")};function x(){}x.prototype=v.prototype;function w(j,oe,ve){this.props=j,this.context=oe,this.refs=_,this.updater=ve||m}var T=w.prototype=new x;T.constructor=w,f(T,v.prototype),T.isPureReactComponent=!0;var C=Array.isArray,M={H:null,A:null,T:null,S:null,V:null},A=Object.prototype.hasOwnProperty;function I(j,oe,ve,Ye,de,fe){return ve=fe.ref,{$$typeof:t,type:j,key:oe,ref:ve!==void 0?ve:null,props:fe}}function L(j,oe){return I(j.type,oe,void 0,void 0,void 0,j.props)}function D(j){return typeof j=="object"&&j!==null&&j.$$typeof===t}function O(j){var oe={"=":"=0",":":"=2"};return"$"+j.replace(/[=:]/g,function(ve){return oe[ve]})}var U=/\/+/g;function $(j,oe){return typeof j=="object"&&j!==null&&j.key!=null?O(""+j.key):oe.toString(36)}function B(){}function V(j){switch(j.status){case"fulfilled":return j.value;case"rejected":throw j.reason;default:switch(typeof j.status=="string"?j.then(B,B):(j.status="pending",j.then(function(oe){j.status==="pending"&&(j.status="fulfilled",j.value=oe)},function(oe){j.status==="pending"&&(j.status="rejected",j.reason=oe)})),j.status){case"fulfilled":return j.value;case"rejected":throw j.reason}}throw j}function H(j,oe,ve,Ye,de){var fe=typeof j;(fe==="undefined"||fe==="boolean")&&(j=null);var Ne=!1;if(j===null)Ne=!0;else switch(fe){case"bigint":case"string":case"number":Ne=!0;break;case"object":switch(j.$$typeof){case t:case e:Ne=!0;break;case c:return Ne=j._init,H(Ne(j._payload),oe,ve,Ye,de)}}if(Ne)return de=de(j),Ne=Ye===""?"."+$(j,0):Ye,C(de)?(ve="",Ne!=null&&(ve=Ne.replace(U,"$&/")+"/"),H(de,oe,ve,"",function(Zt){return Zt})):de!=null&&(D(de)&&(de=L(de,ve+(de.key==null||j&&j.key===de.key?"":(""+de.key).replace(U,"$&/")+"/")+Ne)),oe.push(de)),1;Ne=0;var je=Ye===""?".":Ye+":";if(C(j))for(var Ee=0;Ee<j.length;Ee++)Ye=j[Ee],fe=je+$(Ye,Ee),Ne+=H(Ye,oe,ve,fe,de);else if(Ee=d(j),typeof Ee=="function")for(j=Ee.call(j),Ee=0;!(Ye=j.next()).done;)Ye=Ye.value,fe=je+$(Ye,Ee++),Ne+=H(Ye,oe,ve,fe,de);else if(fe==="object"){if(typeof j.then=="function")return H(V(j),oe,ve,Ye,de);throw oe=String(j),Error("Objects are not valid as a React child (found: "+(oe==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":oe)+"). If you meant to render a collection of children, use an array instead.")}return Ne}function Y(j,oe,ve){if(j==null)return j;var Ye=[],de=0;return H(j,Ye,"","",function(fe){return oe.call(ve,fe,de++)}),Ye}function W(j){if(j._status===-1){var oe=j._result;oe=oe(),oe.then(function(ve){(j._status===0||j._status===-1)&&(j._status=1,j._result=ve)},function(ve){(j._status===0||j._status===-1)&&(j._status=2,j._result=ve)}),j._status===-1&&(j._status=0,j._result=oe)}if(j._status===1)return j._result.default;throw j._result}var ee=typeof reportError=="function"?reportError:function(j){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var oe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof j=="object"&&j!==null&&typeof j.message=="string"?String(j.message):String(j),error:j});if(!window.dispatchEvent(oe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",j);return}console.error(j)};function ne(){}return us.Children={map:Y,forEach:function(j,oe,ve){Y(j,function(){oe.apply(this,arguments)},ve)},count:function(j){var oe=0;return Y(j,function(){oe++}),oe},toArray:function(j){return Y(j,function(oe){return oe})||[]},only:function(j){if(!D(j))throw Error("React.Children.only expected to receive a single React element child.");return j}},us.Component=v,us.Fragment=i,us.Profiler=n,us.PureComponent=w,us.StrictMode=s,us.Suspense=l,us.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=M,us.__COMPILER_RUNTIME={__proto__:null,c:function(j){return M.H.useMemoCache(j)}},us.cache=function(j){return function(){return j.apply(null,arguments)}},us.cloneElement=function(j,oe,ve){if(j==null)throw Error("The argument must be a React element, but you passed "+j+".");var Ye=f({},j.props),de=j.key,fe=void 0;if(oe!=null)for(Ne in oe.ref!==void 0&&(fe=void 0),oe.key!==void 0&&(de=""+oe.key),oe)!A.call(oe,Ne)||Ne==="key"||Ne==="__self"||Ne==="__source"||Ne==="ref"&&oe.ref===void 0||(Ye[Ne]=oe[Ne]);var Ne=arguments.length-2;if(Ne===1)Ye.children=ve;else if(1<Ne){for(var je=Array(Ne),Ee=0;Ee<Ne;Ee++)je[Ee]=arguments[Ee+2];Ye.children=je}return I(j.type,de,void 0,void 0,fe,Ye)},us.createContext=function(j){return j={$$typeof:o,_currentValue:j,_currentValue2:j,_threadCount:0,Provider:null,Consumer:null},j.Provider=j,j.Consumer={$$typeof:r,_context:j},j},us.createElement=function(j,oe,ve){var Ye,de={},fe=null;if(oe!=null)for(Ye in oe.key!==void 0&&(fe=""+oe.key),oe)A.call(oe,Ye)&&Ye!=="key"&&Ye!=="__self"&&Ye!=="__source"&&(de[Ye]=oe[Ye]);var Ne=arguments.length-2;if(Ne===1)de.children=ve;else if(1<Ne){for(var je=Array(Ne),Ee=0;Ee<Ne;Ee++)je[Ee]=arguments[Ee+2];de.children=je}if(j&&j.defaultProps)for(Ye in Ne=j.defaultProps,Ne)de[Ye]===void 0&&(de[Ye]=Ne[Ye]);return I(j,fe,void 0,void 0,null,de)},us.createRef=function(){return{current:null}},us.forwardRef=function(j){return{$$typeof:a,render:j}},us.isValidElement=D,us.lazy=function(j){return{$$typeof:c,_payload:{_status:-1,_result:j},_init:W}},us.memo=function(j,oe){return{$$typeof:u,type:j,compare:oe===void 0?null:oe}},us.startTransition=function(j){var oe=M.T,ve={};M.T=ve;try{var Ye=j(),de=M.S;de!==null&&de(ve,Ye),typeof Ye=="object"&&Ye!==null&&typeof Ye.then=="function"&&Ye.then(ne,ee)}catch(fe){ee(fe)}finally{M.T=oe}},us.unstable_useCacheRefresh=function(){return M.H.useCacheRefresh()},us.use=function(j){return M.H.use(j)},us.useActionState=function(j,oe,ve){return M.H.useActionState(j,oe,ve)},us.useCallback=function(j,oe){return M.H.useCallback(j,oe)},us.useContext=function(j){return M.H.useContext(j)},us.useDebugValue=function(){},us.useDeferredValue=function(j,oe){return M.H.useDeferredValue(j,oe)},us.useEffect=function(j,oe,ve){var Ye=M.H;if(typeof ve=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Ye.useEffect(j,oe)},us.useId=function(){return M.H.useId()},us.useImperativeHandle=function(j,oe,ve){return M.H.useImperativeHandle(j,oe,ve)},us.useInsertionEffect=function(j,oe){return M.H.useInsertionEffect(j,oe)},us.useLayoutEffect=function(j,oe){return M.H.useLayoutEffect(j,oe)},us.useMemo=function(j,oe){return M.H.useMemo(j,oe)},us.useOptimistic=function(j,oe){return M.H.useOptimistic(j,oe)},us.useReducer=function(j,oe,ve){return M.H.useReducer(j,oe,ve)},us.useRef=function(j){return M.H.useRef(j)},us.useState=function(j){return M.H.useState(j)},us.useSyncExternalStore=function(j,oe,ve){return M.H.useSyncExternalStore(j,oe,ve)},us.useTransition=function(){return M.H.useTransition()},us.version="19.1.0",us}var HZ;function NM(){return HZ||(HZ=1,W$.exports=JSe()),W$.exports}var Z$={exports:{}},Ua={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jZ;function eEe(){if(jZ)return Ua;jZ=1;var t=NM();function e(l){var u="https://react.dev/errors/"+l;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)u+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var s={d:{f:i,r:function(){throw Error(e(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},n=Symbol.for("react.portal");function r(l,u,c){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:h==null?null:""+h,children:l,containerInfo:u,implementation:c}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function a(l,u){if(l==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return Ua.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,Ua.createPortal=function(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(e(299));return r(l,u,null,c)},Ua.flushSync=function(l){var u=o.T,c=s.p;try{if(o.T=null,s.p=2,l)return l()}finally{o.T=u,s.p=c,s.d.f()}},Ua.preconnect=function(l,u){typeof l=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,s.d.C(l,u))},Ua.prefetchDNS=function(l){typeof l=="string"&&s.d.D(l)},Ua.preinit=function(l,u){if(typeof l=="string"&&u&&typeof u.as=="string"){var c=u.as,h=a(c,u.crossOrigin),d=typeof u.integrity=="string"?u.integrity:void 0,m=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;c==="style"?s.d.S(l,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:h,integrity:d,fetchPriority:m}):c==="script"&&s.d.X(l,{crossOrigin:h,integrity:d,fetchPriority:m,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},Ua.preinitModule=function(l,u){if(typeof l=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var c=a(u.as,u.crossOrigin);s.d.M(l,{crossOrigin:c,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&s.d.M(l)},Ua.preload=function(l,u){if(typeof l=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var c=u.as,h=a(c,u.crossOrigin);s.d.L(l,c,{crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},Ua.preloadModule=function(l,u){if(typeof l=="string")if(u){var c=a(u.as,u.crossOrigin);s.d.m(l,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:c,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else s.d.m(l)},Ua.requestFormReset=function(l){s.d.r(l)},Ua.unstable_batchedUpdates=function(l,u){return l(u)},Ua.useFormState=function(l,u,c){return o.H.useFormState(l,u,c)},Ua.useFormStatus=function(){return o.H.useHostTransitionStatus()},Ua.version="19.1.0",Ua}var YZ;function dF(){if(YZ)return Z$.exports;YZ=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Z$.exports=eEe(),Z$.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XZ;function tEe(){if(XZ)return w2;XZ=1;var t=QSe(),e=NM(),i=dF();function s(p){var g="https://react.dev/errors/"+p;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var b=2;b<arguments.length;b++)g+="&args[]="+encodeURIComponent(arguments[b])}return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(p){return!(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)}function r(p){var g=p,b=p;if(p.alternate)for(;g.return;)g=g.return;else{p=g;do g=p,(g.flags&4098)!==0&&(b=g.return),p=g.return;while(p)}return g.tag===3?b:null}function o(p){if(p.tag===13){var g=p.memoizedState;if(g===null&&(p=p.alternate,p!==null&&(g=p.memoizedState)),g!==null)return g.dehydrated}return null}function a(p){if(r(p)!==p)throw Error(s(188))}function l(p){var g=p.alternate;if(!g){if(g=r(p),g===null)throw Error(s(188));return g!==p?null:p}for(var b=p,P=g;;){var R=b.return;if(R===null)break;var k=R.alternate;if(k===null){if(P=R.return,P!==null){b=P;continue}break}if(R.child===k.child){for(k=R.child;k;){if(k===b)return a(R),p;if(k===P)return a(R),g;k=k.sibling}throw Error(s(188))}if(b.return!==P.return)b=R,P=k;else{for(var Z=!1,ie=R.child;ie;){if(ie===b){Z=!0,b=R,P=k;break}if(ie===P){Z=!0,P=R,b=k;break}ie=ie.sibling}if(!Z){for(ie=k.child;ie;){if(ie===b){Z=!0,b=k,P=R;break}if(ie===P){Z=!0,P=k,b=R;break}ie=ie.sibling}if(!Z)throw Error(s(189))}}if(b.alternate!==P)throw Error(s(190))}if(b.tag!==3)throw Error(s(188));return b.stateNode.current===b?p:g}function u(p){var g=p.tag;if(g===5||g===26||g===27||g===6)return p;for(p=p.child;p!==null;){if(g=u(p),g!==null)return g;p=p.sibling}return null}var c=Object.assign,h=Symbol.for("react.element"),d=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),f=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),w=Symbol.for("react.consumer"),T=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),L=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),U=Symbol.iterator;function $(p){return p===null||typeof p!="object"?null:(p=U&&p[U]||p["@@iterator"],typeof p=="function"?p:null)}var B=Symbol.for("react.client.reference");function V(p){if(p==null)return null;if(typeof p=="function")return p.$$typeof===B?null:p.displayName||p.name||null;if(typeof p=="string")return p;switch(p){case f:return"Fragment";case v:return"Profiler";case _:return"StrictMode";case M:return"Suspense";case A:return"SuspenseList";case D:return"Activity"}if(typeof p=="object")switch(p.$$typeof){case m:return"Portal";case T:return(p.displayName||"Context")+".Provider";case w:return(p._context.displayName||"Context")+".Consumer";case C:var g=p.render;return p=p.displayName,p||(p=g.displayName||g.name||"",p=p!==""?"ForwardRef("+p+")":"ForwardRef"),p;case I:return g=p.displayName||null,g!==null?g:V(p.type)||"Memo";case L:g=p._payload,p=p._init;try{return V(p(g))}catch{}}return null}var H=Array.isArray,Y=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee={pending:!1,data:null,method:null,action:null},ne=[],j=-1;function oe(p){return{current:p}}function ve(p){0>j||(p.current=ne[j],ne[j]=null,j--)}function Ye(p,g){j++,ne[j]=p.current,p.current=g}var de=oe(null),fe=oe(null),Ne=oe(null),je=oe(null);function Ee(p,g){switch(Ye(Ne,g),Ye(fe,p),Ye(de,null),g.nodeType){case 9:case 11:p=(p=g.documentElement)&&(p=p.namespaceURI)?pZ(p):0;break;default:if(p=g.tagName,g=g.namespaceURI)g=pZ(g),p=fZ(g,p);else switch(p){case"svg":p=1;break;case"math":p=2;break;default:p=0}}ve(de),Ye(de,p)}function Zt(){ve(de),ve(fe),ve(Ne)}function qt(p){p.memoizedState!==null&&Ye(je,p);var g=de.current,b=fZ(g,p.type);g!==b&&(Ye(fe,p),Ye(de,b))}function Mi(p){fe.current===p&&(ve(de),ve(fe)),je.current===p&&(ve(je),g2._currentValue=ee)}var oi=Object.prototype.hasOwnProperty,si=t.unstable_scheduleCallback,me=t.unstable_cancelCallback,Bi=t.unstable_shouldYield,pt=t.unstable_requestPaint,$e=t.unstable_now,wt=t.unstable_getCurrentPriorityLevel,$i=t.unstable_ImmediatePriority,Mt=t.unstable_UserBlockingPriority,le=t.unstable_NormalPriority,te=t.unstable_LowPriority,De=t.unstable_IdlePriority,et=t.log,tt=t.unstable_setDisableYieldValue,Ze=null,Ct=null;function gt(p){if(typeof et=="function"&&tt(p),Ct&&typeof Ct.setStrictMode=="function")try{Ct.setStrictMode(Ze,p)}catch{}}var dt=Math.clz32?Math.clz32:xt,hi=Math.log,ct=Math.LN2;function xt(p){return p>>>=0,p===0?32:31-(hi(p)/ct|0)|0}var li=256,jt=4194304;function Tt(p){var g=p&42;if(g!==0)return g;switch(p&-p){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return p&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return p}}function Ii(p,g,b){var P=p.pendingLanes;if(P===0)return 0;var R=0,k=p.suspendedLanes,Z=p.pingedLanes;p=p.warmLanes;var ie=P&134217727;return ie!==0?(P=ie&~k,P!==0?R=Tt(P):(Z&=ie,Z!==0?R=Tt(Z):b||(b=ie&~p,b!==0&&(R=Tt(b))))):(ie=P&~k,ie!==0?R=Tt(ie):Z!==0?R=Tt(Z):b||(b=P&~p,b!==0&&(R=Tt(b)))),R===0?0:g!==0&&g!==R&&(g&k)===0&&(k=R&-R,b=g&-g,k>=b||k===32&&(b&4194048)!==0)?g:R}function di(p,g){return(p.pendingLanes&~(p.suspendedLanes&~p.pingedLanes)&g)===0}function ms(p,g){switch(p){case 1:case 2:case 4:case 8:case 64:return g+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function we(){var p=li;return li<<=1,(li&4194048)===0&&(li=256),p}function Dt(){var p=jt;return jt<<=1,(jt&62914560)===0&&(jt=4194304),p}function Qe(p){for(var g=[],b=0;31>b;b++)g.push(p);return g}function ot(p,g){p.pendingLanes|=g,g!==268435456&&(p.suspendedLanes=0,p.pingedLanes=0,p.warmLanes=0)}function Rt(p,g,b,P,R,k){var Z=p.pendingLanes;p.pendingLanes=b,p.suspendedLanes=0,p.pingedLanes=0,p.warmLanes=0,p.expiredLanes&=b,p.entangledLanes&=b,p.errorRecoveryDisabledLanes&=b,p.shellSuspendCounter=0;var ie=p.entanglements,pe=p.expirationTimes,Ue=p.hiddenUpdates;for(b=Z&~b;0<b;){var rt=31-dt(b),ut=1<<rt;ie[rt]=0,pe[rt]=-1;var qe=Ue[rt];if(qe!==null)for(Ue[rt]=null,rt=0;rt<qe.length;rt++){var Xe=qe[rt];Xe!==null&&(Xe.lane&=-536870913)}b&=~ut}P!==0&&It(p,P,0),k!==0&&R===0&&p.tag!==0&&(p.suspendedLanes|=k&~(Z&~g))}function It(p,g,b){p.pendingLanes|=g,p.suspendedLanes&=~g;var P=31-dt(g);p.entangledLanes|=g,p.entanglements[P]=p.entanglements[P]|1073741824|b&4194090}function qi(p,g){var b=p.entangledLanes|=g;for(p=p.entanglements;b;){var P=31-dt(b),R=1<<P;R&g|p[P]&g&&(p[P]|=g),b&=~R}}function hn(p){switch(p){case 2:p=1;break;case 8:p=4;break;case 32:p=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:p=128;break;case 268435456:p=134217728;break;default:p=0}return p}function or(p){return p&=-p,2<p?8<p?(p&134217727)!==0?32:268435456:8:2}function Ms(){var p=W.p;return p!==0?p:(p=window.event,p===void 0?32:OZ(p.type))}function Le(p,g){var b=W.p;try{return W.p=p,g()}finally{W.p=b}}var Ui=Math.random().toString(36).slice(2),Sn="__reactFiber$"+Ui,Js="__reactProps$"+Ui,Br="__reactContainer$"+Ui,Bt="__reactEvents$"+Ui,ch="__reactListeners$"+Ui,Rn="__reactHandles$"+Ui,Qr="__reactResources$"+Ui,dl="__reactMarker$"+Ui;function Jr(p){delete p[Sn],delete p[Js],delete p[Bt],delete p[ch],delete p[Rn]}function La(p){var g=p[Sn];if(g)return g;for(var b=p.parentNode;b;){if(g=b[Br]||b[Sn]){if(b=g.alternate,g.child!==null||b!==null&&b.child!==null)for(p=vZ(p);p!==null;){if(b=p[Sn])return b;p=vZ(p)}return g}p=b,b=p.parentNode}return null}function Bl(p){if(p=p[Sn]||p[Br]){var g=p.tag;if(g===5||g===6||g===13||g===26||g===27||g===3)return p}return null}function wi(p){var g=p.tag;if(g===5||g===26||g===27||g===6)return p.stateNode;throw Error(s(33))}function ha(p){var g=p[Qr];return g||(g=p[Qr]={hoistableStyles:new Map,hoistableScripts:new Map}),g}function ys(p){p[dl]=!0}var eo=new Set,to={};function _n(p,g){re(p,g),re(p+"Capture",g)}function re(p,g){for(to[p]=g,p=0;p<g.length;p++)eo.add(g[p])}var Ce=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Oe={},Be={};function Ae(p){return oi.call(Be,p)?!0:oi.call(Oe,p)?!1:Ce.test(p)?Be[p]=!0:(Oe[p]=!0,!1)}function ft(p,g,b){if(Ae(g))if(b===null)p.removeAttribute(g);else{switch(typeof b){case"undefined":case"function":case"symbol":p.removeAttribute(g);return;case"boolean":var P=g.toLowerCase().slice(0,5);if(P!=="data-"&&P!=="aria-"){p.removeAttribute(g);return}}p.setAttribute(g,""+b)}}function St(p,g,b){if(b===null)p.removeAttribute(g);else{switch(typeof b){case"undefined":case"function":case"symbol":case"boolean":p.removeAttribute(g);return}p.setAttribute(g,""+b)}}function At(p,g,b,P){if(P===null)p.removeAttribute(b);else{switch(typeof P){case"undefined":case"function":case"symbol":case"boolean":p.removeAttribute(b);return}p.setAttributeNS(g,b,""+P)}}var zt,Ti;function Yt(p){if(zt===void 0)try{throw Error()}catch(b){var g=b.stack.trim().match(/\n( *(at )?)/);zt=g&&g[1]||"",Ti=-1<b.stack.indexOf(`
    at`)?" (<anonymous>)":-1<b.stack.indexOf("@")?"@unknown:0:0":""}return`
`+zt+p+Ti}var ci=!1;function os(p,g){if(!p||ci)return"";ci=!0;var b=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var P={DetermineComponentFrameRoot:function(){try{if(g){var ut=function(){throw Error()};if(Object.defineProperty(ut.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ut,[])}catch(Xe){var qe=Xe}Reflect.construct(p,[],ut)}else{try{ut.call()}catch(Xe){qe=Xe}p.call(ut.prototype)}}else{try{throw Error()}catch(Xe){qe=Xe}(ut=p())&&typeof ut.catch=="function"&&ut.catch(function(){})}}catch(Xe){if(Xe&&qe&&typeof Xe.stack=="string")return[Xe.stack,qe.stack]}return[null,null]}};P.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var R=Object.getOwnPropertyDescriptor(P.DetermineComponentFrameRoot,"name");R&&R.configurable&&Object.defineProperty(P.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var k=P.DetermineComponentFrameRoot(),Z=k[0],ie=k[1];if(Z&&ie){var pe=Z.split(`
`),Ue=ie.split(`
`);for(R=P=0;P<pe.length&&!pe[P].includes("DetermineComponentFrameRoot");)P++;for(;R<Ue.length&&!Ue[R].includes("DetermineComponentFrameRoot");)R++;if(P===pe.length||R===Ue.length)for(P=pe.length-1,R=Ue.length-1;1<=P&&0<=R&&pe[P]!==Ue[R];)R--;for(;1<=P&&0<=R;P--,R--)if(pe[P]!==Ue[R]){if(P!==1||R!==1)do if(P--,R--,0>R||pe[P]!==Ue[R]){var rt=`
`+pe[P].replace(" at new "," at ");return p.displayName&&rt.includes("<anonymous>")&&(rt=rt.replace("<anonymous>",p.displayName)),rt}while(1<=P&&0<=R);break}}}finally{ci=!1,Error.prepareStackTrace=b}return(b=p?p.displayName||p.name:"")?Yt(b):""}function ue(p){switch(p.tag){case 26:case 27:case 5:return Yt(p.type);case 16:return Yt("Lazy");case 13:return Yt("Suspense");case 19:return Yt("SuspenseList");case 0:case 15:return os(p.type,!1);case 11:return os(p.type.render,!1);case 1:return os(p.type,!0);case 31:return Yt("Activity");default:return""}}function He(p){try{var g="";do g+=ue(p),p=p.return;while(p);return g}catch(b){return`
Error generating stack: `+b.message+`
`+b.stack}}function Je(p){switch(typeof p){case"bigint":case"boolean":case"number":case"string":case"undefined":return p;case"object":return p;default:return""}}function bt(p){var g=p.type;return(p=p.nodeName)&&p.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function Pt(p){var g=bt(p)?"checked":"value",b=Object.getOwnPropertyDescriptor(p.constructor.prototype,g),P=""+p[g];if(!p.hasOwnProperty(g)&&typeof b<"u"&&typeof b.get=="function"&&typeof b.set=="function"){var R=b.get,k=b.set;return Object.defineProperty(p,g,{configurable:!0,get:function(){return R.call(this)},set:function(Z){P=""+Z,k.call(this,Z)}}),Object.defineProperty(p,g,{enumerable:b.enumerable}),{getValue:function(){return P},setValue:function(Z){P=""+Z},stopTracking:function(){p._valueTracker=null,delete p[g]}}}}function Hi(p){p._valueTracker||(p._valueTracker=Pt(p))}function xi(p){if(!p)return!1;var g=p._valueTracker;if(!g)return!0;var b=g.getValue(),P="";return p&&(P=bt(p)?p.checked?"true":"false":p.value),p=P,p!==b?(g.setValue(p),!0):!1}function as(p){if(p=p||(typeof document<"u"?document:void 0),typeof p>"u")return null;try{return p.activeElement||p.body}catch{return p.body}}var Ir=/[\n"\\]/g;function Fs(p){return p.replace(Ir,function(g){return"\\"+g.charCodeAt(0).toString(16)+" "})}function Dr(p,g,b,P,R,k,Z,ie){p.name="",Z!=null&&typeof Z!="function"&&typeof Z!="symbol"&&typeof Z!="boolean"?p.type=Z:p.removeAttribute("type"),g!=null?Z==="number"?(g===0&&p.value===""||p.value!=g)&&(p.value=""+Je(g)):p.value!==""+Je(g)&&(p.value=""+Je(g)):Z!=="submit"&&Z!=="reset"||p.removeAttribute("value"),g!=null?io(p,Z,Je(g)):b!=null?io(p,Z,Je(b)):P!=null&&p.removeAttribute("value"),R==null&&k!=null&&(p.defaultChecked=!!k),R!=null&&(p.checked=R&&typeof R!="function"&&typeof R!="symbol"),ie!=null&&typeof ie!="function"&&typeof ie!="symbol"&&typeof ie!="boolean"?p.name=""+Je(ie):p.removeAttribute("name")}function en(p,g,b,P,R,k,Z,ie){if(k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(p.type=k),g!=null||b!=null){if(!(k!=="submit"&&k!=="reset"||g!=null))return;b=b!=null?""+Je(b):"",g=g!=null?""+Je(g):b,ie||g===p.value||(p.value=g),p.defaultValue=g}P=P??R,P=typeof P!="function"&&typeof P!="symbol"&&!!P,p.checked=ie?p.checked:!!P,p.defaultChecked=!!P,Z!=null&&typeof Z!="function"&&typeof Z!="symbol"&&typeof Z!="boolean"&&(p.name=Z)}function io(p,g,b){g==="number"&&as(p.ownerDocument)===p||p.defaultValue===""+b||(p.defaultValue=""+b)}function dn(p,g,b,P){if(p=p.options,g){g={};for(var R=0;R<b.length;R++)g["$"+b[R]]=!0;for(b=0;b<p.length;b++)R=g.hasOwnProperty("$"+p[b].value),p[b].selected!==R&&(p[b].selected=R),R&&P&&(p[b].defaultSelected=!0)}else{for(b=""+Je(b),g=null,R=0;R<p.length;R++){if(p[R].value===b){p[R].selected=!0,P&&(p[R].defaultSelected=!0);return}g!==null||p[R].disabled||(g=p[R])}g!==null&&(g.selected=!0)}}function Gn(p,g,b){if(g!=null&&(g=""+Je(g),g!==p.value&&(p.value=g),b==null)){p.defaultValue!==g&&(p.defaultValue=g);return}p.defaultValue=b!=null?""+Je(b):""}function Nr(p,g,b,P){if(g==null){if(P!=null){if(b!=null)throw Error(s(92));if(H(P)){if(1<P.length)throw Error(s(93));P=P[0]}b=P}b==null&&(b=""),g=b}b=Je(g),p.defaultValue=b,P=p.textContent,P===b&&P!==""&&P!==null&&(p.value=P)}function da(p,g){if(g){var b=p.firstChild;if(b&&b===p.lastChild&&b.nodeType===3){b.nodeValue=g;return}}p.textContent=g}var Nu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function mE(p,g,b){var P=g.indexOf("--")===0;b==null||typeof b=="boolean"||b===""?P?p.setProperty(g,""):g==="float"?p.cssFloat="":p[g]="":P?p.setProperty(g,b):typeof b!="number"||b===0||Nu.has(g)?g==="float"?p.cssFloat=b:p[g]=(""+b).trim():p[g]=b+"px"}function Wm(p,g,b){if(g!=null&&typeof g!="object")throw Error(s(62));if(p=p.style,b!=null){for(var P in b)!b.hasOwnProperty(P)||g!=null&&g.hasOwnProperty(P)||(P.indexOf("--")===0?p.setProperty(P,""):P==="float"?p.cssFloat="":p[P]="");for(var R in g)P=g[R],g.hasOwnProperty(R)&&b[R]!==P&&mE(p,R,P)}else for(var k in g)g.hasOwnProperty(k)&&mE(p,k,g[k])}function Xy(p){if(p.indexOf("-")===-1)return!1;switch(p){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var RA=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),hh=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function W1(p){return hh.test(""+p)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":p}var _c=null;function Jf(p){return p=p.target||p.srcElement||window,p.correspondingUseElement&&(p=p.correspondingUseElement),p.nodeType===3?p.parentNode:p}var Zm=null,yc=null;function Z1(p){var g=Bl(p);if(g&&(p=g.stateNode)){var b=p[Js]||null;e:switch(p=g.stateNode,g.type){case"input":if(Dr(p,b.value,b.defaultValue,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name),g=b.name,b.type==="radio"&&g!=null){for(b=p;b.parentNode;)b=b.parentNode;for(b=b.querySelectorAll('input[name="'+Fs(""+g)+'"][type="radio"]'),g=0;g<b.length;g++){var P=b[g];if(P!==p&&P.form===p.form){var R=P[Js]||null;if(!R)throw Error(s(90));Dr(P,R.value,R.defaultValue,R.defaultValue,R.checked,R.defaultChecked,R.type,R.name)}}for(g=0;g<b.length;g++)P=b[g],P.form===p.form&&xi(P)}break e;case"textarea":Gn(p,b.value,b.defaultValue);break e;case"select":g=b.value,g!=null&&dn(p,!!b.multiple,g,!1)}}}var Km=!1;function pE(p,g,b){if(Km)return p(g,b);Km=!0;try{var P=p(g);return P}finally{if(Km=!1,(Zm!==null||yc!==null)&&(GI(),Zm&&(g=Zm,p=yc,yc=Zm=null,Z1(g),p)))for(g=0;g<p.length;g++)Z1(p[g])}}function eg(p,g){var b=p.stateNode;if(b===null)return null;var P=b[Js]||null;if(P===null)return null;b=P[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(P=!P.disabled)||(p=p.type,P=!(p==="button"||p==="input"||p==="select"||p==="textarea")),p=!P;break e;default:p=!1}if(p)return null;if(b&&typeof b!="function")throw Error(s(231,g,typeof b));return b}var vc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ad=!1;if(vc)try{var Wy={};Object.defineProperty(Wy,"passive",{get:function(){Ad=!0}}),window.addEventListener("test",Wy,Wy),window.removeEventListener("test",Wy,Wy)}catch{Ad=!1}var dh=null,Zy=null,Qm=null;function K1(){if(Qm)return Qm;var p,g=Zy,b=g.length,P,R="value"in dh?dh.value:dh.textContent,k=R.length;for(p=0;p<b&&g[p]===R[p];p++);var Z=b-p;for(P=1;P<=Z&&g[b-P]===R[k-P];P++);return Qm=R.slice(p,1<P?1-P:void 0)}function Q1(p){var g=p.keyCode;return"charCode"in p?(p=p.charCode,p===0&&g===13&&(p=13)):p=g,p===10&&(p=13),32<=p||p===13?p:0}function Jm(){return!0}function OA(){return!1}function ma(p){function g(b,P,R,k,Z){this._reactName=b,this._targetInst=R,this.type=P,this.nativeEvent=k,this.target=Z,this.currentTarget=null;for(var ie in p)p.hasOwnProperty(ie)&&(b=p[ie],this[ie]=b?b(k):k[ie]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?Jm:OA,this.isPropagationStopped=OA,this}return c(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var b=this.nativeEvent;b&&(b.preventDefault?b.preventDefault():typeof b.returnValue!="unknown"&&(b.returnValue=!1),this.isDefaultPrevented=Jm)},stopPropagation:function(){var b=this.nativeEvent;b&&(b.stopPropagation?b.stopPropagation():typeof b.cancelBubble!="unknown"&&(b.cancelBubble=!0),this.isPropagationStopped=Jm)},persist:function(){},isPersistent:Jm}),g}var mh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(p){return p.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},tg=ma(mh),ep=c({},mh,{view:0,detail:0}),LA=ma(ep),tp,Ky,ig,Qy=c({},ep,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gE,button:0,buttons:0,relatedTarget:function(p){return p.relatedTarget===void 0?p.fromElement===p.srcElement?p.toElement:p.fromElement:p.relatedTarget},movementX:function(p){return"movementX"in p?p.movementX:(p!==ig&&(ig&&p.type==="mousemove"?(tp=p.screenX-ig.screenX,Ky=p.screenY-ig.screenY):Ky=tp=0,ig=p),tp)},movementY:function(p){return"movementY"in p?p.movementY:Ky}}),ip=ma(Qy),Sk=c({},Qy,{dataTransfer:0}),FA=ma(Sk),kA=c({},ep,{relatedTarget:0}),J1=ma(kA),$A=c({},mh,{animationName:0,elapsedTime:0,pseudoElement:0}),UA=ma($A),fE=c({},mh,{clipboardData:function(p){return"clipboardData"in p?p.clipboardData:window.clipboardData}}),VA=ma(fE),Ek=c({},mh,{data:0}),zA=ma(Ek),GA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},BA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ex={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ck(p){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(p):(p=ex[p])?!!g[p]:!1}function gE(){return Ck}var _E=c({},ep,{key:function(p){if(p.key){var g=GA[p.key]||p.key;if(g!=="Unidentified")return g}return p.type==="keypress"?(p=Q1(p),p===13?"Enter":String.fromCharCode(p)):p.type==="keydown"||p.type==="keyup"?BA[p.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gE,charCode:function(p){return p.type==="keypress"?Q1(p):0},keyCode:function(p){return p.type==="keydown"||p.type==="keyup"?p.keyCode:0},which:function(p){return p.type==="keypress"?Q1(p):p.type==="keydown"||p.type==="keyup"?p.keyCode:0}}),qA=ma(_E),HA=c({},Qy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Id=ma(HA),yE=c({},ep,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gE}),Tk=ma(yE),jA=c({},mh,{propertyName:0,elapsedTime:0,pseudoElement:0}),Pk=ma(jA),Mk=c({},Qy,{deltaX:function(p){return"deltaX"in p?p.deltaX:"wheelDeltaX"in p?-p.wheelDeltaX:0},deltaY:function(p){return"deltaY"in p?p.deltaY:"wheelDeltaY"in p?-p.wheelDeltaY:"wheelDelta"in p?-p.wheelDelta:0},deltaZ:0,deltaMode:0}),Ak=ma(Mk),Ik=c({},mh,{newState:0,oldState:0}),YA=ma(Ik),XA=[9,13,27,32],vE=vc&&"CompositionEvent"in window,xc=null;vc&&"documentMode"in document&&(xc=document.documentMode);var sp=vc&&"TextEvent"in window&&!xc,WA=vc&&(!vE||xc&&8<xc&&11>=xc),Jy=" ",ZA=!1;function KA(p,g){switch(p){case"keyup":return XA.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function QA(p){return p=p.detail,typeof p=="object"&&"data"in p?p.data:null}var sg=!1;function Dk(p,g){switch(p){case"compositionend":return QA(g);case"keypress":return g.which!==32?null:(ZA=!0,Jy);case"textInput":return p=g.data,p===Jy&&ZA?null:p;default:return null}}function Nk(p,g){if(sg)return p==="compositionend"||!vE&&KA(p,g)?(p=K1(),Qm=Zy=dh=null,sg=!1,p):null;switch(p){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return WA&&g.locale!=="ko"?null:g.data;default:return null}}var Rk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function JA(p){var g=p&&p.nodeName&&p.nodeName.toLowerCase();return g==="input"?!!Rk[p.type]:g==="textarea"}function ql(p,g,b,P){Zm?yc?yc.push(P):yc=[P]:Zm=P,g=XI(g,"onChange"),0<g.length&&(b=new tg("onChange","change",null,b,P),p.push({event:b,listeners:g}))}var ng=null,rg=null;function eI(p){uZ(p,0)}function tx(p){var g=wi(p);if(xi(g))return p}function tI(p,g){if(p==="change")return g}var xE=!1;if(vc){var og;if(vc){var bE="oninput"in document;if(!bE){var iI=document.createElement("div");iI.setAttribute("oninput","return;"),bE=typeof iI.oninput=="function"}og=bE}else og=!1;xE=og&&(!document.documentMode||9<document.documentMode)}function wE(){ng&&(ng.detachEvent("onpropertychange",sI),rg=ng=null)}function sI(p){if(p.propertyName==="value"&&tx(rg)){var g=[];ql(g,rg,p,Jf(p)),pE(eI,g)}}function Ok(p,g,b){p==="focusin"?(wE(),ng=g,rg=b,ng.attachEvent("onpropertychange",sI)):p==="focusout"&&wE()}function nI(p){if(p==="selectionchange"||p==="keyup"||p==="keydown")return tx(rg)}function rI(p,g){if(p==="click")return tx(g)}function oI(p,g){if(p==="input"||p==="change")return tx(g)}function ix(p,g){return p===g&&(p!==0||1/p===1/g)||p!==p&&g!==g}var Fa=typeof Object.is=="function"?Object.is:ix;function np(p,g){if(Fa(p,g))return!0;if(typeof p!="object"||p===null||typeof g!="object"||g===null)return!1;var b=Object.keys(p),P=Object.keys(g);if(b.length!==P.length)return!1;for(P=0;P<b.length;P++){var R=b[P];if(!oi.call(g,R)||!Fa(p[R],g[R]))return!1}return!0}function ml(p){for(;p&&p.firstChild;)p=p.firstChild;return p}function aI(p,g){var b=ml(p);p=0;for(var P;b;){if(b.nodeType===3){if(P=p+b.textContent.length,p<=g&&P>=g)return{node:b,offset:g-p};p=P}e:{for(;b;){if(b.nextSibling){b=b.nextSibling;break e}b=b.parentNode}b=void 0}b=ml(b)}}function lI(p,g){return p&&g?p===g?!0:p&&p.nodeType===3?!1:g&&g.nodeType===3?lI(p,g.parentNode):"contains"in p?p.contains(g):p.compareDocumentPosition?!!(p.compareDocumentPosition(g)&16):!1:!1}function SE(p){p=p!=null&&p.ownerDocument!=null&&p.ownerDocument.defaultView!=null?p.ownerDocument.defaultView:window;for(var g=as(p.document);g instanceof p.HTMLIFrameElement;){try{var b=typeof g.contentWindow.location.href=="string"}catch{b=!1}if(b)p=g.contentWindow;else break;g=as(p.document)}return g}function sx(p){var g=p&&p.nodeName&&p.nodeName.toLowerCase();return g&&(g==="input"&&(p.type==="text"||p.type==="search"||p.type==="tel"||p.type==="url"||p.type==="password")||g==="textarea"||p.contentEditable==="true")}var Lk=vc&&"documentMode"in document&&11>=document.documentMode,ag=null,EE=null,e0=null,CE=!1;function uI(p,g,b){var P=b.window===b?b.document:b.nodeType===9?b:b.ownerDocument;CE||ag==null||ag!==as(P)||(P=ag,"selectionStart"in P&&sx(P)?P={start:P.selectionStart,end:P.selectionEnd}:(P=(P.ownerDocument&&P.ownerDocument.defaultView||window).getSelection(),P={anchorNode:P.anchorNode,anchorOffset:P.anchorOffset,focusNode:P.focusNode,focusOffset:P.focusOffset}),e0&&np(e0,P)||(e0=P,P=XI(EE,"onSelect"),0<P.length&&(g=new tg("onSelect","select",null,g,b),p.push({event:g,listeners:P}),g.target=ag)))}function Dd(p,g){var b={};return b[p.toLowerCase()]=g.toLowerCase(),b["Webkit"+p]="webkit"+g,b["Moz"+p]="moz"+g,b}var rp={animationend:Dd("Animation","AnimationEnd"),animationiteration:Dd("Animation","AnimationIteration"),animationstart:Dd("Animation","AnimationStart"),transitionrun:Dd("Transition","TransitionRun"),transitionstart:Dd("Transition","TransitionStart"),transitioncancel:Dd("Transition","TransitionCancel"),transitionend:Dd("Transition","TransitionEnd")},t0={},cI={};vc&&(cI=document.createElement("div").style,"AnimationEvent"in window||(delete rp.animationend.animation,delete rp.animationiteration.animation,delete rp.animationstart.animation),"TransitionEvent"in window||delete rp.transitionend.transition);function op(p){if(t0[p])return t0[p];if(!rp[p])return p;var g=rp[p],b;for(b in g)if(g.hasOwnProperty(b)&&b in cI)return t0[p]=g[b];return p}var Nd=op("animationend"),bc=op("animationiteration"),TE=op("animationstart"),Fk=op("transitionrun"),hI=op("transitionstart"),dI=op("transitioncancel"),PE=op("transitionend"),ME=new Map,AE="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");AE.push("scrollEnd");function Ru(p,g){ME.set(p,g),_n(g,[p])}var mI=new WeakMap;function pl(p,g){if(typeof p=="object"&&p!==null){var b=mI.get(p);return b!==void 0?b:(g={value:p,source:g,stack:He(g)},mI.set(p,g),g)}return{value:p,source:g,stack:He(g)}}var fl=[],lg=0,IE=0;function nx(){for(var p=lg,g=IE=lg=0;g<p;){var b=fl[g];fl[g++]=null;var P=fl[g];fl[g++]=null;var R=fl[g];fl[g++]=null;var k=fl[g];if(fl[g++]=null,P!==null&&R!==null){var Z=P.pending;Z===null?R.next=R:(R.next=Z.next,Z.next=R),P.pending=R}k!==0&&NE(b,R,k)}}function rx(p,g,b,P){fl[lg++]=p,fl[lg++]=g,fl[lg++]=b,fl[lg++]=P,IE|=P,p.lanes|=P,p=p.alternate,p!==null&&(p.lanes|=P)}function DE(p,g,b,P){return rx(p,g,b,P),ox(p)}function ka(p,g){return rx(p,null,null,g),ox(p)}function NE(p,g,b){p.lanes|=b;var P=p.alternate;P!==null&&(P.lanes|=b);for(var R=!1,k=p.return;k!==null;)k.childLanes|=b,P=k.alternate,P!==null&&(P.childLanes|=b),k.tag===22&&(p=k.stateNode,p===null||p._visibility&1||(R=!0)),p=k,k=k.return;return p.tag===3?(k=p.stateNode,R&&g!==null&&(R=31-dt(b),p=k.hiddenUpdates,P=p[R],P===null?p[R]=[g]:P.push(g),g.lane=b|536870912),k):null}function ox(p){if(50<l2)throw l2=0,f$=null,Error(s(185));for(var g=p.return;g!==null;)p=g,g=p.return;return p.tag===3?p.stateNode:null}var ug={};function kk(p,g,b,P){this.tag=p,this.key=b,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=P,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gl(p,g,b,P){return new kk(p,g,b,P)}function RE(p){return p=p.prototype,!(!p||!p.isReactComponent)}function ph(p,g){var b=p.alternate;return b===null?(b=gl(p.tag,g,p.key,p.mode),b.elementType=p.elementType,b.type=p.type,b.stateNode=p.stateNode,b.alternate=p,p.alternate=b):(b.pendingProps=g,b.type=p.type,b.flags=0,b.subtreeFlags=0,b.deletions=null),b.flags=p.flags&65011712,b.childLanes=p.childLanes,b.lanes=p.lanes,b.child=p.child,b.memoizedProps=p.memoizedProps,b.memoizedState=p.memoizedState,b.updateQueue=p.updateQueue,g=p.dependencies,b.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},b.sibling=p.sibling,b.index=p.index,b.ref=p.ref,b.refCleanup=p.refCleanup,b}function pI(p,g){p.flags&=65011714;var b=p.alternate;return b===null?(p.childLanes=0,p.lanes=g,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=b.childLanes,p.lanes=b.lanes,p.child=b.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=b.memoizedProps,p.memoizedState=b.memoizedState,p.updateQueue=b.updateQueue,p.type=b.type,g=b.dependencies,p.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext}),p}function ax(p,g,b,P,R,k){var Z=0;if(P=p,typeof p=="function")RE(p)&&(Z=1);else if(typeof p=="string")Z=NSe(p,b,de.current)?26:p==="html"||p==="head"||p==="body"?27:5;else e:switch(p){case D:return p=gl(31,b,g,R),p.elementType=D,p.lanes=k,p;case f:return fh(b.children,R,k,g);case _:Z=8,R|=24;break;case v:return p=gl(12,b,g,R|2),p.elementType=v,p.lanes=k,p;case M:return p=gl(13,b,g,R),p.elementType=M,p.lanes=k,p;case A:return p=gl(19,b,g,R),p.elementType=A,p.lanes=k,p;default:if(typeof p=="object"&&p!==null)switch(p.$$typeof){case x:case T:Z=10;break e;case w:Z=9;break e;case C:Z=11;break e;case I:Z=14;break e;case L:Z=16,P=null;break e}Z=29,b=Error(s(130,p===null?"null":typeof p,"")),P=null}return g=gl(Z,b,g,R),g.elementType=p,g.type=P,g.lanes=k,g}function fh(p,g,b,P){return p=gl(7,p,P,g),p.lanes=b,p}function cg(p,g,b){return p=gl(6,p,null,g),p.lanes=b,p}function OE(p,g,b){return g=gl(4,p.children!==null?p.children:[],p.key,g),g.lanes=b,g.stateNode={containerInfo:p.containerInfo,pendingChildren:null,implementation:p.implementation},g}var ap=[],lp=0,Rd=null,hg=0,Hl=[],jl=0,up=null,pa=1,gh="";function cp(p,g){ap[lp++]=hg,ap[lp++]=Rd,Rd=p,hg=g}function fI(p,g,b){Hl[jl++]=pa,Hl[jl++]=gh,Hl[jl++]=up,up=p;var P=pa;p=gh;var R=32-dt(P)-1;P&=~(1<<R),b+=1;var k=32-dt(g)+R;if(30<k){var Z=R-R%5;k=(P&(1<<Z)-1).toString(32),P>>=Z,R-=Z,pa=1<<32-dt(g)+R|b<<R|P,gh=k+p}else pa=1<<k|b<<R|P,gh=p}function LE(p){p.return!==null&&(cp(p,1),fI(p,1,0))}function dg(p){for(;p===Rd;)Rd=ap[--lp],ap[lp]=null,hg=ap[--lp],ap[lp]=null;for(;p===up;)up=Hl[--jl],Hl[jl]=null,gh=Hl[--jl],Hl[jl]=null,pa=Hl[--jl],Hl[jl]=null}var bo=null,ar=null,ks=!1,hp=null,fa=!1,i0=Error(s(519));function Od(p){var g=Error(s(418,""));throw n0(pl(g,p)),i0}function gI(p){var g=p.stateNode,b=p.type,P=p.memoizedProps;switch(g[Sn]=p,g[Js]=P,b){case"dialog":Es("cancel",g),Es("close",g);break;case"iframe":case"object":case"embed":Es("load",g);break;case"video":case"audio":for(b=0;b<c2.length;b++)Es(c2[b],g);break;case"source":Es("error",g);break;case"img":case"image":case"link":Es("error",g),Es("load",g);break;case"details":Es("toggle",g);break;case"input":Es("invalid",g),en(g,P.value,P.defaultValue,P.checked,P.defaultChecked,P.type,P.name,!0),Hi(g);break;case"select":Es("invalid",g);break;case"textarea":Es("invalid",g),Nr(g,P.value,P.defaultValue,P.children),Hi(g)}b=P.children,typeof b!="string"&&typeof b!="number"&&typeof b!="bigint"||g.textContent===""+b||P.suppressHydrationWarning===!0||mZ(g.textContent,b)?(P.popover!=null&&(Es("beforetoggle",g),Es("toggle",g)),P.onScroll!=null&&Es("scroll",g),P.onScrollEnd!=null&&Es("scrollend",g),P.onClick!=null&&(g.onclick=WI),g=!0):g=!1,g||Od(p)}function _I(p){for(bo=p.return;bo;)switch(bo.tag){case 5:case 13:fa=!1;return;case 27:case 3:fa=!0;return;default:bo=bo.return}}function s0(p){if(p!==bo)return!1;if(!ks)return _I(p),ks=!0,!1;var g=p.tag,b;if((b=g!==3&&g!==27)&&((b=g===5)&&(b=p.type,b=!(b!=="form"&&b!=="button")||D$(p.type,p.memoizedProps)),b=!b),b&&ar&&Od(p),_I(p),g===13){if(p=p.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(s(317));e:{for(p=p.nextSibling,g=0;p;){if(p.nodeType===8)if(b=p.data,b==="/$"){if(g===0){ar=Sh(p.nextSibling);break e}g--}else b!=="$"&&b!=="$!"&&b!=="$?"||g++;p=p.nextSibling}ar=null}}else g===27?(g=ar,Mg(p.type)?(p=L$,L$=null,ar=p):ar=g):ar=bo?Sh(p.stateNode.nextSibling):null;return!0}function _h(){ar=bo=null,ks=!1}function Ld(){var p=hp;return p!==null&&(Wl===null?Wl=p:Wl.push.apply(Wl,p),hp=null),p}function n0(p){hp===null?hp=[p]:hp.push(p)}var FE=oe(null),dp=null,yh=null;function Fd(p,g,b){Ye(FE,g._currentValue),g._currentValue=b}function vh(p){p._currentValue=FE.current,ve(FE)}function kE(p,g,b){for(;p!==null;){var P=p.alternate;if((p.childLanes&g)!==g?(p.childLanes|=g,P!==null&&(P.childLanes|=g)):P!==null&&(P.childLanes&g)!==g&&(P.childLanes|=g),p===b)break;p=p.return}}function $E(p,g,b,P){var R=p.child;for(R!==null&&(R.return=p);R!==null;){var k=R.dependencies;if(k!==null){var Z=R.child;k=k.firstContext;e:for(;k!==null;){var ie=k;k=R;for(var pe=0;pe<g.length;pe++)if(ie.context===g[pe]){k.lanes|=b,ie=k.alternate,ie!==null&&(ie.lanes|=b),kE(k.return,b,p),P||(Z=null);break e}k=ie.next}}else if(R.tag===18){if(Z=R.return,Z===null)throw Error(s(341));Z.lanes|=b,k=Z.alternate,k!==null&&(k.lanes|=b),kE(Z,b,p),Z=null}else Z=R.child;if(Z!==null)Z.return=R;else for(Z=R;Z!==null;){if(Z===p){Z=null;break}if(R=Z.sibling,R!==null){R.return=Z.return,Z=R;break}Z=Z.return}R=Z}}function mg(p,g,b,P){p=null;for(var R=g,k=!1;R!==null;){if(!k){if((R.flags&524288)!==0)k=!0;else if((R.flags&262144)!==0)break}if(R.tag===10){var Z=R.alternate;if(Z===null)throw Error(s(387));if(Z=Z.memoizedProps,Z!==null){var ie=R.type;Fa(R.pendingProps.value,Z.value)||(p!==null?p.push(ie):p=[ie])}}else if(R===je.current){if(Z=R.alternate,Z===null)throw Error(s(387));Z.memoizedState.memoizedState!==R.memoizedState.memoizedState&&(p!==null?p.push(g2):p=[g2])}R=R.return}p!==null&&$E(g,p,b,P),g.flags|=262144}function lx(p){for(p=p.firstContext;p!==null;){if(!Fa(p.context._currentValue,p.memoizedValue))return!0;p=p.next}return!1}function kd(p){dp=p,yh=null,p=p.dependencies,p!==null&&(p.firstContext=null)}function so(p){return $d(dp,p)}function r0(p,g){return dp===null&&kd(p),$d(p,g)}function $d(p,g){var b=g._currentValue;if(g={context:g,memoizedValue:b,next:null},yh===null){if(p===null)throw Error(s(308));yh=g,p.dependencies={lanes:0,firstContext:g},p.flags|=524288}else yh=yh.next=g;return b}var yI=typeof AbortController<"u"?AbortController:function(){var p=[],g=this.signal={aborted:!1,addEventListener:function(b,P){p.push(P)}};this.abort=function(){g.aborted=!0,p.forEach(function(b){return b()})}},UE=t.unstable_scheduleCallback,vI=t.unstable_NormalPriority,br={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ux(){return{controller:new yI,data:new Map,refCount:0}}function mp(p){p.refCount--,p.refCount===0&&UE(vI,function(){p.controller.abort()})}var o0=null,xh=0,_l=0,pg=null;function $k(p,g){if(o0===null){var b=o0=[];xh=0,_l=w$(),pg={status:"pending",value:void 0,then:function(P){b.push(P)}}}return xh++,g.then(xI,xI),g}function xI(){if(--xh===0&&o0!==null){pg!==null&&(pg.status="fulfilled");var p=o0;o0=null,_l=0,pg=null;for(var g=0;g<p.length;g++)(0,p[g])()}}function Uk(p,g){var b=[],P={status:"pending",value:null,reason:null,then:function(R){b.push(R)}};return p.then(function(){P.status="fulfilled",P.value=g;for(var R=0;R<b.length;R++)(0,b[R])(g)},function(R){for(P.status="rejected",P.reason=R,R=0;R<b.length;R++)(0,b[R])(void 0)}),P}var bI=Y.S;Y.S=function(p,g){typeof g=="object"&&g!==null&&typeof g.then=="function"&&$k(p,g),bI!==null&&bI(p,g)};var pp=oe(null);function VE(){var p=pp.current;return p!==null?p:qn.pooledCache}function cx(p,g){g===null?Ye(pp,pp.current):Ye(pp,g.pool)}function zE(){var p=VE();return p===null?null:{parent:br._currentValue,pool:p}}var Ud=Error(s(460)),a0=Error(s(474)),hx=Error(s(542)),GE={then:function(){}};function fg(p){return p=p.status,p==="fulfilled"||p==="rejected"}function Q(){}function F(p,g,b){switch(b=p[b],b===void 0?p.push(g):b!==g&&(g.then(Q,Q),g=b),g.status){case"fulfilled":return g.value;case"rejected":throw p=g.reason,Te(p),p;default:if(typeof g.status=="string")g.then(Q,Q);else{if(p=qn,p!==null&&100<p.shellSuspendCounter)throw Error(s(482));p=g,p.status="pending",p.then(function(P){if(g.status==="pending"){var R=g;R.status="fulfilled",R.value=P}},function(P){if(g.status==="pending"){var R=g;R.status="rejected",R.reason=P}})}switch(g.status){case"fulfilled":return g.value;case"rejected":throw p=g.reason,Te(p),p}throw X=g,Ud}}var X=null;function ae(){if(X===null)throw Error(s(459));var p=X;return X=null,p}function Te(p){if(p===Ud||p===hx)throw Error(s(483))}var Pe=!1;function Ke(p){p.updateQueue={baseState:p.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function lt(p,g){p=p.updateQueue,g.updateQueue===p&&(g.updateQueue={baseState:p.baseState,firstBaseUpdate:p.firstBaseUpdate,lastBaseUpdate:p.lastBaseUpdate,shared:p.shared,callbacks:null})}function vt(p){return{lane:p,tag:0,payload:null,callback:null,next:null}}function Ft(p,g,b){var P=p.updateQueue;if(P===null)return null;if(P=P.shared,(yn&2)!==0){var R=P.pending;return R===null?g.next=g:(g.next=R.next,R.next=g),P.pending=g,g=ox(p),NE(p,null,b),g}return rx(p,P,g,b),ox(p)}function Ht(p,g,b){if(g=g.updateQueue,g!==null&&(g=g.shared,(b&4194048)!==0)){var P=g.lanes;P&=p.pendingLanes,b|=P,g.lanes=b,qi(p,b)}}function Ot(p,g){var b=p.updateQueue,P=p.alternate;if(P!==null&&(P=P.updateQueue,b===P)){var R=null,k=null;if(b=b.firstBaseUpdate,b!==null){do{var Z={lane:b.lane,tag:b.tag,payload:b.payload,callback:null,next:null};k===null?R=k=Z:k=k.next=Z,b=b.next}while(b!==null);k===null?R=k=g:k=k.next=g}else R=k=g;b={baseState:P.baseState,firstBaseUpdate:R,lastBaseUpdate:k,shared:P.shared,callbacks:P.callbacks},p.updateQueue=b;return}p=b.lastBaseUpdate,p===null?b.firstBaseUpdate=g:p.next=g,b.lastBaseUpdate=g}var ts=!1;function Si(){if(ts){var p=pg;if(p!==null)throw p}}function Oi(p,g,b,P){ts=!1;var R=p.updateQueue;Pe=!1;var k=R.firstBaseUpdate,Z=R.lastBaseUpdate,ie=R.shared.pending;if(ie!==null){R.shared.pending=null;var pe=ie,Ue=pe.next;pe.next=null,Z===null?k=Ue:Z.next=Ue,Z=pe;var rt=p.alternate;rt!==null&&(rt=rt.updateQueue,ie=rt.lastBaseUpdate,ie!==Z&&(ie===null?rt.firstBaseUpdate=Ue:ie.next=Ue,rt.lastBaseUpdate=pe))}if(k!==null){var ut=R.baseState;Z=0,rt=Ue=pe=null,ie=k;do{var qe=ie.lane&-536870913,Xe=qe!==ie.lane;if(Xe?($s&qe)===qe:(P&qe)===qe){qe!==0&&qe===_l&&(ts=!0),rt!==null&&(rt=rt.next={lane:0,tag:ie.tag,payload:ie.payload,callback:null,next:null});e:{var ji=p,Ni=ie;qe=g;var Cn=b;switch(Ni.tag){case 1:if(ji=Ni.payload,typeof ji=="function"){ut=ji.call(Cn,ut,qe);break e}ut=ji;break e;case 3:ji.flags=ji.flags&-65537|128;case 0:if(ji=Ni.payload,qe=typeof ji=="function"?ji.call(Cn,ut,qe):ji,qe==null)break e;ut=c({},ut,qe);break e;case 2:Pe=!0}}qe=ie.callback,qe!==null&&(p.flags|=64,Xe&&(p.flags|=8192),Xe=R.callbacks,Xe===null?R.callbacks=[qe]:Xe.push(qe))}else Xe={lane:qe,tag:ie.tag,payload:ie.payload,callback:ie.callback,next:null},rt===null?(Ue=rt=Xe,pe=ut):rt=rt.next=Xe,Z|=qe;if(ie=ie.next,ie===null){if(ie=R.shared.pending,ie===null)break;Xe=ie,ie=Xe.next,Xe.next=null,R.lastBaseUpdate=Xe,R.shared.pending=null}}while(!0);rt===null&&(pe=ut),R.baseState=pe,R.firstBaseUpdate=Ue,R.lastBaseUpdate=rt,k===null&&(R.shared.lanes=0),Eg|=Z,p.lanes=Z,p.memoizedState=ut}}function Vi(p,g){if(typeof p!="function")throw Error(s(191,p));p.call(g)}function Xi(p,g){var b=p.callbacks;if(b!==null)for(p.callbacks=null,p=0;p<b.length;p++)Vi(b[p],g)}var Ds=oe(null),tn=oe(0);function ls(p,g){p=xp,Ye(tn,p),Ye(Ds,g),xp=p|g.baseLanes}function Ns(){Ye(tn,xp),Ye(Ds,Ds.current)}function is(){xp=tn.current,ve(Ds),ve(tn)}var ss=0,Xt=null,yi=null,Li=null,Bn=!1,no=!1,wo=!1,ro=0,Go=0,So=null,lr=0;function js(){throw Error(s(321))}function Yl(p,g){if(g===null)return!1;for(var b=0;b<g.length&&b<p.length;b++)if(!Fa(p[b],g[b]))return!1;return!0}function Vd(p,g,b,P,R,k){return ss=k,Xt=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,Y.H=p===null||p.memoizedState===null?YX:XX,wo=!1,k=b(P,R),wo=!1,no&&(k=mn(g,b,P,R)),qr(p),k}function qr(p){Y.H=AI;var g=yi!==null&&yi.next!==null;if(ss=0,Li=yi=Xt=null,Bn=!1,Go=0,So=null,g)throw Error(s(300));p===null||Bo||(p=p.dependencies,p!==null&&lx(p)&&(Bo=!0))}function mn(p,g,b,P){Xt=p;var R=0;do{if(no&&(So=null),Go=0,no=!1,25<=R)throw Error(s(301));if(R+=1,Li=yi=null,p.updateQueue!=null){var k=p.updateQueue;k.lastEffect=null,k.events=null,k.stores=null,k.memoCache!=null&&(k.memoCache.index=0)}Y.H=Bwe,k=g(b,P)}while(no);return k}function ga(){var p=Y.H,g=p.useState()[0];return g=typeof g.then=="function"?l0(g):g,p=p.useState()[0],(yi!==null?yi.memoizedState:null)!==p&&(Xt.flags|=1024),g}function $a(){var p=ro!==0;return ro=0,p}function wc(p,g,b){g.updateQueue=p.updateQueue,g.flags&=-2053,p.lanes&=~b}function gg(p){if(Bn){for(p=p.memoizedState;p!==null;){var g=p.queue;g!==null&&(g.pending=null),p=p.next}Bn=!1}ss=0,Li=yi=Xt=null,no=!1,Go=ro=0,So=null}function _a(){var p={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Li===null?Xt.memoizedState=Li=p:Li=Li.next=p,Li}function wr(){if(yi===null){var p=Xt.alternate;p=p!==null?p.memoizedState:null}else p=yi.next;var g=Li===null?Xt.memoizedState:Li.next;if(g!==null)Li=g,yi=p;else{if(p===null)throw Xt.alternate===null?Error(s(467)):Error(s(310));yi=p,p={memoizedState:yi.memoizedState,baseState:yi.baseState,baseQueue:yi.baseQueue,queue:yi.queue,next:null},Li===null?Xt.memoizedState=Li=p:Li=Li.next=p}return Li}function _g(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function l0(p){var g=Go;return Go+=1,So===null&&(So=[]),p=F(So,p,g),g=Xt,(Li===null?g.memoizedState:Li.next)===null&&(g=g.alternate,Y.H=g===null||g.memoizedState===null?YX:XX),p}function dx(p){if(p!==null&&typeof p=="object"){if(typeof p.then=="function")return l0(p);if(p.$$typeof===T)return so(p)}throw Error(s(438,String(p)))}function u0(p){var g=null,b=Xt.updateQueue;if(b!==null&&(g=b.memoCache),g==null){var P=Xt.alternate;P!==null&&(P=P.updateQueue,P!==null&&(P=P.memoCache,P!=null&&(g={data:P.data.map(function(R){return R.slice()}),index:0})))}if(g==null&&(g={data:[],index:0}),b===null&&(b=_g(),Xt.updateQueue=b),b.memoCache=g,b=g.data[g.index],b===void 0)for(b=g.data[g.index]=Array(p),P=0;P<p;P++)b[P]=O;return g.index++,b}function bh(p,g){return typeof g=="function"?g(p):g}function c0(p){var g=wr();return BE(g,yi,p)}function BE(p,g,b){var P=p.queue;if(P===null)throw Error(s(311));P.lastRenderedReducer=b;var R=p.baseQueue,k=P.pending;if(k!==null){if(R!==null){var Z=R.next;R.next=k.next,k.next=Z}g.baseQueue=R=k,P.pending=null}if(k=p.baseState,R===null)p.memoizedState=k;else{g=R.next;var ie=Z=null,pe=null,Ue=g,rt=!1;do{var ut=Ue.lane&-536870913;if(ut!==Ue.lane?($s&ut)===ut:(ss&ut)===ut){var qe=Ue.revertLane;if(qe===0)pe!==null&&(pe=pe.next={lane:0,revertLane:0,action:Ue.action,hasEagerState:Ue.hasEagerState,eagerState:Ue.eagerState,next:null}),ut===_l&&(rt=!0);else if((ss&qe)===qe){Ue=Ue.next,qe===_l&&(rt=!0);continue}else ut={lane:0,revertLane:Ue.revertLane,action:Ue.action,hasEagerState:Ue.hasEagerState,eagerState:Ue.eagerState,next:null},pe===null?(ie=pe=ut,Z=k):pe=pe.next=ut,Xt.lanes|=qe,Eg|=qe;ut=Ue.action,wo&&b(k,ut),k=Ue.hasEagerState?Ue.eagerState:b(k,ut)}else qe={lane:ut,revertLane:Ue.revertLane,action:Ue.action,hasEagerState:Ue.hasEagerState,eagerState:Ue.eagerState,next:null},pe===null?(ie=pe=qe,Z=k):pe=pe.next=qe,Xt.lanes|=ut,Eg|=ut;Ue=Ue.next}while(Ue!==null&&Ue!==g);if(pe===null?Z=k:pe.next=ie,!Fa(k,p.memoizedState)&&(Bo=!0,rt&&(b=pg,b!==null)))throw b;p.memoizedState=k,p.baseState=Z,p.baseQueue=pe,P.lastRenderedState=k}return R===null&&(P.lanes=0),[p.memoizedState,P.dispatch]}function mx(p){var g=wr(),b=g.queue;if(b===null)throw Error(s(311));b.lastRenderedReducer=p;var P=b.dispatch,R=b.pending,k=g.memoizedState;if(R!==null){b.pending=null;var Z=R=R.next;do k=p(k,Z.action),Z=Z.next;while(Z!==R);Fa(k,g.memoizedState)||(Bo=!0),g.memoizedState=k,g.baseQueue===null&&(g.baseState=k),b.lastRenderedState=k}return[k,P]}function qE(p,g,b){var P=Xt,R=wr(),k=ks;if(k){if(b===void 0)throw Error(s(407));b=b()}else b=g();var Z=!Fa((yi||R).memoizedState,b);Z&&(R.memoizedState=b,Bo=!0),R=R.queue;var ie=zd.bind(null,P,R,p);if(KE(2048,8,ie,[p]),R.getSnapshot!==g||Z||Li!==null&&Li.memoizedState.tag&1){if(P.flags|=2048,_x(9,TI(),SI.bind(null,P,R,b,g),null),qn===null)throw Error(s(349));k||(ss&124)!==0||wI(P,g,b)}return b}function wI(p,g,b){p.flags|=16384,p={getSnapshot:g,value:b},g=Xt.updateQueue,g===null?(g=_g(),Xt.updateQueue=g,g.stores=[p]):(b=g.stores,b===null?g.stores=[p]:b.push(p))}function SI(p,g,b,P){g.value=b,g.getSnapshot=P,h0(g)&&HE(p)}function zd(p,g,b){return b(function(){h0(g)&&HE(p)})}function h0(p){var g=p.getSnapshot;p=p.value;try{var b=g();return!Fa(p,b)}catch{return!0}}function HE(p){var g=ka(p,2);g!==null&&$u(g,p,2)}function px(p){var g=_a();if(typeof p=="function"){var b=p;if(p=b(),wo){gt(!0);try{b()}finally{gt(!1)}}}return g.memoizedState=g.baseState=p,g.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:bh,lastRenderedState:p},g}function fx(p,g,b,P){return p.baseState=b,BE(p,yi,typeof P=="function"?P:bh)}function EI(p,g,b,P,R){if(MI(p))throw Error(s(485));if(p=g.action,p!==null){var k={payload:R,action:p,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Z){k.listeners.push(Z)}};Y.T!==null?b(!0):k.isTransition=!1,P(k),b=g.pending,b===null?(k.next=g.pending=k,jE(g,k)):(k.next=b.next,g.pending=b.next=k)}}function jE(p,g){var b=g.action,P=g.payload,R=p.state;if(g.isTransition){var k=Y.T,Z={};Y.T=Z;try{var ie=b(R,P),pe=Y.S;pe!==null&&pe(Z,ie),YE(p,g,ie)}catch(Ue){WE(p,g,Ue)}finally{Y.T=k}}else try{k=b(R,P),YE(p,g,k)}catch(Ue){WE(p,g,Ue)}}function YE(p,g,b){b!==null&&typeof b=="object"&&typeof b.then=="function"?b.then(function(P){XE(p,g,P)},function(P){return WE(p,g,P)}):XE(p,g,b)}function XE(p,g,b){g.status="fulfilled",g.value=b,CI(g),p.state=b,g=p.pending,g!==null&&(b=g.next,b===g?p.pending=null:(b=b.next,g.next=b,jE(p,b)))}function WE(p,g,b){var P=p.pending;if(p.pending=null,P!==null){P=P.next;do g.status="rejected",g.reason=b,CI(g),g=g.next;while(g!==P)}p.action=null}function CI(p){p=p.listeners;for(var g=0;g<p.length;g++)(0,p[g])()}function gx(p,g){return g}function ZE(p,g){if(ks){var b=qn.formState;if(b!==null){e:{var P=Xt;if(ks){if(ar){t:{for(var R=ar,k=fa;R.nodeType!==8;){if(!k){R=null;break t}if(R=Sh(R.nextSibling),R===null){R=null;break t}}k=R.data,R=k==="F!"||k==="F"?R:null}if(R){ar=Sh(R.nextSibling),P=R.data==="F!";break e}}Od(P)}P=!1}P&&(g=b[0])}}return b=_a(),b.memoizedState=b.baseState=g,P={pending:null,lanes:0,dispatch:null,lastRenderedReducer:gx,lastRenderedState:g},b.queue=P,b=qX.bind(null,Xt,P),P.dispatch=b,P=px(!1),k=qk.bind(null,Xt,!1,P.queue),P=_a(),R={state:g,dispatch:null,action:p,pending:null},P.queue=R,b=EI.bind(null,Xt,R,k,b),R.dispatch=b,P.memoizedState=p,[g,b,!1]}function TX(p){var g=wr();return PX(g,yi,p)}function PX(p,g,b){if(g=BE(p,g,gx)[0],p=c0(bh)[0],typeof g=="object"&&g!==null&&typeof g.then=="function")try{var P=l0(g)}catch(Z){throw Z===Ud?hx:Z}else P=g;g=wr();var R=g.queue,k=R.dispatch;return b!==g.memoizedState&&(Xt.flags|=2048,_x(9,TI(),Uwe.bind(null,R,b),null)),[P,k,p]}function Uwe(p,g){p.action=g}function MX(p){var g=wr(),b=yi;if(b!==null)return PX(g,b,p);wr(),g=g.memoizedState,b=wr();var P=b.queue.dispatch;return b.memoizedState=p,[g,P,!1]}function _x(p,g,b,P){return p={tag:p,create:b,deps:P,inst:g,next:null},g=Xt.updateQueue,g===null&&(g=_g(),Xt.updateQueue=g),b=g.lastEffect,b===null?g.lastEffect=p.next=p:(P=b.next,b.next=p,p.next=P,g.lastEffect=p),p}function TI(){return{destroy:void 0,resource:void 0}}function AX(){return wr().memoizedState}function PI(p,g,b,P){var R=_a();P=P===void 0?null:P,Xt.flags|=p,R.memoizedState=_x(1|g,TI(),b,P)}function KE(p,g,b,P){var R=wr();P=P===void 0?null:P;var k=R.memoizedState.inst;yi!==null&&P!==null&&Yl(P,yi.memoizedState.deps)?R.memoizedState=_x(g,k,b,P):(Xt.flags|=p,R.memoizedState=_x(1|g,k,b,P))}function IX(p,g){PI(8390656,8,p,g)}function DX(p,g){KE(2048,8,p,g)}function NX(p,g){return KE(4,2,p,g)}function RX(p,g){return KE(4,4,p,g)}function OX(p,g){if(typeof g=="function"){p=p();var b=g(p);return function(){typeof b=="function"?b():g(null)}}if(g!=null)return p=p(),g.current=p,function(){g.current=null}}function LX(p,g,b){b=b!=null?b.concat([p]):null,KE(4,4,OX.bind(null,g,p),b)}function Vk(){}function FX(p,g){var b=wr();g=g===void 0?null:g;var P=b.memoizedState;return g!==null&&Yl(g,P[1])?P[0]:(b.memoizedState=[p,g],p)}function kX(p,g){var b=wr();g=g===void 0?null:g;var P=b.memoizedState;if(g!==null&&Yl(g,P[1]))return P[0];if(P=p(),wo){gt(!0);try{p()}finally{gt(!1)}}return b.memoizedState=[P,g],P}function zk(p,g,b){return b===void 0||(ss&1073741824)!==0?p.memoizedState=g:(p.memoizedState=b,p=VW(),Xt.lanes|=p,Eg|=p,b)}function $X(p,g,b,P){return Fa(b,g)?b:Ds.current!==null?(p=zk(p,b,P),Fa(p,g)||(Bo=!0),p):(ss&42)===0?(Bo=!0,p.memoizedState=b):(p=VW(),Xt.lanes|=p,Eg|=p,g)}function UX(p,g,b,P,R){var k=W.p;W.p=k!==0&&8>k?k:8;var Z=Y.T,ie={};Y.T=ie,qk(p,!1,g,b);try{var pe=R(),Ue=Y.S;if(Ue!==null&&Ue(ie,pe),pe!==null&&typeof pe=="object"&&typeof pe.then=="function"){var rt=Uk(pe,P);QE(p,g,rt,ku(p))}else QE(p,g,P,ku(p))}catch(ut){QE(p,g,{then:function(){},status:"rejected",reason:ut},ku())}finally{W.p=k,Y.T=Z}}function Vwe(){}function Gk(p,g,b,P){if(p.tag!==5)throw Error(s(476));var R=VX(p).queue;UX(p,R,g,ee,b===null?Vwe:function(){return zX(p),b(P)})}function VX(p){var g=p.memoizedState;if(g!==null)return g;g={memoizedState:ee,baseState:ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:bh,lastRenderedState:ee},next:null};var b={};return g.next={memoizedState:b,baseState:b,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:bh,lastRenderedState:b},next:null},p.memoizedState=g,p=p.alternate,p!==null&&(p.memoizedState=g),g}function zX(p){var g=VX(p).next.queue;QE(p,g,{},ku())}function Bk(){return so(g2)}function GX(){return wr().memoizedState}function BX(){return wr().memoizedState}function zwe(p){for(var g=p.return;g!==null;){switch(g.tag){case 24:case 3:var b=ku();p=vt(b);var P=Ft(g,p,b);P!==null&&($u(P,g,b),Ht(P,g,b)),g={cache:ux()},p.payload=g;return}g=g.return}}function Gwe(p,g,b){var P=ku();b={lane:P,revertLane:0,action:b,hasEagerState:!1,eagerState:null,next:null},MI(p)?HX(g,b):(b=DE(p,g,b,P),b!==null&&($u(b,p,P),jX(b,g,P)))}function qX(p,g,b){var P=ku();QE(p,g,b,P)}function QE(p,g,b,P){var R={lane:P,revertLane:0,action:b,hasEagerState:!1,eagerState:null,next:null};if(MI(p))HX(g,R);else{var k=p.alternate;if(p.lanes===0&&(k===null||k.lanes===0)&&(k=g.lastRenderedReducer,k!==null))try{var Z=g.lastRenderedState,ie=k(Z,b);if(R.hasEagerState=!0,R.eagerState=ie,Fa(ie,Z))return rx(p,g,R,0),qn===null&&nx(),!1}catch{}finally{}if(b=DE(p,g,R,P),b!==null)return $u(b,p,P),jX(b,g,P),!0}return!1}function qk(p,g,b,P){if(P={lane:2,revertLane:w$(),action:P,hasEagerState:!1,eagerState:null,next:null},MI(p)){if(g)throw Error(s(479))}else g=DE(p,b,P,2),g!==null&&$u(g,p,2)}function MI(p){var g=p.alternate;return p===Xt||g!==null&&g===Xt}function HX(p,g){no=Bn=!0;var b=p.pending;b===null?g.next=g:(g.next=b.next,b.next=g),p.pending=g}function jX(p,g,b){if((b&4194048)!==0){var P=g.lanes;P&=p.pendingLanes,b|=P,g.lanes=b,qi(p,b)}}var AI={readContext:so,use:dx,useCallback:js,useContext:js,useEffect:js,useImperativeHandle:js,useLayoutEffect:js,useInsertionEffect:js,useMemo:js,useReducer:js,useRef:js,useState:js,useDebugValue:js,useDeferredValue:js,useTransition:js,useSyncExternalStore:js,useId:js,useHostTransitionStatus:js,useFormState:js,useActionState:js,useOptimistic:js,useMemoCache:js,useCacheRefresh:js},YX={readContext:so,use:dx,useCallback:function(p,g){return _a().memoizedState=[p,g===void 0?null:g],p},useContext:so,useEffect:IX,useImperativeHandle:function(p,g,b){b=b!=null?b.concat([p]):null,PI(4194308,4,OX.bind(null,g,p),b)},useLayoutEffect:function(p,g){return PI(4194308,4,p,g)},useInsertionEffect:function(p,g){PI(4,2,p,g)},useMemo:function(p,g){var b=_a();g=g===void 0?null:g;var P=p();if(wo){gt(!0);try{p()}finally{gt(!1)}}return b.memoizedState=[P,g],P},useReducer:function(p,g,b){var P=_a();if(b!==void 0){var R=b(g);if(wo){gt(!0);try{b(g)}finally{gt(!1)}}}else R=g;return P.memoizedState=P.baseState=R,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:p,lastRenderedState:R},P.queue=p,p=p.dispatch=Gwe.bind(null,Xt,p),[P.memoizedState,p]},useRef:function(p){var g=_a();return p={current:p},g.memoizedState=p},useState:function(p){p=px(p);var g=p.queue,b=qX.bind(null,Xt,g);return g.dispatch=b,[p.memoizedState,b]},useDebugValue:Vk,useDeferredValue:function(p,g){var b=_a();return zk(b,p,g)},useTransition:function(){var p=px(!1);return p=UX.bind(null,Xt,p.queue,!0,!1),_a().memoizedState=p,[!1,p]},useSyncExternalStore:function(p,g,b){var P=Xt,R=_a();if(ks){if(b===void 0)throw Error(s(407));b=b()}else{if(b=g(),qn===null)throw Error(s(349));($s&124)!==0||wI(P,g,b)}R.memoizedState=b;var k={value:b,getSnapshot:g};return R.queue=k,IX(zd.bind(null,P,k,p),[p]),P.flags|=2048,_x(9,TI(),SI.bind(null,P,k,b,g),null),b},useId:function(){var p=_a(),g=qn.identifierPrefix;if(ks){var b=gh,P=pa;b=(P&~(1<<32-dt(P)-1)).toString(32)+b,g="«"+g+"R"+b,b=ro++,0<b&&(g+="H"+b.toString(32)),g+="»"}else b=lr++,g="«"+g+"r"+b.toString(32)+"»";return p.memoizedState=g},useHostTransitionStatus:Bk,useFormState:ZE,useActionState:ZE,useOptimistic:function(p){var g=_a();g.memoizedState=g.baseState=p;var b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return g.queue=b,g=qk.bind(null,Xt,!0,b),b.dispatch=g,[p,g]},useMemoCache:u0,useCacheRefresh:function(){return _a().memoizedState=zwe.bind(null,Xt)}},XX={readContext:so,use:dx,useCallback:FX,useContext:so,useEffect:DX,useImperativeHandle:LX,useInsertionEffect:NX,useLayoutEffect:RX,useMemo:kX,useReducer:c0,useRef:AX,useState:function(){return c0(bh)},useDebugValue:Vk,useDeferredValue:function(p,g){var b=wr();return $X(b,yi.memoizedState,p,g)},useTransition:function(){var p=c0(bh)[0],g=wr().memoizedState;return[typeof p=="boolean"?p:l0(p),g]},useSyncExternalStore:qE,useId:GX,useHostTransitionStatus:Bk,useFormState:TX,useActionState:TX,useOptimistic:function(p,g){var b=wr();return fx(b,yi,p,g)},useMemoCache:u0,useCacheRefresh:BX},Bwe={readContext:so,use:dx,useCallback:FX,useContext:so,useEffect:DX,useImperativeHandle:LX,useInsertionEffect:NX,useLayoutEffect:RX,useMemo:kX,useReducer:mx,useRef:AX,useState:function(){return mx(bh)},useDebugValue:Vk,useDeferredValue:function(p,g){var b=wr();return yi===null?zk(b,p,g):$X(b,yi.memoizedState,p,g)},useTransition:function(){var p=mx(bh)[0],g=wr().memoizedState;return[typeof p=="boolean"?p:l0(p),g]},useSyncExternalStore:qE,useId:GX,useHostTransitionStatus:Bk,useFormState:MX,useActionState:MX,useOptimistic:function(p,g){var b=wr();return yi!==null?fx(b,yi,p,g):(b.baseState=p,[p,b.queue.dispatch])},useMemoCache:u0,useCacheRefresh:BX},yx=null,JE=0;function II(p){var g=JE;return JE+=1,yx===null&&(yx=[]),F(yx,p,g)}function e2(p,g){g=g.props.ref,p.ref=g!==void 0?g:null}function DI(p,g){throw g.$$typeof===h?Error(s(525)):(p=Object.prototype.toString.call(g),Error(s(31,p==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":p)))}function WX(p){var g=p._init;return g(p._payload)}function ZX(p){function g(Ie,xe){if(p){var Fe=Ie.deletions;Fe===null?(Ie.deletions=[xe],Ie.flags|=16):Fe.push(xe)}}function b(Ie,xe){if(!p)return null;for(;xe!==null;)g(Ie,xe),xe=xe.sibling;return null}function P(Ie){for(var xe=new Map;Ie!==null;)Ie.key!==null?xe.set(Ie.key,Ie):xe.set(Ie.index,Ie),Ie=Ie.sibling;return xe}function R(Ie,xe){return Ie=ph(Ie,xe),Ie.index=0,Ie.sibling=null,Ie}function k(Ie,xe,Fe){return Ie.index=Fe,p?(Fe=Ie.alternate,Fe!==null?(Fe=Fe.index,Fe<xe?(Ie.flags|=67108866,xe):Fe):(Ie.flags|=67108866,xe)):(Ie.flags|=1048576,xe)}function Z(Ie){return p&&Ie.alternate===null&&(Ie.flags|=67108866),Ie}function ie(Ie,xe,Fe,at){return xe===null||xe.tag!==6?(xe=cg(Fe,Ie.mode,at),xe.return=Ie,xe):(xe=R(xe,Fe),xe.return=Ie,xe)}function pe(Ie,xe,Fe,at){var ni=Fe.type;return ni===f?rt(Ie,xe,Fe.props.children,at,Fe.key):xe!==null&&(xe.elementType===ni||typeof ni=="object"&&ni!==null&&ni.$$typeof===L&&WX(ni)===xe.type)?(xe=R(xe,Fe.props),e2(xe,Fe),xe.return=Ie,xe):(xe=ax(Fe.type,Fe.key,Fe.props,null,Ie.mode,at),e2(xe,Fe),xe.return=Ie,xe)}function Ue(Ie,xe,Fe,at){return xe===null||xe.tag!==4||xe.stateNode.containerInfo!==Fe.containerInfo||xe.stateNode.implementation!==Fe.implementation?(xe=OE(Fe,Ie.mode,at),xe.return=Ie,xe):(xe=R(xe,Fe.children||[]),xe.return=Ie,xe)}function rt(Ie,xe,Fe,at,ni){return xe===null||xe.tag!==7?(xe=fh(Fe,Ie.mode,at,ni),xe.return=Ie,xe):(xe=R(xe,Fe),xe.return=Ie,xe)}function ut(Ie,xe,Fe){if(typeof xe=="string"&&xe!==""||typeof xe=="number"||typeof xe=="bigint")return xe=cg(""+xe,Ie.mode,Fe),xe.return=Ie,xe;if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case d:return Fe=ax(xe.type,xe.key,xe.props,null,Ie.mode,Fe),e2(Fe,xe),Fe.return=Ie,Fe;case m:return xe=OE(xe,Ie.mode,Fe),xe.return=Ie,xe;case L:var at=xe._init;return xe=at(xe._payload),ut(Ie,xe,Fe)}if(H(xe)||$(xe))return xe=fh(xe,Ie.mode,Fe,null),xe.return=Ie,xe;if(typeof xe.then=="function")return ut(Ie,II(xe),Fe);if(xe.$$typeof===T)return ut(Ie,r0(Ie,xe),Fe);DI(Ie,xe)}return null}function qe(Ie,xe,Fe,at){var ni=xe!==null?xe.key:null;if(typeof Fe=="string"&&Fe!==""||typeof Fe=="number"||typeof Fe=="bigint")return ni!==null?null:ie(Ie,xe,""+Fe,at);if(typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case d:return Fe.key===ni?pe(Ie,xe,Fe,at):null;case m:return Fe.key===ni?Ue(Ie,xe,Fe,at):null;case L:return ni=Fe._init,Fe=ni(Fe._payload),qe(Ie,xe,Fe,at)}if(H(Fe)||$(Fe))return ni!==null?null:rt(Ie,xe,Fe,at,null);if(typeof Fe.then=="function")return qe(Ie,xe,II(Fe),at);if(Fe.$$typeof===T)return qe(Ie,xe,r0(Ie,Fe),at);DI(Ie,Fe)}return null}function Xe(Ie,xe,Fe,at,ni){if(typeof at=="string"&&at!==""||typeof at=="number"||typeof at=="bigint")return Ie=Ie.get(Fe)||null,ie(xe,Ie,""+at,ni);if(typeof at=="object"&&at!==null){switch(at.$$typeof){case d:return Ie=Ie.get(at.key===null?Fe:at.key)||null,pe(xe,Ie,at,ni);case m:return Ie=Ie.get(at.key===null?Fe:at.key)||null,Ue(xe,Ie,at,ni);case L:var ws=at._init;return at=ws(at._payload),Xe(Ie,xe,Fe,at,ni)}if(H(at)||$(at))return Ie=Ie.get(Fe)||null,rt(xe,Ie,at,ni,null);if(typeof at.then=="function")return Xe(Ie,xe,Fe,II(at),ni);if(at.$$typeof===T)return Xe(Ie,xe,Fe,r0(xe,at),ni);DI(xe,at)}return null}function ji(Ie,xe,Fe,at){for(var ni=null,ws=null,vi=xe,Fi=xe=0,Ho=null;vi!==null&&Fi<Fe.length;Fi++){vi.index>Fi?(Ho=vi,vi=null):Ho=vi.sibling;var Ys=qe(Ie,vi,Fe[Fi],at);if(Ys===null){vi===null&&(vi=Ho);break}p&&vi&&Ys.alternate===null&&g(Ie,vi),xe=k(Ys,xe,Fi),ws===null?ni=Ys:ws.sibling=Ys,ws=Ys,vi=Ho}if(Fi===Fe.length)return b(Ie,vi),ks&&cp(Ie,Fi),ni;if(vi===null){for(;Fi<Fe.length;Fi++)vi=ut(Ie,Fe[Fi],at),vi!==null&&(xe=k(vi,xe,Fi),ws===null?ni=vi:ws.sibling=vi,ws=vi);return ks&&cp(Ie,Fi),ni}for(vi=P(vi);Fi<Fe.length;Fi++)Ho=Xe(vi,Ie,Fi,Fe[Fi],at),Ho!==null&&(p&&Ho.alternate!==null&&vi.delete(Ho.key===null?Fi:Ho.key),xe=k(Ho,xe,Fi),ws===null?ni=Ho:ws.sibling=Ho,ws=Ho);return p&&vi.forEach(function(Rg){return g(Ie,Rg)}),ks&&cp(Ie,Fi),ni}function Ni(Ie,xe,Fe,at){if(Fe==null)throw Error(s(151));for(var ni=null,ws=null,vi=xe,Fi=xe=0,Ho=null,Ys=Fe.next();vi!==null&&!Ys.done;Fi++,Ys=Fe.next()){vi.index>Fi?(Ho=vi,vi=null):Ho=vi.sibling;var Rg=qe(Ie,vi,Ys.value,at);if(Rg===null){vi===null&&(vi=Ho);break}p&&vi&&Rg.alternate===null&&g(Ie,vi),xe=k(Rg,xe,Fi),ws===null?ni=Rg:ws.sibling=Rg,ws=Rg,vi=Ho}if(Ys.done)return b(Ie,vi),ks&&cp(Ie,Fi),ni;if(vi===null){for(;!Ys.done;Fi++,Ys=Fe.next())Ys=ut(Ie,Ys.value,at),Ys!==null&&(xe=k(Ys,xe,Fi),ws===null?ni=Ys:ws.sibling=Ys,ws=Ys);return ks&&cp(Ie,Fi),ni}for(vi=P(vi);!Ys.done;Fi++,Ys=Fe.next())Ys=Xe(vi,Ie,Fi,Ys.value,at),Ys!==null&&(p&&Ys.alternate!==null&&vi.delete(Ys.key===null?Fi:Ys.key),xe=k(Ys,xe,Fi),ws===null?ni=Ys:ws.sibling=Ys,ws=Ys);return p&&vi.forEach(function(qSe){return g(Ie,qSe)}),ks&&cp(Ie,Fi),ni}function Cn(Ie,xe,Fe,at){if(typeof Fe=="object"&&Fe!==null&&Fe.type===f&&Fe.key===null&&(Fe=Fe.props.children),typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case d:e:{for(var ni=Fe.key;xe!==null;){if(xe.key===ni){if(ni=Fe.type,ni===f){if(xe.tag===7){b(Ie,xe.sibling),at=R(xe,Fe.props.children),at.return=Ie,Ie=at;break e}}else if(xe.elementType===ni||typeof ni=="object"&&ni!==null&&ni.$$typeof===L&&WX(ni)===xe.type){b(Ie,xe.sibling),at=R(xe,Fe.props),e2(at,Fe),at.return=Ie,Ie=at;break e}b(Ie,xe);break}else g(Ie,xe);xe=xe.sibling}Fe.type===f?(at=fh(Fe.props.children,Ie.mode,at,Fe.key),at.return=Ie,Ie=at):(at=ax(Fe.type,Fe.key,Fe.props,null,Ie.mode,at),e2(at,Fe),at.return=Ie,Ie=at)}return Z(Ie);case m:e:{for(ni=Fe.key;xe!==null;){if(xe.key===ni)if(xe.tag===4&&xe.stateNode.containerInfo===Fe.containerInfo&&xe.stateNode.implementation===Fe.implementation){b(Ie,xe.sibling),at=R(xe,Fe.children||[]),at.return=Ie,Ie=at;break e}else{b(Ie,xe);break}else g(Ie,xe);xe=xe.sibling}at=OE(Fe,Ie.mode,at),at.return=Ie,Ie=at}return Z(Ie);case L:return ni=Fe._init,Fe=ni(Fe._payload),Cn(Ie,xe,Fe,at)}if(H(Fe))return ji(Ie,xe,Fe,at);if($(Fe)){if(ni=$(Fe),typeof ni!="function")throw Error(s(150));return Fe=ni.call(Fe),Ni(Ie,xe,Fe,at)}if(typeof Fe.then=="function")return Cn(Ie,xe,II(Fe),at);if(Fe.$$typeof===T)return Cn(Ie,xe,r0(Ie,Fe),at);DI(Ie,Fe)}return typeof Fe=="string"&&Fe!==""||typeof Fe=="number"||typeof Fe=="bigint"?(Fe=""+Fe,xe!==null&&xe.tag===6?(b(Ie,xe.sibling),at=R(xe,Fe),at.return=Ie,Ie=at):(b(Ie,xe),at=cg(Fe,Ie.mode,at),at.return=Ie,Ie=at),Z(Ie)):b(Ie,xe)}return function(Ie,xe,Fe,at){try{JE=0;var ni=Cn(Ie,xe,Fe,at);return yx=null,ni}catch(vi){if(vi===Ud||vi===hx)throw vi;var ws=gl(29,vi,null,Ie.mode);return ws.lanes=at,ws.return=Ie,ws}finally{}}}var vx=ZX(!0),KX=ZX(!1),Sc=oe(null),Gd=null;function yg(p){var g=p.alternate;Ye(Eo,Eo.current&1),Ye(Sc,p),Gd===null&&(g===null||Ds.current!==null||g.memoizedState!==null)&&(Gd=p)}function QX(p){if(p.tag===22){if(Ye(Eo,Eo.current),Ye(Sc,p),Gd===null){var g=p.alternate;g!==null&&g.memoizedState!==null&&(Gd=p)}}else vg()}function vg(){Ye(Eo,Eo.current),Ye(Sc,Sc.current)}function fp(p){ve(Sc),Gd===p&&(Gd=null),ve(Eo)}var Eo=oe(0);function NI(p){for(var g=p;g!==null;){if(g.tag===13){var b=g.memoizedState;if(b!==null&&(b=b.dehydrated,b===null||b.data==="$?"||O$(b)))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}function Hk(p,g,b,P){g=p.memoizedState,b=b(P,g),b=b==null?g:c({},g,b),p.memoizedState=b,p.lanes===0&&(p.updateQueue.baseState=b)}var jk={enqueueSetState:function(p,g,b){p=p._reactInternals;var P=ku(),R=vt(P);R.payload=g,b!=null&&(R.callback=b),g=Ft(p,R,P),g!==null&&($u(g,p,P),Ht(g,p,P))},enqueueReplaceState:function(p,g,b){p=p._reactInternals;var P=ku(),R=vt(P);R.tag=1,R.payload=g,b!=null&&(R.callback=b),g=Ft(p,R,P),g!==null&&($u(g,p,P),Ht(g,p,P))},enqueueForceUpdate:function(p,g){p=p._reactInternals;var b=ku(),P=vt(b);P.tag=2,g!=null&&(P.callback=g),g=Ft(p,P,b),g!==null&&($u(g,p,b),Ht(g,p,b))}};function JX(p,g,b,P,R,k,Z){return p=p.stateNode,typeof p.shouldComponentUpdate=="function"?p.shouldComponentUpdate(P,k,Z):g.prototype&&g.prototype.isPureReactComponent?!np(b,P)||!np(R,k):!0}function eW(p,g,b,P){p=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(b,P),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(b,P),g.state!==p&&jk.enqueueReplaceState(g,g.state,null)}function d0(p,g){var b=g;if("ref"in g){b={};for(var P in g)P!=="ref"&&(b[P]=g[P])}if(p=p.defaultProps){b===g&&(b=c({},b));for(var R in p)b[R]===void 0&&(b[R]=p[R])}return b}var RI=typeof reportError=="function"?reportError:function(p){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var g=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof p=="object"&&p!==null&&typeof p.message=="string"?String(p.message):String(p),error:p});if(!window.dispatchEvent(g))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",p);return}console.error(p)};function tW(p){RI(p)}function iW(p){console.error(p)}function sW(p){RI(p)}function OI(p,g){try{var b=p.onUncaughtError;b(g.value,{componentStack:g.stack})}catch(P){setTimeout(function(){throw P})}}function nW(p,g,b){try{var P=p.onCaughtError;P(b.value,{componentStack:b.stack,errorBoundary:g.tag===1?g.stateNode:null})}catch(R){setTimeout(function(){throw R})}}function Yk(p,g,b){return b=vt(b),b.tag=3,b.payload={element:null},b.callback=function(){OI(p,g)},b}function rW(p){return p=vt(p),p.tag=3,p}function oW(p,g,b,P){var R=b.type.getDerivedStateFromError;if(typeof R=="function"){var k=P.value;p.payload=function(){return R(k)},p.callback=function(){nW(g,b,P)}}var Z=b.stateNode;Z!==null&&typeof Z.componentDidCatch=="function"&&(p.callback=function(){nW(g,b,P),typeof R!="function"&&(Cg===null?Cg=new Set([this]):Cg.add(this));var ie=P.stack;this.componentDidCatch(P.value,{componentStack:ie!==null?ie:""})})}function qwe(p,g,b,P,R){if(b.flags|=32768,P!==null&&typeof P=="object"&&typeof P.then=="function"){if(g=b.alternate,g!==null&&mg(g,b,R,!0),b=Sc.current,b!==null){switch(b.tag){case 13:return Gd===null?_$():b.alternate===null&&Rr===0&&(Rr=3),b.flags&=-257,b.flags|=65536,b.lanes=R,P===GE?b.flags|=16384:(g=b.updateQueue,g===null?b.updateQueue=new Set([P]):g.add(P),v$(p,P,R)),!1;case 22:return b.flags|=65536,P===GE?b.flags|=16384:(g=b.updateQueue,g===null?(g={transitions:null,markerInstances:null,retryQueue:new Set([P])},b.updateQueue=g):(b=g.retryQueue,b===null?g.retryQueue=new Set([P]):b.add(P)),v$(p,P,R)),!1}throw Error(s(435,b.tag))}return v$(p,P,R),_$(),!1}if(ks)return g=Sc.current,g!==null?((g.flags&65536)===0&&(g.flags|=256),g.flags|=65536,g.lanes=R,P!==i0&&(p=Error(s(422),{cause:P}),n0(pl(p,b)))):(P!==i0&&(g=Error(s(423),{cause:P}),n0(pl(g,b))),p=p.current.alternate,p.flags|=65536,R&=-R,p.lanes|=R,P=pl(P,b),R=Yk(p.stateNode,P,R),Ot(p,R),Rr!==4&&(Rr=2)),!1;var k=Error(s(520),{cause:P});if(k=pl(k,b),a2===null?a2=[k]:a2.push(k),Rr!==4&&(Rr=2),g===null)return!0;P=pl(P,b),b=g;do{switch(b.tag){case 3:return b.flags|=65536,p=R&-R,b.lanes|=p,p=Yk(b.stateNode,P,p),Ot(b,p),!1;case 1:if(g=b.type,k=b.stateNode,(b.flags&128)===0&&(typeof g.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Cg===null||!Cg.has(k))))return b.flags|=65536,R&=-R,b.lanes|=R,R=rW(R),oW(R,p,b,P),Ot(b,R),!1}b=b.return}while(b!==null);return!1}var aW=Error(s(461)),Bo=!1;function ya(p,g,b,P){g.child=p===null?KX(g,null,b,P):vx(g,p.child,b,P)}function lW(p,g,b,P,R){b=b.render;var k=g.ref;if("ref"in P){var Z={};for(var ie in P)ie!=="ref"&&(Z[ie]=P[ie])}else Z=P;return kd(g),P=Vd(p,g,b,Z,k,R),ie=$a(),p!==null&&!Bo?(wc(p,g,R),gp(p,g,R)):(ks&&ie&&LE(g),g.flags|=1,ya(p,g,P,R),g.child)}function uW(p,g,b,P,R){if(p===null){var k=b.type;return typeof k=="function"&&!RE(k)&&k.defaultProps===void 0&&b.compare===null?(g.tag=15,g.type=k,cW(p,g,k,P,R)):(p=ax(b.type,null,P,g,g.mode,R),p.ref=g.ref,p.return=g,g.child=p)}if(k=p.child,!t$(p,R)){var Z=k.memoizedProps;if(b=b.compare,b=b!==null?b:np,b(Z,P)&&p.ref===g.ref)return gp(p,g,R)}return g.flags|=1,p=ph(k,P),p.ref=g.ref,p.return=g,g.child=p}function cW(p,g,b,P,R){if(p!==null){var k=p.memoizedProps;if(np(k,P)&&p.ref===g.ref)if(Bo=!1,g.pendingProps=P=k,t$(p,R))(p.flags&131072)!==0&&(Bo=!0);else return g.lanes=p.lanes,gp(p,g,R)}return Xk(p,g,b,P,R)}function hW(p,g,b){var P=g.pendingProps,R=P.children,k=p!==null?p.memoizedState:null;if(P.mode==="hidden"){if((g.flags&128)!==0){if(P=k!==null?k.baseLanes|b:b,p!==null){for(R=g.child=p.child,k=0;R!==null;)k=k|R.lanes|R.childLanes,R=R.sibling;g.childLanes=k&~P}else g.childLanes=0,g.child=null;return dW(p,g,P,b)}if((b&536870912)!==0)g.memoizedState={baseLanes:0,cachePool:null},p!==null&&cx(g,k!==null?k.cachePool:null),k!==null?ls(g,k):Ns(),QX(g);else return g.lanes=g.childLanes=536870912,dW(p,g,k!==null?k.baseLanes|b:b,b)}else k!==null?(cx(g,k.cachePool),ls(g,k),vg(),g.memoizedState=null):(p!==null&&cx(g,null),Ns(),vg());return ya(p,g,R,b),g.child}function dW(p,g,b,P){var R=VE();return R=R===null?null:{parent:br._currentValue,pool:R},g.memoizedState={baseLanes:b,cachePool:R},p!==null&&cx(g,null),Ns(),QX(g),p!==null&&mg(p,g,P,!0),null}function LI(p,g){var b=g.ref;if(b===null)p!==null&&p.ref!==null&&(g.flags|=4194816);else{if(typeof b!="function"&&typeof b!="object")throw Error(s(284));(p===null||p.ref!==b)&&(g.flags|=4194816)}}function Xk(p,g,b,P,R){return kd(g),b=Vd(p,g,b,P,void 0,R),P=$a(),p!==null&&!Bo?(wc(p,g,R),gp(p,g,R)):(ks&&P&&LE(g),g.flags|=1,ya(p,g,b,R),g.child)}function mW(p,g,b,P,R,k){return kd(g),g.updateQueue=null,b=mn(g,P,b,R),qr(p),P=$a(),p!==null&&!Bo?(wc(p,g,k),gp(p,g,k)):(ks&&P&&LE(g),g.flags|=1,ya(p,g,b,k),g.child)}function pW(p,g,b,P,R){if(kd(g),g.stateNode===null){var k=ug,Z=b.contextType;typeof Z=="object"&&Z!==null&&(k=so(Z)),k=new b(P,k),g.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,k.updater=jk,g.stateNode=k,k._reactInternals=g,k=g.stateNode,k.props=P,k.state=g.memoizedState,k.refs={},Ke(g),Z=b.contextType,k.context=typeof Z=="object"&&Z!==null?so(Z):ug,k.state=g.memoizedState,Z=b.getDerivedStateFromProps,typeof Z=="function"&&(Hk(g,b,Z,P),k.state=g.memoizedState),typeof b.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(Z=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),Z!==k.state&&jk.enqueueReplaceState(k,k.state,null),Oi(g,P,k,R),Si(),k.state=g.memoizedState),typeof k.componentDidMount=="function"&&(g.flags|=4194308),P=!0}else if(p===null){k=g.stateNode;var ie=g.memoizedProps,pe=d0(b,ie);k.props=pe;var Ue=k.context,rt=b.contextType;Z=ug,typeof rt=="object"&&rt!==null&&(Z=so(rt));var ut=b.getDerivedStateFromProps;rt=typeof ut=="function"||typeof k.getSnapshotBeforeUpdate=="function",ie=g.pendingProps!==ie,rt||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(ie||Ue!==Z)&&eW(g,k,P,Z),Pe=!1;var qe=g.memoizedState;k.state=qe,Oi(g,P,k,R),Si(),Ue=g.memoizedState,ie||qe!==Ue||Pe?(typeof ut=="function"&&(Hk(g,b,ut,P),Ue=g.memoizedState),(pe=Pe||JX(g,b,pe,P,qe,Ue,Z))?(rt||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(g.flags|=4194308)):(typeof k.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=P,g.memoizedState=Ue),k.props=P,k.state=Ue,k.context=Z,P=pe):(typeof k.componentDidMount=="function"&&(g.flags|=4194308),P=!1)}else{k=g.stateNode,lt(p,g),Z=g.memoizedProps,rt=d0(b,Z),k.props=rt,ut=g.pendingProps,qe=k.context,Ue=b.contextType,pe=ug,typeof Ue=="object"&&Ue!==null&&(pe=so(Ue)),ie=b.getDerivedStateFromProps,(Ue=typeof ie=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(Z!==ut||qe!==pe)&&eW(g,k,P,pe),Pe=!1,qe=g.memoizedState,k.state=qe,Oi(g,P,k,R),Si();var Xe=g.memoizedState;Z!==ut||qe!==Xe||Pe||p!==null&&p.dependencies!==null&&lx(p.dependencies)?(typeof ie=="function"&&(Hk(g,b,ie,P),Xe=g.memoizedState),(rt=Pe||JX(g,b,rt,P,qe,Xe,pe)||p!==null&&p.dependencies!==null&&lx(p.dependencies))?(Ue||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(P,Xe,pe),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(P,Xe,pe)),typeof k.componentDidUpdate=="function"&&(g.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof k.componentDidUpdate!="function"||Z===p.memoizedProps&&qe===p.memoizedState||(g.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||Z===p.memoizedProps&&qe===p.memoizedState||(g.flags|=1024),g.memoizedProps=P,g.memoizedState=Xe),k.props=P,k.state=Xe,k.context=pe,P=rt):(typeof k.componentDidUpdate!="function"||Z===p.memoizedProps&&qe===p.memoizedState||(g.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||Z===p.memoizedProps&&qe===p.memoizedState||(g.flags|=1024),P=!1)}return k=P,LI(p,g),P=(g.flags&128)!==0,k||P?(k=g.stateNode,b=P&&typeof b.getDerivedStateFromError!="function"?null:k.render(),g.flags|=1,p!==null&&P?(g.child=vx(g,p.child,null,R),g.child=vx(g,null,b,R)):ya(p,g,b,R),g.memoizedState=k.state,p=g.child):p=gp(p,g,R),p}function fW(p,g,b,P){return _h(),g.flags|=256,ya(p,g,b,P),g.child}var Wk={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Zk(p){return{baseLanes:p,cachePool:zE()}}function Kk(p,g,b){return p=p!==null?p.childLanes&~b:0,g&&(p|=Ec),p}function gW(p,g,b){var P=g.pendingProps,R=!1,k=(g.flags&128)!==0,Z;if((Z=k)||(Z=p!==null&&p.memoizedState===null?!1:(Eo.current&2)!==0),Z&&(R=!0,g.flags&=-129),Z=(g.flags&32)!==0,g.flags&=-33,p===null){if(ks){if(R?yg(g):vg(),ks){var ie=ar,pe;if(pe=ie){e:{for(pe=ie,ie=fa;pe.nodeType!==8;){if(!ie){ie=null;break e}if(pe=Sh(pe.nextSibling),pe===null){ie=null;break e}}ie=pe}ie!==null?(g.memoizedState={dehydrated:ie,treeContext:up!==null?{id:pa,overflow:gh}:null,retryLane:536870912,hydrationErrors:null},pe=gl(18,null,null,0),pe.stateNode=ie,pe.return=g,g.child=pe,bo=g,ar=null,pe=!0):pe=!1}pe||Od(g)}if(ie=g.memoizedState,ie!==null&&(ie=ie.dehydrated,ie!==null))return O$(ie)?g.lanes=32:g.lanes=536870912,null;fp(g)}return ie=P.children,P=P.fallback,R?(vg(),R=g.mode,ie=FI({mode:"hidden",children:ie},R),P=fh(P,R,b,null),ie.return=g,P.return=g,ie.sibling=P,g.child=ie,R=g.child,R.memoizedState=Zk(b),R.childLanes=Kk(p,Z,b),g.memoizedState=Wk,P):(yg(g),Qk(g,ie))}if(pe=p.memoizedState,pe!==null&&(ie=pe.dehydrated,ie!==null)){if(k)g.flags&256?(yg(g),g.flags&=-257,g=Jk(p,g,b)):g.memoizedState!==null?(vg(),g.child=p.child,g.flags|=128,g=null):(vg(),R=P.fallback,ie=g.mode,P=FI({mode:"visible",children:P.children},ie),R=fh(R,ie,b,null),R.flags|=2,P.return=g,R.return=g,P.sibling=R,g.child=P,vx(g,p.child,null,b),P=g.child,P.memoizedState=Zk(b),P.childLanes=Kk(p,Z,b),g.memoizedState=Wk,g=R);else if(yg(g),O$(ie)){if(Z=ie.nextSibling&&ie.nextSibling.dataset,Z)var Ue=Z.dgst;Z=Ue,P=Error(s(419)),P.stack="",P.digest=Z,n0({value:P,source:null,stack:null}),g=Jk(p,g,b)}else if(Bo||mg(p,g,b,!1),Z=(b&p.childLanes)!==0,Bo||Z){if(Z=qn,Z!==null&&(P=b&-b,P=(P&42)!==0?1:hn(P),P=(P&(Z.suspendedLanes|b))!==0?0:P,P!==0&&P!==pe.retryLane))throw pe.retryLane=P,ka(p,P),$u(Z,p,P),aW;ie.data==="$?"||_$(),g=Jk(p,g,b)}else ie.data==="$?"?(g.flags|=192,g.child=p.child,g=null):(p=pe.treeContext,ar=Sh(ie.nextSibling),bo=g,ks=!0,hp=null,fa=!1,p!==null&&(Hl[jl++]=pa,Hl[jl++]=gh,Hl[jl++]=up,pa=p.id,gh=p.overflow,up=g),g=Qk(g,P.children),g.flags|=4096);return g}return R?(vg(),R=P.fallback,ie=g.mode,pe=p.child,Ue=pe.sibling,P=ph(pe,{mode:"hidden",children:P.children}),P.subtreeFlags=pe.subtreeFlags&65011712,Ue!==null?R=ph(Ue,R):(R=fh(R,ie,b,null),R.flags|=2),R.return=g,P.return=g,P.sibling=R,g.child=P,P=R,R=g.child,ie=p.child.memoizedState,ie===null?ie=Zk(b):(pe=ie.cachePool,pe!==null?(Ue=br._currentValue,pe=pe.parent!==Ue?{parent:Ue,pool:Ue}:pe):pe=zE(),ie={baseLanes:ie.baseLanes|b,cachePool:pe}),R.memoizedState=ie,R.childLanes=Kk(p,Z,b),g.memoizedState=Wk,P):(yg(g),b=p.child,p=b.sibling,b=ph(b,{mode:"visible",children:P.children}),b.return=g,b.sibling=null,p!==null&&(Z=g.deletions,Z===null?(g.deletions=[p],g.flags|=16):Z.push(p)),g.child=b,g.memoizedState=null,b)}function Qk(p,g){return g=FI({mode:"visible",children:g},p.mode),g.return=p,p.child=g}function FI(p,g){return p=gl(22,p,null,g),p.lanes=0,p.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},p}function Jk(p,g,b){return vx(g,p.child,null,b),p=Qk(g,g.pendingProps.children),p.flags|=2,g.memoizedState=null,p}function _W(p,g,b){p.lanes|=g;var P=p.alternate;P!==null&&(P.lanes|=g),kE(p.return,g,b)}function e$(p,g,b,P,R){var k=p.memoizedState;k===null?p.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:P,tail:b,tailMode:R}:(k.isBackwards=g,k.rendering=null,k.renderingStartTime=0,k.last=P,k.tail=b,k.tailMode=R)}function yW(p,g,b){var P=g.pendingProps,R=P.revealOrder,k=P.tail;if(ya(p,g,P.children,b),P=Eo.current,(P&2)!==0)P=P&1|2,g.flags|=128;else{if(p!==null&&(p.flags&128)!==0)e:for(p=g.child;p!==null;){if(p.tag===13)p.memoizedState!==null&&_W(p,b,g);else if(p.tag===19)_W(p,b,g);else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===g)break e;for(;p.sibling===null;){if(p.return===null||p.return===g)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}P&=1}switch(Ye(Eo,P),R){case"forwards":for(b=g.child,R=null;b!==null;)p=b.alternate,p!==null&&NI(p)===null&&(R=b),b=b.sibling;b=R,b===null?(R=g.child,g.child=null):(R=b.sibling,b.sibling=null),e$(g,!1,R,b,k);break;case"backwards":for(b=null,R=g.child,g.child=null;R!==null;){if(p=R.alternate,p!==null&&NI(p)===null){g.child=R;break}p=R.sibling,R.sibling=b,b=R,R=p}e$(g,!0,b,null,k);break;case"together":e$(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function gp(p,g,b){if(p!==null&&(g.dependencies=p.dependencies),Eg|=g.lanes,(b&g.childLanes)===0)if(p!==null){if(mg(p,g,b,!1),(b&g.childLanes)===0)return null}else return null;if(p!==null&&g.child!==p.child)throw Error(s(153));if(g.child!==null){for(p=g.child,b=ph(p,p.pendingProps),g.child=b,b.return=g;p.sibling!==null;)p=p.sibling,b=b.sibling=ph(p,p.pendingProps),b.return=g;b.sibling=null}return g.child}function t$(p,g){return(p.lanes&g)!==0?!0:(p=p.dependencies,!!(p!==null&&lx(p)))}function Hwe(p,g,b){switch(g.tag){case 3:Ee(g,g.stateNode.containerInfo),Fd(g,br,p.memoizedState.cache),_h();break;case 27:case 5:qt(g);break;case 4:Ee(g,g.stateNode.containerInfo);break;case 10:Fd(g,g.type,g.memoizedProps.value);break;case 13:var P=g.memoizedState;if(P!==null)return P.dehydrated!==null?(yg(g),g.flags|=128,null):(b&g.child.childLanes)!==0?gW(p,g,b):(yg(g),p=gp(p,g,b),p!==null?p.sibling:null);yg(g);break;case 19:var R=(p.flags&128)!==0;if(P=(b&g.childLanes)!==0,P||(mg(p,g,b,!1),P=(b&g.childLanes)!==0),R){if(P)return yW(p,g,b);g.flags|=128}if(R=g.memoizedState,R!==null&&(R.rendering=null,R.tail=null,R.lastEffect=null),Ye(Eo,Eo.current),P)break;return null;case 22:case 23:return g.lanes=0,hW(p,g,b);case 24:Fd(g,br,p.memoizedState.cache)}return gp(p,g,b)}function vW(p,g,b){if(p!==null)if(p.memoizedProps!==g.pendingProps)Bo=!0;else{if(!t$(p,b)&&(g.flags&128)===0)return Bo=!1,Hwe(p,g,b);Bo=(p.flags&131072)!==0}else Bo=!1,ks&&(g.flags&1048576)!==0&&fI(g,hg,g.index);switch(g.lanes=0,g.tag){case 16:e:{p=g.pendingProps;var P=g.elementType,R=P._init;if(P=R(P._payload),g.type=P,typeof P=="function")RE(P)?(p=d0(P,p),g.tag=1,g=pW(null,g,P,p,b)):(g.tag=0,g=Xk(null,g,P,p,b));else{if(P!=null){if(R=P.$$typeof,R===C){g.tag=11,g=lW(null,g,P,p,b);break e}else if(R===I){g.tag=14,g=uW(null,g,P,p,b);break e}}throw g=V(P)||P,Error(s(306,g,""))}}return g;case 0:return Xk(p,g,g.type,g.pendingProps,b);case 1:return P=g.type,R=d0(P,g.pendingProps),pW(p,g,P,R,b);case 3:e:{if(Ee(g,g.stateNode.containerInfo),p===null)throw Error(s(387));P=g.pendingProps;var k=g.memoizedState;R=k.element,lt(p,g),Oi(g,P,null,b);var Z=g.memoizedState;if(P=Z.cache,Fd(g,br,P),P!==k.cache&&$E(g,[br],b,!0),Si(),P=Z.element,k.isDehydrated)if(k={element:P,isDehydrated:!1,cache:Z.cache},g.updateQueue.baseState=k,g.memoizedState=k,g.flags&256){g=fW(p,g,P,b);break e}else if(P!==R){R=pl(Error(s(424)),g),n0(R),g=fW(p,g,P,b);break e}else{switch(p=g.stateNode.containerInfo,p.nodeType){case 9:p=p.body;break;default:p=p.nodeName==="HTML"?p.ownerDocument.body:p}for(ar=Sh(p.firstChild),bo=g,ks=!0,hp=null,fa=!0,b=KX(g,null,P,b),g.child=b;b;)b.flags=b.flags&-3|4096,b=b.sibling}else{if(_h(),P===R){g=gp(p,g,b);break e}ya(p,g,P,b)}g=g.child}return g;case 26:return LI(p,g),p===null?(b=SZ(g.type,null,g.pendingProps,null))?g.memoizedState=b:ks||(b=g.type,p=g.pendingProps,P=ZI(Ne.current).createElement(b),P[Sn]=g,P[Js]=p,xa(P,b,p),ys(P),g.stateNode=P):g.memoizedState=SZ(g.type,p.memoizedProps,g.pendingProps,p.memoizedState),null;case 27:return qt(g),p===null&&ks&&(P=g.stateNode=xZ(g.type,g.pendingProps,Ne.current),bo=g,fa=!0,R=ar,Mg(g.type)?(L$=R,ar=Sh(P.firstChild)):ar=R),ya(p,g,g.pendingProps.children,b),LI(p,g),p===null&&(g.flags|=4194304),g.child;case 5:return p===null&&ks&&((R=P=ar)&&(P=vSe(P,g.type,g.pendingProps,fa),P!==null?(g.stateNode=P,bo=g,ar=Sh(P.firstChild),fa=!1,R=!0):R=!1),R||Od(g)),qt(g),R=g.type,k=g.pendingProps,Z=p!==null?p.memoizedProps:null,P=k.children,D$(R,k)?P=null:Z!==null&&D$(R,Z)&&(g.flags|=32),g.memoizedState!==null&&(R=Vd(p,g,ga,null,null,b),g2._currentValue=R),LI(p,g),ya(p,g,P,b),g.child;case 6:return p===null&&ks&&((p=b=ar)&&(b=xSe(b,g.pendingProps,fa),b!==null?(g.stateNode=b,bo=g,ar=null,p=!0):p=!1),p||Od(g)),null;case 13:return gW(p,g,b);case 4:return Ee(g,g.stateNode.containerInfo),P=g.pendingProps,p===null?g.child=vx(g,null,P,b):ya(p,g,P,b),g.child;case 11:return lW(p,g,g.type,g.pendingProps,b);case 7:return ya(p,g,g.pendingProps,b),g.child;case 8:return ya(p,g,g.pendingProps.children,b),g.child;case 12:return ya(p,g,g.pendingProps.children,b),g.child;case 10:return P=g.pendingProps,Fd(g,g.type,P.value),ya(p,g,P.children,b),g.child;case 9:return R=g.type._context,P=g.pendingProps.children,kd(g),R=so(R),P=P(R),g.flags|=1,ya(p,g,P,b),g.child;case 14:return uW(p,g,g.type,g.pendingProps,b);case 15:return cW(p,g,g.type,g.pendingProps,b);case 19:return yW(p,g,b);case 31:return P=g.pendingProps,b=g.mode,P={mode:P.mode,children:P.children},p===null?(b=FI(P,b),b.ref=g.ref,g.child=b,b.return=g,g=b):(b=ph(p.child,P),b.ref=g.ref,g.child=b,b.return=g,g=b),g;case 22:return hW(p,g,b);case 24:return kd(g),P=so(br),p===null?(R=VE(),R===null&&(R=qn,k=ux(),R.pooledCache=k,k.refCount++,k!==null&&(R.pooledCacheLanes|=b),R=k),g.memoizedState={parent:P,cache:R},Ke(g),Fd(g,br,R)):((p.lanes&b)!==0&&(lt(p,g),Oi(g,null,null,b),Si()),R=p.memoizedState,k=g.memoizedState,R.parent!==P?(R={parent:P,cache:P},g.memoizedState=R,g.lanes===0&&(g.memoizedState=g.updateQueue.baseState=R),Fd(g,br,P)):(P=k.cache,Fd(g,br,P),P!==R.cache&&$E(g,[br],b,!0))),ya(p,g,g.pendingProps.children,b),g.child;case 29:throw g.pendingProps}throw Error(s(156,g.tag))}function _p(p){p.flags|=4}function xW(p,g){if(g.type!=="stylesheet"||(g.state.loading&4)!==0)p.flags&=-16777217;else if(p.flags|=16777216,!MZ(g)){if(g=Sc.current,g!==null&&(($s&4194048)===$s?Gd!==null:($s&62914560)!==$s&&($s&536870912)===0||g!==Gd))throw X=GE,a0;p.flags|=8192}}function kI(p,g){g!==null&&(p.flags|=4),p.flags&16384&&(g=p.tag!==22?Dt():536870912,p.lanes|=g,Sx|=g)}function t2(p,g){if(!ks)switch(p.tailMode){case"hidden":g=p.tail;for(var b=null;g!==null;)g.alternate!==null&&(b=g),g=g.sibling;b===null?p.tail=null:b.sibling=null;break;case"collapsed":b=p.tail;for(var P=null;b!==null;)b.alternate!==null&&(P=b),b=b.sibling;P===null?g||p.tail===null?p.tail=null:p.tail.sibling=null:P.sibling=null}}function Sr(p){var g=p.alternate!==null&&p.alternate.child===p.child,b=0,P=0;if(g)for(var R=p.child;R!==null;)b|=R.lanes|R.childLanes,P|=R.subtreeFlags&65011712,P|=R.flags&65011712,R.return=p,R=R.sibling;else for(R=p.child;R!==null;)b|=R.lanes|R.childLanes,P|=R.subtreeFlags,P|=R.flags,R.return=p,R=R.sibling;return p.subtreeFlags|=P,p.childLanes=b,g}function jwe(p,g,b){var P=g.pendingProps;switch(dg(g),g.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Sr(g),null;case 1:return Sr(g),null;case 3:return b=g.stateNode,P=null,p!==null&&(P=p.memoizedState.cache),g.memoizedState.cache!==P&&(g.flags|=2048),vh(br),Zt(),b.pendingContext&&(b.context=b.pendingContext,b.pendingContext=null),(p===null||p.child===null)&&(s0(g)?_p(g):p===null||p.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,Ld())),Sr(g),null;case 26:return b=g.memoizedState,p===null?(_p(g),b!==null?(Sr(g),xW(g,b)):(Sr(g),g.flags&=-16777217)):b?b!==p.memoizedState?(_p(g),Sr(g),xW(g,b)):(Sr(g),g.flags&=-16777217):(p.memoizedProps!==P&&_p(g),Sr(g),g.flags&=-16777217),null;case 27:Mi(g),b=Ne.current;var R=g.type;if(p!==null&&g.stateNode!=null)p.memoizedProps!==P&&_p(g);else{if(!P){if(g.stateNode===null)throw Error(s(166));return Sr(g),null}p=de.current,s0(g)?gI(g):(p=xZ(R,P,b),g.stateNode=p,_p(g))}return Sr(g),null;case 5:if(Mi(g),b=g.type,p!==null&&g.stateNode!=null)p.memoizedProps!==P&&_p(g);else{if(!P){if(g.stateNode===null)throw Error(s(166));return Sr(g),null}if(p=de.current,s0(g))gI(g);else{switch(R=ZI(Ne.current),p){case 1:p=R.createElementNS("http://www.w3.org/2000/svg",b);break;case 2:p=R.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;default:switch(b){case"svg":p=R.createElementNS("http://www.w3.org/2000/svg",b);break;case"math":p=R.createElementNS("http://www.w3.org/1998/Math/MathML",b);break;case"script":p=R.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof P.is=="string"?R.createElement("select",{is:P.is}):R.createElement("select"),P.multiple?p.multiple=!0:P.size&&(p.size=P.size);break;default:p=typeof P.is=="string"?R.createElement(b,{is:P.is}):R.createElement(b)}}p[Sn]=g,p[Js]=P;e:for(R=g.child;R!==null;){if(R.tag===5||R.tag===6)p.appendChild(R.stateNode);else if(R.tag!==4&&R.tag!==27&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===g)break e;for(;R.sibling===null;){if(R.return===null||R.return===g)break e;R=R.return}R.sibling.return=R.return,R=R.sibling}g.stateNode=p;e:switch(xa(p,b,P),b){case"button":case"input":case"select":case"textarea":p=!!P.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&_p(g)}}return Sr(g),g.flags&=-16777217,null;case 6:if(p&&g.stateNode!=null)p.memoizedProps!==P&&_p(g);else{if(typeof P!="string"&&g.stateNode===null)throw Error(s(166));if(p=Ne.current,s0(g)){if(p=g.stateNode,b=g.memoizedProps,P=null,R=bo,R!==null)switch(R.tag){case 27:case 5:P=R.memoizedProps}p[Sn]=g,p=!!(p.nodeValue===b||P!==null&&P.suppressHydrationWarning===!0||mZ(p.nodeValue,b)),p||Od(g)}else p=ZI(p).createTextNode(P),p[Sn]=g,g.stateNode=p}return Sr(g),null;case 13:if(P=g.memoizedState,p===null||p.memoizedState!==null&&p.memoizedState.dehydrated!==null){if(R=s0(g),P!==null&&P.dehydrated!==null){if(p===null){if(!R)throw Error(s(318));if(R=g.memoizedState,R=R!==null?R.dehydrated:null,!R)throw Error(s(317));R[Sn]=g}else _h(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;Sr(g),R=!1}else R=Ld(),p!==null&&p.memoizedState!==null&&(p.memoizedState.hydrationErrors=R),R=!0;if(!R)return g.flags&256?(fp(g),g):(fp(g),null)}if(fp(g),(g.flags&128)!==0)return g.lanes=b,g;if(b=P!==null,p=p!==null&&p.memoizedState!==null,b){P=g.child,R=null,P.alternate!==null&&P.alternate.memoizedState!==null&&P.alternate.memoizedState.cachePool!==null&&(R=P.alternate.memoizedState.cachePool.pool);var k=null;P.memoizedState!==null&&P.memoizedState.cachePool!==null&&(k=P.memoizedState.cachePool.pool),k!==R&&(P.flags|=2048)}return b!==p&&b&&(g.child.flags|=8192),kI(g,g.updateQueue),Sr(g),null;case 4:return Zt(),p===null&&T$(g.stateNode.containerInfo),Sr(g),null;case 10:return vh(g.type),Sr(g),null;case 19:if(ve(Eo),R=g.memoizedState,R===null)return Sr(g),null;if(P=(g.flags&128)!==0,k=R.rendering,k===null)if(P)t2(R,!1);else{if(Rr!==0||p!==null&&(p.flags&128)!==0)for(p=g.child;p!==null;){if(k=NI(p),k!==null){for(g.flags|=128,t2(R,!1),p=k.updateQueue,g.updateQueue=p,kI(g,p),g.subtreeFlags=0,p=b,b=g.child;b!==null;)pI(b,p),b=b.sibling;return Ye(Eo,Eo.current&1|2),g.child}p=p.sibling}R.tail!==null&&$e()>VI&&(g.flags|=128,P=!0,t2(R,!1),g.lanes=4194304)}else{if(!P)if(p=NI(k),p!==null){if(g.flags|=128,P=!0,p=p.updateQueue,g.updateQueue=p,kI(g,p),t2(R,!0),R.tail===null&&R.tailMode==="hidden"&&!k.alternate&&!ks)return Sr(g),null}else 2*$e()-R.renderingStartTime>VI&&b!==536870912&&(g.flags|=128,P=!0,t2(R,!1),g.lanes=4194304);R.isBackwards?(k.sibling=g.child,g.child=k):(p=R.last,p!==null?p.sibling=k:g.child=k,R.last=k)}return R.tail!==null?(g=R.tail,R.rendering=g,R.tail=g.sibling,R.renderingStartTime=$e(),g.sibling=null,p=Eo.current,Ye(Eo,P?p&1|2:p&1),g):(Sr(g),null);case 22:case 23:return fp(g),is(),P=g.memoizedState!==null,p!==null?p.memoizedState!==null!==P&&(g.flags|=8192):P&&(g.flags|=8192),P?(b&536870912)!==0&&(g.flags&128)===0&&(Sr(g),g.subtreeFlags&6&&(g.flags|=8192)):Sr(g),b=g.updateQueue,b!==null&&kI(g,b.retryQueue),b=null,p!==null&&p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(b=p.memoizedState.cachePool.pool),P=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(P=g.memoizedState.cachePool.pool),P!==b&&(g.flags|=2048),p!==null&&ve(pp),null;case 24:return b=null,p!==null&&(b=p.memoizedState.cache),g.memoizedState.cache!==b&&(g.flags|=2048),vh(br),Sr(g),null;case 25:return null;case 30:return null}throw Error(s(156,g.tag))}function Ywe(p,g){switch(dg(g),g.tag){case 1:return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 3:return vh(br),Zt(),p=g.flags,(p&65536)!==0&&(p&128)===0?(g.flags=p&-65537|128,g):null;case 26:case 27:case 5:return Mi(g),null;case 13:if(fp(g),p=g.memoizedState,p!==null&&p.dehydrated!==null){if(g.alternate===null)throw Error(s(340));_h()}return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 19:return ve(Eo),null;case 4:return Zt(),null;case 10:return vh(g.type),null;case 22:case 23:return fp(g),is(),p!==null&&ve(pp),p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 24:return vh(br),null;case 25:return null;default:return null}}function bW(p,g){switch(dg(g),g.tag){case 3:vh(br),Zt();break;case 26:case 27:case 5:Mi(g);break;case 4:Zt();break;case 13:fp(g);break;case 19:ve(Eo);break;case 10:vh(g.type);break;case 22:case 23:fp(g),is(),p!==null&&ve(pp);break;case 24:vh(br)}}function i2(p,g){try{var b=g.updateQueue,P=b!==null?b.lastEffect:null;if(P!==null){var R=P.next;b=R;do{if((b.tag&p)===p){P=void 0;var k=b.create,Z=b.inst;P=k(),Z.destroy=P}b=b.next}while(b!==R)}}catch(ie){On(g,g.return,ie)}}function xg(p,g,b){try{var P=g.updateQueue,R=P!==null?P.lastEffect:null;if(R!==null){var k=R.next;P=k;do{if((P.tag&p)===p){var Z=P.inst,ie=Z.destroy;if(ie!==void 0){Z.destroy=void 0,R=g;var pe=b,Ue=ie;try{Ue()}catch(rt){On(R,pe,rt)}}}P=P.next}while(P!==k)}}catch(rt){On(g,g.return,rt)}}function wW(p){var g=p.updateQueue;if(g!==null){var b=p.stateNode;try{Xi(g,b)}catch(P){On(p,p.return,P)}}}function SW(p,g,b){b.props=d0(p.type,p.memoizedProps),b.state=p.memoizedState;try{b.componentWillUnmount()}catch(P){On(p,g,P)}}function s2(p,g){try{var b=p.ref;if(b!==null){switch(p.tag){case 26:case 27:case 5:var P=p.stateNode;break;case 30:P=p.stateNode;break;default:P=p.stateNode}typeof b=="function"?p.refCleanup=b(P):b.current=P}}catch(R){On(p,g,R)}}function Bd(p,g){var b=p.ref,P=p.refCleanup;if(b!==null)if(typeof P=="function")try{P()}catch(R){On(p,g,R)}finally{p.refCleanup=null,p=p.alternate,p!=null&&(p.refCleanup=null)}else if(typeof b=="function")try{b(null)}catch(R){On(p,g,R)}else b.current=null}function EW(p){var g=p.type,b=p.memoizedProps,P=p.stateNode;try{e:switch(g){case"button":case"input":case"select":case"textarea":b.autoFocus&&P.focus();break e;case"img":b.src?P.src=b.src:b.srcSet&&(P.srcset=b.srcSet)}}catch(R){On(p,p.return,R)}}function i$(p,g,b){try{var P=p.stateNode;pSe(P,p.type,b,g),P[Js]=g}catch(R){On(p,p.return,R)}}function CW(p){return p.tag===5||p.tag===3||p.tag===26||p.tag===27&&Mg(p.type)||p.tag===4}function s$(p){e:for(;;){for(;p.sibling===null;){if(p.return===null||CW(p.return))return null;p=p.return}for(p.sibling.return=p.return,p=p.sibling;p.tag!==5&&p.tag!==6&&p.tag!==18;){if(p.tag===27&&Mg(p.type)||p.flags&2||p.child===null||p.tag===4)continue e;p.child.return=p,p=p.child}if(!(p.flags&2))return p.stateNode}}function n$(p,g,b){var P=p.tag;if(P===5||P===6)p=p.stateNode,g?(b.nodeType===9?b.body:b.nodeName==="HTML"?b.ownerDocument.body:b).insertBefore(p,g):(g=b.nodeType===9?b.body:b.nodeName==="HTML"?b.ownerDocument.body:b,g.appendChild(p),b=b._reactRootContainer,b!=null||g.onclick!==null||(g.onclick=WI));else if(P!==4&&(P===27&&Mg(p.type)&&(b=p.stateNode,g=null),p=p.child,p!==null))for(n$(p,g,b),p=p.sibling;p!==null;)n$(p,g,b),p=p.sibling}function $I(p,g,b){var P=p.tag;if(P===5||P===6)p=p.stateNode,g?b.insertBefore(p,g):b.appendChild(p);else if(P!==4&&(P===27&&Mg(p.type)&&(b=p.stateNode),p=p.child,p!==null))for($I(p,g,b),p=p.sibling;p!==null;)$I(p,g,b),p=p.sibling}function TW(p){var g=p.stateNode,b=p.memoizedProps;try{for(var P=p.type,R=g.attributes;R.length;)g.removeAttributeNode(R[0]);xa(g,P,b),g[Sn]=p,g[Js]=b}catch(k){On(p,p.return,k)}}var yp=!1,Hr=!1,r$=!1,PW=typeof WeakSet=="function"?WeakSet:Set,qo=null;function Xwe(p,g){if(p=p.containerInfo,A$=iD,p=SE(p),sx(p)){if("selectionStart"in p)var b={start:p.selectionStart,end:p.selectionEnd};else e:{b=(b=p.ownerDocument)&&b.defaultView||window;var P=b.getSelection&&b.getSelection();if(P&&P.rangeCount!==0){b=P.anchorNode;var R=P.anchorOffset,k=P.focusNode;P=P.focusOffset;try{b.nodeType,k.nodeType}catch{b=null;break e}var Z=0,ie=-1,pe=-1,Ue=0,rt=0,ut=p,qe=null;t:for(;;){for(var Xe;ut!==b||R!==0&&ut.nodeType!==3||(ie=Z+R),ut!==k||P!==0&&ut.nodeType!==3||(pe=Z+P),ut.nodeType===3&&(Z+=ut.nodeValue.length),(Xe=ut.firstChild)!==null;)qe=ut,ut=Xe;for(;;){if(ut===p)break t;if(qe===b&&++Ue===R&&(ie=Z),qe===k&&++rt===P&&(pe=Z),(Xe=ut.nextSibling)!==null)break;ut=qe,qe=ut.parentNode}ut=Xe}b=ie===-1||pe===-1?null:{start:ie,end:pe}}else b=null}b=b||{start:0,end:0}}else b=null;for(I$={focusedElem:p,selectionRange:b},iD=!1,qo=g;qo!==null;)if(g=qo,p=g.child,(g.subtreeFlags&1024)!==0&&p!==null)p.return=g,qo=p;else for(;qo!==null;){switch(g=qo,k=g.alternate,p=g.flags,g.tag){case 0:break;case 11:case 15:break;case 1:if((p&1024)!==0&&k!==null){p=void 0,b=g,R=k.memoizedProps,k=k.memoizedState,P=b.stateNode;try{var ji=d0(b.type,R,b.elementType===b.type);p=P.getSnapshotBeforeUpdate(ji,k),P.__reactInternalSnapshotBeforeUpdate=p}catch(Ni){On(b,b.return,Ni)}}break;case 3:if((p&1024)!==0){if(p=g.stateNode.containerInfo,b=p.nodeType,b===9)R$(p);else if(b===1)switch(p.nodeName){case"HEAD":case"HTML":case"BODY":R$(p);break;default:p.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((p&1024)!==0)throw Error(s(163))}if(p=g.sibling,p!==null){p.return=g.return,qo=p;break}qo=g.return}}function MW(p,g,b){var P=b.flags;switch(b.tag){case 0:case 11:case 15:bg(p,b),P&4&&i2(5,b);break;case 1:if(bg(p,b),P&4)if(p=b.stateNode,g===null)try{p.componentDidMount()}catch(Z){On(b,b.return,Z)}else{var R=d0(b.type,g.memoizedProps);g=g.memoizedState;try{p.componentDidUpdate(R,g,p.__reactInternalSnapshotBeforeUpdate)}catch(Z){On(b,b.return,Z)}}P&64&&wW(b),P&512&&s2(b,b.return);break;case 3:if(bg(p,b),P&64&&(p=b.updateQueue,p!==null)){if(g=null,b.child!==null)switch(b.child.tag){case 27:case 5:g=b.child.stateNode;break;case 1:g=b.child.stateNode}try{Xi(p,g)}catch(Z){On(b,b.return,Z)}}break;case 27:g===null&&P&4&&TW(b);case 26:case 5:bg(p,b),g===null&&P&4&&EW(b),P&512&&s2(b,b.return);break;case 12:bg(p,b);break;case 13:bg(p,b),P&4&&DW(p,b),P&64&&(p=b.memoizedState,p!==null&&(p=p.dehydrated,p!==null&&(b=sSe.bind(null,b),bSe(p,b))));break;case 22:if(P=b.memoizedState!==null||yp,!P){g=g!==null&&g.memoizedState!==null||Hr,R=yp;var k=Hr;yp=P,(Hr=g)&&!k?wg(p,b,(b.subtreeFlags&8772)!==0):bg(p,b),yp=R,Hr=k}break;case 30:break;default:bg(p,b)}}function AW(p){var g=p.alternate;g!==null&&(p.alternate=null,AW(g)),p.child=null,p.deletions=null,p.sibling=null,p.tag===5&&(g=p.stateNode,g!==null&&Jr(g)),p.stateNode=null,p.return=null,p.dependencies=null,p.memoizedProps=null,p.memoizedState=null,p.pendingProps=null,p.stateNode=null,p.updateQueue=null}var ur=null,Xl=!1;function vp(p,g,b){for(b=b.child;b!==null;)IW(p,g,b),b=b.sibling}function IW(p,g,b){if(Ct&&typeof Ct.onCommitFiberUnmount=="function")try{Ct.onCommitFiberUnmount(Ze,b)}catch{}switch(b.tag){case 26:Hr||Bd(b,g),vp(p,g,b),b.memoizedState?b.memoizedState.count--:b.stateNode&&(b=b.stateNode,b.parentNode.removeChild(b));break;case 27:Hr||Bd(b,g);var P=ur,R=Xl;Mg(b.type)&&(ur=b.stateNode,Xl=!1),vp(p,g,b),d2(b.stateNode),ur=P,Xl=R;break;case 5:Hr||Bd(b,g);case 6:if(P=ur,R=Xl,ur=null,vp(p,g,b),ur=P,Xl=R,ur!==null)if(Xl)try{(ur.nodeType===9?ur.body:ur.nodeName==="HTML"?ur.ownerDocument.body:ur).removeChild(b.stateNode)}catch(k){On(b,g,k)}else try{ur.removeChild(b.stateNode)}catch(k){On(b,g,k)}break;case 18:ur!==null&&(Xl?(p=ur,yZ(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,b.stateNode),x2(p)):yZ(ur,b.stateNode));break;case 4:P=ur,R=Xl,ur=b.stateNode.containerInfo,Xl=!0,vp(p,g,b),ur=P,Xl=R;break;case 0:case 11:case 14:case 15:Hr||xg(2,b,g),Hr||xg(4,b,g),vp(p,g,b);break;case 1:Hr||(Bd(b,g),P=b.stateNode,typeof P.componentWillUnmount=="function"&&SW(b,g,P)),vp(p,g,b);break;case 21:vp(p,g,b);break;case 22:Hr=(P=Hr)||b.memoizedState!==null,vp(p,g,b),Hr=P;break;default:vp(p,g,b)}}function DW(p,g){if(g.memoizedState===null&&(p=g.alternate,p!==null&&(p=p.memoizedState,p!==null&&(p=p.dehydrated,p!==null))))try{x2(p)}catch(b){On(g,g.return,b)}}function Wwe(p){switch(p.tag){case 13:case 19:var g=p.stateNode;return g===null&&(g=p.stateNode=new PW),g;case 22:return p=p.stateNode,g=p._retryCache,g===null&&(g=p._retryCache=new PW),g;default:throw Error(s(435,p.tag))}}function o$(p,g){var b=Wwe(p);g.forEach(function(P){var R=nSe.bind(null,p,P);b.has(P)||(b.add(P),P.then(R,R))})}function Ou(p,g){var b=g.deletions;if(b!==null)for(var P=0;P<b.length;P++){var R=b[P],k=p,Z=g,ie=Z;e:for(;ie!==null;){switch(ie.tag){case 27:if(Mg(ie.type)){ur=ie.stateNode,Xl=!1;break e}break;case 5:ur=ie.stateNode,Xl=!1;break e;case 3:case 4:ur=ie.stateNode.containerInfo,Xl=!0;break e}ie=ie.return}if(ur===null)throw Error(s(160));IW(k,Z,R),ur=null,Xl=!1,k=R.alternate,k!==null&&(k.return=null),R.return=null}if(g.subtreeFlags&13878)for(g=g.child;g!==null;)NW(g,p),g=g.sibling}var wh=null;function NW(p,g){var b=p.alternate,P=p.flags;switch(p.tag){case 0:case 11:case 14:case 15:Ou(g,p),Lu(p),P&4&&(xg(3,p,p.return),i2(3,p),xg(5,p,p.return));break;case 1:Ou(g,p),Lu(p),P&512&&(Hr||b===null||Bd(b,b.return)),P&64&&yp&&(p=p.updateQueue,p!==null&&(P=p.callbacks,P!==null&&(b=p.shared.hiddenCallbacks,p.shared.hiddenCallbacks=b===null?P:b.concat(P))));break;case 26:var R=wh;if(Ou(g,p),Lu(p),P&512&&(Hr||b===null||Bd(b,b.return)),P&4){var k=b!==null?b.memoizedState:null;if(P=p.memoizedState,b===null)if(P===null)if(p.stateNode===null){e:{P=p.type,b=p.memoizedProps,R=R.ownerDocument||R;t:switch(P){case"title":k=R.getElementsByTagName("title")[0],(!k||k[dl]||k[Sn]||k.namespaceURI==="http://www.w3.org/2000/svg"||k.hasAttribute("itemprop"))&&(k=R.createElement(P),R.head.insertBefore(k,R.querySelector("head > title"))),xa(k,P,b),k[Sn]=p,ys(k),P=k;break e;case"link":var Z=TZ("link","href",R).get(P+(b.href||""));if(Z){for(var ie=0;ie<Z.length;ie++)if(k=Z[ie],k.getAttribute("href")===(b.href==null||b.href===""?null:b.href)&&k.getAttribute("rel")===(b.rel==null?null:b.rel)&&k.getAttribute("title")===(b.title==null?null:b.title)&&k.getAttribute("crossorigin")===(b.crossOrigin==null?null:b.crossOrigin)){Z.splice(ie,1);break t}}k=R.createElement(P),xa(k,P,b),R.head.appendChild(k);break;case"meta":if(Z=TZ("meta","content",R).get(P+(b.content||""))){for(ie=0;ie<Z.length;ie++)if(k=Z[ie],k.getAttribute("content")===(b.content==null?null:""+b.content)&&k.getAttribute("name")===(b.name==null?null:b.name)&&k.getAttribute("property")===(b.property==null?null:b.property)&&k.getAttribute("http-equiv")===(b.httpEquiv==null?null:b.httpEquiv)&&k.getAttribute("charset")===(b.charSet==null?null:b.charSet)){Z.splice(ie,1);break t}}k=R.createElement(P),xa(k,P,b),R.head.appendChild(k);break;default:throw Error(s(468,P))}k[Sn]=p,ys(k),P=k}p.stateNode=P}else PZ(R,p.type,p.stateNode);else p.stateNode=CZ(R,P,p.memoizedProps);else k!==P?(k===null?b.stateNode!==null&&(b=b.stateNode,b.parentNode.removeChild(b)):k.count--,P===null?PZ(R,p.type,p.stateNode):CZ(R,P,p.memoizedProps)):P===null&&p.stateNode!==null&&i$(p,p.memoizedProps,b.memoizedProps)}break;case 27:Ou(g,p),Lu(p),P&512&&(Hr||b===null||Bd(b,b.return)),b!==null&&P&4&&i$(p,p.memoizedProps,b.memoizedProps);break;case 5:if(Ou(g,p),Lu(p),P&512&&(Hr||b===null||Bd(b,b.return)),p.flags&32){R=p.stateNode;try{da(R,"")}catch(Xe){On(p,p.return,Xe)}}P&4&&p.stateNode!=null&&(R=p.memoizedProps,i$(p,R,b!==null?b.memoizedProps:R)),P&1024&&(r$=!0);break;case 6:if(Ou(g,p),Lu(p),P&4){if(p.stateNode===null)throw Error(s(162));P=p.memoizedProps,b=p.stateNode;try{b.nodeValue=P}catch(Xe){On(p,p.return,Xe)}}break;case 3:if(JI=null,R=wh,wh=KI(g.containerInfo),Ou(g,p),wh=R,Lu(p),P&4&&b!==null&&b.memoizedState.isDehydrated)try{x2(g.containerInfo)}catch(Xe){On(p,p.return,Xe)}r$&&(r$=!1,RW(p));break;case 4:P=wh,wh=KI(p.stateNode.containerInfo),Ou(g,p),Lu(p),wh=P;break;case 12:Ou(g,p),Lu(p);break;case 13:Ou(g,p),Lu(p),p.child.flags&8192&&p.memoizedState!==null!=(b!==null&&b.memoizedState!==null)&&(d$=$e()),P&4&&(P=p.updateQueue,P!==null&&(p.updateQueue=null,o$(p,P)));break;case 22:R=p.memoizedState!==null;var pe=b!==null&&b.memoizedState!==null,Ue=yp,rt=Hr;if(yp=Ue||R,Hr=rt||pe,Ou(g,p),Hr=rt,yp=Ue,Lu(p),P&8192)e:for(g=p.stateNode,g._visibility=R?g._visibility&-2:g._visibility|1,R&&(b===null||pe||yp||Hr||m0(p)),b=null,g=p;;){if(g.tag===5||g.tag===26){if(b===null){pe=b=g;try{if(k=pe.stateNode,R)Z=k.style,typeof Z.setProperty=="function"?Z.setProperty("display","none","important"):Z.display="none";else{ie=pe.stateNode;var ut=pe.memoizedProps.style,qe=ut!=null&&ut.hasOwnProperty("display")?ut.display:null;ie.style.display=qe==null||typeof qe=="boolean"?"":(""+qe).trim()}}catch(Xe){On(pe,pe.return,Xe)}}}else if(g.tag===6){if(b===null){pe=g;try{pe.stateNode.nodeValue=R?"":pe.memoizedProps}catch(Xe){On(pe,pe.return,Xe)}}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===p)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break e;for(;g.sibling===null;){if(g.return===null||g.return===p)break e;b===g&&(b=null),g=g.return}b===g&&(b=null),g.sibling.return=g.return,g=g.sibling}P&4&&(P=p.updateQueue,P!==null&&(b=P.retryQueue,b!==null&&(P.retryQueue=null,o$(p,b))));break;case 19:Ou(g,p),Lu(p),P&4&&(P=p.updateQueue,P!==null&&(p.updateQueue=null,o$(p,P)));break;case 30:break;case 21:break;default:Ou(g,p),Lu(p)}}function Lu(p){var g=p.flags;if(g&2){try{for(var b,P=p.return;P!==null;){if(CW(P)){b=P;break}P=P.return}if(b==null)throw Error(s(160));switch(b.tag){case 27:var R=b.stateNode,k=s$(p);$I(p,k,R);break;case 5:var Z=b.stateNode;b.flags&32&&(da(Z,""),b.flags&=-33);var ie=s$(p);$I(p,ie,Z);break;case 3:case 4:var pe=b.stateNode.containerInfo,Ue=s$(p);n$(p,Ue,pe);break;default:throw Error(s(161))}}catch(rt){On(p,p.return,rt)}p.flags&=-3}g&4096&&(p.flags&=-4097)}function RW(p){if(p.subtreeFlags&1024)for(p=p.child;p!==null;){var g=p;RW(g),g.tag===5&&g.flags&1024&&g.stateNode.reset(),p=p.sibling}}function bg(p,g){if(g.subtreeFlags&8772)for(g=g.child;g!==null;)MW(p,g.alternate,g),g=g.sibling}function m0(p){for(p=p.child;p!==null;){var g=p;switch(g.tag){case 0:case 11:case 14:case 15:xg(4,g,g.return),m0(g);break;case 1:Bd(g,g.return);var b=g.stateNode;typeof b.componentWillUnmount=="function"&&SW(g,g.return,b),m0(g);break;case 27:d2(g.stateNode);case 26:case 5:Bd(g,g.return),m0(g);break;case 22:g.memoizedState===null&&m0(g);break;case 30:m0(g);break;default:m0(g)}p=p.sibling}}function wg(p,g,b){for(b=b&&(g.subtreeFlags&8772)!==0,g=g.child;g!==null;){var P=g.alternate,R=p,k=g,Z=k.flags;switch(k.tag){case 0:case 11:case 15:wg(R,k,b),i2(4,k);break;case 1:if(wg(R,k,b),P=k,R=P.stateNode,typeof R.componentDidMount=="function")try{R.componentDidMount()}catch(Ue){On(P,P.return,Ue)}if(P=k,R=P.updateQueue,R!==null){var ie=P.stateNode;try{var pe=R.shared.hiddenCallbacks;if(pe!==null)for(R.shared.hiddenCallbacks=null,R=0;R<pe.length;R++)Vi(pe[R],ie)}catch(Ue){On(P,P.return,Ue)}}b&&Z&64&&wW(k),s2(k,k.return);break;case 27:TW(k);case 26:case 5:wg(R,k,b),b&&P===null&&Z&4&&EW(k),s2(k,k.return);break;case 12:wg(R,k,b);break;case 13:wg(R,k,b),b&&Z&4&&DW(R,k);break;case 22:k.memoizedState===null&&wg(R,k,b),s2(k,k.return);break;case 30:break;default:wg(R,k,b)}g=g.sibling}}function a$(p,g){var b=null;p!==null&&p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(b=p.memoizedState.cachePool.pool),p=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(p=g.memoizedState.cachePool.pool),p!==b&&(p!=null&&p.refCount++,b!=null&&mp(b))}function l$(p,g){p=null,g.alternate!==null&&(p=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==p&&(g.refCount++,p!=null&&mp(p))}function qd(p,g,b,P){if(g.subtreeFlags&10256)for(g=g.child;g!==null;)OW(p,g,b,P),g=g.sibling}function OW(p,g,b,P){var R=g.flags;switch(g.tag){case 0:case 11:case 15:qd(p,g,b,P),R&2048&&i2(9,g);break;case 1:qd(p,g,b,P);break;case 3:qd(p,g,b,P),R&2048&&(p=null,g.alternate!==null&&(p=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==p&&(g.refCount++,p!=null&&mp(p)));break;case 12:if(R&2048){qd(p,g,b,P),p=g.stateNode;try{var k=g.memoizedProps,Z=k.id,ie=k.onPostCommit;typeof ie=="function"&&ie(Z,g.alternate===null?"mount":"update",p.passiveEffectDuration,-0)}catch(pe){On(g,g.return,pe)}}else qd(p,g,b,P);break;case 13:qd(p,g,b,P);break;case 23:break;case 22:k=g.stateNode,Z=g.alternate,g.memoizedState!==null?k._visibility&2?qd(p,g,b,P):n2(p,g):k._visibility&2?qd(p,g,b,P):(k._visibility|=2,xx(p,g,b,P,(g.subtreeFlags&10256)!==0)),R&2048&&a$(Z,g);break;case 24:qd(p,g,b,P),R&2048&&l$(g.alternate,g);break;default:qd(p,g,b,P)}}function xx(p,g,b,P,R){for(R=R&&(g.subtreeFlags&10256)!==0,g=g.child;g!==null;){var k=p,Z=g,ie=b,pe=P,Ue=Z.flags;switch(Z.tag){case 0:case 11:case 15:xx(k,Z,ie,pe,R),i2(8,Z);break;case 23:break;case 22:var rt=Z.stateNode;Z.memoizedState!==null?rt._visibility&2?xx(k,Z,ie,pe,R):n2(k,Z):(rt._visibility|=2,xx(k,Z,ie,pe,R)),R&&Ue&2048&&a$(Z.alternate,Z);break;case 24:xx(k,Z,ie,pe,R),R&&Ue&2048&&l$(Z.alternate,Z);break;default:xx(k,Z,ie,pe,R)}g=g.sibling}}function n2(p,g){if(g.subtreeFlags&10256)for(g=g.child;g!==null;){var b=p,P=g,R=P.flags;switch(P.tag){case 22:n2(b,P),R&2048&&a$(P.alternate,P);break;case 24:n2(b,P),R&2048&&l$(P.alternate,P);break;default:n2(b,P)}g=g.sibling}}var r2=8192;function bx(p){if(p.subtreeFlags&r2)for(p=p.child;p!==null;)LW(p),p=p.sibling}function LW(p){switch(p.tag){case 26:bx(p),p.flags&r2&&p.memoizedState!==null&&OSe(wh,p.memoizedState,p.memoizedProps);break;case 5:bx(p);break;case 3:case 4:var g=wh;wh=KI(p.stateNode.containerInfo),bx(p),wh=g;break;case 22:p.memoizedState===null&&(g=p.alternate,g!==null&&g.memoizedState!==null?(g=r2,r2=16777216,bx(p),r2=g):bx(p));break;default:bx(p)}}function FW(p){var g=p.alternate;if(g!==null&&(p=g.child,p!==null)){g.child=null;do g=p.sibling,p.sibling=null,p=g;while(p!==null)}}function o2(p){var g=p.deletions;if((p.flags&16)!==0){if(g!==null)for(var b=0;b<g.length;b++){var P=g[b];qo=P,$W(P,p)}FW(p)}if(p.subtreeFlags&10256)for(p=p.child;p!==null;)kW(p),p=p.sibling}function kW(p){switch(p.tag){case 0:case 11:case 15:o2(p),p.flags&2048&&xg(9,p,p.return);break;case 3:o2(p);break;case 12:o2(p);break;case 22:var g=p.stateNode;p.memoizedState!==null&&g._visibility&2&&(p.return===null||p.return.tag!==13)?(g._visibility&=-3,UI(p)):o2(p);break;default:o2(p)}}function UI(p){var g=p.deletions;if((p.flags&16)!==0){if(g!==null)for(var b=0;b<g.length;b++){var P=g[b];qo=P,$W(P,p)}FW(p)}for(p=p.child;p!==null;){switch(g=p,g.tag){case 0:case 11:case 15:xg(8,g,g.return),UI(g);break;case 22:b=g.stateNode,b._visibility&2&&(b._visibility&=-3,UI(g));break;default:UI(g)}p=p.sibling}}function $W(p,g){for(;qo!==null;){var b=qo;switch(b.tag){case 0:case 11:case 15:xg(8,b,g);break;case 23:case 22:if(b.memoizedState!==null&&b.memoizedState.cachePool!==null){var P=b.memoizedState.cachePool.pool;P!=null&&P.refCount++}break;case 24:mp(b.memoizedState.cache)}if(P=b.child,P!==null)P.return=b,qo=P;else e:for(b=p;qo!==null;){P=qo;var R=P.sibling,k=P.return;if(AW(P),P===b){qo=null;break e}if(R!==null){R.return=k,qo=R;break e}qo=k}}}var Zwe={getCacheForType:function(p){var g=so(br),b=g.data.get(p);return b===void 0&&(b=p(),g.data.set(p,b)),b}},Kwe=typeof WeakMap=="function"?WeakMap:Map,yn=0,qn=null,Ss=null,$s=0,vn=0,Fu=null,Sg=!1,wx=!1,u$=!1,xp=0,Rr=0,Eg=0,p0=0,c$=0,Ec=0,Sx=0,a2=null,Wl=null,h$=!1,d$=0,VI=1/0,zI=null,Cg=null,va=0,Tg=null,Ex=null,Cx=0,m$=0,p$=null,UW=null,l2=0,f$=null;function ku(){if((yn&2)!==0&&$s!==0)return $s&-$s;if(Y.T!==null){var p=_l;return p!==0?p:w$()}return Ms()}function VW(){Ec===0&&(Ec=($s&536870912)===0||ks?we():536870912);var p=Sc.current;return p!==null&&(p.flags|=32),Ec}function $u(p,g,b){(p===qn&&(vn===2||vn===9)||p.cancelPendingCommit!==null)&&(Tx(p,0),Pg(p,$s,Ec,!1)),ot(p,b),((yn&2)===0||p!==qn)&&(p===qn&&((yn&2)===0&&(p0|=b),Rr===4&&Pg(p,$s,Ec,!1)),Hd(p))}function zW(p,g,b){if((yn&6)!==0)throw Error(s(327));var P=!b&&(g&124)===0&&(g&p.expiredLanes)===0||di(p,g),R=P?eSe(p,g):y$(p,g,!0),k=P;do{if(R===0){wx&&!P&&Pg(p,g,0,!1);break}else{if(b=p.current.alternate,k&&!Qwe(b)){R=y$(p,g,!1),k=!1;continue}if(R===2){if(k=g,p.errorRecoveryDisabledLanes&k)var Z=0;else Z=p.pendingLanes&-536870913,Z=Z!==0?Z:Z&536870912?536870912:0;if(Z!==0){g=Z;e:{var ie=p;R=a2;var pe=ie.current.memoizedState.isDehydrated;if(pe&&(Tx(ie,Z).flags|=256),Z=y$(ie,Z,!1),Z!==2){if(u$&&!pe){ie.errorRecoveryDisabledLanes|=k,p0|=k,R=4;break e}k=Wl,Wl=R,k!==null&&(Wl===null?Wl=k:Wl.push.apply(Wl,k))}R=Z}if(k=!1,R!==2)continue}}if(R===1){Tx(p,0),Pg(p,g,0,!0);break}e:{switch(P=p,k=R,k){case 0:case 1:throw Error(s(345));case 4:if((g&4194048)!==g)break;case 6:Pg(P,g,Ec,!Sg);break e;case 2:Wl=null;break;case 3:case 5:break;default:throw Error(s(329))}if((g&62914560)===g&&(R=d$+300-$e(),10<R)){if(Pg(P,g,Ec,!Sg),Ii(P,0,!0)!==0)break e;P.timeoutHandle=gZ(GW.bind(null,P,b,Wl,zI,h$,g,Ec,p0,Sx,Sg,k,2,-0,0),R);break e}GW(P,b,Wl,zI,h$,g,Ec,p0,Sx,Sg,k,0,-0,0)}}break}while(!0);Hd(p)}function GW(p,g,b,P,R,k,Z,ie,pe,Ue,rt,ut,qe,Xe){if(p.timeoutHandle=-1,ut=g.subtreeFlags,(ut&8192||(ut&16785408)===16785408)&&(f2={stylesheets:null,count:0,unsuspend:RSe},LW(g),ut=LSe(),ut!==null)){p.cancelPendingCommit=ut(WW.bind(null,p,g,k,b,P,R,Z,ie,pe,rt,1,qe,Xe)),Pg(p,k,Z,!Ue);return}WW(p,g,k,b,P,R,Z,ie,pe)}function Qwe(p){for(var g=p;;){var b=g.tag;if((b===0||b===11||b===15)&&g.flags&16384&&(b=g.updateQueue,b!==null&&(b=b.stores,b!==null)))for(var P=0;P<b.length;P++){var R=b[P],k=R.getSnapshot;R=R.value;try{if(!Fa(k(),R))return!1}catch{return!1}}if(b=g.child,g.subtreeFlags&16384&&b!==null)b.return=g,g=b;else{if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function Pg(p,g,b,P){g&=~c$,g&=~p0,p.suspendedLanes|=g,p.pingedLanes&=~g,P&&(p.warmLanes|=g),P=p.expirationTimes;for(var R=g;0<R;){var k=31-dt(R),Z=1<<k;P[k]=-1,R&=~Z}b!==0&&It(p,b,g)}function GI(){return(yn&6)===0?(u2(0),!1):!0}function g$(){if(Ss!==null){if(vn===0)var p=Ss.return;else p=Ss,yh=dp=null,gg(p),yx=null,JE=0,p=Ss;for(;p!==null;)bW(p.alternate,p),p=p.return;Ss=null}}function Tx(p,g){var b=p.timeoutHandle;b!==-1&&(p.timeoutHandle=-1,gSe(b)),b=p.cancelPendingCommit,b!==null&&(p.cancelPendingCommit=null,b()),g$(),qn=p,Ss=b=ph(p.current,null),$s=g,vn=0,Fu=null,Sg=!1,wx=di(p,g),u$=!1,Sx=Ec=c$=p0=Eg=Rr=0,Wl=a2=null,h$=!1,(g&8)!==0&&(g|=g&32);var P=p.entangledLanes;if(P!==0)for(p=p.entanglements,P&=g;0<P;){var R=31-dt(P),k=1<<R;g|=p[R],P&=~k}return xp=g,nx(),b}function BW(p,g){Xt=null,Y.H=AI,g===Ud||g===hx?(g=ae(),vn=3):g===a0?(g=ae(),vn=4):vn=g===aW?8:g!==null&&typeof g=="object"&&typeof g.then=="function"?6:1,Fu=g,Ss===null&&(Rr=1,OI(p,pl(g,p.current)))}function qW(){var p=Y.H;return Y.H=AI,p===null?AI:p}function HW(){var p=Y.A;return Y.A=Zwe,p}function _$(){Rr=4,Sg||($s&4194048)!==$s&&Sc.current!==null||(wx=!0),(Eg&134217727)===0&&(p0&134217727)===0||qn===null||Pg(qn,$s,Ec,!1)}function y$(p,g,b){var P=yn;yn|=2;var R=qW(),k=HW();(qn!==p||$s!==g)&&(zI=null,Tx(p,g)),g=!1;var Z=Rr;e:do try{if(vn!==0&&Ss!==null){var ie=Ss,pe=Fu;switch(vn){case 8:g$(),Z=6;break e;case 3:case 2:case 9:case 6:Sc.current===null&&(g=!0);var Ue=vn;if(vn=0,Fu=null,Px(p,ie,pe,Ue),b&&wx){Z=0;break e}break;default:Ue=vn,vn=0,Fu=null,Px(p,ie,pe,Ue)}}Jwe(),Z=Rr;break}catch(rt){BW(p,rt)}while(!0);return g&&p.shellSuspendCounter++,yh=dp=null,yn=P,Y.H=R,Y.A=k,Ss===null&&(qn=null,$s=0,nx()),Z}function Jwe(){for(;Ss!==null;)jW(Ss)}function eSe(p,g){var b=yn;yn|=2;var P=qW(),R=HW();qn!==p||$s!==g?(zI=null,VI=$e()+500,Tx(p,g)):wx=di(p,g);e:do try{if(vn!==0&&Ss!==null){g=Ss;var k=Fu;t:switch(vn){case 1:vn=0,Fu=null,Px(p,g,k,1);break;case 2:case 9:if(fg(k)){vn=0,Fu=null,YW(g);break}g=function(){vn!==2&&vn!==9||qn!==p||(vn=7),Hd(p)},k.then(g,g);break e;case 3:vn=7;break e;case 4:vn=5;break e;case 7:fg(k)?(vn=0,Fu=null,YW(g)):(vn=0,Fu=null,Px(p,g,k,7));break;case 5:var Z=null;switch(Ss.tag){case 26:Z=Ss.memoizedState;case 5:case 27:var ie=Ss;if(!Z||MZ(Z)){vn=0,Fu=null;var pe=ie.sibling;if(pe!==null)Ss=pe;else{var Ue=ie.return;Ue!==null?(Ss=Ue,BI(Ue)):Ss=null}break t}}vn=0,Fu=null,Px(p,g,k,5);break;case 6:vn=0,Fu=null,Px(p,g,k,6);break;case 8:g$(),Rr=6;break e;default:throw Error(s(462))}}tSe();break}catch(rt){BW(p,rt)}while(!0);return yh=dp=null,Y.H=P,Y.A=R,yn=b,Ss!==null?0:(qn=null,$s=0,nx(),Rr)}function tSe(){for(;Ss!==null&&!Bi();)jW(Ss)}function jW(p){var g=vW(p.alternate,p,xp);p.memoizedProps=p.pendingProps,g===null?BI(p):Ss=g}function YW(p){var g=p,b=g.alternate;switch(g.tag){case 15:case 0:g=mW(b,g,g.pendingProps,g.type,void 0,$s);break;case 11:g=mW(b,g,g.pendingProps,g.type.render,g.ref,$s);break;case 5:gg(g);default:bW(b,g),g=Ss=pI(g,xp),g=vW(b,g,xp)}p.memoizedProps=p.pendingProps,g===null?BI(p):Ss=g}function Px(p,g,b,P){yh=dp=null,gg(g),yx=null,JE=0;var R=g.return;try{if(qwe(p,R,g,b,$s)){Rr=1,OI(p,pl(b,p.current)),Ss=null;return}}catch(k){if(R!==null)throw Ss=R,k;Rr=1,OI(p,pl(b,p.current)),Ss=null;return}g.flags&32768?(ks||P===1?p=!0:wx||($s&536870912)!==0?p=!1:(Sg=p=!0,(P===2||P===9||P===3||P===6)&&(P=Sc.current,P!==null&&P.tag===13&&(P.flags|=16384))),XW(g,p)):BI(g)}function BI(p){var g=p;do{if((g.flags&32768)!==0){XW(g,Sg);return}p=g.return;var b=jwe(g.alternate,g,xp);if(b!==null){Ss=b;return}if(g=g.sibling,g!==null){Ss=g;return}Ss=g=p}while(g!==null);Rr===0&&(Rr=5)}function XW(p,g){do{var b=Ywe(p.alternate,p);if(b!==null){b.flags&=32767,Ss=b;return}if(b=p.return,b!==null&&(b.flags|=32768,b.subtreeFlags=0,b.deletions=null),!g&&(p=p.sibling,p!==null)){Ss=p;return}Ss=p=b}while(p!==null);Rr=6,Ss=null}function WW(p,g,b,P,R,k,Z,ie,pe){p.cancelPendingCommit=null;do qI();while(va!==0);if((yn&6)!==0)throw Error(s(327));if(g!==null){if(g===p.current)throw Error(s(177));if(k=g.lanes|g.childLanes,k|=IE,Rt(p,b,k,Z,ie,pe),p===qn&&(Ss=qn=null,$s=0),Ex=g,Tg=p,Cx=b,m$=k,p$=R,UW=P,(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?(p.callbackNode=null,p.callbackPriority=0,rSe(le,function(){return eZ(),null})):(p.callbackNode=null,p.callbackPriority=0),P=(g.flags&13878)!==0,(g.subtreeFlags&13878)!==0||P){P=Y.T,Y.T=null,R=W.p,W.p=2,Z=yn,yn|=4;try{Xwe(p,g,b)}finally{yn=Z,W.p=R,Y.T=P}}va=1,ZW(),KW(),QW()}}function ZW(){if(va===1){va=0;var p=Tg,g=Ex,b=(g.flags&13878)!==0;if((g.subtreeFlags&13878)!==0||b){b=Y.T,Y.T=null;var P=W.p;W.p=2;var R=yn;yn|=4;try{NW(g,p);var k=I$,Z=SE(p.containerInfo),ie=k.focusedElem,pe=k.selectionRange;if(Z!==ie&&ie&&ie.ownerDocument&&lI(ie.ownerDocument.documentElement,ie)){if(pe!==null&&sx(ie)){var Ue=pe.start,rt=pe.end;if(rt===void 0&&(rt=Ue),"selectionStart"in ie)ie.selectionStart=Ue,ie.selectionEnd=Math.min(rt,ie.value.length);else{var ut=ie.ownerDocument||document,qe=ut&&ut.defaultView||window;if(qe.getSelection){var Xe=qe.getSelection(),ji=ie.textContent.length,Ni=Math.min(pe.start,ji),Cn=pe.end===void 0?Ni:Math.min(pe.end,ji);!Xe.extend&&Ni>Cn&&(Z=Cn,Cn=Ni,Ni=Z);var Ie=aI(ie,Ni),xe=aI(ie,Cn);if(Ie&&xe&&(Xe.rangeCount!==1||Xe.anchorNode!==Ie.node||Xe.anchorOffset!==Ie.offset||Xe.focusNode!==xe.node||Xe.focusOffset!==xe.offset)){var Fe=ut.createRange();Fe.setStart(Ie.node,Ie.offset),Xe.removeAllRanges(),Ni>Cn?(Xe.addRange(Fe),Xe.extend(xe.node,xe.offset)):(Fe.setEnd(xe.node,xe.offset),Xe.addRange(Fe))}}}}for(ut=[],Xe=ie;Xe=Xe.parentNode;)Xe.nodeType===1&&ut.push({element:Xe,left:Xe.scrollLeft,top:Xe.scrollTop});for(typeof ie.focus=="function"&&ie.focus(),ie=0;ie<ut.length;ie++){var at=ut[ie];at.element.scrollLeft=at.left,at.element.scrollTop=at.top}}iD=!!A$,I$=A$=null}finally{yn=R,W.p=P,Y.T=b}}p.current=g,va=2}}function KW(){if(va===2){va=0;var p=Tg,g=Ex,b=(g.flags&8772)!==0;if((g.subtreeFlags&8772)!==0||b){b=Y.T,Y.T=null;var P=W.p;W.p=2;var R=yn;yn|=4;try{MW(p,g.alternate,g)}finally{yn=R,W.p=P,Y.T=b}}va=3}}function QW(){if(va===4||va===3){va=0,pt();var p=Tg,g=Ex,b=Cx,P=UW;(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?va=5:(va=0,Ex=Tg=null,JW(p,p.pendingLanes));var R=p.pendingLanes;if(R===0&&(Cg=null),or(b),g=g.stateNode,Ct&&typeof Ct.onCommitFiberRoot=="function")try{Ct.onCommitFiberRoot(Ze,g,void 0,(g.current.flags&128)===128)}catch{}if(P!==null){g=Y.T,R=W.p,W.p=2,Y.T=null;try{for(var k=p.onRecoverableError,Z=0;Z<P.length;Z++){var ie=P[Z];k(ie.value,{componentStack:ie.stack})}}finally{Y.T=g,W.p=R}}(Cx&3)!==0&&qI(),Hd(p),R=p.pendingLanes,(b&4194090)!==0&&(R&42)!==0?p===f$?l2++:(l2=0,f$=p):l2=0,u2(0)}}function JW(p,g){(p.pooledCacheLanes&=g)===0&&(g=p.pooledCache,g!=null&&(p.pooledCache=null,mp(g)))}function qI(p){return ZW(),KW(),QW(),eZ()}function eZ(){if(va!==5)return!1;var p=Tg,g=m$;m$=0;var b=or(Cx),P=Y.T,R=W.p;try{W.p=32>b?32:b,Y.T=null,b=p$,p$=null;var k=Tg,Z=Cx;if(va=0,Ex=Tg=null,Cx=0,(yn&6)!==0)throw Error(s(331));var ie=yn;if(yn|=4,kW(k.current),OW(k,k.current,Z,b),yn=ie,u2(0,!1),Ct&&typeof Ct.onPostCommitFiberRoot=="function")try{Ct.onPostCommitFiberRoot(Ze,k)}catch{}return!0}finally{W.p=R,Y.T=P,JW(p,g)}}function tZ(p,g,b){g=pl(b,g),g=Yk(p.stateNode,g,2),p=Ft(p,g,2),p!==null&&(ot(p,2),Hd(p))}function On(p,g,b){if(p.tag===3)tZ(p,p,b);else for(;g!==null;){if(g.tag===3){tZ(g,p,b);break}else if(g.tag===1){var P=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof P.componentDidCatch=="function"&&(Cg===null||!Cg.has(P))){p=pl(b,p),b=rW(2),P=Ft(g,b,2),P!==null&&(oW(b,P,g,p),ot(P,2),Hd(P));break}}g=g.return}}function v$(p,g,b){var P=p.pingCache;if(P===null){P=p.pingCache=new Kwe;var R=new Set;P.set(g,R)}else R=P.get(g),R===void 0&&(R=new Set,P.set(g,R));R.has(b)||(u$=!0,R.add(b),p=iSe.bind(null,p,g,b),g.then(p,p))}function iSe(p,g,b){var P=p.pingCache;P!==null&&P.delete(g),p.pingedLanes|=p.suspendedLanes&b,p.warmLanes&=~b,qn===p&&($s&b)===b&&(Rr===4||Rr===3&&($s&62914560)===$s&&300>$e()-d$?(yn&2)===0&&Tx(p,0):c$|=b,Sx===$s&&(Sx=0)),Hd(p)}function iZ(p,g){g===0&&(g=Dt()),p=ka(p,g),p!==null&&(ot(p,g),Hd(p))}function sSe(p){var g=p.memoizedState,b=0;g!==null&&(b=g.retryLane),iZ(p,b)}function nSe(p,g){var b=0;switch(p.tag){case 13:var P=p.stateNode,R=p.memoizedState;R!==null&&(b=R.retryLane);break;case 19:P=p.stateNode;break;case 22:P=p.stateNode._retryCache;break;default:throw Error(s(314))}P!==null&&P.delete(g),iZ(p,b)}function rSe(p,g){return si(p,g)}var HI=null,Mx=null,x$=!1,jI=!1,b$=!1,f0=0;function Hd(p){p!==Mx&&p.next===null&&(Mx===null?HI=Mx=p:Mx=Mx.next=p),jI=!0,x$||(x$=!0,aSe())}function u2(p,g){if(!b$&&jI){b$=!0;do for(var b=!1,P=HI;P!==null;){if(p!==0){var R=P.pendingLanes;if(R===0)var k=0;else{var Z=P.suspendedLanes,ie=P.pingedLanes;k=(1<<31-dt(42|p)+1)-1,k&=R&~(Z&~ie),k=k&201326741?k&201326741|1:k?k|2:0}k!==0&&(b=!0,oZ(P,k))}else k=$s,k=Ii(P,P===qn?k:0,P.cancelPendingCommit!==null||P.timeoutHandle!==-1),(k&3)===0||di(P,k)||(b=!0,oZ(P,k));P=P.next}while(b);b$=!1}}function oSe(){sZ()}function sZ(){jI=x$=!1;var p=0;f0!==0&&(fSe()&&(p=f0),f0=0);for(var g=$e(),b=null,P=HI;P!==null;){var R=P.next,k=nZ(P,g);k===0?(P.next=null,b===null?HI=R:b.next=R,R===null&&(Mx=b)):(b=P,(p!==0||(k&3)!==0)&&(jI=!0)),P=R}u2(p)}function nZ(p,g){for(var b=p.suspendedLanes,P=p.pingedLanes,R=p.expirationTimes,k=p.pendingLanes&-62914561;0<k;){var Z=31-dt(k),ie=1<<Z,pe=R[Z];pe===-1?((ie&b)===0||(ie&P)!==0)&&(R[Z]=ms(ie,g)):pe<=g&&(p.expiredLanes|=ie),k&=~ie}if(g=qn,b=$s,b=Ii(p,p===g?b:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),P=p.callbackNode,b===0||p===g&&(vn===2||vn===9)||p.cancelPendingCommit!==null)return P!==null&&P!==null&&me(P),p.callbackNode=null,p.callbackPriority=0;if((b&3)===0||di(p,b)){if(g=b&-b,g===p.callbackPriority)return g;switch(P!==null&&me(P),or(b)){case 2:case 8:b=Mt;break;case 32:b=le;break;case 268435456:b=De;break;default:b=le}return P=rZ.bind(null,p),b=si(b,P),p.callbackPriority=g,p.callbackNode=b,g}return P!==null&&P!==null&&me(P),p.callbackPriority=2,p.callbackNode=null,2}function rZ(p,g){if(va!==0&&va!==5)return p.callbackNode=null,p.callbackPriority=0,null;var b=p.callbackNode;if(qI()&&p.callbackNode!==b)return null;var P=$s;return P=Ii(p,p===qn?P:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),P===0?null:(zW(p,P,g),nZ(p,$e()),p.callbackNode!=null&&p.callbackNode===b?rZ.bind(null,p):null)}function oZ(p,g){if(qI())return null;zW(p,g,!0)}function aSe(){_Se(function(){(yn&6)!==0?si($i,oSe):sZ()})}function w$(){return f0===0&&(f0=we()),f0}function aZ(p){return p==null||typeof p=="symbol"||typeof p=="boolean"?null:typeof p=="function"?p:W1(""+p)}function lZ(p,g){var b=g.ownerDocument.createElement("input");return b.name=g.name,b.value=g.value,p.id&&b.setAttribute("form",p.id),g.parentNode.insertBefore(b,g),p=new FormData(p),b.parentNode.removeChild(b),p}function lSe(p,g,b,P,R){if(g==="submit"&&b&&b.stateNode===R){var k=aZ((R[Js]||null).action),Z=P.submitter;Z&&(g=(g=Z[Js]||null)?aZ(g.formAction):Z.getAttribute("formAction"),g!==null&&(k=g,Z=null));var ie=new tg("action","action",null,P,R);p.push({event:ie,listeners:[{instance:null,listener:function(){if(P.defaultPrevented){if(f0!==0){var pe=Z?lZ(R,Z):new FormData(R);Gk(b,{pending:!0,data:pe,method:R.method,action:k},null,pe)}}else typeof k=="function"&&(ie.preventDefault(),pe=Z?lZ(R,Z):new FormData(R),Gk(b,{pending:!0,data:pe,method:R.method,action:k},k,pe))},currentTarget:R}]})}}for(var S$=0;S$<AE.length;S$++){var E$=AE[S$],uSe=E$.toLowerCase(),cSe=E$[0].toUpperCase()+E$.slice(1);Ru(uSe,"on"+cSe)}Ru(Nd,"onAnimationEnd"),Ru(bc,"onAnimationIteration"),Ru(TE,"onAnimationStart"),Ru("dblclick","onDoubleClick"),Ru("focusin","onFocus"),Ru("focusout","onBlur"),Ru(Fk,"onTransitionRun"),Ru(hI,"onTransitionStart"),Ru(dI,"onTransitionCancel"),Ru(PE,"onTransitionEnd"),re("onMouseEnter",["mouseout","mouseover"]),re("onMouseLeave",["mouseout","mouseover"]),re("onPointerEnter",["pointerout","pointerover"]),re("onPointerLeave",["pointerout","pointerover"]),_n("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),_n("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),_n("onBeforeInput",["compositionend","keypress","textInput","paste"]),_n("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),_n("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),_n("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var c2="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hSe=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(c2));function uZ(p,g){g=(g&4)!==0;for(var b=0;b<p.length;b++){var P=p[b],R=P.event;P=P.listeners;e:{var k=void 0;if(g)for(var Z=P.length-1;0<=Z;Z--){var ie=P[Z],pe=ie.instance,Ue=ie.currentTarget;if(ie=ie.listener,pe!==k&&R.isPropagationStopped())break e;k=ie,R.currentTarget=Ue;try{k(R)}catch(rt){RI(rt)}R.currentTarget=null,k=pe}else for(Z=0;Z<P.length;Z++){if(ie=P[Z],pe=ie.instance,Ue=ie.currentTarget,ie=ie.listener,pe!==k&&R.isPropagationStopped())break e;k=ie,R.currentTarget=Ue;try{k(R)}catch(rt){RI(rt)}R.currentTarget=null,k=pe}}}}function Es(p,g){var b=g[Bt];b===void 0&&(b=g[Bt]=new Set);var P=p+"__bubble";b.has(P)||(cZ(g,p,2,!1),b.add(P))}function C$(p,g,b){var P=0;g&&(P|=4),cZ(b,p,P,g)}var YI="_reactListening"+Math.random().toString(36).slice(2);function T$(p){if(!p[YI]){p[YI]=!0,eo.forEach(function(b){b!=="selectionchange"&&(hSe.has(b)||C$(b,!1,p),C$(b,!0,p))});var g=p.nodeType===9?p:p.ownerDocument;g===null||g[YI]||(g[YI]=!0,C$("selectionchange",!1,g))}}function cZ(p,g,b,P){switch(OZ(g)){case 2:var R=$Se;break;case 8:R=USe;break;default:R=V$}b=R.bind(null,g,b,p),R=void 0,!Ad||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(R=!0),P?R!==void 0?p.addEventListener(g,b,{capture:!0,passive:R}):p.addEventListener(g,b,!0):R!==void 0?p.addEventListener(g,b,{passive:R}):p.addEventListener(g,b,!1)}function P$(p,g,b,P,R){var k=P;if((g&1)===0&&(g&2)===0&&P!==null)e:for(;;){if(P===null)return;var Z=P.tag;if(Z===3||Z===4){var ie=P.stateNode.containerInfo;if(ie===R)break;if(Z===4)for(Z=P.return;Z!==null;){var pe=Z.tag;if((pe===3||pe===4)&&Z.stateNode.containerInfo===R)return;Z=Z.return}for(;ie!==null;){if(Z=La(ie),Z===null)return;if(pe=Z.tag,pe===5||pe===6||pe===26||pe===27){P=k=Z;continue e}ie=ie.parentNode}}P=P.return}pE(function(){var Ue=k,rt=Jf(b),ut=[];e:{var qe=ME.get(p);if(qe!==void 0){var Xe=tg,ji=p;switch(p){case"keypress":if(Q1(b)===0)break e;case"keydown":case"keyup":Xe=qA;break;case"focusin":ji="focus",Xe=J1;break;case"focusout":ji="blur",Xe=J1;break;case"beforeblur":case"afterblur":Xe=J1;break;case"click":if(b.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Xe=ip;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Xe=FA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Xe=Tk;break;case Nd:case bc:case TE:Xe=UA;break;case PE:Xe=Pk;break;case"scroll":case"scrollend":Xe=LA;break;case"wheel":Xe=Ak;break;case"copy":case"cut":case"paste":Xe=VA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Xe=Id;break;case"toggle":case"beforetoggle":Xe=YA}var Ni=(g&4)!==0,Cn=!Ni&&(p==="scroll"||p==="scrollend"),Ie=Ni?qe!==null?qe+"Capture":null:qe;Ni=[];for(var xe=Ue,Fe;xe!==null;){var at=xe;if(Fe=at.stateNode,at=at.tag,at!==5&&at!==26&&at!==27||Fe===null||Ie===null||(at=eg(xe,Ie),at!=null&&Ni.push(h2(xe,at,Fe))),Cn)break;xe=xe.return}0<Ni.length&&(qe=new Xe(qe,ji,null,b,rt),ut.push({event:qe,listeners:Ni}))}}if((g&7)===0){e:{if(qe=p==="mouseover"||p==="pointerover",Xe=p==="mouseout"||p==="pointerout",qe&&b!==_c&&(ji=b.relatedTarget||b.fromElement)&&(La(ji)||ji[Br]))break e;if((Xe||qe)&&(qe=rt.window===rt?rt:(qe=rt.ownerDocument)?qe.defaultView||qe.parentWindow:window,Xe?(ji=b.relatedTarget||b.toElement,Xe=Ue,ji=ji?La(ji):null,ji!==null&&(Cn=r(ji),Ni=ji.tag,ji!==Cn||Ni!==5&&Ni!==27&&Ni!==6)&&(ji=null)):(Xe=null,ji=Ue),Xe!==ji)){if(Ni=ip,at="onMouseLeave",Ie="onMouseEnter",xe="mouse",(p==="pointerout"||p==="pointerover")&&(Ni=Id,at="onPointerLeave",Ie="onPointerEnter",xe="pointer"),Cn=Xe==null?qe:wi(Xe),Fe=ji==null?qe:wi(ji),qe=new Ni(at,xe+"leave",Xe,b,rt),qe.target=Cn,qe.relatedTarget=Fe,at=null,La(rt)===Ue&&(Ni=new Ni(Ie,xe+"enter",ji,b,rt),Ni.target=Fe,Ni.relatedTarget=Cn,at=Ni),Cn=at,Xe&&ji)t:{for(Ni=Xe,Ie=ji,xe=0,Fe=Ni;Fe;Fe=Ax(Fe))xe++;for(Fe=0,at=Ie;at;at=Ax(at))Fe++;for(;0<xe-Fe;)Ni=Ax(Ni),xe--;for(;0<Fe-xe;)Ie=Ax(Ie),Fe--;for(;xe--;){if(Ni===Ie||Ie!==null&&Ni===Ie.alternate)break t;Ni=Ax(Ni),Ie=Ax(Ie)}Ni=null}else Ni=null;Xe!==null&&hZ(ut,qe,Xe,Ni,!1),ji!==null&&Cn!==null&&hZ(ut,Cn,ji,Ni,!0)}}e:{if(qe=Ue?wi(Ue):window,Xe=qe.nodeName&&qe.nodeName.toLowerCase(),Xe==="select"||Xe==="input"&&qe.type==="file")var ni=tI;else if(JA(qe))if(xE)ni=oI;else{ni=nI;var ws=Ok}else Xe=qe.nodeName,!Xe||Xe.toLowerCase()!=="input"||qe.type!=="checkbox"&&qe.type!=="radio"?Ue&&Xy(Ue.elementType)&&(ni=tI):ni=rI;if(ni&&(ni=ni(p,Ue))){ql(ut,ni,b,rt);break e}ws&&ws(p,qe,Ue),p==="focusout"&&Ue&&qe.type==="number"&&Ue.memoizedProps.value!=null&&io(qe,"number",qe.value)}switch(ws=Ue?wi(Ue):window,p){case"focusin":(JA(ws)||ws.contentEditable==="true")&&(ag=ws,EE=Ue,e0=null);break;case"focusout":e0=EE=ag=null;break;case"mousedown":CE=!0;break;case"contextmenu":case"mouseup":case"dragend":CE=!1,uI(ut,b,rt);break;case"selectionchange":if(Lk)break;case"keydown":case"keyup":uI(ut,b,rt)}var vi;if(vE)e:{switch(p){case"compositionstart":var Fi="onCompositionStart";break e;case"compositionend":Fi="onCompositionEnd";break e;case"compositionupdate":Fi="onCompositionUpdate";break e}Fi=void 0}else sg?KA(p,b)&&(Fi="onCompositionEnd"):p==="keydown"&&b.keyCode===229&&(Fi="onCompositionStart");Fi&&(WA&&b.locale!=="ko"&&(sg||Fi!=="onCompositionStart"?Fi==="onCompositionEnd"&&sg&&(vi=K1()):(dh=rt,Zy="value"in dh?dh.value:dh.textContent,sg=!0)),ws=XI(Ue,Fi),0<ws.length&&(Fi=new zA(Fi,p,null,b,rt),ut.push({event:Fi,listeners:ws}),vi?Fi.data=vi:(vi=QA(b),vi!==null&&(Fi.data=vi)))),(vi=sp?Dk(p,b):Nk(p,b))&&(Fi=XI(Ue,"onBeforeInput"),0<Fi.length&&(ws=new zA("onBeforeInput","beforeinput",null,b,rt),ut.push({event:ws,listeners:Fi}),ws.data=vi)),lSe(ut,p,Ue,b,rt)}uZ(ut,g)})}function h2(p,g,b){return{instance:p,listener:g,currentTarget:b}}function XI(p,g){for(var b=g+"Capture",P=[];p!==null;){var R=p,k=R.stateNode;if(R=R.tag,R!==5&&R!==26&&R!==27||k===null||(R=eg(p,b),R!=null&&P.unshift(h2(p,R,k)),R=eg(p,g),R!=null&&P.push(h2(p,R,k))),p.tag===3)return P;p=p.return}return[]}function Ax(p){if(p===null)return null;do p=p.return;while(p&&p.tag!==5&&p.tag!==27);return p||null}function hZ(p,g,b,P,R){for(var k=g._reactName,Z=[];b!==null&&b!==P;){var ie=b,pe=ie.alternate,Ue=ie.stateNode;if(ie=ie.tag,pe!==null&&pe===P)break;ie!==5&&ie!==26&&ie!==27||Ue===null||(pe=Ue,R?(Ue=eg(b,k),Ue!=null&&Z.unshift(h2(b,Ue,pe))):R||(Ue=eg(b,k),Ue!=null&&Z.push(h2(b,Ue,pe)))),b=b.return}Z.length!==0&&p.push({event:g,listeners:Z})}var dSe=/\r\n?/g,mSe=/\u0000|\uFFFD/g;function dZ(p){return(typeof p=="string"?p:""+p).replace(dSe,`
`).replace(mSe,"")}function mZ(p,g){return g=dZ(g),dZ(p)===g}function WI(){}function En(p,g,b,P,R,k){switch(b){case"children":typeof P=="string"?g==="body"||g==="textarea"&&P===""||da(p,P):(typeof P=="number"||typeof P=="bigint")&&g!=="body"&&da(p,""+P);break;case"className":St(p,"class",P);break;case"tabIndex":St(p,"tabindex",P);break;case"dir":case"role":case"viewBox":case"width":case"height":St(p,b,P);break;case"style":Wm(p,P,k);break;case"data":if(g!=="object"){St(p,"data",P);break}case"src":case"href":if(P===""&&(g!=="a"||b!=="href")){p.removeAttribute(b);break}if(P==null||typeof P=="function"||typeof P=="symbol"||typeof P=="boolean"){p.removeAttribute(b);break}P=W1(""+P),p.setAttribute(b,P);break;case"action":case"formAction":if(typeof P=="function"){p.setAttribute(b,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof k=="function"&&(b==="formAction"?(g!=="input"&&En(p,g,"name",R.name,R,null),En(p,g,"formEncType",R.formEncType,R,null),En(p,g,"formMethod",R.formMethod,R,null),En(p,g,"formTarget",R.formTarget,R,null)):(En(p,g,"encType",R.encType,R,null),En(p,g,"method",R.method,R,null),En(p,g,"target",R.target,R,null)));if(P==null||typeof P=="symbol"||typeof P=="boolean"){p.removeAttribute(b);break}P=W1(""+P),p.setAttribute(b,P);break;case"onClick":P!=null&&(p.onclick=WI);break;case"onScroll":P!=null&&Es("scroll",p);break;case"onScrollEnd":P!=null&&Es("scrollend",p);break;case"dangerouslySetInnerHTML":if(P!=null){if(typeof P!="object"||!("__html"in P))throw Error(s(61));if(b=P.__html,b!=null){if(R.children!=null)throw Error(s(60));p.innerHTML=b}}break;case"multiple":p.multiple=P&&typeof P!="function"&&typeof P!="symbol";break;case"muted":p.muted=P&&typeof P!="function"&&typeof P!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(P==null||typeof P=="function"||typeof P=="boolean"||typeof P=="symbol"){p.removeAttribute("xlink:href");break}b=W1(""+P),p.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",b);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":P!=null&&typeof P!="function"&&typeof P!="symbol"?p.setAttribute(b,""+P):p.removeAttribute(b);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":P&&typeof P!="function"&&typeof P!="symbol"?p.setAttribute(b,""):p.removeAttribute(b);break;case"capture":case"download":P===!0?p.setAttribute(b,""):P!==!1&&P!=null&&typeof P!="function"&&typeof P!="symbol"?p.setAttribute(b,P):p.removeAttribute(b);break;case"cols":case"rows":case"size":case"span":P!=null&&typeof P!="function"&&typeof P!="symbol"&&!isNaN(P)&&1<=P?p.setAttribute(b,P):p.removeAttribute(b);break;case"rowSpan":case"start":P==null||typeof P=="function"||typeof P=="symbol"||isNaN(P)?p.removeAttribute(b):p.setAttribute(b,P);break;case"popover":Es("beforetoggle",p),Es("toggle",p),ft(p,"popover",P);break;case"xlinkActuate":At(p,"http://www.w3.org/1999/xlink","xlink:actuate",P);break;case"xlinkArcrole":At(p,"http://www.w3.org/1999/xlink","xlink:arcrole",P);break;case"xlinkRole":At(p,"http://www.w3.org/1999/xlink","xlink:role",P);break;case"xlinkShow":At(p,"http://www.w3.org/1999/xlink","xlink:show",P);break;case"xlinkTitle":At(p,"http://www.w3.org/1999/xlink","xlink:title",P);break;case"xlinkType":At(p,"http://www.w3.org/1999/xlink","xlink:type",P);break;case"xmlBase":At(p,"http://www.w3.org/XML/1998/namespace","xml:base",P);break;case"xmlLang":At(p,"http://www.w3.org/XML/1998/namespace","xml:lang",P);break;case"xmlSpace":At(p,"http://www.w3.org/XML/1998/namespace","xml:space",P);break;case"is":ft(p,"is",P);break;case"innerText":case"textContent":break;default:(!(2<b.length)||b[0]!=="o"&&b[0]!=="O"||b[1]!=="n"&&b[1]!=="N")&&(b=RA.get(b)||b,ft(p,b,P))}}function M$(p,g,b,P,R,k){switch(b){case"style":Wm(p,P,k);break;case"dangerouslySetInnerHTML":if(P!=null){if(typeof P!="object"||!("__html"in P))throw Error(s(61));if(b=P.__html,b!=null){if(R.children!=null)throw Error(s(60));p.innerHTML=b}}break;case"children":typeof P=="string"?da(p,P):(typeof P=="number"||typeof P=="bigint")&&da(p,""+P);break;case"onScroll":P!=null&&Es("scroll",p);break;case"onScrollEnd":P!=null&&Es("scrollend",p);break;case"onClick":P!=null&&(p.onclick=WI);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!to.hasOwnProperty(b))e:{if(b[0]==="o"&&b[1]==="n"&&(R=b.endsWith("Capture"),g=b.slice(2,R?b.length-7:void 0),k=p[Js]||null,k=k!=null?k[b]:null,typeof k=="function"&&p.removeEventListener(g,k,R),typeof P=="function")){typeof k!="function"&&k!==null&&(b in p?p[b]=null:p.hasAttribute(b)&&p.removeAttribute(b)),p.addEventListener(g,P,R);break e}b in p?p[b]=P:P===!0?p.setAttribute(b,""):ft(p,b,P)}}}function xa(p,g,b){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Es("error",p),Es("load",p);var P=!1,R=!1,k;for(k in b)if(b.hasOwnProperty(k)){var Z=b[k];if(Z!=null)switch(k){case"src":P=!0;break;case"srcSet":R=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,g));default:En(p,g,k,Z,b,null)}}R&&En(p,g,"srcSet",b.srcSet,b,null),P&&En(p,g,"src",b.src,b,null);return;case"input":Es("invalid",p);var ie=k=Z=R=null,pe=null,Ue=null;for(P in b)if(b.hasOwnProperty(P)){var rt=b[P];if(rt!=null)switch(P){case"name":R=rt;break;case"type":Z=rt;break;case"checked":pe=rt;break;case"defaultChecked":Ue=rt;break;case"value":k=rt;break;case"defaultValue":ie=rt;break;case"children":case"dangerouslySetInnerHTML":if(rt!=null)throw Error(s(137,g));break;default:En(p,g,P,rt,b,null)}}en(p,k,ie,pe,Ue,Z,R,!1),Hi(p);return;case"select":Es("invalid",p),P=Z=k=null;for(R in b)if(b.hasOwnProperty(R)&&(ie=b[R],ie!=null))switch(R){case"value":k=ie;break;case"defaultValue":Z=ie;break;case"multiple":P=ie;default:En(p,g,R,ie,b,null)}g=k,b=Z,p.multiple=!!P,g!=null?dn(p,!!P,g,!1):b!=null&&dn(p,!!P,b,!0);return;case"textarea":Es("invalid",p),k=R=P=null;for(Z in b)if(b.hasOwnProperty(Z)&&(ie=b[Z],ie!=null))switch(Z){case"value":P=ie;break;case"defaultValue":R=ie;break;case"children":k=ie;break;case"dangerouslySetInnerHTML":if(ie!=null)throw Error(s(91));break;default:En(p,g,Z,ie,b,null)}Nr(p,P,R,k),Hi(p);return;case"option":for(pe in b)if(b.hasOwnProperty(pe)&&(P=b[pe],P!=null))switch(pe){case"selected":p.selected=P&&typeof P!="function"&&typeof P!="symbol";break;default:En(p,g,pe,P,b,null)}return;case"dialog":Es("beforetoggle",p),Es("toggle",p),Es("cancel",p),Es("close",p);break;case"iframe":case"object":Es("load",p);break;case"video":case"audio":for(P=0;P<c2.length;P++)Es(c2[P],p);break;case"image":Es("error",p),Es("load",p);break;case"details":Es("toggle",p);break;case"embed":case"source":case"link":Es("error",p),Es("load",p);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ue in b)if(b.hasOwnProperty(Ue)&&(P=b[Ue],P!=null))switch(Ue){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,g));default:En(p,g,Ue,P,b,null)}return;default:if(Xy(g)){for(rt in b)b.hasOwnProperty(rt)&&(P=b[rt],P!==void 0&&M$(p,g,rt,P,b,void 0));return}}for(ie in b)b.hasOwnProperty(ie)&&(P=b[ie],P!=null&&En(p,g,ie,P,b,null))}function pSe(p,g,b,P){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var R=null,k=null,Z=null,ie=null,pe=null,Ue=null,rt=null;for(Xe in b){var ut=b[Xe];if(b.hasOwnProperty(Xe)&&ut!=null)switch(Xe){case"checked":break;case"value":break;case"defaultValue":pe=ut;default:P.hasOwnProperty(Xe)||En(p,g,Xe,null,P,ut)}}for(var qe in P){var Xe=P[qe];if(ut=b[qe],P.hasOwnProperty(qe)&&(Xe!=null||ut!=null))switch(qe){case"type":k=Xe;break;case"name":R=Xe;break;case"checked":Ue=Xe;break;case"defaultChecked":rt=Xe;break;case"value":Z=Xe;break;case"defaultValue":ie=Xe;break;case"children":case"dangerouslySetInnerHTML":if(Xe!=null)throw Error(s(137,g));break;default:Xe!==ut&&En(p,g,qe,Xe,P,ut)}}Dr(p,Z,ie,pe,Ue,rt,k,R);return;case"select":Xe=Z=ie=qe=null;for(k in b)if(pe=b[k],b.hasOwnProperty(k)&&pe!=null)switch(k){case"value":break;case"multiple":Xe=pe;default:P.hasOwnProperty(k)||En(p,g,k,null,P,pe)}for(R in P)if(k=P[R],pe=b[R],P.hasOwnProperty(R)&&(k!=null||pe!=null))switch(R){case"value":qe=k;break;case"defaultValue":ie=k;break;case"multiple":Z=k;default:k!==pe&&En(p,g,R,k,P,pe)}g=ie,b=Z,P=Xe,qe!=null?dn(p,!!b,qe,!1):!!P!=!!b&&(g!=null?dn(p,!!b,g,!0):dn(p,!!b,b?[]:"",!1));return;case"textarea":Xe=qe=null;for(ie in b)if(R=b[ie],b.hasOwnProperty(ie)&&R!=null&&!P.hasOwnProperty(ie))switch(ie){case"value":break;case"children":break;default:En(p,g,ie,null,P,R)}for(Z in P)if(R=P[Z],k=b[Z],P.hasOwnProperty(Z)&&(R!=null||k!=null))switch(Z){case"value":qe=R;break;case"defaultValue":Xe=R;break;case"children":break;case"dangerouslySetInnerHTML":if(R!=null)throw Error(s(91));break;default:R!==k&&En(p,g,Z,R,P,k)}Gn(p,qe,Xe);return;case"option":for(var ji in b)if(qe=b[ji],b.hasOwnProperty(ji)&&qe!=null&&!P.hasOwnProperty(ji))switch(ji){case"selected":p.selected=!1;break;default:En(p,g,ji,null,P,qe)}for(pe in P)if(qe=P[pe],Xe=b[pe],P.hasOwnProperty(pe)&&qe!==Xe&&(qe!=null||Xe!=null))switch(pe){case"selected":p.selected=qe&&typeof qe!="function"&&typeof qe!="symbol";break;default:En(p,g,pe,qe,P,Xe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ni in b)qe=b[Ni],b.hasOwnProperty(Ni)&&qe!=null&&!P.hasOwnProperty(Ni)&&En(p,g,Ni,null,P,qe);for(Ue in P)if(qe=P[Ue],Xe=b[Ue],P.hasOwnProperty(Ue)&&qe!==Xe&&(qe!=null||Xe!=null))switch(Ue){case"children":case"dangerouslySetInnerHTML":if(qe!=null)throw Error(s(137,g));break;default:En(p,g,Ue,qe,P,Xe)}return;default:if(Xy(g)){for(var Cn in b)qe=b[Cn],b.hasOwnProperty(Cn)&&qe!==void 0&&!P.hasOwnProperty(Cn)&&M$(p,g,Cn,void 0,P,qe);for(rt in P)qe=P[rt],Xe=b[rt],!P.hasOwnProperty(rt)||qe===Xe||qe===void 0&&Xe===void 0||M$(p,g,rt,qe,P,Xe);return}}for(var Ie in b)qe=b[Ie],b.hasOwnProperty(Ie)&&qe!=null&&!P.hasOwnProperty(Ie)&&En(p,g,Ie,null,P,qe);for(ut in P)qe=P[ut],Xe=b[ut],!P.hasOwnProperty(ut)||qe===Xe||qe==null&&Xe==null||En(p,g,ut,qe,P,Xe)}var A$=null,I$=null;function ZI(p){return p.nodeType===9?p:p.ownerDocument}function pZ(p){switch(p){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function fZ(p,g){if(p===0)switch(g){case"svg":return 1;case"math":return 2;default:return 0}return p===1&&g==="foreignObject"?0:p}function D$(p,g){return p==="textarea"||p==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.children=="bigint"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var N$=null;function fSe(){var p=window.event;return p&&p.type==="popstate"?p===N$?!1:(N$=p,!0):(N$=null,!1)}var gZ=typeof setTimeout=="function"?setTimeout:void 0,gSe=typeof clearTimeout=="function"?clearTimeout:void 0,_Z=typeof Promise=="function"?Promise:void 0,_Se=typeof queueMicrotask=="function"?queueMicrotask:typeof _Z<"u"?function(p){return _Z.resolve(null).then(p).catch(ySe)}:gZ;function ySe(p){setTimeout(function(){throw p})}function Mg(p){return p==="head"}function yZ(p,g){var b=g,P=0,R=0;do{var k=b.nextSibling;if(p.removeChild(b),k&&k.nodeType===8)if(b=k.data,b==="/$"){if(0<P&&8>P){b=P;var Z=p.ownerDocument;if(b&1&&d2(Z.documentElement),b&2&&d2(Z.body),b&4)for(b=Z.head,d2(b),Z=b.firstChild;Z;){var ie=Z.nextSibling,pe=Z.nodeName;Z[dl]||pe==="SCRIPT"||pe==="STYLE"||pe==="LINK"&&Z.rel.toLowerCase()==="stylesheet"||b.removeChild(Z),Z=ie}}if(R===0){p.removeChild(k),x2(g);return}R--}else b==="$"||b==="$?"||b==="$!"?R++:P=b.charCodeAt(0)-48;else P=0;b=k}while(b);x2(g)}function R$(p){var g=p.firstChild;for(g&&g.nodeType===10&&(g=g.nextSibling);g;){var b=g;switch(g=g.nextSibling,b.nodeName){case"HTML":case"HEAD":case"BODY":R$(b),Jr(b);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(b.rel.toLowerCase()==="stylesheet")continue}p.removeChild(b)}}function vSe(p,g,b,P){for(;p.nodeType===1;){var R=b;if(p.nodeName.toLowerCase()!==g.toLowerCase()){if(!P&&(p.nodeName!=="INPUT"||p.type!=="hidden"))break}else if(P){if(!p[dl])switch(g){case"meta":if(!p.hasAttribute("itemprop"))break;return p;case"link":if(k=p.getAttribute("rel"),k==="stylesheet"&&p.hasAttribute("data-precedence"))break;if(k!==R.rel||p.getAttribute("href")!==(R.href==null||R.href===""?null:R.href)||p.getAttribute("crossorigin")!==(R.crossOrigin==null?null:R.crossOrigin)||p.getAttribute("title")!==(R.title==null?null:R.title))break;return p;case"style":if(p.hasAttribute("data-precedence"))break;return p;case"script":if(k=p.getAttribute("src"),(k!==(R.src==null?null:R.src)||p.getAttribute("type")!==(R.type==null?null:R.type)||p.getAttribute("crossorigin")!==(R.crossOrigin==null?null:R.crossOrigin))&&k&&p.hasAttribute("async")&&!p.hasAttribute("itemprop"))break;return p;default:return p}}else if(g==="input"&&p.type==="hidden"){var k=R.name==null?null:""+R.name;if(R.type==="hidden"&&p.getAttribute("name")===k)return p}else return p;if(p=Sh(p.nextSibling),p===null)break}return null}function xSe(p,g,b){if(g==="")return null;for(;p.nodeType!==3;)if((p.nodeType!==1||p.nodeName!=="INPUT"||p.type!=="hidden")&&!b||(p=Sh(p.nextSibling),p===null))return null;return p}function O$(p){return p.data==="$!"||p.data==="$?"&&p.ownerDocument.readyState==="complete"}function bSe(p,g){var b=p.ownerDocument;if(p.data!=="$?"||b.readyState==="complete")g();else{var P=function(){g(),b.removeEventListener("DOMContentLoaded",P)};b.addEventListener("DOMContentLoaded",P),p._reactRetry=P}}function Sh(p){for(;p!=null;p=p.nextSibling){var g=p.nodeType;if(g===1||g===3)break;if(g===8){if(g=p.data,g==="$"||g==="$!"||g==="$?"||g==="F!"||g==="F")break;if(g==="/$")return null}}return p}var L$=null;function vZ(p){p=p.previousSibling;for(var g=0;p;){if(p.nodeType===8){var b=p.data;if(b==="$"||b==="$!"||b==="$?"){if(g===0)return p;g--}else b==="/$"&&g++}p=p.previousSibling}return null}function xZ(p,g,b){switch(g=ZI(b),p){case"html":if(p=g.documentElement,!p)throw Error(s(452));return p;case"head":if(p=g.head,!p)throw Error(s(453));return p;case"body":if(p=g.body,!p)throw Error(s(454));return p;default:throw Error(s(451))}}function d2(p){for(var g=p.attributes;g.length;)p.removeAttributeNode(g[0]);Jr(p)}var Cc=new Map,bZ=new Set;function KI(p){return typeof p.getRootNode=="function"?p.getRootNode():p.nodeType===9?p:p.ownerDocument}var bp=W.d;W.d={f:wSe,r:SSe,D:ESe,C:CSe,L:TSe,m:PSe,X:ASe,S:MSe,M:ISe};function wSe(){var p=bp.f(),g=GI();return p||g}function SSe(p){var g=Bl(p);g!==null&&g.tag===5&&g.type==="form"?zX(g):bp.r(p)}var Ix=typeof document>"u"?null:document;function wZ(p,g,b){var P=Ix;if(P&&typeof g=="string"&&g){var R=Fs(g);R='link[rel="'+p+'"][href="'+R+'"]',typeof b=="string"&&(R+='[crossorigin="'+b+'"]'),bZ.has(R)||(bZ.add(R),p={rel:p,crossOrigin:b,href:g},P.querySelector(R)===null&&(g=P.createElement("link"),xa(g,"link",p),ys(g),P.head.appendChild(g)))}}function ESe(p){bp.D(p),wZ("dns-prefetch",p,null)}function CSe(p,g){bp.C(p,g),wZ("preconnect",p,g)}function TSe(p,g,b){bp.L(p,g,b);var P=Ix;if(P&&p&&g){var R='link[rel="preload"][as="'+Fs(g)+'"]';g==="image"&&b&&b.imageSrcSet?(R+='[imagesrcset="'+Fs(b.imageSrcSet)+'"]',typeof b.imageSizes=="string"&&(R+='[imagesizes="'+Fs(b.imageSizes)+'"]')):R+='[href="'+Fs(p)+'"]';var k=R;switch(g){case"style":k=Dx(p);break;case"script":k=Nx(p)}Cc.has(k)||(p=c({rel:"preload",href:g==="image"&&b&&b.imageSrcSet?void 0:p,as:g},b),Cc.set(k,p),P.querySelector(R)!==null||g==="style"&&P.querySelector(m2(k))||g==="script"&&P.querySelector(p2(k))||(g=P.createElement("link"),xa(g,"link",p),ys(g),P.head.appendChild(g)))}}function PSe(p,g){bp.m(p,g);var b=Ix;if(b&&p){var P=g&&typeof g.as=="string"?g.as:"script",R='link[rel="modulepreload"][as="'+Fs(P)+'"][href="'+Fs(p)+'"]',k=R;switch(P){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":k=Nx(p)}if(!Cc.has(k)&&(p=c({rel:"modulepreload",href:p},g),Cc.set(k,p),b.querySelector(R)===null)){switch(P){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(b.querySelector(p2(k)))return}P=b.createElement("link"),xa(P,"link",p),ys(P),b.head.appendChild(P)}}}function MSe(p,g,b){bp.S(p,g,b);var P=Ix;if(P&&p){var R=ha(P).hoistableStyles,k=Dx(p);g=g||"default";var Z=R.get(k);if(!Z){var ie={loading:0,preload:null};if(Z=P.querySelector(m2(k)))ie.loading=5;else{p=c({rel:"stylesheet",href:p,"data-precedence":g},b),(b=Cc.get(k))&&F$(p,b);var pe=Z=P.createElement("link");ys(pe),xa(pe,"link",p),pe._p=new Promise(function(Ue,rt){pe.onload=Ue,pe.onerror=rt}),pe.addEventListener("load",function(){ie.loading|=1}),pe.addEventListener("error",function(){ie.loading|=2}),ie.loading|=4,QI(Z,g,P)}Z={type:"stylesheet",instance:Z,count:1,state:ie},R.set(k,Z)}}}function ASe(p,g){bp.X(p,g);var b=Ix;if(b&&p){var P=ha(b).hoistableScripts,R=Nx(p),k=P.get(R);k||(k=b.querySelector(p2(R)),k||(p=c({src:p,async:!0},g),(g=Cc.get(R))&&k$(p,g),k=b.createElement("script"),ys(k),xa(k,"link",p),b.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},P.set(R,k))}}function ISe(p,g){bp.M(p,g);var b=Ix;if(b&&p){var P=ha(b).hoistableScripts,R=Nx(p),k=P.get(R);k||(k=b.querySelector(p2(R)),k||(p=c({src:p,async:!0,type:"module"},g),(g=Cc.get(R))&&k$(p,g),k=b.createElement("script"),ys(k),xa(k,"link",p),b.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},P.set(R,k))}}function SZ(p,g,b,P){var R=(R=Ne.current)?KI(R):null;if(!R)throw Error(s(446));switch(p){case"meta":case"title":return null;case"style":return typeof b.precedence=="string"&&typeof b.href=="string"?(g=Dx(b.href),b=ha(R).hoistableStyles,P=b.get(g),P||(P={type:"style",instance:null,count:0,state:null},b.set(g,P)),P):{type:"void",instance:null,count:0,state:null};case"link":if(b.rel==="stylesheet"&&typeof b.href=="string"&&typeof b.precedence=="string"){p=Dx(b.href);var k=ha(R).hoistableStyles,Z=k.get(p);if(Z||(R=R.ownerDocument||R,Z={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},k.set(p,Z),(k=R.querySelector(m2(p)))&&!k._p&&(Z.instance=k,Z.state.loading=5),Cc.has(p)||(b={rel:"preload",as:"style",href:b.href,crossOrigin:b.crossOrigin,integrity:b.integrity,media:b.media,hrefLang:b.hrefLang,referrerPolicy:b.referrerPolicy},Cc.set(p,b),k||DSe(R,p,b,Z.state))),g&&P===null)throw Error(s(528,""));return Z}if(g&&P!==null)throw Error(s(529,""));return null;case"script":return g=b.async,b=b.src,typeof b=="string"&&g&&typeof g!="function"&&typeof g!="symbol"?(g=Nx(b),b=ha(R).hoistableScripts,P=b.get(g),P||(P={type:"script",instance:null,count:0,state:null},b.set(g,P)),P):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,p))}}function Dx(p){return'href="'+Fs(p)+'"'}function m2(p){return'link[rel="stylesheet"]['+p+"]"}function EZ(p){return c({},p,{"data-precedence":p.precedence,precedence:null})}function DSe(p,g,b,P){p.querySelector('link[rel="preload"][as="style"]['+g+"]")?P.loading=1:(g=p.createElement("link"),P.preload=g,g.addEventListener("load",function(){return P.loading|=1}),g.addEventListener("error",function(){return P.loading|=2}),xa(g,"link",b),ys(g),p.head.appendChild(g))}function Nx(p){return'[src="'+Fs(p)+'"]'}function p2(p){return"script[async]"+p}function CZ(p,g,b){if(g.count++,g.instance===null)switch(g.type){case"style":var P=p.querySelector('style[data-href~="'+Fs(b.href)+'"]');if(P)return g.instance=P,ys(P),P;var R=c({},b,{"data-href":b.href,"data-precedence":b.precedence,href:null,precedence:null});return P=(p.ownerDocument||p).createElement("style"),ys(P),xa(P,"style",R),QI(P,b.precedence,p),g.instance=P;case"stylesheet":R=Dx(b.href);var k=p.querySelector(m2(R));if(k)return g.state.loading|=4,g.instance=k,ys(k),k;P=EZ(b),(R=Cc.get(R))&&F$(P,R),k=(p.ownerDocument||p).createElement("link"),ys(k);var Z=k;return Z._p=new Promise(function(ie,pe){Z.onload=ie,Z.onerror=pe}),xa(k,"link",P),g.state.loading|=4,QI(k,b.precedence,p),g.instance=k;case"script":return k=Nx(b.src),(R=p.querySelector(p2(k)))?(g.instance=R,ys(R),R):(P=b,(R=Cc.get(k))&&(P=c({},b),k$(P,R)),p=p.ownerDocument||p,R=p.createElement("script"),ys(R),xa(R,"link",P),p.head.appendChild(R),g.instance=R);case"void":return null;default:throw Error(s(443,g.type))}else g.type==="stylesheet"&&(g.state.loading&4)===0&&(P=g.instance,g.state.loading|=4,QI(P,b.precedence,p));return g.instance}function QI(p,g,b){for(var P=b.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),R=P.length?P[P.length-1]:null,k=R,Z=0;Z<P.length;Z++){var ie=P[Z];if(ie.dataset.precedence===g)k=ie;else if(k!==R)break}k?k.parentNode.insertBefore(p,k.nextSibling):(g=b.nodeType===9?b.head:b,g.insertBefore(p,g.firstChild))}function F$(p,g){p.crossOrigin==null&&(p.crossOrigin=g.crossOrigin),p.referrerPolicy==null&&(p.referrerPolicy=g.referrerPolicy),p.title==null&&(p.title=g.title)}function k$(p,g){p.crossOrigin==null&&(p.crossOrigin=g.crossOrigin),p.referrerPolicy==null&&(p.referrerPolicy=g.referrerPolicy),p.integrity==null&&(p.integrity=g.integrity)}var JI=null;function TZ(p,g,b){if(JI===null){var P=new Map,R=JI=new Map;R.set(b,P)}else R=JI,P=R.get(b),P||(P=new Map,R.set(b,P));if(P.has(p))return P;for(P.set(p,null),b=b.getElementsByTagName(p),R=0;R<b.length;R++){var k=b[R];if(!(k[dl]||k[Sn]||p==="link"&&k.getAttribute("rel")==="stylesheet")&&k.namespaceURI!=="http://www.w3.org/2000/svg"){var Z=k.getAttribute(g)||"";Z=p+Z;var ie=P.get(Z);ie?ie.push(k):P.set(Z,[k])}}return P}function PZ(p,g,b){p=p.ownerDocument||p,p.head.insertBefore(b,g==="title"?p.querySelector("head > title"):null)}function NSe(p,g,b){if(b===1||g.itemProp!=null)return!1;switch(p){case"meta":case"title":return!0;case"style":if(typeof g.precedence!="string"||typeof g.href!="string"||g.href==="")break;return!0;case"link":if(typeof g.rel!="string"||typeof g.href!="string"||g.href===""||g.onLoad||g.onError)break;switch(g.rel){case"stylesheet":return p=g.disabled,typeof g.precedence=="string"&&p==null;default:return!0}case"script":if(g.async&&typeof g.async!="function"&&typeof g.async!="symbol"&&!g.onLoad&&!g.onError&&g.src&&typeof g.src=="string")return!0}return!1}function MZ(p){return!(p.type==="stylesheet"&&(p.state.loading&3)===0)}var f2=null;function RSe(){}function OSe(p,g,b){if(f2===null)throw Error(s(475));var P=f2;if(g.type==="stylesheet"&&(typeof b.media!="string"||matchMedia(b.media).matches!==!1)&&(g.state.loading&4)===0){if(g.instance===null){var R=Dx(b.href),k=p.querySelector(m2(R));if(k){p=k._p,p!==null&&typeof p=="object"&&typeof p.then=="function"&&(P.count++,P=eD.bind(P),p.then(P,P)),g.state.loading|=4,g.instance=k,ys(k);return}k=p.ownerDocument||p,b=EZ(b),(R=Cc.get(R))&&F$(b,R),k=k.createElement("link"),ys(k);var Z=k;Z._p=new Promise(function(ie,pe){Z.onload=ie,Z.onerror=pe}),xa(k,"link",b),g.instance=k}P.stylesheets===null&&(P.stylesheets=new Map),P.stylesheets.set(g,p),(p=g.state.preload)&&(g.state.loading&3)===0&&(P.count++,g=eD.bind(P),p.addEventListener("load",g),p.addEventListener("error",g))}}function LSe(){if(f2===null)throw Error(s(475));var p=f2;return p.stylesheets&&p.count===0&&$$(p,p.stylesheets),0<p.count?function(g){var b=setTimeout(function(){if(p.stylesheets&&$$(p,p.stylesheets),p.unsuspend){var P=p.unsuspend;p.unsuspend=null,P()}},6e4);return p.unsuspend=g,function(){p.unsuspend=null,clearTimeout(b)}}:null}function eD(){if(this.count--,this.count===0){if(this.stylesheets)$$(this,this.stylesheets);else if(this.unsuspend){var p=this.unsuspend;this.unsuspend=null,p()}}}var tD=null;function $$(p,g){p.stylesheets=null,p.unsuspend!==null&&(p.count++,tD=new Map,g.forEach(FSe,p),tD=null,eD.call(p))}function FSe(p,g){if(!(g.state.loading&4)){var b=tD.get(p);if(b)var P=b.get(null);else{b=new Map,tD.set(p,b);for(var R=p.querySelectorAll("link[data-precedence],style[data-precedence]"),k=0;k<R.length;k++){var Z=R[k];(Z.nodeName==="LINK"||Z.getAttribute("media")!=="not all")&&(b.set(Z.dataset.precedence,Z),P=Z)}P&&b.set(null,P)}R=g.instance,Z=R.getAttribute("data-precedence"),k=b.get(Z)||P,k===P&&b.set(null,R),b.set(Z,R),this.count++,P=eD.bind(this),R.addEventListener("load",P),R.addEventListener("error",P),k?k.parentNode.insertBefore(R,k.nextSibling):(p=p.nodeType===9?p.head:p,p.insertBefore(R,p.firstChild)),g.state.loading|=4}}var g2={$$typeof:T,Provider:null,Consumer:null,_currentValue:ee,_currentValue2:ee,_threadCount:0};function kSe(p,g,b,P,R,k,Z,ie){this.tag=1,this.containerInfo=p,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Qe(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qe(0),this.hiddenUpdates=Qe(null),this.identifierPrefix=P,this.onUncaughtError=R,this.onCaughtError=k,this.onRecoverableError=Z,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ie,this.incompleteTransitions=new Map}function AZ(p,g,b,P,R,k,Z,ie,pe,Ue,rt,ut){return p=new kSe(p,g,b,Z,ie,pe,Ue,ut),g=1,k===!0&&(g|=24),k=gl(3,null,null,g),p.current=k,k.stateNode=p,g=ux(),g.refCount++,p.pooledCache=g,g.refCount++,k.memoizedState={element:P,isDehydrated:b,cache:g},Ke(k),p}function IZ(p){return p?(p=ug,p):ug}function DZ(p,g,b,P,R,k){R=IZ(R),P.context===null?P.context=R:P.pendingContext=R,P=vt(g),P.payload={element:b},k=k===void 0?null:k,k!==null&&(P.callback=k),b=Ft(p,P,g),b!==null&&($u(b,p,g),Ht(b,p,g))}function NZ(p,g){if(p=p.memoizedState,p!==null&&p.dehydrated!==null){var b=p.retryLane;p.retryLane=b!==0&&b<g?b:g}}function U$(p,g){NZ(p,g),(p=p.alternate)&&NZ(p,g)}function RZ(p){if(p.tag===13){var g=ka(p,67108864);g!==null&&$u(g,p,67108864),U$(p,67108864)}}var iD=!0;function $Se(p,g,b,P){var R=Y.T;Y.T=null;var k=W.p;try{W.p=2,V$(p,g,b,P)}finally{W.p=k,Y.T=R}}function USe(p,g,b,P){var R=Y.T;Y.T=null;var k=W.p;try{W.p=8,V$(p,g,b,P)}finally{W.p=k,Y.T=R}}function V$(p,g,b,P){if(iD){var R=z$(P);if(R===null)P$(p,g,P,sD,b),LZ(p,P);else if(zSe(R,p,g,b,P))P.stopPropagation();else if(LZ(p,P),g&4&&-1<VSe.indexOf(p)){for(;R!==null;){var k=Bl(R);if(k!==null)switch(k.tag){case 3:if(k=k.stateNode,k.current.memoizedState.isDehydrated){var Z=Tt(k.pendingLanes);if(Z!==0){var ie=k;for(ie.pendingLanes|=2,ie.entangledLanes|=2;Z;){var pe=1<<31-dt(Z);ie.entanglements[1]|=pe,Z&=~pe}Hd(k),(yn&6)===0&&(VI=$e()+500,u2(0))}}break;case 13:ie=ka(k,2),ie!==null&&$u(ie,k,2),GI(),U$(k,2)}if(k=z$(P),k===null&&P$(p,g,P,sD,b),k===R)break;R=k}R!==null&&P.stopPropagation()}else P$(p,g,P,null,b)}}function z$(p){return p=Jf(p),G$(p)}var sD=null;function G$(p){if(sD=null,p=La(p),p!==null){var g=r(p);if(g===null)p=null;else{var b=g.tag;if(b===13){if(p=o(g),p!==null)return p;p=null}else if(b===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;p=null}else g!==p&&(p=null)}}return sD=p,null}function OZ(p){switch(p){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(wt()){case $i:return 2;case Mt:return 8;case le:case te:return 32;case De:return 268435456;default:return 32}default:return 32}}var B$=!1,Ag=null,Ig=null,Dg=null,_2=new Map,y2=new Map,Ng=[],VSe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function LZ(p,g){switch(p){case"focusin":case"focusout":Ag=null;break;case"dragenter":case"dragleave":Ig=null;break;case"mouseover":case"mouseout":Dg=null;break;case"pointerover":case"pointerout":_2.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":y2.delete(g.pointerId)}}function v2(p,g,b,P,R,k){return p===null||p.nativeEvent!==k?(p={blockedOn:g,domEventName:b,eventSystemFlags:P,nativeEvent:k,targetContainers:[R]},g!==null&&(g=Bl(g),g!==null&&RZ(g)),p):(p.eventSystemFlags|=P,g=p.targetContainers,R!==null&&g.indexOf(R)===-1&&g.push(R),p)}function zSe(p,g,b,P,R){switch(g){case"focusin":return Ag=v2(Ag,p,g,b,P,R),!0;case"dragenter":return Ig=v2(Ig,p,g,b,P,R),!0;case"mouseover":return Dg=v2(Dg,p,g,b,P,R),!0;case"pointerover":var k=R.pointerId;return _2.set(k,v2(_2.get(k)||null,p,g,b,P,R)),!0;case"gotpointercapture":return k=R.pointerId,y2.set(k,v2(y2.get(k)||null,p,g,b,P,R)),!0}return!1}function FZ(p){var g=La(p.target);if(g!==null){var b=r(g);if(b!==null){if(g=b.tag,g===13){if(g=o(b),g!==null){p.blockedOn=g,Le(p.priority,function(){if(b.tag===13){var P=ku();P=hn(P);var R=ka(b,P);R!==null&&$u(R,b,P),U$(b,P)}});return}}else if(g===3&&b.stateNode.current.memoizedState.isDehydrated){p.blockedOn=b.tag===3?b.stateNode.containerInfo:null;return}}}p.blockedOn=null}function nD(p){if(p.blockedOn!==null)return!1;for(var g=p.targetContainers;0<g.length;){var b=z$(p.nativeEvent);if(b===null){b=p.nativeEvent;var P=new b.constructor(b.type,b);_c=P,b.target.dispatchEvent(P),_c=null}else return g=Bl(b),g!==null&&RZ(g),p.blockedOn=b,!1;g.shift()}return!0}function kZ(p,g,b){nD(p)&&b.delete(g)}function GSe(){B$=!1,Ag!==null&&nD(Ag)&&(Ag=null),Ig!==null&&nD(Ig)&&(Ig=null),Dg!==null&&nD(Dg)&&(Dg=null),_2.forEach(kZ),y2.forEach(kZ)}function rD(p,g){p.blockedOn===g&&(p.blockedOn=null,B$||(B$=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,GSe)))}var oD=null;function $Z(p){oD!==p&&(oD=p,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){oD===p&&(oD=null);for(var g=0;g<p.length;g+=3){var b=p[g],P=p[g+1],R=p[g+2];if(typeof P!="function"){if(G$(P||b)===null)continue;break}var k=Bl(b);k!==null&&(p.splice(g,3),g-=3,Gk(k,{pending:!0,data:R,method:b.method,action:P},P,R))}}))}function x2(p){function g(pe){return rD(pe,p)}Ag!==null&&rD(Ag,p),Ig!==null&&rD(Ig,p),Dg!==null&&rD(Dg,p),_2.forEach(g),y2.forEach(g);for(var b=0;b<Ng.length;b++){var P=Ng[b];P.blockedOn===p&&(P.blockedOn=null)}for(;0<Ng.length&&(b=Ng[0],b.blockedOn===null);)FZ(b),b.blockedOn===null&&Ng.shift();if(b=(p.ownerDocument||p).$$reactFormReplay,b!=null)for(P=0;P<b.length;P+=3){var R=b[P],k=b[P+1],Z=R[Js]||null;if(typeof k=="function")Z||$Z(b);else if(Z){var ie=null;if(k&&k.hasAttribute("formAction")){if(R=k,Z=k[Js]||null)ie=Z.formAction;else if(G$(R)!==null)continue}else ie=Z.action;typeof ie=="function"?b[P+1]=ie:(b.splice(P,3),P-=3),$Z(b)}}}function q$(p){this._internalRoot=p}aD.prototype.render=q$.prototype.render=function(p){var g=this._internalRoot;if(g===null)throw Error(s(409));var b=g.current,P=ku();DZ(b,P,p,g,null,null)},aD.prototype.unmount=q$.prototype.unmount=function(){var p=this._internalRoot;if(p!==null){this._internalRoot=null;var g=p.containerInfo;DZ(p.current,2,null,p,null,null),GI(),g[Br]=null}};function aD(p){this._internalRoot=p}aD.prototype.unstable_scheduleHydration=function(p){if(p){var g=Ms();p={blockedOn:null,target:p,priority:g};for(var b=0;b<Ng.length&&g!==0&&g<Ng[b].priority;b++);Ng.splice(b,0,p),b===0&&FZ(p)}};var UZ=e.version;if(UZ!=="19.1.0")throw Error(s(527,UZ,"19.1.0"));W.findDOMNode=function(p){var g=p._reactInternals;if(g===void 0)throw typeof p.render=="function"?Error(s(188)):(p=Object.keys(p).join(","),Error(s(268,p)));return p=l(g),p=p!==null?u(p):null,p=p===null?null:p.stateNode,p};var BSe={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Y,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var lD=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!lD.isDisabled&&lD.supportsFiber)try{Ze=lD.inject(BSe),Ct=lD}catch{}}return w2.createRoot=function(p,g){if(!n(p))throw Error(s(299));var b=!1,P="",R=tW,k=iW,Z=sW,ie=null;return g!=null&&(g.unstable_strictMode===!0&&(b=!0),g.identifierPrefix!==void 0&&(P=g.identifierPrefix),g.onUncaughtError!==void 0&&(R=g.onUncaughtError),g.onCaughtError!==void 0&&(k=g.onCaughtError),g.onRecoverableError!==void 0&&(Z=g.onRecoverableError),g.unstable_transitionCallbacks!==void 0&&(ie=g.unstable_transitionCallbacks)),g=AZ(p,1,!1,null,null,b,P,R,k,Z,ie,null),p[Br]=g.current,T$(p),new q$(g)},w2.hydrateRoot=function(p,g,b){if(!n(p))throw Error(s(299));var P=!1,R="",k=tW,Z=iW,ie=sW,pe=null,Ue=null;return b!=null&&(b.unstable_strictMode===!0&&(P=!0),b.identifierPrefix!==void 0&&(R=b.identifierPrefix),b.onUncaughtError!==void 0&&(k=b.onUncaughtError),b.onCaughtError!==void 0&&(Z=b.onCaughtError),b.onRecoverableError!==void 0&&(ie=b.onRecoverableError),b.unstable_transitionCallbacks!==void 0&&(pe=b.unstable_transitionCallbacks),b.formState!==void 0&&(Ue=b.formState)),g=AZ(p,1,!0,g,b??null,P,R,k,Z,ie,pe,Ue),g.context=IZ(null),b=g.current,P=ku(),P=hn(P),R=vt(P),R.callback=null,Ft(b,R,P),b=P,g.current.lanes=b,ot(g,b),Hd(g),p[Br]=g.current,T$(p),new aD(g)},w2.version="19.1.0",w2}var WZ;function iEe(){if(WZ)return j$.exports;WZ=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),j$.exports=tEe(),j$.exports}var sEe=iEe(),Ve=NM();function y(t,e,i,s){var n,r=arguments.length,o=r<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,i):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,i,o):n(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o}function zmt(t,e){return function(i,s){e(i,s,t)}}function Gmt(t,e,i,s){function n(r){return r instanceof i?r:new i(function(o){o(r)})}return new(i||(i=Promise))(function(r,o){function a(c){try{u(s.next(c))}catch(h){o(h)}}function l(c){try{u(s.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):n(c.value).then(a,l)}u((s=s.apply(t,[])).next())})}function Da(t,e,i){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var s,n;if(s===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=e[Symbol.dispose]}if(typeof s!="function")throw new TypeError("Object not disposable.");n&&(s=function(){try{n.call(this)}catch(r){return Promise.reject(r)}}),t.stack.push({value:e,dispose:s,async:i})}return e}var nEe=typeof SuppressedError=="function"?SuppressedError:function(t,e,i){var s=new Error(i);return s.name="SuppressedError",s.error=t,s.suppressed=e,s};function Hf(t){function e(r){t.error=t.hasError?new nEe(r,t.error,"An error was suppressed during disposal."):r,t.hasError=!0}var i,s=0;function n(){for(;i=t.stack.pop();)try{if(!i.async&&s===1)return s=0,t.stack.push(i),Promise.resolve().then(n);if(i.dispose){var r=i.dispose.call(i.value);if(i.async)return s|=2,Promise.resolve(r).then(n,function(o){return e(o),n()})}else s|=1}catch(o){e(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return n()}let q_;function ke(t){return typeof q_[t]=="function"?q_[t]=q_[t](globalThis):q_[t]}var Cle,Tle,Ple,Mle;q_=(Cle=globalThis.dojoConfig)!=null&&Cle.has||(Tle=globalThis.esriConfig)!=null&&Tle.has?{...(Ple=globalThis.dojoConfig)==null?void 0:Ple.has,...(Mle=globalThis.esriConfig)==null?void 0:Mle.has}:{},ke.add=(t,e,i,s)=>{(s||q_[t]===void 0)&&(q_[t]=e),i&&ke(t)},ke.cache=q_,ke.add("big-integer-warning-enabled",!0),ke.add("esri-deprecation-warnings",!0),ke.add("esri-tests-disable-screenshots",!1),ke.add("esri-tests-use-full-window",!1),ke.add("esri-tests-post-to-influx",!0),ke.add("esri-cim-animations-enable-status","enabled"),ke.add("esri-cim-animations-spotlight",!1),ke.add("esri-cim-animations-freeze-time",!1),ke.add("enable-feature:multiple-highlights",!0),(()=>{var e;ke.add("host-webworker",globalThis.WorkerGlobalScope!==void 0&&self instanceof globalThis.WorkerGlobalScope);const t=typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document;if(ke.add("host-browser",t),ke.add("host-node",typeof globalThis.process=="object"&&((e=globalThis.process.versions)==null?void 0:e.node)&&globalThis.process.versions.v8),ke.add("dom",t),ke("host-browser")){const i=navigator,s=i.userAgent,n=i.appVersion,r=parseFloat(n);if(ke.add("wp",parseFloat(s.split("Windows Phone")[1])||void 0),ke.add("msapp",parseFloat(s.split("MSAppHost/")[1])||void 0),ke.add("khtml",n.includes("Konqueror")?r:void 0),ke.add("edge",parseFloat(s.split("Edge/")[1])||void 0),ke.add("opr",parseFloat(s.split("OPR/")[1])||void 0),ke.add("webkit",!ke("wp")&&!ke("edge")&&parseFloat(s.split("WebKit/")[1])||void 0),ke.add("chrome",!ke("edge")&&!ke("opr")&&parseFloat(s.split("Chrome/")[1])||void 0),ke.add("android",!ke("wp")&&parseFloat(s.split("Android ")[1])||void 0),ke.add("safari",!n.includes("Safari")||ke("wp")||ke("chrome")||ke("android")||ke("edge")||ke("opr")?void 0:parseFloat(n.split("Version/")[1])),ke.add("mac",n.includes("Macintosh")),!ke("wp")&&/(iPhone|iPod|iPad)/.test(s)){const o=RegExp.$1.replace(/P/,"p"),a=/OS ([\d_]+)/.test(s)?RegExp.$1:"1",l=parseFloat(a.replace(/_/,".").replaceAll("_",""));ke.add(o,l),ke.add("ios",l)}ke("webkit")||(!s.includes("Gecko")||ke("wp")||ke("khtml")||ke("edge")||ke.add("mozilla",r),ke("mozilla")&&ke.add("ff",parseFloat(s.split("Firefox/")[1]||s.split("Minefield/")[1])||void 0))}})(),(()=>{if(globalThis.navigator){const t=navigator.userAgent,e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(t),i=/iPhone/i.test(t);e&&ke.add("esri-mobile",e),i&&ke.add("esri-iPhone",i),ke.add("esri-geolocation",!!navigator.geolocation)}ke.add("esri-wasm","WebAssembly"in globalThis),ke.add("esri-performance-mode-frames-between-render",20),ke.add("esri-force-performance-mode",!1),ke.add("esri-shared-array-buffer",()=>{const t="SharedArrayBuffer"in globalThis,e=globalThis.crossOriginIsolated===!1;return t&&!e}),ke.add("wasm-simd",()=>{const t=[0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11];return WebAssembly.validate(new Uint8Array(t))}),ke.add("esri-atomics","Atomics"in globalThis),ke.add("esri-workers","Worker"in globalThis),ke.add("web-feat:cache","caches"in globalThis),ke.add("esri-workers-arraybuffer-transfer",!ke("safari")||Number(ke("safari"))>=12),ke.add("workers-pool-size",8),ke.add("featurelayer-simplify-thresholds",[.5,.5,.5,.5]),ke.add("featurelayer-simplify-payload-size-factors",[1,1,4]),ke.add("featurelayer-fast-triangulation-enabled",!0),ke.add("featurelayer-animation-enabled",!0),ke.add("featurelayer-snapshot-enabled",!0),ke.add("featurelayer-snapshot-point-min-threshold",8e4),ke.add("featurelayer-snapshot-point-max-threshold",4e5),ke.add("featurelayer-snapshot-point-coverage",.1),ke.add("featurelayer-query-max-depth",4),ke.add("featurelayer-query-pausing-enabled",!1),ke.add("featurelayer-advanced-symbols",!1),ke.add("featurelayer-pbf",!0),ke.add("featurelayer-pbf-statistics",!1),ke.add("feature-layers-workers",!0),ke.add("feature-polyline-generalization-factor",1),ke.add("mapview-transitions-duration",200),ke.add("mapview-essential-goto-duration",200),ke.add("mapview-srswitch-adjust-rotation-scale-threshold",24e6),ke.add("mapserver-pbf-version-support",10.81),ke.add("mapservice-popup-identify-max-tolerance",20),ke.add("request-queue-concurrency-hosted",16),ke.add("request-queue-concurrency-non-hosted",4),ke.add("curve-densification-coarse-segments",128),ke.add("curve-densification-max-segments",2e3),ke.add("curve-densification-min-segments",3),ke.add("curve-densification-pixels-per-segment",16),ke.add("view-readyState-waiting-delay",1e3),ke.add("gradient-depth-bias",.01),ke.add("gradient-depth-epsilon",1e-8),ke("host-webworker")||ke("host-browser")&&(ke.add("esri-csp-restrictions",()=>{try{new Function}catch{return!0}return!1}),ke.add("esri-image-decode",()=>{if("decode"in new Image){const t=new Image;return t.src='data:image/svg+xml;charset=UTF-8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>',void t.decode().then(()=>{ke.add("esri-image-decode",!0,!0,!0)}).catch(()=>{ke.add("esri-image-decode",!1,!0,!0)})}return!1}),ke.add("esri-url-encodes-apostrophe",()=>{const t=window.document.createElement("a");return t.href="?'",t.href.includes("?%27")}))})();function Bmt(t){}function rEe(t){return()=>t}function qmt(t){return t}let vR=class F0{constructor(e=1){this._seed=e}set seed(e){this._seed=e??Math.random()*F0._m}getInt(){return this._seed=(F0._a*this._seed+F0._c)%F0._m,this._seed}getFloat(){return this.getInt()/(F0._m-1)}getIntRange(e,i){return Math.round(this.getFloatRange(e,i))}getFloatRange(e,i){const s=i-e;return e+this.getInt()/F0._m*s}};vR._m=2147483647,vR._a=48271,vR._c=0;const oEe=1.5,Hmt=1/oEe,jmt=.5;function Ymt(t,e){return e?t.filter((i,s,n)=>n.findIndex(e.bind(null,i))===s):Array.from(new Set(t))}function mF(t,e,i){if(t==null&&e==null)return!0;if(t==null||e==null||t.length!==e.length)return!1;if(i){for(let s=0;s<t.length;s++)if(!i(t[s],e[s]))return!1}else for(let s=0;s<t.length;s++)if(t[s]!==e[s])return!1;return!0}function ZZ(t,e,i){let s,n;return i?(s=e.filter(r=>!t.some(o=>i(o,r))),n=t.filter(r=>!e.some(o=>i(o,r)))):(s=e.filter(r=>!t.includes(r)),n=t.filter(r=>!e.includes(r))),{added:s,removed:n}}function Xmt(t){return t&&typeof t.length=="number"}let Lle=class{constructor(){this.last=0}};const Fle=new Lle;function nz(t,e,i,s){s=s||Fle;const n=Math.max(0,s.last-10);for(let o=n;o<i;++o)if(t[o]===e)return s.last=o,o;const r=Math.min(n,i);for(let o=0;o<r;++o)if(t[o]===e)return s.last=o,o;return-1}function aEe(t,e,i,s){const n=t.length,r=nz(t,e,n,s);if(r!==-1)return t[r]=t[n-1],t.pop(),e}const Eh=new Set;function lEe(t,e,i=t.length,s=e.length,n,r){if(s===0||i===0)return i;Eh.clear();for(let a=0;a<s;++a)Eh.add(e[a]);n=n||Fle;const o=Math.max(0,n.last-10);for(let a=o;a<i;++a)if(Eh.has(t[a])&&(r==null||r.push(t[a]),Eh.delete(t[a]),t[a]=t[i-1],--i,--a,Eh.size===0||i===0))return Eh.clear(),i;for(let a=0;a<o;++a)if(Eh.has(t[a])&&(r==null||r.push(t[a]),Eh.delete(t[a]),t[a]=t[i-1],--i,--a,Eh.size===0||i===0))return Eh.clear(),i;return Eh.clear(),i}function Zmt(t,e,i){const s=t.length;if(e>=s)return t.slice();const n=kle(i),r=new Set,o=[];for(;o.length<e;){const a=Math.floor(n()*s);r.has(a)||(r.add(a),o.push(t[a]))}return o}function kle(t){return t?(KZ.seed=t,()=>KZ.getFloat()):Math.random}const KZ=new vR;function Kmt(t,e){const i=kle(e);for(let s=t.length-1;s>0;s--){const n=Math.floor(i()*(s+1)),r=t[s];t[s]=t[n],t[n]=r}return t}function $le(t,e){const i=t.indexOf(e);return i!==-1?(t.splice(i,1),e):null}function Df(t,e){return t!=null}const Qmt=[];function Jmt(t){return t instanceof ArrayBuffer}function tH(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Int8Array"}function Ule(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Uint8Array"}function Vle(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Uint8ClampedArray"}function iH(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Int16Array"}function zle(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Uint16Array"}function sH(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Int32Array"}function Gle(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Uint32Array"}function pF(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Float32Array"}function fF(t){var e;return((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="Float64Array"}function uEe(t){return"buffer"in t}const Ble=1024;function ept(t){return fF(t)||pF(t)||sH(t)||iH(t)||tH(t)}function tpt(t){return fF(t)||pF(t)}function ipt(t){return fF(t)?179769e303:pF(t)?3402823e32:Gle(t)?4294967295:zle(t)?65535:Ule(t)||Vle(t)?255:sH(t)?2147483647:iH(t)?32767:tH(t)?127:256}function cEe(t,e){let i;for(i in t)t.hasOwnProperty(i)&&t[i]===void 0&&delete t[i];return t}function be(t){if(!t||typeof t!="object"||typeof t=="function")return t;const e=jle(t);if(e!=null)return e;if(cO(t))return t.clone();if(qle(t))return t.map(be);if(Hle(t))throw new Error("Trying to clone an unclonable Accessor instance");const i={};for(const s of Object.getOwnPropertyNames(t))i[s]=be(t[s]);return i}function rz(t){if(!t||typeof t!="object"||typeof t=="function"||"HTMLElement"in globalThis&&t instanceof HTMLElement)return t;const e=jle(t);if(e!=null)return e;if(qle(t)){let s=!0;const n=t.map(r=>{const o=rz(r);return r!=null&&o==null&&(s=!1),o});return s?n:null}if(cO(t))return t.clone();if(t instanceof File||t instanceof Blob)return t;if(Hle(t))return null;const i=new(Object.getPrototypeOf(t)).constructor;for(const s of Object.getOwnPropertyNames(t)){const n=t[s],r=rz(n);if(n!=null&&r==null)return null;i[s]=r}return i}function cO(t){return typeof t.clone=="function"}function qle(t){return typeof t.map=="function"&&typeof t.forEach=="function"}function Hle(t){return typeof t.notifyChange=="function"&&typeof t.watch=="function"}function QZ(t){if(Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}function jle(t){if(tH(t)||Ule(t)||Vle(t)||iH(t)||zle(t)||sH(t)||Gle(t)||pF(t)||fF(t))return t.slice();if(t instanceof Date)return new Date(t.getTime());if(t instanceof ArrayBuffer)return t.slice(0,t.byteLength);if(t instanceof Map){const e=new Map;for(const[i,s]of t)e.set(i,be(s));return e}if(t instanceof Set){const e=new Set;for(const i of t)e.add(be(i));return e}return null}function nH(t,e){return t===e||typeof t=="number"&&isNaN(t)&&typeof e=="number"&&isNaN(e)||typeof(t==null?void 0:t.getTime)=="function"&&typeof(e==null?void 0:e.getTime)=="function"&&t.getTime()===e.getTime()||!1}function Yle(t,e){return t===e||(t==null||typeof t=="string"?t===e:typeof t=="number"?t===e||typeof e=="number"&&isNaN(t)&&isNaN(e):t instanceof Date?e instanceof Date&&t.getTime()===e.getTime():Array.isArray(t)?Array.isArray(e)&&mF(t,e):t instanceof Set?e instanceof Set&&dEe(t,e):t instanceof Map?e instanceof Map&&mEe(t,e):!!QZ(t)&&QZ(e)&&hEe(t,e))}function hEe(t,e){if(t===null||e===null)return!1;const i=Object.keys(t);if(e===null||Object.keys(e).length!==i.length)return!1;for(const s of i)if(t[s]!==e[s]||!Object.prototype.hasOwnProperty.call(e,s))return!1;return!0}function dEe(t,e){if(t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0}function mEe(t,e){if(t.size!==e.size)return!1;for(const[i,s]of t){const n=e.get(i);if(n!==s||n===void 0&&!e.has(i))return!1}return!0}function rH(t,e,i=!1){return Wle(t,e,i)}function gF(t,e){if(e!=null)return e[t]||Xle(t.split("."),!1,e)}function la(t,e,i){const s=t.split("."),n=s.pop(),r=Xle(s,!0,i);r&&n&&(r[n]=e)}function JZ(t,e){if(t==null&&e==null)return!1;if(t==null||e==null)return!0;if(typeof t=="object"){if(Array.isArray(t)){const i=e;if(t.length!==i.length)return!0;for(let s=0;s<t.length;s++)if(JZ(t[s],i[s]))return!0;return!1}if(Object.keys(t).length!==Object.keys(e).length)return!0;for(const i in t)if(JZ(t[i],e[i]))return!0;return!1}return t!==e}function Xle(t,e,i){let s=i;for(const n of t){if(s==null)return;if(!(n in s)){if(!e)return;s[n]={}}s=s[n]}return s}function Wle(t,e,i){return e?Object.keys(e).reduce((s,n)=>{let r=s[n],o=e[n];return r===o?s:r===void 0?(s[n]=be(o),s):(Array.isArray(o)||Array.isArray(s)?(r=r?Array.isArray(r)?s[n]=r.slice():s[n]=[r]:s[n]=[],o&&(Array.isArray(o)||(o=[o]),i?o.forEach(a=>{r.includes(a)||r.push(a)}):s[n]=o.slice())):o&&typeof o=="object"?s[n]=Wle(r,o,i):s.hasOwnProperty(n)&&!e.hasOwnProperty(n)||(s[n]=o),s)},t||{}):t}const pEe=/\{([^}]+)\}/g;function eK(t){return t??""}function _F(t,e){return e?t.replaceAll(pEe,typeof e=="object"?(i,s)=>eK(gF(s,e)):(i,s)=>eK(e(s))):t}function spt(t,e){return t.replaceAll(/([.$?*|{}()[\]\\/+\-^])/g,i=>e!=null&&e.includes(i)?i:`\\${i}`)}function Zle(t){let e=0;for(let i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e|=0;return e}let tK;function npt(t){return tK??(tK=new DOMParser),tK.parseFromString(t||"","text/html").body.innerText||""}function rpt(t,e){return new RegExp(`{${e}}`,"ig").test(t)}function opt(t,...e){let i=t[0];for(let s=0;s<e.length;++s)i+=e[s]+t[s+1];return i}var Ale;const Ks={apiKey:void 0,applicationName:"",applicationUrl:(Ale=globalThis.location)==null?void 0:Ale.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",userPrivilegesApplied:!0,portalUrl:"https://www.arcgis.com",respectPrefersReducedMotion:!0,routeServiceUrl:"https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{crossOriginNoCorsDomains:null,httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],internalInterceptors:[],maxUrlLength:2e3,priority:"high",proxyRules:[],proxyUrl:null,timeout:62e3,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};if(globalThis.esriConfig&&(rH(Ks,globalThis.esriConfig,!0),delete Ks.has),!Ks.assetsPath){{const t="4.32";Ks.assetsPath=`https://js.arcgis.com/${t}/@arcgis/core/assets`}Ks.defaultAssetsPath=Ks.assetsPath}const iK={info:0,warn:1,error:2,none:3};let ht=class Gu{constructor(e){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},e.level!=null&&(this.level=e.level),e.writer!=null&&(this.writer=e.writer),this._module=e.module,Gu._loggers.set(this.module,this);const i=this.module.lastIndexOf(".");i!==-1&&(this._parent=Gu.getLogger(this.module.slice(0,i)))}get module(){return this._module}get parent(){return this._parent}error(...e){this._log("error","always",...e)}warn(...e){this._log("warn","always",...e)}info(...e){this._log("info","always",...e)}errorOnce(...e){this._log("error","once",...e)}warnOnce(...e){this._log("warn","once",...e)}infoOnce(...e){this._log("info","once",...e)}errorOncePerTick(...e){this._log("error","oncePerTick",...e)}warnOncePerTick(...e){this._log("warn","oncePerTick",...e)}infoOncePerTick(...e){this._log("info","oncePerTick",...e)}get test(){}static get test(){}static getLogger(e){return e=typeof e!="string"?e.declaredClass:e,Gu._loggers.get(e)||new Gu({module:e})}_log(e,i,...s){if(this._matchLevel(e)){if(i!=="always"&&!Gu._throttlingDisabled){const n=gEe(s),r=this._loggedMessages[e].get(n);if(i==="once"&&r!=null||i==="oncePerTick"&&r&&r>=Gu._tickCounter)return;this._loggedMessages[e].set(n,Gu._tickCounter),Gu._scheduleTickCounterIncrement()}for(const n of Ks.log.interceptors)if(n(e,this.module,...s))return;this._inheritedWriter()(e,this.module,...s)}}_parentWithMember(e,i){let s=this;for(;s!=null;){const n=s[e];if(n!=null)return n;s=s.parent}return i}_inheritedWriter(){return this._parentWithMember("writer",fEe)}_matchLevel(e){const i=Ks.log.level||"warn";return iK[this._parentWithMember("level",i)]<=iK[e]}static _scheduleTickCounterIncrement(){Gu._tickCounterScheduled||(Gu._tickCounterScheduled=!0,Promise.resolve().then(()=>{Gu._tickCounter++,Gu._tickCounterScheduled=!1}))}};function fEe(t,e,...i){console[t](`[${e}]`,...i)}function gEe(...t){return Zle(JSON.stringify(t,(i,s)=>typeof s!="object"||Array.isArray(s)?s:"[Object]"))}ht._loggers=new Map,ht._tickCounter=0,ht._tickCounterScheduled=!1,ht._throttlingDisabled=!1;function _Ee(t,e){for(const i of t.values())if(e(i))return!0;return!1}function apt(t,e){for(const i of t.values())if(e(i))return i;return null}function RM(t,e,i){const s=t.get(e);if(s!==void 0)return s;const n=i();return t.set(e,n),n}function lpt(t){const e=new Map;return i=>(e.has(i)||e.set(i,t(i)),e.get(i))}const bw=()=>ht.getLogger("esri.core.accessorSupport.ensureTypes");function yEe(t){return t==null?t:new Date(t)}function vEe(t){return t==null?t:!!t}function OM(t){return t==null?t:t.toString()}function Al(t,e=0){return t==null?t:(t=parseFloat(t),isNaN(t)?e:t)}function oH(t){return t==null?t:Math.round(parseFloat(t))}function xEe(t){return null}function bEe(t,e){return i=>{let s=t(i);return e.step!=null&&(s=Math.round(s/e.step)*e.step),e.min!=null&&(s=Math.max(e.min,s)),e.max!=null&&(s=Math.min(e.max,s)),s}}function Kle(t){return(t==null?void 0:t.constructor)&&t.constructor.__accessorMetadata__!==void 0}function hO(t,e){return e!=null&&t&&!(e instanceof t)}function Qle(t){return t&&"isCollection"in t}function sK(t){return t!=null&&t.Type?typeof t.Type=="function"?t.Type:t.Type.base:null}function wEe(t,e){if(!(e!=null&&e.constructor)||!Qle(e.constructor))return oz(t,e)?e:new t(e);const i=sK(t.prototype.itemType),s=sK(e.constructor.prototype.itemType);return i?s?i===s?e:i.prototype.isPrototypeOf(s.prototype)?new t(e):(oz(t,e),e):new t(e):e}function oz(t,e){return!!Kle(e)&&(bw().error("Accessor#set","Assigning an instance of '"+(e.declaredClass||"unknown")+"' which is not a subclass of '"+yF(t)+"'"),!0)}function OS(t,e){return e==null?e:Qle(t)?wEe(t,e):hO(t,e)?oz(t,e)?e:new t(e):e}function yF(t){var e;return((e=t==null?void 0:t.prototype)==null?void 0:e.declaredClass)||"unknown"}const SEe=new WeakMap;function EEe(t){switch(t){case Number:return e=>Al(e);case zs:return oH;case Boolean:return vEe;case String:return OM;case Date:return yEe;case vF:return xEe;default:return RM(SEe,t,()=>OS.bind(null,t))}}function xo(t,e){const i=EEe(t);return arguments.length===1?i:i(e)}function gP(t,e,i){return arguments.length===1?gP.bind(null,t):e&&(Array.isArray(e)?e.map(s=>t(s,i)):[t(e,i)])}function CEe(t,e){return arguments.length===1?gP(i=>xo(t,i)):gP(i=>xo(t,i),e)}function Jle(t,e,i){return e!==0&&Array.isArray(i)?i.map(s=>Jle(t,e-1,s)):t(i)}function dO(t,e,i){if(arguments.length===2)return r=>dO(t,e,r);if(!i)return i;i=Jle(t,e,i);let s=e,n=i;for(;s>0&&Array.isArray(n);)s--,n=n[0];if(n!==void 0)for(let r=0;r<s;r++)i=[i];return i}function TEe(t,e,i){return arguments.length===2?dO(s=>xo(t,s),e):dO(s=>xo(t,s),e,i)}function eue(t){return!!Array.isArray(t)&&!t.some(e=>{const i=typeof e;return!(i==="string"||i==="number"||i==="function"&&t.length>1)})}function az(t,e){if(arguments.length===2)return az(t).call(null,e);const i=new Set,s=t.filter(a=>typeof a!="function"),n=t.filter(a=>typeof a=="function");for(const a of t)typeof a!="string"&&typeof a!="number"||i.add(a);let r=null,o=null;return(a,l)=>{if(a==null)return a;const u=typeof a,c=u==="string"||u==="number";return c&&(i.has(a)||n.some(h=>u==="string"&&h===String||u==="number"&&h===Number))||u==="object"&&n.some(h=>!hO(a,h))?a:(c&&s.length?(r||(r=s.map(h=>typeof h=="string"?`'${h}'`:`${h}`).join(", ")),bw().error("Accessor#set",`'${a}' is not a valid value for this property, only the following values are valid: ${r}`)):typeof a=="object"&&n.length?(o||(o=n.map(h=>yF(h)).join(", ")),bw().error("Accessor#set",`'${a}' is not a valid value for this property, value must be one of ${o}`)):bw().error("Accessor#set",`'${a}' is not a valid value for this property`),l&&(l.valid=!1),null)}}function _d(t,e){if(arguments.length===2)return _d(t).call(null,e);const i={},s=[],n=[];for(const l in t.typeMap){const u=t.typeMap[l];i[l]=xo(u),s.push(yF(u)),n.push(l)}const r=()=>`'${s.join("', '")}'`,o=()=>`'${n.join("', '")}'`,a=typeof t.key=="string"?l=>l[t.key]:t.key;return l=>{if(t.base&&!hO(t.base,l)||l==null)return l;const u=a(l)||t.defaultKeyValue,c=i[u];if(!c)return bw().error("Accessor#set",`Invalid property value, value needs to be one of ${r()}, or a plain object that can autocast (having .type = ${o()})`),null;if(!hO(t.typeMap[u],l))return l;if(typeof t.key=="string"&&!Kle(l)){const h={};for(const d in l)d!==t.key&&(h[d]=l[d]);return c(h)}return c(l)}}let zs=class{},vF=class{};const hpt={native:t=>({type:"native",value:t}),array:t=>({type:"array",value:t}),oneOf:t=>({type:"one-of",values:t})};function PEe(t){if(!t||!("type"in t))return!1;switch(t.type){case"native":case"array":case"one-of":return!0}return!1}function tue(t){switch(t.type){case"native":return xo(t.value);case"array":return gP(tue(t.value));case"one-of":return MEe(t);default:return null}}function MEe(t){let e=null;return(i,s)=>uz(i,t)?i:(e==null&&(e=lz(t)),bw().error("Accessor#set",`Invalid property value, value needs to be of type ${e}`),s&&(s.valid=!1),null)}function lz(t){switch(t.type){case"native":switch(t.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case zs:return"integer";case Date:return"date";case vF:return"null";default:return yF(t.value)}case"array":return`array of ${lz(t.value)}`;case"one-of":{const e=t.values.map(i=>lz(i));return`one of ${e.slice(0,-1)} or ${e[e.length-1]}`}}return"unknown"}function uz(t,e){if(t==null)return!0;switch(e.type){case"native":switch(e.value){case Number:case zs:return typeof t=="number";case Boolean:return typeof t=="boolean";case String:return typeof t=="string";case vF:return t===null}return t instanceof e.value;case"array":return!!Array.isArray(t)&&!t.some(i=>!uz(i,e.value));case"one-of":return e.values.some(i=>uz(t,i))}}const AEe={remove:()=>{}};function Gs(t){return t?{remove(){t&&(t(),t=void 0)}}:AEe}function iue(t){t.forEach(e=>e==null?void 0:e.remove())}function dpt(t){iue(t),t.length=0}function LM(t){return Gs(()=>iue(t))}function mpt(t){return Gs(()=>{var e;return(e=t())==null?void 0:e.remove()})}function ppt(t){return Gs(()=>t==null?void 0:t.abort())}function IEe(t){return Gs(t!=null?()=>t.destroy():void 0)}function Su(t){return t.__accessor__??null}function DEe(t,e){var i;return((i=t==null?void 0:t.metadata)==null?void 0:i[e])!=null}function xR(t,e,i){return i?mO(t,e,{policy:i,path:""}):mO(t,e,null)}function mO(t,e,i){return e?Object.keys(e).reduce((s,n)=>{const r=n;let o=null,a="merge";if(i&&(o=i.path?`${i.path}.${n}`:n,a=i.policy(o)),a==="replace"||a==="replace-arrays"&&Array.isArray(s[r]))return s[r]=e[r],s;if(s[r]===void 0)return s[r]=be(e[r]),s;let l=s[r],u=e[r];if(l===u)return s;if(Array.isArray(u)||Array.isArray(s))l=l?Array.isArray(l)?s[r]=l.slice():s[r]=[l]:s[r]=[],u&&(Array.isArray(u)||(u=[u]),u.forEach(c=>{l.includes(c)||l.push(c)}));else if(u&&typeof u=="object")if(i){const c=i.path;i.path=o,s[r]=mO(l,u,i),i.path=c}else s[r]=mO(l,u,null);else s.hasOwnProperty(n)&&!e.hasOwnProperty(n)||(s[r]=u);return s},t||{}):t}function sue(t){return Array.isArray(t)?t:t.split(".")}function nK(t){return t.includes(",")?t.split(",").map(e=>e.trim()):[t.trim()]}function NEe(t){if(Array.isArray(t)){const e=[];for(const i of t)e.push(...nK(i));return e}return nK(t)}function nue(t,e,i,s){const n=NEe(e);if(n.length!==1){const r=n.map(o=>s(t,o,i));return LM(r)}return s(t,n[0],i)}function rue(t,e){const i=t[t.length-1]==="?"?t.slice(0,-1):t;if(e.getItemAt!=null||Array.isArray(e)){const n=parseInt(i,10);if(!isNaN(n))return Array.isArray(e)?e[n]:e.at(n)}const s=Su(e);return DEe(s,i)?s.get(i):e[i]}function oue(t,e,i){if(t==null)return t;const s=rue(e[i],t);return!s&&i<e.length-1?void 0:i===e.length-1?s:oue(s,e,i+1)}function FM(t,e,i=0){return typeof e!="string"||e.includes(".")?oue(t,sue(e),i):rue(e,t)}function Tm(t,e){return FM(t,e)}function rK(t,e){return FM(e,t)!==void 0}function kM(t){let e=t.constructor.__accessorMetadata__;const i=Object.prototype.hasOwnProperty.call(t.constructor,"__accessorMetadata__");if(e){if(!i){e=Object.create(e);for(const s in e)e[s]=be(e[s]);Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0})}}else e={},Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0});return t.constructor.__accessorMetadata__}function xF(t,e){const i=kM(t);let s=i[e];return s||(s=i[e]={}),s}function REe(t,e){return xR(t,e,LEe)}const OEe=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function LEe(t){return OEe.test(t)?"replace":"merge"}function FEe(t,e){return t.replaceAll(/\$\{([^\s:}]*)(?::([^\s:}]+))?\}/g,(i,s)=>s===""?"$":(gF(s,e)??"").toString())}let aue=class{constructor(e,i,s=void 0){this.name=e,this.details=s,this.message=(i&&FEe(i,s))??""}toString(){return"["+this.name+"]: "+this.message}},Se=class lue extends aue{constructor(e,i,s){super(e,i,s)}toJSON(){if(this.details!=null)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,(e,i)=>{if(i&&typeof i=="object"&&typeof i.toJSON=="function")return i;try{return be(i)}catch{return"[object]"}}))}}catch(e){throw ht.getLogger("esri.core.Error").error(e),e}return{name:this.name,message:this.message,details:this.details}}static fromJSON(e){return new lue(e.name,e.message,e.details)}};Se.prototype.type="error";function pO(t,e,i){if(t&&e)if(typeof e=="object")for(const s of Object.getOwnPropertyNames(e))pO(t,s,e[s]);else{if(e.includes(".")){const n=e.split("."),r=n.splice(-1,1)[0];return void pO(Tm(t,n),r,i)}const s=t.__accessor__;s!=null&&kEe(e,s),t[e]=i}}function kEe(t,e){if(ke("esri-unknown-property-errors")&&!$Ee(t,e))throw new Se("set:unknown-property",UEe(t,e))}function $Ee(t,e){return e.metadata[t]!=null}function UEe(t,e){return"setting unknown property '"+t+"' on instance of "+e.host.declaredClass}function S(t={}){return(e,i)=>{if(e===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${e.name}.${i}. Accessor does not support static properties.`);const s=Object.getOwnPropertyDescriptor(e,i),n=xF(e,i);s&&(s.get||s.set?(n.get=s.get||n.get,n.set=s.set||n.set):"value"in s&&("value"in t&&ht.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${i}" on "${e.constructor.name}" already defined in the metadata`,t),n.value=t.value=s.value)),t.readOnly!=null&&(n.readOnly=t.readOnly);const r=t.aliasOf;if(r){const l=typeof r=="string"?r:r.source,u=typeof r=="string"?null:r.overridable===!0;let c;n.dependsOn=[l],n.get=function(){let h=Tm(this,l);if(typeof h=="function"){c||(c=l.split(".").slice(0,-1).join("."));const d=Tm(this,c);d&&(h=h.bind(d))}return h},n.readOnly||(n.set=u?function(h){this._override(i,h)}:function(h){pO(this,l,h)})}const o=t.type,a=t.types;if(!n.cast){let l;o?l=VEe(o):a&&(l=Array.isArray(a)?gP(_d(a[0])):_d(a)),t.cast=zEe(t.cast,l)}REe(n,t),t.range&&(n.cast=bEe(n.cast,t.range))}}function uue(t,e,i){const s=xF(t,i);s.json||(s.json={});let n=s.json;return e!==void 0&&(n.origins||(n.origins={}),n.origins[e]||(n.origins[e]={}),n=n.origins[e]),n}function VEe(t){let e=0,i=t;if(PEe(t))return tue(t);for(;Array.isArray(i)&&i.length===1&&typeof i[0]!="string"&&typeof i[0]!="number";)i=i[0],e++;const s=i;if(eue(s))return e===0?az(s):dO(az(s),e);if(e===1)return CEe(s);if(e>1)return TEe(s,e);const n=t;return n.from?n.from:xo(n)}function zEe(t,e){if(t||e)return t?e?(i,s)=>e(t(i,s),s):t:e}const cue=Symbol("Accessor-beforeDestroy");var du;(function(t){t[t.INITIALIZING=0]="INITIALIZING",t[t.CONSTRUCTING=1]="CONSTRUCTING",t[t.CONSTRUCTED=2]="CONSTRUCTED",t[t.DESTROYED=3]="DESTROYED"})(du||(du={}));var on;(function(t){t[t.Dirty=1]="Dirty",t[t.Overridden=2]="Overridden",t[t.Computing=4]="Computing",t[t.NonNullable=8]="NonNullable",t[t.HasDefaultValue=16]="HasDefaultValue",t[t.DepTrackingInitialized=32]="DepTrackingInitialized",t[t.AutoTracked=64]="AutoTracked",t[t.ExplicitlyTracking=128]="ExplicitlyTracking"})(on||(on={}));let bF=class{constructor(e){this.accessed=void 0,this._handles=void 0,this._observer=e}destroy(){var e;(e=this.accessed)==null||e.clear(),this.clear()}onAccessed(e){this._observer!=null&&e!==this._observer&&(this.accessed==null&&(this.accessed=new Set),this.accessed.add(e))}onTrackingEnd(){this._observer!=null&&(this.clear(),this.accessed!=null&&(this._handles==null&&(this._handles=[]),this.accessed.forEach(e=>{this._handles.push(e.observe(this._observer))}),this.accessed.clear()))}clear(){if(this._handles!=null){for(let e=0;e<this._handles.length;++e)this._handles[e].remove();this._handles.length=0}}};const fO=new bF,dC=[];let FT=fO;function fi(t){FT.onAccessed(t)}let bR=!1,wR=!1;function Nf(t,e,i){if(bR)return aH(t,e,i);let s=null;return hue(t),s=e.call(i),due(),s}function GEe(t,e){return Nf(fO,t,e)}function aH(t,e,i){const s=bR;bR=!0,hue(t);let n=null;try{n=e.call(i)}catch(r){wR&&ht.getLogger("esri.core.accessorSupport.tracking").error(r)}return due(),bR=s,n}function hue(t){FT=t,dC.push(t)}function due(){const t=dC.length;if(t>1){const e=dC.pop();FT=dC[t-2],e.onTrackingEnd()}else if(t===1){const e=dC.pop();FT=fO,e.onTrackingEnd()}else FT=fO}function mue(t,e){if(e.flags&on.DepTrackingInitialized)return;e.flags|=on.DepTrackingInitialized;const i=wR;wR=!1,e.flags&on.AutoTracked?aH(e.trackingTarget,e.metadata.get,t):pue(t,e),wR=i}const BEe=[];function pue(t,e){e.flags&on.ExplicitlyTracking||(e.flags|=on.ExplicitlyTracking,aH(e.trackingTarget,()=>{const i=e.metadata.dependsOn||BEe;for(const s of i)if(typeof s!="string"||s.includes(".")){const n=sue(s);for(let r=0,o=t;r<n.length&&o!=null&&typeof o=="object";++r)o=oK(o,n[r],r!==n.length-1)}else oK(t,s,!1)}),e.flags&=~on.ExplicitlyTracking)}function oK(t,e,i){const s=e[e.length-1]==="?"?e.slice(0,-1):e;if(t.getItemAt!=null||Array.isArray(t)){const r=parseInt(s,10);if(!isNaN(r))return Array.isArray(t)?t[r]:t.at(r)}const n=Su(t);if(n){const r=n.propertiesByName.get(s);r&&(fi(r),mue(t,r))}return i?t[s]:void 0}function qEe(t){if(t.json&&t.json.origins){const e=t.json.origins,i={"web-document":["web-scene","web-map"]};for(const s in i)if(e[s]){const n=e[s];i[s].forEach(r=>{e[r]=n}),delete e[s]}}}let ih=class extends aue{constructor(e,i,s){super(e,i,s)}};ih.prototype.type="warning";function fue(t){var e;return!!t&&((e=t.prototype)==null?void 0:e.declaredClass)&&t.prototype.declaredClass.indexOf("esri.core.Collection")===0}const cz=()=>ht.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function aK(t,e,i){var s,n;t&&(!i&&!e.read||(s=e.read)!=null&&s.reader||((n=e.read)==null?void 0:n.enabled)===!1||YEe(t)&&la("read.reader",LS(t),e))}function LS(t){var i,s;const e=t.ndimArray??0;if(e>1)return jEe(t);if(e===1)return lK(t);if("type"in t&&_ue(t.type)){const n=(s=(i=t.type.prototype)==null?void 0:i.itemType)==null?void 0:s.Type,r=lK(typeof n=="function"?{type:n}:{types:n});return(o,a,l)=>{const u=r(o,a,l);return u&&new t.type(u)}}return lH(t)}function lH(t){return"type"in t?HEe(t.type):XEe(t.types)}function HEe(t){return t.prototype.read?(e,i,s)=>{if(e==null)return e;const n=typeof e;if(n!=="object")return void cz().error(`Expected JSON value of type 'object' to deserialize type '${t.prototype.declaredClass}', but got '${n}'`);const r=new t;return r.read(e,s),r}:t.fromJSON}function gue(t,e,i,s){return s!==0&&Array.isArray(e)?e.map(n=>gue(t,n,i,s-1)):t(e,void 0,i)}function jEe(t){const e=lH(t),i=gue.bind(null,e),s=t.ndimArray??0;return(n,r,o)=>{if(n==null)return n;n=i(n,o,s);let a=s,l=n;for(;a>0&&Array.isArray(l);)a--,l=l[0];if(l!==void 0)for(let u=0;u<a;u++)n=[n];return n}}function lK(t){const e=lH(t);return(i,s,n)=>{if(i==null)return i;if(Array.isArray(i)){const o=[];for(const a of i){const l=e(a,void 0,n);l!==void 0&&o.push(l)}return o}const r=e(i,void 0,n);return r!==void 0?[r]:void 0}}function _ue(t){if(!fue(t))return!1;const e=t.prototype.itemType;return!(!e||!e.Type)&&(typeof e.Type=="function"?uH(e.Type):yue(e.Type))}function YEe(t){return"types"in t?yue(t.types):uH(t.type)}function uH(t){return!Array.isArray(t)&&!!t&&t.prototype&&("read"in t.prototype||"fromJSON"in t||_ue(t))}function yue(t){for(const e in t.typeMap)if(!uH(t.typeMap[e]))return!1;return!0}function XEe(t){let e=null;const i=t.errorContext??"type",s=t.validate;return(n,r,o)=>{if(n==null)return n;const a=typeof n;if(a!=="object")return void cz().error(`Expected JSON value of type 'object' to deserialize, but got '${a}'`);e||(e=WEe(t));const l=t.key;if(typeof l!="string")return;const u=n[l],c=u?e[u]:t.defaultKeyValue?t.typeMap[t.defaultKeyValue]:void 0;if(!c){const d=`Type '${u||"unknown"}' is not supported`;return o!=null&&o.messages&&n&&o.messages.push(new ih(`${i}:unsupported`,d,{definition:n,context:o})),void cz().error(d)}const h=new c;return h.read(n,o),s?s(h):h}}function WEe(t){var i,s;const e={};for(const n in t.typeMap){const r=t.typeMap[n],o=kM(r.prototype);if(typeof t.key=="function")continue;const a=o[t.key];if(!a)continue;if((i=a.json)!=null&&i.type&&Array.isArray(a.json.type)&&a.json.type.length===1&&typeof a.json.type[0]=="string"){e[a.json.type[0]]=r;continue}const l=(s=a.json)==null?void 0:s.write;if(!(l!=null&&l.writer)){e[n]=r;continue}const u=l.target,c=typeof u=="string"?u:t.key,h={};l.writer(n,h,c),h[c]&&(e[h[c]]=r)}return e}function ZEe(t){if(t.json||(t.json={}),cK(t.json),hK(t.json),uK(t.json),t.json.origins)for(const e in t.json.origins)cK(t.json.origins[e]),hK(t.json.origins[e]),uK(t.json.origins[e]);return!0}function uK(t){t.name&&(t.read&&typeof t.read=="object"?t.read.source===void 0&&(t.read.source=t.name):t.read={source:t.name},t.write&&typeof t.write=="object"?t.write.target===void 0&&(t.write.target=t.name):t.write={target:t.name})}function cK(t){typeof t.read=="boolean"?t.read={enabled:t.read}:typeof t.read=="function"?t.read={enabled:!0,reader:t.read}:t.read&&typeof t.read=="object"&&t.read.enabled===void 0&&(t.read.enabled=!0)}function hK(t){typeof t.write=="boolean"?t.write={enabled:t.write}:typeof t.write=="function"?t.write={enabled:!0,writer:t.write}:t.write&&typeof t.write=="object"&&t.write.enabled===void 0&&(t.write.enabled=!0)}function dK(t,e){if(!e.write||e.write.writer||e.write.enabled===!1&&!e.write.overridePolicy)return;const i=(t==null?void 0:t.ndimArray)??0;t&&(i===1||"type"in t&&fue(t.type))?e.write.writer=JEe:i>1?e.write.writer=e2e(i):e.types?Array.isArray(e.types)?e.write.writer=QEe(e.types[0]):e.write.writer=KEe(e.types):e.write.writer=_P}function KEe(t){return(e,i,s,n)=>e?vue(e,t,n)?_P(e,i,s,n):void 0:_P(e,i,s,n)}function vue(t,e,i){for(const s in e.typeMap)if(t instanceof e.typeMap[s])return!0;if(i!=null&&i.messages){const s=e.errorContext??"type",n=`Values of type '${(typeof e.key!="function"?t[e.key]:t.declaredClass)??"Unknown"}' cannot be written`;i&&i.messages&&t&&i.messages.push(new Se(`${s}:unsupported`,n,{definition:t,context:i})),ht.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(n)}return!1}function QEe(t){return(e,i,s,n)=>!e||!Array.isArray(e)?_P(e,i,s,n):_P(e.filter(r=>vue(r,t,n)),i,s,n)}function _P(t,e,i,s){la(i,gO(t,s),e)}function gO(t,e){return t&&typeof t.write=="function"?t.write({},e):t&&typeof t.toJSON=="function"?t.toJSON():typeof t=="number"?_O(t):t}function _O(t){return t===-1/0?-Number.MAX_VALUE:t===1/0?Number.MAX_VALUE:isNaN(t)?null:t}function JEe(t,e,i,s){let n;t===null?n=null:t&&typeof t.map=="function"?(n=t.map(r=>gO(r,s)),typeof n.toArray=="function"&&(n=n.toArray())):n=[gO(t,s)],la(i,n,e)}function xue(t,e,i){return i!==0&&Array.isArray(t)?t.map(s=>xue(s,e,i-1)):gO(t,e)}function e2e(t){return(e,i,s,n)=>{let r;if(e===null)r=null;else{r=xue(e,n,t);let o=t,a=r;for(;o>0&&Array.isArray(a);)o--,a=a[0];if(a!==void 0)for(let l=0;l<o;l++)r=[r]}la(s,r,i)}}function t2e(t,e){return cH(t,"any",e==null?void 0:e.origin)}function hz(t,e){return cH(t,"read",e==null?void 0:e.origin)}function bue(t,e){return cH(t,"write",e==null?void 0:e.origin)}function cH(t,e,i){let s=t==null?void 0:t.json;if(s!=null&&s.origins&&i){let n;n=i==="link-chart"?s.origins[i]&&(e==="any"||e in s.origins[i])?s.origins[i]:s.origins["web-map"]:s.origins[i],n&&(e==="any"||e in n)&&(s=n)}return s}function i2e(t){var i;const e=s2e(t);if(t.json.origins)for(const s in t.json.origins){const n=t.json.origins[s],r=n.types?n2e(n):e;aK(r,n,!1),n.types&&!n.write&&((i=t.json.write)!=null&&i.enabled)&&(n.write={...t.json.write}),dK(r,n)}aK(e,t.json,!0),dK(e,t.json)}function s2e(t){return t.json.types?dz(t.json):t.type?wue(t):dz(t)}function n2e(t){return t.type?wue(t):dz(t)}function wue(t){if(!t.type)return;let e=0,i=t.type;for(;Array.isArray(i)&&!eue(i);)i=i[0],e++;return{type:i,ndimArray:e}}function dz(t){if(!t.types)return;let e=0,i=t.types;for(;Array.isArray(i);)i=i[0],e++;return{types:i,ndimArray:e}}function r2e(t){ZEe(t)&&(qEe(t),i2e(t))}const K$=new Set,Q$=new Set;function se(t){return e=>{t??(t="esri.core.Accessor"),e.prototype.declaredClass=t,a2e(e);const i=[],s=[];let n=e.prototype;for(;n;)n.hasOwnProperty("initialize")&&!K$.has(n.initialize)&&(K$.add(n.initialize),i.push(n.initialize)),n.hasOwnProperty("destroy")&&!Q$.has(n.destroy)&&(Q$.add(n.destroy),s.push(n.destroy)),n=Object.getPrototypeOf(n);K$.clear(),Q$.clear();const r=class extends e{constructor(...a){if(super(...a),this.constructor===r&&typeof this.postscript=="function"){if(i.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let l=i.length-1;l>=0;l--)i[l].call(this)}}),s.length){let l=!1;const u=this[cue];Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!l){l=!0,u.call(this);for(let c=0;c<s.length;c++)s[c].call(this)}}})}Object.defineProperty(this,Symbol.dispose,{enumerable:!1,configurable:!0,value(){this.destroy()}}),this.postscript()}}};r.__accessorMetadata__=kM(e.prototype),r.prototype.declaredClass=t;const o=(t||"AccessorSubclass").split(".").slice(-1)[0];return Object.defineProperty(r,"name",{value:o,configurable:!0}),r}}function o2e(t,e){return e.get==null?function(){const i=this.__accessor__,s=i.propertiesByName.get(t);if(s===void 0)return;i.mutable&&fi(s);const n=i.store;return n.has(t)?n.get(t):s.metadata.value}:function(){const i=this.__accessor__,s=i.propertiesByName.get(t);if(s!==void 0)return s.getComputed(i)}}function a2e(t){const e=t.prototype,i=kM(e),s={};for(const n of Object.getOwnPropertyNames(i)){const r=i[n];r2e(r),s[n]={enumerable:!0,configurable:!0,get:o2e(n,r),set(o){const a=this.__accessor__;if(a!==void 0){if(a.mutable)return a.initialized&&r.readOnly?mK("read-only",n):a.lifecycle===du.CONSTRUCTED&&r.constructOnly?mK("construct-only",n):void a.set(n,o)}else Object.defineProperty(this,n,{enumerable:!0,configurable:!0,writable:!0,value:o})}}}Object.defineProperties(t.prototype,s)}const mK=(t,e)=>{ht.getLogger("esri.core.Accessor").error(`cannot assign to ${t} property '${e}'`)},pK=new WeakMap;function l2e(t,e,i=!1){const s=`🛑 DEPRECATED - ${e}`;if(!i)return void t.warn(s);let n=pK.get(t);n||(n=new Set,pK.set(t,n)),n.has(e)||(n.add(e),t.warn(s))}function u2e(t,e,i={}){if(ke("esri-deprecation-warnings")){const{moduleName:s}=i;yP(t,`Function: ${(s?s+"::":"")+e+"()"}`,i)}}function c2e(t,e,i={}){if(ke("esri-deprecation-warnings")){const{moduleName:s}=i;yP(t,`Property: ${(s?s+"::":"")+e}`,i)}}function h2e(t,e,i={}){ke("esri-deprecation-warnings")&&yP(t,`Multiple argument constructor: ${e}`,{warnOnce:!0,replacement:`new ${e}({ <your properties here> })`,...i})}function yP(t,e,i={}){if(ke("esri-deprecation-warnings")){const{replacement:s,version:n,see:r,warnOnce:o}=i;let a=e;if(s&&(a+=`
	🛠️ Replacement: ${s}`),n&&(a+=`
	⚙️ Version: ${n}`),r)if(Array.isArray(r)){a+=`
	🔗 See for more details:`;for(const l of r)a+=`
		${l}`}else a+=`
	🔗 See ${r} for more details.`;l2e(t,a,o)}}function ypt(t){const e=[];return function*(){yield*e;for(const i of t)e.push(i),yield i}}function d2e(t,e){for(const i of t)if(i!=null&&e(i))return i}function yO(t){return t!=null&&typeof t[Symbol.iterator]=="function"}let FS=class{constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let e=0;return this._groups.forEach(i=>{e+=i.length}),e}add(e,i){if(yO(e)){const s=this._getOrCreateGroup(i);for(const n of e)gK(n)&&s.push(n)}else gK(e)&&this._getOrCreateGroup(i).push(e);return this}forEach(e,i){if(typeof e=="function")this._groups.forEach(s=>s.forEach(e));else{const s=this._getGroup(e);s&&i&&s.forEach(i)}}has(e){return this._groups.has(uD(e))}remove(e){if(typeof e!="string"&&yO(e)){for(const i of e)this.remove(i);return this}return this.has(e)?(fK(this._getGroup(e)),this._groups.delete(uD(e)),this):this}removeAll(){return this._groups.forEach(fK),this._groups.clear(),this}removeReference(e){return this._groups.delete(e),this}_getOrCreateGroup(e){if(this.has(e))return this._getGroup(e);const i=[];return this._groups.set(uD(e),i),i}_getGroup(e){return this._groups.get(uD(e))}};function uD(t){return t||"_default_"}function fK(t){for(const e of t)e instanceof FS?e.removeAll():e.remove()}function gK(t){return t!=null&&(!!t.remove||t instanceof FS)}function Sue(t,e){if(t==null)throw new Error(e??"value is None")}function er(t){return t==null||t.destroy(),null}function xpt(t){return t==null||t.dispose(),null}function sr(t){return t==null||t.remove(),null}function Xw(t){return t==null||t.abort(),null}function bpt(t){return t==null||t.release(),null}function m2e(t,e,i){return t!=null&&e!=null?i!=null?i(t,e):t.equals(e):t===e}function p2e(t,e){let i;return t.some((s,n)=>(i=e(s,n),i!=null)),i??void 0}function f2e(t){return(t==null?void 0:t.release)&&typeof t.release=="function"}function g2e(t){return(t==null?void 0:t.acquire)&&typeof t.acquire=="function"}let F1=class mz{constructor(e,i,s,n=1,r=0){this._ctor=e,this._acquireFunction=i,this._releaseFunction=s,this.allocationSize=n,this._pool=new Array(r),this._initialSize=r;for(let o=0;o<r;o++)this._pool[o]=new this._ctor;this.allocationSize=Math.max(n,1)}destroy(){this.prune(0)}acquire(...e){let i;if(mz.test.disabled)i=new this._ctor;else{if(this._pool.length===0){const s=this.allocationSize;for(let n=0;n<s;n++)this._pool[n]=new this._ctor}i=this._pool.pop()}return this._acquireFunction?this._acquireFunction(i,...e):g2e(i)&&i.acquire(...e),i}release(e){e&&!mz.test.disabled&&(this._releaseFunction?this._releaseFunction(e):f2e(e)&&e.release(),this._pool.push(e))}prune(e=this._initialSize){if(!(e>=this._pool.length)){for(let i=e;i<this._pool.length;++i){const s=this._pool[i];this._dispose(s)}this._pool.length=e}}_dispose(e){e.dispose&&typeof e.dispose=="function"&&e.dispose()}};F1.test={disabled:!1};let _2e=class{constructor(e,i){this._observers=e,this._observer=i}remove(){$le(this._observers,this._observer)}},Eue=class{constructor(){this._observers=null,this.destroyed=!1}observe(e){if(this.destroyed||e.destroyed)return y2e;this._observers==null&&(this._observers=[]);const i=this._observers;let s=!1,n=!1;const r=i.length;for(let o=0;o<r;++o){const a=i[o];if(a.destroyed)n=!0;else if(a===e){s=!0;break}}return s||(i.push(e),n&&this._removeDestroyedObservers()),new _2e(i,e)}_removeDestroyedObservers(){const e=this._observers;if(!e||e.length===0)return;const i=e.length;let s=0;for(let n=0;n<i;++n){for(;n+s<i&&e[n+s].destroyed;)++s;if(s>0){if(!(n+s<i))break;e[n]=e[n+s]}}e.length=i-s}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this._observers;if(e!=null){for(const i of e)i.onCommitted();this._observers=null}}};const y2e=Gs();var ds;(function(t){t[t.DEFAULTS=0]="DEFAULTS",t[t.COMPUTED=1]="COMPUTED",t[t.SERVICE=2]="SERVICE",t[t.PORTAL_ITEM=3]="PORTAL_ITEM",t[t.WEB_SCENE=4]="WEB_SCENE",t[t.WEB_MAP=5]="WEB_MAP",t[t.LINK_CHART=6]="LINK_CHART",t[t.USER=7]="USER"})(ds||(ds={}));const pz=ds.USER+1;function H_(t){switch(t){case"defaults":return ds.DEFAULTS;case"service":return ds.SERVICE;case"portal-item":return ds.PORTAL_ITEM;case"web-scene":return ds.WEB_SCENE;case"web-map":return ds.WEB_MAP;case"link-chart":return ds.LINK_CHART;case"user":return ds.USER;default:return null}}function vO(t){switch(t){case ds.DEFAULTS:return"defaults";case ds.SERVICE:return"service";case ds.PORTAL_ITEM:return"portal-item";case ds.WEB_SCENE:return"web-scene";case ds.WEB_MAP:return"web-map";case ds.LINK_CHART:return"link-chart";case ds.USER:return"user"}}function v2e(t){return vO(t)}let _K=class extends Eue{constructor(e,i){super(),this.propertyName=e,this.metadata=i,this.trackingTarget=new bF(this),this.flags=0,this.flags=on.Dirty|(i.nonNullable?on.NonNullable:0)|(i.hasOwnProperty("value")?on.HasDefaultValue:0)|(i.get===void 0?on.DepTrackingInitialized:0)|(i.dependsOn===void 0?on.AutoTracked:0)}destroy(){this.flags&on.Dirty&&this.onCommitted(),super.destroy(),this.trackingTarget.destroy()}getComputed(e){e.mutable&&fi(this);const i=e.store,s=this.propertyName,n=this.flags,r=i.get(s);if(n&on.Computing||~n&on.Dirty&&i.has(s))return r;this.flags|=on.Computing;const o=e.host;let a;n&on.AutoTracked?a=Nf(this.trackingTarget,this.metadata.get,o):(pue(o,this),a=this.metadata.get.call(o)),this.flags|=on.DepTrackingInitialized,i.set(s,a,ds.COMPUTED);const l=i.get(s);return l===r?this.flags&=~on.Dirty:GEe(this.commit,this),this.flags&=~on.Computing,l}notifyChange(){this.onInvalidated(),this.onCommitted()}invalidate(){this.onInvalidated()}commit(){this.flags&=~on.Dirty,this.onCommitted()}onInvalidated(){~this.flags&on.Overridden&&(this.flags|=on.Dirty);const e=this._observers;if(e&&e.length>0)for(const i of e)i.onInvalidated()}onCommitted(){const e=this._observers;if(e&&e.length>0){const i=e.slice();for(const s of i)s.onCommitted()}}},x2e=class Cue{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const i=new Cue;return this._values.forEach((s,n)=>{e&&e.has(n)||i.set(n,be(s))}),i}get(e){return this._values.get(e)}originOf(){return ds.USER}keys(){return[...this._values.keys()]}set(e,i){this._values.set(e,i)}delete(e){this._values.delete(e)}has(e){return this._values.has(e)}forEach(e){this._values.forEach(e)}};function cD(t,e,i){return t!==void 0}function yK(t,e,i,s){return t!==void 0&&(!(i==null&&t.flags&on.NonNullable)||(s.lifecycle,du.INITIALIZING,!1))}let b2e=class{constructor(e){this.host=e,this.propertiesByName=new Map,this.ctorArgs=null,this.lifecycle=du.INITIALIZING,this.store=new x2e,this.mutable=!0,this._origin=ds.USER;const i=this.host.constructor.__accessorMetadata__;for(const s in i){const n=new _K(s,i[s]);this.propertiesByName.set(s,n)}this.metadata=i}initialize(){this.lifecycle=du.CONSTRUCTING}constructed(){this.lifecycle=du.CONSTRUCTED}destroy(){this.lifecycle=du.DESTROYED,this.propertiesByName.forEach(e=>e.destroy())}get initialized(){return this.lifecycle!==du.INITIALIZING}get(e){const i=this.propertiesByName.get(e);if(i.metadata.get)return i.getComputed(this);this.mutable&&fi(i);const s=this.store;return s.has(e)?s.get(e):i.metadata.value}originOf(e){const i=this.store.originOf(e);if(i===void 0){const s=this.propertiesByName.get(e);if(s!==void 0&&s.flags&on.HasDefaultValue)return"defaults"}return vO(i)}has(e){return this.propertiesByName.has(e)&&this.store.has(e)}keys(){return[...this.propertiesByName.keys()]}internalGet(e){const i=this.propertiesByName.get(e);if(cD(i))return this.store.has(e)?this.store.get(e):i.metadata.value}internalSet(e,i){const s=this.propertiesByName.get(e);cD(s)&&this._internalSet(s,i)}getDependsInfo(e,i,s){const n=this.propertiesByName.get(i);if(!cD(n))return"";const r=new bF,o=Nf(r,()=>{var u;return(u=n.metadata.get)==null?void 0:u.call(e)});let a=`${s}${e.declaredClass.split(".").pop()}.${i}: ${o}
`;const l=r.accessed??new Set;if(l.size===0)return a;s+="  ";for(const u of l)u instanceof _K&&(a+=`${s}${u.propertyName}: undefined
`);return a}setAtOrigin(e,i,s){const n=this.propertiesByName.get(e);if(cD(n))return this._setAtOrigin(n,i,s)}isOverridden(e){const i=this.propertiesByName.get(e);return i!==void 0&&!!(i.flags&on.Overridden)}clearOverride(e){const i=this.propertiesByName.get(e);i&&i.flags&on.Overridden&&(i.flags&=~on.Overridden,i.notifyChange())}override(e,i){const s=this.propertiesByName.get(e);if(!yK(s,e,i,this))return;const n=s.metadata.cast;if(n){const r=this._cast(n,i),{valid:o,value:a}=r;if(J$.release(r),!o)return;i=a}s.flags|=on.Overridden,this._internalSet(s,i)}set(e,i){const s=this.propertiesByName.get(e);if(!yK(s,e,i,this))return;const n=s.metadata.cast;if(n){const o=this._cast(n,i),{valid:a,value:l}=o;if(J$.release(o),!a)return;i=l}const r=s.metadata.set;r?r.call(this.host,i):this._internalSet(s,i)}setDefaultOrigin(e){this._origin=H_(e)}getDefaultOrigin(){return vO(this._origin)}notifyChange(e){const i=this.propertiesByName.get(e);i!==void 0&&i.notifyChange()}invalidate(e){const i=this.propertiesByName.get(e);i!==void 0&&i.invalidate()}commit(e){const i=this.propertiesByName.get(e);i!==void 0&&i.commit()}_internalSet(e,i){const s=this.lifecycle!==du.INITIALIZING?this._origin:ds.DEFAULTS;this._setAtOrigin(e,i,s)}_setAtOrigin(e,i,s){const n=this.store,r=e.propertyName;n.has(r,s)&&nH(i,n.get(r))&&~e.flags&on.Overridden&&s===n.originOf(r)||(e.invalidate(),n.set(r,i,s),e.commit(),mue(this.host,e))}_cast(e,i){const s=J$.acquire();return s.valid=!0,s.value=i,e&&(s.value=e.call(this.host,i,s)),s}},w2e=class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}};const J$=new F1(w2e);let S2e;function E2e(){return S2e}var vK;(function(t){t[t.Ignore=0]="Ignore",t[t.Destroy=1]="Destroy",t[t.ThrowError=2]="ThrowError"})(vK||(vK={}));function C2e(t){t.length=0}let Il=class{constructor(e=50,i=50){this._pool=new F1(Array,void 0,C2e,i,e)}acquire(){return this._pool.acquire()}release(e){this._pool.release(e)}prune(){this._pool.prune(0)}static acquire(){return eU.acquire()}static release(e){return eU.release(e)}static prune(){eU.prune()}};const eU=new Il(100);let Tue=class extends F1{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...e){const i=super.acquire(...e);return this._set.delete(i),i}release(e){e&&!this._set.has(e)&&(super.release(e),this._set.add(e))}_dispose(e){this._set.delete(e),super._dispose(e)}};const hD=[];function xO(t){hD.push(t),hD.length===1&&queueMicrotask(()=>{const e=hD.slice();hD.length=0;for(const i of e)i()})}let kT=class{constructor(e,i=30){this.name=e,this._counter=0,this._samples=new Array(i)}push(e){e!=null&&(this._samples[++this._counter%this._samples.length]=e)}set(e){e!=null&&(this._samples[this._counter%this._samples.length]=e)}get median(){return this._samples.slice().sort((e,i)=>e-i)[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce((e,i)=>e+i,0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}};var fz;(function(t){const e=(r,o,a,l)=>{let u=o,c=o;const h=a>>>1,d=r[u-1];for(;c<=h;){c=u<<1,c<a&&l(r[c-1],r[c])<0&&++c;const m=r[c-1];if(l(m,d)<=0)break;r[u-1]=m,u=c}r[u-1]=d},i=(r,o)=>r<o?-1:r>o?1:0;function s(r,o,a,l){o===void 0&&(o=0),a===void 0&&(a=r.length),l===void 0&&(l=i);for(let c=a>>>1;c>o;c--)e(r,c,a,l);const u=o+1;for(let c=a-1;c>o;c--){const h=r[o];r[o]=r[c],r[c]=h,e(r,u,c,l)}}function*n(r,o,a,l){o===void 0&&(o=0),a===void 0&&(a=r.length),l===void 0&&(l=i);for(let c=a>>>1;c>o;c--)e(r,c,a,l),yield;const u=o+1;for(let c=a-1;c>o;c--){const h=r[o];r[o]=r[c],r[c]=h,e(r,u,c,l),yield}}t.sort=s,t.iterableSort=n})(fz||(fz={}));const xK=fz,T2e=1.5,P2e=1.1;let jv=class{constructor(e){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new Lle,e&&(e.initialSize&&(this.data=new Array(e.initialSize)),e.allocator&&(this._allocator=e.allocator),e.deallocator!==void 0&&(this._deallocator=e.deallocator),e.shrink&&(this._shrink=()=>bK(this)))}toArray(){return this.data.slice(0,this.length)}filter(e){const i=new Array;for(let s=0;s<this._length;s++){const n=this.data[s];e(n)&&i.push(n)}return i}at(e){if((e=Math.trunc(e)||0)<0&&(e+=this._length),!(e<0||e>=this._length))return this.data[e]}includes(e,i){const s=this.data.indexOf(e,i);return s!==-1&&s<this.length}get length(){return this._length}set length(e){if(e>this._length){if(this._allocator){for(;this._length<e;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=e}else{if(this._deallocator)for(let i=e;i<this._length;++i)this.data[i]=this._deallocator(this.data[i]);this._length=e,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(e){this.data[this._length++]=e}pushArray(e,i=e.length){for(let s=0;s<i;s++)this.data[this._length++]=e[s]}fill(e,i){for(let s=0;s<i;s++)this.data[this._length++]=e}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const e=this.data[this._length];return++this._length,e}unshift(e){this.data.unshift(e),this._length++,bK(this)}pop(){if(this.length===0)return;const e=this.data[this.length-1];return this.length=this.length-1,this._shrink(),e}remove(e){const i=nz(this.data,e,this.length,this._hint);if(i!==-1)return this.data.splice(i,1),this.length=this.length-1,e}removeUnordered(e){return this.removeUnorderedIndex(nz(this.data,e,this.length,this._hint))}removeUnorderedIndex(e){if(!(e>=this.length||e<0))return this.swapElements(e,this.length-1),this.pop()}removeUnorderedMany(e,i=e.length,s){this.length=lEe(this.data,e,this.length,i,this._hint,s),this._shrink()}front(){if(this.length!==0)return this.data[0]}back(){if(this.length!==0)return this.data[this.length-1]}swapElements(e,i){if(e>=this.length||i>=this.length||e===i)return;const s=this.data[e];this.data[e]=this.data[i],this.data[i]=s}sort(e){xK.sort(this.data,0,this.length,e)}iterableSort(e){return xK.iterableSort(this.data,0,this.length,e)}some(e,i){for(let s=0;s<this.length;++s)if(e.call(i,this.data[s],s,this.data))return!0;return!1}find(e,i){const{data:s,length:n}=this;for(let r=0;r<n;++r)if(e.call(i,s[r]))return s[r]}filterInPlace(e,i){let s=0;for(let n=0;n<this._length;++n){const r=this.data[n];e.call(i,r,n,this.data)&&(this.data[n]=this.data[s],this.data[s]=r,s++)}if(this._deallocator)for(let n=s;n<this._length;n++)this.data[n]=this._deallocator(this.data[n]);return this._length=s,this._shrink(),this}forAll(e,i){const{data:s,length:n}=this;for(let r=0;r<n;++r)e.call(i,s[r],r,s)}forEach(e,i){this.data.slice(0,this.length).forEach(e,i)}map(e,i){const s=new Array(this.length);for(let n=0;n<this.length;++n)s[n]=e.call(i,this.data[n],n,this.data);return s}reduce(e,i){let s=i;for(let n=0;n<this.length;++n)s=e(s,this.data[n],n,this.data);return s}has(e){const i=this.length,s=this.data;for(let n=0;n<i;++n)if(s[n]===e)return!0;return!1}*[Symbol.iterator](){for(let e=0;e<this.length;e++)yield this.data[e]}};function bK(t){t.data.length>T2e*t.length&&(t.data.length=Math.floor(t.length*P2e))}function M2e(t){return{setTimeout:(e,i)=>{const s=t.setTimeout(e,i);return Gs(()=>t.clearTimeout(s))}}}const kS=M2e(globalThis);function wF(t){return A2e(t)||Pue(t)}function A2e(t){return t!=null&&typeof t=="object"&&"on"in t&&typeof t.on=="function"}function Pue(t){return t!=null&&typeof t=="object"&&"addEventListener"in t&&typeof t.addEventListener=="function"}function $M(t,e,i){if(!wF(t))throw new TypeError("target is not a Evented or EventTarget object");return Pue(t)?I2e(t,e,i):t.on(e,i)}function I2e(t,e,i,s){if(Array.isArray(e)){const n=e.slice();for(const r of n)t.addEventListener(r,i,s);return Gs(()=>{for(const r of n)t.removeEventListener(r,i,s)})}return t.addEventListener(e,i,s),Gs(()=>t.removeEventListener(e,i,s))}function Mue(t,e,i){if(!wF(t))throw new TypeError("target is not a Evented or EventTarget object");if("once"in t)return t.once(e,i);const s=$M(t,e,n=>{s.remove(),i.call(t,n)});return s}function Vn(t="Aborted"){return new Se("AbortError",t)}function vr(t,e="Aborted"){if(dc(t))throw Vn(e)}function UM(t){return t instanceof AbortSignal?t:(t==null?void 0:t.signal)??void 0}function dc(t){const e=UM(t);return e!=null&&e.aborted}function ym(t){if(cl(t))throw t}function wK(t){if(!cl(t))throw t}function Jc(t,e){const i=UM(t);if(i!=null){if(!i.aborted)return Mue(i,"abort",()=>e());e()}}function hH(t,e){const i=UM(t);if(i!=null)return vr(i),Mue(i,"abort",()=>e(Vn()))}function Aue(t,e){return UM(e)==null?t:new Promise((i,s)=>{let n=Jc(e,()=>s(Vn()));const r=()=>{n=sr(n)};t.then(r,r),t.then(i,s)})}function cl(t){return(t==null?void 0:t.name)==="AbortError"}async function vP(t){try{return await t}catch(e){if(!cl(e))throw e;return}}async function dH(t){if(!t)return;if(typeof t.forEach!="function"){const i=Object.keys(t),s=i.map(o=>t[o]),n=await dH(s),r={};return i.map((o,a)=>r[o]=n[a]),r}const e=t;return Promise.allSettled(e).then(i=>Array.from(e,(s,n)=>{const r=i[n];return r.status==="fulfilled"?{promise:s,value:r.value}:{promise:s,error:r.reason}}))}async function D2e(t){return(await Promise.allSettled(t)).filter(e=>e.status==="fulfilled").map(e=>e.value)}async function Dpt(t){return(await Promise.allSettled(t)).filter(e=>e.status==="rejected").map(e=>e.reason)}function Iue(t,e=void 0,i){const s=new AbortController;return Jc(i,()=>s.abort()),new Promise((n,r)=>{let o=setTimeout(()=>{o=0,n(e)},t);Jc(s,()=>{o&&(clearTimeout(o),r(Vn()))})})}function Npt(t,e,i,s){const n=i&&"abort"in i?i:null;s!=null||n||(s=i);let r=setTimeout(()=>{r=0,n==null||n.abort()},e);const o=()=>s||new Se("promiseUtils:timeout","The wrapped promise did not resolve within "+e+" ms");return t.then(a=>{if(r===0)throw o();return clearTimeout(r),a},a=>{throw clearTimeout(r),r===0?o():a})}function N2e(t,e){const i=new AbortController,s=setTimeout(()=>i.abort(),e);return Jc(t,()=>{i.abort(),clearTimeout(s)}),{...t,signal:i.signal}}function Hm(t){return t&&typeof t.then=="function"}function gz(t){return Hm(t)?t:Promise.resolve(t)}function mH(t,e=-1){let i,s,n,r,o=null;const a=(...l)=>{if(i){s=l,r&&r.reject(Vn()),r=mc();const d=r.promise;if(o){const m=o;o=null,m.abort()}return d}if(n=r||mc(),r=null,e>0){const d=new AbortController;i=gz(t(...l,d.signal));const m=i;Iue(e).then(()=>{i===m&&(r?d.abort():o=d)})}else i=1,i=gz(t(...l));const u=()=>{const d=s;s=n=i=o=null,d!=null&&a(...d)},c=i,h=n;return c.then(u,u),c.then(h.resolve,h.reject),h.promise};return a}function mc(){let t,e;const i=new Promise((n,r)=>{t=n,e=r}),s=n=>{t(n)};return s.resolve=n=>t(n),s.reject=n=>e(n),s.timeout=(n,r)=>kS.setTimeout(()=>s.reject(r),n),s.promise=i,s}async function SK(t){await Promise.resolve(),vr(t)}function Rpt(t){return t}function R2e(t){return 1e3*t}function Opt(t){return t}function Lpt(t){return .001*t}let O2e=class{constructor(e){this.phases=e,this.paused=!1,this.ticks=-1,this.removed=!1}},L2e=class{constructor(e){this.callback=e,this.isActive=!0}remove(){this.isActive=!1}},_z=0;const S2={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},yz=["prepare","preRender","render","postRender","update","finish"],vz=[],r1=new jv;let F2e=class{constructor(e){this._task=e}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1,Due()}};function k2e(){Yv!=null&&(cancelAnimationFrame(Yv),Yv=requestAnimationFrame(pH))}function Due(){Yv==null&&(_z=performance.now(),Yv=requestAnimationFrame(pH))}const bO={frameTasks:r1,willDispatch:!1,clearFrameTasks:$2e,dispatch:Rue,executeFrameTasks:U2e,reschedule:k2e};function VM(t){const e=new L2e(t);return vz.push(e),bO.willDispatch||(bO.willDispatch=!0,xO(Rue)),e}function Ww(t){const e=new O2e(t);return r1.push(e),Due(),new F2e(e)}let Yv=null;function $2e(t=!1){r1.forAll(e=>{e.removed=!0}),t&&Nue()}function pH(){const t=performance.now();Yv=null,Yv=r1.some(i=>!i.paused&&!i.removed)?requestAnimationFrame(pH):null,bO.executeFrameTasks(t)}function U2e(t){const e=t-_z;_z=t;const i=1e3/60,s=Math.max(0,e-i);S2.time=t,S2.frameDuration=i-s;for(let n=0;n<yz.length;n++){const r=performance.now(),o=yz[n];r1.forAll(a=>{var l;a.paused||a.removed||(n===0&&a.ticks++,a.phases[o]&&(S2.elapsedFrameTime=performance.now()-t,S2.deltaTime=a.ticks===0?0:e,(l=a.phases[o])==null||l.call(a,S2)))}),B2e[n].push(performance.now()-r)}Nue(),q2e.push(performance.now()-t)}const dD=new jv;function Nue(){r1.forAll(t=>{t.removed&&dD.push(t)}),r1.removeUnorderedMany(dD.data,dD.length),dD.clear()}function Rue(){for(;vz.length;){const t=vz.shift();t.isActive&&t.callback()}bO.willDispatch=!1}function V2e(t=1,e){const i=mc(),s=()=>{dc(e)?i.reject(Vn()):t===0?i():(--t,xO(()=>s()))};return s(),i.promise}function z2e(t){return V2e(1,t)}async function G2e(t){await z2e(t),await new Promise(e=>requestAnimationFrame(()=>{t!=null&&t.aborted||e()}))}const B2e=yz.map(t=>new kT(t)),q2e=new kT("total");function Oue(t,e){for(const i of t.values())if(e(i))return!0;return!1}function wO(t,e){if(!e)return t;for(const i of e)i!=null&&t.add(i);return t}function EK(t,e){return e!=null&&t.add(e),t}function fH(t,e){const i=new Set;return wO(i,t),wO(i,e),i}function H2e(t,e){const i=new Set;for(const s of e)t.has(s)&&i.add(s);return i}function Upt(t,e){if(!t||!e)return!1;if(t===e)return!0;for(const i of t)if(!e.has(i))return!1;return!0}function Vpt(t,e){if(t==null&&e==null)return!0;if(t==null||e==null||t.size!==e.size)return!1;for(const i of t)if(!e.has(i))return!1;return!0}function j2e(t,e){const i=new Set(t);for(const s of e)i.delete(s);return i}function Y2e(t,e){return j2e(fH(t,e),H2e(t,e))}let X2e=0;function SR(){return++X2e}let SF=class extends bF{constructor(e){super(new W2e(e)),this._observer&&CK.register(this,new WeakRef(this._observer),this)}destroy(){var e,i;this._observer&&CK.unregister(this._observer),(e=this.accessed)==null||e.clear(),this.clear(),(i=this._observer)==null||i.destroy()}},W2e=class{constructor(e){this._notify=e,this._invalidCount=0,this.destroyed=!1}onInvalidated(){this._invalidCount++}onCommitted(){if(this.destroyed)return;const e=this._invalidCount;if(e===1)return this._invalidCount=0,void this._notify();this._invalidCount=e>0?e-1:0}destroy(){this.destroyed=!0,this._notify=Z2e}};const CK=new FinalizationRegistry(t=>{var e;(e=t.deref())==null||e.destroy()});function Z2e(){}let ww=!1;const SO=[];function Lue(t,e){let i=new SF(r),s=null,n=!1;function r(){if(!i||n)return;if(ww)return void $ue(r);const a=s;i.clear(),ww=!0,n=!0,s=Nf(i,t),n=!1,ww=!1,e(s,a),Uue()}function o(){i&&(i.destroy(),i=null,s=null)}return n=!0,s=Nf(i,t),n=!1,Gs(o)}function Fue(t,e){let i=new SF(n),s=null;function n(){e(s,o)}function r(){i&&(i.destroy(),i=null),s=null}function o(){return i?(i.clear(),s=Nf(i,t),s):null}return o(),Gs(r)}function kue(t,e){let i=!1,s=!1;const n=!!(e!=null&&e.sync);let r=new SF(()=>{i||s||(s=!0,n?o():queueMicrotask(o))});function o(){s=!1,r&&!i&&(ww?$ue(o):(r.clear(),ww=!0,i=!0,Nf(r,t),i=!1,ww=!1,Uue()))}function a(){r&&(r.destroy(),r=null)}return i=!0,Nf(r,t),i=!1,Gs(a)}function $ue(t){SO.includes(t)||SO.unshift(t)}function Uue(){for(;SO.length;)SO.pop()()}var $T;(function(t){t[t.Untracked=0]="Untracked",t[t.Tracked=1]="Tracked"})($T||($T={}));let xP=class{constructor(){this.uid=SR(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(e,i,s,n,r){return this.pool.acquire($T.Untracked,e,i,s,n,r,nH)}static acquireTracked(e,i,s,n){return this.pool.acquire($T.Tracked,e,i,s,null,null,n)}notify(e,i){this.type===$T.Untracked?this.callback.call(this.target,e,i,this.path,this.target):this.callback.call(null,e,i,void 0,void 0)}acquire(e,i,s,n,r,o,a){this.uid=SR(),this.removed=!1,this.type=e,this.oldValue=i,this.callback=s,this.getValue=n,this.target=r,this.path=o,this.equals=a}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=SR(),this.removed=!0}};xP.pool=new Tue(xP);const ER=new Il,Ef=new Set;let EO;function CO(t){Ef.delete(t),Ef.add(t),EO||(EO=VM(J2e))}function K2e(t){if(t.removed)return;const e=t.oldValue,i=t.getValue();t.equals(e,i)||(t.oldValue=i,t.notify(i,e))}function Q2e(t){for(const e of Ef.values())e.target===t&&(e.removed=!0)}function J2e(){let t=10;for(;EO&&t--;){EO=null;const e=eCe(),i=ER.acquire();for(const s of e){const n=s.uid;K2e(s),n===s.uid&&s.removed&&i.push(s)}for(const s of Ef)s.removed&&(i.push(s),Ef.delete(s));for(const s of i)xP.pool.release(s);ER.release(i),ER.release(e),xz.forEach(s=>s())}}function eCe(){const t=ER.acquire();t.length=Ef.size;let e=0;for(const i of Ef)t[e]=i,++e;return Ef.clear(),t}const xz=new Set;function tCe(t){return xz.add(t),Gs(()=>xz.delete(t))}function iCe(t,e,i){let s=nue(t,e,i,(n,r,o)=>{let a,l,u=Fue(()=>FM(n,r),(c,h)=>{var d;((d=n.__accessor__)==null?void 0:d.lifecycle)===du.DESTROYED||a&&a.uid!==l?s.remove():(a||(a=xP.acquireUntracked(c,o,h,n,r),l=a.uid),CO(a))});return Gs(()=>{u.remove(),a&&(a.uid!==l||a.removed||(a.removed=!0,CO(a)),a=null),s=u=null})});return s}function sCe(t,e,i){const s=nue(t,e,i,(n,r,o)=>{let a=!1;return Lue(()=>FM(n,r),(l,u)=>{n.__accessor__.lifecycle!==du.DESTROYED?a||(a=!0,nH(u,l)||o.call(n,l,u,r,n),a=!1):s.remove()})});return s}function nCe(t,e,i,s=!1){return t.__accessor__&&t.__accessor__.lifecycle!==du.DESTROYED?s?sCe(t,e,i):iCe(t,e,i):Gs()}function rCe(t,e,i){let s,n,r=Fue(t,(o,a)=>{s&&s.uid!==n?r.remove():(s||(s=xP.acquireTracked(o,e,a,i),n=s.uid),CO(s))});return Gs(()=>{r.remove(),s&&(s.uid!==n||s.removed||(s.removed=!0,CO(s)),s=null),r=null})}function oCe(t,e,i){let s=!1;return Lue(t,(n,r)=>{s||(s=!0,i(r,n)||e(n,r),s=!1)})}function aCe(t,e,i=!1,s=Yle){return i?oCe(t,e,s):rCe(t,e,s)}function TK(t){return Oue(Ef,e=>e.oldValue===t)}var Vue,zue;function lCe(t){var e;if(t==null)return{value:t};if(Array.isArray(t))return{type:[t[0]],value:null};switch(typeof t){case"object":return(e=t.constructor)!=null&&e.__accessorMetadata__||t instanceof Date?{type:t.constructor,value:t}:t;case"boolean":return{type:Boolean,value:t};case"string":return{type:String,value:t};case"number":return{type:Number,value:t};case"function":return{type:t,value:null};default:return}}const Xd=Symbol("Accessor-Handles"),bz=Symbol("Accessor-Initialized");let ei=class CR{static createSubclass(e={}){if(Array.isArray(e))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:i,declaredClass:s,constructor:n}=e;delete e.declaredClass,delete e.properties,delete e.constructor;const r=this;class o extends r{constructor(...l){super(...l),this.inherited=null,n&&n.apply(this,l)}}kM(o.prototype);for(const a in e){const l=e[a];o.prototype[a]=typeof l=="function"?function(...u){const c=this.inherited;let h;this.inherited=function(...d){if(r.prototype[a])return r.prototype[a].apply(this,d)};try{h=l.apply(this,u)}catch(d){throw this.inherited=c,d}return this.inherited=c,h}:e[a]}for(const a in i){const l=lCe(i[a]);S(l)(o.prototype,a)}return se(s)(o)}static freeze(e){return e instanceof CR?e.__accessor__.mutable=!1:Object.freeze(e),e}static isFrozen(e){return e instanceof CR?!e.__accessor__.mutable:Object.isFrozen(e)}constructor(...e){var s;if(this[Vue]=null,this[zue]=!1,this.constructor===CR)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");const i=new b2e(this);Object.defineProperty(this,"__accessor__",{enumerable:!1,value:i}),e.length>0&&(i.ctorArgs=((s=this.normalizeCtorArgs)==null?void 0:s.apply(this,e))??e[0])}postscript(){const e=this.__accessor__,i=e.ctorArgs;e.initialize(),i&&(this.set(i),e.ctorArgs=null),e.constructed(),this.initialize(),this[bz]=!0}initialize(){}[cue](){this[Xd]=er(this[Xd])}destroy(){var e;this.destroyed||(Q2e(this),this.__accessor__.destroy(),(e=E2e())==null||e.onInstanceDestroy(this))}[Symbol.dispose](){this.destroy()}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[bz]}get destroyed(){var e;return((e=this.__accessor__)==null?void 0:e.lifecycle)===du.DESTROYED||!1}commitProperty(e){Tm(this,e)}hasOwnProperty(e){return this.__accessor__?this.__accessor__.has(e):Object.prototype.hasOwnProperty.call(this,e)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(e,i){return pO(this,e,i),this}watch(e,i,s){return u2e(ht.getLogger(this),"`watch` is deprecated in favor of reactiveUtils.watch",{replacement:"reactiveUtils.watch",version:"4.32",see:"https://developers.arcgis.com/javascript/latest/api-reference/esri-core-reactiveUtils.html#watch",warnOnce:!0}),nCe(this,e,i,s)}addHandles(e,i){if(this.destroyed){const s=Array.isArray(e)?e:[e];for(const n of s)n.remove();return}(this[Xd]??(this[Xd]=new FS)).add(e,i)}removeHandles(e){var i;(i=this[Xd])==null||i.remove(e)}removeAllHandles(){var e;(e=this[Xd])==null||e.removeAll()}removeHandlesReference(e){var i;(i=this[Xd])==null||i.removeReference(e)}hasHandles(e){var i;return((i=this[Xd])==null?void 0:i.has(e))===!0}_override(e,i){i===void 0?this.__accessor__.clearOverride(e):this.__accessor__.override(e,i)}_clearOverride(e){return this.__accessor__.clearOverride(e)}_overrideIfSome(e,i){i==null?this.__accessor__.clearOverride(e):this.__accessor__.override(e,i)}_isOverridden(e){return this.__accessor__.isOverridden(e)}notifyChange(e){this.__accessor__.notifyChange(e)}_get(e){return this.__accessor__.internalGet(e)}_set(e,i){return this.__accessor__.internalSet(e,i),this}};Vue=Xd,zue=bz;let uCe=class Gue{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(e){const i=new Gue;return this._values.forEach((s,n)=>{e&&e.has(n)||i.set(n,be(s.value),s.origin)}),i}get(e,i){i=this._normalizeOrigin(i);const s=this._values.get(e);return i==null||(s==null?void 0:s.origin)===i?s==null?void 0:s.value:void 0}originOf(e){var i;return((i=this._values.get(e))==null?void 0:i.origin)??ds.USER}keys(e){e=this._normalizeOrigin(e);const i=[...this._values.keys()];return e==null?i:i.filter(s=>{var n;return((n=this._values.get(s))==null?void 0:n.origin)===e})}set(e,i,s){if((s=this._normalizeOrigin(s))===ds.DEFAULTS){const n=this._values.get(e);if((n==null?void 0:n.origin)!=null&&n.origin>s)return}this._values.set(e,new cCe(i,s))}delete(e,i){var s;(i=this._normalizeOrigin(i))!=null&&((s=this._values.get(e))==null?void 0:s.origin)!==i||this._values.delete(e)}has(e,i){var s;return(i=this._normalizeOrigin(i))!=null?((s=this._values.get(e))==null?void 0:s.origin)===i:this._values.has(e)}forEach(e){this._values.forEach(({value:i},s)=>e(i,s))}_normalizeOrigin(e){if(e!=null)return e===ds.DEFAULTS?e:ds.USER}},cCe=class{constructor(e,i){this.value=e,this.origin=i}};function Bue(t,e,i){e.keys().forEach(n=>{i.set(n,e.get(n),ds.DEFAULTS)});const s=t.metadata;Object.keys(s).forEach(n=>{t.internalGet(n)&&i.set(n,t.internalGet(n),ds.DEFAULTS)})}function hCe(t,e,i){if(!(t!=null&&t.read)||t.read.enabled===!1||!t.read.source)return!1;const s=t.read.source;if(typeof s=="string"){if(s===e||s.includes(".")&&s.indexOf(e)===0&&rK(s,i))return!0}else for(const n of s)if(n===e||n.includes(".")&&n.indexOf(e)===0&&rK(n,i))return!0;return!1}function dCe(t){return t&&(!t.read||t.read.enabled!==!1&&!t.read.source)}function mCe(t,e,i,s,n){let r=hz(e[i],n);dCe(r)&&(t[i]=!0);for(const o of Object.getOwnPropertyNames(e))r=hz(e[o],n),hCe(r,i,s)&&(t[o]=!0)}function pCe(t,e,i,s){const n=i.metadata,r=t2e(n[e],s),o=r==null?void 0:r.default;if(o===void 0)return;const a=typeof o=="function"?o.call(t,e,s):o;a!==void 0&&i.set(e,a)}const que={origin:"service"};function Hue(t,e,i=que){if(!e||typeof e!="object")return;const s=Su(t),n=s.metadata,r={};for(const o of Object.getOwnPropertyNames(e))mCe(r,n,o,e,i);s.setDefaultOrigin(i.origin);for(const o of Object.getOwnPropertyNames(r)){const a=hz(n[o],i).read,l=a==null?void 0:a.source;let u;u=l&&typeof l=="string"?FM(e,l):e[o],a!=null&&a.reader&&(u=a.reader.call(t,u,e,i)),u!==void 0&&s.set(o,u)}if(!i||!i.ignoreDefaults){s.setDefaultOrigin("defaults");for(const o of Object.getOwnPropertyNames(n))r[o]||pCe(t,o,s,i)}s.setDefaultOrigin("user")}function fCe(t,e,i,s=que){var r;const n={...s,messages:[]};i(n),(r=n.messages)==null||r.forEach(o=>{o.type!=="warning"||t.loaded?s!=null&&s.messages&&s.messages.push(o):t.loadWarnings.push(o)})}function gCe(t,e,i,s,n){var o,a;const r={};return(a=(o=e.write)==null?void 0:o.writer)==null||a.call(t,s,r,i,n),r}function jue(t,e,i,s,n,r){if(!(s!=null&&s.write))return!1;const o=Tm(t,i);if(!n&&s.write.overridePolicy){const a=s.write.overridePolicy.call(t,o,i,r??void 0);a!==void 0&&(n=a)}if(n||(n=s.write),!n||n.enabled===!1||n.layerContainerTypes&&(r!=null&&r.layerContainerType)&&!n.layerContainerTypes.includes(r.layerContainerType))return!1;if((o===null&&!n.allowNull&&!n.writerEnsuresNonNull||o===void 0)&&n.isRequired){const a=new Se("web-document-write:property-required",`Missing value for required property '${i}' on '${t.declaredClass}'`,{propertyName:i,target:t});return a&&(r!=null&&r.messages)?r.messages.push(a):a&&!r&&ht.getLogger("esri.core.accessorSupport.write").error(a.name,a.message),!1}return!(o===void 0||o===null&&!n.allowNull&&!n.writerEnsuresNonNull||!n.alwaysWriteDefaults&&(!e.store.multipleOriginsSupported||e.store.originOf(i)===ds.DEFAULTS)&&_Ce(t,i,r,s,o)||!n.ignoreOrigin&&(r!=null&&r.origin)&&e.store.multipleOriginsSupported&&e.store.originOf(i)<H_(r.origin))}function _Ce(t,e,i,s,n){const r=s.default;if(r===void 0)return!1;if(s.defaultEquals!=null)return s.defaultEquals(n);if(typeof r=="function"){if(Array.isArray(n)){const o=r.call(t,e,i??void 0);return mF(o,n)}return!1}return r===n}function yCe(t,e,i,s){const n=Su(t),r=n.metadata,o=bue(r[e],s);return!!o&&jue(t,n,e,o,i,s)}function Yue(t,e,i){var r,o;if(t&&typeof t.toJSON=="function"&&(!t.toJSON.isDefaultToJSON||!t.write))return xR(e,t.toJSON(i));const s=Su(t),n=s.metadata;for(const a in n){const l=bue(n[a],i);if(!jue(t,s,a,l,void 0,i))continue;const u=Tm(t,a),c=gCe(t,l,l.write&&typeof l.write.target=="string"?l.write.target:a,u,i);Object.keys(c).length>0&&(e=xR(e,c),(o=(r=i==null?void 0:i.resources)==null?void 0:r.pendingOperations)!=null&&o.length&&i.resources.pendingOperations.push(Promise.all(i.resources.pendingOperations).then(()=>xR(e,c,()=>"replace-arrays"))),i!=null&&i.writtenProperties&&i.writtenProperties.push({target:t,propName:a,oldOrigin:v2e(s.store.originOf(a)),newOrigin:i.origin}))}return e}const Xue=t=>{let e=class extends t{constructor(...i){super(...i);const s=Su(this),n=s.store,r=new uCe;s.store=r,Bue(s,n,r)}read(i,s){Hue(this,i,s)}write(i,s){return Yue(this,i??{},s)}toJSON(i){return this.write({},i)}static fromJSON(i,s){return vCe.call(this,i,s)}};return e=y([se("esri.core.JSONSupport")],e),e.prototype.toJSON.isDefaultToJSON=!0,e};function vCe(t,e){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const i=new this;return i.read(t,e),i}let mC=class extends Xue(ei){};mC=y([se("esri.core.JSONSupport")],mC),function(t){function e(i){return i&&typeof i=="object"&&"toJSON"in i&&typeof i.toJSON=="function"}t.JSONSupportMixin=Xue,t.isSerializable=e}(mC||(mC={}));const it=mC;function mt(t,e,i){let s,n;return e===void 0||Array.isArray(e)?(n=t,i=e,s=[void 0]):(n=e,s=Array.isArray(t)?t:[t]),(r,o)=>{const a=r.constructor.prototype;s.forEach(l=>{const u=uue(r,l,n);u.read&&typeof u.read=="object"||(u.read={}),u.read.reader=a[o],i&&(u.read.source=(u.read.source||[]).concat(i))})}}let gs=class{constructor(e,i={ignoreUnknown:!1,useNumericKeys:!1}){this._jsonToAPI=e,this._options=i,this.apiValues=[],this.jsonValues=[],this._apiToJSON=xCe(e),this.apiValues=PK(this._apiToJSON),this.jsonValues=PK(this._jsonToAPI),this.read=s=>this.fromJSON(s),this.write=(s,n,r)=>{const o=this.toJSON(s);o!==void 0&&la(r,o,n)},this.write.isJSONMapWriter=!0}toJSON(e){if(e==null)return null;if(this._apiToJSON.hasOwnProperty(e)){const i=this._apiToJSON[e];return this._options.useNumericKeys?+i:i}return this._options.ignoreUnknown?null:e}fromJSON(e){return e!=null&&this._jsonToAPI.hasOwnProperty(e)?this._jsonToAPI[e]:this._options.ignoreUnknown?void 0:e}};function xCe(t){const e={};for(const i in t)e[t[i]]=i;return e}function PK(t){const e=[];for(const i in t)e.push(i);return e.sort(),e}function ca(){return function(t,e){return new gs(t,{ignoreUnknown:!0,...e})}}let gH=class{constructor(e,i,s,n,r,o){this.semiMajorAxis=e,this.flattening=i,this.outerAtmosphereRimWidth=s,this.atmosphereHeight=n,this.scaleHeight=r;const a=1-this.flattening;this.semiMinorAxis=this.semiMajorAxis*a,this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=o||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}};const Pr=new gH(6378137,1/298.257223563,3e5,1e5,.085,.006694379990137799),Pm=new gH(3396190,1/169.8944472236118,23e4,6e4,.111),my=new gH(1737400,0,0,0,0),bCe="modulepreload",wCe=function(t){return"/react-styx/"+t},MK={},_e=function(e,i,s){let n=Promise.resolve();if(i&&i.length>0){let o=function(u){return Promise.all(u.map(c=>Promise.resolve(c).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));n=o(i.map(u=>{if(u=wCe(u),u in MK)return;MK[u]=!0;const c=u.endsWith(".css"),h=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${h}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":bCe,c||(d.as="script"),d.crossOrigin="",d.href=u,l&&d.setAttribute("nonce",l),document.head.appendChild(d),c)return new Promise((m,f)=>{d.addEventListener("load",m),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${u}`)))})}))}function r(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return n.then(o=>{for(const a of o||[])a.status==="rejected"&&r(a.reason);return e().catch(r)})},SCe=/^https:\/\/([a-z\d-]+)(\.maps([^.]*))?\.arcgis\.com/i,ECe={devext:{customBaseUrl:"mapsdevext.arcgis.com",portalHostname:"devext.arcgis.com"},qaext:{customBaseUrl:"mapsqa.arcgis.com",portalHostname:"qaext.arcgis.com"},www:{customBaseUrl:"maps.arcgis.com",portalHostname:"www.arcgis.com"}};function AK(t){const e=t==null?void 0:t.match(SCe);if(!e)return null;const[,i,s,n]=e;if(!i)return null;let r=null,o=null,a=null;const{devext:l,qaext:u,www:c}=ECe;if(s)if(r=i,n)switch(n.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=l);break;case"qa":({customBaseUrl:o,portalHostname:a}=u);break;default:return null}else({customBaseUrl:o,portalHostname:a}=c);else switch(i.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=l);break;case"qaext":({customBaseUrl:o,portalHostname:a}=u);break;case"www":({customBaseUrl:o,portalHostname:a}=c);break;default:return null}return{customBaseUrl:o,isPortal:!1,portalHostname:a,urlKey:r}}function CCe(t){return/\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(t)}function Wue(t){const e=/^https?:\/\/(?:cdn|[a-z\d-]+\.maps)\.arcgis\.com/i,i=/^https?:\/\/(?:cdndev|[a-z\d-]+\.mapsdevext)\.arcgis\.com/i,s=/^https?:\/\/(?:cdnqa|[a-z\d-]+\.mapsqa)\.arcgis\.com/i;return e.test(t)?t=t.replace(e,"https://www.arcgis.com"):i.test(t)?t=t.replace(i,"https://devext.arcgis.com"):s.test(t)&&(t=t.replace(s,"https://qaext.arcgis.com")),t}function Zue(t){const e=atob(t),i=new Uint8Array(e.length);for(let s=0;s<e.length;s++)i[s]=e.charCodeAt(s);return i.buffer}function TCe(t){const e=new Uint8Array(t);let i="";for(let s=0;s<e.length;s++)i+=String.fromCharCode(e[s]);return btoa(i)}const PCe=()=>ht.getLogger("esri.core.urlUtils"),$S=Ks.request,IK="esri/config: esriConfig.request.proxyUrl is not set.",Kue=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,Que=/^\s*http:/i,MCe=/^\s*https:/i,ACe=/^\s*file:/i,ICe=/:\d+$/,DCe=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,NCe=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),RCe=new RegExp("^((([^[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^[:]*))(:([0-9]+))?$");let Sw=class{constructor(e=""){this.uri=e,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let i=this.uri.match(NCe);this.scheme=i[2]||(i[1]?"":null),this.authority=i[4]||(i[3]?"":null),this.path=i[5],this.query=i[7]||(i[6]?"":null),this.fragment=i[9]||(i[8]?"":null),this.authority!=null&&(i=this.authority.match(RCe),this.user=i[3]||null,this.password=i[4]||null,this.host=i[6]||i[7],this.port=i[9]||null)}toString(){return this.uri}};const mD={},OCe=new Sw(Ks.applicationUrl);let el=OCe;const LCe=FCe();let _H=LCe;const yH=()=>el,Wpt=()=>_H;function FCe(){const t=el.path,e=t.slice(0,t.lastIndexOf("/")+1);return`${`${el.scheme}://${el.host}${el.port!=null?`:${el.port}`:""}`}${e}`}function ol(t){if(!t)return null;const e={path:null,query:null},i=new Sw(t),s=t.indexOf("?");return i.query===null?e.path=t:(e.path=t.slice(0,s),e.query=vH(i.query)),i.fragment&&(e.hash=i.fragment,i.query===null&&(e.path=e.path.slice(0,e.path.length-(i.fragment.length+1)))),e}function vH(t){const e=t.split("&"),i={};for(const s of e){if(!s)continue;const n=s.indexOf("=");let r,o;n<0?(r=decodeURIComponent(s),o=""):(r=decodeURIComponent(s.slice(0,n)),o=decodeURIComponent(s.slice(n+1)));let a=i[r];typeof a=="string"&&(a=i[r]=[a]),Array.isArray(a)?a.push(o):i[r]=o}return i}function bP(t,e){return t?Object.keys(t).map(i=>{const s=t[i];if(s==null)return"";const n=encodeURIComponent(i)+"=",r=e==null?void 0:e[i];return r?n+encodeURIComponent(r(s)):Array.isArray(s)?s.map(o=>it.isSerializable(o)?n+encodeURIComponent(JSON.stringify(o)):n+encodeURIComponent(o)).join("&"):it.isSerializable(s)?n+encodeURIComponent(JSON.stringify(s)):n+encodeURIComponent(s)}).filter(i=>i).join("&"):""}function Jue(t=!1){let e,i=$S.proxyUrl;if(typeof t=="string"){e=GCe(t);const s=EF(t);s&&(i=s.proxyUrl)}else e=!!t;if(!i)throw PCe().warn(IK),new Se("urlUtils:proxy-not-set",IK);return e&&Sz()&&(i=EH(i)),ol(i)}function Zpt(t,e=!1){const i=EF(t);let s,n;if(i){const r=xH(i.proxyUrl);s=r.path,n=r.query?vH(r.query):null}else if(e){const r=Jue(t);s=r.path,n=r.query}if(s){const r=ol(t);t=s+"?"+r.path;const o=bP({...n,...r.query});o&&(t=`${t}?${o}`)}return t}const E2={path:"",query:""};function xH(t){const e=t.indexOf("?");return e!==-1?(E2.path=t.slice(0,e),E2.query=t.slice(e+1)):(E2.path=t,E2.query=null),E2}function ece(t){return t=(t=PO(t=XCe(t=xH(t).path),!0)).toLowerCase()}function kCe(t){const e={proxyUrl:t.proxyUrl,urlPrefix:ece(t.urlPrefix)},i=$S.proxyRules,s=e.urlPrefix;let n=i.length;for(let r=0;r<i.length;r++){const o=i[r].urlPrefix;if(s.indexOf(o)===0){if(s.length===o.length)return-1;n=r;break}o.indexOf(s)===0&&(n=r+1)}return i.splice(n,0,e),n}function EF(t){const e=$S.proxyRules,i=ece(t);for(let s=0;s<e.length;s++)if(i.indexOf(e[s].urlPrefix)===0)return e[s]}function $Ce(t,e){if(!t||!e)return!1;t=TO(t),e=TO(e);const i=AK(t),s=AK(e);return i!=null&&s!=null?i.portalHostname===s.portalHostname:i==null&&s==null&&Zw(t,e,!0)}function tce(t,e){return t=TO(t),e=TO(e),PO(t)===PO(e)}function TO(t){const e=(t=hd(t)).indexOf("/sharing");return e>0?t.slice(0,e):t.replace(/\/+$/,"")}function wz(t,e=$S.interceptors){const i=s=>s==null||s instanceof RegExp&&s.test(t)||typeof s=="string"&&t.startsWith(s);if(e){for(const s of e)if(Array.isArray(s.urls)){if(s.urls.some(i))return s}else if(i(s.urls))return s}return null}function Zw(t,e,i=!1){if(!t||!e)return!1;const s=Cz(t),n=Cz(e);return!(!i&&s.scheme!==n.scheme)&&s.host!=null&&n.host!=null&&s.host.toLowerCase()===n.host.toLowerCase()&&s.port===n.port}function bH(t){if(typeof t=="string"){if(!uc(t))return!0;t=Cz(t)}if(Zw(t,el))return!0;const e=$S.trustedServers||[];for(let i=0;i<e.length;i++){const s=UCe(e[i]);for(let n=0;n<s.length;n++)if(Zw(t,s[n]))return!0}return!1}function UCe(t){return mD[t]||(SH(t)||Lm(t)?mD[t]=[new Sw(Yc(t))]:mD[t]=[new Sw(`http://${t}`),new Sw(`https://${t}`)]),mD[t]}function Yc(t,e=_H,i){return Lm(t)?i!=null&&i.preserveProtocolRelative?t:el.scheme==="http"&&el.authority===lc(t).slice(2)?`http:${t}`:`https:${t}`:SH(t)?t:Kw(t[0]==="/"?jCe(e):e,t)}function wH(t,e=_H,i){if(t==null||!uc(t))return t;const s=hd(t),n=s.toLowerCase(),r=hd(e).toLowerCase().replace(/\/+$/,""),o=i?hd(i).toLowerCase().replace(/\/+$/,""):null;if(o&&r.indexOf(o)!==0)return t;const a=(h,d,m)=>(m=h.indexOf(d,m))===-1?h.length:m;let l=a(n,"/",n.indexOf("//")+2),u=-1;for(;n.slice(0,l+1)===r.slice(0,l)+"/"&&(u=l+1,l!==n.length);)l=a(n,"/",l+1);if(u===-1||o&&u<o.length)return t;t=s.slice(u);const c=r.slice(u-1).replaceAll(/[^/]+/g,"").length;if(c>0)for(let h=0;h<c;h++)t=`../${t}`;else t=`./${t}`;return t}function hd(t){return t=KCe(t=ZCe(t=WCe(t=Yc(t=t.trim()))))}function Kw(...t){const e=t.filter(Df);if(!(e!=null&&e.length))return;const i=[];if(uc(e[0])){const n=e[0],r=n.indexOf("//");r!==-1&&(i.push(n.slice(0,r+1)),qCe(e[0])&&(i[0]+="/"),e[0]=n.slice(r+2))}else e[0][0]==="/"&&i.push("");const s=e.reduce((n,r)=>r?n.concat(r.split("/")):n,[]);for(let n=0;n<s.length;n++){const r=s[n];r===".."&&i.length>0&&i[i.length-1]!==".."?i.pop():(!r&&n===s.length-1||r&&(r!=="."||i.length===0))&&i.push(r)}return i.join("/")}function lc(t,e=!1){if(t==null||CF(t)||k1(t))return null;let i=t.indexOf("://");if(i===-1&&Lm(t))i=2;else{if(i===-1)return null;i+=3}const s=t.indexOf("/",i);return s!==-1&&(t=t.slice(0,s)),e&&(t=PO(t,!0)),t}function uc(t){return Lm(t)||SH(t)}function CF(t){return t!=null&&t.slice(0,5)==="blob:"}function k1(t){return t!=null&&t.slice(0,5)==="data:"}function VCe(t){const e=Qw(t);return e!=null&&e.isBase64?Zue(e.data):null}function Kpt(t){return TCe(t).replaceAll("+","-").replaceAll("/","_").replace(/=+$/,"")}const zCe=/^data:(.*?)(;base64)?,(.*)$/;function Qw(t){const e=t.match(zCe);if(!e)return null;const[,i,s,n]=e;return{mediaType:i,isBase64:!!s,data:n}}function ice(t){return t.isBase64?`data:${t.mediaType};base64,${t.data}`:`data:${t.mediaType},${t.data}`}async function Qpt(t){return(await fetch(t)).blob()}function Jpt(t){const e=VCe(t);if(!e)return null;const i=Qw(t);return new Blob([e],{type:i.mediaType})}function Lm(t){return t!=null&&t[0]==="/"&&t[1]==="/"}function SH(t){return t!=null&&Kue.test(t)}function GCe(t){return t!=null&&MCe.test(t)||el.scheme==="https"&&Lm(t)}function BCe(t){return t!=null&&Que.test(t)||el.scheme==="http"&&Lm(t)}function qCe(t){return t!=null&&ACe.test(t)}function EH(t){return Lm(t)?`https:${t}`:t.replace(Que,"https:")}function HCe(){return el.scheme==="http"}function Sz(){return el.scheme==="https"}function PO(t,e=!1){return Lm(t)?t.slice(2):(t=t.replace(Kue,""),e&&t.length>1&&t[0]==="/"&&t[1]==="/"&&(t=t.slice(2)),t)}function jCe(t){const e=t.indexOf("//"),i=t.indexOf("/",e+2);return i===-1?t:t.slice(0,i)}function YCe(t){let e=0;if(uc(t)){const s=t.indexOf("//");s!==-1&&(e=s+2)}const i=t.lastIndexOf("/");return i<e?t:t.slice(0,i+1)}function eft(t,e){if(!t)return"";const i=ol(t).path.replace(/\/+$/,""),s=i.slice(i.lastIndexOf("/")+1);if(!(e!=null&&e.length))return s;const n=new RegExp(`\\.(${e.join("|")})$`,"i");return s.replace(n,"")}function XCe(t){return t.endsWith("/")?t:`${t}/`}function sce(t){return t.replace(/\/+$/,"")}function WCe(t){if(/^https?:\/\//i.test(t)){const e=xH(t);t=(t=e.path.replaceAll(/\/{2,}/g,"/")).replace("/","//"),e.query&&(t+=`?${e.query}`)}return t}function ZCe(t){return t.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function KCe(t){const e=$S.httpsDomains;if(!BCe(t))return t;const i=t.indexOf("/",7);let s;if(s=i===-1?t:t.slice(0,i),s=s.toLowerCase().slice(7),ICe.test(s)){if(!s.endsWith(":80"))return t;s=s.slice(0,-3),t=t.replace(":80","")}return HCe()&&s===el.authority&&!DCe.test(t)||(Sz()&&s===el.authority||e&&e.some(n=>s===n||s.endsWith(`.${n}`))||Sz()&&!EF(t))&&(t=EH(t)),t}function Ez(t,e,i){if(!(e&&i&&t&&uc(t)))return t;const s=t.indexOf("//"),n=t.indexOf("/",s+2),r=t.indexOf(":",s+2),o=Math.min(n<0?t.length:n,r<0?t.length:r);return t.slice(s+2,o).toLowerCase()!==e.toLowerCase()?t:`${t.slice(0,s+2)}${i}${t.slice(o)}`}function Cz(t){return typeof t=="string"?new Sw(Yc(t)):(t.scheme||(t.scheme=el.scheme),t)}function tft(t){return JCe.test(t)}function nce(t,e){const i=ol(t),s=Object.keys(i.query||{});return s.length>0&&e&&e.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${s.join(", ")}.`),i.path}function QCe(t,e,i){const s=ol(t),n=s.query||{};return n[e]=String(i),`${s.path}?${bP(n)}`}function tU(t,e){if(!e)return t;const i=ol(t),s=i.query||{};for(const[r,o]of Object.entries(e))o!=null&&(s[r]=o);const n=bP(s);return n?`${i.path}?${n}`:i.path}function ift(t){if(t==null)return null;const e=t.match(rce);return e?e[2]:null}function DK(t){if(t==null)return null;const e=t.match(rce);return e?{path:e[1],extension:e[2]}:{path:t,extension:null}}async function sft(t){return typeof t=="string"?Qw(t)??{data:t}:new Promise((e,i)=>{const s=new FileReader;s.readAsDataURL(t),s.onload=()=>e(Qw(s.result)),s.onerror=n=>i(n)})}const rce=/([^.]*)\.([^/]*)$/,JCe=/(^data:image\/svg|\.svg$)/i,oce="20250407",ace="04d2b42da93678ca718b23aaf7e216985f10fa8e";Symbol.dispose??(Symbol.dispose=Symbol("Symbol.dispose")),Symbol.asyncDispose??(Symbol.asyncDispose=Symbol("Symbol.asyncDispose"));const eTe="4.32";let Yi,CH=eTe;CH="4.32.10";function nft(t){Yi=t}function rft(t){const e=Yi==null?void 0:Yi.findCredential(t);return e!=null&&e.token?QCe(t,"token",e.token):t}ke("host-webworker")||globalThis.$arcgis||Object.defineProperty(globalThis,"$arcgis",{configurable:!1,enumerable:!0,writable:!1,value:{}}),ke("host-webworker");function US(t,e){var s;const i=(s=e==null?void 0:e.url)==null?void 0:s.path;if(t&&i&&(t=Yc(t,i,{preserveProtocolRelative:!0}),e.portalItem&&e.readResourcePaths)){const n=wH(t,e.portalItem.itemUrl);n!=null&&tTe.test(n)&&e.readResourcePaths.push(e.portalItem.resourceFromPath(n).path)}return(t=Tz(t,e==null?void 0:e.portal))&&TF.test(t)?PH(t):t}function zM(t,e,i=wP.YES){var n,r;if((t=t&&TF.test(t)?uce(t):t)==null)return t;!uc(t)&&(e!=null&&e.blockedRelativeUrls)&&e.blockedRelativeUrls.push(t);let s=Yc(t);if(e){const o=((n=e.verifyItemRelativeUrls)==null?void 0:n.rootPath)||((r=e.url)==null?void 0:r.path);if(o){const a=Tz(o,e.portal),l=Tz(s,e.portal);s=wH(l,a,a),s!=null&&s!==l&&s!==t&&e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.writtenUrls.push(s)}}return s=lce(s,e==null?void 0:e.portal),uc(s)&&(s=hd(s)),e!=null&&e.resources&&(e!=null&&e.portalItem)&&!uc(s)&&!k1(s)&&i===wP.YES&&e.resources.toKeep.push({resource:e.portalItem.resourceFromPath(s),compress:!1}),s}function TH(t,e,i){return US(t,i)}function o1(t,e,i,s){const n=zM(t,s);n!==void 0&&(e[i]=n)}const TF=/\/items\/([^/]+)\/resources\/(.*)/,tTe=/^\.\/resources\//;function iTe(t){const e=(t==null?void 0:t.match(TF))??null;return(e==null?void 0:e[1])??null}function sTe(t){const e=(t==null?void 0:t.match(TF))??null;if(e==null)return null;const i=e[2],s=i.lastIndexOf("/");if(s===-1){const{path:o,extension:a}=DK(i);return{prefix:null,filename:o,extension:a}}const{path:n,extension:r}=DK(i.slice(s+1));return{prefix:i.slice(0,s),filename:n,extension:r}}function lce(t,e){return e&&!e.isPortal&&e.urlKey&&e.customBaseUrl?Ez(t,`${e.urlKey}.${e.customBaseUrl}`,e.portalHostname):t}function Tz(t,e){if(!e||e.isPortal||!e.urlKey||!e.customBaseUrl)return t;const i=`${e.urlKey}.${e.customBaseUrl}`,s=yH();return Zw(s,`${s.scheme}://${i}`)?Ez(t,e.portalHostname,i):Ez(t,i,e.portalHostname)}function PH(t){if(!t)return t||null;let e=t;return e&&Yi&&!Yi.findCredential(e)&&(e=Wue(e),e=e.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),e=e.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),e=e.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com")),e}function uce(t){if(!t)return t||null;let e=t;return e=e.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com"),e=e.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com"),e=e.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"),e&&Yi&&!Yi.findCredential(e)&&(e=Wue(e)),e}var wP;(function(t){t[t.YES=0]="YES",t[t.NO=1]="NO"})(wP||(wP={}));const oft=Object.freeze(Object.defineProperty({__proto__:null,get MarkKeep(){return wP},ensureMainOnlineDomain:lce,fromCDNUrl:uce,fromJSON:US,itemIdFromResourceUrl:iTe,prefixAndFilenameFromResourceUrl:sTe,read:TH,toCDNUrl:PH,toJSON:zM,write:o1},Symbol.toStringTag,{value:"Module"})),cce={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},hce=Object.values(cce),dce=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${hce.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),nTe=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${hce.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),rTe=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function aft(t){return dce.test(t)}function VS(t){if(t==null)return null;const e=ol(t),i=(e==null?void 0:e.path.match(dce))||(e==null?void 0:e.path.match(nTe));if(!i)return null;const[,s,n,r,o]=i,a=n.indexOf("/");return{title:MH(a!==-1?n.slice(a+1):n),serverType:cce[r.toLowerCase()],sublayer:o!=null&&o!==""?parseInt(o,10):null,url:{path:s}}}function oTe(t){const e=ol(t).path.match(rTe);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function MH(t){return(t=t.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+t.slice(1)}function aTe(t,e){const i=[];if(t){const s=VS(t);s!=null&&s.title&&i.push(s.title)}if(e){const s=MH(e);i.push(s)}if(i.length===2){if(i[0].toLowerCase().includes(i[1].toLowerCase()))return i[0];if(i[1].toLowerCase().includes(i[0].toLowerCase()))return i[1]}return i.join(" - ")}function MO(t){let e=lc(t,!0);return!!e&&(e=e.toLowerCase(),e.endsWith(".arcgis.com")&&(e.startsWith("services")||e.startsWith("tiles")||e.startsWith("features")))}function lTe(t,e){return t&&sce(nce(t,e))}function uTe(t){let{url:e}=t;if(!e)return{url:e};e=nce(e,t.logger);const i=ol(e),s=VS(i.path);let n;if(s!=null)s.sublayer!=null&&t.layer.layerId==null&&(n=s.sublayer),e=s.url.path;else if(t.nonStandardUrlAllowed){const r=oTe(i.path);r!=null&&(e=r.serviceUrl,n=r.sublayerId)}return{url:sce(e),layerId:n}}function cTe(t,e,i,s,n){o1(e,s,"url",n),s.url&&t.layerId!=null&&(s.url=Kw(s.url,i,t.layerId.toString()))}function lft(t){if(!t)return!1;const e=t.toLowerCase(),i=e.includes("/services/"),s=e.includes("/mapserver/wmsserver"),n=e.includes("/imageserver/wmsserver"),r=e.includes("/wmsserver");return i&&(s||n||r)}const hTe=new Set(["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"]);function dTe(t){const e=lc(t,!0);return!!e&&e.endsWith(".arcgis.com")&&!hTe.has(e)&&!t.endsWith("/sharing/rest/generateToken")}function mce(t,e){return!(!Ks.apiKey||!dTe(t))}function mTe(t,e,i=!1,s){return new Promise((n,r)=>{if(dc(s))return void r(NK());let o=()=>{u(),r(new Error(`Unable to load ${e}`))},a=()=>{const c=t;u(),n(c)},l=()=>{if(!t)return;const c=t;u(),c.src="",r(NK())};const u=()=>{ke("esri-image-decode")||(t.removeEventListener("error",o),t.removeEventListener("load",a)),o=null,a=null,t=null,s!=null&&s.removeEventListener("abort",l),l=null,i&&URL.revokeObjectURL(e)};s!=null&&s.addEventListener("abort",l),ke("esri-image-decode")?t.decode().then(a,o):(t.addEventListener("error",o),t.addEventListener("load",a))})}function NK(){try{return new DOMException("Aborted","AbortError")}catch{const t=new Error;return t.name="AbortError",t}}const pce="Timeout exceeded";function pTe(){return new Error(pce)}function uft(t){return typeof t=="object"&&!!t&&"message"in t&&t.message===pce}function fTe(t){Ks.request.crossOriginNoCorsDomains||(Ks.request.crossOriginNoCorsDomains={});const e=Ks.request.crossOriginNoCorsDomains;for(let i of t)i=i.toLowerCase(),/^https?:\/\//.test(i)?e[lc(i)??""]=0:(e[lc("http://"+i)??""]=0,e[lc("https://"+i)??""]=0)}function gTe(t){const e=Ks.request.crossOriginNoCorsDomains;if(e){let i=lc(t);if(i)return i=i.toLowerCase(),!Zw(i,yH())&&e[i]<Date.now()-36e5}return!1}async function _Te(t){var n;const e=ol(t);t=e.path,((n=e.query)==null?void 0:n.f)==="json"&&(t+="?f=json");try{await fetch(t,{mode:"no-cors",credentials:"include"})}catch{}const i=Ks.request.crossOriginNoCorsDomains,s=lc(t);i&&s&&(i[s.toLowerCase()]=Date.now())}async function $n(t,e){var m;t instanceof URL&&(t=t.toString()),(e==null?void 0:e.query)instanceof URLSearchParams&&(e.query=vH(e.query.toString().replaceAll("+"," ")));const i=k1(t),s=CF(t);s||i||(t=hd(t));const n={url:t,requestOptions:{...e}},r=f=>({data:f,getAllHeaders:Jw,getHeader:Jw,httpStatus:200,requestOptions:n.requestOptions,url:n.url}),o=wz(t,Bc.internalInterceptors);if(o){const f=await OK(o,n);if(f!=null)return r(f)}let a=wz(t);if(a){const f=await OK(a,n);if(f!=null)return r(f);a.after||a.error||(a=null)}if(t=n.url,(e=n.requestOptions).responseType==="image"&&(ke("host-webworker")||ke("host-node")))throw dd("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),n);if(e.method==="head"){if(e.body)throw dd("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),n);if(i||s)throw dd("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),n)}if(await wTe(),AO)return AO.execute(t,e);const l=new AbortController,u=Jc(e,()=>l.abort()),c={controller:l,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:a,params:n,redoRequest:!1,useIdentity:Bc.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},h=e.useRequestQueue?PTe(c):Mz(c),d=await h.finally(()=>u==null?void 0:u.remove());return(m=a==null?void 0:a.after)==null||m.call(a,d),d}let AO;const Bc=Ks.request,fce="FormData"in globalThis,yTe=new Set([499,498,403,401]),vTe=new Set(["COM_0056","COM_0057","SB_0008"]),xTe=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],Jw=()=>null,IO=Symbol();function bTe(t){const e=lc(t);e&&!$n._corsServers.includes(e)&&$n._corsServers.push(e)}function RK(t){const e=lc(t);return!e||e.endsWith(".arcgis.com")||$n._corsServers.includes(e)||bH(e)}function dd(t,e,i,s){let n="Error";const r={url:i.url,requestOptions:i.requestOptions,getAllHeaders:Jw,getHeader:Jw,ssl:!1};if(e instanceof Se)return e.details?(e.details=be(e.details),e.details.url=i.url,e.details.requestOptions=i.requestOptions):e.details=r,e;if(e){const o=s&&(()=>Array.from(s.headers)),a=s&&(c=>s.headers.get(c)),l=s==null?void 0:s.status,u=e.message;u&&(n=u),o&&a&&(r.getAllHeaders=o,r.getHeader=a),r.httpStatus=(e.httpCode!=null?e.httpCode:e.code)||l||0,r.subCode=e.subcode,r.messageCode=e.messageCode,typeof e.details=="string"?r.messages=[e.details]:r.messages=e.details,r.raw=IO in e?e[IO]:e}return cl(e)?Vn():new Se(t,n,r)}async function wTe(){ke("host-webworker")&&!AO&&(AO=await _e(()=>import("./request-60J4GA3N.js"),[]))}async function Pz(){Yi||await _e(()=>import("./IdentityManager-DpB67qwJ.js"),__vite__mapDeps([0,1]))}async function STe(t){var a;const e=t.params.url,i=t.params.requestOptions,s=t.controller.signal,n=i.body;let r=null,o=null;if(fce&&"HTMLFormElement"in globalThis&&(n instanceof FormData?r=n:n instanceof HTMLFormElement&&(r=new FormData(n))),typeof n=="string"&&(o=n),t.fetchOptions={cache:i.cacheBust?"no-cache":"default",credentials:"same-origin",headers:i.headers||{},method:i.method==="head"?"HEAD":"GET",mode:"cors",priority:Bc.priority,redirect:"follow",signal:s},(r||o)&&(t.fetchOptions.body=r||o),i.authMode==="anonymous"&&(t.useIdentity=!1),t.hasToken=!!(/token=/i.test(e)||(a=i.query)!=null&&a.token||r!=null&&r.get("token")),!t.hasToken&&mce(e)&&(i.query||(i.query={}),i.query.token=Ks.apiKey,t.hasToken=!0),t.useIdentity&&!t.hasToken&&!t.credentialToken&&!gce(e)&&!dc(s)){let l;i.authMode==="immediate"?(await Pz(),l=await Yi.getCredential(e,{signal:s}),t.credential=l):i.authMode==="no-prompt"?(await Pz(),l=await Yi.getCredential(e,{prompt:!1,signal:s}).catch(()=>{}),t.credential=l):Yi&&(l=Yi.findCredential(e)),l&&(t.credentialToken=l.token,t.useSSL=!!l.ssl)}}function gce(t){return xTe.some(e=>e.test(t))}async function ETe(t){let e=t.params.url;const i=t.params.requestOptions,s=t.fetchOptions??{},n=CF(e)||k1(e),r=i.responseType||"json",o=n?0:i.timeout!=null?i.timeout:Bc.timeout;let a=!1;if(!n){t.useSSL&&(e=EH(e));let d={...i.query};t.credentialToken&&(d.token=t.credentialToken);let m=bP(d);ke("esri-url-encodes-apostrophe")&&(m=m.replaceAll("'","%27"));const f=e.length+1+m.length;let _;a=i.method==="delete"||i.method==="post"||i.method==="put"||!!i.body||f>Bc.maxUrlLength;const v=i.useProxy||!!EF(e);if(v){const x=Jue(e);_=x.path,!a&&_.length+1+f>Bc.maxUrlLength&&(a=!0),x.query&&(d={...x.query,...d})}if(s.method==="HEAD"&&(a||v)){if(a)throw f>Bc.maxUrlLength?dd("request:invalid-parameters",new Error("URL exceeds maximum length"),t.params):dd("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),t.params);if(v)throw dd("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),t.params)}if(a?(s.method=i.method==="delete"?"DELETE":i.method==="put"?"PUT":"POST",i.body?e=tU(e,d):(s.body=bP(d),s.headers||(s.headers={}),s.headers["Content-Type"]="application/x-www-form-urlencoded")):e=tU(e,d),v&&(t.useProxy=!0,e=`${_}?${e}`),d.token&&fce&&s.body instanceof FormData&&!CCe(e)&&s.body.set("token",d.token),i.hasOwnProperty("withCredentials"))t.withCredentials=i.withCredentials;else if(!Zw(e,yH())){if(bH(e))t.withCredentials=!0;else if(Yi){const x=Yi.findServerInfo(e);x!=null&&x.webTierAuth&&(t.withCredentials=!0)}}t.withCredentials&&(s.credentials="include",gTe(e)&&await _Te(a?tU(e,d):e))}let l,u,c=0,h=!1;o>0&&(c=setTimeout(()=>{h=!0,t.controller.abort()},o));try{if(i.responseType==="native-request-init")u=s,u.url=e,i.signal?u.signal=i.signal:delete u.signal;else if(i.responseType!=="image"||s.cache!=="default"||s.method!=="GET"||a||CTe(i.headers)||!n&&!t.useProxy&&Bc.proxyUrl&&!RK(e)){if($n._beforeFetch&&await $n._beforeFetch(e,s),l=await fetch(e,s),$n._afterFetch&&await $n._afterFetch(l),t.useProxy||bTe(e),i.responseType==="native")u=l;else if(s.method!=="HEAD")if(l.ok){switch(r){case"array-buffer":u=await l.arrayBuffer();break;case"blob":case"image":u=await l.blob();break;default:u=await l.text()}if(c&&(clearTimeout(c),c=0),r==="json"||r==="xml"||r==="document")if(u)switch(r){case"json":u=JSON.parse(u);break;case"xml":u=LK(u,"application/xml");break;case"document":u=LK(u,"text/html")}else u=null;if(u){if(r==="array-buffer"||r==="blob"){const d=l.headers.get("Content-Type");if(d&&/application\/json|text\/plain/i.test(d)&&u[r==="blob"?"size":"byteLength"]<=750)try{const m=await new Response(u).json();m.error&&(u=m)}catch{}}r==="image"&&u instanceof Blob&&(u=await FK(URL.createObjectURL(u),t,!0))}}else{u=await l.text();try{u=JSON.parse(u)}catch{}}}else u=await FK(e,t)}catch(d){if(d.name==="AbortError")throw h?pTe():Vn("Request canceled");if(!(!l&&d instanceof TypeError&&Bc.proxyUrl)||i.body||i.method==="delete"||i.method==="head"||i.method==="post"||i.method==="put"||t.useProxy||RK(e))throw d;t.redoRequest=!0,kCe({proxyUrl:Bc.proxyUrl,urlPrefix:lc(e)??""})}finally{c&&clearTimeout(c)}return[l,u]}async function OK(t,e){if(t.responseData!=null)return t.responseData;if(t.headers&&(e.requestOptions.headers={...e.requestOptions.headers,...t.headers}),t.query&&(e.requestOptions.query={...e.requestOptions.query,...t.query}),t.before){let i,s;try{s=await t.before(e)}catch(n){i=dd("request:interceptor",n,e)}if((s instanceof Error||s instanceof Se)&&(i=dd("request:interceptor",s,e)),i)throw t.error&&t.error(i),i;return s}}function CTe(t){if(t){for(const e of Object.getOwnPropertyNames(t))if(t[e])return!0}return!1}function LK(t,e){let i;try{i=new DOMParser().parseFromString(t,e)}catch{}if(!i||i.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return i}$n._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"],$n._beforeFetch=void 0,$n._afterFetch=void 0;const TTe=new Map;async function PTe(t){const e=ATe(t.params.url);if(!e)return Mz(t);const{QueueProcessor:i}=await _e(()=>import("./QueueProcessor-iTAW5oVl.js"),[]);return RM(TTe,e.origin,()=>{const n=e.isHosted?ke("request-queue-concurrency-hosted"):ke("request-queue-concurrency-non-hosted");return new i({concurrency:n,process:r=>{if(dc(r.params.requestOptions))throw dd("",Vn("Request canceled"),r.params);return Mz(r)}})}).push(t)}async function Mz(t){var r,o;let e,i;await STe(t);try{do[e,i]=await ETe(t);while(!await MTe(t,e,i))}catch(a){const l=dd("request:server",a,t.params,e);throw l.details.ssl=t.useSSL,(r=t.interceptor)!=null&&r.error&&t.interceptor.error(l),l}const s=t.params.url;if(i&&/\/sharing\/rest\/(accounts|portals)\/self/i.test(s)){if(!t.hasToken&&!t.credentialToken&&((o=i.user)!=null&&o.username)&&!bH(s)){const a=lc(s,!0);a&&Bc.trustedServers.push(a)}Array.isArray(i.authorizedCrossOriginNoCorsDomains)&&fTe(i.authorizedCrossOriginNoCorsDomains)}const n=t.credential;if(n&&Yi){const a=Yi.findServerInfo(n.server);let l=a==null?void 0:a.owningSystemUrl;if(l){l=l.replace(/\/?$/,"/sharing");const u=Yi.findCredential(l,n.userId);u&&Yi._getIdenticalSvcIdx(l,u)===-1&&u.resources.unshift(l)}}return{data:i,getAllHeaders:e?()=>Array.from(e.headers):Jw,getHeader:e?a=>e.headers.get(a):Jw,httpStatus:(e==null?void 0:e.status)??200,requestOptions:t.params.requestOptions,ssl:t.useSSL,url:t.params.url}}async function MTe(t,e,i){var u;if(t.redoRequest)return t.redoRequest=!1,!1;const s=t.params.requestOptions;if(!e||s.responseType==="native"||s.responseType==="native-request-init")return!0;let n,r;if(i&&(i.error&&typeof i.error=="object"?n=i.error:i.status==="error"&&Array.isArray(i.messages)&&(n={...i},n[IO]=i,n.details=i.messages)),!n&&!e.ok)throw n=new Error(`Unable to load ${e.url} status: ${e.status}`),n[IO]=i,n;let o,a=null;n&&(r=Number(n.code),a=n.hasOwnProperty("subcode")?Number(n.subcode):null,o=n.messageCode,o=o==null?void 0:o.toUpperCase());const l=s.authMode;if(r===403&&(a===4||(u=n.message)!=null&&u.toLowerCase().includes("ssl")&&!n.message.toLowerCase().includes("permission"))){if(!t.useSSL)return t.useSSL=!0,!1}else if(!t.hasToken&&t.useIdentity&&(l!=="no-prompt"||r===498)&&r!==void 0&&yTe.has(r)&&!gce(t.params.url)&&(r!==403||(!o||!vTe.has(o))&&(a==null||a===2&&t.credentialToken))){await Pz();try{const c=await Yi.getCredential(t.params.url,{error:dd("request:server",n,t.params),prompt:l!=="no-prompt",signal:t.controller.signal,token:t.credentialToken});return t.credential=c,t.credentialToken=c.token,t.useSSL=t.useSSL||c.ssl,!1}catch(c){if(l==="no-prompt")return t.credential=void 0,t.credentialToken=void 0,!1;n=c}}if(n)throw n;return!0}function FK(t,e,i=!1){const s=e.controller.signal,n=new Image;return e.withCredentials?n.crossOrigin="use-credentials":n.crossOrigin="anonymous",n.alt="",n.fetchPriority=Bc.priority,n.src=t,mTe(n,t,i,s)}function ATe(t){let e,i;return typeof t=="string"?(e=lc(t,!0),i=MO(t)):(e=t.origin,i=MO(t.toString())),e==null?null:{origin:e,isHosted:i}}function $r(t){if(!Ks.assetsPath)throw ht.getLogger("esri.assets").errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new Se("assets:path-not-set","config.assetsPath is not set");return Kw(Ks.assetsPath,t)}let iU,ye=null;function PF(){return!!ye}function ITe(){return!!ke("esri-wasm")}function AH(){return iU||(iU=_e(()=>import("./pe-wasm-Co3DzcyP.js"),__vite__mapDeps([2,3])).then(t=>t.p).then(({default:t})=>t({locateFile:e=>$r(`esri/geometry/support/${e}`)})).then(t=>{vce(t)}),iU)}var Az,Jn;(function(t){function e(r,o,a){ye.ensureCache.prepare();const l=Sv(a),u=a===l,c=ye.ensureFloat64(l),h=ye._pe_geog_to_proj(ye.getPointer(r),o,c);return h&&V_(a,o,c,u),h}function i(r,o,a,l){switch(l){case Jn.PE_TRANSFORM_P_TO_G:return s(r,o,a);case Jn.PE_TRANSFORM_G_TO_P:return e(r,o,a)}return 0}function s(r,o,a){return n(r,o,a,0)}function n(r,o,a,l){ye.ensureCache.prepare();const u=Sv(a),c=a===u,h=ye.ensureFloat64(u),d=ye._pe_proj_to_geog_center(ye.getPointer(r),o,h,l);return d&&V_(a,o,h,c),d}t.geogToProj=e,t.projGeog=i,t.projToGeog=s,t.projToGeogCenter=n})(Az||(Az={})),function(t){function e(){t.PE_BUFFER_MAX=ye.PeDefs.prototype.PE_BUFFER_MAX,t.PE_NAME_MAX=ye.PeDefs.prototype.PE_NAME_MAX,t.PE_MGRS_MAX=ye.PeDefs.prototype.PE_MGRS_MAX,t.PE_USNG_MAX=ye.PeDefs.prototype.PE_USNG_MAX,t.PE_DD_MAX=ye.PeDefs.prototype.PE_DD_MAX,t.PE_DDM_MAX=ye.PeDefs.prototype.PE_DDM_MAX,t.PE_DMS_MAX=ye.PeDefs.prototype.PE_DMS_MAX,t.PE_UTM_MAX=ye.PeDefs.prototype.PE_UTM_MAX,t.PE_PARM_MAX=ye.PeDefs.prototype.PE_PARM_MAX,t.PE_TYPE_NONE=ye.PeDefs.prototype.PE_TYPE_NONE,t.PE_TYPE_GEOGCS=ye.PeDefs.prototype.PE_TYPE_GEOGCS,t.PE_TYPE_PROJCS=ye.PeDefs.prototype.PE_TYPE_PROJCS,t.PE_TYPE_GEOGTRAN=ye.PeDefs.prototype.PE_TYPE_GEOGTRAN,t.PE_TYPE_COORDSYS=ye.PeDefs.prototype.PE_TYPE_COORDSYS,t.PE_TYPE_UNIT=ye.PeDefs.prototype.PE_TYPE_UNIT,t.PE_TYPE_LINUNIT=ye.PeDefs.prototype.PE_TYPE_LINUNIT,t.PE_STR_OPTS_NONE=ye.PeDefs.prototype.PE_STR_OPTS_NONE,t.PE_STR_AUTH_NONE=ye.PeDefs.prototype.PE_STR_AUTH_NONE,t.PE_STR_AUTH_TOP=ye.PeDefs.prototype.PE_STR_AUTH_TOP,t.PE_STR_NAME_CANON=ye.PeDefs.prototype.PE_STR_NAME_CANON,t.PE_STR_FMT_WKT=ye.PeDefs.prototype.PE_STR_FMT_WKT,t.PE_STR_FMT_WKT2=ye.PeDefs.prototype.PE_STR_FMT_WKT2,t.PE_PARM_X0=ye.PeDefs.prototype.PE_PARM_X0,t.PE_PARM_ND=ye.PeDefs.prototype.PE_PARM_ND,t.PE_TRANSFORM_1_TO_2=ye.PeDefs.prototype.PE_TRANSFORM_1_TO_2,t.PE_TRANSFORM_2_TO_1=ye.PeDefs.prototype.PE_TRANSFORM_2_TO_1,t.PE_TRANSFORM_P_TO_G=ye.PeDefs.prototype.PE_TRANSFORM_P_TO_G,t.PE_TRANSFORM_G_TO_P=ye.PeDefs.prototype.PE_TRANSFORM_G_TO_P,t.PE_HORIZON_RECT=ye.PeDefs.prototype.PE_HORIZON_RECT,t.PE_HORIZON_POLY=ye.PeDefs.prototype.PE_HORIZON_POLY,t.PE_HORIZON_LINE=ye.PeDefs.prototype.PE_HORIZON_LINE,t.PE_HORIZON_DELTA=ye.PeDefs.prototype.PE_HORIZON_DELTA}t.init=e}(Jn||(Jn={}));let _ce=null;var Iz;(function(t){const e={},i={},s=m=>{const f=m.getType();switch(f){case Jn.PE_TYPE_GEOGCS:m=ye.castObject(m,ye.PeGeogcs);break;case Jn.PE_TYPE_PROJCS:m=ye.castObject(m,ye.PeProjcs);break;case Jn.PE_TYPE_GEOGTRAN:m=ye.castObject(m,ye.PeGeogtran);break;default:f&Jn.PE_TYPE_UNIT&&(m=ye.castObject(m,ye.PeUnit))}return m};function n(){ye.PeFactory.prototype.initialize(null)}function r(m){return o(Jn.PE_TYPE_COORDSYS,m)}function o(m,f){let _=null,v=e[m];if(v||(v={},e[m]=v),v.hasOwnProperty(String(f))&&(_=v[f],ye.compare(_,ye.NULL)&&(_=null)),!_){const x=ye.PeFactory.prototype.factoryByType(m,f);ye.compare(x,ye.NULL)||(_=s(x),v[f]=_)}return _}function a(m,f){let _=null,v=i[m];if(v||(v={},i[m]=v),v.hasOwnProperty(f)&&(_=v[f],ye.compare(_,ye.NULL)&&(_=null)),!_){const x=ye.PeFactory.prototype.fromString(m,f);ye.compare(x,ye.NULL)||(_=s(x),v[f]=_)}return _}function l(m){return o(Jn.PE_TYPE_GEOGCS,m)}function u(m){return o(Jn.PE_TYPE_GEOGTRAN,m)}function c(m){return ye.PeFactory.prototype.getCode(m)}function h(m){return o(Jn.PE_TYPE_PROJCS,m)}function d(m){return o(Jn.PE_TYPE_UNIT,m)}t.initialize=n,t.coordsys=r,t.factoryByType=o,t.fromString=a,t.geogcs=l,t.geogtran=u,t.getCode=c,t.projcs=h,t.unit=d})(Iz||(Iz={}));let yce=null;var DO,Dz,Nz,Rz,Oz,Lz,NO,Fz,RO,OO,kz;function vce(t){function e(r,o,a){r[o]=a(r[o])}ye=t,Jn.init(),DO.init(),NO.init(),RO.init(),OO.init(),_ce=class extends ye.PeDouble{constructor(r=NaN){super(r)}destroy(){ye.destroy(this)}[Symbol.dispose](){this.destroy()}},yce=class extends ye.PeGCSExtent{destroy(){ye.destroy(this)}[Symbol.dispose](){this.destroy()}};const i=[ye.PeAngunit,ye.PeDatum,ye.PeGeogcs,ye.PeGeogtran,ye.PeObject,ye.PeParameter,ye.PePrimem,ye.PeProjcs,ye.PeSpheroid,ye.PeUnit];for(const r of i)e(r.prototype,"getName",o=>function(){return o.call(this,new Array(Jn.PE_NAME_MAX))});for(const r of[ye.PeGeogtran,ye.PeProjcs])e(r.prototype,"getParameters",o=>function(){const a=new Array(Jn.PE_PARM_MAX);let l=o.call(this);for(let u=0;u<a.length;u++){const c=ye.getValue(l,"*");a[u]=c?ye.wrapPointer(c,ye.PeParameter):null,l+=Int32Array.BYTES_PER_ELEMENT}return a});e(ye.PeHorizon.prototype,"getCoord",r=>function(o=!1){const a=this.getSize();if(!a)return null;const l=[];return V_(l,a,r.call(this),o),l}),e(ye.PeGTlistExtendedEntry.prototype,"getEntries",r=>{const o=ye._pe_getPeGTlistExtendedGTsSize();return function(){let a=null;const l=r.call(this);if(!ye.compare(l,ye.NULL)){a=[l];const u=this.getSteps();if(u>1){const c=ye.getPointer(l);for(let h=1;h<u;h++)a.push(ye.wrapPointer(c+o*h,ye.PeGTlistExtendedGTs))}}return a}});const s=ye._pe_getPeHorizonSize(),n=r=>function(){let o=this._cache;if(o||(o=new Map,this._cache=o),o.has(r))return o.get(r);let a=null;const l=r.call(this);if(!ye.compare(l,ye.NULL)){a=[l];const u=l.getNump();if(u>1){const c=ye.getPointer(l);for(let h=1;h<u;h++)a.push(ye.wrapPointer(c+s*h,ye.PeHorizon))}}return o.set(r,a),a};e(ye.PeProjcs.prototype,"horizonGcsGenerate",n),e(ye.PeProjcs.prototype,"horizonPcsGenerate",n),ye.PeObject.prototype.toString=function(r=Jn.PE_STR_OPTS_NONE){ye.ensureCache.prepare();const o=ye.getPointer(this),a=ye.ensureInt8(new Array(Jn.PE_BUFFER_MAX));return ye.UTF8ToString(ye._pe_object_to_string_ext(o,r,a))},ye.PeGeogcs.prototype.destroy=function(){this.Delete(),Zh(this),this.ptr=0},ye.PeGeogcs.prototype[Symbol.dispose]=function(){this.destroy()},ye.PeProjcs.prototype.destroy=function(){this.Delete(),Zh(this),this.ptr=0},ye.PeProjcs.prototype[Symbol.dispose]=function(){this.destroy()}}function Zh(t){if(!t)return;const e=ye.getClass(t);if(!e)return;const i=ye.getCache(e);if(!i)return;const s=ye.getPointer(t);s&&delete i[s]}function pD(t,e){const i=[],s=new Array(e);for(let n=0;n<t;n++)i.push(ye.ensureInt8(s));return i}function Sv(t){return ArrayBuffer.isView(t)?t:Array.isArray(t[0])?t.flat():t}function V_(t,e,i,s=!1){if(s)for(let n=0;n<2*e;n++)t[n]=ye.getValue(i+n*Float64Array.BYTES_PER_ELEMENT,"double");else{const n=t.length===0;for(let r=0;r<e;r++)n&&(t[r]=new Array(2)),t[r][0]=ye.getValue(i,"double"),t[r][1]=ye.getValue(i+Float64Array.BYTES_PER_ELEMENT,"double"),i+=2*Float64Array.BYTES_PER_ELEMENT}}(function(t){let e;function i(){t.PE_GTLIST_OPTS_COMMON=ye.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,e=ye._pe_getPeGTlistExtendedEntrySize()}function s(n,r,o,a,l,u){let c=null;const h=new ye.PeInteger(u);try{const d=ye.PeGTlistExtended.prototype.getGTlist(n,r,o,a,l,h);if((u=h.val)&&(c=[d],u>1)){const m=ye.getPointer(d);for(let f=1;f<u;f++)c.push(ye.wrapPointer(m+e*f,ye.PeGTlistExtendedEntry))}}finally{ye.destroy(h)}return c}t.init=i,t.getGTlist=s})(DO||(DO={})),function(t){function e(i){if(i!=null&&i.length){for(const s of i)Zh(s),s.getEntries().forEach(n=>{Zh(n);const r=n.getGeogtran();Zh(r),r.getParameters().forEach(Zh),[r.getGeogcs1(),r.getGeogcs2()].forEach(o=>{Zh(o);const a=o.getDatum();Zh(a),Zh(a.getSpheroid()),Zh(o.getPrimem()),Zh(o.getUnit())})});ye.PeGTlistExtendedEntry.prototype.Delete(i[0])}}t.destroy=e}(Dz||(Dz={})),function(t){function e(i,s,n,r,o){ye.ensureCache.prepare();const a=Sv(n),l=n===a,u=ye.ensureFloat64(a);let c=0;r&&(c=ye.ensureFloat64(r));const h=ye._pe_geog_to_geog(ye.getPointer(i),s,u,c,o);return h&&V_(n,s,u,l),h}t.geogToGeog=e}(Nz||(Nz={})),function(t){function e(r,o,a,l,u,c,h,d){ye.PeLineType.prototype.geodesic_coordinate(r,o,a,l,u,c,h,d)}function i(r,o,a,l,u,c,h,d,m){ye.PeLineType.prototype.geodetic_coordinate(r,o,a,l,u,c,h,d,m)}function s(r,o,a,l,u,c,h,d,m,f){ye.PeLineType.prototype.geodetic_distance(r,o,a,l,u,c,h,d,m,f)}function n(r,o,a,l,u,c,h,d,m){ye.PeLineType.prototype.great_elliptic_distance(r,o,a,l,u,c,h,d,m)}t.geodesicCoordinate=e,t.geodeticCoordinate=i,t.geodeticDistance=s,t.greatEllipticDistance=n}(Rz||(Rz={})),function(t){function e(o,a){return ye.PeMath.prototype.phi_to_eta(o,a)}function i(o,a){return ye.PeMath.prototype.eta_to_phi(o,a)}function s(o,a){return ye.PeMath.prototype.phi_to_phig(o,a)}function n(o,a,l){return ye.PeMath.prototype.q(o,a,l)}function r(o,a){return ye.PeMath.prototype.q90(o,a)}t.phiToEta=e,t.etaToPhi=i,t.phiToPhig=s,t.q=n,t.q90=r}(Oz||(Oz={})),function(t){const e=(u,c,h,d,m,f)=>{let _,v;switch(ye.ensureCache.prepare(),u){case"dd":_=ye._pe_geog_to_dd,v=Jn.PE_DD_MAX;break;case"ddm":_=ye._pe_geog_to_ddm,v=Jn.PE_DDM_MAX;break;case"dms":_=ye._pe_geog_to_dms,v=Jn.PE_DMS_MAX}let x=0;c&&(x=ye.getPointer(c));const w=Sv(d),T=ye.ensureFloat64(w),C=pD(h,v),M=_(x,h,T,m,ye.ensureInt32(C));if(M)for(let A=0;A<h;A++)f[A]=ye.UTF8ToString(C[A]);return M},i=(u,c,h,d,m)=>{let f;switch(ye.ensureCache.prepare(),u){case"dd":f=ye._pe_dd_to_geog;break;case"ddm":f=ye._pe_ddm_to_geog;break;case"dms":f=ye._pe_dms_to_geog}let _=0;c&&(_=ye.getPointer(c));const v=d.map(C=>ye.ensureString(C)),x=ye.ensureInt32(v),w=ye.ensureFloat64(new Array(2*h)),T=f(_,h,x,w);return T&&V_(m,h,w),T};function s(u,c,h,d,m){return e("dms",u,c,h,d,m)}function n(u,c,h,d){return i("dms",u,c,h,d)}function r(u,c,h,d,m){return e("ddm",u,c,h,d,m)}function o(u,c,h,d){return i("ddm",u,c,h,d)}function a(u,c,h,d,m){return e("dd",u,c,h,d,m)}function l(u,c,h,d){return i("dd",u,c,h,d)}t.geogToDms=s,t.dmsToGeog=n,t.geogToDdm=r,t.ddmToGeog=o,t.geogToDd=a,t.ddToGeog=l}(Lz||(Lz={})),function(t){function e(){t.PE_MGRS_STYLE_NEW=ye.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,t.PE_MGRS_STYLE_OLD=ye.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,t.PE_MGRS_STYLE_AUTO=ye.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,t.PE_MGRS_180_ZONE_1_PLUS=ye.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,t.PE_MGRS_ADD_SPACES=ye.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES}function i(n,r,o,a,l,u,c){ye.ensureCache.prepare();let h=0;n&&(h=ye.getPointer(n));const d=Sv(o),m=ye.ensureFloat64(d),f=pD(r,Jn.PE_MGRS_MAX),_=ye.ensureInt32(f),v=ye._pe_geog_to_mgrs_extended(h,r,m,a,l,u,_);if(v)for(let x=0;x<r;x++)c[x]=ye.UTF8ToString(f[x]);return v}function s(n,r,o,a,l){ye.ensureCache.prepare();let u=0;n&&(u=ye.getPointer(n));const c=o.map(f=>ye.ensureString(f)),h=ye.ensureInt32(c),d=ye.ensureFloat64(new Array(2*r)),m=ye._pe_mgrs_to_geog_extended(u,r,h,a,d);return m&&V_(l,r,d),m}t.init=e,t.geogToMgrsExtended=i,t.mgrsToGeogExtended=s}(NO||(NO={})),function(t){function e(s,n,r,o,a,l,u){ye.ensureCache.prepare();let c=0;s&&(c=ye.getPointer(s));const h=Sv(r),d=ye.ensureFloat64(h),m=pD(n,Jn.PE_MGRS_MAX),f=ye.ensureInt32(m),_=ye._pe_geog_to_usng(c,n,d,o,a,l,f);if(_)for(let v=0;v<n;v++)u[v]=ye.UTF8ToString(m[v]);return _}function i(s,n,r,o){ye.ensureCache.prepare();let a=0;s&&(a=ye.getPointer(s));const l=r.map(d=>ye.ensureString(d)),u=ye.ensureInt32(l),c=ye.ensureFloat64(new Array(2*n)),h=ye._pe_usng_to_geog(a,n,u,c);return h&&V_(o,n,c),h}t.geogToUsng=e,t.usngToGeog=i}(Fz||(Fz={})),function(t){function e(){t.PE_UTM_OPTS_NONE=ye.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,t.PE_UTM_OPTS_ADD_SPACES=ye.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,t.PE_UTM_OPTS_NS=ye.PeNotationUtm.prototype.PE_UTM_OPTS_NS}function i(n,r,o,a,l){ye.ensureCache.prepare();let u=0;n&&(u=ye.getPointer(n));const c=Sv(o),h=ye.ensureFloat64(c),d=pD(r,Jn.PE_UTM_MAX),m=ye.ensureInt32(d),f=ye._pe_geog_to_utm(u,r,h,a,m);if(f)for(let _=0;_<r;_++)l[_]=ye.UTF8ToString(d[_]);return f}function s(n,r,o,a,l){ye.ensureCache.prepare();let u=0;n&&(u=ye.getPointer(n));const c=o.map(f=>ye.ensureString(f)),h=ye.ensureInt32(c),d=ye.ensureFloat64(new Array(2*r)),m=ye._pe_utm_to_geog(u,r,h,a,d);return m&&V_(l,r,d),m}t.init=e,t.geogToUtm=i,t.utmToGeog=s}(RO||(RO={})),function(t){const e=new Map;function i(){t.PE_PCSINFO_OPTION_NONE=ye.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,t.PE_PCSINFO_OPTION_DOMAIN=ye.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,t.PE_POLE_OUTSIDE_BOUNDARY=ye.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,t.PE_POLE_POINT=ye.PePCSInfo.prototype.PE_POLE_POINT}function s(n,r=t.PE_PCSINFO_OPTION_DOMAIN){let o=null,a=null;return e.has(n)&&(a=e.get(n),a[r]&&(o=a[r])),o||(o=ye.PePCSInfo.prototype.generate(n,r),a||(a=[],e.set(n,a)),a[r]=o),o}t.init=i,t.generate=s}(OO||(OO={})),function(t){function e(){return ye.PeVersion.prototype.version_string()}t.versionString=e}(kz||(kz={}));const xce=Object.freeze(Object.defineProperty({__proto__:null,get PeCSTransformations(){return Az},get PeDefs(){return Jn},get PeDouble(){return _ce},get PeFactory(){return Iz},get PeGCSExtent(){return yce},get PeGTTransformations(){return Nz},get PeGTlistExtended(){return DO},get PeGTlistExtendedEntry(){return Dz},get PeLineType(){return Rz},get PeMath(){return Oz},get PeNotationDms(){return Lz},get PeNotationMgrs(){return NO},get PeNotationUsng(){return Fz},get PeNotationUtm(){return RO},get PePCSInfo(){return OO},get PeVersion(){return kz},_init:vce,get _pe(){return ye},isLoaded:PF,isSupported:ITe,load:AH},Symbol.toStringTag,{value:"Module"}));var a1;(function(t){t[t.CGCS2000=4490]="CGCS2000",t[t.GCSMARS2000=104971]="GCSMARS2000",t[t.GCSMARS2000_SPHERE=104905]="GCSMARS2000_SPHERE",t[t.GCSMOON2000=104903]="GCSMOON2000"})(a1||(a1={}));let E;const K={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.1168,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:14,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5041:0,5042:0,5048:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,9709:0,9712:0,9713:0,9716:0,9741:0,9748:2,9749:2,9761:0,9766:0,9793:0,9794:0,9869:0,9874:0,9875:0,9880:0,9895:0,9943:0,9945:0,9947:0,9967:0,9972:0,9977:0,10160:0,10183:0,10188:0,10194:0,10199:0,10207:0,10212:0,10217:0,10222:0,10227:0,10235:0,10240:0,10250:0,10254:0,10270:0,10275:0,10280:0,10306:0,10329:0,10471:0,10477:0,10481:2,10516:2,10592:0,10594:0,10596:0,10598:0,10601:0,10603:0,10626:0,10632:0,10665:0,20002:0,20042:0,20050:1,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22239:0,22240:0,22332:0,22337:0,22338:0,22391:0,22392:0,22639:0,22700:0,22739:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,54090:0,54091:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:15,102069:16,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102731:0,102732:0,102759:1,102760:1,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2,103897:1,103978:2,103979:0,103980:2,103981:0};for(E=2e3;E<=2045;E++)K[E]=0;for(E=2056;E<=2065;E++)K[E]=0;for(E=2067;E<=2135;E++)K[E]=0;for(E=2137;E<=2154;E++)K[E]=0;for(E=2161;E<=2170;E++)K[E]=0;for(E=2172;E<=2193;E++)K[E]=0;for(E=2195;E<=2198;E++)K[E]=0;for(E=2200;E<=2203;E++)K[E]=0;for(E=2205;E<=2217;E++)K[E]=0;for(E=2222;E<=2224;E++)K[E]=1;for(E=2225;E<=2250;E++)K[E]=2;for(E=2251;E<=2253;E++)K[E]=1;for(E=2257;E<=2264;E++)K[E]=2;for(E=2274;E<=2279;E++)K[E]=2;for(E=2280;E<=2282;E++)K[E]=1;for(E=2283;E<=2289;E++)K[E]=2;for(E=2290;E<=2292;E++)K[E]=0;for(E=2308;E<=2313;E++)K[E]=0;for(E=2315;E<=2491;E++)K[E]=0;for(E=2494;E<=2866;E++)K[E]=0;for(E=2867;E<=2869;E++)K[E]=1;for(E=2870;E<=2888;E++)K[E]=2;for(E=2891;E<=2895;E++)K[E]=2;for(E=2896;E<=2898;E++)K[E]=1;for(E=2902;E<=2908;E++)K[E]=2;for(E=2915;E<=2920;E++)K[E]=2;for(E=2921;E<=2923;E++)K[E]=1;for(E=2924;E<=2930;E++)K[E]=2;for(E=2931;E<=2962;E++)K[E]=0;for(E=2964;E<=2968;E++)K[E]=2;for(E=2969;E<=2973;E++)K[E]=0;for(E=2975;E<=2991;E++)K[E]=0;for(E=2995;E<=3051;E++)K[E]=0;for(E=3054;E<=3079;E++)K[E]=0;for(E=3081;E<=3088;E++)K[E]=0;for(E=3092;E<=3101;E++)K[E]=0;for(E=3106;E<=3138;E++)K[E]=0;for(E=3146;E<=3151;E++)K[E]=0;for(E=3153;E<=3166;E++)K[E]=0;for(E=3168;E<=3172;E++)K[E]=0;for(E=3174;E<=3203;E++)K[E]=0;for(E=3294;E<=3358;E++)K[E]=0;for(E=3367;E<=3403;E++)K[E]=0;for(E=3408;E<=3416;E++)K[E]=0;for(E=3417;E<=3438;E++)K[E]=2;for(E=3441;E<=3446;E++)K[E]=2;for(E=3447;E<=3450;E++)K[E]=0;for(E=3451;E<=3459;E++)K[E]=2;for(E=3460;E<=3478;E++)K[E]=0;for(E=3554;E<=3559;E++)K[E]=0;for(E=3560;E<=3570;E++)K[E]=2;for(E=3571;E<=3581;E++)K[E]=0;for(E=3594;E<=3597;E++)K[E]=0;for(E=3601;E<=3604;E++)K[E]=0;for(E=3637;E<=3639;E++)K[E]=0;for(E=3665;E<=3667;E++)K[E]=0;for(E=3693;E<=3695;E++)K[E]=0;for(E=3701;E<=3727;E++)K[E]=0;for(E=3728;E<=3739;E++)K[E]=2;for(E=3740;E<=3751;E++)K[E]=0;for(E=3753;E<=3760;E++)K[E]=2;for(E=3761;E<=3773;E++)K[E]=0;for(E=3775;E<=3777;E++)K[E]=0;for(E=3779;E<=3781;E++)K[E]=0;for(E=3783;E<=3785;E++)K[E]=0;for(E=3788;E<=3791;E++)K[E]=0;for(E=3797;E<=3802;E++)K[E]=0;for(E=3814;E<=3816;E++)K[E]=0;for(E=3825;E<=3829;E++)K[E]=0;for(E=3832;E<=3841;E++)K[E]=0;for(E=3844;E<=3852;E++)K[E]=0;for(E=3873;E<=3885;E++)K[E]=0;for(E=3890;E<=3893;E++)K[E]=0;for(E=3907;E<=3912;E++)K[E]=0;for(E=3942;E<=3950;E++)K[E]=0;for(E=3968;E<=3970;E++)K[E]=0;for(E=3973;E<=3976;E++)K[E]=0;for(E=3986;E<=3989;E++)K[E]=0;for(E=3994;E<=3997;E++)K[E]=0;for(E=4048;E<=4051;E++)K[E]=0;for(E=4056;E<=4063;E++)K[E]=0;for(E=4093;E<=4096;E++)K[E]=0;for(E=4390;E<=4398;E++)K[E]=0;for(E=4399;E<=4413;E++)K[E]=2;for(E=4418;E<=4433;E++)K[E]=2;for(E=4455;E<=4457;E++)K[E]=2;for(E=4484;E<=4489;E++)K[E]=0;for(E=4491;E<=4554;E++)K[E]=0;for(E=4568;E<=4589;E++)K[E]=0;for(E=4652;E<=4656;E++)K[E]=0;for(E=4766;E<=4800;E++)K[E]=0;for(E=5014;E<=5016;E++)K[E]=0;for(E=5069;E<=5072;E++)K[E]=0;for(E=5105;E<=5130;E++)K[E]=0;for(E=5167;E<=5188;E++)K[E]=0;for(E=5253;E<=5259;E++)K[E]=0;for(E=5269;E<=5275;E++)K[E]=0;for(E=5292;E<=5311;E++)K[E]=0;for(E=5329;E<=5331;E++)K[E]=0;for(E=5343;E<=5349;E++)K[E]=0;for(E=5355;E<=5357;E++)K[E]=0;for(E=5387;E<=5389;E++)K[E]=0;for(E=5459;E<=5463;E++)K[E]=0;for(E=5479;E<=5482;E++)K[E]=0;for(E=5518;E<=5520;E++)K[E]=0;for(E=5530;E<=5539;E++)K[E]=0;for(E=5550;E<=5552;E++)K[E]=0;for(E=5562;E<=5583;E++)K[E]=0;for(E=5623;E<=5625;E++)K[E]=2;for(E=5631;E<=5639;E++)K[E]=0;for(E=5649;E<=5653;E++)K[E]=0;for(E=5663;E<=5680;E++)K[E]=0;for(E=5682;E<=5685;E++)K[E]=0;for(E=5875;E<=5877;E++)K[E]=0;for(E=5896;E<=5899;E++)K[E]=0;for(E=5921;E<=5940;E++)K[E]=0;for(E=6050;E<=6125;E++)K[E]=0;for(E=6244;E<=6275;E++)K[E]=0;for(E=6328;E<=6348;E++)K[E]=0;for(E=6350;E<=6356;E++)K[E]=0;for(E=6366;E<=6372;E++)K[E]=0;for(E=6381;E<=6387;E++)K[E]=0;for(E=6393;E<=6404;E++)K[E]=0;for(E=6480;E<=6483;E++)K[E]=0;for(E=6511;E<=6514;E++)K[E]=0;for(E=6579;E<=6581;E++)K[E]=0;for(E=6619;E<=6624;E++)K[E]=0;for(E=6625;E<=6627;E++)K[E]=2;for(E=6628;E<=6632;E++)K[E]=0;for(E=6634;E<=6637;E++)K[E]=0;for(E=6669;E<=6692;E++)K[E]=0;for(E=6707;E<=6709;E++)K[E]=0;for(E=6720;E<=6723;E++)K[E]=0;for(E=6732;E<=6738;E++)K[E]=0;for(E=6931;E<=6933;E++)K[E]=0;for(E=6956;E<=6959;E++)K[E]=0;for(E=7005;E<=7007;E++)K[E]=0;for(E=7057;E<=7070;E++)K[E]=2;for(E=7074;E<=7082;E++)K[E]=0;for(E=7109;E<=7118;E++)K[E]=0;for(E=7119;E<=7127;E++)K[E]=1;for(E=7374;E<=7376;E++)K[E]=0;for(E=7528;E<=7586;E++)K[E]=0;for(E=7587;E<=7645;E++)K[E]=2;for(E=7692;E<=7696;E++)K[E]=0;for(E=7755;E<=7787;E++)K[E]=0;for(E=7791;E<=7795;E++)K[E]=0;for(E=7799;E<=7801;E++)K[E]=0;for(E=7803;E<=7805;E++)K[E]=0;for(E=7825;E<=7831;E++)K[E]=0;for(E=7845;E<=7859;E++)K[E]=0;for(E=8013;E<=8032;E++)K[E]=0;for(E=8065;E<=8068;E++)K[E]=1;for(E=8518;E<=8529;E++)K[E]=2;for(E=8533;E<=8536;E++)K[E]=2;for(E=8538;E<=8540;E++)K[E]=2;for(E=8677;E<=8679;E++)K[E]=0;for(E=8836;E<=8840;E++)K[E]=0;for(E=8857;E<=8859;E++)K[E]=0;for(E=8908;E<=8910;E++)K[E]=0;for(E=9154;E<=9159;E++)K[E]=0;for(E=9205;E<=9218;E++)K[E]=0;for(E=9271;E<=9273;E++)K[E]=0;for(E=9295;E<=9297;E++)K[E]=0;for(E=9356;E<=9360;E++)K[E]=0;for(E=9404;E<=9407;E++)K[E]=0;for(E=9476;E<=9482;E++)K[E]=0;for(E=9487;E<=9494;E++)K[E]=0;for(E=9697;E<=9699;E++)K[E]=0;for(E=9821;E<=9865;E++)K[E]=0;for(E=10285;E<=10291;E++)K[E]=0;for(E=10314;E<=10317;E++)K[E]=0;for(E=10448;E<=10465;E++)K[E]=0;for(E=10731;E<=10733;E++)K[E]=0;for(E=11114;E<=11118;E++)K[E]=0;for(E=20004;E<=20032;E++)K[E]=0;for(E=20047;E<=20049;E++)K[E]=0;for(E=20062;E<=20092;E++)K[E]=0;for(E=20135;E<=20138;E++)K[E]=0;for(E=20248;E<=20258;E++)K[E]=0;for(E=20348;E<=20358;E++)K[E]=0;for(E=20436;E<=20440;E++)K[E]=0;for(E=20822;E<=20824;E++)K[E]=0;for(E=20904;E<=20932;E++)K[E]=0;for(E=20934;E<=20936;E++)K[E]=0;for(E=21004;E<=21032;E++)K[E]=0;for(E=21035;E<=21037;E++)K[E]=0;for(E=21095;E<=21097;E++)K[E]=0;for(E=21148;E<=21150;E++)K[E]=0;for(E=21207;E<=21264;E++)K[E]=0;for(E=21307;E<=21364;E++)K[E]=0;for(E=21413;E<=21423;E++)K[E]=0;for(E=21453;E<=21463;E++)K[E]=0;for(E=21473;E<=21483;E++)K[E]=0;for(E=21780;E<=21782;E++)K[E]=0;for(E=21891;E<=21894;E++)K[E]=0;for(E=21896;E<=21899;E++)K[E]=0;for(E=22171;E<=22177;E++)K[E]=0;for(E=22181;E<=22187;E++)K[E]=0;for(E=22191;E<=22197;E++)K[E]=0;for(E=22207;E<=22222;E++)K[E]=0;for(E=22229;E<=22232;E++)K[E]=0;for(E=22234;E<=22236;E++)K[E]=0;for(E=22243;E<=22250;E++)K[E]=0;for(E=22262;E<=22265;E++)K[E]=0;for(E=22307;E<=22322;E++)K[E]=0;for(E=22348;E<=22357;E++)K[E]=0;for(E=22407;E<=22422;E++)K[E]=0;for(E=22462;E<=22465;E++)K[E]=0;for(E=22521;E<=22525;E++)K[E]=0;for(E=22607;E<=22622;E++)K[E]=0;for(E=22641;E<=22646;E++)K[E]=0;for(E=22648;E<=22657;E++)K[E]=0;for(E=22707;E<=22722;E++)K[E]=0;for(E=22762;E<=22765;E++)K[E]=0;for(E=22807;E<=22822;E++)K[E]=0;for(E=22991;E<=22994;E++)K[E]=0;for(E=23028;E<=23038;E++)K[E]=0;for(E=23301;E<=23333;E++)K[E]=2;for(E=23830;E<=23853;E++)K[E]=0;for(E=23866;E<=23872;E++)K[E]=0;for(E=23877;E<=23884;E++)K[E]=0;for(E=23886;E<=23894;E++)K[E]=0;for(E=23946;E<=23948;E++)K[E]=0;for(E=24311;E<=24313;E++)K[E]=0;for(E=24342;E<=24347;E++)K[E]=0;for(E=24370;E<=24374;E++)K[E]=10;for(E=24375;E<=24381;E++)K[E]=0;for(E=24718;E<=24721;E++)K[E]=0;for(E=24817;E<=24821;E++)K[E]=0;for(E=24877;E<=24882;E++)K[E]=0;for(E=24891;E<=24893;E++)K[E]=0;for(E=25391;E<=25395;E++)K[E]=0;for(E=25828;E<=25838;E++)K[E]=0;for(E=26191;E<=26195;E++)K[E]=0;for(E=26391;E<=26393;E++)K[E]=0;for(E=26701;E<=26722;E++)K[E]=0;for(E=26729;E<=26799;E++)K[E]=2;for(E=26801;E<=26803;E++)K[E]=2;for(E=26811;E<=26813;E++)K[E]=2;for(E=26847;E<=26870;E++)K[E]=2;for(E=26891;E<=26899;E++)K[E]=0;for(E=26901;E<=26923;E++)K[E]=0;for(E=26929;E<=26946;E++)K[E]=0;for(E=26948;E<=26998;E++)K[E]=0;for(E=27037;E<=27040;E++)K[E]=0;for(E=27205;E<=27232;E++)K[E]=0;for(E=27258;E<=27260;E++)K[E]=0;for(E=27391;E<=27398;E++)K[E]=0;for(E=27561;E<=27564;E++)K[E]=0;for(E=27571;E<=27574;E++)K[E]=0;for(E=27581;E<=27584;E++)K[E]=0;for(E=27591;E<=27594;E++)K[E]=0;for(E=27700;E<=27707;E++)K[E]=0;for(E=28191;E<=28193;E++)K[E]=0;for(E=28348;E<=28358;E++)K[E]=0;for(E=28402;E<=28432;E++)K[E]=0;for(E=28462;E<=28492;E++)K[E]=0;for(E=29118;E<=29122;E++)K[E]=0;for(E=29168;E<=29172;E++)K[E]=0;for(E=29177;E<=29185;E++)K[E]=0;for(E=29187;E<=29195;E++)K[E]=0;for(E=29900;E<=29903;E++)K[E]=0;for(E=30161;E<=30179;E++)K[E]=0;for(E=30491;E<=30494;E++)K[E]=0;for(E=30729;E<=30732;E++)K[E]=0;for(E=31251;E<=31259;E++)K[E]=0;for(E=31265;E<=31268;E++)K[E]=0;for(E=31275;E<=31279;E++)K[E]=0;for(E=31281;E<=31297;E++)K[E]=0;for(E=31461;E<=31469;E++)K[E]=0;for(E=31491;E<=31495;E++)K[E]=0;for(E=31917;E<=31922;E++)K[E]=0;for(E=31965;E<=32e3;E++)K[E]=0;for(E=32001;E<=32003;E++)K[E]=2;for(E=32005;E<=32031;E++)K[E]=2;for(E=32033;E<=32060;E++)K[E]=2;for(E=32064;E<=32067;E++)K[E]=2;for(E=32074;E<=32077;E++)K[E]=2;for(E=32081;E<=32086;E++)K[E]=0;for(E=32107;E<=32130;E++)K[E]=0;for(E=32133;E<=32159;E++)K[E]=0;for(E=32164;E<=32167;E++)K[E]=2;for(E=32180;E<=32199;E++)K[E]=0;for(E=32201;E<=32260;E++)K[E]=0;for(E=32301;E<=32360;E++)K[E]=0;for(E=32401;E<=32460;E++)K[E]=0;for(E=32501;E<=32560;E++)K[E]=0;for(E=32601;E<=32662;E++)K[E]=0;for(E=32664;E<=32667;E++)K[E]=2;for(E=32701;E<=32761;E++)K[E]=0;for(E=53001;E<=53004;E++)K[E]=0;for(E=53008;E<=53019;E++)K[E]=0;for(E=53021;E<=53032;E++)K[E]=0;for(E=53034;E<=53037;E++)K[E]=0;for(E=53042;E<=53046;E++)K[E]=0;for(E=53074;E<=53080;E++)K[E]=0;for(E=54001;E<=54004;E++)K[E]=0;for(E=54008;E<=54019;E++)K[E]=0;for(E=54021;E<=54032;E++)K[E]=0;for(E=54034;E<=54037;E++)K[E]=0;for(E=54042;E<=54046;E++)K[E]=0;for(E=54048;E<=54053;E++)K[E]=0;for(E=54074;E<=54080;E++)K[E]=0;for(E=54098;E<=54101;E++)K[E]=0;for(E=102001;E<=102040;E++)K[E]=0;for(E=102042;E<=102063;E++)K[E]=0;for(E=102065;E<=102067;E++)K[E]=0;for(E=102070;E<=102117;E++)K[E]=0;for(E=102122;E<=102216;E++)K[E]=0;for(E=102221;E<=102377;E++)K[E]=0;for(E=102382;E<=102388;E++)K[E]=0;for(E=102389;E<=102398;E++)K[E]=2;for(E=102399;E<=102444;E++)K[E]=0;for(E=102445;E<=102447;E++)K[E]=2;for(E=102448;E<=102458;E++)K[E]=0;for(E=102459;E<=102468;E++)K[E]=2;for(E=102469;E<=102499;E++)K[E]=0;for(E=102500;E<=102519;E++)K[E]=1;for(E=102520;E<=102524;E++)K[E]=0;for(E=102525;E<=102529;E++)K[E]=2;for(E=102530;E<=102588;E++)K[E]=0;for(E=102590;E<=102598;E++)K[E]=0;for(E=102601;E<=102603;E++)K[E]=0;for(E=102605;E<=102628;E++)K[E]=0;for(E=102629;E<=102646;E++)K[E]=2;for(E=102648;E<=102700;E++)K[E]=2;for(E=102701;E<=102703;E++)K[E]=0;for(E=102707;E<=102730;E++)K[E]=2;for(E=102733;E<=102758;E++)K[E]=2;for(E=102767;E<=102900;E++)K[E]=0;for(E=102901;E<=102933;E++)K[E]=2;for(E=102934;E<=102950;E++)K[E]=13;for(E=102951;E<=102963;E++)K[E]=0;for(E=102965;E<=102969;E++)K[E]=0;for(E=102971;E<=102973;E++)K[E]=0;for(E=102975;E<=102989;E++)K[E]=0;for(E=102990;E<=102992;E++)K[E]=1;for(E=102997;E<=103002;E++)K[E]=0;for(E=103003;E<=103008;E++)K[E]=2;for(E=103009;E<=103011;E++)K[E]=0;for(E=103012;E<=103014;E++)K[E]=2;for(E=103019;E<=103021;E++)K[E]=0;for(E=103022;E<=103024;E++)K[E]=2;for(E=103029;E<=103031;E++)K[E]=0;for(E=103032;E<=103034;E++)K[E]=2;for(E=103065;E<=103068;E++)K[E]=0;for(E=103074;E<=103076;E++)K[E]=0;for(E=103077;E<=103079;E++)K[E]=1;for(E=103080;E<=103082;E++)K[E]=0;for(E=103083;E<=103085;E++)K[E]=2;for(E=103090;E<=103093;E++)K[E]=0;for(E=103097;E<=103099;E++)K[E]=0;for(E=103100;E<=103102;E++)K[E]=2;for(E=103107;E<=103109;E++)K[E]=0;for(E=103110;E<=103112;E++)K[E]=2;for(E=103113;E<=103116;E++)K[E]=0;for(E=103117;E<=103120;E++)K[E]=2;for(E=103153;E<=103157;E++)K[E]=0;for(E=103158;E<=103162;E++)K[E]=2;for(E=103163;E<=103165;E++)K[E]=0;for(E=103166;E<=103168;E++)K[E]=1;for(E=103169;E<=103171;E++)K[E]=2;for(E=103186;E<=103188;E++)K[E]=0;for(E=103189;E<=103191;E++)K[E]=2;for(E=103192;E<=103195;E++)K[E]=0;for(E=103196;E<=103199;E++)K[E]=2;for(E=103200;E<=103224;E++)K[E]=0;for(E=103225;E<=103227;E++)K[E]=1;for(E=103232;E<=103237;E++)K[E]=0;for(E=103238;E<=103243;E++)K[E]=2;for(E=103244;E<=103246;E++)K[E]=0;for(E=103247;E<=103249;E++)K[E]=2;for(E=103254;E<=103256;E++)K[E]=0;for(E=103257;E<=103259;E++)K[E]=2;for(E=103264;E<=103266;E++)K[E]=0;for(E=103267;E<=103269;E++)K[E]=2;for(E=103300;E<=103375;E++)K[E]=0;for(E=103381;E<=103383;E++)K[E]=0;for(E=103384;E<=103386;E++)K[E]=1;for(E=103387;E<=103389;E++)K[E]=0;for(E=103390;E<=103392;E++)K[E]=2;for(E=103397;E<=103399;E++)K[E]=0;for(E=103400;E<=103471;E++)K[E]=2;for(E=103476;E<=103478;E++)K[E]=0;for(E=103479;E<=103481;E++)K[E]=2;for(E=103486;E<=103488;E++)K[E]=0;for(E=103489;E<=103491;E++)K[E]=2;for(E=103492;E<=103495;E++)K[E]=0;for(E=103496;E<=103499;E++)K[E]=2;for(E=103528;E<=103543;E++)K[E]=0;for(E=103544;E<=103548;E++)K[E]=2;for(E=103549;E<=103551;E++)K[E]=0;for(E=103552;E<=103554;E++)K[E]=1;for(E=103555;E<=103557;E++)K[E]=2;for(E=103558;E<=103560;E++)K[E]=0;for(E=103571;E<=103573;E++)K[E]=0;for(E=103574;E<=103576;E++)K[E]=2;for(E=103577;E<=103580;E++)K[E]=0;for(E=103581;E<=103583;E++)K[E]=2;for(E=103595;E<=103694;E++)K[E]=0;for(E=103696;E<=103699;E++)K[E]=0;for(E=103700;E<=103793;E++)K[E]=2;for(E=103794;E<=103890;E++)K[E]=0;for(E=103891;E<=103896;E++)K[E]=2;for(E=103900;E<=103971;E++)K[E]=2;for(E=103972;E<=103977;E++)K[E]=0;for(E=112e3;E<=112101;E++)K[E]=0;const bce=[102100,102113,3857,3785,900913],DTe=[104905,104971],NTe=[4326,...bce,...DTe],SP=[-20037508342788905e-9,20037508342788905e-9],$z=[-20037508342787e-6,20037508342787e-6],sU={wkTemplate:'PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',valid:SP,origin:$z,dx:1e-5},wce={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:SP,origin:$z,dx:1e-5},102100:sU,3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:SP,origin:$z,dx:1e-5},3857:sU,4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},900913:sU};function $o(t,e){if(t===e)return!0;if(t==null||e==null)return!1;const i=t.wkid,s=e.wkid;if(i!=null||s!=null){if(i===s||yd(t)&&yd(e))return!0;const o=t.latestWkid;if(o!=null&&s===o)return!0;const a=e.latestWkid;return a!=null&&i===a}let n,r;return t.wkt2&&e.wkt2?(n=t.wkt2,r=e.wkt2):t.wkt&&e.wkt&&(n=t.wkt,r=e.wkt),!(!n||!r)&&n.toUpperCase()===r.toUpperCase()}function Ol(t){const e=t==null?void 0:t.wkid;return e!=null&&e>=2e3&&wce[e]||null}function Sce(t){if(!t)return;const{wkid:e,vcsWkid:i}=t;if(e)return i?JSON.stringify({wkid:e,vcsWkid:i}):String(e);const s=t.wkt||t.wkt2;return JSON.stringify(s?i?{wkt:s,vcsWkid:i}:{wkt:s}:{})}function Rf(t){if(!rc(t))return!1;const{wkid:e}=t;if(e)return K[e]==null;const i=t.wkt2||t.wkt;return!!i&&/^\s*(?:GEOGCS|GEOGCRS|GEOGRAPHICCRS)/i.test(i)}function RTe(t){return!(Ece(t)||Cce(t))}function l1(t){return(t==null?void 0:t.wkid)===4326}function cft(t){return/^\s*(?:GEOD|GEODETIC|GEOG|GEOGRAPHIC|PROJ|PROJECTED|VERT|VERTICAL|ENG|ENGINEERING|PARAMETRIC|TIME|DERIVEDPROJ|COMPOUND|BOUND)CRS/i.test(t)}function kK(t){return(t==null?void 0:t.wkid)===a1.CGCS2000}function yd(t){const e=t==null?void 0:t.wkid;return e!=null&&e>=2e3&&bce.includes(e)}function OTe(t){return(t==null?void 0:t.wkid)===32662}function MF(t){return t===a1.GCSMARS2000||t===a1.GCSMARS2000_SPHERE}function Ece(t){return MF(t==null?void 0:t.wkid)}function AF(t){return t===a1.GCSMOON2000}function Cce(t){return AF(t==null?void 0:t.wkid)}function LTe(t){const e=t==null?void 0:t.wkid;return e!=null&&e>=2e3&&NTe.includes(e)}function rc(t){if(t==null)return!1;const e=t.wkid;return e!=null&&e>=2e3||t.wkt2!=null||t.wkt!=null}const Tce={wkid:4326,wkt:_F(wce[4326].wkTemplate,{Central_Meridian:"0.0"})},Pce={wkid:102100,latestWkid:3857},FTe={wkid:32662};function IH(t){return{wkt:`GEOCCS["Spherical geocentric",
    DATUM["Not specified",
      SPHEROID["Sphere",${t.radius},0]],
    PRIMEM["Greenwich",0.0,
      AUTHORITY["EPSG","8901"]],
    UNIT["m",1.0],
    AXIS["Geocentric X",OTHER],
    AXIS["Geocentric Y",EAST],
    AXIS["Geocentric Z",NORTH]
  ]`}}const kTe=IH(Pr),DH=IH(Pm),NH=IH(my),$Te={wkt:`GEOCCS["WGS 84",
  DATUM["WGS_1984",
    SPHEROID["WGS 84",${Pr.radius},298.257223563,
      AUTHORITY["EPSG","7030"]],
    AUTHORITY["EPSG","6326"]],
  PRIMEM["Greenwich",0,
    AUTHORITY["EPSG","8901"]],
  UNIT["m",1.0,
    AUTHORITY["EPSG","9001"]],
  AXIS["Geocentric X",OTHER],
  AXIS["Geocentric Y",OTHER],
  AXIS["Geocentric Z",NORTH],
  AUTHORITY["EPSG","4978"]
]`},UTe=DH.wkt.toUpperCase(),VTe=NH.wkt.toUpperCase();function Mce(t){if(t!=null&&rc(t)){const e=t.wkid,i=t.wkt2??t.wkt;if(MF(e))return Pm;const s=i==null?void 0:i.toUpperCase();if(i&&s===UTe)return Pm;if(AF(e)||s&&s===VTe)return my}return Pr}function hft(t){return MF(t)?Pm:AF(t)?my:Pr}function LO(t){return $o(t,kTe)}function py(t){return LO(t)||$o(t,DH)||$o(t,NH)}const Ace=39.37,zTe=Pr.radius*Math.PI/200,Ice=/(?:LENGTH)?UNIT\[([^\]]+)]]$/i,eS=K,Dce=/UNIT\[([^\]]+)]/i,Nce=new Set([4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104025,104026,104139,104140]),GTe=ca()({millimeter:"millimeters",centimeter:"centimeters",meter:"meters",meter_german:"german-meters",kilometer:"kilometers",decimeter:"decimeters",micrometer:"micrometers",nanometer:"nanometers","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",fathom:"fathoms",nautical_mile:"nautical-miles",chain_us:"us-chains",link_us:"us-links",mile_us:"us-miles",yard_clarke:"clarke-yards",chain_clarke:"clarke-chains",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",link_sears:"sears-links",yard_benoit_1895_a:"benoit-1895-a-yards",foot_benoit_1895_a:"benoit-1895-a-feet",chain_benoit_1895_a:"benoit-1895-a-chains",link_benoit_1895_a:"benoit-1895-a-links",yard_benoit_1895_b:"benoit-1895-b-yards",foot_benoit_1895_b:"benoit-1895-b-feet",chain_benoit_1895_b:"benoit-1895-b-chains",link_benoit_1895_b:"benoit-1895-b-links",foot_1865:"1865-feet",foot_indian:"indian-feet",foot_indian_1937:"indian-1937-feet",foot_indian_1962:"indian-1962-feet",foot_indian_1975:"indian-1975-feet",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",yard_indian_1962:"indian-1962-yards",yard_indian_1975:"indian-1975-yards",statute_mile:"statute-miles",foot_gold_coast:"gold-coast-feet",foot_british_1936:"british-1936-feet",yard:"yards",chain:"chains",link:"links",yard_sears_1922_truncated:"sears-1922-truncated-yards",foot_sears_1922_truncated:"sears-1922-truncated-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains",link_sears_1922_truncated:"sears-1922-truncated-links",yard_us:"us-yards",inch:"inches",inch_us:"us-inches",rod:"rods",rod_us:"us-rods",nautical_mile_us:"us-nautical-miles",nautical_mile_uk:"uk-nautical-miles",smoot:"smoots",vara_tx:"tx-vara",point:"points"}),Ch=t=>t*t,Og=t=>t*t*t,EP={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},meters:{inBaseUnits:1},feet:{inBaseUnits:.3048},"us-feet":{inBaseUnits:.3048006096012192},"clarke-feet":{inBaseUnits:.3047972654},fathoms:{inBaseUnits:1.8288},"nautical-miles":{inBaseUnits:1852},"german-meters":{inBaseUnits:1.0000135965},"us-chains":{inBaseUnits:20.11684023368047},"us-links":{inBaseUnits:.2011684023368047},"us-miles":{inBaseUnits:1609.347218694438},kilometers:{inBaseUnits:1e3},"clarke-yards":{inBaseUnits:.9143917962},"clarke-chains":{inBaseUnits:20.1166195164},"clarke-links":{inBaseUnits:.201166195164},"sears-yards":{inBaseUnits:.9143984146160287},"sears-feet":{inBaseUnits:.3047994715386762},"sears-chains":{inBaseUnits:20.11676512155263},"sears-links":{inBaseUnits:.2011676512155263},"benoit-1895-a-yards":{inBaseUnits:.9143992},"benoit-1895-a-feet":{inBaseUnits:.3047997333333333},"benoit-1895-a-chains":{inBaseUnits:20.1167824},"benoit-1895-a-links":{inBaseUnits:.201167824},"benoit-1895-b-yards":{inBaseUnits:.9143992042898124},"benoit-1895-b-feet":{inBaseUnits:.3047997347632708},"benoit-1895-b-chains":{inBaseUnits:20.11678249437587},"benoit-1895-b-links":{inBaseUnits:.2011678249437587},"1865-feet":{inBaseUnits:.3048008333333334},"indian-feet":{inBaseUnits:.3047995102481469},"indian-1937-feet":{inBaseUnits:.30479841},"indian-1962-feet":{inBaseUnits:.3047996},"indian-1975-feet":{inBaseUnits:.3047995},"indian-yards":{inBaseUnits:.9143985307444408},"indian-1937-yards":{inBaseUnits:.91439523},"indian-1962-yards":{inBaseUnits:.9143988},"indian-1975-yards":{inBaseUnits:.9143985},miles:{inBaseUnits:1609.344},"statute-miles":{inBaseUnits:1609.344},"gold-coast-feet":{inBaseUnits:.3047997101815088},"british-1936-feet":{inBaseUnits:.3048007491},yards:{inBaseUnits:.9144},chains:{inBaseUnits:20.1168},links:{inBaseUnits:.201168},"sears-1922-truncated-yards":{inBaseUnits:.914398},"sears-1922-truncated-feet":{inBaseUnits:.3047993333333334},"sears-1922-truncated-chains":{inBaseUnits:20.116756},"sears-1922-truncated-links":{inBaseUnits:.20116756},"us-yards":{inBaseUnits:.9144018288036576},decimeters:{inBaseUnits:.1},inches:{inBaseUnits:.0254},"us-inches":{inBaseUnits:.0254000508001016},rods:{inBaseUnits:5.0292},"us-rods":{inBaseUnits:5.029210058420118},"us-nautical-miles":{inBaseUnits:1853.248},"uk-nautical-miles":{inBaseUnits:1853.184},smoots:{inBaseUnits:1.7018},"tx-vara":{inBaseUnits:.8466683600033867},points:{inBaseUnits:.0003527777777777778},micrometers:{inBaseUnits:1e-6},nanometers:{inBaseUnits:1e-9},"50-kilometers":{inBaseUnits:5e4},"150-kilometers":{inBaseUnits:15e4}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:Ch(.001)},"square-centimeters":{inBaseUnits:Ch(.01)},"square-decimeters":{inBaseUnits:Ch(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:Ch(1e3)},"square-inches":{inBaseUnits:Ch(.0254)},"square-feet":{inBaseUnits:Ch(.3048)},"square-yards":{inBaseUnits:Ch(.9144)},"square-miles":{inBaseUnits:Ch(1609.344)},"square-nautical-miles":{inBaseUnits:Ch(1852)},"square-us-feet":{inBaseUnits:Ch(1200/3937)},acres:{inBaseUnits:.0015625*Ch(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*Og(.001)},"cubic-centimeters":{inBaseUnits:1e3*Og(.01)},"cubic-decimeters":{inBaseUnits:1e3*Og(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*Og(1e3)},"cubic-inches":{inBaseUnits:1e3*Og(.0254)},"cubic-feet":{inBaseUnits:1e3*Og(.3048)},"cubic-yards":{inBaseUnits:1e3*Og(.9144)},"cubic-miles":{inBaseUnits:1e3*Og(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},BTe=(()=>{const t={};for(const e in EP)for(const i in EP[e].units)t[i]=e;return t})();function qTe(t,e,i){return t*EP[i].units[e].inBaseUnits}function HTe(t,e,i){return t/EP[i].units[e].inBaseUnits}const Rce=["metric","imperial","inches","feet","yards","miles","nautical-miles","us-feet","meters","kilometers"],jTe=new Map([["meters","square-meters"],["feet","square-feet"],["us-feet","square-us-feet"]]);function Uz(t){const e=BTe[t];if(!e)throw new Error("unknown type");return e}function $K(t,e=null){return e=e||Uz(t),EP[e].baseUnit===t}function Qn(t,e,i){if(e===i)return t;const s=Uz(e);if(s!==Uz(i))throw new Error("incompatible units");const n=$K(e,s)?t:qTe(t,e,s);return $K(i,s)?n:HTe(n,i,s)}function dft(t,e,i,s=!1){if(!s&&Rf(e))throw new Error("Unable to convert from an angular unit to a linear unit.");const n=$1(e);return n!==i&&(t=n?Qn(t,n,i):Qn(t*=ah(e),"meters",i)),t}function mft(t,e,i,s=!1){if(!s&&Rf(i))throw new Error("Unable to convert from a linear unit to an angular unit.");const n=$1(i);return e!==n&&(t=n?Qn(t,e,n):Qn(t,e,"meters")/ah(i)),t}function YTe(t){switch(t){case"metric":return"meters";case"imperial":return"feet";default:return t}}function pft(t){return YTe(t)}function fft(t){switch(t){case"metric":return"square-meters";case"imperial":return"square-feet";default:return t}}function gft(t,e){const i=Qn(t,e,"meters");return Math.abs(i)<3e3?"meters":"kilometers"}function _ft(t,e){const i=Qn(t,e,"meters");return Math.abs(i)<1e5?"meters":"kilometers"}function yft(t,e){const i=Qn(t,e,"feet");return Math.abs(i)<1e3?"feet":"miles"}function vft(t,e){const i=Qn(t,e,"feet");return Math.abs(i)<1e5?"feet":"miles"}function xft(t,e){const i=Qn(t,e,"square-meters");return Math.abs(i)<3e6?"square-meters":"square-kilometers"}function bft(t,e){const i=Qn(t,e,"square-feet");return Math.abs(i)<1e6?"square-feet":"square-miles"}function Oce(t,e,i){return Qn(t,e,"meters")/(i*Math.PI/180)}function RH(t){return GTe.fromJSON(t.toLowerCase())||null}function FO(t){if(t!=null&&!RTe(t))return 1;const e=ah(t);return e>1e5?1:e}function Lce(t){return ah(t)>=Mce(t).metersPerDegree?"meters":$1(t)}function ah(t,e=Pr.metersPerDegree){return OH(t,!0)??e}function OH(t,e=!1){const i=(t==null?void 0:t.wkid)??null,s=(t==null?void 0:t.wkt2)??(t==null?void 0:t.wkt)??null;let n=null;if(i){if(MF(i))return Pm.metersPerDegree;if(AF(i))return my.metersPerDegree;n=eS.values[eS[i]],!n&&e&&Nce.has(i)&&(n=zTe)}else s&&(IF(s)?n=UK(Ice.exec(s),n):kce(s)&&(n=UK(Dce.exec(s),n)));return n}function wft(t){return Rf(t)?1:ah(t)}function UK(t,e){return t!=null&&t[1]?Fce(t[1]):e}function Fce(t){return parseFloat(t.split(",")[1])}function $1(t){const e=(t==null?void 0:t.wkid)??null,i=(t==null?void 0:t.wkt2)??(t==null?void 0:t.wkt)??null;let s=null;if(e)s=eS.units[eS[e]];else if(i){const n=IF(i)?Ice:kce(i)?Dce:null;if(n){const r=n.exec(i);r!=null&&r[1]&&(s=WTe(r[1]))}}return s!=null?RH(s):null}function Sft(t){const e=$1(t);return e!=null&&Rce.includes(e)?e:null}function Eft(t){const e=Lce(t);return e!=null&&Rce.includes(e)?e:null}function Cft(t){const e=$1(t);return e==null?null:jTe.get(e)}function kce(t){return/^GEOCCS/i.test(t)}function IF(t){return/^\s*(?:PROJCS|PROJCRS|PROJECTEDCRS)/i.test(t)}const XTe=1e-7;function WTe(t){const e=/[\\"']{1}([^\\"']+)/.exec(t);let i=e==null?void 0:e[1];if(!i||!RH(i)){const s=Fce(t);i=null;const n=eS.values;for(let r=0;r<n.length;++r)if(Math.abs(s-n[r])<XTe){i=eS.units[r];break}}return i}function Tft(t){const e=$1(t);if(e==null)return null;switch(e){case"feet":case"us-feet":case"clarke-feet":case"fathoms":case"nautical-miles":case"us-chains":case"us-links":case"us-miles":case"clarke-yards":case"clarke-chains":case"clarke-links":case"sears-yards":case"sears-feet":case"sears-chains":case"sears-links":case"benoit-1895-a-yards":case"benoit-1895-a-feet":case"benoit-1895-a-chains":case"benoit-1895-a-links":case"benoit-1895-b-yards":case"benoit-1895-b-feet":case"benoit-1895-b-chains":case"benoit-1895-b-links":case"1865-feet":case"indian-feet":case"indian-1937-feet":case"indian-1962-feet":case"indian-1975-feet":case"indian-yards":case"indian-1937-yards":case"indian-1962-yards":case"indian-1975-yards":case"statute-miles":case"gold-coast-feet":case"british-1936-feet":case"yards":case"chains":case"links":case"sears-1922-truncated-yards":case"sears-1922-truncated-feet":case"sears-1922-truncated-chains":case"sears-1922-truncated-links":case"us-yards":case"inches":case"us-inches":case"rods":case"us-rods":case"us-nautical-miles":case"uk-nautical-miles":case"smoots":case"tx-vara":case"points":return"imperial";case"millimeters":case"centimeters":case"meters":case"german-meters":case"kilometers":case"decimeters":case"micrometers":case"nanometers":case"50-kilometers":case"150-kilometers":return"metric"}return null}const ZTe={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},KTe={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},QTe={esriDUDecimalDegrees:"degrees",esriDURadians:"radians"},JTe=ca()(ZTe),ePe=ca()(KTe),Pft=ca()(QTe);function yt(t,e,i){let s,n;return e===void 0?(n=t,s=[void 0]):typeof e!="string"?(n=t,s=[void 0],i=e):(n=e,s=Array.isArray(t)?t:[t]),(r,o)=>{const a=r.constructor.prototype;for(const l of s){const u=uue(r,l,n);u.write&&typeof u.write=="object"||(u.write={}),i&&(u.write.target=i),u.write.writer=a[o]}}}var Wd;let pn=Wd=class extends it{static fromJSON(t){if(!t)return null;if((t==null?void 0:t.wkid)===102100)return Wd.WebMercator;if((t==null?void 0:t.wkid)===4326)return Wd.WGS84;const e=new Wd;return e.read(t),e}constructor(t){super(t),this.latestWkid=null,this.wkid=null,this.wkt=null,this.wkt2=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}normalizeCtorArgs(t){return t&&typeof t=="object"?t:{[typeof t=="string"?"wkt":"wkid"]:t}}get isWGS84(){return l1(this)}get isWebMercator(){return yd(this)}get isGeographic(){return Rf(this)}get isWrappable(){return LTe(this)}get metersPerUnit(){return ah(this)}get unit(){return $1(this)||(this.isGeographic?"degrees":null)}writeWkt(t,e){this.wkid||(e.wkt=t)}clone(){if(this===Wd.WGS84)return new Wd(Tce);if(this===Wd.WebMercator)return new Wd(Pce);const t=new Wd;return this.wkid!=null?(t.wkid=this.wkid,this.latestWkid!=null&&(t.latestWkid=this.latestWkid),this.vcsWkid!=null&&(t.vcsWkid=this.vcsWkid),this.latestVcsWkid!=null&&(t.latestVcsWkid=this.latestVcsWkid)):(this.wkt!=null&&(t.wkt=this.wkt),this.wkt2!=null&&(t.wkt2=this.wkt2)),this.imageCoordinateSystem&&(t.imageCoordinateSystem=be(this.imageCoordinateSystem)),t}equals(t){if(t==null)return!1;if(this.imageCoordinateSystem||t.imageCoordinateSystem){if(this.imageCoordinateSystem==null||t.imageCoordinateSystem==null)return!1;const{id:e,referenceServiceName:i}=t.imageCoordinateSystem,{geodataXform:s}=t.imageCoordinateSystem,n=this.imageCoordinateSystem;return e==null||s?JSON.stringify(n)===JSON.stringify(t.imageCoordinateSystem):i?n.id===e&&n.referenceServiceName===i:n.id===e}return $o(this,t)}toJSON(t){return this.write(void 0,t)}};pn.GCS_NAD_1927=null,pn.WGS84=null,pn.WebMercator=null,pn.PlateCarree=null,y([S({readOnly:!0})],pn.prototype,"isWGS84",null),y([S({readOnly:!0})],pn.prototype,"isWebMercator",null),y([S({readOnly:!0})],pn.prototype,"isGeographic",null),y([S({readOnly:!0})],pn.prototype,"isWrappable",null),y([S({type:zs,json:{write:!0}})],pn.prototype,"latestWkid",void 0),y([S({readOnly:!0})],pn.prototype,"metersPerUnit",null),y([S({readOnly:!0})],pn.prototype,"unit",null),y([S({type:zs,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkt==null}}}}}}})],pn.prototype,"wkid",void 0),y([S({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkid==null}}}}}}})],pn.prototype,"wkt",void 0),y([yt("wkt"),yt("web-scene","wkt")],pn.prototype,"writeWkt",null),y([S({type:String,json:{write:!1}})],pn.prototype,"wkt2",void 0),y([S({type:zs,json:{write:!0}})],pn.prototype,"vcsWkid",void 0),y([S({type:zs,json:{write:!0}})],pn.prototype,"latestVcsWkid",void 0),y([S()],pn.prototype,"imageCoordinateSystem",void 0),pn=Wd=y([se("esri.geometry.SpatialReference")],pn),pn.prototype.toJSON.isDefaultToJSON=!0,pn.GCS_NAD_1927=ei.freeze(new pn({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'})),pn.WGS84=ei.freeze(new pn(Tce)),pn.WebMercator=ei.freeze(new pn(Pce)),pn.PlateCarree=ei.freeze(new pn(FTe));const Ri=pn;let Zd=class extends it{constructor(...e){super(...e),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=Ri.WGS84}get cache(){return this.commitProperty("spatialReference"),{}}get extent(){return null}readSpatialReference(e,i){if(e instanceof Ri)return e;if(e!=null){const s=new Ri;return s.read(e,i),s}return e}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(e){return this.cache[e]}setCacheValue(e,i){this.cache[e]=i}};y([S()],Zd.prototype,"type",void 0),y([S({readOnly:!0})],Zd.prototype,"cache",null),y([S({readOnly:!0})],Zd.prototype,"extent",null),y([S({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Zd.prototype,"hasM",void 0),y([S({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Zd.prototype,"hasZ",void 0),y([S({type:Ri,json:{write:!0},value:Ri.WGS84})],Zd.prototype,"spatialReference",void 0),y([mt("spatialReference")],Zd.prototype,"readSpatialReference",null),Zd=y([se("esri.geometry.Geometry")],Zd);const jf=Zd,tPe=Object.prototype.toString;function iPe(t){const e="__accessorMetadata__"in t?xo(t):t;return function(...i){if(i.push(e),typeof i[2]=="number")throw new Error("Using @cast has parameter decorator is not supported since 4.16");return sPe.apply(this,i)}}function sPe(t,e,i,s){xF(t,e).cast=s}function nPe(t){return(e,i)=>{xF(e,t).cast=e[i]}}function Ls(...t){if(t.length!==3||typeof t[1]!="string")return t.length===1&&tPe.call(t[0])==="[object Function]"?iPe(t[0]):t.length===1&&typeof t[0]=="string"?nPe(t[0]):void 0}function tS(t){if(t&&typeof t=="object"&&"type"in t&&t.type==="mesh")throw new Se("Mesh geometries are not supported for this operation")}function rPe(t){t.forEach(tS)}const oPe=57.29577951308232,aPe=.017453292519943;function VK(t){return t*oPe}function zK(t){return t*aPe}function Aft(t){return Math.PI/2-2*Math.atan(Math.exp(-t/Pr.radius))}function Vz(t){return t.wkid!=null||t.wkt!=null}const nU=[0,0];function kO(t,e,i,s,n){const r=t,o=n;if(o.spatialReference=i,"x"in r&&"x"in o)[o.x,o.y]=e(r.x,r.y,nU,s);else if("xmin"in r&&"xmin"in o)[o.xmin,o.ymin]=e(r.xmin,r.ymin,nU,s),[o.xmax,o.ymax]=e(r.xmax,r.ymax,nU,s);else if("paths"in r&&"paths"in o||"rings"in r&&"rings"in o){const a="paths"in r?r.paths:r.rings,l=[];let u;for(let c=0;c<a.length;c++){const h=a[c];u=[],l.push(u);for(let d=0;d<h.length;d++)u.push(e(h[d][0],h[d][1],[0,0],s)),h[d].length>2&&u[d].push(h[d][2]),h[d].length>3&&u[d].push(h[d][3])}"paths"in o?o.paths=l:o.rings=l}else if("points"in r&&"points"in o){const a=r.points,l=[];for(let u=0;u<a.length;u++)l[u]=e(a[u][0],a[u][1],[0,0],s),a[u].length>2&&l[u].push(a[u][2]),a[u].length>3&&l[u].push(a[u][3]);o.points=l}return n}function TR(t,e){const i=t&&(Vz(t)?t:t.spatialReference),s=e&&(Vz(e)?e:e.spatialReference);return!(t&&"type"in t&&t.type==="mesh"||e&&"type"in e&&e.type==="mesh"||!i||!s)&&(!!$o(s,i)||yd(s)&&l1(i)||yd(i)&&l1(s))}function DF(t,e){if(t==null)return null;const i=t.spatialReference,s=e&&(Vz(e)?e:e.spatialReference);return TR(i,s)?$o(i,s)?be(t):yd(s)?kO(t,rw,Ri.WebMercator,!1,be(t)):l1(s)?kO(t,NF,Ri.WGS84,!1,be(t)):null:null}function rw(t,e,i=[0,0]){e>89.99999?e=89.99999:e<-89.99999&&(e=-89.99999);const s=zK(e);return i[0]=zK(t)*Pr.radius,i[1]=Pr.halfSemiMajorAxis*Math.log((1+Math.sin(s))/(1-Math.sin(s))),i}function NF(t,e,i=[0,0],s=!1){if(t===SP[0])i[0]=-180;else if(t===SP[1])i[0]=180;else{const n=VK(t/Pr.radius);i[0]=s?n:n-360*Math.floor((n+180)/360)}return i[1]=VK(Math.PI/2-2*Math.atan(Math.exp(-e/Pr.radius))),i}function ty(t,e=!1,i=be(t)){return tS(t),tS(i),kO(t,rw,Ri.WebMercator,e,i)}function Ov(t,e=!1,i=be(t)){return tS(t),tS(i),kO(t,NF,Ri.WGS84,e,i)}function $ce(t,e){const i=t.x-e.x,s=t.y-e.y,n=t.z!=null&&e.z!=null?t.z-e.z:0;return Math.sqrt(i*i+s*s+n*n)}function lPe(t){var e;return((e=Uce(t,Vce))==null?void 0:e[0])??null}function uPe(t){var e;return((e=Uce(t,Vce))==null?void 0:e[1])??null}function Uce({x:t,y:e,spatialReference:i},s=[0,0]){if(i){if(yd(i))return NF(t,e,s);if(Rf(i))return s[0]=t,s[1]=e,s}return null}const Vce=[0,0];var PR;const rU=[0,0];function GK(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}let vl=PR=class extends jf{static copy(t,e){e._set("x",t._get("x")),e._set("y",t._get("y")),e._set("z",t._get("z")),e._set("m",t._get("m"));const i=t._get("spatialReference");e._set("spatialReference",ei.isFrozen(i)?i:i.clone())}constructor(...t){super(...t),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}normalizeCtorArgs(t,e,i,s,n){let r;if(Array.isArray(t))r=t,n=e,t=r[0],e=r[1],i=r[2],s=r[3];else if(t&&typeof t=="object"){if(r=t,t=r.x!=null?r.x:r.longitude,e=r.y!=null?r.y:r.latitude,i=r.z,s=r.m,(n=r.spatialReference)&&n.declaredClass!=="esri.geometry.SpatialReference"&&(n=new Ri(n)),r.longitude!=null||r.latitude!=null){if(r.longitude==null)ht.getLogger(this).warn(".longitude=","Latitude was defined without longitude");else if(r.latitude==null)ht.getLogger(this).warn(".latitude=","Longitude was defined without latitude");else if(!r.declaredClass&&(n!=null&&n.isWebMercator)){const a=rw(r.longitude,r.latitude,rU);t=a[0],e=a[1]}}}else GK(i)?(n=i,i=null):GK(s)&&(n=s,s=null);const o={x:t,y:e};return o.x==null&&o.y!=null?ht.getLogger(this).warn(".y=","Y coordinate was defined without an X coordinate"):o.y==null&&o.x!=null&&ht.getLogger(this).warn(".x=","X coordinate was defined without a Y coordinate"),n!=null&&(o.spatialReference=n),i!=null&&(o.z=i),s!=null&&(o.m=s),o}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return this.m!==void 0}set hasM(t){t!==(this._get("m")!==void 0)&&(this._set("m",t?0:void 0),this._set("hasM",t))}get hasZ(){return this.z!==void 0}set hasZ(t){t!==(this._get("z")!==void 0)&&(this._set("z",t?0:void 0),this._set("hasZ",t))}get latitude(){return uPe(this)}set latitude(t){const{spatialReference:e,x:i}=this;t!=null&&e&&(e.isWebMercator?this._set("y",rw(i,t,rU)[1]):e.isGeographic&&this._set("y",t),this._set("latitude",t))}get longitude(){return lPe(this)}set longitude(t){const{y:e,spatialReference:i}=this;t!=null&&i&&(i.isWebMercator?this._set("x",rw(t,e,rU)[0]):i.isGeographic&&this._set("x",t),this._set("longitude",t))}writeX(t,e,i){e[i]=isNaN(t)?"NaN":t}readX(t){return typeof t=="string"?NaN:t}clone(){const t=new PR;return t.x=this.x,t.y=this.y,t.z=this.z,t.m=this.m,t.spatialReference=this.spatialReference,t}copy(t){return PR.copy(t,this),this}equals(t){if(t==null)return!1;const{x:e,y:i,z:s,m:n,spatialReference:r}=this,{z:o,m:a}=t;let{x:l,y:u,spatialReference:c}=t;if(!r.equals(c))if(r.isWebMercator&&c.isWGS84)[l,u]=rw(l,u),c=r;else{if(!r.isWGS84||!c.isWebMercator)return!1;[l,u]=NF(l,u),c=r}return e===l&&i===u&&s===o&&n===a&&r.wkid===c.wkid}offset(t,e,i){return this.x+=t,this.y+=e,i!=null&&(this.z=(this.z??0)+i),this}normalize(){if(!this.spatialReference)return this;const t=Ol(this.spatialReference);if(!t)return this;let e=this.x;const[i,s]=t.valid,n=2*s;let r;return e>s?(r=Math.ceil(Math.abs(e-s)/n),e-=r*n):e<i&&(r=Math.ceil(Math.abs(e-i)/n),e+=r*n),this._set("x",e),this}distance(t){return $ce(this,t)}toArray(){const t=this.hasZ,e=this.hasM;return t&&e?[this.x,this.y,this.z,this.m]:t?[this.x,this.y,this.z]:e?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(t){return this.write({},t)}};y([S({readOnly:!0})],vl.prototype,"cache",null),y([S({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],vl.prototype,"hasM",null),y([S({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],vl.prototype,"hasZ",null),y([S({type:Number})],vl.prototype,"latitude",null),y([S({type:Number})],vl.prototype,"longitude",null),y([S({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),Ls(t=>isNaN(t)?t:Al(t))],vl.prototype,"x",void 0),y([yt("x")],vl.prototype,"writeX",null),y([mt("x")],vl.prototype,"readX",null),y([S({type:Number,json:{write:!0}})],vl.prototype,"y",void 0),y([S({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],vl.prototype,"z",void 0),y([S({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],vl.prototype,"m",void 0),vl=PR=y([se("esri.geometry.Point")],vl),vl.prototype.toJSON.isDefaultToJSON=!0;const ki=vl,oU=[0,0];function GM(t,e){return e!=null&&Tl(t,e.x,e.y,e.z)}function Ift(t,e){var i;if(!((i=e.points)!=null&&i.length))return!1;for(const s of e.points)if(!iS(t,s))return!1;return!0}function cPe(t,e){const{xmin:i,ymin:s,zmin:n,xmax:r,ymax:o,zmax:a}=e;return t.hasZ&&e.hasZ?Tl(t,i,s,n)&&Tl(t,i,o,n)&&Tl(t,r,o,n)&&Tl(t,r,s,n)&&Tl(t,i,s,a)&&Tl(t,i,o,a)&&Tl(t,r,o,a)&&Tl(t,r,s,a):Tl(t,i,s)&&Tl(t,i,o)&&Tl(t,r,o)&&Tl(t,r,s)}function iS(t,e){return Tl(t,e[0],e[1])}function hPe(t,e){return Tl(t,e[0],e[1],e[2])}function Tl(t,e,i,s){return e>=t.xmin&&e<=t.xmax&&i>=t.ymin&&i<=t.ymax&&(s==null||!t.hasZ||s>=t.zmin&&s<=t.zmax)}function LH(t,e){return oU[1]=e.y,oU[0]=e.x,dPe(t,oU)}function dPe(t,e){return FH(t.rings,e)}function FH(t,e){if(!t)return!1;if(mPe(t))return BK(!1,t,e);let i=!1;for(let s=0,n=t.length;s<n;s++)i=BK(i,t[s],e);return i}function mPe(t){return!Array.isArray(t[0][0])}function BK(t,e,i){const[s,n]=i;let r=t,o=0;for(let a=0,l=e.length;a<l;a++){o++,o===l&&(o=0);const[u,c]=e[a],[h,d]=e[o];(c<n&&d>=n||d<n&&c>=n)&&u+(n-c)/(d-c)*(h-u)<s&&(r=!r)}return r}function pPe(t,e){return GM(t,e)}function fPe(t,e){const i=t.hasZ&&e.hasZ;let s,n,r;if(t.xmin<=e.xmin){if(s=e.xmin,t.xmax<s)return!1}else if(s=t.xmin,e.xmax<s)return!1;if(t.ymin<=e.ymin){if(n=e.ymin,t.ymax<n)return!1}else if(n=t.ymin,e.ymax<n)return!1;if(i&&e.hasZ){if(t.zmin<=e.zmin){if(r=e.zmin,t.zmax<r)return!1}else if(r=t.zmin,e.zmax<r)return!1}return!0}function gPe(t,e){const{points:i,hasZ:s}=e,n=s?hPe:iS;for(const r of i)if(n(t,r))return!0;return!1}const u1=[0,0],c1=[0,0],h1=[0,0],d1=[0,0],_Pe=[u1,c1,h1,d1],zce=[[h1,u1],[u1,c1],[c1,d1],[d1,h1]];function yPe(t,e){return vPe(t,e.rings)}function vPe(t,e){u1[0]=t.xmin,u1[1]=t.ymax,c1[0]=t.xmax,c1[1]=t.ymax,h1[0]=t.xmin,h1[1]=t.ymin,d1[0]=t.xmax,d1[1]=t.ymin;for(const i of _Pe)if(FH(e,i))return!0;for(const i of e){if(!i.length)continue;let s=i[0];if(iS(t,s))return!0;for(let n=1;n<i.length;n++){const r=i[n];if(iS(t,r)||Gce(s,r,zce))return!0;s=r}}return!1}function xPe(t,e){u1[0]=t.xmin,u1[1]=t.ymax,c1[0]=t.xmax,c1[1]=t.ymax,h1[0]=t.xmin,h1[1]=t.ymin,d1[0]=t.xmax,d1[1]=t.ymin;const i=e.paths;for(const s of i){if(!i.length)continue;let n=s[0];if(iS(t,n))return!0;for(let r=1;r<s.length;r++){const o=s[r];if(iS(t,o)||Gce(n,o,zce))return!0;n=o}}return!1}const jo=[0,0];function bPe(t){for(let e=0;e<t.length;e++){const i=t[e];for(let n=0;n<i.length-1;n++){const r=i[n],o=i[n+1];for(let a=e+1;a<t.length;a++)for(let l=0;l<t[a].length-1;l++){const u=t[a][l],c=t[a][l+1];if(zz(r,o,u,c,jo)&&!(jo[0]===r[0]&&jo[1]===r[1]||jo[0]===u[0]&&jo[1]===u[1]||jo[0]===o[0]&&jo[1]===o[1]||jo[0]===c[0]&&jo[1]===c[1]))return!0}}const s=i.length;if(!(s<=4))for(let n=0;n<s-3;n++){let r=s-1;n===0&&(r=s-2);const o=i[n],a=i[n+1];for(let l=n+2;l<r;l++){const u=i[l],c=i[l+1];if(zz(o,a,u,c,jo)&&!(jo[0]===o[0]&&jo[1]===o[1]||jo[0]===u[0]&&jo[1]===u[1]||jo[0]===a[0]&&jo[1]===a[1]||jo[0]===c[0]&&jo[1]===c[1]))return!0}}}return!1}function Gce(t,e,i){for(let s=0;s<i.length;s++)if(zz(t,e,i[s][0],i[s][1]))return!0;return!1}function zz(t,e,i,s,n){const[r,o]=t,[a,l]=e,[u,c]=i,[h,d]=s,m=h-u,f=r-u,_=a-r,v=d-c,x=o-c,w=l-o,T=v*_-m*w;if(T===0)return!1;const C=(m*x-v*f)/T,M=(_*x-w*f)/T;return C>=0&&C<=1&&M>=0&&M<=1&&(n&&(n[0]=r+C*(a-r),n[1]=o+C*(l-o)),!0)}function wPe(t){switch(t){case"esriGeometryEnvelope":case"extent":return fPe;case"esriGeometryMultipoint":case"multipoint":return gPe;case"esriGeometryPoint":case"point":return pPe;case"esriGeometryMultiPatch":case"multipatch":case"esriGeometryPolygon":case"polygon":return yPe;case"esriGeometryPolyline":case"polyline":return xPe}}var Lh;function SPe(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}function Lg(t,e,i){return e==null?i:i==null?e:t(e,i)}let To=Lh=class extends jf{constructor(...t){super(...t),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(t,e,i,s,n){return SPe(t)?{spatialReference:t,xmin:0,ymin:0,xmax:0,ymax:0}:typeof t=="object"?(t.spatialReference=t.spatialReference==null?Ri.WGS84:t.spatialReference,t):{xmin:t,ymin:e,xmax:i,ymax:s,spatialReference:n??Ri.WGS84}}static fromPoint(t){return new Lh({xmin:t.x,ymin:t.y,zmin:t.z,xmax:t.x,ymax:t.y,zmax:t.z,spatialReference:t.spatialReference})}get cache(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}get center(){const t=new ki({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(t.z=.5*(this.zmin+this.zmax)),this.hasM&&(t.m=.5*(this.mmin+this.mmax)),t}get extent(){return this.clone()}get hasM(){return this.mmin!=null&&this.mmax!=null}get hasZ(){return this.zmin!=null&&this.zmax!=null}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(t){const e=this.center;return t.z!=null&&this.hasZ?this.offset(t.x-e.x,t.y-e.y,t.z-e.z):this.offset(t.x-e.x,t.y-e.y)}clone(){const t=new Lh;return t.xmin=this.xmin,t.ymin=this.ymin,t.xmax=this.xmax,t.ymax=this.ymax,t.spatialReference=this.spatialReference,this.zmin!=null&&(t.zmin=this.zmin,t.zmax=this.zmax),this.mmin!=null&&(t.mmin=this.mmin,t.mmax=this.mmax),t}contains(t){if(!t)return!1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&TR(e,i)&&(t=e.isWebMercator?ty(t):Ov(t,!0)),t.type==="point"?GM(this,t):t.type==="extent"&&cPe(this,t)}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&TR(e,i)&&(t=e.isWebMercator?ty(t):Ov(t,!0)),this.xmin===t.xmin&&this.ymin===t.ymin&&this.zmin===t.zmin&&this.mmin===t.mmin&&this.xmax===t.xmax&&this.ymax===t.ymax&&this.zmax===t.zmax&&this.mmax===t.mmax}expand(t){const e=.5*(1-t),i=this.width*e,s=this.height*e;if(this.xmin+=i,this.ymin+=s,this.xmax-=i,this.ymax-=s,this.hasZ){const n=(this.zmax-this.zmin)*e;this.zmin+=n,this.zmax-=n}if(this.hasM){const n=(this.mmax-this.mmin)*e;this.mmin+=n,this.mmax-=n}return this}intersects(t){if(t==null)return!1;t.type==="mesh"&&(t=t.extent);const e=this.spatialReference,i=t.spatialReference;return e&&i&&!$o(e,i)&&TR(e,i)&&(t=e.isWebMercator?ty(t):Ov(t,!0)),wPe(t.type)(this,t)}normalize(){const t=this._normalize(!1,!0);return Array.isArray(t)?t:[t]}offset(t,e,i){return this.xmin+=t,this.ymin+=e,this.xmax+=t,this.ymax+=e,i!=null&&(this.zmin+=i,this.zmax+=i),this}shiftCentralMeridian(){return this._normalize(!0)}union(t){return this===t||(this.xmin=Math.min(this.xmin,t.xmin),this.ymin=Math.min(this.ymin,t.ymin),this.xmax=Math.max(this.xmax,t.xmax),this.ymax=Math.max(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=Lg(Math.min,this.zmin,t.zmin),this.zmax=Lg(Math.max,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=Lg(Math.min,this.mmin,t.mmin),this.mmax=Lg(Math.max,this.mmax,t.mmax))),this}intersection(t){return this===t?this:t!=null&&this.intersects(t)?(this.xmin=Math.max(this.xmin,t.xmin),this.ymin=Math.max(this.ymin,t.ymin),this.xmax=Math.min(this.xmax,t.xmax),this.ymax=Math.min(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=Lg(Math.max,this.zmin,t.zmin),this.zmax=Lg(Math.min,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=Lg(Math.max,this.mmin,t.mmin),this.mmax=Lg(Math.min,this.mmax,t.mmax)),this):null}toJSON(t){return this.write({},t)}_shiftCM(t=Ol(this.spatialReference)){if(!t||!this.spatialReference)return this;const e=this.spatialReference,i=this._getCM(t);if(i){const s=e.isWebMercator?Ov(i):i;this.xmin-=i.x,this.xmax-=i.x,e.isWebMercator||(s.x=aU(s.x,t).x),this.spatialReference=new Ri(_F((e.isWGS84?t.altTemplate:null)??t.wkTemplate,{Central_Meridian:s.x}))}return this}_getCM(t){let e=null;const[i,s]=t.valid,n=this.xmin,r=this.xmax;return n>=i&&n<=s&&r>=i&&r<=s||(e=this.center),e}_normalize(t,e,i){const s=this.spatialReference;if(!s)return this;const n=i??Ol(s);if(n==null)return this;const r=this._getParts(n).map(l=>l.extent);if(r.length<2)return r[0]||this;if(r.length>2)return t?this._shiftCM(n):this.set({xmin:n.valid[0],xmax:n.valid[1]});if(t)return this._shiftCM(n);if(e)return r;let o=!0,a=!0;return r.forEach(l=>{l.hasZ||(o=!1),l.hasM||(a=!1)}),{rings:r.map(l=>{const u=[[l.xmin,l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,l.ymin]];if(o){const c=(l.zmax-l.zmin)/2;for(let h=0;h<u.length;h++)u[h].push(c)}if(a){const c=(l.mmax-l.mmin)/2;for(let h=0;h<u.length;h++)u[h].push(c)}return u}),hasZ:o,hasM:a,spatialReference:s}}_getParts(t){let e=this.cache._parts;if(!e){e=[];const{ymin:n,ymax:r,spatialReference:o}=this,a=this.width,l=this.xmin,u=this.xmax;let c;t=t||Ol(o);const[h,d]=t.valid;c=aU(this.xmin,t);const m=c.x,f=c.frameId;c=aU(this.xmax,t);const _=c.x,v=c.frameId,x=m===_&&a>0;if(a>2*d){const w=new Lh(l<u?m:_,n,d,r,o),T=new Lh(h,n,l<u?_:m,r,o),C=new Lh(0,n,d,r,o),M=new Lh(h,n,0,r,o),A=[],I=[];w.contains(C)&&A.push(f),w.contains(M)&&I.push(f),T.contains(C)&&A.push(v),T.contains(M)&&I.push(v);for(let L=f+1;L<v;L++)A.push(L),I.push(L);e.push({extent:w,frameIds:[f]},{extent:T,frameIds:[v]},{extent:C,frameIds:A},{extent:M,frameIds:I})}else m>_||x?e.push({extent:new Lh(m,n,d,r,o),frameIds:[f]},{extent:new Lh(h,n,_,r,o),frameIds:[v]}):e.push({extent:new Lh(m,n,_,r,o),frameIds:[f]});this.cache._parts=e}const i=this.hasZ,s=this.hasM;if(i||s){const n={};i&&(n.zmin=this.zmin,n.zmax=this.zmax),s&&(n.mmin=this.mmin,n.mmax=this.mmax);for(let r=0;r<e.length;r++)e[r].extent.set(n)}return e}};function aU(t,e){const[i,s]=e.valid,n=2*s;let r,o=0;return t>s?(r=Math.ceil(Math.abs(t-s)/n),t-=r*n,o=r):t<i&&(r=Math.ceil(Math.abs(t-i)/n),t+=r*n,o=-r),{x:t,frameId:o}}y([S({readOnly:!0})],To.prototype,"cache",null),y([S({readOnly:!0})],To.prototype,"center",null),y([S({readOnly:!0})],To.prototype,"extent",null),y([S({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],To.prototype,"hasM",null),y([S({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],To.prototype,"hasZ",null),y([S({readOnly:!0})],To.prototype,"height",null),y([S({readOnly:!0})],To.prototype,"width",null),y([S({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],To.prototype,"xmin",void 0),y([S({type:Number,json:{write:!0}})],To.prototype,"ymin",void 0),y([S({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],To.prototype,"mmin",void 0),y([S({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],To.prototype,"zmin",void 0),y([S({type:Number,json:{write:!0}})],To.prototype,"xmax",void 0),y([S({type:Number,json:{write:!0}})],To.prototype,"ymax",void 0),y([S({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],To.prototype,"mmax",void 0),y([S({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],To.prototype,"zmax",void 0),To=Lh=y([se("esri.geometry.Extent")],To),To.prototype.toJSON.isDefaultToJSON=!0;const Nn=To;function sS(t,e,i=!1){let{hasM:s,hasZ:n}=t;Array.isArray(e)?e.length!==4||s||n?e.length===3&&i&&!s?(n=!0,s=!1):e.length===3&&s&&n&&(s=!1,n=!1):(s=!0,n=!0):(n=!n&&e.hasZ&&(!s||e.hasM),s=!s&&e.hasM&&(!n||e.hasZ)),t.hasZ=n,t.hasM=s}var Gz;function qK(t){return(e,i)=>e==null?i:i==null?e:t(e,i)}function EPe(t){return t&&(t.declaredClass==="esri.geometry.SpatialReference"||t.wkid!=null)}let e_=Gz=class extends jf{constructor(...t){super(...t),this.points=[],this.type="multipoint"}normalizeCtorArgs(t,e){var n;if(!t&&!e)return{};const i={};Array.isArray(t)?(i.points=t,i.spatialReference=e):EPe(t)?i.spatialReference=t:(t.points&&(i.points=t.points),t.spatialReference&&(i.spatialReference=t.spatialReference),t.hasZ&&(i.hasZ=t.hasZ),t.hasM&&(i.hasM=t.hasM));const s=(n=i.points)==null?void 0:n[0];return s&&(i.hasZ===void 0&&i.hasM===void 0?(i.hasZ=s.length>2,i.hasM=!1):i.hasZ===void 0?i.hasZ=s.length>3:i.hasM===void 0&&(i.hasM=s.length>3)),i}get cache(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const t=this.points;if(!t.length)return null;const e=new Nn,i=this.hasZ,s=this.hasM,n=i?3:2,r=t[0],o=qK(Math.min),a=qK(Math.max);let l,u,c,h,[d,m]=r,[f,_]=r;for(let v=0,x=t.length;v<x;v++){const w=t[v],[T,C]=w;if(d=o(d,T),m=o(m,C),f=a(f,T),_=a(_,C),i&&w.length>2){const M=w[2];l=o(l,M),c=a(c,M)}if(s&&w.length>n){const M=w[n];u=o(u,M),h=a(h,M)}}return e.xmin=d,e.ymin=m,e.xmax=f,e.ymax=_,e.spatialReference=this.spatialReference,i?(e.zmin=l,e.zmax=c):(e.zmin=void 0,e.zmax=void 0),s?(e.mmin=u,e.mmax=h):(e.mmin=void 0,e.mmax=void 0),e}writePoints(t,e){e.points=be(this.points)}addPoint(t){return sS(this,t),Array.isArray(t)?this.points.push(t):this.points.push(t.toArray()),this.notifyChange("points"),this}clone(){const t={points:be(this.points),spatialReference:this.spatialReference};return this.hasZ&&(t.hasZ=!0),this.hasM&&(t.hasM=!0),new Gz(t)}getPoint(t){if(!this._validateInputs(t))return null;const e=this.points[t],i={x:e[0],y:e[1],spatialReference:this.spatialReference};let s=2;return this.hasZ&&(i.z=e[2],s=3),this.hasM&&(i.m=e[s]),new ki(i)}removePoint(t){if(!this._validateInputs(t))return null;const e=new ki(this.points.splice(t,1)[0],this.spatialReference);return this.notifyChange("points"),e}setPoint(t,e){return this._validateInputs(t)?(sS(this,e),Array.isArray(e)||(e=e.toArray()),this.points[t]=e,this.notifyChange("points"),this):this}toJSON(t){return this.write({},t)}_validateInputs(t){return t!=null&&t>=0&&t<this.points.length}};y([S({readOnly:!0})],e_.prototype,"cache",null),y([S()],e_.prototype,"extent",null),y([S({type:[[Number]],json:{write:{isRequired:!0}}})],e_.prototype,"points",void 0),y([yt("points")],e_.prototype,"writePoints",null),e_=Gz=y([se("esri.geometry.Multipoint")],e_),e_.prototype.toJSON.isDefaultToJSON=!0;const BM=e_;function Dft(t){const e=[];for(t.reset();t.nextPath();){const i=[];for(;t.nextPoint();)i.push([t.x,t.y]);e.push(i)}return t.reset(),e}function CPe(t){const e=[];for(;t.nextPoint();)e.push([t.x,t.y]);return t.seekPathStart(),e}var $O;(function(t){t[t.X=0]="X",t[t.Y=1]="Y",t[t.Z=2]="Z"})($O||($O={}));function Nft(t){if(!t)return null;if(Array.isArray(t))return t;const e=t.hasZ,i=t.hasM;if(t.type==="point")return i&&e?[t.x,t.y,t.z,t.m]:e?[t.x,t.y,t.z]:i?[t.x,t.y,t.m]:[t.x,t.y];if(t.type==="polygon")return t.rings.slice();if(t.type==="polyline")return t.paths.slice();if(t.type==="multipoint")return t.points.slice();if(t.type==="extent"){const s=t.clone().normalize();if(!s)return null;let n=!1,r=!1;return s.forEach(o=>{o.hasZ&&(n=!0),o.hasM&&(r=!0)}),s.map(o=>{const a=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(n&&o.hasZ){const l=.5*(o.zmax-o.zmin);for(let u=0;u<a.length;u++)a[u].push(l)}if(r&&o.hasM){const l=.5*(o.mmax-o.mmin);for(let u=0;u<a.length;u++)a[u].push(l)}return a})}return null}function RF(t,e){const i=e[0]-t[0],s=e[1]-t[1];if(t.length>2&&e.length>2){const n=t[2]-e[2];return Math.sqrt(i*i+s*s+n*n)}return Math.sqrt(i*i+s*s)}function Bce(t,e,i){const s=t[0]+i*(e[0]-t[0]),n=t[1]+i*(e[1]-t[1]);return t.length>2&&e.length>2?[s,n,t[2]+i*(e[2]-t[2])]:[s,n]}function TPe(t,e,i,s){return PPe(t,e,i[s],i[s+1])}function PPe(t,e,i,s){const[n,r]=e,[o,a]=i,[l,u]=s,c=l-o,h=u-a,d=c*c+h*h,m=(n-o)*c+(r-a)*h,f=Math.min(1,Math.max(0,m/d));return t[0]=o+c*f,t[1]=a+h*f,t}function Rft(t,e,i,s,n,r){let o=i,a=s,l=n-o,u=r-a;if(l!==0||u!==0){const c=((t-o)*l+(e-a)*u)/(l*l+u*u);c>1?(o=n,a=r):c>0&&(o+=l*c,a+=u*c)}return l=t-o,u=e-a,l*l+u*u}function qce(t,e){return Bce(t,e,.5)}function Oft(t){const e=t.length;let i=0;for(let s=0;s<e-1;++s)i+=RF(t[s],t[s+1]);return i}function Lft(t,e){if(e<=0)return t[0];const i=t.length;let s=0;for(let n=0;n<i-1;++n){const r=RF(t[n],t[n+1]);if(e-s<r){const o=(e-s)/r;return Bce(t[n],t[n+1],o)}s+=r}return t[i-1]}function Hce(t,e=$O.X,i=$O.Y){let s=0;const n=t.length;let r=t[0];for(let o=1;o<n;o++){const a=t[o];s+=(a[e]-r[e])*(a[i]+r[i]),r=a}if(!jce(t)){const o=t[0];s+=(o[e]-r[e])*(o[i]+r[i])}return s>=0}function jce(t){const e=t.length;return e<3||mF(t[0],t[e-1])}function Fft(t){"rings"in t&&(MPe(t),APe(t))}function MPe(t){if(!("rings"in t))return!1;let e=!1;for(const i of t.rings)jce(i)||(i.push(i[0].slice()),e=!0);return e}function APe(t){if(!("rings"in t)||t.rings.length===0||Hce(t.rings[0]))return!1;for(const e of t.rings)e.reverse();return!0}function kft(t){return t.type!=="polygon"&&t.type!=="polyline"||IPe(t.type==="polygon"?t.rings:t.paths,t.spatialReference),t}function IPe(t,e){const i=Ol(e);if(!i)return;const s=i.valid[0],n=i.valid[1],r=n-s;for(const o of t){let a=1/0,l=-1/0;for(const c of o){const h=DPe(c[0],s,n);a=Math.min(a,h),l=Math.max(l,h),c[0]=h}const u=l-a;r-u<u&&o.forEach(c=>{c[0]<0&&(c[0]+=r)})}}function DPe(t,e,i){const s=i-e;return t<e?i-(e-t)%s:t>i?e+(t-e)%s:t}function $ft(t,e){if(t===e)return!0;if(t.type!==e.type)return!1;if(t.type==="point"||t.type==="mesh"||t.type==="extent")return!0;if(t.type==="multipoint")return t.points.length===e.points.length;const[i,s]=t.type==="polyline"?[t.paths,e.paths]:[t.rings,e.rings];return i.length===s.length&&i.every((n,r)=>n.length===s[r].length)}function Uft(t){return t?t.hasZ?[t.xmax-t.xmin/2,t.ymax-t.ymin/2,t.zmax-t.zmin/2]:[t.xmax-t.xmin/2,t.ymax-t.ymin/2]:null}function NPe(t){return t?RPe(t.rings,t.hasZ??!1):null}function RPe(t,e){if(!(t!=null&&t.length))return null;const i=[],s=[],n=e?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let r=0,o=t.length;r<o;r++){const a=Yce(t[r],e,n);a&&s.push(a)}if(s.sort((r,o)=>{let a=r[2]-o[2];return a===0&&e&&(a=r[4]-o[4]),a}),s.length&&(i[0]=s[0][0],i[1]=s[0][1],e&&(i[2]=s[0][3]),(i[0]<n[0]||i[0]>n[1]||i[1]<n[2]||i[1]>n[3]||e&&(i[2]<n[4]||i[2]>n[5]))&&(i.length=0)),!i.length){const r=t[0]&&t[0].length?OPe(t[0],e):null;if(!r)return null;i[0]=r[0],i[1]=r[1],e&&r.length>2&&(i[2]=r[2])}return i}function Yce(t,e,i){let s=0,n=0,r=0,o=0,a=0;const l=t.length?t[0][0]:0,u=t.length?t[0][1]:0,c=t.length&&e?t[0][2]:0;for(let d=0;d<t.length;d++){const m=t[d],f=t[(d+1)%t.length],[_,v,x]=m,w=_-l,T=v-u,[C,M,A]=f,I=C-l,L=M-u,D=w*L-I*T;if(o+=D,s+=(w+I)*D,n+=(T+L)*D,e&&m.length>2&&f.length>2){const O=x-c,U=A-c,$=w*U-I*O;r+=(O+U)*$,a+=$}_<i[0]&&(i[0]=_),_>i[1]&&(i[1]=_),v<i[2]&&(i[2]=v),v>i[3]&&(i[3]=v),e&&(x<i[4]&&(i[4]=x),x>i[5]&&(i[5]=x))}if(o>0&&(o*=-1),a>0&&(a*=-1),!o)return null;o*=.5,a*=.5;const h=[s/(6*o)+l,n/(6*o)+u,o];return e&&(i[4]===i[5]||a===0?(h[3]=(i[4]+i[5])/2,h[4]=0):(h[3]=r/(6*a)+c,h[4]=a)),h}function Vft(t,e){let i=0,s=0,n=0;t.nextPoint();const r=t.pathSize?t.x:0,o=t.pathSize?t.y:0;for(let a=0;a<t.pathSize;a++){t.seekInPath(a);const l=[t.x,t.y];t.seekInPath((a+1)%t.pathSize);const u=[t.x,t.y],[c,h]=l,d=c-r,m=h-o,[f,_]=u,v=f-r,x=_-o,w=d*x-v*m;n+=w,i+=(d+v)*w,s+=(m+x)*w,c<e[0]&&(e[0]=c),c>e[1]&&(e[1]=c),h<e[2]&&(e[2]=h),h>e[3]&&(e[3]=h)}return n>0&&(n*=-1),n?(n*=.5,[i/(6*n)+r,s/(6*n)+o,n]):null}function OPe(t,e){const i=e?[0,0,0]:[0,0],s=e?[0,0,0]:[0,0];let n=0,r=0,o=0,a=0;for(let l=0,u=t.length;l<u-1;l++){const c=t[l],h=t[l+1];if(c&&h){i[0]=c[0],i[1]=c[1],s[0]=h[0],s[1]=h[1],e&&c.length>2&&h.length>2&&(i[2]=c[2],s[2]=h[2]);const d=RF(i,s);if(d){n+=d;const m=qce(c,h);r+=d*m[0],o+=d*m[1],e&&m.length>2&&(a+=d*m[2])}}}return n>0?e?[r/n,o/n,a/n]:[r/n,o/n]:t.length?t[0]:null}function LPe(t){const{hasZ:e,totalSize:i}=t;if(i===0)return null;const s=[],n=[],r=e?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(t.reset();t.nextPath();){const o=Yce(CPe(t),t.hasZ,r);o&&n.push(o)}if(n.sort((o,a)=>{let l=o[2]-a[2];return l===0&&e&&(l=o[4]-a[4]),l}),n.length&&(s[0]=n[0][0],s[1]=n[0][1],e&&(s[2]=n[0][3]),(s[0]<r[0]||s[0]>r[1]||s[1]<r[2]||s[1]>r[3]||e&&(s[2]<r[4]||s[2]>r[5]))&&(s.length=0)),!s.length){t.reset(),t.nextPath();const o=t.pathSize?FPe(t):null;if(!o)return null;s[0]=o[0],s[1]=o[1],e&&o.length>2&&(s[2]=o[2])}return s}function FPe(t){const{hasZ:e}=t,i=e?[0,0,0]:[0,0],s=e?[0,0,0]:[0,0];let n=0,r=0,o=0,a=0;if(t.nextPoint()){let l=t.x,u=t.y,c=t.z;for(;t.nextPoint();){const h=t.x,d=t.y,m=t.z;i[0]=l,i[1]=u,s[0]=h,s[1]=d,e&&(i[2]=c,s[2]=m);const f=RF(i,s);if(f){n+=f;const _=qce(i,s);r+=f*_[0],o+=f*_[1],e&&_.length>2&&(a+=f*_[2])}l=h,u=d,c=m}}return n>0?e?[r/n,o/n,a/n]:[r/n,o/n]:t.pathSize?(t.seekPathStart(),t.nextPoint(),[t.x,t.y]):null}const kPe=1e-6;function zft(t){let e=0;for(t.reset();t.nextPath();)e+=t.getCurrentRingArea();if(e<kPe){const n=LPe(t);return n?[n[0],n[1]]:null}const i=[0,0];if(t.reset(),!t.nextPath()||!t.nextPoint())return null;const s=[t.x,t.y];for(t.reset();t.nextPath();)UPe(i,s,t);return i[0]*=1/e,i[1]*=1/e,i[0]+=s[0],i[1]+=s[1],i}const $Pe=1/3;function UPe(t,e,i){if(!i||i.pathSize<3)return null;i.nextPoint();const s=i.x,n=i.y;i.nextPoint();let r,o=i.x-s,a=i.y-n,l=0,u=0;for(;i.nextPoint();)l=i.x-s,u=i.y-n,r=.5*$Pe*(l*a-u*o),t[0]+=r*(o+l),t[1]+=r*(a+u),o=l,a=u;const c=i.getCurrentRingArea(),h=[s,n];return h[0]-=e[0],h[1]-=e[1],h[0]*=c,h[1]*=c,t[0]+=h[0],t[1]+=h[1],t}const HK=new Float32Array(1);function Gft(t){--t;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1}function sh(t,e,i){return Math.min(Math.max(t,e),i)}function Bft(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}function pC(t,e,i){return t+(e-t)*i}function qft(t,e,i,s,n){return pC(s,n,(t-e)/(i-e))}function qM(t){return t*Math.PI/180}function Xce(t){return 180*t/Math.PI}function Hft(t,e=1e-6){return(t<0?-1:1)/Math.max(Math.abs(t),e)}function jft(t){return Math.acos(sh(t,-1,1))}function VPe(t){return Math.asin(sh(t,-1,1))}function md(t,e,i=1e-6){return t===e?!0:!Number.isFinite(t)||!Number.isFinite(e)?!1:(t>e?t-e:e-t)<=i}function Wce(t,e,i=1e-6){return!md(t,e,i)&&t>e}function Bz(t,e,i=1e-6){return!md(t,e,i)&&t<e}function zPe(t,e,i=1e-6){return md(t,e,i)||t>e}const UO=new DataView(new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT));function qz(t){return UO.setFloat64(0,t),UO.getBigInt64(0)}function GPe(t){return UO.setBigInt64(0,t),UO.getFloat64(0)}const MR=BigInt("1000000"),BPe=Zce(1);function Zce(t){const e=qz(t=Math.abs(t)),i=GPe(e<=MR?MR:e-MR);return Math.abs(t-i)}function Yft(t,e,i=BPe){if(t===e)return!0;if(!Number.isFinite(t)||!Number.isFinite(e))return!1;if(i!=null&&Zce(Math.min(Math.abs(t),Math.abs(e)))<i)return Math.abs(t-e)<=i;const s=qz(t),n=qz(e);return s<0!=n<0?!1:!((s<n?n-s:s-n)>MR)}function Xft(t){return Kce(Math.max(-jK,Math.min(t,jK)))}function Kce(t){return HK[0]=t,HK[0]}function Wft(t){const e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[3]*t[3]+t[4]*t[4]+t[5]*t[5],s=t[6]*t[6]+t[7]*t[7]+t[8]*t[8];return!(md(e,1)&&md(i,1)&&md(s,1))}const jK=Kce(34028234663852886e22);function Zft(t,e,i){if(i===void 0||+i==0)return Math[t](e);if(e=+e,i=+i,isNaN(e)||typeof i!="number"||i%1!=0)return NaN;let s=e.toString().split("e");return s=(e=Math[t](+(s[0]+"e"+(s[1]?+s[1]-i:-i)))).toString().split("e"),+(s[0]+"e"+(s[1]?+s[1]+i:i))}function Dl(t=YPe){return[t[0],t[1],t[2],t[3]]}function Qce(t,e){return t!==e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]),t}function Kft(t,e,i,s,n=Dl()){return n[0]=t,n[1]=e,n[2]=i,n[3]=s,n}function Qft(t,e=Dl()){return e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax,e}function qPe(t,e,i=new Nn){return i.xmin=t[0],i.ymin=t[1],i.xmax=t[2],i.ymax=t[3],i.spatialReference=e,i}function Jft(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function egt(t,e,i){if(e!=null)if("length"in e)Hz(e)?(i[0]=Math.min(t[0],e[0]),i[1]=Math.min(t[1],e[1]),i[2]=Math.max(t[2],e[2]),i[3]=Math.max(t[3],e[3])):e.length!==2&&e.length!==3||(i[0]=Math.min(t[0],e[0]),i[1]=Math.min(t[1],e[1]),i[2]=Math.max(t[2],e[0]),i[3]=Math.max(t[3],e[1]));else switch(e.type){case"extent":i[0]=Math.min(t[0],e.xmin),i[1]=Math.min(t[1],e.ymin),i[2]=Math.max(t[2],e.xmax),i[3]=Math.max(t[3],e.ymax);break;case"point":i[0]=Math.min(t[0],e.x),i[1]=Math.min(t[1],e.y),i[2]=Math.max(t[2],e.x),i[3]=Math.max(t[3],e.y)}else Qce(i,t)}function tgt(t,e,i=t){const s=e.length;let n=t[0],r=t[1],o=t[2],a=t[3];for(let l=0;l<s;l++){const u=e[l];n=Math.min(n,u[0]),r=Math.min(r,u[1]),o=Math.max(o,u[0]),a=Math.max(a,u[1])}return i[0]=n,i[1]=r,i[2]=o,i[3]=a,i}function igt(t){for(let e=0;e<4;e++)if(!isFinite(t[e]))return!1;return!0}function kH(t){return t==null||t[0]>=t[2]?0:t[2]-t[0]}function $H(t){return t==null||t[1]>=t[3]?0:t[3]-t[1]}function sgt(t){return kH(t)*$H(t)}function ngt(t,e=[0,0]){return e[0]=(t[0]+t[2])/2,e[1]=(t[1]+t[3])/2,e}function rgt(t){const e=kH(t),i=$H(t);return Math.sqrt(e*e+i*i)}function ogt(t,e){return HPe(t,e.x,e.y)}function HPe(t,e,i){return e>=t[0]&&i>=t[1]&&e<=t[2]&&i<=t[3]}function agt(t,e){return Math.max(e[0],t[0])<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])<=Math.min(e[3],t[3])}function lgt(t,e,i){return Math.max(e[0],t[0])-i<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])-i<=Math.min(e[3],t[3])}function jPe(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}function ugt(t,e,i,s=t){return s[0]=t[0]+e,s[1]=t[1]+i,s[2]=t[2]+e,s[3]=t[3]+i,s}function cgt(t){return t?Qce(t,YK):Dl(YK)}function Hz(t){return t!=null&&t.length===4}function hgt(t,e){return Hz(t)&&Hz(e)?t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]:t===e}const YK=[1/0,1/0,-1/0,-1/0],YPe=[0,0,0,0];function Jce(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function ehe(t){return t.points!==void 0}function the(t){return t.x!==void 0&&t.y!==void 0}function ihe(t){return t.paths!==void 0}function she(t){return t.rings!==void 0}function nhe(t){function e(i,s){return i==null?s:s==null?i:t(i,s)}return e}const j_=nhe(Math.min),Y_=nhe(Math.max);function dgt(t,e){return ihe(e)?nS(t,e.paths,!1,!1):she(e)?nS(t,e.rings,!1,!1):ehe(e)?UH(t,e.points,!1,!1,!1,!1):Jce(e)?rhe(t,e):(the(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.x,t[3]=e.y),t)}function mgt(t){let e,i,s,n;for(t.reset(),e=s=1/0,i=n=-1/0;t.nextPath();){const r=XPe(t);e=Math.min(r[0],e),s=Math.min(r[1],s),i=Math.max(r[2],i),n=Math.max(r[3],n)}return Dl([e,s,i,n])}function XPe(t){let e,i,s,n;for(e=s=1/0,i=n=-1/0;t.nextPoint();)e=Math.min(t.x,e),s=Math.min(t.y,s),i=Math.max(t.x,i),n=Math.max(t.y,n);return Dl([e,s,i,n])}function pgt(t,e){return ihe(e)?nS(t,e.paths,!0,!1):she(e)?nS(t,e.rings,!0,!1):ehe(e)?UH(t,e.points,!0,!1,!0,!1):Jce(e)?rhe(t,e,!0,!1,!0,!1):(the(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.x,t[4]=e.y,t[5]=e.z),t)}function nS(t,e,i,s){const n=i?3:2;if(!e.length||!e[0].length)return null;let r,o,a,l,[u,c]=e[0][0],[h,d]=e[0][0];for(let m=0;m<e.length;m++){const f=e[m];for(let _=0;_<f.length;_++){const v=f[_],[x,w]=v;if(u=j_(u,x),c=j_(c,w),h=Y_(h,x),d=Y_(d,w),i&&v.length>2){const T=v[2];r=j_(r,T),o=Y_(o,T)}if(s&&v.length>n){const T=v[n];a=j_(r,T),l=Y_(o,T)}}}return i?s?(t[0]=u,t[1]=c,t[2]=r,t[3]=a,t[4]=h,t[5]=d,t[6]=o,t[7]=l,t.length=8,t):(t[0]=u,t[1]=c,t[2]=r,t[3]=h,t[4]=d,t[5]=o,t.length=6,t):s?(t[0]=u,t[1]=c,t[2]=a,t[3]=h,t[4]=d,t[5]=l,t.length=6,t):(t[0]=u,t[1]=c,t[2]=h,t[3]=d,t.length=4,t)}function rhe(t,e,i,s,n,r){const o=e.xmin,a=e.xmax,l=e.ymin,u=e.ymax;let c=e.zmin,h=e.zmax,d=e.mmin,m=e.mmax;return n?(c=c||0,h=h||0,r?(d=d||0,m=m||0,t[0]=o,t[1]=l,t[2]=c,t[3]=d,t[4]=a,t[5]=u,t[6]=h,t[7]=m,t):(t[0]=o,t[1]=l,t[2]=c,t[3]=a,t[4]=u,t[5]=h,t)):r?(d=d||0,m=m||0,t[0]=o,t[1]=l,t[2]=d,t[3]=a,t[4]=u,t[5]=m,t):(t[0]=o,t[1]=l,t[2]=a,t[3]=u,t)}function UH(t,e,i,s,n,r){const o=i?3:2,a=s&&r,l=i&&n;if(!e.length||!e[0].length)return null;let u,c,h,d,[m,f]=e[0],[_,v]=e[0];for(let x=0;x<e.length;x++){const w=e[x],[T,C]=w;if(m=j_(m,T),f=j_(f,C),_=Y_(_,T),v=Y_(v,C),l&&w.length>2){const M=w[2];u=j_(u,M),c=Y_(c,M)}if(a&&w.length>o){const M=w[o];h=j_(u,M),d=Y_(c,M)}}return n?(u=u||0,c=c||0,r?(h=h||0,d=d||0,t[0]=m,t[1]=f,t[2]=u,t[3]=h,t[4]=_,t[5]=v,t[6]=c,t[7]=d,t):(t[0]=m,t[1]=f,t[2]=u,t[3]=_,t[4]=v,t[5]=c,t)):r?(h=h||0,d=d||0,t[0]=m,t[1]=f,t[2]=h,t[3]=_,t[4]=v,t[5]=d,t):(t[0]=m,t[1]=f,t[2]=_,t[3]=v,t)}function WPe(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function ZPe(t){return t.points!==void 0}function KPe(t){return t.x!==void 0&&t.y!==void 0}function QPe(t){return t.paths!==void 0}function JPe(t){return t.rings!==void 0}const VH=[];function ohe(t,e,i,s){return{xmin:t,ymin:e,xmax:i,ymax:s}}function ahe(t,e,i,s,n,r){return{xmin:t,ymin:e,zmin:i,xmax:s,ymax:n,zmax:r}}function lhe(t,e,i,s,n,r){return{xmin:t,ymin:e,mmin:i,xmax:s,ymax:n,mmax:r}}function uhe(t,e,i,s,n,r,o,a){return{xmin:t,ymin:e,zmin:i,mmin:s,xmax:n,ymax:r,zmax:o,mmax:a}}function zH(t,e=!1,i=!1){return e?i?uhe(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]):ahe(t[0],t[1],t[2],t[3],t[4],t[5]):i?lhe(t[0],t[1],t[2],t[3],t[4],t[5]):ohe(t[0],t[1],t[2],t[3])}function fgt(t){return t?WPe(t)?t:KPe(t)?tMe(t):JPe(t)?che(t):QPe(t)?hhe(t):ZPe(t)?eMe(t):null:null}function eMe(t){const{hasZ:e,hasM:i,points:s}=t;return zH(UH(VH,s,e??!1,i??!1),e,i)}function tMe(t){const{x:e,y:i,z:s,m:n}=t,r=n!=null;return s!=null?r?uhe(e,i,s,n,e,i,s,n):ahe(e,i,s,e,i,s):r?lhe(e,i,n,e,i,n):ohe(e,i,e,i)}function che(t){const{hasZ:e,hasM:i,rings:s}=t,n=nS(VH,s,e??!1,i??!1);return n?zH(n,e,i):null}function hhe(t){const{hasZ:e,hasM:i,paths:s}=t,n=nS(VH,s,e??!1,i??!1);return n?zH(n,e,i):null}var AR;function XK(t){return!Array.isArray(t[0])}function iMe(t){var e;return typeof((e=t[0])==null?void 0:e[0])=="number"}function sMe(t){var r,o;if(!t)return;let{rings:e,hasM:i,hasZ:s,spatialReference:n}=t;switch(e??(e=[]),iMe(e)&&(e=[e]),(o=(r=e[0])==null?void 0:r[0])==null?void 0:o.length){case 4:s??(s=!0),i??(i=!0);break;case 3:s??(s=i!==!0),i??(i=!s);break;default:s??(s=!1),i??(i=!1)}return n??(n=Ri.WGS84),{...t,hasM:i,hasZ:s,rings:e,spatialReference:n}}let kc=AR=class extends jf{static fromExtent(t){const e=t.clone().normalize(),{spatialReference:i}=t;let s=!1,n=!1;for(const o of e)o.hasZ&&(s=!0),o.hasM&&(n=!0);const r={rings:e.map(o=>{const a=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(s&&o.hasZ){const l=o.zmin+.5*(o.zmax-o.zmin);for(let u=0;u<a.length;u++)a[u].push(l)}if(n&&o.hasM){const l=o.mmin+.5*(o.mmax-o.mmin);for(let u=0;u<a.length;u++)a[u].push(l)}return a}),spatialReference:i};return s&&(r.hasZ=!0),n&&(r.hasM=!0),new AR(r)}constructor(t){super(sMe(t)),this.curveRings=void 0,this.rings=[],this.type="polygon"}get cache(){return this.commitProperty("curveRings"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("rings"),this.commitProperty("spatialReference"),{}}get centroid(){const t=NPe(this);if(!t||isNaN(t[0])||isNaN(t[1])||this.hasZ&&isNaN(t[2]))return null;const e=new ki;return e.x=t[0],e.y=t[1],e.spatialReference=this.spatialReference,this.hasZ&&(e.z=t[2]),e}writeCurveRings(t,e){e.curveRings=be(t)}get extent(){const t=che(this),{spatialReference:e}=this;return t?new Nn({...t,spatialReference:e}):null}get isSelfIntersecting(){return bPe(this.rings)}writeRings(t,e){e.rings=be(this.rings)}addRing(t){if(!t)return;const e=this.rings,i=e.length;if(XK(t)){const s=[];for(let n=0,r=t.length;n<r;n++)s[n]=t[n].toArray();e[i]=s}else e[i]=t.slice();return this.notifyChange("rings"),this}clone(){const t=new AR;return t.spatialReference=this.spatialReference,t.rings=be(this.rings),t.curveRings=be(this.curveRings),t.hasZ=this.hasZ,t.hasM=this.hasM,t}equals(t){if(this===t)return!0;if(t==null)return!1;const e=this.spatialReference,i=t.spatialReference;if(e!=null!=(i!=null)||e!=null&&i!=null&&!e.equals(i)||this.rings.length!==t.rings.length)return!1;const s=([n,r,o,a],[l,u,c,h])=>n===l&&r===u&&(o==null&&c==null||o===c)&&(a==null&&h==null||a===h);for(let n=0;n<this.rings.length;n++){const r=this.rings[n],o=t.rings[n];if(!mF(r,o,s))return!1}return!0}contains(t){if(!t)return!1;const e=DF(t,this.spatialReference);return LH(this,e??t)}isClockwise(t){const e=XK(t)?t.map(i=>this.hasZ?this.hasM?[i.x,i.y,i.z,i.m]:[i.x,i.y,i.z]:[i.x,i.y]):t;return Hce(e)}getPoint(t,e){if(!this._validateInputs(t,e))return null;const i=this.rings[t][e],s=this.hasZ,n=this.hasM;return s&&!n?new ki(i[0],i[1],i[2],void 0,this.spatialReference):n&&!s?new ki(i[0],i[1],void 0,i[2],this.spatialReference):s&&n?new ki(i[0],i[1],i[2],i[3],this.spatialReference):new ki(i[0],i[1],this.spatialReference)}insertPoint(t,e,i){return this._validateInputs(t,e,!0)?(sS(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[t].splice(e,0,i),this.notifyChange("rings"),this):this}removePoint(t,e){if(!this._validateInputs(t,e))return null;const i=new ki(this.rings[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("rings"),i}removeRing(t){if(!this._validateInputs(t,null))return null;const e=this.rings.splice(t,1)[0],i=this.spatialReference,s=e.map(n=>new ki(n,i));return this.notifyChange("rings"),s}setPoint(t,e,i){return this._validateInputs(t,e)?(sS(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[t][e]=i,this.notifyChange("rings"),this):this}_validateInputs(t,e,i=!1){if(t==null||t<0||t>=this.rings.length)return!1;if(e!=null){const s=this.rings[t];if(i&&(e<0||e>s.length)||!i&&(e<0||e>=s.length))return!1}return!0}toJSON(t){return this.write({},t)}};y([S({readOnly:!0})],kc.prototype,"cache",null),y([S({readOnly:!0})],kc.prototype,"centroid",null),y([S({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],kc.prototype,"curveRings",void 0),y([yt("curveRings")],kc.prototype,"writeCurveRings",null),y([S({readOnly:!0})],kc.prototype,"extent",null),y([S({readOnly:!0})],kc.prototype,"isSelfIntersecting",null),y([S({type:[[[Number]]],json:{write:{isRequired:!0}}})],kc.prototype,"rings",void 0),y([yt("rings")],kc.prototype,"writeRings",null),kc=AR=y([se("esri.geometry.Polygon")],kc);const Na=kc;kc.prototype.toJSON.isDefaultToJSON=!0;var jz;function nMe(t){return!Array.isArray(t[0])}function rMe(t){var e;return typeof((e=t[0])==null?void 0:e[0])=="number"}function oMe(t){var r,o;if(!t)return;let{paths:e,hasM:i,hasZ:s,spatialReference:n}=t;switch(e??(e=[]),rMe(e)&&(e=[e]),(o=(r=e[0])==null?void 0:r[0])==null?void 0:o.length){case 4:s??(s=!0),i??(i=!0);break;case 3:s??(s=i!==!0),i??(i=!s);break;default:s??(s=!1),i??(i=!1)}return n??(n=Ri.WGS84),{...t,hasM:i,hasZ:s,paths:e,spatialReference:n}}let hm=jz=class extends jf{constructor(t){super(oMe(t)),this.curvePaths=void 0,this.paths=[],this.type="polyline"}get cache(){return this.commitProperty("curvePaths"),this.commitProperty("hasM"),this.commitProperty("hasZ"),this.commitProperty("paths"),this.commitProperty("spatialReference"),{}}writeCurvePaths(t,e){e.curvePaths=be(t)}get extent(){const t=hhe(this),{spatialReference:e}=this;return t?new Nn({...t,spatialReference:e}):null}writePaths(t,e){e.paths=be(this.paths)}addPath(t){if(!t)return;const e=this.paths,i=e.length;if(nMe(t)){const s=[];for(let n=0,r=t.length;n<r;n++)s[n]=t[n].toArray();e[i]=s}else e[i]=t.slice();return this.notifyChange("paths"),this}clone(){const t=new jz;return t.spatialReference=this.spatialReference,t.paths=be(this.paths),t.curvePaths=be(this.curvePaths),t.hasZ=this.hasZ,t.hasM=this.hasM,t}getPoint(t,e){if(!this._validateInputs(t,e))return null;const i=this.paths[t][e],s=this.hasZ,n=this.hasM;return s&&!n?new ki(i[0],i[1],i[2],void 0,this.spatialReference):n&&!s?new ki(i[0],i[1],void 0,i[2],this.spatialReference):s&&n?new ki(i[0],i[1],i[2],i[3],this.spatialReference):new ki(i[0],i[1],this.spatialReference)}insertPoint(t,e,i){return this._validateInputs(t,e,!0)?(sS(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[t].splice(e,0,i),this.notifyChange("paths"),this):this}removePath(t){if(!this._validateInputs(t,null))return null;const e=this.paths.splice(t,1)[0],i=this.spatialReference,s=e.map(n=>new ki(n,i));return this.notifyChange("paths"),s}removePoint(t,e){if(!this._validateInputs(t,e))return null;const i=new ki(this.paths[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("paths"),i}setPoint(t,e,i){return this._validateInputs(t,e)?(sS(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[t][e]=i,this.notifyChange("paths"),this):this}_validateInputs(t,e,i=!1){if(t==null||t<0||t>=this.paths.length)return!1;if(e!=null){const s=this.paths[t];if(i&&(e<0||e>s.length)||!i&&(e<0||e>=s.length))return!1}return!0}toJSON(t){return this.write({},t)}};y([S({readOnly:!0})],hm.prototype,"cache",null),y([S({json:{write:!0,origins:{"portal-item":{write:!1},"web-map":{write:!1},"web-scene":{write:!1}}}})],hm.prototype,"curvePaths",void 0),y([yt("curvePaths")],hm.prototype,"writeCurvePaths",null),y([S({readOnly:!0})],hm.prototype,"extent",null),y([S({type:[[[Number]]],json:{write:{isRequired:!0}}})],hm.prototype,"paths",void 0),y([yt("paths")],hm.prototype,"writePaths",null),hm=jz=y([se("esri.geometry.Polyline")],hm);const gu=hm;hm.prototype.toJSON.isDefaultToJSON=!0;const Mm=ki,fy=Na,CP=gu,aMe=Ri;var Zr=(t=>(t[t.None=0]="None",t[t.Line=1]="Line",t[t.Polygon=2]="Polygon",t[t.AnchorPoint=3]="AnchorPoint",t[t.EndPoint=4]="EndPoint",t[t.Vertex=5]="Vertex",t[t.Edge=6]="Edge",t[t.Boundary=7]="Boundary",t[t.Compass=8]="Compass",t))(Zr||{});class Lv{}Lt(Lv,"Empty","empty"),Lt(Lv,"Line","line"),Lt(Lv,"Rect","rect"),Lt(Lv,"Polygon","polygon");class Pa{}Lt(Pa,"LineBuilder","LineBuilder"),Lt(Pa,"RectBuilder","RectBuilder"),Lt(Pa,"PolygonBuilder","PolygonBuilder"),Lt(Pa,"RectTransformer","RectTransformer"),Lt(Pa,"RectResizer","RectResizer");var dr=(t=>(t[t.None=0]="None",t[t.DrawLine=1]="DrawLine",t[t.DrawRect=2]="DrawRect",t[t.DrawPolygon=3]="DrawPolygon",t[t.TransformRect=4]="TransformRect",t[t.ResizeRect=5]="ResizeRect",t))(dr||{});class dhe{}Lt(dhe,"graphicsLayerName","Frank");const mhe=t=>{let e=class extends t{clone(){var l;const i=Su(this);Sue(i,"unable to clone instance of non-accessor class");const s=i.metadata,n=i.store,r={},o=new Map;for(const u in s){const c=s[u],h=n==null?void 0:n.originOf(u),d=c.clonable;if(c.readOnly||d===!1||h!==ds.USER&&h!==ds.DEFAULTS&&h!==ds.WEB_MAP&&h!==ds.WEB_SCENE)continue;const m=this[u];let f=null;f=typeof d=="function"?d(m):d==="reference"?m:rz(m),m!=null&&f==null||(h===ds.DEFAULTS?o.set(u,f):r[u]=f)}const a=new(Object.getPrototypeOf(this)).constructor(r);if(o.size){const u=(l=Su(a))==null?void 0:l.store;if(u)for(const[c,h]of o)u.set(c,h,ds.DEFAULTS)}return a}};return e=y([se("esri.core.Clonable")],e),e};let fC=class extends mhe(ei){};fC=y([se("esri.core.Clonable")],fC),function(t){t.ClonableMixin=mhe}(fC||(fC={}));const bs=fC;let vd=class phe{constructor(){this._emitter=new phe.EventEmitter(this)}emit(e,i){return this._emitter.emit(e,i)}on(e,i){return this._emitter.on(e,i)}once(e,i){return this._emitter.once(e,i)}hasEventListener(e){return this._emitter.hasEventListener(e)}};(function(t){class e{constructor(n=null){this._target=n,this._listenersMap=null}clear(){var n;(n=this._listenersMap)==null||n.clear(),this._listenersMap=null}destroy(){this.clear()}emit(n,r){var u;let o=(u=this._listenersMap)==null?void 0:u.get(n);if(!o)return!1;const a=this._target||this;let l=!1;for(const c of o.slice()){const h="deref"in c?c.deref():c;h?h==null||h.call(a,r):l=!0}return l&&(o=o.filter(c=>!("deref"in c)||c.deref()!=null),this._listenersMap.set(n,o)),o.length>0}on(n,r){if(Array.isArray(n)){const a=n.map(l=>this.on(l,r));return LM(a)}if(n.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap??(this._listenersMap=new Map);const o=this._listenersMap.get(n)||[];return o.push(r),this._listenersMap.set(n,o),Gs(()=>{var u;const a=(u=this._listenersMap)==null?void 0:u.get(n),l=(a==null?void 0:a.indexOf(r))??-1;l>=0&&a.splice(l,1)})}once(n,r){const o=this.on(n,a=>{o.remove();const l="deref"in r?r.deref():r;l==null||l.call(null,a)});return o}hasEventListener(n){var o;const r=(o=this._listenersMap)==null?void 0:o.get(n);return r!=null&&r.length>0}}t.EventEmitter=e,t.EventedMixin=s=>{let n=class extends s{constructor(){super(...arguments),this._emitter=new e}destroy(){this._emitter.clear()}emit(r,o){return this._emitter.emit(r,o)}on(r,o){return this._emitter.on(r,o)}once(r,o){return this._emitter.once(r,o)}hasEventListener(r){return this._emitter.hasEventListener(r)}};return n=y([se("esri.core.Evented")],n),n};let i=class extends ei{constructor(){super(...arguments),this._emitter=new vd.EventEmitter(this)}destroy(){this._emitter.clear()}emit(s,n){return this._emitter.emit(s,n)}on(s,n){return this._emitter.on(s,n)}once(s,n){return this._emitter.once(s,n)}hasEventListener(s){return this._emitter.hasEventListener(s)}};i=y([se("esri.core.Evented.EventedAccessor")],i),t.EventedAccessor=i})(vd);var Xs;(function(t){t[t.ADD=1]="ADD",t[t.REMOVE=2]="REMOVE",t[t.MOVE=4]="MOVE"})(Xs||(Xs={}));function GH(t){return(e,i)=>{e[i]=t}}let HM=class extends Eue{notify(){const e=this._observers;if(e&&e.length>0){const i=e.slice();for(const s of i)s.onInvalidated(),s.onCommitted()}}};var df;let lMe=class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(e){this.defaultPrevented=!1,this.item=e}},uMe=class{constructor(e,i,s,n,r){this.target=e,this.added=i,this.removed=s,this.start=n,this.deleteCount=r}};const Tc=new F1(lMe,void 0,t=>{t.item=null,t.target=null,t.defaultPrevented=!1,t.cancellable=!1});function WK(t){t&&typeof t=="object"&&"destroy"in t&&typeof t.destroy=="function"&&t.destroy()}function lU(t){return t?t instanceof of?t.toArray():t.length?Array.prototype.slice.apply(t):[]:[]}function uU(t){if(t!=null&&t.length)return t[0]}function cMe(t,e,i,s){const n=Math.min(t.length-i,e.length-s);let r=0;for(;r<n&&t[i+r]===e[s+r];)r++;return r}function fhe(t,e,i,s){e&&e.forEach((n,r,o)=>{t.push(n),fhe(t,i.call(s,n,r,o),i,s)})}const Fg=new Set,kg=new Set,$g=new Set,cU=new Map;let hMe=0,of=df=class extends vd.EventedAccessor{static isCollection(t){return t!=null&&t instanceof df}constructor(t){super(t),this._chgListeners=[],this._notifications=null,this._updating=!1,this._timer=null,this._observable=new HM,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:hMe++})}normalizeCtorArgs(t){return t?Array.isArray(t)||t instanceof df?{items:t}:t:{}}destroy(){this._removeAllRaw(),this._timer&&this._timer.remove(),this._emitter.destroy(),this._notifications=null}*[Symbol.iterator](){yield*this.items}get items(){return fi(this._observable),this._items}set items(t){this._emitBeforeChanges(Xs.ADD)||(this._splice(0,this.length,lU(t)),this._emitAfterChanges(Xs.ADD))}hasEventListener(t){return!this.destroyed&&(t==="change"?this._chgListeners.length>0:this._emitter.hasEventListener(t))}on(t,e){if(this.destroyed)return Gs();if(t==="change"){const i=this._chgListeners,s={removed:!1,callback:e};return i.push(s),this._notifications&&this._notifications.push({listeners:i.slice(),items:this._items.slice(),changes:[]}),Gs(()=>{s.removed=!0,i.splice(i.indexOf(s),1)})}return this._emitter.on(t,e)}once(t,e){const i="deref"in e?()=>e.deref():()=>e,s=this.on(t,n=>{var r;(r=i())==null||r.call(null,n),s.remove()});return s}add(t,e){if(fi(this._observable),this._emitBeforeChanges(Xs.ADD))return this;const i=this.getNextIndex(e??null);return this._splice(i,0,[t]),this._emitAfterChanges(Xs.ADD),this}addMany(t,e=this._items.length){if(fi(this._observable),!(t!=null&&t.length))return this;if(this._emitBeforeChanges(Xs.ADD))return this;const i=this.getNextIndex(e);return this._splice(i,0,lU(t)),this._emitAfterChanges(Xs.ADD),this}at(t){if(fi(this._observable),(t=Math.trunc(t)||0)<0&&(t+=this.length),!(t<0||t>=this.length))return this._items[t]}removeAll(){if(fi(this._observable),!this.length||this._emitBeforeChanges(Xs.REMOVE))return[];const t=this._removeAllRaw();return this._emitAfterChanges(Xs.REMOVE),t}_removeAllRaw(){return this.length===0?[]:this._splice(0,this.length)||[]}clone(){return fi(this._observable),this._createNewInstance({items:this._items.map(be)})}concat(...t){fi(this._observable);const e=t.map(lU);return this._createNewInstance({items:this._items.concat(...e)})}drain(t,e){if(fi(this._observable),!this.length||this._emitBeforeChanges(Xs.REMOVE))return;const i=this._splice(0,this.length),s=i.length;for(let n=0;n<s;n++)t.call(e,i[n],n,i);this._emitAfterChanges(Xs.REMOVE)}destroyAll(){this.drain(WK)}destroyMany(t){const e=this.removeMany(t);return e.forEach(WK),e}every(t,e){return fi(this._observable),this._items.every(t,e)}filter(t,e){fi(this._observable);const i=arguments.length===2?this._items.filter(t,e):this._items.filter(t);return this._createNewInstance({items:i})}find(t,e){return fi(this._observable),this._items.find(t,e)}findIndex(t,e){return fi(this._observable),this._items.findIndex(t,e)}flatten(t,e){fi(this._observable);const i=[];return fhe(i,this,t,e),new df(i)}forEach(t,e){return fi(this._observable),this._items.forEach(t,e)}getItemAt(t){return fi(this._observable),this._items[t]}getNextIndex(t){fi(this._observable);const e=this.length;return(t=t??e)<0?t=0:t>e&&(t=e),t}includes(t,e=0){return fi(this._observable),this._items.includes(t,e)}indexOf(t,e=0){return fi(this._observable),this._items.indexOf(t,e)}join(t=","){return fi(this._observable),this._items.join(t)}lastIndexOf(t,e=this.length-1){return fi(this._observable),this._items.lastIndexOf(t,e)}map(t,e){fi(this._observable);const i=this._items.map(t,e);return new df({items:i})}reorder(t,e=this.length-1){fi(this._observable);const i=this.indexOf(t);if(i!==-1){if(e<0?e=0:e>=this.length&&(e=this.length-1),i!==e){if(this._emitBeforeChanges(Xs.MOVE))return t;this._splice(i,1),this._splice(e,0,[t]),this._emitAfterChanges(Xs.MOVE)}return t}}pop(){if(fi(this._observable),!this.length||this._emitBeforeChanges(Xs.REMOVE))return;const t=uU(this._splice(this.length-1,1));return this._emitAfterChanges(Xs.REMOVE),t}push(...t){return fi(this._observable),this._emitBeforeChanges(Xs.ADD)||(this._splice(this.length,0,t),this._emitAfterChanges(Xs.ADD)),this.length}reduce(t,e){fi(this._observable);const i=this._items;return arguments.length===2?i.reduce(t,e):i.reduce(t)}reduceRight(t,e){fi(this._observable);const i=this._items;return arguments.length===2?i.reduceRight(t,e):i.reduceRight(t)}remove(t){return fi(this._observable),this.removeAt(this.indexOf(t))}removeAt(t){if(fi(this._observable),t<0||t>=this.length||this._emitBeforeChanges(Xs.REMOVE))return;const e=uU(this._splice(t,1));return this._emitAfterChanges(Xs.REMOVE),e}removeMany(t){if(fi(this._observable),!(t!=null&&t.length)||this._emitBeforeChanges(Xs.REMOVE))return[];const e=t instanceof df?t.toArray():t,i=this._items,s=[],n=e.length;for(let r=0;r<n;r++){const o=e[r],a=i.indexOf(o);if(a>-1){const l=1+cMe(e,i,r+1,a+1),u=this._splice(a,l);u&&u.length>0&&s.push.apply(s,u),r+=l-1}}return this._emitAfterChanges(Xs.REMOVE),s}reverse(){if(fi(this._observable),this._emitBeforeChanges(Xs.MOVE))return this;const t=this._splice(0,this.length);return t&&(t.reverse(),this._splice(0,0,t)),this._emitAfterChanges(Xs.MOVE),this}shift(){if(fi(this._observable),!this.length||this._emitBeforeChanges(Xs.REMOVE))return;const t=uU(this._splice(0,1));return this._emitAfterChanges(Xs.REMOVE),t}slice(t=0,e=this.length){return fi(this._observable),this._createNewInstance({items:this._items.slice(t,e)})}some(t,e){return fi(this._observable),this._items.some(t,e)}sort(t){if(fi(this._observable),!this.length||this._emitBeforeChanges(Xs.MOVE)||!this._requiresSort(t))return this;const e=this._splice(0,this.length);return arguments.length?e.sort(t):e.sort(),this._splice(0,0,e),this._emitAfterChanges(Xs.MOVE),this}_requiresSort(t=(e,i)=>e===i?0:e<i?-1:1){const e=this.length-1;for(let i=0;i<e;i++)if(t(this.items[i],this.items[i+1])>0)return!0;return!1}splice(t,e,...i){fi(this._observable);const s=(e?Xs.REMOVE:0)|(i.length?Xs.ADD:0);if(this._emitBeforeChanges(s))return[];const n=this._splice(t,e,i)||[];return this._emitAfterChanges(s),n}toArray(){return fi(this._observable),this._items.slice()}toJSON(){return fi(this._observable),this.toArray()}toLocaleString(){return fi(this._observable),this._items.toLocaleString()}toString(){return fi(this._observable),this._items.toString()}unshift(...t){return fi(this._observable),!t.length||this._emitBeforeChanges(Xs.ADD)||(this._splice(0,0,t),this._emitAfterChanges(Xs.ADD)),this.length}_createNewInstance(t){return new this.constructor(t)}_splice(t,e,i){const s=this._items,n=this.itemType;let r,o;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._updating=!0,this._timer=VM(()=>this._dispatchChange())),t<0&&(t+=this.length),e){if(o=s.splice(t,e),this.hasEventListener("before-remove")){const a=Tc.acquire();a.target=this,a.cancellable=!0;for(let l=0,u=o.length;l<u;l++)r=o[l],a.reset(r),this.emit("before-remove",a),a.defaultPrevented&&(o.splice(l,1),s.splice(t,0,r),t+=1,l-=1,u-=1);Tc.release(a)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const a=Tc.acquire();a.target=this,a.cancellable=!1;const l=o.length;for(let u=0;u<l;u++)a.reset(o[u]),this.emit("after-remove",a);Tc.release(a)}}if(i!=null&&i.length){if(n){const c=[];for(const h of i){const d=n.ensureType(h);d==null&&h!=null||c.push(d)}i=c}const a=this.hasEventListener("before-add"),l=this.hasEventListener("after-add"),u=t===this.length;if(a||l){const c=Tc.acquire();c.target=this,c.cancellable=!0;const h=Tc.acquire();h.target=this,h.cancellable=!1;for(const d of i)a?(c.reset(d),this.emit("before-add",c),c.defaultPrevented||(u?s.push(d):s.splice(t++,0,d),this._set("length",s.length),l&&(h.reset(d),this.emit("after-add",h)))):(u?s.push(d):s.splice(t++,0,d),this._set("length",s.length),h.reset(d),this.emit("after-add",h));Tc.release(h),Tc.release(c)}else{if(u)for(const c of i)s.push(c);else s.splice(t,0,...i);this._set("length",s.length)}}if((i!=null&&i.length||o!=null&&o.length)&&this._notifyChangeEvent(i,o),this.hasEventListener("after-splice")){const a=new uMe(this,i,o,t,e);this.emit("after-splice",a)}return o}_emitBeforeChanges(t){let e=!1;if(this.hasEventListener("before-changes")){const i=Tc.acquire();i.target=this,i.cancellable=!0,i.type=t,this.emit("before-changes",i),e=i.defaultPrevented,Tc.release(i)}return e}_emitAfterChanges(t){if(this.hasEventListener("after-changes")){const e=Tc.acquire();e.target=this,e.cancellable=!1,e.type=t,this.emit("after-changes",e),Tc.release(e)}this._observable.notify()}_notifyChangeEvent(t,e){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:t,removed:e})}get updating(){return this._updating}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),this._updating=!1,!this._notifications)return;const t=this._notifications;this._notifications=null;for(const e of t){const i=e.changes;Fg.clear(),kg.clear(),$g.clear();for(const{added:l,removed:u}of i){if(l)if($g.size===0&&kg.size===0)for(const c of l)Fg.add(c);else for(const c of l)kg.has(c)?($g.add(c),kg.delete(c)):$g.has(c)||Fg.add(c);if(u)if($g.size===0&&Fg.size===0)for(const c of u)kg.add(c);else for(const c of u)Fg.has(c)?Fg.delete(c):($g.delete(c),kg.add(c))}const s=Il.acquire();Fg.forEach(l=>{s.push(l)});const n=Il.acquire();kg.forEach(l=>{n.push(l)});const r=this._items,o=e.items,a=Il.acquire();if($g.forEach(l=>{o.indexOf(l)!==r.indexOf(l)&&a.push(l)}),e.listeners&&(s.length||n.length||a.length)){const l={target:this,added:s,removed:n,moved:a},u=e.listeners.length;for(let c=0;c<u;c++){const h=e.listeners[c];h.removed||h.callback.call(this,l)}}Il.release(s),Il.release(n),Il.release(a)}Fg.clear(),kg.clear(),$g.clear()}};of.ofType=t=>{if(!t)return df;if(cU.has(t))return cU.get(t);let e=null;if(typeof t=="function")e=t.prototype.declaredClass;else if(t.base)e=t.base.prototype.declaredClass;else for(const s in t.typeMap){const n=t.typeMap[s].prototype.declaredClass;e?e+=` | ${n}`:e=n}let i=class extends df{};return y([GH({Type:t,ensureType:typeof t=="function"?xo(t):_d(t)})],i.prototype,"itemType",void 0),i=y([se(`esri.core.Collection<${e}>`)],i),cU.set(t,i),i},y([S()],of.prototype,"_updating",void 0),y([S()],of.prototype,"length",void 0),y([S()],of.prototype,"items",null),y([S({readOnly:!0})],of.prototype,"updating",null),of=df=y([se("esri.core.Collection")],of);const Nt=of;let hU;async function dMe(){return hU==null&&(hU=_e(()=>import("./WhereClauseCache-COsvhKay.js"),__vite__mapDeps([4,5,6])).then(t=>new t.WhereClauseCache(500,500))),hU}async function ghe(t,e){const i=await dMe(),s=i.get(t,e);if(s==null)throw i.getError(t,e);return s}function mMe(t,e){return t||(t=null),e||(e=null),t==="1=1"?e??t:e==="1=1"?t??e:t&&e?`(${t}) AND (${e})`:t??e}function pMe(t,e){return t||(t=null),e||(e=null),t==="1=1"||e==="1=1"||t===e?t==="1=1"?t:e:t&&e?`(${t}) OR (${e})`:t??e}function xgt(t,e){return e.length===0?null:`${t} IN (${fMe(e)})`}function fMe(t){return t.map(e=>typeof e=="string"?gMe(e):e).join(",")}function gMe(t){return`'${t.replaceAll("'","''")}'`}function ZK(t){return typeof t=="number"}function bgt(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}function wgt(t){return typeof t=="boolean"}function jM(t){return typeof t=="string"||t instanceof String}function _Me(t){return t==null||jM(t)}function Sgt(t){return Array.isArray(t)}function yMe(t){return(t==null?void 0:t.declaredClass)==="esri.Graphic"}function Egt(t){return t instanceof Date}class U1 extends Error{}class vMe extends U1{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}}class xMe extends U1{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}}class bMe extends U1{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}}class ow extends U1{}class _he extends U1{constructor(e){super(`Invalid unit ${e}`)}}class Qa extends U1{}class Ug extends U1{constructor(){super("Zone is an abstract class")}}const Ut="numeric",xd="short",cc="long",VO={year:Ut,month:Ut,day:Ut},yhe={year:Ut,month:xd,day:Ut},wMe={year:Ut,month:xd,day:Ut,weekday:xd},vhe={year:Ut,month:cc,day:Ut},xhe={year:Ut,month:cc,day:Ut,weekday:cc},bhe={hour:Ut,minute:Ut},whe={hour:Ut,minute:Ut,second:Ut},She={hour:Ut,minute:Ut,second:Ut,timeZoneName:xd},Ehe={hour:Ut,minute:Ut,second:Ut,timeZoneName:cc},Che={hour:Ut,minute:Ut,hourCycle:"h23"},The={hour:Ut,minute:Ut,second:Ut,hourCycle:"h23"},Phe={hour:Ut,minute:Ut,second:Ut,hourCycle:"h23",timeZoneName:xd},Mhe={hour:Ut,minute:Ut,second:Ut,hourCycle:"h23",timeZoneName:cc},Ahe={year:Ut,month:Ut,day:Ut,hour:Ut,minute:Ut},Ihe={year:Ut,month:Ut,day:Ut,hour:Ut,minute:Ut,second:Ut},Dhe={year:Ut,month:xd,day:Ut,hour:Ut,minute:Ut},Nhe={year:Ut,month:xd,day:Ut,hour:Ut,minute:Ut,second:Ut},SMe={year:Ut,month:xd,day:Ut,weekday:xd,hour:Ut,minute:Ut},Rhe={year:Ut,month:cc,day:Ut,hour:Ut,minute:Ut,timeZoneName:xd},Ohe={year:Ut,month:cc,day:Ut,hour:Ut,minute:Ut,second:Ut,timeZoneName:xd},Lhe={year:Ut,month:cc,day:Ut,weekday:cc,hour:Ut,minute:Ut,timeZoneName:cc},Fhe={year:Ut,month:cc,day:Ut,weekday:cc,hour:Ut,minute:Ut,second:Ut,timeZoneName:cc};class V1{get type(){throw new Ug}get name(){throw new Ug}get ianaName(){return this.name}get isUniversal(){throw new Ug}offsetName(e,i){throw new Ug}formatOffset(e,i){throw new Ug}offset(e){throw new Ug}equals(e){throw new Ug}get isValid(){throw new Ug}}let dU=null;class OF extends V1{static get instance(){return dU===null&&(dU=new OF),dU}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:i,locale:s}){return Hhe(e,i,s)}formatOffset(e,i){return UT(this.offset(e),i)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}}let IR={};function EMe(t){return IR[t]||(IR[t]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),IR[t]}const CMe={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function TMe(t,e){const i=t.format(e).replace(/\u200E/g,""),s=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(i),[,n,r,o,a,l,u,c]=s;return[o,n,r,a,l,u,c]}function PMe(t,e){const i=t.formatToParts(e),s=[];for(let n=0;n<i.length;n++){const{type:r,value:o}=i[n],a=CMe[r];r==="era"?s[a]=o:Ji(a)||(s[a]=parseInt(o,10))}return s}let fD={};class Eu extends V1{static create(e){return fD[e]||(fD[e]=new Eu(e)),fD[e]}static resetCache(){fD={},IR={}}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=Eu.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:i,locale:s}){return Hhe(e,i,s,this.name)}formatOffset(e,i){return UT(this.offset(e),i)}offset(e){const i=new Date(e);if(isNaN(i))return NaN;const s=EMe(this.name);let[n,r,o,a,l,u,c]=s.formatToParts?PMe(s,i):TMe(s,i);a==="BC"&&(n=-Math.abs(n)+1);const d=FF({year:n,month:r,day:o,hour:l===24?0:l,minute:u,second:c,millisecond:0});let m=+i;const f=m%1e3;return m-=f>=0?f:1e3+f,(d-m)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}}let KK={};function MMe(t,e={}){const i=JSON.stringify([t,e]);let s=KK[i];return s||(s=new Intl.ListFormat(t,e),KK[i]=s),s}let Yz={};function Xz(t,e={}){const i=JSON.stringify([t,e]);let s=Yz[i];return s||(s=new Intl.DateTimeFormat(t,e),Yz[i]=s),s}let Wz={};function AMe(t,e={}){const i=JSON.stringify([t,e]);let s=Wz[i];return s||(s=new Intl.NumberFormat(t,e),Wz[i]=s),s}let Zz={};function IMe(t,e={}){const{base:i,...s}=e,n=JSON.stringify([t,s]);let r=Zz[n];return r||(r=new Intl.RelativeTimeFormat(t,e),Zz[n]=r),r}let gC=null;function DMe(){return gC||(gC=new Intl.DateTimeFormat().resolvedOptions().locale,gC)}let QK={};function NMe(t){let e=QK[t];if(!e){const i=new Intl.Locale(t);e="getWeekInfo"in i?i.getWeekInfo():i.weekInfo,QK[t]=e}return e}function RMe(t){const e=t.indexOf("-x-");e!==-1&&(t=t.substring(0,e));const i=t.indexOf("-u-");if(i===-1)return[t];{let s,n;try{s=Xz(t).resolvedOptions(),n=t}catch{const l=t.substring(0,i);s=Xz(l).resolvedOptions(),n=l}const{numberingSystem:r,calendar:o}=s;return[n,r,o]}}function OMe(t,e,i){return(i||e)&&(t.includes("-u-")||(t+="-u"),i&&(t+=`-ca-${i}`),e&&(t+=`-nu-${e}`)),t}function LMe(t){const e=[];for(let i=1;i<=12;i++){const s=ui.utc(2009,i,1);e.push(t(s))}return e}function FMe(t){const e=[];for(let i=1;i<=7;i++){const s=ui.utc(2016,11,13+i);e.push(t(s))}return e}function gD(t,e,i,s){const n=t.listingMode();return n==="error"?null:n==="en"?i(e):s(e)}function kMe(t){return t.numberingSystem&&t.numberingSystem!=="latn"?!1:t.numberingSystem==="latn"||!t.locale||t.locale.startsWith("en")||new Intl.DateTimeFormat(t.intl).resolvedOptions().numberingSystem==="latn"}class $Me{constructor(e,i,s){this.padTo=s.padTo||0,this.floor=s.floor||!1;const{padTo:n,floor:r,...o}=s;if(!i||Object.keys(o).length>0){const a={useGrouping:!1,...s};s.padTo>0&&(a.minimumIntegerDigits=s.padTo),this.inf=AMe(e,a)}}format(e){if(this.inf){const i=this.floor?Math.floor(e):e;return this.inf.format(i)}else{const i=this.floor?Math.floor(e):YH(e,3);return po(i,this.padTo)}}}class UMe{constructor(e,i,s){this.opts=s,this.originalZone=void 0;let n;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){const o=-1*(e.offset/60),a=o>=0?`Etc/GMT+${o}`:`Etc/GMT${o}`;e.offset!==0&&Eu.create(a).valid?(n=a,this.dt=e):(n="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,n=e.zone.name):(n="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);const r={...this.opts};r.timeZone=r.timeZone||n,this.dtf=Xz(i,r)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(i=>{if(i.type==="timeZoneName"){const s=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...i,value:s}}else return i}):e}resolvedOptions(){return this.dtf.resolvedOptions()}}class VMe{constructor(e,i,s){this.opts={style:"long",...s},!i&&Bhe()&&(this.rtf=IMe(e,s))}format(e,i){return this.rtf?this.rtf.format(e,i):uAe(i,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,i){return this.rtf?this.rtf.formatToParts(e,i):[]}}const zMe={firstDay:1,minimalDays:4,weekend:[6,7]};class fn{static fromOpts(e){return fn.create(e.locale,e.numberingSystem,e.outputCalendar,e.weekSettings,e.defaultToEN)}static create(e,i,s,n,r=!1){const o=e||Vr.defaultLocale,a=o||(r?"en-US":DMe()),l=i||Vr.defaultNumberingSystem,u=s||Vr.defaultOutputCalendar,c=Kz(n)||Vr.defaultWeekSettings;return new fn(a,l,u,c,o)}static resetCache(){gC=null,Yz={},Wz={},Zz={}}static fromObject({locale:e,numberingSystem:i,outputCalendar:s,weekSettings:n}={}){return fn.create(e,i,s,n)}constructor(e,i,s,n,r){const[o,a,l]=RMe(e);this.locale=o,this.numberingSystem=i||a||null,this.outputCalendar=s||l||null,this.weekSettings=n,this.intl=OMe(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=r,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=kMe(this)),this.fastNumbersCached}listingMode(){const e=this.isEnglish(),i=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&i?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:fn.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,Kz(e.weekSettings)||this.weekSettings,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone({...e,defaultToEN:!0})}redefaultToSystem(e={}){return this.clone({...e,defaultToEN:!1})}months(e,i=!1){return gD(this,e,Xhe,()=>{const s=i?{month:e,day:"numeric"}:{month:e},n=i?"format":"standalone";return this.monthsCache[n][e]||(this.monthsCache[n][e]=LMe(r=>this.extract(r,s,"month"))),this.monthsCache[n][e]})}weekdays(e,i=!1){return gD(this,e,Khe,()=>{const s=i?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},n=i?"format":"standalone";return this.weekdaysCache[n][e]||(this.weekdaysCache[n][e]=FMe(r=>this.extract(r,s,"weekday"))),this.weekdaysCache[n][e]})}meridiems(){return gD(this,void 0,()=>Qhe,()=>{if(!this.meridiemCache){const e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[ui.utc(2016,11,13,9),ui.utc(2016,11,13,19)].map(i=>this.extract(i,e,"dayperiod"))}return this.meridiemCache})}eras(e){return gD(this,e,Jhe,()=>{const i={era:e};return this.eraCache[e]||(this.eraCache[e]=[ui.utc(-40,1,1),ui.utc(2017,1,1)].map(s=>this.extract(s,i,"era"))),this.eraCache[e]})}extract(e,i,s){const n=this.dtFormatter(e,i),r=n.formatToParts(),o=r.find(a=>a.type.toLowerCase()===s);return o?o.value:null}numberFormatter(e={}){return new $Me(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,i={}){return new UMe(e,this.intl,i)}relFormatter(e={}){return new VMe(this.intl,this.isEnglish(),e)}listFormatter(e={}){return MMe(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:qhe()?NMe(this.locale):zMe}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}toString(){return`Locale(${this.locale}, ${this.numberingSystem}, ${this.outputCalendar})`}}let mU=null;class ra extends V1{static get utcInstance(){return mU===null&&(mU=new ra(0)),mU}static instance(e){return e===0?ra.utcInstance:new ra(e)}static parseSpecifier(e){if(e){const i=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(i)return new ra(kF(i[1],i[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${UT(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${UT(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,i){return UT(this.fixed,i)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}}class GMe extends V1{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function z_(t,e){if(Ji(t)||t===null)return e;if(t instanceof V1)return t;if(XMe(t)){const i=t.toLowerCase();return i==="default"?e:i==="local"||i==="system"?OF.instance:i==="utc"||i==="gmt"?ra.utcInstance:ra.parseSpecifier(i)||Eu.create(t)}else return iy(t)?ra.instance(t):typeof t=="object"&&"offset"in t&&typeof t.offset=="function"?t:new GMe(t)}const BH={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},JK={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},BMe=BH.hanidec.replace(/[\[|\]]/g,"").split("");function qMe(t){let e=parseInt(t,10);if(isNaN(e)){e="";for(let i=0;i<t.length;i++){const s=t.charCodeAt(i);if(t[i].search(BH.hanidec)!==-1)e+=BMe.indexOf(t[i]);else for(const n in JK){const[r,o]=JK[n];s>=r&&s<=o&&(e+=s-r)}}return parseInt(e,10)}else return e}let _b={};function HMe(){_b={}}function Th({numberingSystem:t},e=""){const i=t||"latn";return _b[i]||(_b[i]={}),_b[i][e]||(_b[i][e]=new RegExp(`${BH[i]}${e}`)),_b[i][e]}let eQ=()=>Date.now(),tQ="system",iQ=null,sQ=null,nQ=null,rQ=60,oQ,aQ=null;class Vr{static get now(){return eQ}static set now(e){eQ=e}static set defaultZone(e){tQ=e}static get defaultZone(){return z_(tQ,OF.instance)}static get defaultLocale(){return iQ}static set defaultLocale(e){iQ=e}static get defaultNumberingSystem(){return sQ}static set defaultNumberingSystem(e){sQ=e}static get defaultOutputCalendar(){return nQ}static set defaultOutputCalendar(e){nQ=e}static get defaultWeekSettings(){return aQ}static set defaultWeekSettings(e){aQ=Kz(e)}static get twoDigitCutoffYear(){return rQ}static set twoDigitCutoffYear(e){rQ=e%100}static get throwOnInvalid(){return oQ}static set throwOnInvalid(e){oQ=e}static resetCaches(){fn.resetCache(),Eu.resetCache(),ui.resetCache(),HMe()}}class ld{constructor(e,i){this.reason=e,this.explanation=i}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const khe=[0,31,59,90,120,151,181,212,243,273,304,334],$he=[0,31,60,91,121,152,182,213,244,274,305,335];function Zc(t,e){return new ld("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${t}, which is invalid`)}function qH(t,e,i){const s=new Date(Date.UTC(t,e-1,i));t<100&&t>=0&&s.setUTCFullYear(s.getUTCFullYear()-1900);const n=s.getUTCDay();return n===0?7:n}function Uhe(t,e,i){return i+(YM(t)?$he:khe)[e-1]}function Vhe(t,e){const i=YM(t)?$he:khe,s=i.findIndex(r=>r<e),n=e-i[s];return{month:s+1,day:n}}function HH(t,e){return(t-e+7)%7+1}function zO(t,e=4,i=1){const{year:s,month:n,day:r}=t,o=Uhe(s,n,r),a=HH(qH(s,n,r),i);let l=Math.floor((o-a+14-e)/7),u;return l<1?(u=s-1,l=TP(u,e,i)):l>TP(s,e,i)?(u=s+1,l=1):u=s,{weekYear:u,weekNumber:l,weekday:a,...$F(t)}}function lQ(t,e=4,i=1){const{weekYear:s,weekNumber:n,weekday:r}=t,o=HH(qH(s,1,e),i),a=Ew(s);let l=n*7+r-o-7+e,u;l<1?(u=s-1,l+=Ew(u)):l>a?(u=s+1,l-=Ew(s)):u=s;const{month:c,day:h}=Vhe(u,l);return{year:u,month:c,day:h,...$F(t)}}function pU(t){const{year:e,month:i,day:s}=t,n=Uhe(e,i,s);return{year:e,ordinal:n,...$F(t)}}function uQ(t){const{year:e,ordinal:i}=t,{month:s,day:n}=Vhe(e,i);return{year:e,month:s,day:n,...$F(t)}}function cQ(t,e){if(!Ji(t.localWeekday)||!Ji(t.localWeekNumber)||!Ji(t.localWeekYear)){if(!Ji(t.weekday)||!Ji(t.weekNumber)||!Ji(t.weekYear))throw new ow("Cannot mix locale-based week fields with ISO-based week fields");return Ji(t.localWeekday)||(t.weekday=t.localWeekday),Ji(t.localWeekNumber)||(t.weekNumber=t.localWeekNumber),Ji(t.localWeekYear)||(t.weekYear=t.localWeekYear),delete t.localWeekday,delete t.localWeekNumber,delete t.localWeekYear,{minDaysInFirstWeek:e.getMinDaysInFirstWeek(),startOfWeek:e.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function jMe(t,e=4,i=1){const s=LF(t.weekYear),n=Kc(t.weekNumber,1,TP(t.weekYear,e,i)),r=Kc(t.weekday,1,7);return s?n?r?!1:Zc("weekday",t.weekday):Zc("week",t.weekNumber):Zc("weekYear",t.weekYear)}function YMe(t){const e=LF(t.year),i=Kc(t.ordinal,1,Ew(t.year));return e?i?!1:Zc("ordinal",t.ordinal):Zc("year",t.year)}function zhe(t){const e=LF(t.year),i=Kc(t.month,1,12),s=Kc(t.day,1,GO(t.year,t.month));return e?i?s?!1:Zc("day",t.day):Zc("month",t.month):Zc("year",t.year)}function Ghe(t){const{hour:e,minute:i,second:s,millisecond:n}=t,r=Kc(e,0,23)||e===24&&i===0&&s===0&&n===0,o=Kc(i,0,59),a=Kc(s,0,59),l=Kc(n,0,999);return r?o?a?l?!1:Zc("millisecond",n):Zc("second",s):Zc("minute",i):Zc("hour",e)}function Ji(t){return typeof t>"u"}function iy(t){return typeof t=="number"}function LF(t){return typeof t=="number"&&t%1===0}function XMe(t){return typeof t=="string"}function WMe(t){return Object.prototype.toString.call(t)==="[object Date]"}function Bhe(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function qhe(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function ZMe(t){return Array.isArray(t)?t:[t]}function hQ(t,e,i){if(t.length!==0)return t.reduce((s,n)=>{const r=[e(n),n];return s&&i(s[0],r[0])===s[0]?s:r},null)[1]}function KMe(t,e){return e.reduce((i,s)=>(i[s]=t[s],i),{})}function rS(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Kz(t){if(t==null)return null;if(typeof t!="object")throw new Qa("Week settings must be an object");if(!Kc(t.firstDay,1,7)||!Kc(t.minimalDays,1,7)||!Array.isArray(t.weekend)||t.weekend.some(e=>!Kc(e,1,7)))throw new Qa("Invalid week settings");return{firstDay:t.firstDay,minimalDays:t.minimalDays,weekend:Array.from(t.weekend)}}function Kc(t,e,i){return LF(t)&&t>=e&&t<=i}function QMe(t,e){return t-e*Math.floor(t/e)}function po(t,e=2){const i=t<0;let s;return i?s="-"+(""+-t).padStart(e,"0"):s=(""+t).padStart(e,"0"),s}function I_(t){if(!(Ji(t)||t===null||t===""))return parseInt(t,10)}function g0(t){if(!(Ji(t)||t===null||t===""))return parseFloat(t)}function jH(t){if(!(Ji(t)||t===null||t==="")){const e=parseFloat("0."+t)*1e3;return Math.floor(e)}}function YH(t,e,i=!1){const s=10**e;return(i?Math.trunc:Math.round)(t*s)/s}function YM(t){return t%4===0&&(t%100!==0||t%400===0)}function Ew(t){return YM(t)?366:365}function GO(t,e){const i=QMe(e-1,12)+1,s=t+(e-i)/12;return i===2?YM(s)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][i-1]}function FF(t){let e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);return t.year<100&&t.year>=0&&(e=new Date(e),e.setUTCFullYear(t.year,t.month-1,t.day)),+e}function dQ(t,e,i){return-HH(qH(t,1,e),i)+e-1}function TP(t,e=4,i=1){const s=dQ(t,e,i),n=dQ(t+1,e,i);return(Ew(t)-s+n)/7}function Qz(t){return t>99?t:t>Vr.twoDigitCutoffYear?1900+t:2e3+t}function Hhe(t,e,i,s=null){const n=new Date(t),r={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};s&&(r.timeZone=s);const o={timeZoneName:e,...r},a=new Intl.DateTimeFormat(i,o).formatToParts(n).find(l=>l.type.toLowerCase()==="timezonename");return a?a.value:null}function kF(t,e){let i=parseInt(t,10);Number.isNaN(i)&&(i=0);const s=parseInt(e,10)||0,n=i<0||Object.is(i,-0)?-s:s;return i*60+n}function jhe(t){const e=Number(t);if(typeof t=="boolean"||t===""||Number.isNaN(e))throw new Qa(`Invalid unit value ${t}`);return e}function BO(t,e){const i={};for(const s in t)if(rS(t,s)){const n=t[s];if(n==null)continue;i[e(s)]=jhe(n)}return i}function UT(t,e){const i=Math.trunc(Math.abs(t/60)),s=Math.trunc(Math.abs(t%60)),n=t>=0?"+":"-";switch(e){case"short":return`${n}${po(i,2)}:${po(s,2)}`;case"narrow":return`${n}${i}${s>0?`:${s}`:""}`;case"techie":return`${n}${po(i,2)}${po(s,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function $F(t){return KMe(t,["hour","minute","second","millisecond"])}const JMe=["January","February","March","April","May","June","July","August","September","October","November","December"],Yhe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],eAe=["J","F","M","A","M","J","J","A","S","O","N","D"];function Xhe(t){switch(t){case"narrow":return[...eAe];case"short":return[...Yhe];case"long":return[...JMe];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const Whe=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Zhe=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],tAe=["M","T","W","T","F","S","S"];function Khe(t){switch(t){case"narrow":return[...tAe];case"short":return[...Zhe];case"long":return[...Whe];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const Qhe=["AM","PM"],iAe=["Before Christ","Anno Domini"],sAe=["BC","AD"],nAe=["B","A"];function Jhe(t){switch(t){case"narrow":return[...nAe];case"short":return[...sAe];case"long":return[...iAe];default:return null}}function rAe(t){return Qhe[t.hour<12?0:1]}function oAe(t,e){return Khe(e)[t.weekday-1]}function aAe(t,e){return Xhe(e)[t.month-1]}function lAe(t,e){return Jhe(e)[t.year<0?0:1]}function uAe(t,e,i="always",s=!1){const n={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},r=["hours","minutes","seconds"].indexOf(t)===-1;if(i==="auto"&&r){const h=t==="days";switch(e){case 1:return h?"tomorrow":`next ${n[t][0]}`;case-1:return h?"yesterday":`last ${n[t][0]}`;case 0:return h?"today":`this ${n[t][0]}`}}const o=Object.is(e,-0)||e<0,a=Math.abs(e),l=a===1,u=n[t],c=s?l?u[1]:u[2]||u[1]:l?n[t][0]:t;return o?`${a} ${c} ago`:`in ${a} ${c}`}function mQ(t,e){let i="";for(const s of t)s.literal?i+=s.val:i+=e(s.val);return i}const cAe={D:VO,DD:yhe,DDD:vhe,DDDD:xhe,t:bhe,tt:whe,ttt:She,tttt:Ehe,T:Che,TT:The,TTT:Phe,TTTT:Mhe,f:Ahe,ff:Dhe,fff:Rhe,ffff:Lhe,F:Ihe,FF:Nhe,FFF:Ohe,FFFF:Fhe};class tl{static create(e,i={}){return new tl(e,i)}static parseFormat(e){let i=null,s="",n=!1;const r=[];for(let o=0;o<e.length;o++){const a=e.charAt(o);a==="'"?(s.length>0&&r.push({literal:n||/^\s+$/.test(s),val:s}),i=null,s="",n=!n):n||a===i?s+=a:(s.length>0&&r.push({literal:/^\s+$/.test(s),val:s}),s=a,i=a)}return s.length>0&&r.push({literal:n||/^\s+$/.test(s),val:s}),r}static macroTokenToFormatOpts(e){return cAe[e]}constructor(e,i){this.opts=i,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,i){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,{...this.opts,...i}).format()}dtFormatter(e,i={}){return this.loc.dtFormatter(e,{...this.opts,...i})}formatDateTime(e,i){return this.dtFormatter(e,i).format()}formatDateTimeParts(e,i){return this.dtFormatter(e,i).formatToParts()}formatInterval(e,i){return this.dtFormatter(e.start,i).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,i){return this.dtFormatter(e,i).resolvedOptions()}num(e,i=0){if(this.opts.forceSimple)return po(e,i);const s={...this.opts};return i>0&&(s.padTo=i),this.loc.numberFormatter(s).format(e)}formatDateTimeFromString(e,i){const s=this.loc.listingMode()==="en",n=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",r=(m,f)=>this.loc.extract(e,m,f),o=m=>e.isOffsetFixed&&e.offset===0&&m.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,m.format):"",a=()=>s?rAe(e):r({hour:"numeric",hourCycle:"h12"},"dayperiod"),l=(m,f)=>s?aAe(e,m):r(f?{month:m}:{month:m,day:"numeric"},"month"),u=(m,f)=>s?oAe(e,m):r(f?{weekday:m}:{weekday:m,month:"long",day:"numeric"},"weekday"),c=m=>{const f=tl.macroTokenToFormatOpts(m);return f?this.formatWithSystemDefault(e,f):m},h=m=>s?lAe(e,m):r({era:m},"era"),d=m=>{switch(m){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return o({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return o({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return o({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return a();case"d":return n?r({day:"numeric"},"day"):this.num(e.day);case"dd":return n?r({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return u("short",!0);case"cccc":return u("long",!0);case"ccccc":return u("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return u("short",!1);case"EEEE":return u("long",!1);case"EEEEE":return u("narrow",!1);case"L":return n?r({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return n?r({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return l("short",!0);case"LLLL":return l("long",!0);case"LLLLL":return l("narrow",!0);case"M":return n?r({month:"numeric"},"month"):this.num(e.month);case"MM":return n?r({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return l("short",!1);case"MMMM":return l("long",!1);case"MMMMM":return l("narrow",!1);case"y":return n?r({year:"numeric"},"year"):this.num(e.year);case"yy":return n?r({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return n?r({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return n?r({year:"numeric"},"year"):this.num(e.year,6);case"G":return h("short");case"GG":return h("long");case"GGGGG":return h("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"n":return this.num(e.localWeekNumber);case"nn":return this.num(e.localWeekNumber,2);case"ii":return this.num(e.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(e.localWeekYear,4);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return c(m)}};return mQ(tl.parseFormat(i),d)}formatDurationFromString(e,i){const s=l=>{switch(l[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},n=l=>u=>{const c=s(u);return c?this.num(l.get(c),u.length):u},r=tl.parseFormat(i),o=r.reduce((l,{literal:u,val:c})=>u?l:l.concat(c),[]),a=e.shiftTo(...o.map(s).filter(l=>l));return mQ(r,n(a))}}const ede=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function zS(...t){const e=t.reduce((i,s)=>i+s.source,"");return RegExp(`^${e}$`)}function GS(...t){return e=>t.reduce(([i,s,n],r)=>{const[o,a,l]=r(e,n);return[{...i,...o},a||s,l]},[{},null,1]).slice(0,2)}function BS(t,...e){if(t==null)return[null,null];for(const[i,s]of e){const n=i.exec(t);if(n)return s(n)}return[null,null]}function tde(...t){return(e,i)=>{const s={};let n;for(n=0;n<t.length;n++)s[t[n]]=I_(e[i+n]);return[s,null,i+n]}}const ide=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,hAe=`(?:${ide.source}?(?:\\[(${ede.source})\\])?)?`,XH=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,sde=RegExp(`${XH.source}${hAe}`),WH=RegExp(`(?:T${sde.source})?`),dAe=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,mAe=/(\d{4})-?W(\d\d)(?:-?(\d))?/,pAe=/(\d{4})-?(\d{3})/,fAe=tde("weekYear","weekNumber","weekDay"),gAe=tde("year","ordinal"),_Ae=/(\d{4})-(\d\d)-(\d\d)/,nde=RegExp(`${XH.source} ?(?:${ide.source}|(${ede.source}))?`),yAe=RegExp(`(?: ${nde.source})?`);function Cw(t,e,i){const s=t[e];return Ji(s)?i:I_(s)}function vAe(t,e){return[{year:Cw(t,e),month:Cw(t,e+1,1),day:Cw(t,e+2,1)},null,e+3]}function qS(t,e){return[{hours:Cw(t,e,0),minutes:Cw(t,e+1,0),seconds:Cw(t,e+2,0),milliseconds:jH(t[e+3])},null,e+4]}function XM(t,e){const i=!t[e]&&!t[e+1],s=kF(t[e+1],t[e+2]),n=i?null:ra.instance(s);return[{},n,e+3]}function WM(t,e){const i=t[e]?Eu.create(t[e]):null;return[{},i,e+1]}const xAe=RegExp(`^T?${XH.source}$`),bAe=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function wAe(t){const[e,i,s,n,r,o,a,l,u]=t,c=e[0]==="-",h=l&&l[0]==="-",d=(m,f=!1)=>m!==void 0&&(f||m&&c)?-m:m;return[{years:d(g0(i)),months:d(g0(s)),weeks:d(g0(n)),days:d(g0(r)),hours:d(g0(o)),minutes:d(g0(a)),seconds:d(g0(l),l==="-0"),milliseconds:d(jH(u),h)}]}const SAe={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function ZH(t,e,i,s,n,r,o){const a={year:e.length===2?Qz(I_(e)):I_(e),month:Yhe.indexOf(i)+1,day:I_(s),hour:I_(n),minute:I_(r)};return o&&(a.second=I_(o)),t&&(a.weekday=t.length>3?Whe.indexOf(t)+1:Zhe.indexOf(t)+1),a}const EAe=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function CAe(t){const[,e,i,s,n,r,o,a,l,u,c,h]=t,d=ZH(e,n,s,i,r,o,a);let m;return l?m=SAe[l]:u?m=0:m=kF(c,h),[d,new ra(m)]}function TAe(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const PAe=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,MAe=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,AAe=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function pQ(t){const[,e,i,s,n,r,o,a]=t;return[ZH(e,n,s,i,r,o,a),ra.utcInstance]}function IAe(t){const[,e,i,s,n,r,o,a]=t;return[ZH(e,a,i,s,n,r,o),ra.utcInstance]}const DAe=zS(dAe,WH),NAe=zS(mAe,WH),RAe=zS(pAe,WH),OAe=zS(sde),rde=GS(vAe,qS,XM,WM),LAe=GS(fAe,qS,XM,WM),FAe=GS(gAe,qS,XM,WM),kAe=GS(qS,XM,WM);function $Ae(t){return BS(t,[DAe,rde],[NAe,LAe],[RAe,FAe],[OAe,kAe])}function UAe(t){return BS(TAe(t),[EAe,CAe])}function VAe(t){return BS(t,[PAe,pQ],[MAe,pQ],[AAe,IAe])}function zAe(t){return BS(t,[bAe,wAe])}const GAe=GS(qS);function BAe(t){return BS(t,[xAe,GAe])}const qAe=zS(_Ae,yAe),HAe=zS(nde),jAe=GS(qS,XM,WM);function YAe(t){return BS(t,[qAe,rde],[HAe,jAe])}const fQ="Invalid Duration",ode={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},XAe={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3},...ode},Pc=146097/400,Rx=146097/4800,WAe={years:{quarters:4,months:12,weeks:Pc/7,days:Pc,hours:Pc*24,minutes:Pc*24*60,seconds:Pc*24*60*60,milliseconds:Pc*24*60*60*1e3},quarters:{months:3,weeks:Pc/28,days:Pc/4,hours:Pc*24/4,minutes:Pc*24*60/4,seconds:Pc*24*60*60/4,milliseconds:Pc*24*60*60*1e3/4},months:{weeks:Rx/7,days:Rx,hours:Rx*24,minutes:Rx*24*60,seconds:Rx*24*60*60,milliseconds:Rx*24*60*60*1e3},...ode},Fv=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],ZAe=Fv.slice(0).reverse();function Vg(t,e,i=!1){const s={values:i?e.values:{...t.values,...e.values||{}},loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy,matrix:e.matrix||t.matrix};return new qs(s)}function ade(t,e){let i=e.milliseconds??0;for(const s of ZAe.slice(1))e[s]&&(i+=e[s]*t[s].milliseconds);return i}function gQ(t,e){const i=ade(t,e)<0?-1:1;Fv.reduceRight((s,n)=>{if(Ji(e[n]))return s;if(s){const r=e[s]*i,o=t[n][s],a=Math.floor(r/o);e[n]+=a*i,e[s]-=a*o*i}return n},null),Fv.reduce((s,n)=>{if(Ji(e[n]))return s;if(s){const r=e[s]%1;e[s]-=r,e[n]+=r*t[s][n]}return n},null)}function KAe(t){const e={};for(const[i,s]of Object.entries(t))s!==0&&(e[i]=s);return e}class qs{constructor(e){const i=e.conversionAccuracy==="longterm"||!1;let s=i?WAe:XAe;e.matrix&&(s=e.matrix),this.values=e.values,this.loc=e.loc||fn.create(),this.conversionAccuracy=i?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=s,this.isLuxonDuration=!0}static fromMillis(e,i){return qs.fromObject({milliseconds:e},i)}static fromObject(e,i={}){if(e==null||typeof e!="object")throw new Qa(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new qs({values:BO(e,qs.normalizeUnit),loc:fn.fromObject(i),conversionAccuracy:i.conversionAccuracy,matrix:i.matrix})}static fromDurationLike(e){if(iy(e))return qs.fromMillis(e);if(qs.isDuration(e))return e;if(typeof e=="object")return qs.fromObject(e);throw new Qa(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,i){const[s]=zAe(e);return s?qs.fromObject(s,i):qs.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,i){const[s]=BAe(e);return s?qs.fromObject(s,i):qs.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,i=null){if(!e)throw new Qa("need to specify a reason the Duration is invalid");const s=e instanceof ld?e:new ld(e,i);if(Vr.throwOnInvalid)throw new bMe(s);return new qs({invalid:s})}static normalizeUnit(e){const i={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!i)throw new _he(e);return i}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,i={}){const s={...i,floor:i.round!==!1&&i.floor!==!1};return this.isValid?tl.create(this.loc,s).formatDurationFromString(this,e):fQ}toHuman(e={}){if(!this.isValid)return fQ;const i=Fv.map(s=>{const n=this.values[s];return Ji(n)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...e,unit:s.slice(0,-1)}).format(n)}).filter(s=>s);return this.loc.listFormatter({type:"conjunction",style:e.listStyle||"narrow",...e}).format(i)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=YH(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;const i=this.toMillis();return i<0||i>=864e5?null:(e={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...e,includeOffset:!1},ui.fromMillis(i,{zone:"UTC"}).toISOTime(e))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?ade(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;const i=qs.fromDurationLike(e),s={};for(const n of Fv)(rS(i.values,n)||rS(this.values,n))&&(s[n]=i.get(n)+this.get(n));return Vg(this,{values:s},!0)}minus(e){if(!this.isValid)return this;const i=qs.fromDurationLike(e);return this.plus(i.negate())}mapUnits(e){if(!this.isValid)return this;const i={};for(const s of Object.keys(this.values))i[s]=jhe(e(this.values[s],s));return Vg(this,{values:i},!0)}get(e){return this[qs.normalizeUnit(e)]}set(e){if(!this.isValid)return this;const i={...this.values,...BO(e,qs.normalizeUnit)};return Vg(this,{values:i})}reconfigure({locale:e,numberingSystem:i,conversionAccuracy:s,matrix:n}={}){const o={loc:this.loc.clone({locale:e,numberingSystem:i}),matrix:n,conversionAccuracy:s};return Vg(this,o)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;const e=this.toObject();return gQ(this.matrix,e),Vg(this,{values:e},!0)}rescale(){if(!this.isValid)return this;const e=KAe(this.normalize().shiftToAll().toObject());return Vg(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(o=>qs.normalizeUnit(o));const i={},s={},n=this.toObject();let r;for(const o of Fv)if(e.indexOf(o)>=0){r=o;let a=0;for(const u in s)a+=this.matrix[u][o]*s[u],s[u]=0;iy(n[o])&&(a+=n[o]);const l=Math.trunc(a);i[o]=l,s[o]=(a*1e3-l*1e3)/1e3}else iy(n[o])&&(s[o]=n[o]);for(const o in s)s[o]!==0&&(i[r]+=o===r?s[o]:s[o]/this.matrix[r][o]);return gQ(this.matrix,i),Vg(this,{values:i},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const e={};for(const i of Object.keys(this.values))e[i]=this.values[i]===0?0:-this.values[i];return Vg(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function i(s,n){return s===void 0||s===0?n===void 0||n===0:s===n}for(const s of Fv)if(!i(this.values[s],e.values[s]))return!1;return!0}}const Ox="Invalid Interval";function QAe(t,e){return!t||!t.isValid?Ur.invalid("missing or invalid start"):!e||!e.isValid?Ur.invalid("missing or invalid end"):e<t?Ur.invalid("end before start",`The end of an interval must be after its start, but you had start=${t.toISO()} and end=${e.toISO()}`):null}class Ur{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,i=null){if(!e)throw new Qa("need to specify a reason the Interval is invalid");const s=e instanceof ld?e:new ld(e,i);if(Vr.throwOnInvalid)throw new xMe(s);return new Ur({invalid:s})}static fromDateTimes(e,i){const s=C2(e),n=C2(i),r=QAe(s,n);return r??new Ur({start:s,end:n})}static after(e,i){const s=qs.fromDurationLike(i),n=C2(e);return Ur.fromDateTimes(n,n.plus(s))}static before(e,i){const s=qs.fromDurationLike(i),n=C2(e);return Ur.fromDateTimes(n.minus(s),n)}static fromISO(e,i){const[s,n]=(e||"").split("/",2);if(s&&n){let r,o;try{r=ui.fromISO(s,i),o=r.isValid}catch{o=!1}let a,l;try{a=ui.fromISO(n,i),l=a.isValid}catch{l=!1}if(o&&l)return Ur.fromDateTimes(r,a);if(o){const u=qs.fromISO(n,i);if(u.isValid)return Ur.after(r,u)}else if(l){const u=qs.fromISO(s,i);if(u.isValid)return Ur.before(a,u)}}return Ur.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds",i){if(!this.isValid)return NaN;const s=this.start.startOf(e,i);let n;return i!=null&&i.useLocaleWeeks?n=this.end.reconfigure({locale:s.locale}):n=this.end,n=n.startOf(e,i),Math.floor(n.diff(s,e).get(e))+(n.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:i}={}){return this.isValid?Ur.fromDateTimes(e||this.s,i||this.e):this}splitAt(...e){if(!this.isValid)return[];const i=e.map(C2).filter(o=>this.contains(o)).sort((o,a)=>o.toMillis()-a.toMillis()),s=[];let{s:n}=this,r=0;for(;n<this.e;){const o=i[r]||this.e,a=+o>+this.e?this.e:o;s.push(Ur.fromDateTimes(n,a)),n=a,r+=1}return s}splitBy(e){const i=qs.fromDurationLike(e);if(!this.isValid||!i.isValid||i.as("milliseconds")===0)return[];let{s}=this,n=1,r;const o=[];for(;s<this.e;){const a=this.start.plus(i.mapUnits(l=>l*n));r=+a>+this.e?this.e:a,o.push(Ur.fromDateTimes(s,r)),s=r,n+=1}return o}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;const i=this.s>e.s?this.s:e.s,s=this.e<e.e?this.e:e.e;return i>=s?null:Ur.fromDateTimes(i,s)}union(e){if(!this.isValid)return this;const i=this.s<e.s?this.s:e.s,s=this.e>e.e?this.e:e.e;return Ur.fromDateTimes(i,s)}static merge(e){const[i,s]=e.sort((n,r)=>n.s-r.s).reduce(([n,r],o)=>r?r.overlaps(o)||r.abutsStart(o)?[n,r.union(o)]:[n.concat([r]),o]:[n,o],[[],null]);return s&&i.push(s),i}static xor(e){let i=null,s=0;const n=[],r=e.map(l=>[{time:l.s,type:"s"},{time:l.e,type:"e"}]),o=Array.prototype.concat(...r),a=o.sort((l,u)=>l.time-u.time);for(const l of a)s+=l.type==="s"?1:-1,s===1?i=l.time:(i&&+i!=+l.time&&n.push(Ur.fromDateTimes(i,l.time)),i=null);return Ur.merge(n)}difference(...e){return Ur.xor([this].concat(e)).map(i=>this.intersection(i)).filter(i=>i&&!i.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} – ${this.e.toISO()})`:Ox}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(e=VO,i={}){return this.isValid?tl.create(this.s.loc.clone(i),e).formatInterval(this):Ox}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:Ox}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:Ox}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:Ox}toFormat(e,{separator:i=" – "}={}){return this.isValid?`${this.s.toFormat(e)}${i}${this.e.toFormat(e)}`:Ox}toDuration(e,i){return this.isValid?this.e.diff(this.s,e,i):qs.invalid(this.invalidReason)}mapEndpoints(e){return Ur.fromDateTimes(e(this.s),e(this.e))}}class _D{static hasDST(e=Vr.defaultZone){const i=ui.now().setZone(e).set({month:12});return!e.isUniversal&&i.offset!==i.set({month:6}).offset}static isValidIANAZone(e){return Eu.isValidZone(e)}static normalizeZone(e){return z_(e,Vr.defaultZone)}static getStartOfWeek({locale:e=null,locObj:i=null}={}){return(i||fn.create(e)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:e=null,locObj:i=null}={}){return(i||fn.create(e)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:e=null,locObj:i=null}={}){return(i||fn.create(e)).getWeekendDays().slice()}static months(e="long",{locale:i=null,numberingSystem:s=null,locObj:n=null,outputCalendar:r="gregory"}={}){return(n||fn.create(i,s,r)).months(e)}static monthsFormat(e="long",{locale:i=null,numberingSystem:s=null,locObj:n=null,outputCalendar:r="gregory"}={}){return(n||fn.create(i,s,r)).months(e,!0)}static weekdays(e="long",{locale:i=null,numberingSystem:s=null,locObj:n=null}={}){return(n||fn.create(i,s,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:i=null,numberingSystem:s=null,locObj:n=null}={}){return(n||fn.create(i,s,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return fn.create(e).meridiems()}static eras(e="short",{locale:i=null}={}){return fn.create(i,null,"gregory").eras(e)}static features(){return{relative:Bhe(),localeWeek:qhe()}}}function _Q(t,e){const i=n=>n.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),s=i(e)-i(t);return Math.floor(qs.fromMillis(s).as("days"))}function JAe(t,e,i){const s=[["years",(l,u)=>u.year-l.year],["quarters",(l,u)=>u.quarter-l.quarter+(u.year-l.year)*4],["months",(l,u)=>u.month-l.month+(u.year-l.year)*12],["weeks",(l,u)=>{const c=_Q(l,u);return(c-c%7)/7}],["days",_Q]],n={},r=t;let o,a;for(const[l,u]of s)i.indexOf(l)>=0&&(o=l,n[l]=u(t,e),a=r.plus(n),a>e?(n[l]--,t=r.plus(n),t>e&&(a=t,n[l]--,t=r.plus(n))):t=a);return[t,n,a,o]}function eIe(t,e,i,s){let[n,r,o,a]=JAe(t,e,i);const l=e-n,u=i.filter(h=>["hours","minutes","seconds","milliseconds"].indexOf(h)>=0);u.length===0&&(o<e&&(o=n.plus({[a]:1})),o!==n&&(r[a]=(r[a]||0)+l/(o-n)));const c=qs.fromObject(r,s);return u.length>0?qs.fromMillis(l,s).shiftTo(...u).plus(c):c}const tIe="missing Intl.DateTimeFormat.formatToParts support";function sn(t,e=i=>i){return{regex:t,deser:([i])=>e(qMe(i))}}const iIe=" ",lde=`[ ${iIe}]`,ude=new RegExp(lde,"g");function sIe(t){return t.replace(/\./g,"\\.?").replace(ude,lde)}function yQ(t){return t.replace(/\./g,"").replace(ude," ").toLowerCase()}function Ph(t,e){return t===null?null:{regex:RegExp(t.map(sIe).join("|")),deser:([i])=>t.findIndex(s=>yQ(i)===yQ(s))+e}}function vQ(t,e){return{regex:t,deser:([,i,s])=>kF(i,s),groups:e}}function yD(t){return{regex:t,deser:([e])=>e}}function nIe(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function rIe(t,e){const i=Th(e),s=Th(e,"{2}"),n=Th(e,"{3}"),r=Th(e,"{4}"),o=Th(e,"{6}"),a=Th(e,"{1,2}"),l=Th(e,"{1,3}"),u=Th(e,"{1,6}"),c=Th(e,"{1,9}"),h=Th(e,"{2,4}"),d=Th(e,"{4,6}"),m=v=>({regex:RegExp(nIe(v.val)),deser:([x])=>x,literal:!0}),_=(v=>{if(t.literal)return m(v);switch(v.val){case"G":return Ph(e.eras("short"),0);case"GG":return Ph(e.eras("long"),0);case"y":return sn(u);case"yy":return sn(h,Qz);case"yyyy":return sn(r);case"yyyyy":return sn(d);case"yyyyyy":return sn(o);case"M":return sn(a);case"MM":return sn(s);case"MMM":return Ph(e.months("short",!0),1);case"MMMM":return Ph(e.months("long",!0),1);case"L":return sn(a);case"LL":return sn(s);case"LLL":return Ph(e.months("short",!1),1);case"LLLL":return Ph(e.months("long",!1),1);case"d":return sn(a);case"dd":return sn(s);case"o":return sn(l);case"ooo":return sn(n);case"HH":return sn(s);case"H":return sn(a);case"hh":return sn(s);case"h":return sn(a);case"mm":return sn(s);case"m":return sn(a);case"q":return sn(a);case"qq":return sn(s);case"s":return sn(a);case"ss":return sn(s);case"S":return sn(l);case"SSS":return sn(n);case"u":return yD(c);case"uu":return yD(a);case"uuu":return sn(i);case"a":return Ph(e.meridiems(),0);case"kkkk":return sn(r);case"kk":return sn(h,Qz);case"W":return sn(a);case"WW":return sn(s);case"E":case"c":return sn(i);case"EEE":return Ph(e.weekdays("short",!1),1);case"EEEE":return Ph(e.weekdays("long",!1),1);case"ccc":return Ph(e.weekdays("short",!0),1);case"cccc":return Ph(e.weekdays("long",!0),1);case"Z":case"ZZ":return vQ(new RegExp(`([+-]${a.source})(?::(${s.source}))?`),2);case"ZZZ":return vQ(new RegExp(`([+-]${a.source})(${s.source})?`),2);case"z":return yD(/[a-z_+-/]{1,256}?/i);case" ":return yD(/[^\S\n\r]/);default:return m(v)}})(t)||{invalidReason:tIe};return _.token=t,_}const oIe={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function aIe(t,e,i){const{type:s,value:n}=t;if(s==="literal"){const l=/^\s+$/.test(n);return{literal:!l,val:l?" ":n}}const r=e[s];let o=s;s==="hour"&&(e.hour12!=null?o=e.hour12?"hour12":"hour24":e.hourCycle!=null?e.hourCycle==="h11"||e.hourCycle==="h12"?o="hour12":o="hour24":o=i.hour12?"hour12":"hour24");let a=oIe[o];if(typeof a=="object"&&(a=a[r]),a)return{literal:!1,val:a}}function lIe(t){return[`^${t.map(i=>i.regex).reduce((i,s)=>`${i}(${s.source})`,"")}$`,t]}function uIe(t,e,i){const s=t.match(e);if(s){const n={};let r=1;for(const o in i)if(rS(i,o)){const a=i[o],l=a.groups?a.groups+1:1;!a.literal&&a.token&&(n[a.token.val[0]]=a.deser(s.slice(r,r+l))),r+=l}return[s,n]}else return[s,{}]}function cIe(t){const e=r=>{switch(r){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let i=null,s;return Ji(t.z)||(i=Eu.create(t.z)),Ji(t.Z)||(i||(i=new ra(t.Z)),s=t.Z),Ji(t.q)||(t.M=(t.q-1)*3+1),Ji(t.h)||(t.h<12&&t.a===1?t.h+=12:t.h===12&&t.a===0&&(t.h=0)),t.G===0&&t.y&&(t.y=-t.y),Ji(t.u)||(t.S=jH(t.u)),[Object.keys(t).reduce((r,o)=>{const a=e(o);return a&&(r[a]=t[o]),r},{}),i,s]}let fU=null;function hIe(){return fU||(fU=ui.fromMillis(1555555555555)),fU}function dIe(t,e){if(t.literal)return t;const i=tl.macroTokenToFormatOpts(t.val),s=mde(i,e);return s==null||s.includes(void 0)?t:s}function cde(t,e){return Array.prototype.concat(...t.map(i=>dIe(i,e)))}class hde{constructor(e,i){if(this.locale=e,this.format=i,this.tokens=cde(tl.parseFormat(i),e),this.units=this.tokens.map(s=>rIe(s,e)),this.disqualifyingUnit=this.units.find(s=>s.invalidReason),!this.disqualifyingUnit){const[s,n]=lIe(this.units);this.regex=RegExp(s,"i"),this.handlers=n}}explainFromTokens(e){if(this.isValid){const[i,s]=uIe(e,this.regex,this.handlers),[n,r,o]=s?cIe(s):[null,null,void 0];if(rS(s,"a")&&rS(s,"H"))throw new ow("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:this.tokens,regex:this.regex,rawMatches:i,matches:s,result:n,zone:r,specificOffset:o}}else return{input:e,tokens:this.tokens,invalidReason:this.invalidReason}}get isValid(){return!this.disqualifyingUnit}get invalidReason(){return this.disqualifyingUnit?this.disqualifyingUnit.invalidReason:null}}function dde(t,e,i){return new hde(t,i).explainFromTokens(e)}function mIe(t,e,i){const{result:s,zone:n,specificOffset:r,invalidReason:o}=dde(t,e,i);return[s,n,r,o]}function mde(t,e){if(!t)return null;const s=tl.create(e,t).dtFormatter(hIe()),n=s.formatToParts(),r=s.resolvedOptions();return n.map(o=>aIe(o,t,r))}const gU="Invalid DateTime",pIe=864e13;function _C(t){return new ld("unsupported zone",`the zone "${t.name}" is not supported`)}function _U(t){return t.weekData===null&&(t.weekData=zO(t.c)),t.weekData}function yU(t){return t.localWeekData===null&&(t.localWeekData=zO(t.c,t.loc.getMinDaysInFirstWeek(),t.loc.getStartOfWeek())),t.localWeekData}function _0(t,e){const i={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new ui({...i,...e,old:i})}function pde(t,e,i){let s=t-e*60*1e3;const n=i.offset(s);if(e===n)return[s,e];s-=(n-e)*60*1e3;const r=i.offset(s);return n===r?[s,n]:[t-Math.min(n,r)*60*1e3,Math.max(n,r)]}function vD(t,e){t+=e*60*1e3;const i=new Date(t);return{year:i.getUTCFullYear(),month:i.getUTCMonth()+1,day:i.getUTCDate(),hour:i.getUTCHours(),minute:i.getUTCMinutes(),second:i.getUTCSeconds(),millisecond:i.getUTCMilliseconds()}}function DR(t,e,i){return pde(FF(t),e,i)}function xQ(t,e){const i=t.o,s=t.c.year+Math.trunc(e.years),n=t.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,r={...t.c,year:s,month:n,day:Math.min(t.c.day,GO(s,n))+Math.trunc(e.days)+Math.trunc(e.weeks)*7},o=qs.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),a=FF(r);let[l,u]=pde(a,i,t.zone);return o!==0&&(l+=o,u=t.zone.offset(l)),{ts:l,o:u}}function Lx(t,e,i,s,n,r){const{setZone:o,zone:a}=i;if(t&&Object.keys(t).length!==0||e){const l=e||a,u=ui.fromObject(t,{...i,zone:l,specificOffset:r});return o?u:u.setZone(a)}else return ui.invalid(new ld("unparsable",`the input "${n}" can't be parsed as ${s}`))}function xD(t,e,i=!0){return t.isValid?tl.create(fn.create("en-US"),{allowZ:i,forceSimple:!0}).formatDateTimeFromString(t,e):null}function vU(t,e){const i=t.c.year>9999||t.c.year<0;let s="";return i&&t.c.year>=0&&(s+="+"),s+=po(t.c.year,i?6:4),e?(s+="-",s+=po(t.c.month),s+="-",s+=po(t.c.day)):(s+=po(t.c.month),s+=po(t.c.day)),s}function bQ(t,e,i,s,n,r){let o=po(t.c.hour);return e?(o+=":",o+=po(t.c.minute),(t.c.millisecond!==0||t.c.second!==0||!i)&&(o+=":")):o+=po(t.c.minute),(t.c.millisecond!==0||t.c.second!==0||!i)&&(o+=po(t.c.second),(t.c.millisecond!==0||!s)&&(o+=".",o+=po(t.c.millisecond,3))),n&&(t.isOffsetFixed&&t.offset===0&&!r?o+="Z":t.o<0?(o+="-",o+=po(Math.trunc(-t.o/60)),o+=":",o+=po(Math.trunc(-t.o%60))):(o+="+",o+=po(Math.trunc(t.o/60)),o+=":",o+=po(Math.trunc(t.o%60)))),r&&(o+="["+t.zone.ianaName+"]"),o}const fde={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},fIe={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},gIe={ordinal:1,hour:0,minute:0,second:0,millisecond:0},gde=["year","month","day","hour","minute","second","millisecond"],_Ie=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],yIe=["year","ordinal","hour","minute","second","millisecond"];function vIe(t){const e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new _he(t);return e}function wQ(t){switch(t.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return vIe(t)}}function xIe(t){return RR[t]||(NR===void 0&&(NR=Vr.now()),RR[t]=t.offset(NR)),RR[t]}function SQ(t,e){const i=z_(e.zone,Vr.defaultZone);if(!i.isValid)return ui.invalid(_C(i));const s=fn.fromObject(e);let n,r;if(Ji(t.year))n=Vr.now();else{for(const l of gde)Ji(t[l])&&(t[l]=fde[l]);const o=zhe(t)||Ghe(t);if(o)return ui.invalid(o);const a=xIe(i);[n,r]=DR(t,a,i)}return new ui({ts:n,zone:i,loc:s,o:r})}function EQ(t,e,i){const s=Ji(i.round)?!0:i.round,n=(o,a)=>(o=YH(o,s||i.calendary?0:2,!0),e.loc.clone(i).relFormatter(i).format(o,a)),r=o=>i.calendary?e.hasSame(t,o)?0:e.startOf(o).diff(t.startOf(o),o).get(o):e.diff(t,o).get(o);if(i.unit)return n(r(i.unit),i.unit);for(const o of i.units){const a=r(o);if(Math.abs(a)>=1)return n(a,o)}return n(t>e?-0:0,i.units[i.units.length-1])}function CQ(t){let e={},i;return t.length>0&&typeof t[t.length-1]=="object"?(e=t[t.length-1],i=Array.from(t).slice(0,t.length-1)):i=Array.from(t),[e,i]}let NR,RR={};class ui{constructor(e){const i=e.zone||Vr.defaultZone;let s=e.invalid||(Number.isNaN(e.ts)?new ld("invalid input"):null)||(i.isValid?null:_C(i));this.ts=Ji(e.ts)?Vr.now():e.ts;let n=null,r=null;if(!s)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(i))[n,r]=[e.old.c,e.old.o];else{const a=iy(e.o)&&!e.old?e.o:i.offset(this.ts);n=vD(this.ts,a),s=Number.isNaN(n.year)?new ld("invalid input"):null,n=s?null:n,r=s?null:a}this._zone=i,this.loc=e.loc||fn.create(),this.invalid=s,this.weekData=null,this.localWeekData=null,this.c=n,this.o=r,this.isLuxonDateTime=!0}static now(){return new ui({})}static local(){const[e,i]=CQ(arguments),[s,n,r,o,a,l,u]=i;return SQ({year:s,month:n,day:r,hour:o,minute:a,second:l,millisecond:u},e)}static utc(){const[e,i]=CQ(arguments),[s,n,r,o,a,l,u]=i;return e.zone=ra.utcInstance,SQ({year:s,month:n,day:r,hour:o,minute:a,second:l,millisecond:u},e)}static fromJSDate(e,i={}){const s=WMe(e)?e.valueOf():NaN;if(Number.isNaN(s))return ui.invalid("invalid input");const n=z_(i.zone,Vr.defaultZone);return n.isValid?new ui({ts:s,zone:n,loc:fn.fromObject(i)}):ui.invalid(_C(n))}static fromMillis(e,i={}){if(iy(e))return e<-864e13||e>pIe?ui.invalid("Timestamp out of range"):new ui({ts:e,zone:z_(i.zone,Vr.defaultZone),loc:fn.fromObject(i)});throw new Qa(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,i={}){if(iy(e))return new ui({ts:e*1e3,zone:z_(i.zone,Vr.defaultZone),loc:fn.fromObject(i)});throw new Qa("fromSeconds requires a numerical input")}static fromObject(e,i={}){e=e||{};const s=z_(i.zone,Vr.defaultZone);if(!s.isValid)return ui.invalid(_C(s));const n=fn.fromObject(i),r=BO(e,wQ),{minDaysInFirstWeek:o,startOfWeek:a}=cQ(r,n),l=Vr.now(),u=Ji(i.specificOffset)?s.offset(l):i.specificOffset,c=!Ji(r.ordinal),h=!Ji(r.year),d=!Ji(r.month)||!Ji(r.day),m=h||d,f=r.weekYear||r.weekNumber;if((m||c)&&f)throw new ow("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(d&&c)throw new ow("Can't mix ordinal dates with month/day");const _=f||r.weekday&&!m;let v,x,w=vD(l,u);_?(v=_Ie,x=fIe,w=zO(w,o,a)):c?(v=yIe,x=gIe,w=pU(w)):(v=gde,x=fde);let T=!1;for(const O of v){const U=r[O];Ji(U)?T?r[O]=x[O]:r[O]=w[O]:T=!0}const C=_?jMe(r,o,a):c?YMe(r):zhe(r),M=C||Ghe(r);if(M)return ui.invalid(M);const A=_?lQ(r,o,a):c?uQ(r):r,[I,L]=DR(A,u,s),D=new ui({ts:I,zone:s,o:L,loc:n});return r.weekday&&m&&e.weekday!==D.weekday?ui.invalid("mismatched weekday",`you can't specify both a weekday of ${r.weekday} and a date of ${D.toISO()}`):D.isValid?D:ui.invalid(D.invalid)}static fromISO(e,i={}){const[s,n]=$Ae(e);return Lx(s,n,i,"ISO 8601",e)}static fromRFC2822(e,i={}){const[s,n]=UAe(e);return Lx(s,n,i,"RFC 2822",e)}static fromHTTP(e,i={}){const[s,n]=VAe(e);return Lx(s,n,i,"HTTP",i)}static fromFormat(e,i,s={}){if(Ji(e)||Ji(i))throw new Qa("fromFormat requires an input string and a format");const{locale:n=null,numberingSystem:r=null}=s,o=fn.fromOpts({locale:n,numberingSystem:r,defaultToEN:!0}),[a,l,u,c]=mIe(o,e,i);return c?ui.invalid(c):Lx(a,l,s,`format ${i}`,e,u)}static fromString(e,i,s={}){return ui.fromFormat(e,i,s)}static fromSQL(e,i={}){const[s,n]=YAe(e);return Lx(s,n,i,"SQL",e)}static invalid(e,i=null){if(!e)throw new Qa("need to specify a reason the DateTime is invalid");const s=e instanceof ld?e:new ld(e,i);if(Vr.throwOnInvalid)throw new vMe(s);return new ui({invalid:s})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,i={}){const s=mde(e,fn.fromObject(i));return s?s.map(n=>n?n.val:null).join(""):null}static expandFormat(e,i={}){return cde(tl.parseFormat(e),fn.fromObject(i)).map(n=>n.val).join("")}static resetCache(){NR=void 0,RR={}}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?_U(this).weekYear:NaN}get weekNumber(){return this.isValid?_U(this).weekNumber:NaN}get weekday(){return this.isValid?_U(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?yU(this).weekday:NaN}get localWeekNumber(){return this.isValid?yU(this).weekNumber:NaN}get localWeekYear(){return this.isValid?yU(this).weekYear:NaN}get ordinal(){return this.isValid?pU(this.c).ordinal:NaN}get monthShort(){return this.isValid?_D.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?_D.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?_D.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?_D.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const e=864e5,i=6e4,s=FF(this.c),n=this.zone.offset(s-e),r=this.zone.offset(s+e),o=this.zone.offset(s-n*i),a=this.zone.offset(s-r*i);if(o===a)return[this];const l=s-o*i,u=s-a*i,c=vD(l,o),h=vD(u,a);return c.hour===h.hour&&c.minute===h.minute&&c.second===h.second&&c.millisecond===h.millisecond?[_0(this,{ts:l}),_0(this,{ts:u})]:[this]}get isInLeapYear(){return YM(this.year)}get daysInMonth(){return GO(this.year,this.month)}get daysInYear(){return this.isValid?Ew(this.year):NaN}get weeksInWeekYear(){return this.isValid?TP(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?TP(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(e={}){const{locale:i,numberingSystem:s,calendar:n}=tl.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:i,numberingSystem:s,outputCalendar:n}}toUTC(e=0,i={}){return this.setZone(ra.instance(e),i)}toLocal(){return this.setZone(Vr.defaultZone)}setZone(e,{keepLocalTime:i=!1,keepCalendarTime:s=!1}={}){if(e=z_(e,Vr.defaultZone),e.equals(this.zone))return this;if(e.isValid){let n=this.ts;if(i||s){const r=e.offset(this.ts),o=this.toObject();[n]=DR(o,r,e)}return _0(this,{ts:n,zone:e})}else return ui.invalid(_C(e))}reconfigure({locale:e,numberingSystem:i,outputCalendar:s}={}){const n=this.loc.clone({locale:e,numberingSystem:i,outputCalendar:s});return _0(this,{loc:n})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;const i=BO(e,wQ),{minDaysInFirstWeek:s,startOfWeek:n}=cQ(i,this.loc),r=!Ji(i.weekYear)||!Ji(i.weekNumber)||!Ji(i.weekday),o=!Ji(i.ordinal),a=!Ji(i.year),l=!Ji(i.month)||!Ji(i.day),u=a||l,c=i.weekYear||i.weekNumber;if((u||o)&&c)throw new ow("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(l&&o)throw new ow("Can't mix ordinal dates with month/day");let h;r?h=lQ({...zO(this.c,s,n),...i},s,n):Ji(i.ordinal)?(h={...this.toObject(),...i},Ji(i.day)&&(h.day=Math.min(GO(h.year,h.month),h.day))):h=uQ({...pU(this.c),...i});const[d,m]=DR(h,this.o,this.zone);return _0(this,{ts:d,o:m})}plus(e){if(!this.isValid)return this;const i=qs.fromDurationLike(e);return _0(this,xQ(this,i))}minus(e){if(!this.isValid)return this;const i=qs.fromDurationLike(e).negate();return _0(this,xQ(this,i))}startOf(e,{useLocaleWeeks:i=!1}={}){if(!this.isValid)return this;const s={},n=qs.normalizeUnit(e);switch(n){case"years":s.month=1;case"quarters":case"months":s.day=1;case"weeks":case"days":s.hour=0;case"hours":s.minute=0;case"minutes":s.second=0;case"seconds":s.millisecond=0;break}if(n==="weeks")if(i){const r=this.loc.getStartOfWeek(),{weekday:o}=this;o<r&&(s.weekNumber=this.weekNumber-1),s.weekday=r}else s.weekday=1;if(n==="quarters"){const r=Math.ceil(this.month/3);s.month=(r-1)*3+1}return this.set(s)}endOf(e,i){return this.isValid?this.plus({[e]:1}).startOf(e,i).minus(1):this}toFormat(e,i={}){return this.isValid?tl.create(this.loc.redefaultToEN(i)).formatDateTimeFromString(this,e):gU}toLocaleString(e=VO,i={}){return this.isValid?tl.create(this.loc.clone(i),e).formatDateTime(this):gU}toLocaleParts(e={}){return this.isValid?tl.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:i=!1,suppressMilliseconds:s=!1,includeOffset:n=!0,extendedZone:r=!1}={}){if(!this.isValid)return null;const o=e==="extended";let a=vU(this,o);return a+="T",a+=bQ(this,o,i,s,n,r),a}toISODate({format:e="extended"}={}){return this.isValid?vU(this,e==="extended"):null}toISOWeekDate(){return xD(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:i=!1,includeOffset:s=!0,includePrefix:n=!1,extendedZone:r=!1,format:o="extended"}={}){return this.isValid?(n?"T":"")+bQ(this,o==="extended",i,e,s,r):null}toRFC2822(){return xD(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return xD(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?vU(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:i=!1,includeOffsetSpace:s=!0}={}){let n="HH:mm:ss.SSS";return(i||e)&&(s&&(n+=" "),i?n+="z":e&&(n+="ZZ")),xD(this,n,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():gU}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};const i={...this.c};return e.includeConfig&&(i.outputCalendar=this.outputCalendar,i.numberingSystem=this.loc.numberingSystem,i.locale=this.loc.locale),i}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,i="milliseconds",s={}){if(!this.isValid||!e.isValid)return qs.invalid("created by diffing an invalid DateTime");const n={locale:this.locale,numberingSystem:this.numberingSystem,...s},r=ZMe(i).map(qs.normalizeUnit),o=e.valueOf()>this.valueOf(),a=o?this:e,l=o?e:this,u=eIe(a,l,r,n);return o?u.negate():u}diffNow(e="milliseconds",i={}){return this.diff(ui.now(),e,i)}until(e){return this.isValid?Ur.fromDateTimes(this,e):this}hasSame(e,i,s){if(!this.isValid)return!1;const n=e.valueOf(),r=this.setZone(e.zone,{keepLocalTime:!0});return r.startOf(i,s)<=n&&n<=r.endOf(i,s)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;const i=e.base||ui.fromObject({},{zone:this.zone}),s=e.padding?this<i?-e.padding:e.padding:0;let n=["years","months","days","hours","minutes","seconds"],r=e.unit;return Array.isArray(e.unit)&&(n=e.unit,r=void 0),EQ(i,this.plus(s),{...e,numeric:"always",units:n,unit:r})}toRelativeCalendar(e={}){return this.isValid?EQ(e.base||ui.fromObject({},{zone:this.zone}),this,{...e,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...e){if(!e.every(ui.isDateTime))throw new Qa("min requires all arguments be DateTimes");return hQ(e,i=>i.valueOf(),Math.min)}static max(...e){if(!e.every(ui.isDateTime))throw new Qa("max requires all arguments be DateTimes");return hQ(e,i=>i.valueOf(),Math.max)}static fromFormatExplain(e,i,s={}){const{locale:n=null,numberingSystem:r=null}=s,o=fn.fromOpts({locale:n,numberingSystem:r,defaultToEN:!0});return dde(o,e,i)}static fromStringExplain(e,i,s={}){return ui.fromFormatExplain(e,i,s)}static buildFormatParser(e,i={}){const{locale:s=null,numberingSystem:n=null}=i,r=fn.fromOpts({locale:s,numberingSystem:n,defaultToEN:!0});return new hde(r,e)}static fromFormatParser(e,i,s={}){if(Ji(e)||Ji(i))throw new Qa("fromFormatParser requires an input string and a format parser");const{locale:n=null,numberingSystem:r=null}=s,o=fn.fromOpts({locale:n,numberingSystem:r,defaultToEN:!0});if(!o.equals(i.locale))throw new Qa(`fromFormatParser called with a locale of ${o}, but the format parser was created for ${i.locale}`);const{result:a,zone:l,specificOffset:u,invalidReason:c}=i.explainFromTokens(e);return c?ui.invalid(c):Lx(a,l,s,`format ${i.format}`,e,u)}static get DATE_SHORT(){return VO}static get DATE_MED(){return yhe}static get DATE_MED_WITH_WEEKDAY(){return wMe}static get DATE_FULL(){return vhe}static get DATE_HUGE(){return xhe}static get TIME_SIMPLE(){return bhe}static get TIME_WITH_SECONDS(){return whe}static get TIME_WITH_SHORT_OFFSET(){return She}static get TIME_WITH_LONG_OFFSET(){return Ehe}static get TIME_24_SIMPLE(){return Che}static get TIME_24_WITH_SECONDS(){return The}static get TIME_24_WITH_SHORT_OFFSET(){return Phe}static get TIME_24_WITH_LONG_OFFSET(){return Mhe}static get DATETIME_SHORT(){return Ahe}static get DATETIME_SHORT_WITH_SECONDS(){return Ihe}static get DATETIME_MED(){return Dhe}static get DATETIME_MED_WITH_SECONDS(){return Nhe}static get DATETIME_MED_WITH_WEEKDAY(){return SMe}static get DATETIME_FULL(){return Rhe}static get DATETIME_FULL_WITH_SECONDS(){return Ohe}static get DATETIME_HUGE(){return Lhe}static get DATETIME_HUGE_WITH_SECONDS(){return Fhe}}function C2(t){if(ui.isDateTime(t))return t;if(t&&t.valueOf&&iy(t.valueOf()))return ui.fromJSDate(t);if(t&&typeof t=="object")return ui.fromObject(t);throw new Qa(`Unknown datetime argument: ${t}, of type ${typeof t}`)}const bIe="HH:mm",wIe="HH:mm:ss",SIe="HH:mm:ss.SSS",EIe=[SIe,wIe,bIe,"TT"],CIe="yyyy-MM-dd";function TQ(t){if(!t||!jM(t))return null;const e=ui.fromFormat(t,CIe);return e.isValid?e:null}function PQ(t){return t&&jM(t)?p2e(EIe,e=>{const i=ui.fromFormat(t,e);return i.isValid?i:null})??null:null}function MQ(t){if(!t||!jM(t))return null;const e=ui.fromISO(t);return e.isValid?e:null}var qO;(function(t){t.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range",t.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(qO||(qO={}));const _de=new Set(["integer","small-integer","big-integer","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger"]);function TIe(t){return t!=null&&_de.has(t.type)}function yde(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function vde(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function xde(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}const PIe=new Set(["single","double","esriFieldTypeSingle","esriFieldTypeDouble"]);fH(_de,PIe);function Cgt(t,e){const i=t==null?void 0:t.domain;if(!i||i.type!=="range")return;const s="range"in i?i.range[0]:i.minValue,n="range"in i?i.range[1]:i.maxValue,r=TIe(t);return yde(t)||xde(t)||vde(t)?{...MIe(t,n,s),isInteger:r}:{min:s!=null&&typeof s=="number"?s:null,max:n!=null&&typeof n=="number"?n:null,rawMin:s,rawMax:n,isInteger:r}}function MIe(t,e,i){var s,n,r,o,a,l;return yde(t)?{min:(s=TQ(i))==null?void 0:s.toMillis(),max:(n=TQ(e))==null?void 0:n.toMillis(),rawMin:i,rawMax:e}:xde(t)?{min:(r=PQ(i))==null?void 0:r.toMillis(),max:(o=PQ(e))==null?void 0:o.toMillis(),rawMin:i,rawMax:e}:vde(t)?{min:(a=MQ(i))==null?void 0:a.toMillis(),max:(l=MQ(e))==null?void 0:l.toMillis(),rawMin:i,rawMax:e}:{max:null,min:null}}function AIe(t){if(!t)return;const e=t.match(IIe);return e!=null&&e.groups?e.groups.doubleQuoted??e.groups.singleQuoted??e.groups.dotNotation:void 0}const IIe=/^(\$feature\[(?:"(?<doubleQuoted>[^"]+)"|'(?<singleQuoted>[^']+)')\]|\$feature\.(?<dotNotation>[a-zA-Z_][a-zA-Z0-9_]*))$/i;function DIe(t){var e,i;return((i=(e=t.match(NIe))==null?void 0:e[1])==null?void 0:i.replace(/\\'/g,"'"))??null}const NIe=/^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;let td=class{};function RIe(t){return t instanceof V1?t===td.instance:(t==null?void 0:t.toString().toLowerCase())==="unknown"}function Pgt(t){return RIe(t)?td.instance:t}td.instance=new Eu("Etc/UTC");var HO;(function(t){t.TimeZoneNotRecognized="TimeZoneNotRecognized"})(HO||(HO={}));const OIe={[HO.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};let LIe=class bde extends Error{constructor(e,i){super(_F(OIe[e],i)),this.declaredRootClass="esri.arcade.arcadedate.dateerror",Error.captureStackTrace&&Error.captureStackTrace(this,bde)}};function Fx(t,e,i){return t<e?t-e:t>i?t-i:0}function kx(t,e,i){return t<e?e:t>i?i:t}let bD=class Yr{constructor(e){this._date=e,this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(e=0,i=1,s=1,n=0,r=0,o=0,a=0,l){if(isNaN(e)||isNaN(i)||isNaN(s)||isNaN(n)||isNaN(r)||isNaN(o)||isNaN(a))return null;const u=ui.local(e,i).daysInMonth;let c=ui.fromObject({day:kx(s,1,u),year:e,month:kx(i,1,12),hour:kx(n,0,23),minute:kx(r,0,59),second:kx(o,0,59),millisecond:kx(a,0,999)},{zone:y0(l)});return c=c.plus({months:Fx(i,1,12),days:Fx(s,1,u),hours:Fx(n,0,23),minutes:Fx(r,0,59),seconds:Fx(o,0,59),milliseconds:Fx(a,0,999)}),new Yr(c)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(e,i){const s=y0(i);return e.isUnknownTimeZone||s===td.instance?Yr.fromParts(e.year,e.monthJS+1,e.day,e.hour,e.minute,e.second,e.millisecond,s):new Yr(e._date.setZone(s))}static dateJSToArcadeDate(e){return new Yr(ui.fromJSDate(e,{zone:"system"}))}static dateJSAndZoneToArcadeDate(e,i="system"){const s=y0(i);return new Yr(ui.fromJSDate(e,{zone:s}))}static unknownEpochToArcadeDate(e){return new Yr(ui.fromMillis(e,{zone:td.instance}))}static unknownDateJSToArcadeDate(e){return new Yr(ui.fromMillis(e.getTime(),{zone:td.instance}))}static epochToArcadeDate(e,i="system"){const s=y0(i);return new Yr(ui.fromMillis(e,{zone:s}))}static dateTimeToArcadeDate(e){return new Yr(e)}clone(){return new Yr(this._date)}changeTimeZone(e){const i=y0(e);return Yr.dateTimeToArcadeDate(this._date.setZone(i))}static dateTimeAndZoneToArcadeDate(e,i){const s=y0(i);return e.zone===td.instance||s===td.instance?Yr.fromParts(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond,s):new Yr(e.setZone(s))}static nowToArcadeDate(e){const i=y0(e);return new Yr(ui.fromJSDate(new Date,{zone:i}))}static nowUTCToArcadeDate(){return new Yr(ui.utc())}get isSystem(){return this.timeZone==="system"||this.timeZone===Yr.systemTimeZoneCanonicalName}equals(e){return this.isSystem&&e.isSystem?this.toNumber()===e.toNumber():this.isUnknownTimeZone===e.isUnknownTimeZone&&this._date.equals(e._date)}get isUnknownTimeZone(){return this._date.zone===td.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let e=this._date.weekday;return e>6&&(e=0),e}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if(this._date.zone.type==="system")return"system";const e=this.zone;return e.type==="fixed"?e.fixed===0?"UTC":e.formatOffset(0,"short"):e.name}stringify(){return JSON.stringify(this.toJSDate())}plus(e){return new Yr(this._date.plus(e))}diff(e,i="milliseconds"){return this._date.diff(e._date,i)[i]}toISODate(){return this._date.toISODate()}toISOString(e){return e?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(e,i){return this._date.toISOTime({suppressMilliseconds:e,includeOffset:i&&!this.isUnknownTimeZone})}toFormat(e,i){return this.isUnknownTimeZone&&(e=e.replaceAll("Z","")),this._date.toFormat(e,i)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new Yr(this._date.toUTC())}toLocal(){return new Yr(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(e){if(!e)return null;const i=ui.fromISO(e,{setZone:!0});return new Yr(i)}};function y0(t,e=!0){if(t instanceof V1)return t;if(t.toLowerCase()==="system")return"system";if(t.toLowerCase()==="utc")return"UTC";if(t.toLowerCase()==="unknown")return td.instance;if(/^[+-]?[0-9]{1,2}([:][0-9]{2})?$/.test(t)){const s=ra.parseSpecifier("UTC"+(t.startsWith("+")||t.startsWith("-")?"":"+")+t);if(s)return s}const i=Eu.create(t);if(!i.isValid){if(e)throw new LIe(HO.TimeZoneNotRecognized);return null}return i}const FIe=()=>ht.getLogger("esri.support.arcadeOnDemand"),kIe=["geometry","scale","timeProperties"];function Mgt(t,e){if(e!=null)for(const i of kIe)e.hasArcadeDependency(i)&&t.add(i);return t}let xU;function gy(){return xU||(xU=(async()=>{const t=await _e(()=>import("./arcadeUtils-BbybX28j.js"),__vite__mapDeps([7,8,9,10,11,6,12,13,14,15,16,5]));return{arcade:t.arcade,arcadeUtils:t,Dictionary:t.Dictionary,Feature:t.arcadeFeature,Voxel:t.Voxel}})()),xU}const Agt=(t,e,i)=>wde.create(t,e,i,null,["$feature","$view"],[]),$Ie=(t,e,i,s)=>wde.create(t,e,i,s,["$feature","$view"],[]);let wde=class Sde{constructor(e,i,s,n,r,o,a){this._dependencies=new Map,this.services=null,this.script=e,this.evaluate=n;const l=Array.isArray(o)?o:o==null?void 0:o.fields;this.fields=l??[],this._syntaxTree=s,this._arcade=i,this._arcadeFeature=r,this._spatialReference=a,this._dependencies.set("geometry",i.scriptTouchesGeometry(this._syntaxTree)),this._dependencies.set("scale",this._arcade.referencesMember(this._syntaxTree,"scale")),this._dependencies.set("timeProperties",this._arcade.scriptUsesViewProperties(this._syntaxTree,["timeProperties"]))}static async create(e,i,s,n,r,o){const{arcade:a,Feature:l,Dictionary:u}=await gy(),c=i instanceof Ri?i:Ri.fromJSON(i);let h;try{h=a.parseScript(e,o)}catch(L){return FIe().error(new Se("arcade-bad-expression","Failed to parse arcade script",{script:e,error:L})),null}const d=r.reduce((L,D)=>({...L,[D]:null}),{});let m=null;n!=null&&(m=new u(n),m.immutable=!0,d.$config=null);const f=a.scriptUsesGeometryEngine(h),_=f&&a.enableGeometrySupport(),v=a.scriptUsesFeatureSet(h)&&a.enableFeatureSetSupport(),x=a.scriptIsAsync(h),w=x&&a.enableAsyncSupport(),T={vars:d,spatialReference:c,useAsync:!!w};await Promise.all([_,v,w]);const C=new Set;await a.loadDependentModules(C,h,null,x,f);const M=new u;M.immutable=!1,M.setField("scale",0);const A=a.compileScript(h,T),I=(L,D)=>{var U;const O=(U=L.$view)==null?void 0:U.timeZone;if("$view"in L&&L.$view){let $;if(M.setField("scale",typeof L.$view=="object"&&"scale"in L.$view?L.$view.scale:void 0),typeof L.$view=="object"&&"timeProperties"in L.$view&&L.$view.timeProperties!=null){const{currentStart:B,currentEnd:V}=L.$view.timeProperties;$=new u({currentStart:B!=null?O!=null?bD.epochToArcadeDate(B,O):bD.unknownEpochToArcadeDate(B):void 0,currentEnd:V!=null?O!=null?bD.epochToArcadeDate(V,O):bD.unknownEpochToArcadeDate(V):void 0,startIncluded:!0,endIncluded:!0})}M.setField("timeProperties",$),L.$view=M}return m&&(L.$config=m),A({vars:L,spatialReference:c,services:D,timeZone:O})};return new Sde(e,a,h,I,new l,s,c)}repurposeFeature(e){return e.geometry&&!e.geometry.spatialReference&&(e.geometry.spatialReference=this._spatialReference),this._arcadeFeature.repurposeFromGraphicLikeObject(e.geometry,e.attributes,{fields:this.fields}),this._arcadeFeature}references(e){return this._dependencies.get(e)??!1}};const UIe=/^([0-9_])/,VIe=/[^a-z0-9_\u0080-\uffff]+/gi;function zIe(t){return t==null?null:t.trim().replaceAll(VIe,"_").replace(UIe,"F$1")||null}const GIe=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],BIe=["field","normalizationField"];function AQ(t,e){if(t!=null&&e!=null){for(const i of Array.isArray(t)?t:[t])if(IQ(GIe,i,e),"visualVariables"in i&&i.visualVariables)for(const s of i.visualVariables)IQ(BIe,s,e)}}function IQ(t,e,i){if(t)for(const s of t){const n=gF(s,e),r=n&&typeof n!="function"&&i.get(n);r&&la(s,r.name,e)}}function Ede(t,e){var i;if(t!=null&&((i=e==null?void 0:e.fields)!=null&&i.length))if("startField"in t){const s=e.get(t.startField),n=e.get(t.endField);t.startField=(s==null?void 0:s.name)??null,t.endField=(n==null?void 0:n.name)??null}else{const s=e.get(t.startTimeField),n=e.get(t.endTimeField);t.startTimeField=(s==null?void 0:s.name)??null,t.endTimeField=(n==null?void 0:n.name)??null}}const bU=new Set;function UF(t,e){return t&&e?(bU.clear(),m1(bU,t,e),Array.from(bU).sort()):[]}function m1(t,e,i){var s;if(i)if((s=e==null?void 0:e.fields)!=null&&s.length)if(i.includes("*"))for(const{name:n}of e.fields)t.add(n);else for(const n of i)Ll(t,e,n);else{if(i.includes("*"))return t.clear(),void t.add("*");for(const n of i)n!=null&&t.add(n)}}function Ll(t,e,i){if(typeof i=="string")if(e){const s=e.get(i);s&&t.add(s.name)}else t.add(i)}function Igt(t,e){return e==null||t==null?[]:e.includes("*")?(t.fields??[]).map(i=>i.name):e}function Dgt(t,e,i=1){if(!e||!t)return[];if(e.includes("*"))return["*"];const s=UF(t,e);return s.length/t.fields.length>=i?["*"]:s}async function al(t,e,i){var r;if(!i)return;let s;const n=AIe(i);if(n)s=[n];else{const{arcadeUtils:o}=await gy();s=o.extractFieldNames(i,(r=e==null?void 0:e.fields)==null?void 0:r.map(a=>a.name))}for(const o of s)Ll(t,e,o)}async function KH(t,e,i){if(i&&i!=="1=1"){const s=await ghe(i,e);if(!s.isStandardized)throw new Se("fieldUtils:collectFilterFields","Where clause is not standardized",{where:i});m1(t,e,s.fieldNames)}}function qIe({displayField:t,fields:e}){return t||(e!=null&&e.length?wU(e,"name-or-title")||wU(e,"unique-identifier")||wU(e,"type-or-category")||HIe(e):null)}function HIe(t){for(const e of t){if(!(e!=null&&e.name))continue;const i=e.name.toLowerCase();if(i.includes("name")||i.includes("title"))return e.name}return null}function wU(t,e){for(const i of t)if(i!=null&&i.valueType&&i.valueType===e)return i.name;return null}async function Ngt(t,e){var s;if(!e)return;const i=(s=e.elevationInfo)==null?void 0:s.featureExpressionInfo;return i?i.collectRequiredFields(t,e.fieldsIndex):void 0}function jIe(t,e,i){i.onStatisticExpression?al(t,e,i.onStatisticExpression.expression):t.add(i.onStatisticField)}async function Rgt(t,e,i){if(!e||!i||!("fields"in i))return;const s=[],n=i.popupTemplate;s.push(Cde(t,e,n)),i.fields&&s.push(...i.fields.map(async r=>jIe(t,e.fieldsIndex,r))),await Promise.all(s)}async function Ogt(t,e){var r,o,a;const{fieldsIndex:i,trackInfo:s}=e;if(!e||!s||!i)return;const n=[(r=s.latestObservations.renderer)==null?void 0:r.collectRequiredFields(t,i),(o=s.previousObservations.renderer)==null?void 0:o.collectRequiredFields(t,i),(a=s.trackLines.renderer)==null?void 0:a.collectRequiredFields(t,i)];s.popupTemplate&&n.push(Cde(t,e,s.popupTemplate));for(const l of[s.latestObservations.labelingInfo,s.previousObservations.labelingInfo,s.trackLines.labelingInfo])if(l)for(const u of l)n.push(Mde(t,i,u));await Promise.all(n)}async function Cde(t,e,i){const s=[];i!=null&&i.expressionInfos&&s.push(...i.expressionInfos.map(r=>al(t,e.fieldsIndex,r.expression)));const n=i==null?void 0:i.content;if(Array.isArray(n))for(const r of n)r.type==="expression"&&r.expressionInfo&&s.push(al(t,e.fieldsIndex,r.expressionInfo.expression));await Promise.all(s)}async function Lgt(t,e,i){e&&(e.timeInfo&&(i!=null&&i.timeExtent)&&m1(t,e.fieldsIndex,[e.timeInfo.startField,e.timeInfo.endField]),e.floorInfo&&m1(t,e.fieldsIndex,[e.floorInfo.floorField]),(i==null?void 0:i.where)!=null&&await KH(t,e.fieldsIndex,i.where))}async function Fgt(t,e,i){e&&i&&await Promise.all(i.map(s=>YIe(t,e,s)))}async function YIe(t,e,i){e&&i&&(i.valueExpression?await al(t,e.fieldsIndex,i.valueExpression):i.field&&Ll(t,e.fieldsIndex,i.field))}function kgt(t){return t?UF(t.fieldsIndex,Tde(t)):[]}function XIe(t){if(!t)return[];const e=t.geometryFieldsInfo;return e?UF(t.fieldsIndex,[e.shapeAreaField,e.shapeLengthField]):[]}async function $gt(t,e,i){if(!e||!i)return;const s=e.fieldsIndex;await Promise.all(i.filters.map(n=>KH(t,s,n.where)))}const WIe=new Set(["oid","global-id","guid"]),ZIe=new Set(["oid","global-id"]),KIe=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^shape$/i,/^shape_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/perimeter/i,/objectid/i,/_i$/i];function QIe(t){const e=new Set;Pde(t).forEach(s=>e.add(s)),XIe(t).forEach(s=>e.add(s.toLowerCase()));const i=t&&"infoFor3D"in t?t.infoFor3D:void 0;return i&&(Object.values(i.assetMapFieldRoles).forEach(s=>e.add(s.toLowerCase())),Object.values(i.transformFieldRoles).forEach(s=>e.add(s.toLowerCase()))),Array.from(e)}function Tde(t){if(!t)return[];const e="editFieldsInfo"in t&&t.editFieldsInfo;if(!e)return[];const{creationDateField:i,creatorField:s,editDateField:n,editorField:r}=e;return[i,s,n,r].filter(Boolean)}function Pde(t){return Tde(t).map(e=>e.toLowerCase())}function JIe(t,e){var i;return t.editable&&!WIe.has(t.type)&&!Pde(e).includes(((i=t.name)==null?void 0:i.toLowerCase())??"")}function eDe(t,e){var s;const i=((s=t.name)==null?void 0:s.toLowerCase())??"";return!((e==null?void 0:e.objectIdField)!=null&&i===e.objectIdField.toLowerCase()||(e==null?void 0:e.globalIdField)!=null&&i===e.globalIdField.toLowerCase()||QIe(e).includes(i)||ZIe.has(t.type)||KIe.some(n=>n.test(i)))}async function Ugt(t,e){const{labelingInfo:i,fieldsIndex:s}=e;i!=null&&i.length&&await Promise.all(i.map(n=>Mde(t,s,n)))}async function Mde(t,e,i){if(!i)return;const s=i.getLabelExpression(),n=i.where;if(s.type==="arcade")await al(t,e,s.expression);else{const r=s.expression.match(/{[^}]*}/g);r&&r.forEach(o=>{Ll(t,e,o.slice(1,-1))})}await KH(t,e,n)}function tDe(t){const e=t.defaultValue;return e!==void 0&&Ide(t,e)?e:t.nullable?null:void 0}function Vgt(t){const e=typeof t=="string"?{type:t}:t;return Rde(e)?255:e.type==="esriFieldTypeDate"||e.type==="date"?8:void 0}function Ade(t){return typeof t=="number"&&!isNaN(t)&&isFinite(t)}function iDe(t){return t===null||Ade(t)}function sDe(t){return t===null||Number.isInteger(t)}function nDe(){return!0}function Ide(t,e){let i;switch(t.type){case"date":case"integer":case"long":case"small-integer":case"big-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":case"esriFieldTypeBigInteger":i=t.nullable?sDe:Number.isInteger;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":i=t.nullable?iDe:Ade;break;case"string":case"esriFieldTypeString":i=t.nullable?_Me:jM;break;default:i=nDe}return arguments.length===1?i:i(e)}const rDe=["integer","small-integer","big-integer"],oDe=["single","double"],aDe=["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger"],lDe=["esriFieldTypeSingle","esriFieldTypeDouble"],Dde=new Set([...rDe,...aDe]),uDe=new Set([...oDe,...lDe]),cDe=fH(Dde,uDe);function hDe(t){return t!=null&&Dde.has(t.type)}function Nde(t){return t!=null&&cDe.has(t.type)}function Rde(t){return t!=null&&(t.type==="string"||t.type==="esriFieldTypeString")}function dDe(t){return t!=null&&(t.type==="date"||t.type==="esriFieldTypeDate")}function zgt(t){return t!=null&&(t.type==="date-only"||t.type==="esriFieldTypeDateOnly")}function Ggt(t){return t!=null&&(t.type==="timestamp-offset"||t.type==="esriFieldTypeTimestampOffset")}function mDe(t){return t!=null&&(t.type==="time-only"||t.type==="esriFieldTypeTimeOnly")}function DQ(t){return t!=null&&(t.type==="oid"||t.type==="esriFieldTypeOID")}function NQ(t){return t!=null&&(t.type==="global-id"||t.type==="esriFieldTypeGlobalID")}function Bgt(t,e){return pDe(t,e)===null}var jO,YO;function qgt(t){return t==null||typeof t=="number"&&isNaN(t)?null:t}function pDe(t,e){return t==null||t.nullable&&e===null?null:Ide(t,e)?Nde(t)&&!fDe(t.type,Number(e))?jO.OUT_OF_RANGE:null:YO.INVALID_TYPE}function fDe(t,e){const i=typeof t=="string"?Ode(t):t;if(!i)return!1;const s=i.min,n=i.max;return i.isInteger?Number.isInteger(e)&&e>=s&&e<=n:e>=s&&e<=n}function Ode(t){switch(t){case"esriFieldTypeSmallInteger":case"small-integer":return gDe;case"esriFieldTypeInteger":case"integer":return _De;case"esriFieldTypeBigInteger":case"big-integer":return yDe;case"esriFieldTypeSingle":case"single":return vDe;case"esriFieldTypeDouble":case"double":return xDe}}(function(t){t.OUT_OF_RANGE="numeric-range-validation-error::out-of-range"})(jO||(jO={})),function(t){t.INVALID_TYPE="type-validation-error::invalid-type"}(YO||(YO={}));const gDe={min:-32768,max:32767,isInteger:!0,rawMin:-32768,rawMax:32767},_De={min:-2147483648,max:2147483647,isInteger:!0,rawMin:-2147483648,rawMax:2147483647},yDe={min:-Number.MAX_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,isInteger:!0,rawMin:-Number.MAX_SAFE_INTEGER,rawMax:Number.MAX_SAFE_INTEGER},vDe={min:-34e37,max:12e37,isInteger:!1,rawMin:-34e37,rawMax:12e37},xDe={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1,rawMin:-Number.MAX_VALUE,rawMax:Number.MAX_VALUE};function Hgt(t,e,i){switch(t){case qO.INVALID_CODED_VALUE:return`Value ${i} is not in the coded domain - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case qO.VALUE_OUT_OF_RANGE:return`Value ${i} is out of the range of valid values - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case YO.INVALID_TYPE:return`Value ${i} is not a valid value for the field type - field: ${e.name}, type: ${e.type}, nullable: ${e.nullable}`;case jO.OUT_OF_RANGE:{const{min:s,max:n}=Ode(e.type);return`Value ${i} is out of range for the number type - field: ${e.name}, type: ${e.type}, value range is ${s} to ${n}`}}}function bDe(t,e){return!wDe(t,e,null)}function wDe(t,e,i){if(!(e!=null&&e.attributes)||!t)return!0;const s=new Set(Object.keys(e.attributes));let n=!1;for(const r of t)if(!s.has(r)&&(n=!0,i==null))break;return n}function SDe(t){return!!t&&["raster.itempixelvalue","raster.servicepixelvalue"].some(e=>t.toLowerCase().startsWith(e))}function QH(t){const e=t==null?void 0:t.match(/{[^}]+}/g);return e?e.map(i=>i.slice(1,-1).split(":")[0].trim()):[]}let OR=class extends it{constructor(e){super(e),this.type=null}};y([S({type:["attachments","custom","fields","media","text","expression","relationship","utility-network-associations"],readOnly:!0,json:{read:!1,write:!0}})],OR.prototype,"type",void 0),OR=y([se("esri.popup.content.Content")],OR);const Yf=OR,wD=new gs({asc:"ascending",desc:"descending"});let yC=class extends bs.ClonableMixin(it){constructor(e){super(e),this.field=null,this.order="ascending"}};y([S({type:String,json:{write:!0}})],yC.prototype,"field",void 0),y([S({type:wD.apiValues,json:{type:wD.jsonValues,read:wD.read,write:wD.write}})],yC.prototype,"order",void 0),yC=y([se("esri.popup.support.AttachmentsOrderByInfo")],yC);const EDe=yC;let t_=class extends bs.ClonableMixin(Yf){constructor(e){super(e),this.description=null,this.displayType="auto",this.orderByFields=null,this.title=null,this.type="attachments"}};y([S({type:String,json:{write:!0}})],t_.prototype,"description",void 0),y([S({type:["auto","preview","list"],json:{write:!0}})],t_.prototype,"displayType",void 0),y([S({type:[EDe],json:{write:!0}})],t_.prototype,"orderByFields",void 0),y([S({type:String,json:{write:!0}})],t_.prototype,"title",void 0),y([S({type:["attachments"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],t_.prototype,"type",void 0),t_=y([se("esri.popup.content.AttachmentsContent")],t_);const oS=t_;var Jz;let k0=Jz=class extends Yf{constructor(t){super(t),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new Jz({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?be(this.outFields):null})}};y([S()],k0.prototype,"creator",void 0),y([S()],k0.prototype,"destroyer",void 0),y([S()],k0.prototype,"outFields",void 0),y([S({type:["custom"],readOnly:!0})],k0.prototype,"type",void 0),k0=Jz=y([se("esri.popup.content.CustomContent")],k0);const CDe=k0;var e6;let yb=e6=class extends it{constructor(t){super(t),this.title=null,this.expression=null,this.returnType="dictionary"}clone(){return new e6({title:this.title,expression:this.expression})}};y([S({type:String,json:{write:!0}})],yb.prototype,"title",void 0),y([S({type:String,json:{write:!0}})],yb.prototype,"expression",void 0),y([S({type:["dictionary"],readOnly:!0,json:{read:!1,write:!0}})],yb.prototype,"returnType",void 0),yb=e6=y([se("esri.popup.ElementExpressionInfo")],yb);const TDe=yb;var t6;let vC=t6=class extends Yf{constructor(t){super(t),this.expressionInfo=null,this.type="expression"}clone(){var t;return new t6({expressionInfo:(t=this.expressionInfo)==null?void 0:t.clone()})}};y([S({type:TDe,json:{write:!0}})],vC.prototype,"expressionInfo",void 0),y([S({type:["expression"],readOnly:!0,json:{read:!1,write:!0}})],vC.prototype,"type",void 0),vC=t6=y([se("esri.popup.content.ExpressionContent")],vC);const VF=vC;function ai(t,e={}){const i=t instanceof gs?t:new gs(t,e),{alwaysWriteDefaults:s,default:n,ignoreUnknown:r=!0,name:o,nonNullable:a,readOnly:l=!1}=e;return S({type:r?i.apiValues:String,json:{type:i.jsonValues,default:n,name:o,read:!l&&{reader:i.read},write:{writer:i.write,alwaysWriteDefaults:s}},nonNullable:a,readOnly:l})}let VT;var Ile,Dle;const PDe=((Ile=globalThis.esriConfig)==null?void 0:Ile.locale)??((Dle=globalThis.dojoConfig)==null?void 0:Dle.locale);var Nle;const zT=(Nle=globalThis.document)==null?void 0:Nle.documentElement;function Lde(){var i;const t=zT==null?void 0:zT.getAttribute("lang"),e=(i=globalThis.navigator)==null?void 0:i.language;return PDe??t??e??"en"}function vu(){return VT===void 0&&(VT=Lde()),VT}function Wgt(t=vu()){const e=/^([a-zA-Z]{2,3})(?:[_-][a-zA-Z0-9]+)*$/.exec(t);return e==null?void 0:e[1].toLowerCase()}const LR=[];function Fde(t){return LR.push(t),Gs(()=>LR.splice(LR.indexOf(t),1))}const FR=[];function JH(t){return FR.push(t),Gs(()=>FR.splice(FR.indexOf(t),1))}function RQ(){const t=Lde();VT!==t&&([...FR].forEach(e=>e(t)),VT=t,[...LR].forEach(e=>e(t)))}var Rle;(Rle=globalThis.addEventListener)==null||Rle.call(globalThis,"languagechange",RQ),zT&&new MutationObserver(()=>{RQ()}).observe(zT,{attributeFilter:["lang"]});const Fm="system",p1="unknown",_y="UTC",MDe=Intl.DateTimeFormat().resolvedOptions().timeZone,OQ=new Map([["AUS Central Standard Time","Australia/Darwin"],["AUS Eastern Standard Time","Australia/Sydney"],["Afghanistan Standard Time","Asia/Kabul"],["Alaskan Standard Time","America/Anchorage"],["Aleutian Standard Time","America/Adak"],["Altai Standard Time","Asia/Barnaul"],["Arab Standard Time","Asia/Riyadh"],["Arabian Standard Time","Asia/Dubai"],["Arabic Standard Time","Asia/Baghdad"],["Argentina Standard Time","America/Buenos_Aires"],["Astrakhan Standard Time","Europe/Astrakhan"],["Atlantic Standard Time","America/Halifax"],["Aus Central W. Standard Time","Australia/Eucla"],["Azerbaijan Standard Time","Asia/Baku"],["Azores Standard Time","Atlantic/Azores"],["Bahia Standard Time","America/Bahia"],["Bangladesh Standard Time","Asia/Dhaka"],["Belarus Standard Time","Europe/Minsk"],["Bougainville Standard Time","Pacific/Bougainville"],["Canada Central Standard Time","America/Regina"],["Cape Verde Standard Time","Atlantic/Cape_Verde"],["Caucasus Standard Time","Asia/Yerevan"],["Cen. Australia Standard Time","Australia/Adelaide"],["Central America Standard Time","America/Guatemala"],["Central Asia Standard Time","Asia/Bishkek"],["Central Brazilian Standard Time","America/Cuiaba"],["Central Europe Standard Time","Europe/Budapest"],["Central European Standard Time","Europe/Warsaw"],["Central Pacific Standard Time","Pacific/Guadalcanal"],["Central Standard Time","America/Chicago"],["Central Standard Time (Mexico)","America/Mexico_City"],["Chatham Islands Standard Time","Pacific/Chatham"],["China Standard Time","Asia/Shanghai"],["Cuba Standard Time","America/Havana"],["Dateline Standard Time","Etc/GMT+12"],["E. Africa Standard Time","Africa/Nairobi"],["E. Australia Standard Time","Australia/Brisbane"],["E. Europe Standard Time","Europe/Chisinau"],["E. South America Standard Time","America/Sao_Paulo"],["Easter Island Standard Time","Pacific/Easter"],["Eastern Standard Time","America/New_York"],["Eastern Standard Time (Mexico)","America/Cancun"],["Egypt Standard Time","Africa/Cairo"],["Ekaterinburg Standard Time","Asia/Yekaterinburg"],["FLE Standard Time","Europe/Kiev"],["Fiji Standard Time","Pacific/Fiji"],["GMT Standard Time","Europe/London"],["GTB Standard Time","Europe/Bucharest"],["Georgian Standard Time","Asia/Tbilisi"],["Greenland Standard Time","America/Godthab"],["Greenwich Standard Time","Atlantic/Reykjavik"],["Haiti Standard Time","America/Port-au-Prince"],["Hawaiian Standard Time","Pacific/Honolulu"],["India Standard Time","Asia/Calcutta"],["Iran Standard Time","Asia/Tehran"],["Israel Standard Time","Asia/Jerusalem"],["Jordan Standard Time","Asia/Amman"],["Kaliningrad Standard Time","Europe/Kaliningrad"],["Korea Standard Time","Asia/Seoul"],["Libya Standard Time","Africa/Tripoli"],["Line Islands Standard Time","Pacific/Kiritimati"],["Lord Howe Standard Time","Australia/Lord_Howe"],["Magadan Standard Time","Asia/Magadan"],["Magallanes Standard Time","America/Punta_Arenas"],["Marquesas Standard Time","Pacific/Marquesas"],["Mauritius Standard Time","Indian/Mauritius"],["Middle East Standard Time","Asia/Beirut"],["Montevideo Standard Time","America/Montevideo"],["Morocco Standard Time","Africa/Casablanca"],["Mountain Standard Time","America/Denver"],["Mountain Standard Time (Mexico)","America/Mazatlan"],["Myanmar Standard Time","Asia/Rangoon"],["N. Central Asia Standard Time","Asia/Novosibirsk"],["Namibia Standard Time","Africa/Windhoek"],["Nepal Standard Time","Asia/Katmandu"],["New Zealand Standard Time","Pacific/Auckland"],["Newfoundland Standard Time","America/St_Johns"],["Norfolk Standard Time","Pacific/Norfolk"],["North Asia East Standard Time","Asia/Irkutsk"],["North Asia Standard Time","Asia/Krasnoyarsk"],["North Korea Standard Time","Asia/Pyongyang"],["Omsk Standard Time","Asia/Omsk"],["Pacific SA Standard Time","America/Santiago"],["Pacific Standard Time","America/Los_Angeles"],["Pacific Standard Time (Mexico)","America/Tijuana"],["Pakistan Standard Time","Asia/Karachi"],["Paraguay Standard Time","America/Asuncion"],["Qyzylorda Standard Time","Asia/Qyzylorda"],["Romance Standard Time","Europe/Paris"],["Russia Time Zone 10","Asia/Srednekolymsk"],["Russia Time Zone 11","Asia/Kamchatka"],["Russia Time Zone 3","Europe/Samara"],["Russian Standard Time","Europe/Moscow"],["SA Eastern Standard Time","America/Cayenne"],["SA Pacific Standard Time","America/Bogota"],["SA Western Standard Time","America/La_Paz"],["SE Asia Standard Time","Asia/Bangkok"],["Saint Pierre Standard Time","America/Miquelon"],["Sakhalin Standard Time","Asia/Sakhalin"],["Samoa Standard Time","Pacific/Apia"],["Sao Tome Standard Time","Africa/Sao_Tome"],["Saratov Standard Time","Europe/Saratov"],["Singapore Standard Time","Asia/Singapore"],["South Africa Standard Time","Africa/Johannesburg"],["South Sudan Standard Time","Africa/Juba"],["Sri Lanka Standard Time","Asia/Colombo"],["Sudan Standard Time","Africa/Khartoum"],["Syria Standard Time","Asia/Damascus"],["Taipei Standard Time","Asia/Taipei"],["Tasmania Standard Time","Australia/Hobart"],["Tocantins Standard Time","America/Araguaina"],["Tokyo Standard Time","Asia/Tokyo"],["Tomsk Standard Time","Asia/Tomsk"],["Tonga Standard Time","Pacific/Tongatapu"],["Transbaikal Standard Time","Asia/Chita"],["Turkey Standard Time","Europe/Istanbul"],["Turks And Caicos Standard Time","America/Grand_Turk"],["US Eastern Standard Time","America/Indianapolis"],["US Mountain Standard Time","America/Phoenix"],["UTC","Etc/GMT"],["UTC+01","Etc/GMT-1"],["UTC+02","Etc/GMT-2"],["UTC+03","Etc/GMT-3"],["UTC+04","Etc/GMT-4"],["UTC+05","Etc/GMT-5"],["UTC+06","Etc/GMT-6"],["UTC+07","Etc/GMT-7"],["UTC+08","Etc/GMT-8"],["UTC+09","Etc/GMT-9"],["UTC+10","Etc/GMT-10"],["UTC+11","Etc/GMT-11"],["UTC+12","Etc/GMT-12"],["UTC+13","Etc/GMT-13"],["UTC+14","Etc/GMT-14"],["UTC-01","Etc/GMT+1"],["UTC-02","Etc/GMT+2"],["UTC-03","Etc/GMT+3"],["UTC-04","Etc/GMT+4"],["UTC-05","Etc/GMT+5"],["UTC-06","Etc/GMT+6"],["UTC-07","Etc/GMT+7"],["UTC-08","Etc/GMT+8"],["UTC-09","Etc/GMT+9"],["UTC-10","Etc/GMT+10"],["UTC-11","Etc/GMT+11"],["UTC-12","Etc/GMT+12"],["Ulaanbaatar Standard Time","Asia/Ulaanbaatar"],["Venezuela Standard Time","America/Caracas"],["Vladivostok Standard Time","Asia/Vladivostok"],["Volgograd Standard Time","Europe/Volgograd"],["W. Australia Standard Time","Australia/Perth"],["W. Central Africa Standard Time","Africa/Lagos"],["W. Europe Standard Time","Europe/Berlin"],["W. Mongolia Standard Time","Asia/Hovd"],["West Asia Standard Time","Asia/Tashkent"],["West Bank Standard Time","Asia/Hebron"],["West Pacific Standard Time","Pacific/Port_Moresby"],["Yakutsk Standard Time","Asia/Yakutsk"],["Yukon Standard Time","America/Whitehorse"]]),ADe="shortOffset";function IDe(t){return"timeZoneIANA"in t}function DDe(t){return t.startsWith("UTC")}function XO(t,e=!1){return{json:{read:{source:t,reader:(i,s)=>s[t]?kR(s[t]):null},write:!!e&&{allowNull:!0,writer(i,s){s[t]=i?NDe(i):null}}}}}function kR(t,e=Fm){return t?IDe(t)?t.timeZoneIANA:RDe(t,e):e}function NDe(t){return{timeZoneIANA:t}}function RDe(t,e=Fm){if(!t||!OQ.has(t.timeZone))return e;const i=OQ.get(t.timeZone);return DDe(t.timeZone)||t.respectsDaylightSaving?i:ODe(i)}function ODe(t){const e=ui.local().setZone(t),i=Math.min(e.set({month:1,day:1}).offset,e.set({month:5}).offset);return i===0?"Etc/UTC":`Etc/GMT${ra.instance(-i).formatOffset(0,"narrow")}`}function Zgt(t,e,i,s,n){if(e&&n==="date")return{timeZone:_y,timeZoneName:void 0};const r=s.timeStyle||s.hour,o=i===p1;return{timeZone:o?n==="timestamp-offset"?void 0:t??_y:i,timeZoneName:o&&r?ADe:void 0}}function LDe(t){const e=new Set(["etc/utc","etc/gmt","gmt"]),i=new Set(Intl.supportedValuesOf("timeZone").map(s=>s.toLowerCase()));return t===Fm||t===p1||e.has(t.toLowerCase())||i.has(t.toLowerCase())}const FDe={year:void 0,month:void 0,day:void 0,weekday:void 0},kDe={hour:void 0,minute:void 0,second:void 0},kde={timeZone:_y},jd={year:"numeric",month:"numeric",day:"numeric"},T2={year:"numeric",month:"long",day:"numeric"},P2={year:"numeric",month:"short",day:"numeric"},M2={year:"numeric",month:"long",weekday:"long",day:"numeric"},D_={hour:"numeric",minute:"numeric"},$0={...D_,second:"numeric"},$de={hourCycle:"h23"},A2={...D_,...$de},I2={...$0,...$de},Ude={"short-date":jd,"short-date-short-time":{...jd,...D_},"short-date-short-time-24":{...jd,...A2},"short-date-long-time":{...jd,...$0},"short-date-long-time-24":{...jd,...I2},"short-date-le":jd,"short-date-le-short-time":{...jd,...D_},"short-date-le-short-time-24":{...jd,...A2},"short-date-le-long-time":{...jd,...$0},"short-date-le-long-time-24":{...jd,...I2},"long-month-day-year":T2,"long-month-day-year-short-time":{...T2,...D_},"long-month-day-year-short-time-24":{...T2,...A2},"long-month-day-year-long-time":{...T2,...$0},"long-month-day-year-long-time-24":{...T2,...I2},"day-short-month-year":P2,"day-short-month-year-short-time":{...P2,...D_},"day-short-month-year-short-time-24":{...P2,...A2},"day-short-month-year-long-time":{...P2,...$0},"day-short-month-year-long-time-24":{...P2,...I2},"long-date":M2,"long-date-short-time":{...M2,...D_},"long-date-short-time-24":{...M2,...A2},"long-date-long-time":{...M2,...$0},"long-date-long-time-24":{...M2,...I2},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":D_,"long-time":$0},$De=ca()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"}),Vde={ar:"ar-u-nu-latn-ca-gregory"};let i6=new WeakMap;const zF=Ude["short-date-short-time"];function UDe(t){let e=i6.get(t);if(!e){const i=vu(),s=Vde[i]||i,n=t7(t.timeZone??Fm),r={...t,timeZone:n};e=new Intl.DateTimeFormat(s,r),i6.set(t,e)}return e}function Kgt(t){return Ude[t]}function e7(t,e=zF){return UDe(e).format(t)}function Qgt(t,e=zF){return e7(new Date(t),{...e,...kde,...kDe})}function Jgt(t,e=zF){return e7(new Date(`1970-01-01T${t}Z`),{...e,...kde,...FDe})}function e_t(t,e=zF){if(e.timeZone)return e7(new Date(t),e);const i=ui.fromISO(t,{setZone:!0}),s=vu(),n=Vde[s]??s,r=i.offset===0?_y:e.timeZone,o={...e,timeZone:r};return i.toLocaleString(o,{locale:n})}function t7(t){switch(t){case Fm:return MDe;case p1:return _y;default:return t}}JH(()=>{i6=new WeakMap});let vb=class extends bs.ClonableMixin(it){constructor(e){super(e),this.dateFormat=null,this.digitSeparator=!1,this.places=null}};y([ai($De)],vb.prototype,"dateFormat",void 0),y([S({type:Boolean,json:{write:!0}})],vb.prototype,"digitSeparator",void 0),y([S({type:zs,json:{write:!0}})],vb.prototype,"places",void 0),vb=y([se("esri.popup.support.FieldInfoFormat")],vb);const $R=vb;var s6;let Fh=s6=class extends it{constructor(t){super(t),this.fieldName=null,this.format=void 0,this.isEditable=!0,this.label=null,this.stringFieldOption="text-box",this.statisticType=null,this.tooltip=null,this.visible=!0}clone(){var t;return new s6({fieldName:this.fieldName,format:(t=this.format)==null?void 0:t.clone(),isEditable:this.isEditable,label:this.label,stringFieldOption:this.stringFieldOption,statisticType:this.statisticType,tooltip:this.tooltip,visible:this.visible})}};y([S({type:String,json:{write:!0}})],Fh.prototype,"fieldName",void 0),y([S({type:$R,json:{write:!0}})],Fh.prototype,"format",void 0),y([S({type:Boolean,json:{write:{alwaysWriteDefaults:!0},default:!0}})],Fh.prototype,"isEditable",void 0),y([S({type:String,json:{write:!0}})],Fh.prototype,"label",void 0),y([ai(new gs({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],Fh.prototype,"stringFieldOption",void 0),y([S({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],Fh.prototype,"statisticType",void 0),y([S({type:String,json:{write:!0}})],Fh.prototype,"tooltip",void 0),y([S({type:Boolean,json:{write:!0}})],Fh.prototype,"visible",void 0),Fh=s6=y([se("esri.popup.FieldInfo")],Fh);const i7=Fh;var n6;let Op=n6=class extends Yf{constructor(t){super(t),this.attributes=null,this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}writeFieldInfos(t,e){e.fieldInfos=t&&t.map(i=>i.toJSON())}clone(){return new n6(be({attributes:this.attributes,description:this.description,fieldInfos:this.fieldInfos,title:this.title}))}};y([S({type:Object,json:{write:!0}})],Op.prototype,"attributes",void 0),y([S({type:String,json:{write:!0}})],Op.prototype,"description",void 0),y([S({type:[i7]})],Op.prototype,"fieldInfos",void 0),y([yt("fieldInfos")],Op.prototype,"writeFieldInfos",null),y([S({type:String,json:{write:!0}})],Op.prototype,"title",void 0),y([S({type:["fields"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],Op.prototype,"type",void 0),Op=n6=y([se("esri.popup.content.FieldsContent")],Op);const aS=Op;let U0=class extends it{constructor(e){super(e),this.altText=null,this.caption="",this.title="",this.type=null}};y([S({type:String,json:{write:!0}})],U0.prototype,"altText",void 0),y([S({type:String,json:{write:!0}})],U0.prototype,"caption",void 0),y([S({type:String,json:{write:!0}})],U0.prototype,"title",void 0),y([S({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],U0.prototype,"type",void 0),U0=y([se("esri.popup.content.mixins.MediaInfo")],U0);const s7=U0,WO={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function zde(t){return!!WO[t]||!!WO[t.toLowerCase()]}function n7(t){return WO[t]??WO[t.toLowerCase()]}function VDe(t){return[...n7(t)]}function SU(t,e,i){i<0&&++i,i>1&&--i;const s=6*i;return s<1?t+(e-t)*s:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}function Gde(t,e,i,s=1){const n=(t%360+360)%360/360,r=i<=.5?i*(e+1):i+e-i*e,o=2*i-r;return[Math.round(255*SU(o,r,n+1/3)),Math.round(255*SU(o,r,n)),Math.round(255*SU(o,r,n-1/3)),s]}function zDe(t){const e=t.length>5,i=e?8:4,s=(1<<i)-1,n=e?1:17,r=e?t.length===9:t.length===5;let o=+("0x"+t.slice(1));if(isNaN(o))return null;const a=[0,0,0,1];let l;return r&&(l=o&s,o>>=i,a[3]=n*l/255),l=o&s,o>>=i,a[2]=n*l,l=o&s,o>>=i,a[1]=n*l,l=o&s,o>>=i,a[0]=n*l,a}const s_t=2.2;function SD(t){return sh(oH(t),0,255)}function ED(t,e,i){return t=Number(t),isNaN(t)?i:t<e?e:t>i?i:t}function CD(t,e){const i=t.toString(16).padStart(2,"0");return e?i.slice(0,1):i}let Gt=class Po{static blendColors(e,i,s,n=new Po){return n.r=Math.round(e.r+(i.r-e.r)*s),n.g=Math.round(e.g+(i.g-e.g)*s),n.b=Math.round(e.b+(i.b-e.b)*s),n.a=e.a+(i.a-e.a)*s,n._sanitize()}static fromRgb(e,i){const s=e.toLowerCase().match(/^(rgba?|hsla?)\(([\s.\-,%0-9]+)\)/);if(s){const n=s[2].split(/\s*,\s*/),r=s[1];if(r==="rgb"&&n.length===3||r==="rgba"&&n.length===4){const o=n[0];if(o.charAt(o.length-1)==="%"){const a=n.map(l=>2.56*parseFloat(l));return n.length===4&&(a[3]=parseFloat(n[3])),Po.fromArray(a,i)}return Po.fromArray(n.map(a=>parseFloat(a)),i)}if(r==="hsl"&&n.length===3||r==="hsla"&&n.length===4)return Po.fromArray(Gde(parseFloat(n[0]),parseFloat(n[1])/100,parseFloat(n[2])/100,parseFloat(n[3])),i)}return null}static fromHex(e,i=new Po){if(e[0]!=="#"||isNaN(+`0x${e.slice(1)}`))return null;switch(e.length){case 4:case 5:{const s=parseInt(e.slice(1,2),16),n=parseInt(e.slice(2,3),16),r=parseInt(e.slice(3,4),16),o=e.length===5?15:parseInt(e.slice(4),16);return Po.fromArray([s+16*s,n+16*n,r+16*r,(o+16*o)/255],i)}case 7:case 9:{const s=parseInt(e.slice(1,3),16),n=parseInt(e.slice(3,5),16),r=parseInt(e.slice(5,7),16),o=e.length===7?255:parseInt(e.slice(7),16);return Po.fromArray([s,n,r,o/255],i)}default:return null}}static fromArray(e,i=new Po){return i._set(Number(e[0]),Number(e[1]),Number(e[2]),Number(e[3])),isNaN(i.a)&&(i.a=1),i._sanitize()}static fromString(e,i){const s=zde(e)?n7(e):null;return s&&Po.fromArray(s,i)||Po.fromRgb(e,i)||Po.fromHex(e,i)}static fromJSON(e){return e!=null?new Po([e[0],e[1],e[2],(e[3]??255)/255]):void 0}static toUnitRGB(e){return e!=null?[e.r/255,e.g/255,e.b/255]:null}static toUnitRGBA(e){return e!=null?[e.r/255,e.g/255,e.b/255,e.a!=null?e.a:1]:null}constructor(e){this.r=255,this.g=255,this.b=255,this.a=1,e&&this.setColor(e)}get isBright(){return .299*this.r+.587*this.g+.114*this.b>=127}setColor(e){return typeof e=="string"?Po.fromString(e,this):Array.isArray(e)?Po.fromArray(e,this):(this._set(e.r??0,e.g??0,e.b??0,e.a??1),e instanceof Po||this._sanitize()),this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(e){const i=(e==null?void 0:e.capitalize)??!1,s=(e==null?void 0:e.digits)??6,n=s===3||s===4,r=s===4||s===8,o=`#${CD(this.r,n)}${CD(this.g,n)}${CD(this.b,n)}${r?CD(Math.round(255*this.a),n):""}`;return i?o.toUpperCase():o}toCss(e=!1){const i=this.r+", "+this.g+", "+this.b;return e?`rgba(${i}, ${this.a})`:`rgb(${i})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(e=Po.AlphaMode.ALWAYS){const i=SD(this.r),s=SD(this.g),n=SD(this.b);return e===Po.AlphaMode.ALWAYS||this.a!==1?[i,s,n,SD(255*this.a)]:[i,s,n]}clone(){return new Po(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}equals(e){return e!=null&&e.r===this.r&&e.g===this.g&&e.b===this.b&&e.a===this.a}_sanitize(){return this.r=Math.round(ED(this.r,0,255)),this.g=Math.round(ED(this.g,0,255)),this.b=Math.round(ED(this.b,0,255)),this.a=ED(this.a,0,1),this}_set(e,i,s,n){this.r=e,this.g=i,this.b=s,this.a=n}};Gt.prototype.declaredClass="esri.Color",function(t){var e;(e=t.AlphaMode||(t.AlphaMode={}))[e.ALWAYS=0]="ALWAYS",e[e.UNLESS_OPAQUE=1]="UNLESS_OPAQUE"}(Gt);var r6;let V0=r6=class extends ei{constructor(t){super(t),this.color=null,this.fieldName=null,this.tooltip=null,this.value=null}clone(){var t;return new r6({color:(t=this.color)==null?void 0:t.clone(),fieldName:this.fieldName,tooltip:this.tooltip,value:this.value})}};y([S()],V0.prototype,"color",void 0),y([S()],V0.prototype,"fieldName",void 0),y([S()],V0.prototype,"tooltip",void 0),y([S()],V0.prototype,"value",void 0),V0=r6=y([se("esri.popup.content.support.ChartMediaInfoValueSeries")],V0);const GDe=V0;var o6;let i_=o6=class extends it{constructor(t){super(t),this.colors=null,this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new o6({colors:be(this.colors),fields:be(this.fields),normalizeField:this.normalizeField,series:be(this.series),tooltipField:this.tooltipField})}};y([S({type:[Gt],json:{type:[[zs]],write:!0}})],i_.prototype,"colors",void 0),y([S({type:[String],json:{write:{isRequired:!0}}})],i_.prototype,"fields",void 0),y([S({type:String,json:{write:!0}})],i_.prototype,"normalizeField",void 0),y([S({type:[GDe],json:{read:!1}})],i_.prototype,"series",void 0),y([S({type:String,json:{write:!0}})],i_.prototype,"tooltipField",void 0),i_=o6=y([se("esri.popup.content.support.ChartMediaInfoValue")],i_);const BDe=i_;let xC=class extends s7{constructor(e){super(e),this.type=null,this.value=void 0}};y([S({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],xC.prototype,"type",void 0),y([S({type:BDe,json:{write:{isRequired:!0}}})],xC.prototype,"value",void 0),xC=y([se("esri.popup.content.mixins.ChartMediaInfo")],xC);const GF=xC,BF=ca()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var a6;let UR=a6=class extends GF{constructor(t){super(t),this.type="bar-chart"}clone(){var t;return new a6({altText:this.altText,title:this.title,caption:this.caption,value:(t=this.value)==null?void 0:t.clone()})}};y([S({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:{writer:BF.write,isRequired:!0}}})],UR.prototype,"type",void 0),UR=a6=y([se("esri.popup.content.BarChartMediaInfo")],UR);const Bde=UR;var l6;let VR=l6=class extends GF{constructor(t){super(t),this.type="column-chart"}clone(){var t;return new l6({altText:this.altText,title:this.title,caption:this.caption,value:(t=this.value)==null?void 0:t.clone()})}};y([S({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:{writer:BF.write,isRequired:!0}}})],VR.prototype,"type",void 0),VR=l6=y([se("esri.popup.content.ColumnChartMediaInfo")],VR);const qde=VR;var u6;let bC=u6=class extends it{constructor(t){super(t),this.linkURL=null,this.sourceURL=null}clone(){return new u6({linkURL:this.linkURL,sourceURL:this.sourceURL})}};y([S({type:String,json:{write:!0}})],bC.prototype,"linkURL",void 0),y([S({type:String,json:{write:{isRequired:!0}}})],bC.prototype,"sourceURL",void 0),bC=u6=y([se("esri.popup.content.support.ImageMediaInfoValue")],bC);const qDe=bC;var c6;let xb=c6=class extends s7{constructor(t){super(t),this.refreshInterval=0,this.type="image",this.value=void 0}clone(){var t;return new c6({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:(t=this.value)==null?void 0:t.clone()})}};y([S({type:Number,json:{write:!0}})],xb.prototype,"refreshInterval",void 0),y([S({type:["image"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],xb.prototype,"type",void 0),y([S({type:qDe,json:{write:{isRequired:!0}}})],xb.prototype,"value",void 0),xb=c6=y([se("esri.popup.content.ImageMediaInfo")],xb);const Hde=xb;var h6;let zR=h6=class extends GF{constructor(t){super(t),this.type="line-chart"}clone(){var t;return new h6({altText:this.altText,title:this.title,caption:this.caption,value:(t=this.value)==null?void 0:t.clone()})}};y([S({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:{writer:BF.write,isRequired:!0}}})],zR.prototype,"type",void 0),zR=h6=y([se("esri.popup.content.LineChartMediaInfo")],zR);const jde=zR;var d6;let GR=d6=class extends GF{constructor(t){super(t),this.type="pie-chart"}clone(){var t;return new d6({altText:this.altText,title:this.title,caption:this.caption,value:(t=this.value)==null?void 0:t.clone()})}};y([S({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:{writer:BF.write,isRequired:!0}}})],GR.prototype,"type",void 0),GR=d6=y([se("esri.popup.content.PieChartMediaInfo")],GR);const Yde=GR,m6={base:s7,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":Bde,"column-chart":qde,"line-chart":jde,"pie-chart":Yde,image:Hde}};var p6;let kh=p6=class extends Yf{constructor(t){super(t),this.activeMediaInfoIndex=null,this.attributes=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(t){return t&&t.map(e=>e.type==="image"?Hde.fromJSON(e):e.type==="barchart"?Bde.fromJSON(e):e.type==="columnchart"?qde.fromJSON(e):e.type==="linechart"?jde.fromJSON(e):e.type==="piechart"?Yde.fromJSON(e):void 0).filter(Boolean)}writeMediaInfos(t,e){e.mediaInfos=t&&t.map(i=>i.toJSON())}clone(){return new p6(be({activeMediaInfoIndex:this.activeMediaInfoIndex,attributes:this.attributes,description:this.description,mediaInfos:this.mediaInfos,title:this.title}))}};y([S()],kh.prototype,"activeMediaInfoIndex",void 0),y([S({type:Object,json:{write:!0}})],kh.prototype,"attributes",void 0),y([S({type:String,json:{write:!0}})],kh.prototype,"description",void 0),y([S({types:[m6]})],kh.prototype,"mediaInfos",void 0),y([mt("mediaInfos")],kh.prototype,"readMediaInfos",null),y([yt("mediaInfos")],kh.prototype,"writeMediaInfos",null),y([S({type:String,json:{write:!0}})],kh.prototype,"title",void 0),y([S({type:["media"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],kh.prototype,"type",void 0),kh=p6=y([se("esri.popup.content.MediaContent")],kh);const PP=kh;var f6;let wC=f6=class extends it{constructor(t){super(t),this.field=null,this.order=null}clone(){return new f6({field:this.field,order:this.order})}};y([S({type:String,json:{write:!0}})],wC.prototype,"field",void 0),y([S({type:["asc","desc"],json:{write:!0}})],wC.prototype,"order",void 0),wC=f6=y([se("esri.popup.support.RelatedRecordsInfoFieldOrder")],wC);const r7=wC;let Kd=class extends bs.ClonableMixin(Yf){constructor(e){super(e),this.description=null,this.displayCount=null,this.displayType="list",this.orderByFields=null,this.relationshipId=null,this.title=null,this.type="relationship"}};y([S({type:String,json:{write:!0}})],Kd.prototype,"description",void 0),y([S({type:Number,json:{type:zs,write:!0}})],Kd.prototype,"displayCount",void 0),y([S({type:["list"],json:{write:{isRequired:!0}}})],Kd.prototype,"displayType",void 0),y([S({type:[r7],json:{write:!0}})],Kd.prototype,"orderByFields",void 0),y([S({type:Number,json:{type:zs,write:{isRequired:!0}}})],Kd.prototype,"relationshipId",void 0),y([S({type:String,json:{write:!0}})],Kd.prototype,"title",void 0),y([S({type:["relationship"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],Kd.prototype,"type",void 0),Kd=y([se("esri.popup.content.RelationshipContent")],Kd);const MP=Kd;var g6;let SC=g6=class extends Yf{constructor(t){super(t),this.text=null,this.type="text"}clone(){return new g6({text:this.text})}};y([S({type:String,json:{write:!0}})],SC.prototype,"text",void 0),y([S({type:["text"],readOnly:!0,json:{read:!1,write:{isRequired:!0}}})],SC.prototype,"type",void 0),SC=g6=y([se("esri.popup.content.TextContent")],SC);const AP=SC;let Lp=class extends bs.ClonableMixin(it){constructor(e){super(e),this.title=null,this.description=null,this.type=null,this.associatedNetworkSourceId=null,this.associatedAssetGroup=null,this.associatedAssetType=null}};y([S({type:String,json:{write:!0}})],Lp.prototype,"title",void 0),y([S({type:String,json:{write:!0}})],Lp.prototype,"description",void 0),y([S({type:["attachment","connectivity","container","content","structure"],json:{write:!0}})],Lp.prototype,"type",void 0),y([S({type:Number,json:{type:zs,write:!0}})],Lp.prototype,"associatedNetworkSourceId",void 0),y([S({type:Number,json:{type:zs,write:!0}})],Lp.prototype,"associatedAssetGroup",void 0),y([S({type:Number,json:{type:zs,write:!0}})],Lp.prototype,"associatedAssetType",void 0),Lp=y([se("esri.popup.support.UtilityNetworkAssociationType")],Lp);const Xde=Lp;let s_=class extends bs.ClonableMixin(Yf){constructor(e){super(e),this.description=null,this.displayCount=null,this.title=null,this.associationTypes=[],this.type="utility-network-associations"}};y([S({type:String,json:{write:!0}})],s_.prototype,"description",void 0),y([S({type:Number,json:{type:zs,write:!0}})],s_.prototype,"displayCount",void 0),y([S({type:String,json:{write:!0}})],s_.prototype,"title",void 0),y([S({type:[Xde],json:{write:!0}})],s_.prototype,"associationTypes",void 0),y([ai({utilityNetworkAssociations:"utility-network-associations"})],s_.prototype,"type",void 0),s_=y([se("esri.popup.content.UtilityNetworkAssociationsContent")],s_);const o7=s_,HDe={base:null,key:"type",typeMap:{attachment:oS,media:PP,text:AP,expression:VF,field:aS,relationship:MP,utilityNetworkAssociations:o7}},jDe={base:null,key:"type",typeMap:{attachment:oS,media:PP,text:AP,expression:VF,field:aS,relationship:MP}};var _6;let z0=_6=class extends it{constructor(t){super(t),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new _6({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};y([S({type:String,json:{write:!0}})],z0.prototype,"name",void 0),y([S({type:String,json:{write:!0}})],z0.prototype,"title",void 0),y([S({type:String,json:{write:!0}})],z0.prototype,"expression",void 0),y([S({type:["string","number"],json:{write:!0}})],z0.prototype,"returnType",void 0),z0=_6=y([se("esri.popup.ExpressionInfo")],z0);const YDe=z0;var y6;let EC=y6=class extends it{constructor(t){super(t),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new y6({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};y([S({type:Boolean,json:{write:!0}})],EC.prototype,"returnTopmostRaster",void 0),y([S({type:Boolean,json:{write:!0}})],EC.prototype,"showNoDataRecords",void 0),EC=y6=y([se("esri.popup.LayerOptions")],EC);const XDe=EC;var v6;let CC=v6=class extends it{constructor(t){super(t),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new v6({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?be(this.orderByFields):null})}};y([S({type:Boolean,json:{write:!0}})],CC.prototype,"showRelatedRecords",void 0),y([S({type:[r7],json:{write:!0}})],CC.prototype,"orderByFields",void 0),CC=v6=y([se("esri.popup.RelatedRecordsInfo")],CC);const LQ=CC;let Wde=0;const Zde=t=>{let e=class extends t{constructor(...i){super(...i),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+Wde++})}};return e=y([se("esri.core.Identifiable")],e),e},WDe=t=>{let e=class extends t{constructor(...i){super(...i),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Wde++})}};return e=y([se("esri.core.Identifiable.NumericIdentifiable")],e),e};let TC=class extends Zde(class{}){};TC=y([se("esri.core.Identifiable")],TC),function(t){t.IdentifiableMixin=Zde,t.NumericIdentifiableMixin=WDe}(TC||(TC={}));const ZM=TC;var x6;let Ic=x6=class extends ZM.IdentifiableMixin(ei){constructor(t){super(t),this.active=!1,this.className=null,this.disabled=!1,this.icon=null,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new x6({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};y([S()],Ic.prototype,"active",void 0),y([S()],Ic.prototype,"className",void 0),y([S()],Ic.prototype,"disabled",void 0),y([S()],Ic.prototype,"icon",void 0),y([S()],Ic.prototype,"id",void 0),y([S()],Ic.prototype,"indicator",void 0),y([S()],Ic.prototype,"title",void 0),y([S()],Ic.prototype,"type",void 0),y([S()],Ic.prototype,"visible",void 0),Ic=x6=y([se("esri.support.actions.ActionBase")],Ic);const a7=Ic;var b6;let BR=b6=class extends a7{constructor(t){super(t),this.image=null,this.type="button"}clone(){return new b6({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};y([S()],BR.prototype,"image",void 0),BR=b6=y([se("esri.support.actions.ActionButton")],BR);const ZDe=BR;var w6;let PC=w6=class extends a7{constructor(t){super(t),this.image=null,this.type="toggle",this.value=!1}clone(){return new w6({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};y([S()],PC.prototype,"image",void 0),y([S()],PC.prototype,"value",void 0),PC=w6=y([se("esri.support.actions.ActionToggle")],PC);const KDe=PC,D2="relationships/",FQ="expression/",QDe=Nt.ofType({key:"type",defaultKeyValue:"button",base:a7,typeMap:{button:ZDe,toggle:KDe}}),JDe={base:Yf,key:"type",typeMap:{media:PP,custom:CDe,text:AP,attachments:oS,fields:aS,expression:VF,relationship:MP,utilityNetworkAssociations:o7}},Kde=new Set(["attachments","fields","media","text","expression","relationship"]),eNe=new Set([...Kde,"utility-network-associations"]);let ao=class extends bs.ClonableMixin(it){constructor(){super(...arguments),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title=""}castContent(e){return Array.isArray(e)?e.map(i=>_d(JDe,i)):typeof e=="string"||typeof e=="function"||e instanceof HTMLElement||Hm(e)?e:(ht.getLogger(this).error("content error","unsupported content value",{value:e}),null)}readContent(e,i){const{popupElements:s}=i;return Array.isArray(s)&&s.length>0?this._readPopupInfoElements(i.description,i.mediaInfos,s):this._readPopupInfo(i)}writeWebSceneContent(e,i,s,n){this._writePopupTemplateContent(e,i,n)}writeWebMapContent(e,i,s,n){this._writePopupTemplateContent(e,i,n)}writeFieldInfos(e,i,s,n){const{content:r}=this,o=Array.isArray(r)?r:null;if(e){const a=o?o.filter(u=>u.type==="fields"):[],l=a.length&&a.every(u=>{var c;return(c=u.fieldInfos)==null?void 0:c.length});i.fieldInfos=e.filter(Boolean).map(u=>{const c=u.toJSON(n);return l&&(c.visible=!1),c})}if(o)for(const a of o)a.type==="fields"&&this._writeFieldsContent(a,i)}writeLayerOptions(e,i,s,n){i[s]=!e||e.showNoDataRecords===null&&e.returnTopmostRaster===null?null:e.toJSON(n)}writeTitle(e,i){i.title=e||""}async collectRequiredFields(e,i){const s=this.expressionInfos||[];await this._collectExpressionInfoFields(e,i,[...s,...this._getContentExpressionInfos(this.content,s)]),m1(e,i,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(e){const i=new Set;return await this.collectRequiredFields(i,e),[...i].sort()}_writePopupTemplateContent(e,i,s){typeof e!="string"?Array.isArray(e)&&(i.popupElements=e.filter(n=>(s==null?void 0:s.origin)==="web-scene"?Kde.has(n.type):eNe.has(n.type)).map(n=>n==null?void 0:n.toJSON(s)),i.popupElements.forEach(n=>{n.type==="attachments"?this._writeAttachmentContent(i):n.type==="media"?this._writeMediaContent(n,i):n.type==="text"?this._writeTextContent(n,i):n.type==="relationship"&&this._writeRelationshipContent(n,i)})):i.description=e}_writeFieldsContent(e,i){if(!Array.isArray(e.fieldInfos)||!e.fieldInfos.length)return;const s=be(e.fieldInfos);Array.isArray(i.fieldInfos)?s.forEach(n=>{const r=i.fieldInfos.find(o=>{var a,l;return((a=o.fieldName)==null?void 0:a.toLowerCase())===((l=n.fieldName)==null?void 0:l.toLowerCase())});r?r.visible=!0:i.fieldInfos.push(n)}):i.fieldInfos=s}_writeAttachmentContent(e){e.showAttachments||(e.showAttachments=!0)}_writeRelationshipContent(e,i){var r,o;const s=((r=e.orderByFields)==null?void 0:r.map(a=>this._toFieldOrderJSON(a,e.relationshipId)))||[],n=[...((o=i.relatedRecordsInfo)==null?void 0:o.orderByFields)||[],...s];i.relatedRecordsInfo={showRelatedRecords:!0,...(n==null?void 0:n.length)&&{orderByFields:n}}}_writeTextContent(e,i){!i.description&&e.text&&(i.description=e.text)}_writeMediaContent(e,i){if(!Array.isArray(e.mediaInfos)||!e.mediaInfos.length)return;const s=be(e.mediaInfos);Array.isArray(i.mediaInfos)?i.mediaInfos=[...i.mediaInfos,...s]:i.mediaInfos=s}_readPopupInfoElements(e,i,s){const n={description:!1,mediaInfos:!1};return s.map(r=>r.type==="media"?(r.mediaInfos||!i||n.mediaInfos||(r.mediaInfos=i,n.mediaInfos=!0),PP.fromJSON(r)):r.type==="text"?(r.text||!e||n.description||(r.text=e,n.description=!0),AP.fromJSON(r)):r.type==="attachments"?oS.fromJSON(r):r.type==="fields"?aS.fromJSON(r):r.type==="expression"?VF.fromJSON(r):r.type==="relationship"?MP.fromJSON(r):r.type==="utilityNetworkAssociations"?o7.fromJSON(r):void 0).filter(Boolean)}_toRelationshipContent(e){const{field:i,order:s}=e;if(!(i!=null&&i.startsWith(D2)))return null;const n=i.replace(D2,"").split("/");if(n.length!==2)return null;const r=parseInt(n[0],10),o=n[1];return!Number.isNaN(r)&&o?MP.fromJSON({relationshipId:r,orderByFields:[{field:o,order:s}]}):null}_toFieldOrderJSON(e,i){const{order:s,field:n}=e;return{field:`${D2}${i}/${n}`,order:s}}_readPopupInfo({description:e,mediaInfos:i,showAttachments:s,relatedRecordsInfo:n={showRelatedRecords:!1}}){const r=[];e?r.push(new AP({text:e})):r.push(new aS),Array.isArray(i)&&i.length&&r.push(PP.fromJSON({mediaInfos:i})),s&&r.push(oS.fromJSON({displayType:"auto"}));const{showRelatedRecords:o,orderByFields:a}=n;return o&&(a!=null&&a.length)&&a.forEach(l=>{const u=this._toRelationshipContent(l);u&&r.push(u)}),r.length?r:e}_getContentElementFields(e){const i=e==null?void 0:e.type;if(i==="attachments")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)];if(i==="custom")return e.outFields||[];if(i==="fields")return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...this._getFieldInfoFields(e.fieldInfos??this.fieldInfos)];if(i==="media"){const s=e.mediaInfos||[];return[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description),...s.reduce((n,r)=>[...n,...this._getMediaInfoFields(r)],[])]}return i==="text"?this._extractFieldNames(e.text):i==="relationship"||i==="utility-network-associations"?[...this._extractFieldNames(e.title),...this._extractFieldNames(e.description)]:[]}_getMediaInfoFields(e){const{caption:i,title:s,value:n}=e,r=n||{},{fields:o,normalizeField:a,tooltipField:l,sourceURL:u,linkURL:c}=r,h=[...this._extractFieldNames(s),...this._extractFieldNames(i),...this._extractFieldNames(u),...this._extractFieldNames(c),...o??[]];return a&&h.push(a),l&&h.push(l),h}_getContentExpressionInfos(e,i){return Array.isArray(e)?e.reduce((s,n)=>[...s,...n.type==="expression"&&n.expressionInfo?[n.expressionInfo]:[]],i):[]}_getContentFields(e){return typeof e=="string"?this._extractFieldNames(e):Array.isArray(e)?e.reduce((i,s)=>[...i,...this._getContentElementFields(s)],[]):[]}async _collectExpressionInfoFields(e,i,s){s&&await Promise.all(s.map(n=>al(e,i,n.expression)))}_getFieldInfoFields(e){return e?e.filter(({fieldName:i,visible:s})=>!(s!==void 0&&!s||!i||i.startsWith(D2)||i.startsWith(FQ))).map(i=>i.fieldName):[]}_getActionsFields(e){return e?e.toArray().reduce((i,s)=>[...i,...this._getActionFields(s)],[]):[]}_getActionFields(e){const{className:i,title:s,type:n}=e,r=n==="button"||n==="toggle"?e.image:"";return[...this._extractFieldNames(s),...this._extractFieldNames(i),...this._extractFieldNames(r)]}_getTitleFields(e){return typeof e=="string"?this._extractFieldNames(e):[]}_extractFieldNames(e){return QH(e).filter(i=>!(i.indexOf(D2)===0||i.indexOf(FQ)===0))}};y([S({type:QDe})],ao.prototype,"actions",void 0),y([S()],ao.prototype,"content",void 0),y([Ls("content")],ao.prototype,"castContent",null),y([mt("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments","relatedRecordsInfo"])],ao.prototype,"readContent",null),y([yt("web-scene","content",{popupElements:{type:Nt.ofType(jDe)},showAttachments:{type:Boolean},mediaInfos:{type:Nt.ofType(m6)},description:{type:String},relatedRecordsInfo:{type:LQ}})],ao.prototype,"writeWebSceneContent",null),y([yt("content",{popupElements:{type:Nt.ofType(HDe)},showAttachments:{type:Boolean},mediaInfos:{type:Nt.ofType(m6)},description:{type:String},relatedRecordsInfo:{type:LQ}})],ao.prototype,"writeWebMapContent",null),y([S({type:[YDe],json:{write:!0}})],ao.prototype,"expressionInfos",void 0),y([S({type:[i7]})],ao.prototype,"fieldInfos",void 0),y([yt("fieldInfos")],ao.prototype,"writeFieldInfos",null),y([S({type:XDe})],ao.prototype,"layerOptions",void 0),y([yt("layerOptions")],ao.prototype,"writeLayerOptions",null),y([S({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],ao.prototype,"lastEditInfoEnabled",void 0),y([S()],ao.prototype,"outFields",void 0),y([S()],ao.prototype,"overwriteActions",void 0),y([S()],ao.prototype,"returnGeometry",void 0),y([S({json:{type:String}})],ao.prototype,"title",void 0),y([yt("title")],ao.prototype,"writeTitle",null),ao=y([se("esri.PopupTemplate")],ao);const HS=ao;function c_t(t,e,i){return dH(t.map((s,n)=>e.apply(i,[s,n])))}async function tNe(t,e,i){return(await dH(t.map((s,n)=>e.apply(i,[s,n])))).map(s=>s.value)}function l7(t){return{ok:!0,value:t}}function u7(t){return{ok:!1,error:t}}function iNe(t){return t!=null&&t.ok===!0?t.value:null}function sNe(t){return t!=null&&t.ok===!1?t.error:null}async function qF(t){if(t==null)return{ok:!1,error:new Error("no promise provided")};try{return l7(await t)}catch(e){return u7(e)}}async function nNe(t){try{return l7(await t)}catch(e){return ym(e),u7(e)}}function KM(t,e){return new n_(t,e)}let n_=class extends ei{get value(){return iNe(this._result)}get error(){return sNe(this._result)}get finished(){return this._result!=null}constructor(e,i){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=Xw(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:s}=this._abortController;this.promise=e(s),this.promise.then(n=>{this._result=l7(n),this._cleanup()},n=>{this._result=u7(n),this._cleanup()}),this._abortHandle=Jc(i,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=sr(this._abortHandle),this._abortController=null}};y([S()],n_.prototype,"value",null),y([S()],n_.prototype,"error",null),y([S()],n_.prototype,"finished",null),y([S()],n_.prototype,"promise",void 0),y([S()],n_.prototype,"_result",void 0),n_=y([se("esri.core.asyncUtils.ReactiveTask")],n_);function Ai(t,e,i={}){return c7(t,e,i,Qde)}function nh(t,e,i={}){return c7(t,e,i,Jde)}function c7(t,e,i={},s){let n=null;const r=i.once?(o,a)=>{s(o)&&(sr(n),e(o,a))}:(o,a)=>{s(o)&&e(o,a)};if(n=aCe(t,r,i.sync,i.equals),i.initial){const o=t();r(o,o)}return n}function yy(t,e,i,s={}){let n=null,r=null,o=null;function a(){var c;n&&r&&(r.remove(),(c=s.onListenerRemove)==null||c.call(s,n),n=null,r=null)}function l(c){s.once&&s.once&&sr(o),i(c)}const u=Ai(t,(c,h)=>{var d;a(),wF(c)&&(n=c,r=$M(c,e,l),(d=s.onListenerAdd)==null||d.call(s,c))},{sync:s.sync,initial:!0});return o=Gs(()=>{u.remove(),a()}),o}function h7(t,e){return rNe(t,Jde,e)}function rNe(t,e,i){if(dc(i))return Promise.reject(Vn());const s=t();if(e!=null&&e(s))return Promise.resolve(s);let n=null;function r(){n=sr(n)}return new Promise((o,a)=>{n=LM([Jc(i,()=>{r(),a(Vn())}),c7(t,l=>{r(),o(l)},{sync:!1,once:!0},e??Qde)])})}function Qde(t){return!0}function Jde(t){return!!t}function d_t(t,e,i={}){let s=!1;const n=Ai(t,(r,o)=>{s||e(r,o)},i);return{remove(){n.remove()},pause(){s=!0},resume(){s=!1}}}function oNe(t,e){const i=new Nt,s=yy(t,"after-splice",({added:n,start:r,deleteCount:o})=>{const a=i.splice(r,o);for(const l of a)l.remove();if(n!=null&&n.length){const l=n.map(e);i.addMany(l,r)}},{sync:!0,onListenerRemove:()=>i.drain(n=>n.remove()),onListenerAdd:n=>i.addMany(n.items.map(e))});return i.addHandles(s),i}function m_t(t,e){const i=new Nt,s=oNe(t,a=>KM(async l=>{const u=await e(a,l);if(dc(l))throw u.remove(),Vn();return u})),n=()=>null,r=async a=>{const l=await a.promise,u=s.indexOf(a);u<0||i.splice(u,1,l)};i.addMany(s.items.map(n));for(const a of s)vP(r(a));const o=s.on("after-splice",({added:a,start:l,deleteCount:u})=>{const c=i.splice(l,u);for(const h of c)h==null||h.remove();if(a!=null&&a.length){i.addMany(a.map(n),l);for(const h of a)vP(r(h))}});return i.addHandles([IEe(s),o]),i}const km={sync:!0},nl={initial:!0},uu={sync:!0,initial:!0};function eme(t){return t.xmin!==void 0&&t.ymin!==void 0&&t.xmax!==void 0&&t.ymax!==void 0}function tme(t){return t.points!==void 0}function ime(t){return t.x!==void 0&&t.y!==void 0}function d7(t){return t.paths!==void 0||t.curvePaths!==void 0}function Xv(t){return t.rings!==void 0||t.curveRings!==void 0}function f1(t){return t==null?null:t instanceof jf?t:ime(t)?ki.fromJSON(t):d7(t)?gu.fromJSON(t):Xv(t)?Na.fromJSON(t):tme(t)?BM.fromJSON(t):eme(t)?Nn.fromJSON(t):null}function m7(t){return t?ime(t)?"esriGeometryPoint":d7(t)?"esriGeometryPolyline":Xv(t)?"esriGeometryPolygon":eme(t)?"esriGeometryEnvelope":tme(t)?"esriGeometryMultipoint":null:null}const aNe={esriGeometryPoint:ki,esriGeometryPolyline:gu,esriGeometryPolygon:Na,esriGeometryEnvelope:Nn,esriGeometryMultipoint:BM,esriGeometryMultiPatch:Na};function lNe(t){return t&&aNe[t]||null}const uNe=ca()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),kQ=ca()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"}),QM={base:jf,key:"type",typeMap:{extent:Nn,multipoint:BM,point:ki,polyline:gu,polygon:Na}},$Q=new gs({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let cNe=0,bb=class extends it{constructor(e){super(e),this.id="sym"+cNe++,this.type=null,this.color=new Gt([0,0,0,1])}readColor(e){return(e==null?void 0:e[0])!=null?[e[0],e[1],e[2],e[3]/255]:e}async collectRequiredFields(e,i){}hash(){return JSON.stringify(this.toJSON())}clone(){}};y([S({type:$Q.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:$Q.write,isRequired:!0}}})],bb.prototype,"type",void 0),y([S({type:Gt,json:{write:{allowNull:!0}}})],bb.prototype,"color",void 0),y([mt("color")],bb.prototype,"readColor",null),bb=y([se("esri.symbols.Symbol")],bb);const Oa=bb;var S6;let r_=S6=class extends Oa{constructor(t){super(t),this.data=null,this.type="cim"}readData(t,e){return e}writeData(t,e){Object.assign(e,t)}async collectRequiredFields(t,e){var i;if(((i=this.data)==null?void 0:i.type)==="CIMSymbolReference"){const s=this.data.primitiveOverrides;if(s){const n=s.map(r=>{const o=r.valueExpressionInfo;return o?al(t,e,o.expression):null});await Promise.all(n)}}}clone(){return new S6({data:be(this.data)})}hash(){return Zle(JSON.stringify(this.data)).toString()}};y([S({json:{write:!1}})],r_.prototype,"color",void 0),y([S({json:{write:!0}})],r_.prototype,"data",void 0),y([mt("data",["symbol"])],r_.prototype,"readData",null),y([yt("data",{})],r_.prototype,"writeData",null),y([ai({CIMSymbolReference:"cim"},{readOnly:!0})],r_.prototype,"type",void 0),r_=S6=y([se("esri.symbols.CIMSymbol")],r_);const Oy=r_;function Of(t,e,i=Nt){return e||(e=new i),e===t||(e.removeAll(),hNe(t)?e.addMany(t):t&&e.add(t)),e}function sme(t){return t}function hNe(t){return t&&(Array.isArray(t)||"items"in t&&Array.isArray(t.items))}var N_;(function(t){t[t.PENDING=0]="PENDING",t[t.RESOLVED=1]="RESOLVED",t[t.REJECTED=2]="REJECTED"})(N_||(N_={}));let dNe=class{constructor(){this._resolver=mc(),this._status=N_.PENDING,this._resolvingPromises=[],this._resolver.promise.then(()=>{this._status=N_.RESOLVED,this._cleanUp()},()=>{this._status=N_.REJECTED,this._cleanUp()}),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(e){this._resolvingPromises.push(e),this._tryResolve()}isResolved(){return this._status===N_.RESOLVED}isRejected(){return this._status===N_.REJECTED}isFulfilled(){return this._status!==N_.PENDING}abort(){this._resolver.reject(Vn())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;const e=mc(),i=[...this._resolvingPromises,e.promise],s=this._allPromise=Promise.all(i);s.then(()=>{this.isFulfilled()||this._allPromise!==s||this._resolver.resolve()},n=>{this.isFulfilled()||this._allPromise!==s||cl(n)||this._resolver.reject(n)}),e.resolve()}};const nme=t=>{let e=class extends t{constructor(...i){super(...i),this._promiseProps=new dNe,this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(i,s){return this._promiseProps.promise.then(()=>this).then(i,s)}catch(i){return this.when(null,i)}addResolvingPromise(i){i&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in i?i.when():i)}};return e=y([se("esri.core.Promise")],e),e};let MC=class extends nme(ei){};MC=y([se("esri.core.Promise")],MC),function(t){t.EsriPromiseMixin=nme}(MC||(MC={}));const JM=MC,mNe="not-loaded",pNe="loading",fNe="failed",UQ="loaded",rme=t=>{let e=class extends t{constructor(...i){super(...i),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise(s=>{const n=this.load.bind(this);this.load=r=>{const o=new Promise((a,l)=>{const u=hH(r,l);this.destroyed&&l(new Se("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this.when(a,l).finally(()=>{u&&u.remove()})});if(this.loadStatus===mNe){this._set("loadStatus",pNe);const a=this._loadController=new AbortController;n({signal:a.signal})}return s(),o}})),this.when(()=>{this._set("loadStatus",UQ),this._loadController=null},s=>{this._set("loadStatus",fNe),this._set("loadError",s),this._loadController=null})}destroy(){this._loadController&&(this._loadController=Xw(this._loadController),this._promiseProps.abort()),this._set("loadError",null),this._set("loadWarnings",[])}get loaded(){return this.loadStatus===UQ}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){var i;return this.isFulfilled()||(this._set("loadError",new Se("load:cancelled","Cancelled")),(i=this._loadController)==null||i.abort(),this._promiseProps.abort()),this}};return y([S({readOnly:!0})],e.prototype,"loaded",null),y([S({readOnly:!0})],e.prototype,"loadError",void 0),y([S({clonable:!1})],e.prototype,"loadStatus",void 0),y([S({type:[ih],readOnly:!0})],e.prototype,"loadWarnings",null),e=y([se("esri.core.Loadable")],e),e};let AC=class extends rme(JM){};AC=y([se("esri.core.Loadable")],AC),function(t){function e(i){return!(!i||!i.load)}t.LoadableMixin=rme,t.isLoadable=e}(AC||(AC={}));const Lf=AC;let TD;function gNe(t){return TD&&!TD.destroyed||(TD=t()),TD}var E6;const _Ne=new gs({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let Dc=E6=class extends ei{constructor(t){super(t),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.filter=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(t){t!=="asc"&&t!=="desc"||this._set("sortOrder",t)}clone(){return new E6({categories:this.categories?be(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(t,e){let i=[];this.categories&&(i=this.categories.map(o=>Array.isArray(o)?JSON.stringify(o):o));let s="";if(this.extent){const o=DF(this.extent,Ri.WGS84);o!=null&&(s=`${o.xmin},${o.ymin},${o.xmax},${o.ymax}`)}let n=this.query;!this.disableExtraQuery&&t.extraQuery&&(n="("+n+")"+t.extraQuery);const r={categories:i,bbox:s,q:n,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(r.sortField=this.sortField.split(",").map(o=>_Ne.toJSON(o.trim())).join(","),r.sortOrder=this.sortOrder),{query:{...e,...r}}}};y([S()],Dc.prototype,"categories",void 0),y([S()],Dc.prototype,"disableExtraQuery",void 0),y([S({type:Nn})],Dc.prototype,"extent",void 0),y([S()],Dc.prototype,"filter",void 0),y([S()],Dc.prototype,"num",void 0),y([S()],Dc.prototype,"query",void 0),y([S()],Dc.prototype,"sortField",void 0),y([S()],Dc.prototype,"sortOrder",null),y([S()],Dc.prototype,"start",void 0),Dc=E6=y([se("esri.portal.PortalQueryParams")],Dc);const sd=Dc;var C6;let lo=C6=class extends it{constructor(t){super(t),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.sourceJSON=null,this.tags=null,this.title=null}get thumbnailUrl(){var i;const t=this.url,e=this.thumbnail;return t&&e&&this.portal?(i=this.portal)==null?void 0:i.normalizeUrl(`${t}/info/${e}?f=json`):null}get url(){var e;const t=(e=this.portal)==null?void 0:e.restUrl;return t?t+"/community/groups/"+this.id:null}fetchCategorySchema(t){return this.portal.request(this.url+"/categorySchema",t).then(e=>{const i=e.categorySchema||[];return i.some(s=>s.source==="contentCategorySetsGroupQuery.LivingAtlas")?this._fetchCategorySchemaSet("LivingAtlas",t):i})}fetchMembers(t){return this.portal.request(this.url+"/users",t)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}toJSON(){throw new Se("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new C6({sourceJSON:t});return e.read(t),e}queryItems(t,e){let i=xo(sd,t);const s=this.portal;return parseFloat(s.currentVersion)>5?(i=i||new sd,s.queryPortal(`/content/groups/${this.id}/search`,i,"PortalItem",e)):(i=i?i.clone():new sd,i.query="group:"+this.id+(i.query?" "+i.query:""),s.queryItems(i,e))}_fetchCategorySchemaSet(t,e){const i=this.portal;return i.fetchSelf(i.authMode,!0,e).then(s=>{const n=s.contentCategorySetsGroupQuery;if(n){const r=new sd({disableExtraQuery:!0,num:1,query:n});return i.queryGroups(r,e)}throw new Se("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")}).then(s=>{if(s.total){const n=s.results[0],r=new sd({num:1,query:`typekeywords:"${t}"`});return n.queryItems(r,e)}throw new Se("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")}).then(s=>s.total?s.results[0].fetchData("json",e).then(n=>{const r=n==null?void 0:n.categorySchema;return r!=null&&r.length?r:[]}):[])}};y([S()],lo.prototype,"access",void 0),y([S({type:Date})],lo.prototype,"created",void 0),y([S()],lo.prototype,"description",void 0),y([S()],lo.prototype,"id",void 0),y([S()],lo.prototype,"isInvitationOnly",void 0),y([S({type:Date})],lo.prototype,"modified",void 0),y([S()],lo.prototype,"owner",void 0),y([S()],lo.prototype,"portal",void 0),y([S()],lo.prototype,"snippet",void 0),y([S()],lo.prototype,"sortField",void 0),y([S()],lo.prototype,"sortOrder",void 0),y([S()],lo.prototype,"sourceJSON",void 0),y([S()],lo.prototype,"tags",void 0),y([S()],lo.prototype,"thumbnail",void 0),y([S({readOnly:!0})],lo.prototype,"thumbnailUrl",null),y([S()],lo.prototype,"title",void 0),y([S({readOnly:!0})],lo.prototype,"url",null),lo=C6=y([se("esri.portal.PortalGroup")],lo);const T6=lo;let G0=class extends ei{constructor(e){super(e),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};y([S()],G0.prototype,"nextQueryParams",void 0),y([S()],G0.prototype,"queryParams",void 0),y([S()],G0.prototype,"results",void 0),y([S()],G0.prototype,"total",void 0),G0=y([se("esri.portal.PortalQueryResult")],G0);const yNe=G0;let Fp=class extends it{constructor(e){super(e),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){var i;const e=(i=this.portal)==null?void 0:i.restUrl;return e?`${e}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new Se("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};y([S({type:Date})],Fp.prototype,"created",void 0),y([S()],Fp.prototype,"id",void 0),y([S()],Fp.prototype,"portal",void 0),y([S()],Fp.prototype,"title",void 0),y([S({readOnly:!0})],Fp.prototype,"url",null),y([S()],Fp.prototype,"username",void 0),Fp=y([se("esri.portal.PortalFolder")],Fp);const vNe=Fp;var P6;let Ln=P6=class extends it{constructor(t){super(t),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userLicenseTypeId=null,this.userType=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e?this.portal.normalizeUrl(`${t}/info/${e}?f=json`):null}get userContentUrl(){var e;const t=(e=this.portal)==null?void 0:e.restUrl;return t?`${t}/content/users/${this.username}`:null}get url(){var e;const t=(e=this.portal)==null?void 0:e.restUrl;return t?`${t}/community/users/${this.username}`:null}addItem(t){const e=t&&t.item,i=t==null?void 0:t.data,s=t==null?void 0:t.folder,n={method:"post"};e&&(n.query=e.createPostQuery(),i!=null&&(typeof i=="string"?n.query.text=i:typeof i=="object"&&(n.query.text=JSON.stringify(i))));let r=this.userContentUrl;return s&&(r+="/"+(typeof s=="string"?s:s.id)),this.portal.request(r+"/addItem",n).then(o=>(e.id=o.id,e.portal=this.portal,e.loaded?e.reload():e.load()))}async deleteItem(t,e=!1){let i=this.userContentUrl;t.ownerFolder&&(i+="/"+t.ownerFolder);const s=e?{permanentDelete:!0}:{};await this.portal.request(i+`/items/${t.id}/delete`,{method:"post",query:s}),t.id=null,t.portal=null}async deleteItems(t,e=!1){t=t.slice();const i=this.userContentUrl+"/deleteItems",s=[],n=t.map(r=>r.id);if(n.length){const r={method:"post",query:{items:n.join(","),permanentDelete:e}},o=await this.portal.request(i,r);for(const a of o.results){const l=t.find(h=>a.itemId===h.id),u=a.success;let c=null;u?(l.id=null,l.portal=null):a.error&&(c=new Se("portal:delete-item-failed",a.error.message,a.error)),s.push({item:l,success:u,error:c})}}return s}fetchFolders(){const t={query:{num:1}};return this.portal.request(this.userContentUrl??"",t).then(e=>{let i;return i=e&&e.folders?e.folders.map(s=>{const n=vNe.fromJSON(s);return n.portal=this.portal,n}):[],i})}fetchGroups(){return this.portal.request(this.url??"").then(t=>{let e;return e=t&&t.groups?t.groups.map(i=>{const s=T6.fromJSON(i);return s.portal=this.portal,s}):[],e})}async fetchItems(t){t??(t={});let e=this.userContentUrl??"";t.folder&&(e+="/"+t.folder.id);const{default:i}=await _e(()=>Promise.resolve().then(()=>C0e),void 0),s={folders:!1,inRecycleBin:!!t.inRecycleBin||null,foldersContent:!(t.folder||!t.includeSubfolderItems)||null,num:t.num||10,start:t.start||1,sortField:t.sortField||"created",sortOrder:t.sortOrder||"asc"},n=await this.portal.request(e,{query:s});let r;return n!=null&&n.items?(r=n.items.map(o=>{const a=i.fromJSON(o);return a.portal=this.portal,a}),await Promise.all(r.map(o=>o.load())),{items:r,nextStart:n.nextStart,total:n.total}):{items:[],nextStart:-1,total:0}}fetchTags(){return this.portal.request(this.url+"/tags").then(t=>t.tags)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}queryFavorites(t){return this.favGroupId?(this._favGroup||(this._favGroup=new T6({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(t)):Promise.reject(new Se("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}async restoreItem(t,e){const i=this.userContentUrl,s=e?{folderID:typeof e=="string"?e:e.id}:null;await this.portal.request(i+`/items/${t.id}/restore`,{method:"post",query:s})}toJSON(){throw new Se("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");const e=new P6({sourceJSON:t});return e.read(t),e}};y([S()],Ln.prototype,"access",void 0),y([S({type:Date})],Ln.prototype,"created",void 0),y([S()],Ln.prototype,"culture",void 0),y([S()],Ln.prototype,"description",void 0),y([S()],Ln.prototype,"email",void 0),y([S()],Ln.prototype,"favGroupId",void 0),y([S()],Ln.prototype,"fullName",void 0),y([S({type:Date})],Ln.prototype,"modified",void 0),y([S()],Ln.prototype,"orgId",void 0),y([S()],Ln.prototype,"portal",void 0),y([S()],Ln.prototype,"preferredView",void 0),y([S()],Ln.prototype,"privileges",void 0),y([S()],Ln.prototype,"region",void 0),y([S()],Ln.prototype,"role",void 0),y([S()],Ln.prototype,"roleId",void 0),y([S()],Ln.prototype,"sourceJSON",void 0),y([S()],Ln.prototype,"thumbnail",void 0),y([S({readOnly:!0})],Ln.prototype,"thumbnailUrl",null),y([S()],Ln.prototype,"units",void 0),y([S({readOnly:!0})],Ln.prototype,"userContentUrl",null),y([S({readOnly:!0})],Ln.prototype,"url",null),y([S()],Ln.prototype,"username",void 0),y([S()],Ln.prototype,"userLicenseTypeId",void 0),y([S()],Ln.prototype,"userType",void 0),Ln=P6=y([se("esri.portal.PortalUser")],Ln);const p7=Ln;var Bu;let N2;const VQ={PortalGroup:()=>Promise.resolve({default:T6}),PortalItem:()=>_e(()=>Promise.resolve().then(()=>C0e),void 0),PortalUser:()=>Promise.resolve({default:p7})};let _t=Bu=class extends it.JSONSupportMixin(Lf){constructor(t){super(t),this._esriIdCredentialCreateHandle=null,this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.basemapGalleryGroupQuery3D=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.default3DBasemapQuery=null,this.defaultBasemap=null,this.defaultDevBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.devBasemapGalleryGroupQuery=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.layoutGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.hasClassificationSchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.recycleBinEnabled=!1,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=Ks.portalUrl,this.urlKey=null,this.user=null,this.use3dBasemaps=!0,this.useDefault3dBasemap=!1,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(t){return typeof t=="string"?{url:t}:t}destroy(){zQ.unregister(this),this.defaultBasemap=er(this.defaultBasemap),this.defaultDevBasemap=er(this.defaultDevBasemap),this.defaultVectorBasemap=er(this.defaultVectorBasemap),this._esriIdCredentialCreateHandle=sr(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(t){if(t)for(const e of t)Ks.request.trustedServers.includes(e)||Ks.request.trustedServers.push(e);return t}readDefaultBasemap(t){return this._readBasemap(t)}readDefaultDevBasemap(t){return this._readBasemap(t)}readDefaultVectorBasemap(t){return this._readBasemap(t)}get extraQuery(){var i;const t=(i=this.user)==null?void 0:i.orgId,e=!t||this.canSearchPublic;return this.id&&!e?` AND orgid:${this.id}`:null}get hasAPIKey(){return mce(this.url)}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get restUrl(){let t=this.url;if(t){const e=t.indexOf("/sharing");t=e>0?t.slice(0,e):this.url.replace(/\/+$/,""),t+="/sharing/rest"}return t}get thumbnailUrl(){const t=this.restUrl,e=this.thumbnail;return t&&e?this._normalizeSSL(t+"/portals/self/resources/"+e):null}readUrlKey(t){return t&&t.toLowerCase()}readUser(t){let e=null;return t&&(e=p7.fromJSON(t),e.portal=this),e}load(t){const e=_e(()=>Promise.resolve().then(()=>KWe),void 0).then(({default:i})=>{vr(t),N2=i}).then(()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,t)).then(i=>{var s;if(!this.hasAPIKey&&Yi){const n=Yi;this.credential=n.findCredential(this.restUrl),this.credential||this.authMode!==Bu.AUTH_MODE_AUTO&&this.authMode!==Bu.AUTH_MODE_NO_PROMPT||((s=this._esriIdCredentialCreateHandle)==null||s.remove(),this._esriIdCredentialCreateHandle=n.on("credential-create",xNe(new WeakRef(this))),zQ.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=i,this.read(i)});return this.addResolvingPromise(e),Promise.resolve(this)}async createElevationLayers(){await this.load();const t=this._getHelperService("defaultElevationLayers"),e=(await _e(async()=>{const{default:i}=await import("./ElevationLayer-D7OJeUVI.js");return{default:i}},__vite__mapDeps([17,18,19,20,21,15,22]))).default;return t?t.map(i=>new e({id:i.id,url:i.url})):[]}async fetchBasemaps(t,e){const i=await this._fetchBasemaps(t,e);if((e==null?void 0:e.include3d)===!0&&this.use3dBasemaps!==!1){const s=await this._fetchBasemaps3D(t,e);i.unshift(...s)}return i}async fetchDefault3DBasemap(t){if(!this.useDefault3dBasemap||!this.default3DBasemapQuery||this.default3DBasemapQuery==="none")return null;const e=new sd;e.query=this.default3DBasemapQuery,e.disableExtraQuery=!0;const i=(await this.queryItems(e,t)).results.find(s=>s.type==="Web Scene");return i?new N2({portalItem:i}):null}fetchCategorySchema(t){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",t).then(e=>e.categorySchema):dc(t)?Promise.reject(Vn()):Promise.resolve([])}async fetchClassificationSchema(t){return this.hasClassificationSchema?this.request(this.restUrl+"/portals/self/classification/classificationSchema",t).then(e=>e.classificationSchema):null}fetchFeaturedGroups(t){const e=this.featuredGroups,i=new sd({num:100,sortField:"title"});if(e!=null&&e.length){const s=[];for(const n of e)s.push(`(title:"${n.title}" AND owner:${n.owner})`);return i.query=s.join(" OR "),this.queryGroups(i,t).then(n=>n.results)}return dc(t)?Promise.reject(Vn()):Promise.resolve([])}fetchRegions(t){var i;const e=((i=this.user)==null?void 0:i.culture)||this.culture||vu();return this.request(this.restUrl+"/portals/regions",{...t,query:{culture:e}})}fetchSettings(t){var i;const e=((i=this.user)==null?void 0:i.culture)||this.culture||vu();return this.request(this.restUrl+"/portals/self/settings",{...t,query:{culture:e}})}static getDefault(){return gNe(()=>new Bu)}queryGroups(t,e){return this.queryPortal("/community/groups",t,"PortalGroup",e)}queryItems(t,e){return this.queryPortal("/search",t,"PortalItem",e)}queryUsers(t,e){return t.sortField||(t.sortField="username"),this.queryPortal("/community/users",t,"PortalUser",e)}fetchSelf(t=this.authMode,e=!1,i){const s=this.restUrl+"/portals/self",n={authMode:t,query:{culture:vu().toLowerCase()},withCredentials:!0,...i};return n.authMode==="auto"&&(n.authMode="no-prompt"),e&&(n.query.default=!0),this.request(s,n)}queryPortal(t,e,i,s){const n=xo(sd,e),r=o=>this.request(this.restUrl+t,{...n.toRequestOptions(this),...s}).then(a=>{const l=n.clone();return l.start=a.nextStart,new yNe({nextQueryParams:l,queryParams:n,total:a.total,results:Bu._resultsToTypedArray(o,{portal:this},a,s)})}).then(a=>Promise.all(a.results.map(l=>typeof l.when=="function"?l.when():a)).then(()=>a,l=>(ym(l),a)));return i&&VQ[i]?VQ[i]().then(({default:o})=>(vr(s),r(o))):r()}signIn(){if(this.hasAPIKey)return this.load().then(()=>{if(!this.user)throw new Se("portal:not-authenticated","Unable to authenticate user. Portal.user is missing")});if(this.authMode===Bu.AUTH_MODE_ANONYMOUS||this.authMode===Bu.AUTH_MODE_NO_PROMPT&&!Yi)return Promise.reject(new Se("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if(this.loadStatus==="failed")return Promise.reject(this.loadError);const t=e=>Promise.resolve().then(()=>this.loadStatus==="not-loaded"?(e||(this.authMode="immediate"),this.load().then(()=>null)):this.loadStatus==="loading"?this.load().then(()=>this.credential?null:(this.credential=e,this.fetchSelf("immediate"))):this.user&&this.credential===e?null:(this.credential=e,this.fetchSelf("immediate"))).then(i=>{i&&(this.sourceJSON=i,this.read(i))});return Yi?Yi.getCredential(this.restUrl,{prompt:this.authMode!==Bu.AUTH_MODE_NO_PROMPT}).then(e=>t(e)):t(this.credential)}normalizeUrl(t){var i;const e=(i=this.credential)==null?void 0:i.token;return this._normalizeSSL(e?t+(t.includes("?")?"&":"?")+"token="+e:t)}requestToTypedArray(t,e,i){return this.request(t,e).then(s=>{const n=Bu._resultsToTypedArray(i,{portal:this},s);return Promise.all(n.map(r=>typeof r.when=="function"?r.when():s)).then(()=>n,()=>n)})}request(t,e={}){const i={f:"json",...e.query},{authMode:s=this.authMode===Bu.AUTH_MODE_ANONYMOUS||this.authMode===Bu.AUTH_MODE_NO_PROMPT?this.authMode:"auto",body:n=null,cacheBust:r=!1,method:o="auto",responseType:a="json",signal:l}=e,u={authMode:s,body:n,cacheBust:r,method:o,query:i,responseType:a,timeout:0,signal:l};return e.withCredentials&&(u.withCredentials=!0),$n(this._normalizeSSL(t),u).then(c=>c.data)}toJSON(){throw new Se("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new Bu({sourceJSON:t})}_getHelperService(t){const e=this.helperServices&&this.helperServices[t];if(!e)throw new Se("portal:service-not-found",`The \`helperServices\` do not include an entry named "${t}"`);return e}async _fetchBasemaps(t,e){const i=new sd;i.query=t||(this.hasAPIKey?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),i.disableExtraQuery=!0;const s=await this.queryGroups(i,e);if(!s.total)return[];const n=s.results[0];i.num=100,i.query='type:"Web Map" -type:"Web Application"',i.sortField=n.sortField||"name",i.sortOrder=n.sortOrder||"desc";const r=await n.queryItems(i,e);return r.total?r.results.filter(o=>o.type==="Web Map").map(o=>new N2({portalItem:o})):[]}async _fetchBasemaps3D(t,e){const i=t||this.basemapGalleryGroupQuery3D;if(!i)return[];if(this.hasAPIKey)return[];const s=new sd({query:i,disableExtraQuery:!0}),n=await this.queryGroups(s,e);if(!n.total)return[];const r=n.results[0];s.num=100,s.query='type:"Web Scene"',s.sortField=r.sortField||"name",s.sortOrder=r.sortOrder||"desc";const o=await r.queryItems(s,e);return o.total?o.results.filter(a=>a.type==="Web Scene").map(a=>new N2({portalItem:a})):[]}_normalizeSSL(t){return t.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(t){if(t){const e=N2.fromJSON(t);return e.portalItem={portal:this},e}return null}static _resultsToTypedArray(t,e,i,s){let n;if(i){const r=s!=null?s.signal:null;n=i.listings||i.notifications||i.userInvitations||i.tags||i.items||i.groups||i.comments||i.provisions||i.results||i.relatedItems||i,(t||e)&&(n=n.map(o=>{const a=Object.assign(t?t.fromJSON(o):o,e);return typeof a.load=="function"&&a.load(r),a}))}else n=[];return n}};_t.AUTH_MODE_ANONYMOUS="anonymous",_t.AUTH_MODE_AUTO="auto",_t.AUTH_MODE_IMMEDIATE="immediate",_t.AUTH_MODE_NO_PROMPT="no-prompt",y([S()],_t.prototype,"access",void 0),y([S()],_t.prototype,"allSSL",void 0),y([S()],_t.prototype,"authMode",void 0),y([S()],_t.prototype,"authorizedCrossOriginDomains",void 0),y([mt("authorizedCrossOriginDomains")],_t.prototype,"readAuthorizedCrossOriginDomains",null),y([S()],_t.prototype,"basemapGalleryGroupQuery",void 0),y([S({json:{name:"3DBasemapGalleryGroupQuery"}})],_t.prototype,"basemapGalleryGroupQuery3D",void 0),y([S()],_t.prototype,"bingKey",void 0),y([S()],_t.prototype,"canListApps",void 0),y([S()],_t.prototype,"canListData",void 0),y([S()],_t.prototype,"canListPreProvisionedItems",void 0),y([S()],_t.prototype,"canProvisionDirectPurchase",void 0),y([S()],_t.prototype,"canSearchPublic",void 0),y([S()],_t.prototype,"canShareBingPublic",void 0),y([S()],_t.prototype,"canSharePublic",void 0),y([S()],_t.prototype,"canSignInArcGIS",void 0),y([S()],_t.prototype,"canSignInIDP",void 0),y([S()],_t.prototype,"colorSetsGroupQuery",void 0),y([S()],_t.prototype,"commentsEnabled",void 0),y([S({type:Date})],_t.prototype,"created",void 0),y([S()],_t.prototype,"credential",void 0),y([S()],_t.prototype,"culture",void 0),y([S()],_t.prototype,"currentVersion",void 0),y([S()],_t.prototype,"customBaseUrl",void 0),y([S()],_t.prototype,"default3DBasemapQuery",void 0),y([S()],_t.prototype,"defaultBasemap",void 0),y([mt("defaultBasemap")],_t.prototype,"readDefaultBasemap",null),y([S()],_t.prototype,"defaultDevBasemap",void 0),y([mt("defaultDevBasemap")],_t.prototype,"readDefaultDevBasemap",null),y([S({type:Nn})],_t.prototype,"defaultExtent",void 0),y([S()],_t.prototype,"defaultVectorBasemap",void 0),y([mt("defaultVectorBasemap")],_t.prototype,"readDefaultVectorBasemap",null),y([S()],_t.prototype,"description",void 0),y([S()],_t.prototype,"devBasemapGalleryGroupQuery",void 0),y([S()],_t.prototype,"eueiEnabled",void 0),y([S({readOnly:!0})],_t.prototype,"extraQuery",null),y([S()],_t.prototype,"featuredGroups",void 0),y([S()],_t.prototype,"featuredItemsGroupQuery",void 0),y([S()],_t.prototype,"galleryTemplatesGroupQuery",void 0),y([S()],_t.prototype,"layoutGroupQuery",void 0),y([S()],_t.prototype,"livingAtlasGroupQuery",void 0),y([S({readOnly:!0})],_t.prototype,"hasAPIKey",null),y([S()],_t.prototype,"hasCategorySchema",void 0),y([S()],_t.prototype,"hasClassificationSchema",void 0),y([S()],_t.prototype,"helpBase",void 0),y([S()],_t.prototype,"helperServices",void 0),y([S()],_t.prototype,"helpMap",void 0),y([S()],_t.prototype,"homePageFeaturedContent",void 0),y([S()],_t.prototype,"homePageFeaturedContentCount",void 0),y([S()],_t.prototype,"httpPort",void 0),y([S()],_t.prototype,"httpsPort",void 0),y([S()],_t.prototype,"id",void 0),y([S()],_t.prototype,"ipCntryCode",void 0),y([S({readOnly:!0})],_t.prototype,"isOrganization",null),y([S()],_t.prototype,"isPortal",void 0),y([S()],_t.prototype,"isReadOnly",void 0),y([S({readOnly:!0})],_t.prototype,"itemPageUrl",null),y([S()],_t.prototype,"layerTemplatesGroupQuery",void 0),y([S()],_t.prototype,"maxTokenExpirationMinutes",void 0),y([S({type:Date})],_t.prototype,"modified",void 0),y([S()],_t.prototype,"name",void 0),y([S()],_t.prototype,"portalHostname",void 0),y([S()],_t.prototype,"portalMode",void 0),y([S()],_t.prototype,"portalProperties",void 0),y([S()],_t.prototype,"region",void 0),y([S()],_t.prototype,"recycleBinEnabled",void 0),y([S({readOnly:!0})],_t.prototype,"restUrl",null),y([S()],_t.prototype,"rotatorPanels",void 0),y([S()],_t.prototype,"showHomePageDescription",void 0),y([S()],_t.prototype,"sourceJSON",void 0),y([S()],_t.prototype,"staticImagesUrl",void 0),y([S({json:{name:"2DStylesGroupQuery"}})],_t.prototype,"stylesGroupQuery2d",void 0),y([S({json:{name:"stylesGroupQuery"}})],_t.prototype,"stylesGroupQuery3d",void 0),y([S()],_t.prototype,"supportsHostedServices",void 0),y([S()],_t.prototype,"symbolSetsGroupQuery",void 0),y([S()],_t.prototype,"templatesGroupQuery",void 0),y([S()],_t.prototype,"thumbnail",void 0),y([S({readOnly:!0})],_t.prototype,"thumbnailUrl",null),y([S()],_t.prototype,"units",void 0),y([S()],_t.prototype,"url",void 0),y([S()],_t.prototype,"urlKey",void 0),y([mt("urlKey")],_t.prototype,"readUrlKey",null),y([S()],_t.prototype,"user",void 0),y([mt("user")],_t.prototype,"readUser",null),y([S()],_t.prototype,"use3dBasemaps",void 0),y([S()],_t.prototype,"useDefault3dBasemap",void 0),y([S()],_t.prototype,"useStandardizedQuery",void 0),y([S()],_t.prototype,"useVectorBasemaps",void 0),y([S()],_t.prototype,"vectorBasemapGalleryGroupQuery",void 0),_t=Bu=y([se("esri.portal.Portal")],_t);const Cu=_t,zQ=new FinalizationRegistry(t=>{t.remove()});function xNe(t){const e=Yi;return()=>{const i=t.deref();i&&e.findCredential(i.restUrl)&&i.signIn().catch(()=>{})}}let wb=class extends it{constructor(e){super(e),this.enabled=!0,this.type=null,this.ignoreDrivers=!1}writeEnabled(e,i,s){e||(i[s]=e)}};y([S({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],wb.prototype,"enabled",void 0),y([yt("enabled")],wb.prototype,"writeEnabled",null),y([S({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0,json:{write:{isRequired:!0}}})],wb.prototype,"type",void 0),wb=y([se("esri.symbols.Symbol3DLayer")],wb);const jm=wb,bNe=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,wNe="screenUtils.toPt: input not recognized!",ome=96;function SNe(t){return t?t/72*ome:0}function rh(t){return t?72*t/ome:0}function Ps(t){if(typeof t=="string"){const e=t.match(bNe);if(e){const i=Number(e[1]),s=e[3]&&e[3].toLowerCase(),n=t.charAt(0)==="-",r=s==="px"?rh(i):i;return n?-r:r}return console.warn(wNe),null}return t}function oa(t=0,e=0){return{x:t,y:e}}function b_t(t){return t?oa(t.x,t.y):null}function w_t(t=0,e=0){return[t,e]}function S_t(t=0,e=0,i=0){return[t,e,i]}function E_t(t){return t}function C_t(t){return t}function T_t(t){return t}function P_t(t,e){return e?(e[0]=t.x,e[1]=t.y,e.length>2&&(e[2]=0),e):[t.x,t.y]}function HF(t){const e=oH(100*(1-t));return Math.max(0,Math.min(e,100))}function IP(t){const e=1-t/100;return Math.max(0,Math.min(e,1))}function ENe(t,e){const i=e.transparency!=null?IP(e.transparency):1,s=e.color;return s&&Array.isArray(s)?new Gt([s[0]||0,s[1]||0,s[2]||0,i]):null}function CNe(t,e){e.color=t.toJSON().slice(0,3);const i=HF(t.a);i!==0&&(e.transparency=i)}function Ly(t){return{type:Gt,nonNullable:t==null?void 0:t.nonNullable,json:{type:[zs],default:null,read:{source:["color","transparency"],reader:ENe},write:{target:{color:{type:[zs],isRequired:t==null?void 0:t.colorRequiredOnWrite},transparency:{type:zs}},writer:CNe}}}}const $m={type:Number,cast:Ps,json:{write:!0}};let B0=class extends it{constructor(e){super(e),this.color=new Gt([0,0,0,1]),this.extensionLength=0,this.size=rh(1)}clone(){}cloneProperties(){return{color:be(this.color),size:this.size,extensionLength:this.extensionLength}}};y([S({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],B0.prototype,"type",void 0),y([S(Ly({colorRequiredOnWrite:!0}))],B0.prototype,"color",void 0),y([S({...$m,json:{write:{overridePolicy:t=>({enabled:!!t})}}})],B0.prototype,"extensionLength",void 0),y([S($m)],B0.prototype,"size",void 0),B0=y([se("esri.symbols.edges.Edges3D")],B0);const f7=B0;var M6;let qR=M6=class extends f7{constructor(t){super(t),this.type="sketch"}clone(){return new M6(this.cloneProperties())}};y([ai({sketch:"sketch"},{readOnly:!0})],qR.prototype,"type",void 0),qR=M6=y([se("esri.symbols.edges.SketchEdges3D")],qR);const TNe=qR;var A6;let HR=A6=class extends f7{constructor(t){super(t),this.type="solid"}clone(){return new A6(this.cloneProperties())}};y([ai({solid:"solid"},{readOnly:!0})],HR.prototype,"type",void 0),HR=A6=y([se("esri.symbols.edges.SolidEdges3D")],HR);const ame=HR,lme={types:{key:"type",base:f7,typeMap:{solid:ame,sketch:TNe}},json:{write:!0}};function Fy(){return[0,0,0]}function g7(t){return[t[0],t[1],t[2]]}function jS(t,e,i){return[t,e,i]}function PNe(t,e,i){return[t,e,i]}function MNe(t,e=Fy()){const i=Math.min(3,t.length);for(let s=0;s<i;++s)e[s]=t[s];return e}function ANe(t,e){return new Float64Array(t,e,3)}function ume(){return Fy()}function cme(){return jS(1,1,1)}function hme(){return jS(1,0,0)}function dme(){return jS(0,1,0)}function mme(){return jS(0,0,1)}const INe=ume(),DNe=cme(),NNe=hme(),RNe=dme(),ONe=mme();Object.freeze(Object.defineProperty({__proto__:null,ONES:DNe,UNIT_X:NNe,UNIT_Y:RNe,UNIT_Z:ONe,ZEROS:INe,clone:g7,create:Fy,createView:ANe,freeze:PNe,fromArray:MNe,fromValues:jS,ones:cme,unitX:hme,unitY:dme,unitZ:mme,zeros:ume},Symbol.toStringTag,{value:"Module"}));var I6;let oc=I6=class extends it{constructor(t){super(t),this.color=null,this.emissiveFactor=null}clone(){var e;const t={color:((e=this.color)==null?void 0:e.clone())??null,emissiveFactor:this.emissiveFactor?g7(this.emissiveFactor):null};return new I6(t)}};y([S(Ly())],oc.prototype,"color",void 0),y([S({type:[Number],json:{write:!1}})],oc.prototype,"emissiveFactor",void 0),oc=I6=y([se("esri.symbols.support.Symbol3DMaterial")],oc);var D6;let o_=D6=class extends jm{constructor(t){super(t),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){var t,e;return new D6({edges:(t=this.edges)==null?void 0:t.clone(),enabled:this.enabled,material:(e=this.material)==null?void 0:e.clone(),castShadows:this.castShadows,size:this.size})}};y([ai({Extrude:"extrude"},{readOnly:!0})],o_.prototype,"type",void 0),y([S({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],o_.prototype,"size",void 0),y([S({type:oc,json:{write:!0}})],o_.prototype,"material",void 0),y([S({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],o_.prototype,"castShadows",void 0),y([S(lme)],o_.prototype,"edges",void 0),o_=D6=y([se("esri.symbols.ExtrudeSymbol3DLayer")],o_);const pme=o_;let jR=class extends it{constructor(e){super(e)}clone(){throw new Error("Subclasses of LinePattern3D should implement their own clone method.")}};y([S({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],jR.prototype,"type",void 0),jR=y([se("esri.symbols.patterns.LinePattern3D")],jR);const fme=jR,LNe=["dash","dash-dot","dot","long-dash","long-dash-dot","long-dash-dot-dot","none","short-dash","short-dash-dot","short-dash-dot-dot","short-dot","solid"];var N6;const FNe=ca()({dash:"dash","dash-dot":"dash-dot","dash-dot-dot":"long-dash-dot-dot",dot:"dot","long-dash":"long-dash","long-dash-dot":"long-dash-dot",null:"none","short-dash":"short-dash","short-dash-dot":"short-dash-dot","short-dash-dot-dot":"short-dash-dot-dot","short-dot":"short-dot",solid:"solid"});let IC=N6=class extends fme{constructor(t){super(t),this.type="style",this.style="solid"}clone(){const t={style:this.style};return new N6(t)}};y([S({type:["style"],json:{write:{isRequired:!0}}})],IC.prototype,"type",void 0),y([ai(FNe),S({type:LNe,json:{write:{isRequired:!0}}})],IC.prototype,"style",void 0),IC=N6=y([se("esri.symbols.patterns.LineStylePattern3D")],IC);const _7=IC;let YR=class extends it{constructor(e){super(e),this.type="style"}clone(){throw new Error("Subclasses of Pattern3D should implement their own clone method.")}};y([S({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],YR.prototype,"type",void 0),YR=y([se("esri.symbols.patterns.Pattern3D")],YR);const gme=YR,kNe=["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"];var R6;let DC=R6=class extends gme{constructor(t){super(t),this.type="style",this.style="solid"}clone(){return new R6({style:this.style})}};y([S({type:["style"],json:{write:{isRequired:!0}}})],DC.prototype,"type",void 0),y([S({type:kNe,json:{read:!0,write:{isRequired:!0}}})],DC.prototype,"style",void 0),DC=R6=y([se("esri.symbols.patterns.StylePattern3D")],DC);const _me=DC,$Ne={types:{key:"type",base:gme,typeMap:{style:_me}},json:{write:!0}},yme={types:{key:"type",base:fme,typeMap:{style:_7}},json:{write:!0}},GT=new Gt("white"),UNe=new Gt([255,255,255,0]);function VNe(t){return t.r===0&&t.g===0&&t.b===0}var O6;let BT=O6=class extends oc{constructor(t){super(t),this.colorMixMode=null}clone(){var e;const t={color:((e=this.color)==null?void 0:e.clone())??null,emissiveFactor:this.emissiveFactor?g7(this.emissiveFactor):null,colorMixMode:this.colorMixMode};return new O6(t)}};y([ai({multiply:"multiply",replace:"replace",tint:"tint"})],BT.prototype,"colorMixMode",void 0),BT=O6=y([se("esri.symbols.support.Symbol3DFillMaterial")],BT);function zNe(t,e=!1){return t<=Ble?e?new Array(t).fill(0):new Array(t):new Float64Array(t)}function D_t(t){return(uEe(t)?t.byteLength/8:t.length)<=Ble?Array.from(t):new Float64Array(t)}function N_t(t,e,i){return Array.isArray(t)?t.slice(e,e+i):t.subarray(e,e+i)}function eA(t=HNe){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function y7(t,e,i,s,n,r,o=eA()){return o[0]=t,o[1]=e,o[2]=i,o[3]=s,o[4]=n,o[5]=r,o}function R_t(t,e=eA()){return GNe(t,0,t.length/3,e)}function GNe(t,e,i,s=eA()){return vme(s,L6),BNe(s,t,e,i),s}function O_t(t,e=zNe(24)){const[i,s,n,r,o,a]=t;return e[0]=i,e[1]=s,e[2]=n,e[3]=i,e[4]=s,e[5]=a,e[6]=i,e[7]=o,e[8]=n,e[9]=i,e[10]=o,e[11]=a,e[12]=r,e[13]=s,e[14]=n,e[15]=r,e[16]=s,e[17]=a,e[18]=r,e[19]=o,e[20]=n,e[21]=r,e[22]=o,e[23]=a,e}function L_t(t,e){const i=isFinite(t[2])||isFinite(t[5]);return new Nn(i?{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],zmin:t[2],zmax:t[5],spatialReference:e}:{xmin:t[0],xmax:t[3],ymin:t[1],ymax:t[4],spatialReference:e})}function F_t(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t[4]=Math.max(t[4],e[4]),t[5]=Math.max(t[5],e[5])}function k_t(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[3]=Math.max(t[3],e[2]),t[4]=Math.max(t[4],e[3])}function $_t(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[0]),t[4]=Math.max(t[4],e[1]),t[5]=Math.max(t[5],e[2])}function BNe(t,e,i=0,s=e.length/3){let n=t[0],r=t[1],o=t[2],a=t[3],l=t[4],u=t[5];for(let c=0;c<s;c++)n=Math.min(n,e[i+3*c]),r=Math.min(r,e[i+3*c+1]),o=Math.min(o,e[i+3*c+2]),a=Math.max(a,e[i+3*c]),l=Math.max(l,e[i+3*c+1]),u=Math.max(u,e[i+3*c+2]);t[0]=n,t[1]=r,t[2]=o,t[3]=a,t[4]=l,t[5]=u}function U_t(t,e,i){const s=e.length;let n=t[0],r=t[1],o=t[2],a=t[3],l=t[4],u=t[5];if(i)for(let c=0;c<s;c++){const h=e[c];n=Math.min(n,h[0]),r=Math.min(r,h[1]),o=Math.min(o,h[2]),a=Math.max(a,h[0]),l=Math.max(l,h[1]),u=Math.max(u,h[2])}else for(let c=0;c<s;c++){const h=e[c];n=Math.min(n,h[0]),r=Math.min(r,h[1]),a=Math.max(a,h[0]),l=Math.max(l,h[1])}t[0]=n,t[1]=r,t[2]=o,t[3]=a,t[4]=l,t[5]=u}function V_t(t){for(let e=0;e<6;e++)if(!isFinite(t[e]))return!1;return!0}function tA(t){return t[0]>=t[3]?0:t[3]-t[0]}function iA(t){return t[1]>=t[4]?0:t[4]-t[1]}function sA(t){return t[2]>=t[5]?0:t[5]-t[2]}function z_t(t){const e=tA(t),i=sA(t),s=iA(t);return Math.sqrt(e*e+i*i+s*s)}function G_t(t,e=[0,0,0]){return e[0]=t[0]+tA(t)/2,e[1]=t[1]+iA(t)/2,e[2]=t[2]+sA(t)/2,e}function B_t(t,e=[0,0,0]){return e[0]=tA(t),e[1]=iA(t),e[2]=sA(t),e}function q_t(t,e){return e[0]>=t[0]&&e[1]>=t[1]&&e[2]>=t[2]&&e[0]<=t[3]&&e[1]<=t[4]&&e[2]<=t[5]}function qNe(t,e){return Math.max(e[0],t[0])<=Math.min(e[3],t[3])&&Math.max(e[1],t[1])<=Math.min(e[4],t[4])&&Math.max(e[2],t[2])<=Math.min(e[5],t[5])}function H_t(t,e){return e==null||qNe(t,e)}function j_t(t,e,i,s,n=t){return n[0]=t[0]+e,n[1]=t[1]+i,n[2]=t[2]+s,n[3]=t[3]+e,n[4]=t[4]+i,n[5]=t[5]+s,n}function Y_t(t,e,i=t){const s=t[0]+tA(t)/2,n=t[1]+iA(t)/2,r=t[2]+sA(t)/2;return i[0]=s+(t[0]-s)*e,i[1]=n+(t[1]-n)*e,i[2]=r+(t[2]-r)*e,i[3]=s+(t[3]-s)*e,i[4]=n+(t[4]-n)*e,i[5]=r+(t[5]-r)*e,i}function X_t(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function W_t(t,e,i=t){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i!==t&&(i[3]=t[3],i[4]=t[4],i[5]=t[5]),i}function Z_t(t,e,i=t){return i[3]=e[0],i[4]=e[1],i[5]=e[2],i!==t&&(i[0]=t[0],i[1]=t[1],i[2]=t[2]),t}function vme(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function K_t(t){return t?vme(t,L6):eA(L6)}function Q_t(t,e){return e||(e=Dl()),e[0]=t[0],e[1]=t[1],e[2]=t[3],e[3]=t[4],e}function J_t(t,e){return t[0]=e[0],t[1]=e[1],t[2]=Number.NEGATIVE_INFINITY,t[3]=e[2],t[4]=e[3],t[5]=Number.POSITIVE_INFINITY,t}function eyt(t,e,i,s,n){return t[0]=e,t[1]=i,t[2]=Number.NEGATIVE_INFINITY,t[3]=s,t[4]=n,t[5]=Number.POSITIVE_INFINITY,t}function GQ(t){return t.length===6}function tyt(t){return tA(t)===0&&iA(t)===0&&sA(t)===0}function iyt(t,e,i){if(t==null||e==null)return t===e;if(!GQ(t)||!GQ(e))return!1;for(let s=0;s<t.length;s++)if(t[s]!==e[s])return!1;return!0}const L6=[1/0,1/0,1/0,-1/0,-1/0,-1/0],HNe=[0,0,0,0,0,0];eA();function syt(t,{isPrimitive:e,width:i,depth:s,height:n}){const r=e?10:1;if(i==null&&n==null&&s==null)return[r*t[0],r*t[1],r*t[2]];const o=jS(i,s,n);let a;for(let l=0;l<3;l++){const u=o[l];if(u!=null){a=u/t[l];break}}for(let l=0;l<3;l++)o[l]==null&&(o[l]=t[l]*a);return o}const jNe=y7(-.5,-.5,-.5,.5,.5,.5),YNe=y7(-.5,-.5,0,.5,.5,1),XNe=y7(-.5,-.5,0,.5,.5,.5);function nyt(t){switch(t){case"sphere":case"cube":case"diamond":return jNe;case"cylinder":case"cone":case"inverted-cone":return YNe;case"tetrahedron":return XNe;default:return}}const v7=["butt","square","round"],WNe=[...v7,"none"],xme=["miter","bevel","round"];var F6;let q0=F6=class extends it{constructor(t){super(t),this.color=new Gt([0,0,0,1]),this.size=rh(1),this.pattern=null,this.patternCap="butt"}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size,pattern:this.pattern!=null?this.pattern.clone():null,patternCap:this.patternCap};return new F6(t)}};y([S(Ly({colorRequiredOnWrite:!0}))],q0.prototype,"color",void 0),y([S({...$m,json:{write:{isRequired:!0}}})],q0.prototype,"size",void 0),y([S(yme)],q0.prototype,"pattern",void 0),y([S({type:v7,json:{default:"butt",write:{overridePolicy(){return{enabled:this.pattern!=null}}}}})],q0.prototype,"patternCap",void 0),q0=F6=y([se("esri.symbols.support.Symbol3DOutline")],q0);var XR;let kp=XR=class extends jm{constructor(t){super(t),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){const t={edges:this.edges!=null?this.edges.clone():null,enabled:this.enabled,material:this.material!=null?this.material.clone():null,pattern:this.pattern!=null?this.pattern.clone():null,castShadows:this.castShadows,outline:this.outline!=null?this.outline.clone():null};return new XR(t)}static fromSimpleFillSymbol(t){var s,n,r;const e=t.outline&&t.outline.style&&t.outline.style!=="solid"?new _7({style:t.outline.style}):null,i={size:((s=t.outline)==null?void 0:s.width)??0,color:(((n=t.outline)==null?void 0:n.color)??GT).clone(),pattern:e};return e&&((r=t.outline)!=null&&r.cap)&&(i.patternCap=t.outline.cap),new XR({material:new BT({color:(t.color??UNe).clone()}),pattern:t.style&&t.style!=="solid"?new _me({style:t.style}):null,outline:i})}};y([ai({Fill:"fill"},{readOnly:!0})],kp.prototype,"type",void 0),y([S({type:BT,json:{write:!0}})],kp.prototype,"material",void 0),y([S($Ne)],kp.prototype,"pattern",void 0),y([S({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],kp.prototype,"castShadows",void 0),y([S({type:q0,json:{write:!0}})],kp.prototype,"outline",void 0),y([S(lme)],kp.prototype,"edges",void 0),kp=XR=y([se("esri.symbols.FillSymbol3DLayer")],kp);const z1=kp;var k6;const ZNe=ca()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let H0=k6=class extends it{constructor(t){super(t)}readHref(t,e,i){return t?US(t,i):e.dataURI}writeHref(t,e,i,s){t&&(k1(t)?e.dataURI=t:(e.href=zM(t,s),uc(e.href)&&(e.href=hd(e.href))))}clone(){return new k6({href:this.href,primitive:this.primitive})}};y([S({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],H0.prototype,"href",void 0),y([mt("href")],H0.prototype,"readHref",null),y([yt("href",{href:{type:String},dataURI:{type:String}})],H0.prototype,"writeHref",null),y([ai(ZNe)],H0.prototype,"primitive",void 0),H0=k6=y([se("esri.symbols.support.IconSymbol3DLayerResource")],H0);const ryt="circle";var $6;let aw=$6=class extends ei{constructor(){super(...arguments),this.x=0,this.y=0}clone(){return new $6({x:this.x,y:this.y})}};y([S({type:Number})],aw.prototype,"x",void 0),y([S({type:Number})],aw.prototype,"y",void 0),aw=$6=y([se("esri.symbols.support.Symbol3DAnchorPosition2D")],aw);var U6;let NC=U6=class extends it{constructor(t){super(t),this.color=new Gt([0,0,0,1]),this.size=rh(1)}clone(){const t={color:this.color!=null?this.color.clone():null,size:this.size};return new U6(t)}};y([S(Ly({colorRequiredOnWrite:!0}))],NC.prototype,"color",void 0),y([S({...$m,json:{write:{isRequired:!0}}})],NC.prototype,"size",void 0),NC=U6=y([se("esri.symbols.support.Symbol3DIconOutline")],NC);var Sb;const bme="esri.symbols.IconSymbol3DLayer";let $h=Sb=class extends jm{constructor(t){super(t),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null,this.angle=0}clone(){return new Sb({anchor:this.anchor,anchorPosition:be(this.anchorPosition),enabled:this.enabled,material:be(this.material),outline:be(this.outline),resource:be(this.resource),angle:this.angle,size:this.size})}static fromSimpleMarkerSymbol(t){const e=t.color||GT,i=BQ(t),s=t.outline&&t.outline.width>0?{size:t.outline.width,color:(t.outline.color||GT).clone()}:null;return new Sb({size:t.size,angle:t.angle,resource:{primitive:QNe(t.style)},material:{color:e},outline:s,anchor:i?"relative":void 0,anchorPosition:i})}static fromPictureMarkerSymbol(t){const e=!t.color||VNe(t.color)?GT:t.color,i=BQ(t);return new Sb({size:t.width<=t.height?t.height:t.width,angle:t.angle,resource:{href:t.url},material:{color:e.clone()},anchor:i?"relative":void 0,anchorPosition:i})}static fromCIMSymbol(t){return new Sb({resource:{href:ice({mediaType:"application/json",data:JSON.stringify(t.data)})}})}};y([S({type:oc,json:{write:!0}})],$h.prototype,"material",void 0),y([S({type:H0,json:{write:!0}})],$h.prototype,"resource",void 0),y([ai({Icon:"icon"},{readOnly:!0})],$h.prototype,"type",void 0),y([S({...$m,json:{write:{isRequired:!0}}})],$h.prototype,"size",void 0),y([ai({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"},{default:"center"})],$h.prototype,"anchor",void 0),y([S({type:aw,json:{type:[Number],read:{reader:t=>new aw({x:t[0],y:t[1]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],$h.prototype,"anchorPosition",void 0),y([S({type:NC,json:{write:!0}})],$h.prototype,"outline",void 0),y([S({type:Number,json:{write:!0,default:0}})],$h.prototype,"angle",void 0),$h=Sb=y([se(bme)],$h);const kv=$h;function BQ(t){const e="width"in t?t.width:t.size,i="height"in t?t.height:t.size,s=qQ(t.xoffset),n=qQ(t.yoffset);return(s||n)&&e&&i?{x:-s/e,y:n/i}:null}function qQ(t){return isFinite(t)?t:0}const KNe={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function QNe(t){return KNe[t]||(ht.getLogger(bme).warn(`${t} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}const JNe=["begin","end","begin-end"],wme=["arrow","circle","square","diamond","cross","x"];let j0=class extends bs.ClonableMixin(it){constructor(e){super(e),this.type="style",this.placement="begin-end",this.style="arrow",this.color=null}equals(e){return e!=null&&e.placement===this.placement&&e.style===this.style&&(this.color==null&&e.color==null||this.color!=null&&e.color!=null&&this.color.toJSON()===e.color.toJSON())}};y([S({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0,isRequired:!0}}})],j0.prototype,"type",void 0),y([S({type:JNe,json:{default:"begin-end",write:!0}})],j0.prototype,"placement",void 0),y([S({type:wme,json:{default:"arrow",write:!0}})],j0.prototype,"style",void 0),y([S({type:Gt,json:{type:[zs],default:null,write:!0}})],j0.prototype,"color",void 0),j0=y([se("esri.symbols.LineStyleMarker3D")],j0);const V6=j0;var WR;let Qd=WR=class extends jm{constructor(t){super(t),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=rh(1),this.pattern=null,this.marker=null}clone(){const t={enabled:this.enabled,material:this.material!=null?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,pattern:this.pattern!=null?this.pattern.clone():null,marker:this.marker!=null?this.marker.clone():null};return new WR(t)}static fromSimpleLineSymbol(t){var i;const e={enabled:!0,size:t.width??rh(1),cap:t.cap||"butt",join:t.join||"miter",pattern:t.style?new _7({style:t.style}):null,material:new oc({color:(t.color||GT).clone()}),marker:t.marker?new V6({placement:t.marker.placement,style:t.marker.style,color:((i=t.marker.color)==null?void 0:i.clone())??null}):null};return new WR(e)}};y([S({type:oc,json:{write:!0}})],Qd.prototype,"material",void 0),y([ai({Line:"line"},{readOnly:!0})],Qd.prototype,"type",void 0),y([S({type:xme,json:{write:!0,default:"miter"}})],Qd.prototype,"join",void 0),y([S({type:v7,json:{write:!0,default:"butt"}})],Qd.prototype,"cap",void 0),y([S({...$m,json:{write:{isRequired:!0}}})],Qd.prototype,"size",void 0),y([S(yme)],Qd.prototype,"pattern",void 0),y([S({types:{key:"type",base:V6,typeMap:{style:V6}},json:{write:!0}})],Qd.prototype,"marker",void 0),Qd=WR=y([se("esri.symbols.LineSymbol3DLayer")],Qd);const YS=Qd;var z6;const eRe=ca()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let RC=z6=class extends it{clone(){return new z6({href:this.href,primitive:this.primitive})}};y([S({type:String,json:{read:TH,write:o1}})],RC.prototype,"href",void 0),y([ai(eRe)],RC.prototype,"primitive",void 0),RC=z6=y([se("esri.symbols.support.ObjectSymbol3DLayerResource")],RC);const ayt="sphere";var G6;let Ev=G6=class extends ei{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new G6({x:this.x,y:this.y,z:this.z})}};y([S({type:Number})],Ev.prototype,"x",void 0),y([S({type:Number})],Ev.prototype,"y",void 0),y([S({type:Number})],Ev.prototype,"z",void 0),Ev=G6=y([se("esri.symbols.support.Symbol3DAnchorPosition3D")],Ev);var B6;let ja=B6=class extends jm{constructor(t){super(t),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){var t,e,i;return new B6({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:(t=this.anchorPosition)==null?void 0:t.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:((e=this.material)==null?void 0:e.clone())??null,castShadows:this.castShadows,resource:(i=this.resource)==null?void 0:i.clone(),width:this.width})}get isPrimitive(){return!this.resource||typeof this.resource.href!="string"}};y([S({type:oc,json:{write:!0}})],ja.prototype,"material",void 0),y([S({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],ja.prototype,"castShadows",void 0),y([S({type:RC,json:{write:!0}})],ja.prototype,"resource",void 0),y([ai({Object:"object"},{readOnly:!0})],ja.prototype,"type",void 0),y([S({type:Number,json:{write:!0}})],ja.prototype,"width",void 0),y([S({type:Number,json:{write:!0}})],ja.prototype,"height",void 0),y([S({type:Number,json:{write:!0}})],ja.prototype,"depth",void 0),y([ai({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"},{default:"origin"})],ja.prototype,"anchor",void 0),y([S({type:Ev,json:{type:[Number],read:{reader:t=>new Ev({x:t[0],y:t[1],z:t[2]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y,t.z]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],ja.prototype,"anchorPosition",void 0),y([S({type:Number,json:{write:!0}})],ja.prototype,"heading",void 0),y([S({type:Number,json:{write:!0}})],ja.prototype,"tilt",void 0),y([S({type:Number,json:{write:!0}})],ja.prototype,"roll",void 0),y([S({readOnly:!0})],ja.prototype,"isPrimitive",null),ja=B6=y([se("esri.symbols.ObjectSymbol3DLayer")],ja);const x7=ja;var q6;let xl=q6=class extends jm{constructor(t){super(t),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}readWidth(t,e){return t??(e.height==null&&e.size!=null?e.size:void 0)}readHeight(t,e){return t??(e.width==null&&e.size!=null?e.size:void 0)}clone(){return new q6({enabled:this.enabled,material:this.material!=null?this.material.clone():null,castShadows:this.castShadows,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}};y([S({type:oc,json:{write:!0}})],xl.prototype,"material",void 0),y([S({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],xl.prototype,"castShadows",void 0),y([ai({Path:"path"},{readOnly:!0})],xl.prototype,"type",void 0),y([S({type:["circle","quad"],json:{write:!0,default:"circle"}})],xl.prototype,"profile",void 0),y([S({type:xme,json:{write:!0,default:"miter"}})],xl.prototype,"join",void 0),y([S({type:WNe,json:{write:!0,default:"butt"}})],xl.prototype,"cap",void 0),y([S({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],xl.prototype,"width",void 0),y([mt("width",["width","size","height"])],xl.prototype,"readWidth",null),y([S({type:Number,json:{write:!0}})],xl.prototype,"height",void 0),y([mt("height",["height","size","width"])],xl.prototype,"readHeight",null),y([S({type:["center","bottom","top"],json:{write:!0,default:"center"}})],xl.prototype,"anchor",void 0),y([S({type:["heading","all"],json:{write:!0,default:"all"}})],xl.prototype,"profileRotation",void 0),xl=q6=y([se("esri.symbols.PathSymbol3DLayer")],xl);const b7=xl,tRe=["none","underline","line-through"],iRe=["normal","italic","oblique"],sRe=["normal","lighter","bold","bolder"],Sme={type:Number,cast:t=>{const e=Al(t);return e===0?1:sh(e,.1,4)},nonNullable:!0},nRe=["left","right","center"],rRe=["baseline","top","middle","bottom"],Eme={type:nRe,nonNullable:!0},Cme={type:rRe,nonNullable:!0},lyt=8;var H6;let $p=H6=class extends it{constructor(t){super(t),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(t){return Ps(t)}clone(){return new H6({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};y([S({type:tRe,json:{default:"none",write:!0}})],$p.prototype,"decoration",void 0),y([S({type:String,json:{write:!0}})],$p.prototype,"family",void 0),y([S({type:Number,json:{write:{overridePolicy:(t,e,i)=>({enabled:!i||!i.textSymbol3D})}}})],$p.prototype,"size",void 0),y([Ls("size")],$p.prototype,"castSize",null),y([S({type:iRe,json:{default:"normal",write:!0}})],$p.prototype,"style",void 0),y([S({type:sRe,json:{default:"normal",write:!0}})],$p.prototype,"weight",void 0),$p=H6=y([se("esri.symbols.Font")],$p);const jF=$p;var j6;let lw=j6=class extends it{constructor(){super(...arguments),this.color=new Gt([0,0,0,1]),this.size=0}clone(){const t={color:be(this.color),size:this.size};return new j6(t)}};y([S(Ly())],lw.prototype,"color",void 0),y([S($m)],lw.prototype,"size",void 0),lw=j6=y([se("esri.symbols.support.Symbol3DHalo")],lw);let qT=class extends bs.ClonableMixin(it){constructor(e){super(e),this.color=null}};y([S(Ly())],qT.prototype,"color",void 0),qT=y([se("esri.symbols.support.Symbol3DTextBackground")],qT);var ZR;let Jl=ZR=class extends jm{constructor(t){super(t),this._userSize=void 0,this.halo=null,this.horizontalAlignment="center",this.lineHeight=1,this.material=null,this.background=null,this.text=null,this.type="text",this.verticalAlignment="baseline"}get font(){return this._get("font")||null}set font(t){t!=null&&this._userSize!=null&&(t.size=this._userSize),this._set("font",t)}writeFont(t,e,i,s){const n={...s,textSymbol3D:!0};e.font=t.write({},n),delete e.font.size}get size(){var t;return this._userSize!=null?this._userSize:((t=this.font)==null?void 0:t.size)!=null?this.font.size:9}set size(t){this._userSize=t,this.font!=null&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){const t=new ZR({enabled:this.enabled,font:this.font&&be(this.font),halo:this.halo&&be(this.halo),horizontalAlignment:this.horizontalAlignment,lineHeight:this.lineHeight,material:this.material!=null?this.material.clone():null,text:this.text,verticalAlignment:this.verticalAlignment,background:be(this.background)});return t._userSize=this._userSize,t}static fromTextSymbol(t){return new ZR({font:t.font!=null?t.font.clone():new jF,halo:oRe(t.haloColor,t.haloSize),horizontalAlignment:t.horizontalAlignment,lineHeight:t.lineHeight,material:t.color?new oc({color:t.color.clone()}):null,text:t.text,verticalAlignment:t.verticalAlignment,background:t.backgroundColor?new qT({color:t.backgroundColor.clone()}):null})}};function oRe(t,e){return t&&e!=null&&e>0?new lw({color:be(t),size:e}):null}y([S({type:jF,json:{write:!0}})],Jl.prototype,"font",null),y([yt("font")],Jl.prototype,"writeFont",null),y([S({type:lw,json:{write:!0}})],Jl.prototype,"halo",void 0),y([S({...Eme,json:{default:"center",write:!0}})],Jl.prototype,"horizontalAlignment",void 0),y([S({...Sme,json:{default:1,write:!0}})],Jl.prototype,"lineHeight",void 0),y([S({type:oc,json:{write:!0}})],Jl.prototype,"material",void 0),y([S({type:qT,json:{write:!0}})],Jl.prototype,"background",void 0),y([S($m)],Jl.prototype,"size",null),y([S({type:String,json:{write:!0}})],Jl.prototype,"text",void 0),y([ai({Text:"text"},{readOnly:!0})],Jl.prototype,"type",void 0),y([S({...Cme,json:{default:"baseline",write:!0}})],Jl.prototype,"verticalAlignment",void 0),Jl=ZR=y([se("esri.symbols.TextSymbol3DLayer")],Jl);const XS=Jl;var Y6;let a_=Y6=class extends jm{constructor(t){super(t),this.color=X6.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new Y6({color:be(this.color),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}};y([S({type:Gt,nonNullable:!0,json:{type:[zs],write:(t,e,i)=>e[i]=t.toArray(Gt.AlphaMode.UNLESS_OPAQUE),default:()=>X6.clone(),defaultEquals:t=>t.toCss(!0)===X6.toCss(!0)}})],a_.prototype,"color",void 0),y([ai({Water:"water"},{readOnly:!0})],a_.prototype,"type",void 0),y([S({type:["small","medium","large"],json:{write:!0,default:"medium"}})],a_.prototype,"waterbodySize",void 0),y([S({type:Number,json:{write:!0,default:null}})],a_.prototype,"waveDirection",void 0),y([S({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],a_.prototype,"waveStrength",void 0),a_=Y6=y([se("esri.symbols.WaterSymbol3DLayer")],a_);const Tme=a_,X6=new Gt([0,119,190]);var W6;let Y0=W6=class extends ei{constructor(t){super(t),this.name=null,this.styleUrl=null,this.styleName=null,this.portal=null}clone(){return new W6({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};y([S({type:String})],Y0.prototype,"name",void 0),y([S({type:String})],Y0.prototype,"styleUrl",void 0),y([S({type:String})],Y0.prototype,"styleName",void 0),y([S({type:Cu})],Y0.prototype,"portal",void 0),Y0=W6=y([se("esri.symbols.support.StyleOrigin")],Y0);const Z6=Y0;var K6;let HT=K6=class extends ei{constructor(){super(...arguments),this.url=""}clone(){return new K6({url:this.url})}};y([S({type:String})],HT.prototype,"url",void 0),HT=K6=y([se("esri.symbols.support.Thumbnail")],HT);const Pme={icon:kv,object:x7,line:YS,path:b7,fill:z1,extrude:pme,text:XS,water:Tme},aRe=Nt.ofType({base:jm,key:"type",typeMap:Pme,errorContext:"symbol-layer"});let Jd=class extends Oa{constructor(e){super(e),this.styleOrigin=null,this.thumbnail=null,this.type=null;const i=this.__accessor__&&this.__accessor__.metadata&&this.__accessor__.metadata.symbolLayers,s=i==null?void 0:i.type,n=s||Nt;this._set("symbolLayers",new n)}get color(){return null}set color(e){this.constructed&&ht.getLogger(this).error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(e){Of(e,this._get("symbolLayers"))}readStyleOrigin(e,i,s){if(e.styleUrl&&e.name){const n=US(e.styleUrl,s);return new Z6({styleUrl:n,name:e.name})}if(e.styleName&&e.name)return new Z6({portal:(s==null?void 0:s.portal)||Cu.getDefault(),styleName:e.styleName,name:e.name});s!=null&&s.messages&&s.messages.push(new ih("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:s,definition:e}))}writeStyleOrigin(e,i,s,n){if(e.styleUrl&&e.name){let r=zM(e.styleUrl,n);uc(r)&&(r=hd(r)),i.styleOrigin={styleUrl:r,name:e.name}}else e.styleName&&e.name&&(e.portal&&(n!=null&&n.portal)&&!tce(e.portal.restUrl,n.portal.restUrl)?n!=null&&n.messages&&n.messages.push(new ih("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):i.styleOrigin={styleName:e.styleName,name:e.name})}normalizeCtorArgs(e){return e instanceof jm||e&&Pme[e.type]?{symbolLayers:[e]}:Array.isArray(e)?{symbolLayers:e}:e}};y([S({json:{read:!1,write:!1}})],Jd.prototype,"color",null),y([S({type:aRe,nonNullable:!0,json:{write:!0}}),Ls(sme)],Jd.prototype,"symbolLayers",null),y([S({type:Z6})],Jd.prototype,"styleOrigin",void 0),y([mt("styleOrigin")],Jd.prototype,"readStyleOrigin",null),y([yt("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],Jd.prototype,"writeStyleOrigin",null),y([S({type:HT,json:{read:!1}})],Jd.prototype,"thumbnail",void 0),y([S({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],Jd.prototype,"type",void 0),Jd=y([se("esri.symbols.Symbol3D")],Jd);const nA=Jd;let OC=class extends it{constructor(e){super(e),this.visible=!0}clone(){throw new Error("Subclasses of Callout3D should implement their own clone method.")}};y([S({type:["line"],constructOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,isRequired:!0}}})],OC.prototype,"type",void 0),y([S({readOnly:!0})],OC.prototype,"visible",void 0),OC=y([se("esri.symbols.callouts.Callout3D")],OC);const Mme=OC;var Q6;let KR=Q6=class extends it{constructor(t){super(t),this.color=new Gt("white")}clone(){return new Q6({color:be(this.color)})}};y([S(Ly({colorRequiredOnWrite:!0}))],KR.prototype,"color",void 0),KR=Q6=y([se("esri.symbols.callouts.LineCallout3DBorder")],KR);const lRe=KR;var J6;let l_=J6=class extends Mme{constructor(t){super(t),this.type="line",this.color=new Gt([0,0,0,1]),this.size=rh(1),this.border=null}get visible(){return this.size>0&&this.color!=null&&this.color.a>0}clone(){return new J6({color:be(this.color),size:this.size,border:be(this.border)})}};y([ai({line:"line"})],l_.prototype,"type",void 0),y([S(Ly({colorRequiredOnWrite:!0}))],l_.prototype,"color",void 0),y([S({...$m,json:{write:{isRequired:!0}}})],l_.prototype,"size",void 0),y([S({type:lRe,json:{write:!0}})],l_.prototype,"border",void 0),y([S({readOnly:!0})],l_.prototype,"visible",null),l_=J6=y([se("esri.symbols.callouts.LineCallout3D")],l_);const Ame=l_;function w7(t){if(!t)return!1;const e=t.verticalOffset;return!(!e||e.screenLength<=0||e.maxWorldLength!=null&&e.maxWorldLength<=0)}function Ime(t){if(!t||!t.supportsCallout||!t.supportsCallout())return!1;const e=t.callout;return!!(e!=null&&e.visible)&&!!w7(t)}function dyt(t){return t.type==="point-3d"||t.type==="label-3d"}function myt(t){return t.horizontalAlignment==="center"}const Dme={types:{key:"type",base:Mme,typeMap:{line:Ame}},json:{write:!0}};var eG;let Eb=eG=class extends it{constructor(t){super(t),this.screenLength=0,this.minWorldLength=0,this.maxWorldLength=null}clone(){return new eG({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};y([S({...$m,json:{write:{isRequired:!0}}})],Eb.prototype,"screenLength",void 0),y([S({type:Number,nonNullable:!0,json:{write:!0,default:0}})],Eb.prototype,"minWorldLength",void 0),y([S({type:Number,json:{write:!0}})],Eb.prototype,"maxWorldLength",void 0),Eb=eG=y([se("esri.symbols.support.Symbol3DVerticalOffset")],Eb);const S7=Eb;var QR;const Nme=Nt.ofType({base:null,key:"type",typeMap:{text:XS}});let u_=QR=class extends nA{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new Nme,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return Ime(this)}hasVisibleVerticalOffset(){return w7(this)}clone(){return new QR({styleOrigin:be(this.styleOrigin),symbolLayers:be(this.symbolLayers),thumbnail:be(this.thumbnail),callout:be(this.callout),verticalOffset:be(this.verticalOffset)})}static fromTextSymbol(t){return new QR({symbolLayers:new Nt([XS.fromTextSymbol(t)])})}};y([S({type:S7,json:{write:!0}})],u_.prototype,"verticalOffset",void 0),y([S(Dme)],u_.prototype,"callout",void 0),y([S({json:{read:!1,write:!1}})],u_.prototype,"styleOrigin",void 0),y([S({type:Nme})],u_.prototype,"symbolLayers",void 0),y([ai({LabelSymbol3D:"label-3d"},{readOnly:!0})],u_.prototype,"type",void 0),u_=QR=y([se("esri.symbols.LabelSymbol3D")],u_);const YF=u_;var JR;const Rme=Nt.ofType({base:null,key:"type",typeMap:{line:YS,path:b7}}),uRe=Nt.ofType({base:null,key:"type",typeMap:{line:YS,path:b7}});let LC=JR=class extends nA{constructor(t){super(t),this.symbolLayers=new Rme,this.type="line-3d"}clone(){return new JR({styleOrigin:be(this.styleOrigin),symbolLayers:be(this.symbolLayers),thumbnail:be(this.thumbnail)})}static fromSimpleLineSymbol(t){return new JR({symbolLayers:new Nt([YS.fromSimpleLineSymbol(t)])})}};y([S({type:Rme,json:{type:uRe}})],LC.prototype,"symbolLayers",void 0),y([ai({LineSymbol3D:"line-3d"},{readOnly:!0})],LC.prototype,"type",void 0),LC=JR=y([se("esri.symbols.LineSymbol3D")],LC);const G1=LC;var e3;const Ome=Nt.ofType({base:null,key:"type",typeMap:{fill:z1}});let FC=e3=class extends nA{constructor(t){super(t),this.symbolLayers=new Ome,this.type="mesh-3d"}clone(){return new e3({styleOrigin:be(this.styleOrigin),symbolLayers:be(this.symbolLayers),thumbnail:be(this.thumbnail)})}static fromSimpleFillSymbol(t){return new e3({symbolLayers:new Nt([z1.fromSimpleFillSymbol(t)])})}};y([S({type:Ome})],FC.prototype,"symbolLayers",void 0),y([ai({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],FC.prototype,"type",void 0),FC=e3=y([se("esri.symbols.MeshSymbol3D")],FC);const rA=FC;let kC=class extends Oa{constructor(e){super(e),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};y([ai({esriSLS:"simple-line"},{readOnly:!0})],kC.prototype,"type",void 0),y([S({type:Number,cast:Ps,json:{write:!0}})],kC.prototype,"width",void 0),kC=y([se("esri.symbols.LineSymbol")],kC);const cRe=kC;var tG;let em=tG=class extends it{constructor(t){super(t),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(t,e,i,s){e[i]=(s==null?void 0:s.origin)==="web-map"?"arrow":t}set color(t){this._set("color",t)}readColor(t){return(t==null?void 0:t[0])!=null?[t[0],t[1],t[2],t[3]/255]:t}writeColor(t,e,i,s){(s==null?void 0:s.origin)==="web-map"||(e[i]=t)}clone(){return new tG({color:be(this.color),placement:this.placement,style:this.style})}hash(){var t;return`${this.placement}.${(t=this.color)==null?void 0:t.hash()}.${this.style}`}};y([S({type:["begin","end","begin-end"],json:{write:!0}})],em.prototype,"placement",void 0),y([ai({"line-marker":"line-marker"},{readOnly:!0}),S({json:{origins:{"web-map":{write:!1}}}})],em.prototype,"type",void 0),y([S({type:wme})],em.prototype,"style",void 0),y([yt("style")],em.prototype,"writeStyle",null),y([S({type:Gt,value:null,json:{write:{allowNull:!0}}})],em.prototype,"color",null),y([mt("color")],em.prototype,"readColor",null),y([yt("color")],em.prototype,"writeColor",null),em=tG=y([se("esri.symbols.LineSymbolMarker")],em);const hRe=em;var iG;const EU=new gs({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let Up=iG=class extends cRe{constructor(...t){super(...t),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(t,e,i,s,n,r){if(t&&typeof t!="string")return t;const o={};return t!=null&&(o.style=t),e!=null&&(o.color=e),i!=null&&(o.width=Ps(i)),s!=null&&(o.cap=s),n!=null&&(o.join=n),r!=null&&(o.miterLimit=Ps(r)),o}clone(){var t;return new iG({color:be(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:(t=this.marker)==null?void 0:t.clone()})}hash(){var t,e;return`${super.hash()}.${(t=this.color)==null?void 0:t.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${(e=this.marker)==null?void 0:e.hash()}`}};y([ai({esriSLS:"simple-line"},{readOnly:!0})],Up.prototype,"type",void 0),y([S({type:EU.apiValues,json:{read:EU.read,write:EU.write}})],Up.prototype,"style",void 0),y([S({type:["butt","round","square"],json:{write:{overridePolicy:(t,e,i)=>({enabled:t!=="round"&&(i==null?void 0:i.origin)==null})}}})],Up.prototype,"cap",void 0),y([S({type:["miter","round","bevel"],json:{write:{overridePolicy:(t,e,i)=>({enabled:t!=="round"&&(i==null?void 0:i.origin)==null})}}})],Up.prototype,"join",void 0),y([S({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":hRe}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],Up.prototype,"marker",void 0),y([S({type:Number,json:{read:!1,write:!1}})],Up.prototype,"miterLimit",void 0),Up=iG=y([se("esri.symbols.SimpleLineSymbol")],Up);const Tu=Up;let $C=class extends Oa{constructor(e){super(e),this.outline=null,this.type=null}hash(){var e;return`${this.type}.${(e=this.outline)==null?void 0:e.hash()}`}};y([S({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Tu}},json:{default:null,write:!0}})],$C.prototype,"outline",void 0),y([S({type:["simple-fill","picture-fill"],readOnly:!0})],$C.prototype,"type",void 0),$C=y([se("esri.symbols.FillSymbol")],$C);const Lme=$C;function dRe(t,e,i){return e.imageData?ice({mediaType:e.contentType||"image/png",isBase64:!0,data:e.imageData}):Fme(e.url,i)}function Fme(t,e){if(!uc(t)){const i=pRe(e);if(i)return Kw(i,"images",t)}return US(t,e)}function mRe(t,e,i,s){if(k1(t)){const n=Qw(t);if(!n)return;e.contentType=n.mediaType,e.imageData=n.data,i&&i.imageData===e.imageData&&i.url&&o1(i.url,e,"url",s)}else o1(t,e,"url",s)}const kme={json:{read:{source:["imageData","url"],reader:dRe},write:{writer(t,e,i,s){mRe(t,e,this.source,s)}}}},$me={readOnly:!0,json:{read:{source:["imageData","url"],reader(t,e,i){const s={};return e.imageData&&(s.imageData=e.imageData),e.contentType&&(s.contentType=e.contentType),e.url&&(s.url=Fme(e.url,i)),s}}}};function pRe(t){var n,r;if(!t)return null;const{origin:e,layer:i}=t;if(e!=="service"&&e!=="portal-item")return null;const s=i==null?void 0:i.type;return s==="feature"||s==="stream"?(n=i.parsedUrl)==null?void 0:n.path:s==="map-image"||s==="tile"?(r=t.url)==null?void 0:r.path:null}var sG;let Nc=sG=class extends Lme{constructor(...t){super(...t),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(t,e,i,s){if(t&&typeof t!="string"&&t.imageData==null)return t;const n={};return t&&(n.url=t),e&&(n.outline=e),i!=null&&(n.width=Ps(i)),s!=null&&(n.height=Ps(s)),n}clone(){const t=new sG({color:be(this.color),height:this.height,outline:be(this.outline),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return t._set("source",be(this.source)),t}hash(){var t;return`${super.hash()}.${(t=this.color)==null?void 0:t.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};y([ai({esriPFS:"picture-fill"},{readOnly:!0})],Nc.prototype,"type",void 0),y([S(kme)],Nc.prototype,"url",void 0),y([S({type:Number,json:{write:!0}})],Nc.prototype,"xscale",void 0),y([S({type:Number,json:{write:!0}})],Nc.prototype,"yscale",void 0),y([S({type:Number,cast:Ps,json:{write:!0}})],Nc.prototype,"width",void 0),y([S({type:Number,cast:Ps,json:{write:!0}})],Nc.prototype,"height",void 0),y([S({type:Number,cast:Ps,json:{write:!0}})],Nc.prototype,"xoffset",void 0),y([S({type:Number,cast:Ps,json:{write:!0}})],Nc.prototype,"yoffset",void 0),y([S($me)],Nc.prototype,"source",void 0),Nc=sG=y([se("esri.symbols.PictureFillSymbol")],Nc);const E7=Nc;let c_=class extends Oa{constructor(e){super(e),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};y([S({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],c_.prototype,"angle",void 0),y([S({type:["simple-marker","picture-marker"],readOnly:!0})],c_.prototype,"type",void 0),y([S({type:Number,cast:Ps,json:{write:!0}})],c_.prototype,"xoffset",void 0),y([S({type:Number,cast:Ps,json:{write:!0}})],c_.prototype,"yoffset",void 0),y([S({cast:t=>t==="auto"?t:Al(Ps(t)),json:{write:!0}})],c_.prototype,"size",void 0),c_=y([se("esri.symbols.MarkerSymbol")],c_);const Ume=c_;var nG;let Uh=nG=class extends Ume{constructor(...t){super(...t),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(t,e,i){if(t&&typeof t!="string"&&t.imageData==null)return t;const s={};return t&&(s.url=t),e!=null&&(s.width=Ps(e)),i!=null&&(s.height=Ps(i)),s}readHeight(t,e){return e.size||t}readWidth(t,e){return e.size||t}clone(){const t=new nG({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return t._set("source",be(this.source)),t}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};y([S({json:{write:!1}})],Uh.prototype,"color",void 0),y([ai({esriPMS:"picture-marker"},{readOnly:!0})],Uh.prototype,"type",void 0),y([S(kme)],Uh.prototype,"url",void 0),y([S($me)],Uh.prototype,"source",void 0),y([S({type:Number,cast:Ps,json:{write:!0}})],Uh.prototype,"height",void 0),y([mt("height",["height","size"])],Uh.prototype,"readHeight",null),y([S({type:Number,cast:Ps,json:{write:!0}})],Uh.prototype,"width",void 0),y([S({json:{write:!1}})],Uh.prototype,"size",void 0),Uh=nG=y([se("esri.symbols.PictureMarkerSymbol")],Uh);const oA=Uh;var X0;const Vme=Nt.ofType({base:null,key:"type",typeMap:{icon:kv,object:x7,text:XS}});let W0=X0=class extends nA{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.symbolLayers=new Vme,this.type="point-3d"}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const t of this.symbolLayers.items)switch(t.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return Ime(this)}hasVisibleVerticalOffset(){return w7(this)}clone(){return new X0({verticalOffset:be(this.verticalOffset),callout:be(this.callout),styleOrigin:be(this.styleOrigin),symbolLayers:be(this.symbolLayers),thumbnail:be(this.thumbnail)})}static fromSimpleMarkerSymbol(t){return new X0({symbolLayers:new Nt([kv.fromSimpleMarkerSymbol(t)])})}static fromPictureMarkerSymbol(t){return new X0({symbolLayers:new Nt([kv.fromPictureMarkerSymbol(t)])})}static fromCIMSymbol(t){var s,n;if(((n=(s=t.data)==null?void 0:s.symbol)==null?void 0:n.type)!=="CIMPointSymbol")return null;const i=t.data.symbol;return new X0(i!=null&&i.callout?{symbolLayers:new Nt([kv.fromCIMSymbol(t)]),callout:new Ame({size:.5,color:new Gt([0,0,0])}),verticalOffset:new S7({screenLength:40})}:{symbolLayers:new Nt([kv.fromCIMSymbol(t)])})}static fromTextSymbol(t){return new X0({symbolLayers:new Nt([XS.fromTextSymbol(t)])})}};y([S({type:S7,json:{write:!0}})],W0.prototype,"verticalOffset",void 0),y([S(Dme)],W0.prototype,"callout",void 0),y([S({type:Vme,json:{origins:{"web-scene":{write:!0}}}})],W0.prototype,"symbolLayers",void 0),y([ai({PointSymbol3D:"point-3d"},{readOnly:!0})],W0.prototype,"type",void 0),W0=X0=y([se("esri.symbols.PointSymbol3D")],W0);const vf=W0;var UC;const zme=Nt.ofType({base:null,key:"type",typeMap:{extrude:pme,fill:z1,icon:kv,line:YS,object:x7,text:XS,water:Tme}});let VC=UC=class extends nA{constructor(t){super(t),this.symbolLayers=new zme,this.type="polygon-3d"}initialize(){const t=e=>{e.type==="line"&&yP(ht.getLogger(this),"LineSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use FillSymbol3DLayer.outline instead.",version:"4.28"}),e.type==="text"&&yP(ht.getLogger(this),"TextSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use Labels instead.",version:"4.28"})};for(const e of this.symbolLayers)t(e);this.addHandles(yy(()=>this.symbolLayers,"after-add",({item:e})=>t(e),km))}clone(){return new UC({styleOrigin:be(this.styleOrigin),symbolLayers:be(this.symbolLayers),thumbnail:be(this.thumbnail)})}static fromJSON(t){var i;const e=new UC;if(e.read(t),e.symbolLayers.length===2&&e.symbolLayers.at(0).type==="fill"&&e.symbolLayers.at(1).type==="line"){const s=e.symbolLayers.at(0),n=e.symbolLayers.at(1);!n.enabled||(i=t.symbolLayers)!=null&&i[1]&&t.symbolLayers[1].enable===!1||(s.outline={size:n.size,color:n.material!=null?n.material.color:null}),e.symbolLayers.removeAt(1)}return e}static fromSimpleFillSymbol(t){return new UC({symbolLayers:new Nt([z1.fromSimpleFillSymbol(t)])})}};y([S({type:zme,json:{write:!0}})],VC.prototype,"symbolLayers",void 0),y([ai({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],VC.prototype,"type",void 0),VC=UC=y([se("esri.symbols.PolygonSymbol3D")],VC);const ky=VC;var rG;const CU=new gs({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let Z0=rG=class extends Lme{constructor(...t){super(...t),this.color=new Gt([0,0,0,.25]),this.outline=new Tu,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(t,e,i){if(t&&typeof t!="string")return t;const s={};return t&&(s.style=t),e&&(s.outline=e),i&&(s.color=i),s}clone(){return new rG({color:be(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};y([S()],Z0.prototype,"color",void 0),y([S()],Z0.prototype,"outline",void 0),y([ai({esriSFS:"simple-fill"},{readOnly:!0})],Z0.prototype,"type",void 0),y([S({type:CU.apiValues,json:{read:CU.read,write:CU.write}})],Z0.prototype,"style",void 0),Z0=rG=y([se("esri.symbols.SimpleFillSymbol")],Z0);const bd=Z0;var oG;const TU=new gs({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let tm=oG=class extends Ume{constructor(...t){super(...t),this.color=new Gt([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new Tu}normalizeCtorArgs(t,e,i,s){if(t&&typeof t!="string")return t;const n={};return t&&(n.style=t),e!=null&&(n.size=Ps(e)),i&&(n.outline=i),s&&(n.color=s),n}writeColor(t,e){t&&this.style!=="x"&&this.style!=="cross"&&(e.color=t.toJSON()),t===null&&(e.color=null)}set path(t){this.style="path",this._set("path",t)}clone(){return new oG({angle:this.angle,color:be(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){var t;return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${(t=this.outline)==null?void 0:t.hash()}`}};y([S()],tm.prototype,"color",void 0),y([yt("color")],tm.prototype,"writeColor",null),y([ai({esriSMS:"simple-marker"},{readOnly:!0})],tm.prototype,"type",void 0),y([S()],tm.prototype,"size",void 0),y([S({type:TU.apiValues,json:{read:TU.read,write:TU.write}})],tm.prototype,"style",void 0),y([S({type:String,json:{write:!0}})],tm.prototype,"path",null),y([S({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Tu}},json:{default:null,write:!0}})],tm.prototype,"outline",void 0),tm=oG=y([se("esri.symbols.SimpleMarkerSymbol")],tm);const _u=tm;var aG;let Wn=aG=class extends Oa{constructor(...t){super(...t),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new jF,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment="baseline",this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(t,e,i){if(t&&typeof t!="string")return t;const s={};return t&&(s.text=t),e&&(s.font=e),i&&(s.color=i),s}writeLineWidth(t,e,i,s){s&&typeof s!="string"?s.origin:e[i]=t}castLineWidth(t){return Ps(t)}writeLineHeight(t,e,i,s){s&&typeof s!="string"?s.origin:e[i]=t}clone(){return new aG({angle:this.angle,backgroundColor:be(this.backgroundColor),borderLineColor:be(this.borderLineColor),borderLineSize:this.borderLineSize,color:be(this.color),font:this.font&&this.font.clone(),haloColor:be(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){var t,e,i;return`${(t=this.backgroundColor)==null?void 0:t.hash()}.${this.borderLineColor}.${this.borderLineSize}.${(e=this.color)==null?void 0:e.hash()}.${this.font&&this.font.hash()}.${(i=this.haloColor)==null?void 0:i.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};y([S({type:Gt,json:{write:!0}})],Wn.prototype,"backgroundColor",void 0),y([S({type:Gt,json:{write:!0}})],Wn.prototype,"borderLineColor",void 0),y([S({type:Number,json:{write:!0},cast:Ps})],Wn.prototype,"borderLineSize",void 0),y([S({type:jF,json:{write:!0}})],Wn.prototype,"font",void 0),y([S({...Eme,json:{write:!0}})],Wn.prototype,"horizontalAlignment",void 0),y([S({type:Boolean,json:{write:!0}})],Wn.prototype,"kerning",void 0),y([S({type:Gt,json:{write:!0}})],Wn.prototype,"haloColor",void 0),y([S({type:Number,cast:Ps,json:{write:!0}})],Wn.prototype,"haloSize",void 0),y([S({type:Boolean,json:{write:!0}})],Wn.prototype,"rightToLeft",void 0),y([S({type:Boolean,json:{write:!0}})],Wn.prototype,"rotated",void 0),y([S({type:String,json:{write:!0}})],Wn.prototype,"text",void 0),y([ai({esriTS:"text"},{readOnly:!0})],Wn.prototype,"type",void 0),y([S({...Cme,json:{write:!0}})],Wn.prototype,"verticalAlignment",void 0),y([S({type:Number,cast:Ps,json:{write:!0}})],Wn.prototype,"xoffset",void 0),y([S({type:Number,cast:Ps,json:{write:!0}})],Wn.prototype,"yoffset",void 0),y([S({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],Wn.prototype,"angle",void 0),y([S({type:Number,json:{write:!0}})],Wn.prototype,"width",void 0),y([S({type:Number})],Wn.prototype,"lineWidth",void 0),y([yt("lineWidth")],Wn.prototype,"writeLineWidth",null),y([Ls("lineWidth")],Wn.prototype,"castLineWidth",null),y([S(Sme)],Wn.prototype,"lineHeight",void 0),y([yt("lineHeight")],Wn.prototype,"writeLineHeight",null),Wn=aG=y([se("esri.symbols.TextSymbol")],Wn);const WS=Wn;var lG;let Vh=lG=class extends Oa{constructor(t){super(t),this.color=null,this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}get _fetchCacheKey(){const t=this.portal!=null?this.portal:Cu.getDefault(),e=t.user?t.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${e}:${t.url}`}read(t,e){this.portal=e==null?void 0:e.portal,super.read(t,e)}clone(){return new lG({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(t){const e=t&&"acceptedFormats"in t?t.acceptedFormats:["web"];return this._fetchSymbol({...t,acceptedFormats:e})}async fetchCIMSymbol(t){const e=await this.fetchSymbol({...t,acceptedFormats:["cim"]});if((e==null?void 0:e.type)!=="cim")throw new Se("webstylesymbol:fetchCIMSymbol","Resolved web style symbol is not of type 'cim'");return e}async _fetchSymbol(t){const e=t!=null?t.cache:null,i=e?this._fetchCacheKey:null;if(e!=null){const o=i&&e.get(i);if(o)return o.clone()}const{resolveWebStyleSymbol:s}=await _e(()=>import("./webStyleSymbolUtils-dlSXqXJ_.js"),__vite__mapDeps([23,24,25]));vr(t);const n=s(this,{portal:this.portal},t);n.catch(o=>{ht.getLogger(this).error("#fetchSymbol()","Failed to create symbol from style",o)});const r=await n;return e!=null&&e.set(i,r.clone()),r}};y([S({json:{write:!1}})],Vh.prototype,"color",void 0),y([S({type:String,json:{write:!0}})],Vh.prototype,"styleName",void 0),y([S({type:Cu,json:{write:!1}})],Vh.prototype,"portal",void 0),y([S({type:String,json:{read:TH,write:o1}})],Vh.prototype,"styleUrl",void 0),y([S({type:HT,json:{read:!1}})],Vh.prototype,"thumbnail",void 0),y([S({type:String,json:{write:!0}})],Vh.prototype,"name",void 0),y([ai({styleSymbolReference:"web-style"},{readOnly:!0})],Vh.prototype,"type",void 0),y([S()],Vh.prototype,"_fetchCacheKey",null),Vh=lG=y([se("esri.symbols.WebStyleSymbol")],Vh);const vy=Vh;function _yt(t){if(!t)return!1;switch(t.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function Gme(t){switch(t==null?void 0:t.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const X_={base:Oa,key:"type",typeMap:{"simple-fill":bd,"picture-fill":E7,"picture-marker":oA,"simple-line":Tu,"simple-marker":_u,text:WS,"label-3d":YF,"line-3d":G1,"mesh-3d":rA,"point-3d":vf,"polygon-3d":ky,"web-style":vy,cim:Oy},errorContext:"symbol"},yyt={base:Oa,key:"type",typeMap:{"picture-marker":oA,"simple-marker":_u,"point-3d":vf,cim:Oy},errorContext:"symbol"},vyt={base:Oa,key:"type",typeMap:{"simple-line":Tu,"line-3d":G1,cim:Oy},errorContext:"symbol"},xyt={base:Oa,key:"type",typeMap:{"simple-fill":bd,"picture-fill":E7,"polygon-3d":ky,cim:Oy},errorContext:"symbol"},fRe={base:Oa,key:"type",typeMap:{"picture-marker":oA,"simple-marker":_u,text:WS,"web-style":vy,cim:Oy},errorContext:"symbol"},gRe=LS({types:X_}),Bme={base:Oa,key:"type",typeMap:{"simple-fill":bd,"picture-fill":E7,"picture-marker":oA,"simple-line":Tu,"simple-marker":_u,text:WS,"line-3d":G1,"mesh-3d":rA,"point-3d":vf,"polygon-3d":ky,"web-style":vy,cim:Oy},errorContext:"symbol"},_Re={base:Oa,key:"type",typeMap:{text:WS,"label-3d":YF},errorContext:"symbol"},HQ={base:Oa,key:"type",typeMap:{"line-3d":G1,"mesh-3d":rA,"point-3d":vf,"polygon-3d":ky,"web-style":vy,cim:Oy},errorContext:"symbol"},yRe={base:Oa,key:"type",typeMap:{"label-3d":YF},errorContext:"symbol"},qme=_d(X_);var uG;function vRe(t){if(!t)return null;const e={};for(const i in t){const s=f1(t[i]);s&&(e[i]=s)}return Object.keys(e).length!==0?e:null}function xRe(t){if(t==null)return null;const e={};for(const i in t){const s=t[i];s&&(e[i]=s.toJSON())}return Object.keys(e).length!==0?e:null}let eu=uG=class extends bs.ClonableMixin(it){constructor(t){super(t),this.isAggregate=!1,this.layer=null,this.origin=null,this.popupTemplate=null,this.sourceLayer=null,this._version=0,Object.defineProperty(this,"uid",{value:SR(),configurable:!0}),Object.defineProperty(this,"_lastMeshTransform",{value:{},configurable:!0,writable:!0,enumerable:!1}),arguments.length>1&&h2e(ht.getLogger(this),"Graphic",{version:"4.30"})}initialize(){this._watchMeshGeometryChanges()}set aggregateGeometries(t){const e=this._get("aggregateGeometries");JSON.stringify(e)!==JSON.stringify(t)&&this._set("aggregateGeometries",t)}set attributes(t){const e=this._get("attributes");e!==t&&(this._set("attributes",t),this._notifyLayer("attributes",e,t))}set geometry(t){const e=this._get("geometry");e!==t&&(this._set("geometry",t),(t==null?void 0:t.type)!=="mesh"&&this._notifyLayer("geometry",e,t))}set symbol(t){const e=this._get("symbol");e!==t&&(this._set("symbol",t),this._notifyLayer("symbol",e,t))}get version(){return this._version}set visible(t){const e=this._get("visible");e!==t&&(this._set("visible",t),this._notifyLayer("visible",e,t))}cloneShallow(){return new uG({aggregateGeometries:this.aggregateGeometries,attributes:this.attributes,geometry:this.geometry,isAggregate:this.isAggregate,layer:this.layer,popupTemplate:this.popupTemplate,sourceLayer:this.sourceLayer,symbol:this.symbol,visible:this.visible,origin:this.origin})}getEffectivePopupTemplate(t=!1){if(this.popupTemplate)return this.popupTemplate;const e=this.origin&&"layer"in this.origin?this.origin.layer:null;for(const i of[e,this.sourceLayer,this.layer])if(i){if("popupTemplate"in i&&i.popupTemplate)return i.popupTemplate;if(t&&"defaultPopupTemplate"in i&&i.defaultPopupTemplate!=null)return i.defaultPopupTemplate}return null}getAttribute(t){var e;return(e=this.attributes)==null?void 0:e[t]}setAttribute(t,e){if(this.attributes){const i=this.getAttribute(t);this.attributes[t]=e,this._notifyLayer("attributes",i,e,t)}else this.attributes={[t]:e},this._notifyLayer("attributes",void 0,e,t)}getObjectId(){return this.sourceLayer&&"objectIdField"in this.sourceLayer&&this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null}toJSON(){var t;return{aggregateGeometries:xRe(this.aggregateGeometries),geometry:this.geometry!=null?this.geometry.toJSON():null,symbol:this.symbol!=null?this.symbol.toJSON():null,attributes:it.isSerializable(this.attributes)?this.attributes.toJSON():{...this.attributes},popupTemplate:((t=this.popupTemplate)==null?void 0:t.toJSON())??null}}notifyMeshTransformChanged(t={}){const{geometry:e}=this;if((e==null?void 0:e.type)==="mesh"){const i={origin:e.origin,transform:e.transform};this._notifyLayer("origin-transform",i,i,t.action)}}_notifyLayer(t,e,i,s){if(this._version++,!this.layer||!("graphicChanged"in this.layer))return;const n={graphic:this,property:t,oldValue:e,newValue:i};t==="origin-transform"&&(n.action=s),t==="attributes"&&(n.attributeName=s),this.layer.graphicChanged(n)}_watchMeshGeometryChanges(){this.addHandles([nh(()=>{var t,e;return((t=this.geometry)==null?void 0:t.type)==="mesh"&&this.geometry.vertexSpace.origin?{localMatrix:(e=this.geometry.transform)==null?void 0:e.localMatrix,origin:this.geometry.vertexSpace.origin}:void 0},({localMatrix:t,origin:e})=>{this._lastMeshTransform.localMatrix===t&&this._lastMeshTransform.origin===e||(this._lastMeshTransform.localMatrix=t,this._lastMeshTransform.origin=e,this.notifyMeshTransformChanged())}),nh(()=>{var t;return((t=this.geometry)==null?void 0:t.type)==="mesh"?{vertexAttributes:this.geometry.vertexAttributes}:void 0},()=>{var e;const t=this.geometry;(t==null?void 0:t.type)==="mesh"&&t.vertexSpace.origin?(this._lastMeshTransform.localMatrix=(e=t.transform)==null?void 0:e.localMatrix,this._lastMeshTransform.origin=t.vertexSpace.origin):(this._lastMeshTransform.localMatrix=void 0,this._lastMeshTransform.origin=void 0),this._notifyLayer("geometry",this.geometry,this.geometry)},{equals:(t,e)=>t===e,sync:!0})])}};y([S({value:null,json:{read:vRe}})],eu.prototype,"aggregateGeometries",null),y([S({value:null})],eu.prototype,"attributes",null),y([S({value:null,types:QM,json:{read:f1}})],eu.prototype,"geometry",null),y([S({type:Boolean})],eu.prototype,"isAggregate",void 0),y([S({clonable:"reference"})],eu.prototype,"layer",void 0),y([S({clonable:"reference"})],eu.prototype,"origin",void 0),y([S({type:HS})],eu.prototype,"popupTemplate",void 0),y([S({clonable:"reference"})],eu.prototype,"sourceLayer",void 0),y([S({value:null,types:X_})],eu.prototype,"symbol",null),y([S({clonable:!1,json:{read:!1,write:!1}})],eu.prototype,"_version",void 0),y([S({type:Boolean,value:!0})],eu.prototype,"visible",null),eu=uG=y([se("esri.Graphic")],eu);const Kr=eu;class W_{static redCircle(e=5){return new _u({style:"circle",size:e+"px",color:new Gt("#ff000088"),outline:{color:new Gt("#ff000088"),width:2}})}static blackCircle(e=5){return new _u({style:"circle",size:e+"px",color:new Gt("#00000088"),outline:{color:new Gt("#00000088"),width:2}})}static redSquare(e=5){return new _u({style:"square",size:e+"px",color:new Gt("#ff000055"),outline:{color:new Gt("#ff000055"),width:2}})}static redX(){return new _u({style:"x",size:"7px",color:new Gt("#ff000055")})}}const xf=Tu;class sy{static fillSymbol(){return new bd({color:new Gt("#ff000022"),outline:sy.lineSymbol()})}static lineSymbol(){return new xf({color:new Gt("#ff000055"),width:"2px",style:"short-dash"})}static thickLineSymbol(){return new xf({color:new Gt("#ff000088"),width:"6px",style:"solid"})}}class cG{static redDashes(){return new xf({color:"red",width:"2px",style:"long-dash"})}static greenDashes(){return new xf({color:"green",width:"1px",style:"long-dash"})}static redSolid(){return new xf({color:new Gt("#ff000099"),width:"2px",style:"solid"})}static blackSolid(){return new xf({color:new Gt("#000000cc"),width:"2px",style:"solid"})}}function bRe(t){switch(t){case 1:return"Unknown error";case 2:return"Corrupted geometry";case 3:return"Empty geometry";case 4:return"Math singularity";case 5:return"Buffer is too small";case 6:return"Invalid shape type";case 7:return"Projection out of supported range";case 8:return"Non simple geometry";case 9:return"Cannot calculate geodesic";case 10:return"Notation conversion";case 11:return"Missing grid file";case 12:return"Invalid call";case 13:return"Internal error";case 14:return"Not implemented";case 15:return"IO error";case 16:return"Invalid 3D";case 17:return"An ambiguous geography edge with antipodal points";case 18:return"Geocentric coordinates require ellipsoidal height";case 19:return"Geography cannot be projected into a gnomonic plane or a result of an operation cannot fit into a gnomonic plane";case 20:return"Geometry is too large to be exported in to a given format";case 22:return"Operation is canceled by the user";case 21:return"The operation, such as projection or geodetic computation, cannot be performed without pe-wasm loaded";default:return"unknown error"}}function z(t,e){try{if(!t)throw new Error(e)}catch(i){throw i}}let $y=class extends Error{constructor(e,i){super(i),this.m_AdditionalMessage=i,this.m_ErrorType=e,this.name="GeometryError"}what(){return bRe(this.m_ErrorType)}additionalMessage(){return this.m_AdditionalMessage?this.m_AdditionalMessage:""}code(){return this.m_ErrorType}},wRe=class extends $y{constructor(e){super(2,e),this.name="CorruptedGeometryError"}},SRe=class extends $y{constructor(e){super(3,e),this.name="EmptyGeometryError"}},ERe=class extends $y{constructor(e){super(4,e),this.name="MathSingularityError"}},CRe=class extends $y{constructor(e){super(21,e),this.name="ProjectionEngineNotLoadedError"}},TRe=class extends $y{constructor(e){super(8,e),this.name="NonSimpleGeometryError"}};var q;(function(t){t[t.enumUnknown=0]="enumUnknown",t[t.enumPoint=513]="enumPoint",t[t.enumLine=5122]="enumLine",t[t.enumBezier=5123]="enumBezier",t[t.enumEllipticArc=5124]="enumEllipticArc",t[t.enumEnvelope=3077]="enumEnvelope",t[t.enumMultiPoint=8710]="enumMultiPoint",t[t.enumPolyline=25607]="enumPolyline",t[t.enumPolygon=27656]="enumPolygon",t[t.enumMultipatch=40969]="enumMultipatch",t[t.enumGeometryCollection=3594]="enumGeometryCollection",t[t.enumRationalBezier2=5134]="enumRationalBezier2",t[t.enumBezier2=5135]="enumBezier2",t[t.enumRationalBezier23d=5392]="enumRationalBezier23d",t[t.enumGreatArc3d=5393]="enumGreatArc3d"})(q||(q={}));const PRe=[0,0,1,1,1,2,0,1,2,3,-1,-1,-1,-1,1,1];function Pl(t){return PRe[15&t]}function lS(t){return!!(512&t)}function MRe(t){return!!(1024&t)}function Pyt(t){return!!(2048&t)}function nr(t){return!!(4096&t)}function ll(t){return!!(8192&t)}function Ei(t){return!!(16384&t)}function C7(t){return!!(32768&t)}function DP(t){const e=t.getGeometryType();return ll(e)?t.getPointCount():t.isEmpty()?0:e===q.enumEnvelope?4:e===q.enumPoint?1:nr(e)?2:void We("missing type")}function Hme(t){const e=t.getGeometryType();if(Ei(e))return t.hasNonLinearSegments();if(e===q.enumGeometryCollection){const i=t;for(let s=0,n=i.getGeometryCount();s<n;s++)if(Hme(i.getGeometry(s)))return!0;return!1}return!!nr(e)&&e!==q.enumLine}function XF(t){throw new CRe(t)}function jme(t){throw new wRe(t)}function ce(t){throw new Error(t)}function hG(t){throw new ERe(t)}function ARe(){ce("Geometry type is not supported for 3D operations.")}function un(t){throw new $y(12,t)}function WF(t){throw new SRe(t)}function _i(t){throw new $y(14,t)}function bi(t){throw new Error(t)}function We(t){throw new $y(13,t)}function IRe(t){throw new Error(t)}function dG(t){throw new TRe(t)}function DRe(){_i("Operation does not support curves.")}function NP(t){t&&Hme(t)&&DRe()}function Um(t){t&&C7(t.getGeometryType())&&_i("Unsupported geometry type.")}function ZF(t){t===q.enumGeometryCollection&&ce("Geometry_collection instances are not supported in this operation")}function NRe(t){ZF(t.getGeometryType())}function mG(t){ce(`bad wkid: ${t}`)}function Yme(t){let e="bad wkt: ";e+=t,e+="...",ce(e)}function RP(t,e){t||ce(e)}let Wr=class Xme{constructor(e){this.sum=e,this.compensation=0}assign(e){return this.compensation=e.compensation,this.sum=e.sum,this}reset(){this.sum=this.compensation=0}resetToStart(e){this.sum=e,this.compensation=0}normalize(){const e=[Number.NaN];this.sum=YT(this.sum,this.compensation,e),this.compensation=e[0]}add(e){const i=this.sum+e;let s;if(Math.abs(this.sum)>=Math.abs(e)){const n=this.sum-i+e;s=this.compensation+n}else{const n=e-i+this.sum;s=this.compensation+n}this.sum=i,this.compensation=s}sub(e){this.add(-e)}addProduct(e,i){const s=[0],n=ZO(e,i,s);this.add(n),this.add(s[0])}mul(e){const i=new Xme(0);i.addProduct(this.sum,e),i.addProduct(this.compensation,e),this.assign(i)}getResult(){return this.sum+this.compensation}pe(e){return this.add(e),this}me(e){return this.add(-e),this}};const RRe=0x00000000ffffffffn,ORe=0x0000ffffn,LRe=0x000000ffn,FRe=0x0fn,kRe=0xffff0000n,$Re=0xff00n,URe=0xf0n,VRe=[5,1,2,1,3,1,2,1,4,1,2,1,3,1,2,1],zRe=[-1,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3];function pG(t){let e=0;return t&ORe||(e+=16,t>>=16n),t&LRe||(e+=8,t>>=8n),t&FRe||(e+=4,t>>=4n),e+VRe[Number(BigInt.asUintN(4,t))]}function GRe(t){let e=0;return t&kRe&&(e+=16,t>>=16n),t&$Re&&(e+=8,t>>=8n),t&URe&&(e+=4,t>>=4n),e+zRe[Number(BigInt.asUintN(4,t))]+1}function jQ(t){let e=0;return t&RRe||(e=32,t>>=32n),e+pG(BigInt.asUintN(32,t))}function BRe(t){let e=0;return 0xffffffff00000000n&t&&(e=32,t>>=32n),e+GRe(t)}let Me=class zC{constructor(e,i){if(this.m_EnvelopeType=1,e!==void 0){if(e instanceof zC)return this.vmin=e.vmin,void(this.vmax=e.vmax);this.vmin=e,this.vmax=i,this.normalize()}else this.setEmpty()}static construct(e,i){return new zC(e,i)}static constructEmpty(){return new zC}setCoords(e,i){this.vmin=e,this.vmax=i,this.normalize()}setCoordsFromEnvelope(e){this.vmin=e.vmin,this.vmax=e.vmax}setEmpty(){this.vmin=Number.NaN,this.vmax=Number.NaN}getCenter(){return .5*(this.vmin+this.vmax)}equalsRange(e,i){return Ma(this.vmin,e)&&Ma(this.vmax,i)}equals(e,i){return!(!this.isEmpty()||!e.isEmpty())||(i!==void 0?Math.abs(this.vmin-e.vmin)<=i&&Math.abs(this.vmax-e.vmax)<=i:this.vmin===e.vmin&&this.vmax===e.vmax)}width(){return this.vmax-this.vmin}isEmpty(){return Number.isNaN(this.vmin)||Number.isNaN(this.vmax)}isZero(){return this.vmin===this.vmax}setInfinite(){this.vmin=Number.NEGATIVE_INFINITY,this.vmax=Number.POSITIVE_INFINITY}move(e){this.isEmpty()||(this.vmin+=e,this.vmax+=e)}contains(e){return e.vmin>=this.vmin&&e.vmax<=this.vmax}containsCoordinate(e){return e>=this.vmin&&e<=this.vmax}containsRightExclusive(e){return e>=this.vmin&&e<this.vmax}containsExclusiveCoordinate(e){return e>this.vmin&&e<this.vmax}containsExclusive(e){return e.vmin>this.vmin&&e.vmax<this.vmax}isIntersecting(e){return this.vmin<=e.vmin?this.vmax>=e.vmin:e.vmax>=this.vmin}mergeCoordinate(e){if(this.isEmpty())return this.vmin=e,void(this.vmax=e);this.mergeNeCoordinate(e)}merge(e){if(e.isEmpty())return;const i=e.vmin,s=e.vmax;this.mergeCoordinate(i),this.mergeCoordinate(s)}mergeNe(e){const i=e.vmin,s=e.vmax;this.mergeNeCoordinate(i),this.mergeNeCoordinate(s)}mergeNeCoordinate(e){e<this.vmin?this.vmin=e:e>this.vmax&&(this.vmax=e)}intersect(e){this.isEmpty()||e.isEmpty()?this.setEmpty():(this.vmin<e.vmin&&(this.vmin=e.vmin),this.vmax>e.vmax&&(this.vmax=e.vmax),this.vmin>this.vmax&&this.setEmpty())}inflate(e){this.isEmpty()||(this.vmin-=e,this.vmax+=e,this.vmax<this.vmin&&this.setEmpty())}normalize(){this.vmin<=this.vmax||(this.vmin>this.vmax?this.vmax=Ge(this.vmin,this.vmin=this.vmax):this.setEmpty())}isValid(){return this.isEmpty()||this.vmin<=this.vmax}snapClip(e){return Os(e,this.vmin,this.vmax)}calculateToleranceFromEnvelope(){return this.isEmpty()?_1():(Math.abs(this.vmin)+Math.abs(this.vmax)+1)*_1()}static unit(){return qRe}normalizeNoNAN(){this.vmin>this.vmax&&(this.vmax=Ge(this.vmin,this.vmin=this.vmax))}setCoordsNoNAN(e,i){this.vmin=e,this.vmax=i,this.normalizeNoNAN()}clone(){return new zC(this.vmin,this.vmax)}};const qRe=new Me(0,1);let ge=class nn{static getNAN(){return new nn(Number.NaN)}constructor(e,i){this.m_value=e??0,this.m_eps=i??0}[Symbol.toPrimitive](e){return this}clone(){return new nn(this.m_value,this.m_eps)}assign(e){return this.m_value=e.m_value,this.m_eps=e.m_eps,this}scaleError(e){this.m_eps*=e}setError(e){this.m_eps=e}set(e,i){return this.m_value=e,this.m_eps=i??0,this}setWithEps(e,i){return i===void 0&&(i=1),this.m_value=e,this.m_eps=nn.ulp(e)*i,this}setE(e){return this.m_value=e.m_value,this.m_eps=e.m_eps,this}precise(){return new nn(this.m_value)}value(){return this.m_value}toDouble(){return this.m_value}eps(){return this.m_eps}resetError(){return this.m_eps=0,this}absThis(){return this.m_value=Math.abs(this.m_value),this}add(e){return this.clone().addThis(e)}addE(e){return this.clone().addThisE(e)}addThisE(e){const i=this.m_value+e.m_value,s=this.m_eps+e.m_eps+nn.ulp(i);return this.m_value=i,this.m_eps=s,this}addThis(e){const i=this.m_value+e,s=this.m_eps+nn.ulp(i);return this.m_value=i,this.m_eps=s,this}subE(e){return this.clone().subThisE(e)}sub(e){return this.clone().subThis(e)}subThisE(e){const i=this.m_value-e.m_value,s=this.m_eps+e.m_eps+nn.ulp(i);return this.m_value=i,this.m_eps=s,this}subThis(e){const i=this.m_value-e,s=this.m_eps+nn.ulp(i);return this.m_value=i,this.m_eps=s,this}setAddE(e,i){return this.m_value=e.m_value+i.m_value,this.m_eps=e.m_eps+i.m_eps+nn.ulp(this.m_value),this}setAdd(e,i){return this.m_value=e+i,this.m_eps=nn.ulp(this.m_value),this}setAddEN(e,i){return this.m_value=e.m_value+i,this.m_eps=e.m_eps+nn.ulp(this.m_value),this}setAddNE(e,i){return this.m_value=e+i.m_value,this.m_eps=i.m_eps+nn.ulp(this.m_value),this}setSubE(e,i){return this.m_value=e.m_value-i.m_value,this.m_eps=e.m_eps+i.m_eps+nn.ulp(this.m_value),this}setSub(e,i){return this.m_value=e-i,this.m_eps=nn.ulp(this.m_value),this}setSubEN(e,i){return this.m_value=e.m_value-i,this.m_eps=e.m_eps+nn.ulp(this.m_value),this}setSubNE(e,i){return this.m_value=e-i.m_value,this.m_eps=i.m_eps+nn.ulp(this.m_value),this}mulThisE(e){const i=this.m_value*e.m_value;return this.m_eps=this.m_eps*Math.abs(e.m_value)+e.m_eps*Math.abs(this.m_value)+this.m_eps*e.m_eps+nn.ulp(i),this.m_value=i,this}mulThis(e){const i=this.m_value*e;return this.m_eps=this.m_eps*Math.abs(e)+nn.ulp(i),this.m_value=i,this}mul(e){return this.clone().mulThis(e)}mulE(e){return this.clone().mulThisE(e)}setMulE(e,i){const s=e.m_value*i.m_value;return this.m_eps=e.m_eps*Math.abs(i.m_value)+i.m_eps*Math.abs(e.m_value)+e.m_eps*i.m_eps+nn.ulp(s),this.m_value=s,this}setMul(e,i){return this.m_value=e*i,this.m_eps=nn.ulp(this.m_value),this}setMulEN(e,i){return this.setE(e),this.mulThis(i)}setMulNE(e,i){return this.setE(i),this.mulThis(e)}mulThisByPower2(e){return this.m_value*=e,this.m_eps*=Math.abs(e),this}static st_mulByPower2(e,i){return new nn(e.m_value,e.m_eps).mulThisByPower2(i)}divE(e){return this.clone().divThisE(e)}divThisE(e){const i=Math.abs(e.m_value),s=this.m_value/e.m_value;let n=(this.m_eps+Math.abs(s)*e.m_eps)/i;if(e.m_eps>.01*i){const r=e.m_eps/i;n*=1+(1+r)*r}return this.m_value=s,this.m_eps=n+nn.ulp(s),this}divThis(e){const i=Math.abs(e);return this.m_value/=e,this.m_eps=this.m_eps/i+nn.ulp(this.m_value),this}setDivE(e,i){return this.setE(e),this.divThisE(i)}setDiv(e,i){return this.m_value=e/i,this.m_eps=nn.ulp(this.m_value),this}setDivEN(e,i){return this.setE(e),this.divThis(i)}setDivNE(e,i){return this.set(e),this.divThisE(i)}divThisByPower2(e){return this.m_value/=e,this.m_eps/=Math.abs(e),this}invThis(){return this.setE(Ff.clone().divThisE(this)),this}sqrt(){return this.clone().sqrtThis()}sqrtThis(){let e,i;return this.m_value>=0?(e=Math.sqrt(this.m_value),i=this.m_value>10*this.m_eps?.5*this.m_eps/e:this.m_value>this.m_eps?e-Math.sqrt(this.m_value-this.m_eps):Math.max(e,Math.sqrt(this.m_value+this.m_eps)-e),i+=nn.ulp(e)):this.m_value<-this.m_eps?(e=Number.NaN,i=Number.NaN):(e=0,i=Math.sqrt(this.m_eps)),this.m_value=e,this.m_eps=i,this}sqr(){return this.clone().sqrThis()}sqrThis(){const e=this.m_value*this.m_value;return this.m_eps=2*this.m_eps*Math.abs(this.m_value)+this.m_eps*this.m_eps+nn.ulp(e),this.m_value=e,this}setSin(e){const i=Math.sin(e.m_value),s=Math.cos(e.m_value);this.m_value=i;const n=Math.abs(i),r=Math.abs(e.value());return this.m_eps=(Math.abs(s)+.5*n*e.m_eps)*e.m_eps+nn.ulp(n+r),this}static ulp(e){let i=lA(e);const s=((0x7ff0000000000000n&i)>>52n)-1075n;return s>-1023n?(i=s+0x3ffn<<52n,c3e(i)):e===0?0:Number.MIN_VALUE}setCos(e){const i=Math.sin(e.m_value),s=Math.cos(e.m_value);this.m_value=s;const n=Math.abs(s),r=Math.abs(e.value());return this.m_eps=(Math.abs(i)+.5*n*e.m_eps)*e.m_eps+nn.ulp(n+r),this}static st_cosAndSin(e,i,s){const n=Math.sin(e.m_value),r=Math.cos(e.m_value);s.m_value=n,i.m_value=r;const o=Math.abs(n),a=Math.abs(r),l=Math.abs(e.value());s.m_eps=(Math.abs(r)+.5*o*e.m_eps)*e.m_eps+nn.ulp(o+l),i.m_eps=(Math.abs(n)+.5*a*e.m_eps)*e.m_eps+nn.ulp(a+l)}negate(){return this.clone().negateThis()}negateThis(){return this.m_value=-this.m_value,this}setAbs(){return this.m_value=Math.abs(this.m_value),this}isInInterval(e){return Me.construct(this.m_value-this.m_eps,this.m_value+this.m_eps).isIntersecting(e)}eq(e){return Math.abs(this.m_value-e.m_value)<=this.m_eps+e.m_eps}ne(e){return!this.eq(e)}gt(e){return this.m_value-e.m_value>this.m_eps+e.m_eps}lt(e){return e.m_value-this.m_value>this.m_eps+e.m_eps}ge(e){return!this.lt(e)}le(e){return!this.gt(e)}tolEQ(e,i){return Math.abs(this.m_value-e.m_value)<=i||this.eq(e)}tolNE(e,i){return!this.tolEQ(e,i)}tolGT(e,i){return this.m_value-e.m_value>i&&this.gt(e)}tolLT(e,i){return e.m_value-this.m_value>i&&this.lt(e)}tolGE(e,i){return!this.tolLT(e,i)}tolLE(e,i){return!this.tolGT(e,i)}isZero(){return Math.abs(this.m_value)<=this.m_eps}isFuzzyZero(){return this.isZero()&&this.m_eps!==0}tolIsZero(e){return Math.abs(this.m_value)<=Math.max(this.m_eps,e)}setPi(){this.setE(HRe)}setEuler(){this.set(2.718281828459045,T7())}static size(){return 1}};function ba(t,e){const i=tL(t),s=tL(e),n=53-jQ(i),r=53-jQ(s);return(n>=0?n:0)+(r>=0?r:0)<=52}function PD(t,e){const i=t+e;return i-t===e&&i-e===t}function yl(t,e){const i=t-e;return t-i===e&&e+i===t}function T7(){return cn()}ge.dimensions=1;const HRe=new ge(Math.PI,.5*T7()),ZS=new ge(0,0),Ff=new ge(1,0),jRe=new ge(4,0);function $c(t,e,i){return t.addE(e.subE(t).mulE(i))}function Uc(t,e,i){return e.subE(e.subE(t).mulE(Ff.subE(i)))}function YRe(t){return Math.atanh(t)}function XRe(t){let e;if(t===0)e=1;else if(Math.abs(t)>.01)e=YRe(t)/t;else{let i;const s=-36.841361487904734;e=0;const n=t*t;for(let r=2*Math.trunc(s/Math.log(n)+2.5)-1;r>1;r-=2)i=1/r,e=(e+i)*n;e+=1}return e}function fG(t){const e=Math.PI*Math.PI/6;let i;if(t===1)i=e;else if(t>1)i=e;else if(t===0)i=t;else if(t<0){const s=1+(t=Math.abs(t)),n=Math.log(s);i=n*n/-2-fG(t/s)}else if(t>.5){const s=1-t,n=Math.log(t)*Math.log(s);i=e-fG(s)-n}else{i=0;const s=1+Math.trunc(-16*Math.log(10)/Math.log(t)+1.5);let n=s;for(let r=s;r>0;r--,n-=1)i*=t,i+=1/(n*n);i*=t}return i}function Myt(t,e){const i=e*t;if(Math.abs(e)<.1){let s=0;for(let n=60;n>=1;n--)s*=i,s+=1/n/n;return s*=t,s}return fG(i)/e}function WRe(t,e){return t<e?gr(t,e):gr(e,t)}function kf(t,e){const i=Math.abs(t);return e>=0?i:-i}function g1(t){return Math.round(t)}function tr(t,e,i,s,n){n[0]=e[0]+(i[0]-e[0])*s,n[1]=e[1]+(i[1]-e[1])*s,t===3&&(n[2]=e[2]+(i[2]-e[2])*s)}function ir(t,e,i,s,n){n[0]=i[0]-(i[0]-e[0])*(1-s),n[1]=i[1]-(i[1]-e[1])*(1-s),t===3&&(n[2]=i[2]-(i[2]-e[2])*(1-s))}function jT(t,e,i,s,n){s<=.5?tr(t,e,i,s,n):ir(t,e,i,s,n)}function tc(t,e,i,s,n){n[0]=e[0].addE(i[0].subE(e[0]).mulE(s)),n[1]=e[1].addE(i[1].subE(e[1]).mulE(s))}function ic(t,e,i,s,n){n[0]=i[0].subE(i[0].subE(e[0]).mulE(Ff.subE(s))),n[1]=i[1].subE(i[1].subE(e[1]).mulE(Ff.subE(s)))}function es(t,e,i){let s;return s=i<=.5?t+(e-t)*i:e-(e-t)*(1-i),s}function Ro(t,e,i){return t+(e-t)*i}function Xr(t,e,i){return e-(e-t)*(1-i)}function zn(t,e,i,s){i<=.5?(s.x=t.x+(e.x-t.x)*i,s.y=t.y+(e.y-t.y)*i):(s.x=e.x-(e.x-t.x)*(1-i),s.y=e.y-(e.y-t.y)*(1-i))}function ZRe(t,e,i,s){i<=.5?(s.x=t.x+(e.x-t.x)*i,s.y=t.y+(e.y-t.y)*i,s.z=t.z+(e.z-t.z)*i):(s.x=e.x-(e.x-t.x)*(1-i),s.y=e.y-(e.y-t.y)*(1-i),s.z=e.z-(e.z-t.z)*(1-i))}function Di(t){return t*t}function YQ(t){return t*t*t}function KRe(t){return 1/Math.sqrt(t)}function In(t){return t<0?-1:t>0?1:0}function Ayt(t,e,i,s){const n=[0],r=[0],o=[0];return YT(ZO(t,i,n),ZO(e,s,r),o)+(n[0]+r[0]+o[0])}const XQ=[0],QRe=[0];function WQ(t,e,i){return JRe(ZO(t,e,XQ),i,XQ[0],QRe)}const PU=[0],MU=[0],AU=[0],IU=[0];function ZO(t,e,i){const s=t*e;return ZQ(t,PU,MU),ZQ(e,AU,IU),i[0]=MU[0]*IU[0]-(s-PU[0]*AU[0]-MU[0]*AU[0]-PU[0]*IU[0]),s}function ZQ(t,e,i){const s=134217729*t;e[0]=s-(s-t),i[0]=t-e[0]}const KQ=[0],QQ=[0];function JRe(t,e,i,s){const n=YT(t,e,KQ),r=YT(n,i,QQ);return YT(r,KQ[0]+QQ[0],s)}function YT(t,e,i){const s=t+e;return Math.abs(t)>Math.abs(e)?i[0]=t-s+e:i[0]=e-s+t,s}function xy(t,e){return t%e}function P7(t){const e=1-t;if(e===0)return 1;let i;if(e<=.01){const s=e,n=Math.log(s);i=1+s*(.4431471805599453-.25*n+s*(.05680519270997949-.09375*n+s*(.02183137044373718-.05859375*n+s*(.011544521417308362-.042724609375*n+s*(.00714200031339596-.0336456298828125*n+s*(.004854743337164948-.027757644653320312*n+s*(.003514687963781376-.023627042770385742*n)))))))}else{if(t<.016){const s=t;return aa()*(1-s*(.25+s*(.046875+s*(.01953125+s*(.01068115234375+s*(.0067291259765625+s*(.004626274108886719+s*(.0033752918243408203+s*.0025710230693221092))))))))}i=Wme(0,e,1)-t*Zme(0,e,1)/3}return Os(i,1,aa())}function M7(t,e,i=Number.NaN){if(z(e>=0&&e<=1),e===0)return t;let s=1,n=t;if(n<0&&(n=-n,s=-1),e===1){const c=Math.round(n/Zi()),h=n-c*Zi();return s*(2*c+Math.sin(h))}const r=aa(),o=Math.floor(n/r);1&o?n=(o+1)*r-n:n-=o*r;const a=Math.sin(n),l=Number.isNaN(i)?P7(e):i;let u;if(a===1)u=l+Math.sqrt(1-e)*(n-r);else{const c=n*n;if(.01424*Math.pow(c,4)<=2*cn())u=n*(1+c*e*(-1/6+c*((4-3*e)/120-(16+(45*e-60)*e)/5040*c)));else if(e<=.01){const h=Math.sin(2*n),d=Math.sin(4*n),m=Math.sin(6*n),f=Math.sin(8*n),_=Math.sin(10*n);u=n+e*((2*-n+h)/8+e*((-3*n+2*h-.25*d)/64+e*((-20*n+15*h-3*d+m/3)/1024+e*(5*(-140*n+112*h-28*d+16/3*m-.5*f)/65536+7*e*((-63*n+52.5*h-15*d+3.75*m-.625*f+.05*_)/65536+e*(-693*n+594*h-185.625*d+1.375*m-12.375*f+1.8*_-.125*Math.sin(12*n))/1048576)))))}else{const h=a*a,d=Math.cos(n),m=d*d,f=Kme(a,d,e);u=a*(Wme(m,f,1)-e*h*Zme(m,f,1)/3)}}return 1&o?u=l*(o+1)-u:u+=l*o,s*u}function e3e(t,e,i=Number.NaN){if(t===0)return 0;let s=1,n=t;t<0&&(n=-n,s=-1);const r=Number.isNaN(i)?P7(e):i,o=Math.floor(n/r);1&o?n=(o+1)*r-n:n-=o*r;let a=n<=0?0:n>=r?aa():t3e(n,e,r);return 1&o?a=aa()*(o+1)-a:a+=aa()*o,s*a}function Wme(t,e,i){z((t!==0?1:0)+(e!==0?1:0)+1>1);let s=t,n=e,r=i;for(;;){const o=Math.sqrt(s*n)+Math.sqrt(n*r)+Math.sqrt(r*s);s=.25*(s+o),n=.25*(n+o),r=.25*(r+o);const a=(s+n+r)/3,l=(a-s)/a,u=(a-n)/a,c=(a-r)/a;if(Math.abs(l)<=.0024&&Math.abs(u)<=.0024&&Math.abs(c)<=.0024){const h=l*u-c*c,d=l*u*c;return(1+(1/24*h-.1-3/44*d-5*h*h/208+h*d/16)*h+(1/14+3*d/104)*d)/Math.sqrt(a)}}}function Zme(t,e,i){z(t!==0||e!==0);let s=t,n=e,r=i;const o=new Wr(0);let a=1;for(;;){const l=.2*(s+n+3*r),u=(l-s)/l,c=(l-n)/l,h=(l-r)/l;if(Math.abs(u)<=.0015&&Math.abs(c)<=.0015&&Math.abs(h)<=.0015){const v=u*c,x=h*h,w=v-x,T=v-6*x,C=T+w+w,M=3/26,A=T*(.25*(9/22)*T-.21428571428571427-1.5*M*h*C),I=h*(1/6*C+h*(-.4090909090909091*w+h*M*v));return 3*o.getResult()+a*(1+A+I)/(l*Math.sqrt(l))}const d=Math.sqrt(s),m=Math.sqrt(n),f=Math.sqrt(r),_=d*(m+f)+m*f;o.add(a/(f*(r+_))),a*=.25,s=.25*(s+_),n=.25*(n+_),r=.25*(r+_)}}function Kme(t,e,i){return t<.999?1-i*Di(t):1-i+i*Di(e)}function t3e(t,e,i){if(e===0)return t;if(e===1)return Math.asin(t);let s=0,n=!0;if(t<.2){const o=t*t,a=t*(1+o*e*(1/6+o*((13*e-4)/120+(16-284*e+493*e*e)/5040*o))),l=Math.abs(e*(4944*e-64-31224*e*e+37369*e*e*e)/362880*Math.pow(t,9));if(l<Math.abs(a)*cn())return a;s=a,n=l>.1*a}if(n){const o=1-e,a=1-t/i,l=Math.sqrt(a*a+o*o),u=Math.atan2(o,t+cn());s=aa()+Math.sqrt(l)*(u-aa())}let r=0;for(let o=0;o<7;o++){r=M7(s,e,i);const a=Kme(Math.sin(s),Math.cos(s),e);if(s-=(r-t)/Math.sqrt(a),o>0&&Math.abs(r-t)<=4*cn()*t)break}return s}function aA(t,e,i,s,n){return t===0?s===0?e:s===1?i:n:t===1?s===0?e:s===1?i:es(e,i,s):(t===2&&_i("angular interpolation"),void _i(""))}function KO(t,e,i,s,n,r,o,a){if(t===0)for(let l=0;l<r;++l)s[l+n]=o===0?e[l]:o===1?i[l]:a;else if(t===1)if(o===0)Qs(s,e,n,0,r);else if(o===1)Qs(s,i,n,0,r);else for(let l=0;l<r;++l)s[l+n]=es(e[l],i[l],o);else if(t===2)if(o===0)Qs(s,e,n,0,r);else if(o===1)Qs(s,i,n,0,r);else{let l=0;for(let u=0,c=n;u<r;++u,++c)s[c]=es(e[u],i[u],o),l+=s[c]*s[c];if(l>0){l=Math.sqrt(l);for(let u=n;u<n+r;++u)s[u]/=l}else{for(let u=n;u<n+r;++u)s[u]=0;s[n]=1}}else _i("")}function Qs(t,e,i,s,n){if(n===0)return;let r=0,o=i,a=s;for(;r++<n;)t[o++]=e[a++]}function i3e(t,e,i){let s=0;for(let n=0;!s&&n<i;++n)s=t[n]-e[n];return s}function Ge(t,e){return t}function KS(t){t.sort((e,i)=>e<i?-1:e>i?1:0)}function gG(t,e){const i=t.slice(0,e);KS(i),Qs(t,i,0,0,e)}function wd(t,e,i,s){const n=t.slice(e,e+i);n.sort(s),Qs(t,n,e,0,i)}function Vm(t,e){return t<e?-1:t>e?1:0}function JQ(t,e,i,s){return t<i?-1:t>i?1:e<s?-1:e>s?1:0}function Qme(t,e){if(t.length<2)return t.length;let i=0;for(let s=1;s<t.length;++s)e(t[s],t[i])||(i++,t[s]=Ge(t[i],t[i]=t[s]));return 1+i}function s3e(t,e){t[e]=t.at(-1),t.pop()}function Jme(t,e=!1){return{[Symbol.dispose](){this.bForget||t()},bForget:e}}function QO(t,e,i){t.length=e,t.fill(i)}function n3e(t,e,i){t.length=i;for(let s=0;s<i;++s)t[s]=new e}function he(t,e){const i=new Array(e);for(let s=0;s<e;++s)i[s]=new t;return i}function JO(t,e,i){for(let s=0;s<i;++s)t[s].assign(e[s]);return i}function eL(t,e){const i=t.slice(0,e);for(let s=0;s<e;++s)i[s]=i[s].clone();return i}function XT(t){return Array.from({length:t},()=>null)}function eJ(t,e){return Array.from({length:e},()=>t())}function st(t,e){const i=new Array(t);return i.fill(e),i}function KF(t,e){return e in t&&Object.getOwnPropertyNames(t).length===1}let r3e=class{constructor(...e){this.m_elts=e}get length(){return this.m_elts.length}at(e){return this.m_elts[e]}[Symbol.dispose](){for(const e of this.m_elts)e[Symbol.dispose]()}};function gr(t,e){return{first:t,second:e}}const A7=Math.PI,GC=2*Math.PI,zi=.5*Math.PI;let o3e=class{constructor(e,i){this.m_cr=e,this.m_cc=i,this.m_v=st(e*i,0)}get(e,i){return this.m_v[e*this.m_cc+i]}set(e,i,s){this.m_v[e*this.m_cc+i]=s}inc(e,i){return++this.m_v[e*this.m_cc+i]}};const epe=new ArrayBuffer(8),tpe=new Float64Array(epe),ipe=new BigUint64Array(epe),a3e=0x0fffffffffffffn,l3e=0x7ff0000000000000n;function u3e(){return Number.EPSILON*w3e}function lA(t){return tpe[0]=t,ipe[0]}function c3e(t){return ipe[0]=t,tpe[0]}function tL(t){return lA(t)&a3e}function tJ(t){return Number((lA(t)&l3e)>>52n)}function v0(t){if(t===0n)return-1n;if(t===1n||-1n===t)return 0n;t<0n&&(t=-t);let e=0n,i=512n,s=1n<<e+i;for(;t>=s;)e+=i,i<<=1n,s<<=i;let n=e;i>>=1n;let r=n+i;for(;i>0n;)t<1n<<r||(n=r),i>>=1n,r=n+i;return n}function Ma(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}function QS(t,e,i){return t===e||Math.abs(t-e)<=i||Number.isNaN(t)&&Number.isNaN(e)}function an(t,e){return t<e?-1:t>e?1:0}function h3e(t,e){if(t<e)return-1;if(t>e)return 1;if(t===e)return 0;{const i=Number.isNaN(t),s=Number.isNaN(e);return i<s?-1:i>s?1:0}}function Aa(){return 2147483647}function iJ(){return 32767}function fo(){return 2147483647}function d3e(){return-2147483648}const QF=fo(),m3e=BigInt(QF),spe=2166136261,BC=16777619;function p3e(t){let e=spe,i=t;return e=(e^255&i)*BC,i>>=8,e=(e^255&i)*BC,i>>=8,e=(e^255&i)*BC,i>>=8,e=(e^255&i)*BC,e&QF}const f3e=14695981039346656037n,x0=1099511628211n;function g3e(t){let e=f3e,i=t;return e=(e^0xffn&i)*x0,i>>=8n,e=(e^0xffn&i)*x0,i>>=8n,e=(e^0xffn&i)*x0,i>>=8n,e=(e^0xffn&i)*x0,i>>=8n,e=(e^0xffn&i)*x0,i>>=8n,e=(e^0xffn&i)*x0,i>>=8n,e=(e^0xffn&i)*x0,e&m3e}function _3e(t){return 1103515245*t+12345&2147483647}function npe(t){let e=spe;for(let i=0,s=t.length;i<s;++i)e=(e^t.charCodeAt(i))*BC;return e&QF}function fr(t,e){return e+2654435769+(t<<6)+(t>>2)&QF}function y3e(t,e){return fr(t,ope(e))}function rpe(t){return fr(3735928559,t)}function v3e(t,e){return fr(t,rpe(e))}function nd(t){return p3e(t)}function ope(t){return Number(g3e(t))}function x3e(t){return ape(t)}function MD(t){return ope(lA(x3e(t)))}function Tw(t){return _3e(t)}const b3e=100,w3e=100;function _1(){return Number.EPSILON*b3e}function _G(){return .38196601125010515}function S3e(){return 1.4142135623730951}function cn(){return Number.EPSILON}function Vs(t,e,i){return t===e||t===i}function Os(t,e,i){return t>=e?t<=i?t:i:e}function yG(t,e,i){const s=t[0];if(s>=e){if(s<=i)return!1;t[0]=i}else t[0]=e;return!0}function E3e(t,e){return t>=e?e:t<-e?-e:t}function Zi(){return A7}function ia(){return GC}function aa(){return zi}const C3e=3*aa();function T3e(){return C3e}function ape(t){return t+0}function sJ(t){return{v:t}}let nt=class cr{constructor(){this.m_rn=sJ(0n),this.m_rd=sJ(1n),this.m_bNaN=!1,this.m_bNormalized=!1,this.m_power=0,this.m_sign=0}static constructAssign(e,i){const s=e.clone();return i!==void 0&&s.limitPrecisionThis(i),s}static constructDouble(e){return new cr().setDouble(e)}static constructInt64(e){return new cr().setInt64(e)}static constructRational(e,i){return new cr().setRational(e,i)}static constructInt32(e){return this.constructInt64(BigInt(Math.trunc(e)))}[Symbol.toPrimitive](e){return this}compare(e){return this.lt(e)?-1:this.gt(e)?1:0}assignCopy(e){return this.setThis(e)}abs(){return this.clone().absThis()}absThis(){return this.isNAN()||(this.m_sign*=this.m_sign),this}clone(){return new cr().setThis(this)}setThis(e){return this.m_bNaN=e.m_bNaN,this.m_bNormalized=e.m_bNormalized,this.m_rn.v=e.m_rn.v,this.m_rd.v=e.m_rd.v,this.m_power=e.m_power,this.m_sign=e.m_sign,this}setZero(){return this.m_rn.v=0n,this.m_rd.v=1n,this.m_bNaN=!1,this.m_power=0,this.m_bNormalized=!0,this.m_sign=0,this}setDouble(e){if(this.setZero(),e===0)return this;if(Number.isInteger(e)&&Math.abs(e)<fo())return this.setInt32(e);const i=lA(e),s=(i&cr.s_em)>>52n,n=!!(i&cr.s_sm),r=i&cr.s_fm;if(s===cr.s_emax)return r?(this.m_rn.v=this.m_rd.v=0n,this.m_bNaN=!0,this):(this.m_rn.v=n?-1n:1n,this.m_rd.v=0n,this);s===0n&&_i("denormalized numbers not yet implemented");const o=s-1023n,a=o>=0n?o:0n,l=o<0n?-o:0n;return this.m_rn.v=(1n<<52n|r)<<a,this.m_rd.v=1n<<52n+l,this.m_sign=n?-1:1,this.m_bNormalized=!1,this.normalizeThis()}setInt64(e){return e===0n?this.setZero():(this.m_bNaN=!1,this.m_sign=e>0n?1:-1,this.m_rn.v=e>0n?e:-e,this.m_rd.v=1n,this.m_power=0,this.m_bNormalized=!1,this.normalizeThis())}setRational(e,i){return e===0n?i===0n?this.setNAN():this.setZero():i===0n?e>0n?this.setPositiveInf():this.setNegativeInf():(this.m_sign=(e>0n?1:-1)*(i>0n?1:-1),this.m_rn.v=e>0n?e:-e,this.m_rd.v=i>0n?i:-i,this.m_power=0,this.m_bNormalized=!1,this.normalizeThis())}setInt32(e){return this.setInt64(BigInt(Math.trunc(e)))}getDouble(){return this.convertToDouble()}toDouble(){return this.convertToDouble()}value(){return this.convertToDouble()}isNAN(){return this.m_bNaN}isPositiveInf(){return!this.isNAN()&&this.m_rd.v===0n&&this.m_sign===1}isNegativeInf(){return!this.isNAN()&&this.m_rd.v===0n&&this.m_sign===-1}isFinite(){return!this.isNAN()&&this.m_rd.v!==0n}setNAN(){return this.m_bNaN=!0,this.m_rn.v=0n,this.m_rd.v=0n,this.m_power=0,this.m_bNormalized=!0,this}setPositiveInf(){return this.m_rn.v=1n,this.m_rd.v=0n,this.m_bNaN=!1,this.m_bNormalized=!0,this.m_sign=1,this.m_power=0,this}setNegativeInf(){return this.m_rn.v=1n,this.m_rd.v=0n,this.m_bNaN=!1,this.m_bNormalized=!0,this.m_sign=-1,this.m_power=0,this}subThis(e){if(e.isNAN()&&this.setNAN(),this.isPositiveInf()&&e.isPositiveInf())this.setNAN();else{if(this.isPositiveInf()&&e.isNegativeInf())return this.setPositiveInf(),this;if(this.isNegativeInf()&&e.isNegativeInf())this.setNAN();else if(this.isNegativeInf()&&e.isPositiveInf())return this.setNegativeInf(),this}return this.isNAN()?this:this.opPlusMinus(e,!1)}thisSubAbs(e){return z(0),this}mulThis(e){return e.isNAN()&&this.setNAN(),this.isNAN()?this:(this.m_sign*=e.m_sign,this.m_sign===0?this.setZero():(this.m_rn.v*=e.m_rn.v,this.m_rd.v*=e.m_rd.v,this.m_power+=e.m_power,this.m_bNormalized=!1,this.normalizeThis(),this))}mulDoubleThis(e){return this.mulThis(cr.constructDouble(e))}thisMulInt64(e){return z(0),this}thisMulInt32(e){return z(0),this}divThis(e){return this.mulThis(e.clone().invertThis())}divDoubleThis(e){return this.divThis(cr.constructDouble(e))}addDoubleThis(e){return this.addThis(cr.constructDouble(e))}subDoubleThis(e){return this.subThis(cr.constructDouble(e))}mul(e){return this.clone().mulThis(e)}mulBigIntThis(e){return this.mulThis(cr.constructInt64(e))}mulDouble(e){return this.clone().mulThis(cr.constructDouble(e))}div(e){return this.clone().divThis(e)}divDouble(e){return this.clone().divDoubleThis(e)}add(e){return this.clone().addThis(e)}fmSubThis(e,i){return this.subThis(e.clone().mulThis(i))}fmAddThis(e,i){return this.addThis(e.clone().mulThis(i))}addThis(e){if(e.isNAN()&&this.setNAN(),this.isPositiveInf()&&e.isPositiveInf())return this.setPositiveInf(),this;if(this.isPositiveInf()&&e.isNegativeInf())this.setNAN();else{if(this.isNegativeInf()&&e.isNegativeInf())return this.setNegativeInf(),this;this.isNegativeInf()&&e.isPositiveInf()&&this.setNAN()}return this.isNAN()?this:this.opPlusMinus(e,!0)}addDouble(e){return this.clone().addThis(cr.constructDouble(e))}sub(e){return this.clone().subThis(e)}subDouble(e){return this.clone().subThis(cr.constructDouble(e))}isZero(){return this.m_sign===0}equals(e){return this.clone().subThis(e).isZero()}lt(e){return!this.isNAN()&&!e.isNAN()&&!(this.isPositiveInf()&&e.isPositiveInf()||this.isNegativeInf()&&e.isNegativeInf())&&!this.isPositiveInf()&&(!!e.isPositiveInf()||this.clone().sub(e).LZ())}absLessAbs(e){return this.abs().lt(e.abs())}gt(e){return this.clone().sub(e).GZ()}lte(e){return this.sub(e).LEZ()}gte(e){return this.sub(e).GEZ()}normalizeThis(){if(this.m_bNormalized)return this;if(this.m_rn.v===0n)return this.setZero();let e=0,i=0xffffffffn;for(;(this.m_rn.v&i)===0n&&i<=this.m_rn.v;)i<<=32n,e+=32;i&=this.m_rn.v,i>>=BigInt(e),e+=pG(BigInt.asUintN(32,i))-1;let s=0;for(i=0xffffffffn;(this.m_rd.v&i)===0n&&i<=this.m_rd.v;)i<<=32n,s+=32;return i&=this.m_rd.v,i>>=BigInt(s),s+=pG(BigInt.asUintN(32,i))-1,this.m_rn.v>>=BigInt(e),this.m_rd.v>>=BigInt(s),this.m_power+=e-s,this.m_rn.v>1n&&this.m_rd.v>1n&&(this.m_rn.v%this.m_rd.v===0n?(this.m_rn.v/=this.m_rd.v,this.m_rd.v=1n):this.m_rd.v%this.m_rn.v===0n&&(this.m_rd.v/=this.m_rn.v,this.m_rn.v=1n)),this.m_bNormalized=!0,this}negateThis(){return this.isNAN()||(this.m_sign*=-1),this}negate(){return this.clone().negateThis()}invertThis(){return this.isNAN()?this:this.isPositiveInf()||this.isNegativeInf()?(this.setZero(),this):this.m_rn.v===0n?(this.setPositiveInf(),this):(this.m_rd=Ge(this.m_rn,this.m_rn=this.m_rd),this.m_power=-this.m_power,this)}limitPrecisionThis(e){if(e===0)return this;if(this.isZero())return this.setZero();if(!this.isFinite())return this;this.normalizeThis();let i=Number(v0(this.m_rn.v));if(i>e){const s=i-e;this.m_rn.v>>=BigInt(i-e),this.m_power+=s}if(i=Number(v0(this.m_rd.v)),i>e){const s=i-e;this.m_rd.v>>=BigInt(i-e),this.m_power-=s}return this}hiBitIndex(){return Math.max(Number(v0(this.m_rn.v)),Number(v0(this.m_rd.v)))}ldexp(e){return this.clone().ldexpThis(e)}ldexpThis(e){return e&&(this.m_bNormalized=!1,this.m_power+=e,this.normalizeThis()),this}LZ(){return!this.isNAN()&&this.m_sign===-1}GZ(){return!this.isNAN()&&this.m_sign===1}LEZ(){return!this.isNAN()&&this.m_sign<=0}GEZ(){return!this.isNAN()&&this.m_sign>=0}toString(){return this.toDouble().toString()}sqr(){return this.clone().sqrThis()}sqrThis(){return this.mulThis(this.clone())}static sqrt(e,i){if(e.m_sign<0n&&bi("MP_value: sqrt(-1)"),e.isZero())return e.clone();let s=52,n=2220446049250313e-31;for(;s<i;)2*s<=i?(n*=n,s*=2):(n*=2220446049250313e-31,s+=52);s+=52;const r=v0(e.m_rn.v),o=v0(e.m_rd.v);let a,l=e.m_power+Number(r-o);const u=new cr;Math.abs(l)>200?(1&Math.abs(l)&&(l+=1),a=cr.constructAssign(e,53).ldexpThis(-l).value(),u.setThis(e).ldexpThis(-l),z(Number.isFinite(a))):(u.setThis(e),a=u.value(),z(Number.isFinite(a)),l=0),a=Math.sqrt(a);const c=cr.constructDouble(a),h=cr.constructDouble(n);h.mulThis(c).ldexpThis(1);const d=n*a*2,m=c.clone(),f=new cr;let _;for(let v=0;v<10;++v){m.mulThis(c),f.setThis(u).subThis(m).absThis();let x=f.value();if(_=1,x<.9)for(;x>d;)x*=x,++_;else _=4;if(f.lte(h))break;for(let w=0;w<_;w++)m.setThis(c).divThis(u).invertThis().addThis(c).ldexpThis(-1).limitPrecisionThis(s),c.setThis(m)}return c.ldexpThis(l/2)}static cubicRoot(e,i){if(e.isZero())return e.clone();let s=52,n=2220446049250313e-31;for(;s<i;)2*s<=i?(n*=n,s*=2):(n*=2220446049250313e-31,s+=52);s+=52;const r=Math.pow(Math.abs(e.value()),1/3),o=cr.constructDouble(r),a=o.clone();a.sqrThis().mulDoubleThis(3).mulDoubleThis(n),a.limitPrecisionThis(32),e.LZ()&&o.negateThis();for(let l=0;l<10;++l){const u=o.clone();u.sqrThis().mulThis(o);const c=u.clone();if(c.subThis(e),c.absThis().limitPrecisionThis(32),c.lte(a))break;c.setThis(e),c.ldexpThis(1),c.addThis(u);const h=u.clone();h.ldexpThis(1),h.addThis(e),c.divThis(h),o.mulThis(c),o.limitPrecisionThis(s)}return o}isInTheRangeOfDouble(){return z(0),!1}sign(){return this.m_sign}cosAndSin(e,i){z(0)}static nan(){return z(0),new cr}convertToDouble(){if(this.m_bNaN)return Number.NaN;if(this.isZero())return 0;if(this.m_rd.v===0n)return this.m_sign===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;const e=this.m_sign===-1,i=this.m_rn.v<<(this.m_power>=0?BigInt(this.m_power):0n);let s=this.m_rd.v<<(this.m_power<0?BigInt(-this.m_power):0n);const n=i/s;let r=Number(n);if(BigInt(r)!==n)return e?-r:r;let o=i-n*s;if(o){let a=v0(s)-1023n;a>0n&&(s>>=a,o<<=52n,o>>=a);let l=Number(o);Number.isFinite(l)||(o>>=52n,l=Number(o),a=0n),a>0n&&(l/=Math.pow(2,52)),r+=l/Number(s)}return e?-r:r}signVal(){return this.m_sign===1?1n:this.m_sign===-1?-1n:0n}opPlusMinus(e,i){const s=Math.min(this.m_power,e.m_power);let n,r;this.m_power>s?(n=BigInt(this.m_power-s),r=0n):(n=0n,r=BigInt(e.m_power-s));const o=this.signVal()*this.m_rn.v*e.m_rd.v<<n,a=e.signVal()*e.m_rn.v*this.m_rd.v<<r;return this.m_rn.v=i?o+a:o-a,this.m_rd.v*=e.m_rd.v,this.m_power=s,this.m_sign=1,this.m_rn.v<0n&&(this.m_sign=-1,this.m_rn.v=-this.m_rn.v),this.m_bNormalized=!1,this.normalizeThis(),this}};nt.s_sm=0x8000000000000000n,nt.s_em=0x7ff0000000000000n,nt.s_fm=0x000fffffffffffffn,nt.s_emax=0x7ffn;const rd=nt.constructInt32(1),sa=nt.constructInt32(0);function P3e(t,e){return BRe(t^e)}function M3e(t,e){let i=tJ(t);const s=tJ(e);return i===s?(i-=53-P3e(tL(t),tL(e)),i):i>s?i:s}function A3e(t,e){for(let i=0,s=0,n=t.length;i<n;i+=2,s++)e[s].x=t[i],e[s].y=t[i+1]}function I3e(t){const e=new Float64Array(2*t.length);for(let i=0,s=t.length;i<s;++i){const n=i<<1;e[n]=t[i].x,e[n+1]=t[i].y}return e}function $x(t){const e=he(N,t.length);for(let i=0,s=t.length;i<s;++i)e[i].setCoords(t[i][0],t[i][1]);return e}let N=class rs{static construct(e,i){return new rs(e,i)}constructor(e,i){e!==void 0?(this.x=e,this.y=i):this.x=this.y=Number.NaN}clone(){return new rs(this.x,this.y)}assign(e){this.setCoordsPoint2D(e)}setCoords(e,i){return this.x=e,this.y=i,this}setCoordsPoint2D(e){this.x=e.x,this.y=e.y}isEqualPoint2D(e,i){return i!==void 0?Math.abs(this.x-e.x)<=i&&Math.abs(this.y-e.y)<=i:this.x===e.x&&this.y===e.y}isEqual(e,i,s){return s!==void 0?Math.abs(this.x-e)<=s&&Math.abs(this.y-i)<=s:this.x===e&&this.y===i}equalsPoint2D(e,i){return this.isEqualPoint2D(e,i)}setSub(e,i){this.x=e.x-i.x,this.y=e.y-i.y}addThis(e){return this.x+=e.x,this.y+=e.y,this}setAdd(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this}absoluteOther(e){}absolute(){return z(0),this}setNegate(){this.x=-this.x,this.y=-this.y}setNegateOther(e){this.x=-e.x,this.y=-e.y}interpolateThis(e,i){}interpolate(e,i,s){z(0)}scaleAddThis(e,i){this.x=this.x*e+i.x,this.y=this.y*e+i.y}setScaleAdd(e,i,s){this.x=i.x*e+s.x,this.y=i.y*e+s.y}scaleOther(e,i){z(0)}scale(e){this.x*=e,this.y*=e}compare(e){return this.y<e.y?-1:this.y>e.y?1:this.x<e.x?-1:this.x>e.x?1:0}compareX(e){return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0}normalizeOther(e){z(0)}normalize(){const e=this.length();return e?(this.x/=e,this.y/=e):(this.x=1,this.y=0),this}getUnitVector(){return this.clone().normalize()}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}sqrLength(){return this.x*this.x+this.y*this.y}static averageFast(e,i){return z(0),{}}static average(e,i){const s=new rs;if(i===0)return s.setNAN(),s;if(i===1)return s.assign(e[0]),s;const n=new Wr(e[0].x),r=new Wr(e[0].y);for(let o=1;o<i;o++)n.add(e[o].x),r.add(e[o].y),255&o||(n.normalize(),r.normalize());return s.x=n.getResult()/i,s.y=r.getResult()/i,s}offset(e,i){const s=rs.distance(e,i),n=rs.construct(this.x,this.y);if(s===0)return rs.distance(n,e);const r=i.clone();return r.subThis(e),n.subThis(e),n.crossProduct(r)/s}side(e,i){return e.equals(i)?this.equals(e)?0:1:rs.orientationRobust(i,e,this)}static sqrDistance(e,i){const s=e.x-i.x,n=e.y-i.y;return s*s+n*n}static sqrDistanceCoords(e,i,s,n){const r=s-e,o=n-i;return r*r+o*o}static distance(e,i){return Math.sqrt(rs.sqrDistance(e,i))}dotProduct(e){return this.x*e.x+this.y*e.y}dotProductAbs(e){return Math.abs(this.x*e.x)+Math.abs(this.y*e.y)}crossProduct(e){return this.x*e.y-this.y*e.x}crossProductAbs(e){return z(0),0}rotateDirect(e,i){const s=this.x*e-this.y*i,n=this.x*i+this.y*e;this.x=s,this.y=n}rotateReverse(e,i){const s=this.x*e+this.y*i,n=-this.x*i+this.y*e;this.x=s,this.y=n}leftPerpendicularThis(){const e=this.x;this.x=-this.y,this.y=e}leftPerpendicularOther(e){const i=e.x;this.x=-e.y,this.y=i}rightPerpendicularThis(){const e=this.x;this.x=this.y,this.y=-e}rightPerpendicularOther(e){const i=e.x;this.x=e.y,this.y=-i}equals(e){return this.x===e.x&&this.y===e.y}notequals(e){return this.x!==e.x||this.y!==e.y}not(){return!this.x&&!this.y}gt(e){return this.y>e.y||this.y===e.y&&this.x>e.x}gte(e){return!this.lt(e)}lt(e){return this.y<e.y||this.y===e.y&&this.x<e.x}lte(e){return!this.gt(e)}subThis(e){return this.x-=e.x,this.y-=e.y,this}divThis(e){return this.x/=e,this.y/=e,this}add(e){return new rs(this.x+e.x,this.y+e.y)}sub(e){return new rs(this.x-e.x,this.y-e.y)}negateThis(){return this.x=-this.x,this.y=-this.y,this}negate(){return new rs(-this.x,-this.y)}mul(e){return new rs(this.x*e,this.y*e)}mulThis(e){return this.x*=e,this.y*=e,this}divide(e){return new rs(this.x/e,this.y/e)}setNAN(){this.x=this.y=Number.NaN}isNAN(){return Number.isNaN(this.x)||Number.isNaN(this.y)}static getNAN(){return new rs(Number.NaN,Number.NaN)}isFinite(){return Number.isFinite(this.x)&&Number.isFinite(this.y)}isZero(){return this.x===0&&this.y===0}norm(e){switch(e){case 0:{const i=Math.abs(this.x),s=Math.abs(this.y),n=i-s;return n>=0?i:n<=0?s:Number.NaN}case 1:return Math.abs(this.x)+Math.abs(this.y);case 2:return Math.sqrt(this.x*this.x+this.y*this.y);default:ce("norm")}}getQuarter(){return rs.getQuarterCoords(this.x,this.y)}static getQuarterCoords(e,i){return e>0?i>=0?1:4:i>0?2:e===0?4:3}static compareVectors(e,i){const s=e.getQuarter(),n=i.getQuarter();return n===s?rs.orientationRobustImpl(rs.construct(0,0),i,e,!0):s<n?-1:1}static compareVectorsOrigin(e,i,s){const n=i.sub(e),r=s.sub(e),o=n.getQuarter(),a=r.getQuarter();return a===o?rs.orientationRobustImpl(e,s,i,!0):o<a?-1:1}static orientationRobust(e,i,s){return rs.orientationRobustImpl(e,i,s,!1)}static orientationRobustEx(e,i,s,n){if(e.equals(i)||s.equals(n))return 0;const r=i.x-e.x,o=i.y-e.y,a=n.x-s.x,l=n.y-s.y;{const m=rs.getQuarterCoords(r,o)-1,f=rs.getQuarterCoords(a,l)-1,_=rs.d[m][f];if(_!==0)return _}const u=r*l,c=o*a,h=4*cn()*(Math.abs(u)+Math.abs(c)),d=u-c;return Math.abs(d)>=h?d<0?-1:d>0?1:0:rs.orientationRobustExMp(e,i,s,n)}static orientationRobustExMp(e,i,s,n){const r=nt.constructDouble(i.x),o=nt.constructDouble(n.x);r.subThis(nt.constructDouble(e.x)),o.subThis(nt.constructDouble(s.x));const a=nt.constructDouble(i.y),l=nt.constructDouble(n.y);return a.subThis(nt.constructDouble(e.y)),l.subThis(nt.constructDouble(s.y)),r.mulThis(l),a.mulThis(o),r.subThis(a),r.LZ()?-1:r.GZ()?1:0}static orientationNonRobust(e,i,s){const n=i.sub(e).crossProduct(s.sub(e));return n<0?-1:n>0?1:0}static orientationRobustImpl(e,i,s,n){if(i.isEqualPoint2D(e)||s.isEqualPoint2D(e)||i.isEqualPoint2D(s))return 0;const r=i.x-e.x,o=i.y-e.y,a=s.x-e.x,l=s.y-e.y;if(!n){const h=rs.getQuarterCoords(r,o)-1,d=rs.getQuarterCoords(a,l)-1,m=rs.d[h][d];if(m!==0)return m}const u=(Math.abs(r)+Math.abs(o)+Math.abs(a)+Math.abs(l))*(Math.abs(i.x)+Math.abs(i.y)+Math.abs(s.x)+Math.abs(s.y))*8*T7(),c=r*l-o*a;if(Math.abs(c)>u)return c<0?-1:1;if(yl(i.x,e.x)&&yl(s.y,e.y)&&yl(i.y,e.y)&&yl(s.x,e.x)&&ba(r,l)&&ba(o,a)){const h=r*l,d=o*a;if(yl(h,d)){const m=h-d;return m<0?-1:m>0?1:0}}return rs.orientationRobustMp(e,i,s)}static orientationRobustMp(e,i,s){const n=nt.constructDouble(i.x),r=nt.constructDouble(s.x);{const l=nt.constructDouble(e.x);n.subThis(l),r.subThis(l)}const o=nt.constructDouble(s.y),a=nt.constructDouble(i.y);{const l=nt.constructDouble(e.y);o.subThis(l),a.subThis(l)}return n.mulThis(o),a.mulThis(r),n.subThis(a),n.LZ()?-1:n.GZ()?1:0}static inCircleRobust(e,i,s,n){const r=new ge,o=new ge;r.set(e.x),r.subThis(n.x),o.set(e.y),o.subThis(n.y);const a=new ge,l=new ge;a.set(i.x),a.subThis(n.x),l.set(i.y),l.subThis(n.y);const u=new ge,c=new ge;u.set(s.x),u.subThis(n.x),c.set(s.y),c.subThis(n.y);const h=r.mulE(l).subE(o.mulE(a)),d=a.mulE(c).subE(l.mulE(u)),m=r.mulE(c).subE(o.mulE(u)),f=r.mulE(r).addE(o.mulE(o)),_=a.mulE(a).addE(l.mulE(l)),v=u.mulE(u).addE(c.mulE(c)),x=f.mulE(d).subE(_.mulE(m)).addE(v.mulE(h));if(!x.isFuzzyZero()){const w=x.value();return w<0?-1:w>0?1:0}return rs.inCircleRobustMp(e,i,s,n)}static inCircleRobustMp(e,i,s,n){do{if(!yl(e.x,n.x)||!yl(e.y,n.y)||!yl(i.x,n.x)||!yl(i.y,n.y)||!yl(s.x,n.x)||!yl(s.y,n.y))break;const C=e.x-n.x,M=e.y-n.y,A=i.x-n.x,I=i.y-n.y,L=s.x-n.x,D=s.y-n.y;if(!ba(C,I)||!ba(M,A)||!ba(A,D)||!ba(I,L)||!ba(C,D)||!ba(M,L)||!ba(C,C)||!ba(M,M)||!ba(A,A)||!ba(I,I)||!ba(L,L)||!ba(D,D))break;const O=C*I,U=M*A,$=A*D,B=I*L,V=C*D,H=M*L,Y=C*C,W=M*M,ee=A*A,ne=I*I,j=L*L,oe=D*D;if(!yl(O,U)||!yl($,B)||!yl(V,H)||!PD(Y,W)||!PD(ee,ne)||!PD(j,oe))break;const ve=O-U,Ye=$-B,de=V-H,fe=Y+W,Ne=ee+ne,je=j+oe;if(!ba(fe,Ye)||!ba(Ne,de)||!ba(je,ve))break;const Ee=fe*Ye,Zt=Ne*de,qt=je*ve;if(!yl(Ee,Zt))break;const Mi=Ee-Zt;if(!PD(Mi,qt))break;const oi=Mi+qt;return oi<0?-1:oi>0?1:0}while(!1);const r=nt.constructDouble(n.x),o=nt.constructDouble(n.y),a=nt.constructDouble(e.x),l=nt.constructDouble(e.y);a.subThis(r),l.subThis(o);const u=nt.constructDouble(i.x),c=nt.constructDouble(i.y);u.subThis(r),c.subThis(o);const h=nt.constructDouble(s.x),d=nt.constructDouble(s.y);h.subThis(r),d.subThis(o);const m=a.mul(c).sub(l.mul(u)),f=u.mul(d).sub(c.mul(h)),_=a.mul(d).sub(l.mul(h)),v=a.mul(a).add(l.mul(l)),x=u.mul(u).add(c.mul(c)),w=h.mul(h).add(d.mul(d)),T=v.mul(f).sub(x.mul(_)).add(w.mul(m));return T.LZ()?-1:T.GZ()?1:0}static inCircleRobustMp3Point(e,i,s){const n=nt.constructDouble(e.x),r=nt.constructDouble(e.y),o=nt.constructDouble(i.x),a=nt.constructDouble(i.y),l=nt.constructDouble(s.x),u=nt.constructDouble(s.y),c=l.mul(l).add(u.mul(u)).sub(l.mul(n).add(u.mul(r)).add(l.mul(o)).add(u.mul(a))).add(n.mul(o).add(r.mul(a)));return c.LZ()?-1:c.GZ()?1:0}static inCircleRobust3Point(e,i,s){const n=new ge(e.x),r=new ge(e.y),o=new ge(i.x),a=new ge(i.y),l=new ge(s.x),u=new ge(s.y),c=l.mulE(l).addE(u.mulE(u)).subE(l.mulE(n).addE(u.mulE(r)).addE(l.mulE(o)).addE(u.mulE(a))).addE(n.mulE(o).addE(r.mulE(a)));if(!c.isFuzzyZero()){const h=c.value();return h<0?-1:h>0?1:0}return rs.inCircleRobustMp3Point(e,i,s)}static calculateCircleCenterFromThreePoints(e,i,s){if(e.equals(s)||e.equals(i)||s.equals(i))return rs.getNAN();const n=D3e(e,i,s);return n.isNAN()?N3e(e,i,s):n}static calculateAngle(e,i){return Math.atan2(e.crossProduct(i),e.dotProduct(i))}static isBisectorRobust(e,i,s){return z(0),!1}static size(){return 2}get 0(){return this.x}get 1(){return this.y}set 0(e){this.x=e}set 1(e){this.y=e}static compareZorder(e,i){const s=rs.c_compare_zorder_xx[e.x<0?1:0]|rs.c_compare_zorder_yy[e.y<0?1:0],n=rs.c_compare_zorder_xx[i.x<0?1:0]|rs.c_compare_zorder_yy[i.y<0?1:0];if(s===n){let r=0,o=0;for(let a=0;a<2;++a){const l=M3e(e[a],i[a]);l>r&&(r=l,o=a)}return e[o]<i[o]}return s<n}static lerp(e,i,s){const n=new rs;return zn(e,i,s,n),n}static getClosestCoordinate(e,i,s,n=!1){const r=rs.getNAN();r.setSub(i,e);const o=r.sqrLength();if(o===0)return .5;if(i.isEqualPoint2D(s))return 1;const a=rs.getNAN();a.setSub(s,e);let l=a.dotProduct(r)/o;return n||(l<0?l=0:l>1&&(l=1)),l}static intersectLinesAtOnePoint(e,i,s,n){if(e.equals(i)||s.equals(n))return rs.getNAN();const r=i.x-e.x,o=s.x-n.x,a=i.y-e.y,l=s.y-n.y,u=r*l-o*a;if(!u)return rs.getNAN();const c=u;if(c===0)return rs.getNAN();let h=(s.x-e.x)*l-(s.y-e.y)*o;h/=c;const d=new rs;return zn(e,i,h,d),d.isFinite()?d:rs.getNAN()}toString(){return`[${this.x},${this.y}]`}};function D3e(t,e,i){const s=new ge(e.x);s.subThis(t.x);const n=new ge(e.y);n.subThis(t.y);const r=new ge(i.x);r.subThis(t.x);const o=new ge(i.y);o.subThis(t.y);const a=s.clone();a.mulThisE(o);let l=n.clone();if(l.mulThisE(r),a.subThisE(l),a.value()===0)return N.getNAN();a.mulThis(2);const u=s.clone();u.mulThisE(s);const c=n.clone();c.mulThisE(n);const h=u.clone();h.addThisE(c);const d=r.clone();d.mulThisE(r);const m=o.clone();m.mulThisE(o);const f=d.clone();f.addThisE(m);const _=n.clone();_.mulThisE(f),l=o.clone(),l.mulThisE(h),_.subThisE(l),_.divThisE(a);const v=s.clone();v.mulThisE(f),l=r.clone(),l.mulThisE(h),v.subThisE(l),v.divThisE(a);const x=N.construct(t.x-_.value(),t.y+v.value()),w=t.sub(x).length(),T=e.sub(x).length(),C=i.sub(x).length(),M=1e-15*(w+Math.abs(t.x)+Math.abs(e.x)+Math.abs(i.x)+Math.abs(t.y)+Math.abs(e.y)+Math.abs(i.y));return Math.abs(w-T)<=M&&Math.abs(w-C)<=M&&_.eps()<M&&v.eps()<M?x:N.getNAN()}function N3e(t,e,i){const s=nt.constructDouble(e.x);s.subDoubleThis(t.x);const n=nt.constructDouble(e.y);n.subDoubleThis(t.y);const r=nt.constructDouble(i.x);r.subDoubleThis(t.x);const o=nt.constructDouble(i.y);o.subDoubleThis(t.y);const a=s.clone();a.mulThis(o);let l=n.clone();if(l.mulThis(r),a.subThis(l),a.isZero())return N.getNAN();a.mulDoubleThis(2);const u=s.clone();u.mulThis(s);const c=n.clone();c.mulThis(n);const h=u.clone();h.addThis(c);const d=r.clone();d.mulThis(r);const m=o.clone();m.mulThis(o);const f=d.clone();f.addThis(m);const _=n.clone();_.mulThis(f),l=o.clone(),l.mulThis(h),_.subThis(l),_.divThis(a);const v=s.clone();return v.mulThis(f),l=r.clone(),l.mulThis(h),v.subThis(l),v.divThis(a),N.construct(t.x-_.value(),t.y+v.value())}N.dimensions=2,N.d=[[0,1,0,-1],[-1,0,1,0],[0,-1,0,1],[1,0,-1,0]],N.c_compare_zorder_xx=[2,0],N.c_compare_zorder_yy=[1,0];let R3e=class Or{constructor(e,i,s){if(e instanceof Or)return this.data=e.data,this.N=e.N,this.M=e.M,e.data=null,e.N=0,void(e.M=0);this.data=e,this.N=i,this.M=s}assignCopy(e){return this===e||(z(this.N*this.M==e.N*e.M),this.data.set(e.data),this.N=e.N,this.M=e.M),this}setZero(){var e;return(e=this.data)==null||e.fill(0),this}setIdentity(){for(let s=0;s<this.N;s++)for(let n=0;n<this.M;n++)this.setRowCol(s,n,s===n?1:0);return this}rows(){return this.N}cols(){return this.M}row(e){return z(0),{}}set(e,i){return this.data[e]=i,this}setRowCol(e,i,s){return this.data[e*this.M+i]=s,this}at(e){return this.data[e]}atRowCol(e,i){return this.data[e*this.M+i]}mulScalar(e,i){z(0)}mul(e,i){if(z(this.M===e.rows()),z(this.N===i.rows()),z(e.cols()===i.cols()),i===this){const n=new Float64Array(this.N*this.M),r=new Or(n,this.N,this.M);return this.mul(e,r),void i.assignCopy(r)}if(i===e){const n=new Float64Array(e.N*e.M),r=new Or(n,e.N,e.M);return this.mul(e,r),void i.assignCopy(r)}const s=e.cols();for(let n=0;n<this.N;n++)for(let r=0;r<s;r++){let o=0;for(let a=0;a<this.M;a++)o+=this.atRowCol(n,a)*e.atRowCol(a,r);i.setRowCol(n,r,o)}}mulTranspose(e,i){if(z(this.M===e.cols()),z(this.N===i.rows()),z(e.rows()===i.cols()),i===this){const n=new Float64Array(this.N*this.M),r=new Or(n,this.N,this.M);return this.mulTranspose(e,r),void i.assignCopy(r)}if(i===e){const n=new Float64Array(e.N*e.M),r=new Or(n,e.N,e.M);return this.mulTranspose(e,r),void i.assignCopy(r)}const s=e.rows();for(let n=0;n<this.N;n++)for(let r=0;r<s;r++){let o=0;for(let a=0;a<this.M;a++)o+=this.atRowCol(n,a)*e.atRowCol(r,a);i.setRowCol(n,r,o)}}mulLeft(e,i){z(0)}mulLeftTranspose(e,i){z(0)}mulDiag(e,i){if(z(this.M===e.N*e.M),z(this.N===i.rows()),z(this.M===i.cols()),i===this){const n=new Float64Array(this.N*this.M),r=new Or(n,this.N,this.M);return this.mulDiag(e,r),void i.assignCopy(r)}const s=this.M;for(let n=0;n<this.N;n++)for(let r=0;r<s;r++)i.setRowCol(n,r,this.atRowCol(n,r)*e.at(r))}transposeInPlace(){if(this.N===this.M){for(let s=0;s<this.N;s++)for(let n=s+1;n<this.M;n++){const r=this.atRowCol(s,n);this.setRowCol(s,n,this.atRowCol(n,s)),this.setRowCol(n,s,r)}return this}const e=new Float64Array(this.N*this.M),i=new Or(e,this.N,this.M);return i.assignCopy(this),this.M=Ge(this.N,this.N=this.M),i.transpose(this),this}transpose(e){if(this!==e){Or.checkDims(e,this.M,this.N);for(let i=0;i<this.N;i++)for(let s=0;s<this.M;s++)e.setRowCol(s,i,this.atRowCol(i,s))}else e.transposeInPlace()}add(e,i){}svd(e,i,s,n=!1){if(Or.checkDims(e,this.N,this.M),Or.checkDims(i,this.M,1),Or.checkDims(s,this.M,this.M),n){if(z(this.N===this.M),!this.symmetricEigen(i,s))return!1;for(let $=0;$<this.M;++$)i.at($)<0&&i.set($,0);return e.assignCopy(s),!0}let r,o,a,l,u,c,h,d=0,m=0,f=0,_=0,v=0;const x=this.M,w=this.N;e.assignCopy(this);const T=new Float64Array(x),C=new Or(T,x,1),M=($,B)=>B>=0?Math.abs($):-Math.abs($),A=($,B)=>{if(($=Math.abs($))>(B=Math.abs(B))){const V=B/$;return $*Math.sqrt(V*V+1)}if(B>0){const V=$/B;return B*Math.sqrt(V*V+1)}return 0};for(let $=0;$<x;$++){if(d=$+1,C.set($,_*f),f=l=_=0,$<w){for(let V=$;V<w;V++)_+=Math.abs(e.atRowCol(V,$));if(_){for(let V=$;V<w;V++)e.setRowCol(V,$,e.atRowCol(V,$)/_),l+=e.atRowCol(V,$)*e.atRowCol(V,$);o=e.atRowCol($,$),f=-M(Math.sqrt(l),o),a=o*f-l,e.setRowCol($,$,o-f);for(let V=d;V<x;V++){l=0;for(let H=$;H<w;H++)l+=e.atRowCol(H,$)*e.atRowCol(H,V);o=l/a;for(let H=$;H<w;H++)e.setRowCol(H,V,e.atRowCol(H,V)+o*e.atRowCol(H,$))}for(let V=$;V<w;V++)e.setRowCol(V,$,e.atRowCol(V,$)*_)}}if(i.set($,_*f),f=l=_=0,$<w&&$!==x-1){for(let V=d;V<x;V++)_+=Math.abs(e.atRowCol($,V));if(_){for(let V=d;V<x;V++)e.setRowCol($,V,e.atRowCol($,V)/_),l+=e.atRowCol($,V)*e.atRowCol($,V);o=e.atRowCol($,d),f=-M(Math.sqrt(l),o),a=o*f-l,e.setRowCol($,d,o-f);for(let V=d;V<x;V++)C.set(V,e.atRowCol($,V)/a);for(let V=d;V<w;V++){l=0;for(let H=d;H<x;H++)l+=e.atRowCol(V,H)*e.atRowCol($,H);for(let H=d;H<x;H++)e.setRowCol(V,H,e.atRowCol(V,H)+l*C.at(H))}for(let V=d;V<x;V++)e.setRowCol($,V,e.atRowCol($,V)*_)}}const B=Math.abs(i.at($))+Math.abs(C.at($));v=B>v?B:v}for(let $=x-1;$>=0;$--){if($<x-1){if(f){for(let B=d;B<x;B++)s.setRowCol(B,$,e.atRowCol($,B)/e.atRowCol($,d)/f);for(let B=d;B<x;B++){l=0;for(let V=d;V<x;V++)l+=e.atRowCol($,V)*s.atRowCol(V,B);for(let V=d;V<x;V++)s.setRowCol(V,B,s.atRowCol(V,B)+l*s.atRowCol(V,$))}}for(let B=d;B<x;B++)s.setRowCol($,B,0),s.setRowCol(B,$,0)}s.setRowCol($,$,1),f=C.at($),d=$}for(let $=(w<x?w:x)-1;$>=0;$--){d=$+1,f=i.at($);for(let B=d;B<x;B++)e.setRowCol($,B,0);if(f){f=1/f;for(let B=d;B<x;B++){l=0;for(let V=d;V<w;V++)l+=e.atRowCol(V,$)*e.atRowCol(V,B);o=l/e.atRowCol($,$)*f;for(let V=$;V<w;V++)e.setRowCol(V,B,e.atRowCol(V,B)+o*e.atRowCol(V,$))}for(let B=$;B<w;B++)e.setRowCol(B,$,e.atRowCol(B,$)*f)}else for(let B=$;B<w;B++)e.setRowCol(B,$,0);e.setRowCol($,$,e.atRowCol($,$)+1)}for(let $=x-1;$>=0;$--)for(let B=1;;B++){let V=1;for(d=$;d>=0;d--){if(m=d-1,Math.abs(C.at(d))+v===v){V=0;break}if(Math.abs(i.at(m))+v===v)break}if(V){r=0,l=1;for(let H=d;H<=$&&(o=l*C.at(H),C.set(H,C.at(H)*r),Math.abs(o)+v!==v);H++){f=i.at(H),a=A(o,f),i.set(H,a),a=1/a,r=f*a,l=-o*a;for(let Y=0;Y<w;Y++)c=e.atRowCol(Y,m),h=e.atRowCol(Y,H),e.setRowCol(Y,m,c*r+h*l),e.setRowCol(Y,H,h*r-c*l)}}if(h=i.at($),d===$){if(h<0){i.set($,-h);for(let H=0;H<x;H++)s.setRowCol(H,$,-s.atRowCol(H,$))}break}if(B===100)return!1;u=i.at(d),m=$-1,c=i.at(m),f=C.at(m),a=C.at($),o=((c-h)*(c+h)+(f-a)*(f+a))/(2*a*c),f=A(o,1),o=((u-h)*(u+h)+a*(c/(o+M(f,o))-a))/u,r=l=1;for(let H=d;H<=m;H++){const Y=H+1;f=C.at(Y),c=i.at(Y),a=l*f,f*=r,h=A(o,a),C.set(H,h),r=o/h,l=a/h,o=u*r+f*l,f=f*r-u*l,a=c*l,c*=r;for(let W=0;W<x;W++)u=s.atRowCol(W,H),h=s.atRowCol(W,Y),s.setRowCol(W,H,u*r+h*l),s.setRowCol(W,Y,h*r-u*l);h=A(o,a),i.set(H,h),h&&(h=1/h,r=o*h,l=a*h),o=r*f+l*c,u=r*c-l*f;for(let W=0;W<w;W++)c=e.atRowCol(W,H),h=e.atRowCol(W,Y),e.setRowCol(W,H,c*r+h*l),e.setRowCol(W,Y,h*r-c*l)}C.set(d,0),C.set($,o),i.set($,u)}const I=new Float64Array(this.N),L=new Float64Array(this.M),D=new Or(I,this.N,1),O=new Or(L,this.M,1);let U=1;do U*=3,U++;while(U<=this.M);do{U/=3,U=Math.trunc(U);for(let $=U;$<this.M;$++){const B=i.at($);for(let H=0;H<this.N;H++)D.set(H,e.atRowCol(H,$));for(let H=0;H<this.M;H++)O.set(H,s.atRowCol(H,$));let V=$;for(;i.at(V-U)<B;){i.set(V,i.at(V-U));for(let H=0;H<this.N;H++)e.setRowCol(H,V,e.atRowCol(H,V-U));for(let H=0;H<this.M;H++)s.setRowCol(H,V,s.atRowCol(H,V-U));if(V-=U,V<U)break}i.set(V,B);for(let H=0;H<this.N;H++)e.setRowCol(H,V,D.at(H));for(let H=0;H<this.M;H++)s.setRowCol(H,V,O.at(H))}}while(U>1);for(let $=0;$<this.M;$++){let B=0;for(let V=0;V<this.N;V++)e.atRowCol(V,$)<0&&B++;for(let V=0;V<this.M;V++)s.atRowCol(V,$)<0&&B++;if(B>Math.trunc((this.N+this.M)/2)){for(let V=0;V<this.N;V++)e.setRowCol(V,$,-e.atRowCol(V,$));for(let V=0;V<this.M;V++)s.setRowCol(V,$,-s.atRowCol(V,$))}}return!0}isSymmetric(){if(this.N!==this.M)return!1;for(let e=0;e<this.N;e++)for(let i=e+1;i<this.M;i++)if(this.atRowCol(e,i)!==this.atRowCol(i,e))return!1;return!0}isZero(){return z(0),!1}isIdentity(){return z(0),!1}equals(e,i){if(i!==void 0&&z(0),this.N!==e.N||this.M!==e.M)return!1;for(let s=0;s<this.N*this.M;s++)if(this.data[s]!==e.data[s])return!1;return!0}maxElement(){return z(0),0}minElement(){return z(0),0}determinant(){if(z(this.N===this.M),this.N===1)return this.data[0];if(this.N===2)return this.data[0]*this.data[3]-this.data[1]*this.data[2];if(this.N===3){const r=this;return r.atRowCol(0,0)*(r.atRowCol(1,1)*r.atRowCol(2,2)-r.atRowCol(1,2)*r.atRowCol(2,1))-r.atRowCol(0,1)*(r.atRowCol(1,0)*r.atRowCol(2,2)-r.atRowCol(2,0)*r.atRowCol(1,2))+r.atRowCol(0,2)*(r.atRowCol(1,0)*r.atRowCol(2,1)-r.atRowCol(1,1)*r.atRowCol(2,0))}const e=new Float64Array(this.N*this.N),i=new Or(e,this.N,this.N),s=new Float64Array(this.N);if(!this.luDecomposition(i,s))return 0;let n=1;for(let r=0;r<this.N;r++)n*=i.atRowCol(r,r),s[r]!==r&&(n=-n);return n}submatrix(e,i,s){z(0)}inverse(e){z(0)}pseudoInverse(e,i=!1,s=2220446049250313e-31){if(e.setZero(),this.N===1&&this.M===1)return this.atRowCol(0,0)!==0?e.setRowCol(0,0,1/this.atRowCol(0,0)):e.setRowCol(0,0,0),!0;if(this.N===2&&this.M===2){const d=this.atRowCol(0,0)*this.atRowCol(1,1)-this.atRowCol(0,1)*this.atRowCol(1,0),m=1e-5*(Math.abs(this.atRowCol(0,0)*this.atRowCol(1,1))+Math.abs(this.atRowCol(0,1)*this.atRowCol(1,0)));if(Math.abs(d)>m)return e.setRowCol(0,0,this.atRowCol(1,1)/d),e.setRowCol(0,1,-this.atRowCol(0,1)/d),e.setRowCol(1,0,-this.atRowCol(1,0)/d),e.setRowCol(1,1,this.atRowCol(0,0)/d),!0}const n=new Float64Array(this.N*this.M),r=new Or(n,this.N,this.M),o=new Float64Array(this.M),a=new Or(o,this.M,1),l=new Float64Array(this.M*this.M),u=new Or(l,this.M,this.M);if(!this.svd(r,a,u,i))return!1;const c=Math.max(this.N,this.M),h=s*Math.abs(a.at(0))*c;for(let d=0;d<this.M;d++)a.at(d)>h?a.set(d,1/a.at(d)):a.set(d,0);return u.mulDiag(a,e),e.mulTranspose(r,e),!0}luDecomposition(e,i){return z(0),!1}symmetricEigen(e,i){z(this.rows()===this.cols()),z(this.rows()===e.rows()),z(i.rows()===i.cols()&&i.rows()===this.rows()),z(this.isSymmetric());const s=new Float64Array(this.N*this.M),n=new Or(s,this.N,this.M);n.assignCopy(this);const r=100/Number.EPSILON,o=this.rows(),a=new Float64Array(o),l=new Float64Array(o),u=new Or(a,o,1),c=new Or(l,o,1);for(let d=0;d<o;d++)u.set(d,n.atRowCol(d,d)),e.set(d,n.atRowCol(d,d)),c.set(d,0);i.setIdentity();const h=()=>{const d=u;i.transposeInPlace();let m=1;do m*=3,m++;while(m<=o);do{m/=3,m=Math.trunc(m);for(let f=m;f<o;f++){const _=e.at(f),v=Math.abs(_);for(let w=0;w<this.M;w++)d.set(w,i.atRowCol(w,f));let x=f;for(;Math.abs(e.at(x-m))<v;){e.set(x,e.at(x-m));for(let w=0;w<this.M;w++)i.setRowCol(w,x,i.atRowCol(w,x-m));if(x-=m,x<m)break}if(x!==f){e.set(x,_);for(let w=0;w<this.M;w++)i.setRowCol(w,x,d.at(w))}}}while(m>1)};for(let d=1;;d++){let m=0;for(let _=1;_<o;_++)for(let v=0;v<_;v++)m+=Math.abs(n.atRowCol(_,v));if(m===0)return h(),!0;const f=d<4?.2*m/(o*o):0;for(let _=0;_<o;_++)for(let v=_+1;v<o;v++){let x=r*Math.abs(n.atRowCol(v,_));if(d>4&&x<=Math.abs(e.at(_))&&x<=Math.abs(e.at(v)))n.setRowCol(v,_,0);else if(Math.abs(n.atRowCol(v,_))>f){let w,T=e.at(v)-e.at(_);if(x<Math.abs(T))w=n.atRowCol(v,_)/T;else{const L=.5*T/n.atRowCol(v,_);w=1/(Math.abs(L)+Math.sqrt(1+L*L)),L<0&&(w=-w)}const C=1/Math.sqrt(1+w*w),M=w*C,A=M/(1+C);T=w*n.atRowCol(v,_),c.set(_,c.at(_)-T),c.set(v,c.at(v)+T),e.set(_,e.at(_)-T),e.set(v,e.at(v)+T),n.setRowCol(v,_,0);let I=0;for(;I<_;I++)x=n.atRowCol(_,I),T=n.atRowCol(v,I),n.setRowCol(_,I,x-M*(T+x*A)),n.setRowCol(v,I,T+M*(x-T*A));for(I++;I<v;I++)x=n.atRowCol(I,_),T=n.atRowCol(v,I),n.setRowCol(I,_,x-M*(T+x*A)),n.setRowCol(v,I,T+M*(x-T*A));for(I++;I<o;I++)x=n.atRowCol(I,_),T=n.atRowCol(I,v),n.setRowCol(I,_,x-M*(T+x*A)),n.setRowCol(I,v,T+M*(x-T*A));for(I=0;I<o;I++)x=i.atRowCol(_,I),T=i.atRowCol(v,I),i.setRowCol(_,I,x-M*(T+x*A)),i.setRowCol(v,I,T+M*(x-T*A))}}for(let _=0;_<o;_++)u.set(_,u.at(_)+c.at(_)),e.set(_,u.at(_)),c.set(_,0)}}static checkDims(e,i,s){z(e.rows()===i&&e.cols()===s)}},mf=class extends R3e{constructor(e){if(e.copy){const s=new Float64Array(e.copy.N*e.copy.M);return super(s,e.copy.N,e.copy.M),this.buffer=s,void this.assignCopy(e.copy)}const i=new Float64Array(e.NN*e.MM);super(i,e.NN,e.MM),this.buffer=i,e.initializerList&&Qs(this.buffer,e.initializerList,0,0,e.initializerList.length)}assignCopy(e){return this===e||super.assignCopy(e),this}},Gi=class h_{constructor(e){this.m_TransformationType=1,e===void 0?this.setIdentity():e instanceof h_?this.set(e):this.setScale(e)}set(e){return this.xx=e.xx,this.xy=e.xy,this.xd=e.xd,this.yx=e.yx,this.yy=e.yy,this.yd=e.yd,this}clone(){return new h_().set(this)}setZero(){this.xx=0,this.yy=0,this.xy=0,this.yx=0,this.xd=0,this.yd=0}isEqual(e){return this===e||this.xx===e.xx&&this.xy===e.xy&&this.xd===e.xd&&this.yx===e.yx&&this.yy===e.yy&&this.yd===e.yd}transformInPlace(e){const i=this.xx*e.x+this.xy*e.y+this.xd,s=this.yx*e.x+this.yy*e.y+this.yd;e.x=i,e.y=s}transform(e){const i=e.clone();return this.transformInPlace(i),i}queryTransform(e,i){const s=this.xx*e.x+this.xy*e.y+this.xd,n=this.yx*e.x+this.yy*e.y+this.yd;i.setCoords(s,n)}transformEnvInPlace(e){if(e.isEmpty())return;const i=he(N,4);e.queryCorners(i),this.transformPoints2D(i,4,i),e.setFromPoints(i,4)}queryTransformEnv(e,i){z(0)}transformPoints2D(e,i,s){for(let n=0;n<i;++n)this.queryTransform(e[n],s[n])}transformInterleavedPoints(e,i,s){i*=2;const n=N.getNAN();for(let r=0;r<i;r+=2)n.x=e[r],n.y=e[r+1],this.transformInPlace(n),s[r]=n.x,s[r+1]=n.y}multiply(e){return h_.st_multiply(this,e,this),this}mulLeft(e){return z(0),this}static st_multiply(e,i,s){const n=e.xx*i.xx+e.yx*i.xy,r=e.xy*i.xx+e.yy*i.xy,o=e.xd*i.xx+e.yd*i.xy+i.xd,a=e.xx*i.yx+e.yx*i.yy,l=e.xy*i.yx+e.yy*i.yy,u=e.xd*i.yx+e.yd*i.yy+i.yd;s.xx=n,s.xy=r,s.xd=o,s.yx=a,s.yy=l,s.yd=u}getCoefficients(e){z(e.length>=6),e[0]=this.xx,e[1]=this.xy,e[2]=this.xd,e[3]=this.yx,e[4]=this.yy,e[5]=this.yd}setCoefficients(e){z(e.length>=6),this.xx=e[0],this.xy=e[1],this.xd=e[2],this.yx=e[3],this.yy=e[4],this.yd=e[5]}copyTo(e){z(0)}initializeFromRect(e,i){e.isEmpty()||i.isEmpty()||!e.width()||!e.height()?this.setZero():(this.xy=this.yx=0,this.xx=i.width()/e.width(),this.yy=i.height()/e.height(),this.xd=i.xmin-e.xmin*this.xx,this.yd=i.ymin-e.ymin*this.yy)}initializeFromRectIsotropic(e,i){if(e.isEmpty()||!e.width()||!e.height()||i.isEmpty())this.setZero();else{this.yx=0,this.xy=0,this.xx=i.width()/e.width(),this.yy=i.height()/e.height(),this.xx>this.yy?this.xx=this.yy:this.yy=this.xx;const s=i.getCenter(),n=e.getCenter();this.xd=s.x-n.x*this.xx,this.yd=s.y-n.y*this.yy}}initializeFromTwoPointsArray(e,i){if(e[0].equals(i[0])&&e[1].equals(i[1]))return void this.setIdentity();if(e[0].equals(e[1])){if(i[0].equals(i[1]))return void this.setShift(i[0].sub(e[0]));ce("")}if(!e[0].equals(e[1])&&i[0].equals(i[1]))return this.setZero(),void this.shift(i[0]);this.setShiftCoords(-e[0].x,-e[0].y);const s=N.distance(e[0],e[1]),n=N.distance(i[0],i[1]),r=n/s;this.scale(r,r);const o=e[1].sub(e[0]);o.divThis(s);const a=i[1].sub(i[0]);a.divThis(n);const l=o.crossProduct(a),u=o.dotProduct(a);this.rotate(u,l),this.shiftCoords(i[0].x,i[0].y)}initializeFromTwoPoints(e,i,s,n){const r=[e,i],o=[s,n];this.initializeFromTwoPointsArray(r,o)}transformSizeInPlace(e){z(0)}transformSize(e,i){z(0)}transformTol(e){return z(0),0}transformWithoutTranslateArray(e,i,s){for(let n=0;n<i;++n)this.transformWithoutTranslate(e[n],s[n])}transformWithoutTranslateInPlace(e){const i=this.xx*e.x+this.xy*e.y,s=this.yx*e.x+this.yy*e.y;e.setCoords(i,s)}transformWithoutTranslate(e,i){const s=this.xx*e.x+this.xy*e.y,n=this.yx*e.x+this.yy*e.y;i.setCoords(s,n)}setIdentity(){this.xx=1,this.xy=0,this.xd=0,this.yx=0,this.yy=1,this.yd=0}isIdentity(){return!(this.xx!==1||this.yy!==1||this.xy||this.xd||this.yx||this.yd)}isIdentityTol(e){const i=e*e;return!(Di(this.xd)+Di(this.yd)>i)&&!(Di(this.xy+this.xd)+Di(this.yy+this.yd-1)>i)&&!(Di(this.xx+this.xd-1)+Di(this.yx+this.yd)>i)}isReflective(){return this.xx*this.yy-this.yx*this.xy<0}isUniform(e){const i=this.xx*this.xx+this.yx*this.yx,s=this.xy*this.xy+this.yy*this.yy,n=(i+s)*e;return Math.abs(i-s)<=n&&Math.abs(this.xx*this.xy+this.yx*this.yy)<=n}isUniformNoRotation(){return this.xx!==0&&Math.abs(this.xx)===Math.abs(this.yy)&&this.xy===0&&this.yx===0}isTranslate(){return this.xx===1&&this.yy===1&&!this.xy&&!this.yx}isTranslateTol(e){const i=new N;return i.setCoords(0,1),this.transformWithoutTranslateInPlace(i),i.y-=1,!(i.sqrLength()>e*e)&&(i.setCoords(1,0),this.transformWithoutTranslateInPlace(i),i.x-=1,i.sqrLength()<=e*e)}isOrthonormal(e){const i=new h_;return i.xx=this.xx*this.xx+this.xy*this.xy,i.xy=this.xx*this.yx+this.xy*this.yy,i.yx=this.yx*this.xx+this.yy*this.xy,i.yy=this.yx*this.yx+this.yy*this.yy,i.xd=0,i.yd=0,i.isIdentityTol(e)}isDegenerate(e){return Math.abs(this.xx*this.yy-this.yx*this.xy)<=2*e*(Math.abs(this.xx*this.yy)+Math.abs(this.yx*this.xy))}isZero(){return this.xx===0&&this.yy===0&&this.xy===0&&this.yx===0&&this.xd===0&&this.yd===0}isScaleAndTranslateTol(e){return this.xy*this.xy+this.yx*this.yx<=(this.xx*this.xx+this.yy*this.yy)*e}setTranslate(e,i){return this.xx=1,this.xy=0,this.xd=e,this.yx=0,this.yy=1,this.yd=i,this}setShiftCoords(e,i){return this.xx=1,this.xy=0,this.xd=e,this.yx=0,this.yy=1,this.yd=i,this}setShift(e){return this.xx=1,this.xy=0,this.xd=e.x,this.yx=0,this.yy=1,this.yd=e.y,this}setScaleCoords(e,i){return this.xx=e,this.xy=0,this.xd=0,this.yx=0,this.yy=i,this.yd=0,this}setScale(e){return this.setScaleCoords(e,e),this}setFlipX(e,i){return this.xx=-1,this.xy=0,this.xd=e+i,this.yx=0,this.yy=1,this.yd=0,this}setFlipY(e,i){return this.xx=1,this.xy=0,this.xd=0,this.yx=0,this.yy=-1,this.yd=e+i,this}setShear(e,i){return this.xx=1,this.xy=e,this.xd=0,this.yx=i,this.yy=1,this.yd=0,this}scale(e,i){return this.xx*=e,this.xy*=e,this.xd*=e,this.yx*=i,this.yy*=i,this.yd*=i,this}setRotateAngle(e){return this.setRotate(Math.cos(e),Math.sin(e))}setRotate(e,i){return this.xx=e,this.xy=-i,this.xd=0,this.yx=i,this.yy=e,this.yd=0,this}setRotateAngleAbout(e,i){return this.setRotateAbout(Math.cos(e),Math.sin(e),i)}setRotateAbout(e,i,s){return this.setTranslate(-s.x,-s.y),this.rotate(e,i),this.translate(s.x,s.y)}setSwapCoordinates(){return this.xx=0,this.xy=1,this.xd=0,this.yx=1,this.yy=0,this.yd=0,this}setRotateCw90(){return this.xx=0,this.xy=1,this.xd=0,this.yx=-1,this.yy=0,this.yd=0,this}setRotateCcw90(){return this.xx=0,this.xy=-1,this.xd=0,this.yx=1,this.yy=0,this.yd=0,this}shiftCoords(e,i){return this.xd+=e,this.yd+=i,this}shift(e){return this.xd+=e.x,this.yd+=e.y,this}translate(e,i){return this.xd+=e,this.yd+=i,this}flipX(e,i){return this.xx=-this.xx,this.xy=-this.xy,this.xd=e+i-this.xd,this}flipY(e,i){return this.yx=-this.yx,this.yy=-this.yy,this.yd=e+i-this.yd,this}shear(e,i){const s=new h_;return s.setShear(e,i),this.multiply(s)}rotateAngle(e){const i=new h_;return i.setRotateAngle(e),this.multiply(i)}rotate(e,i){const s=new h_;return s.setRotate(e,i),this.multiply(s)}rotateAbout(e,i,s){return this.translate(-s.x,-s.y),this.rotate(e,i),this.translate(s.x,s.y)}rotateAngleAbout(e,i){return this.rotateAbout(Math.cos(e),Math.sin(e),i)}setInvert(e){return this.set(e),this.invertThis()}invertThis(){let e=this.xx*this.yy-this.xy*this.yx;if(e===0)return this.setZero(),this;e=1/e;const i=(this.xy*this.yd-this.xd*this.yy)*e,s=(this.xd*this.yx-this.xx*this.yd)*e,n=this.yy*e,r=-this.xy*e,o=-this.yx*e,a=this.xx*e;return this.xd=i,this.yd=s,this.xx=n,this.yy=a,this.xy=r,this.yx=o,this}invertPrecise(e){return this.set(e),this.invertPreciseThis()}invertPreciseThis(){const e=nt.constructDouble(this.xy),i=nt.constructDouble(this.xx),s=i.mulDouble(this.yy).sub(e.mulDouble(this.yx));if(s.isZero())return this.setZero(),this;const n=s.clone();n.invertThis();const r=nt.constructDouble(this.xd),o=e.mulDouble(this.yd).sub(r.mulDouble(this.yy)).mul(n).toDouble(),a=r.mulDouble(this.yx).sub(i.mulDouble(this.yd)).mul(n).toDouble(),l=n.mulDouble(this.yy).toDouble(),u=n.mulDouble(-this.xy).toDouble(),c=n.mulDouble(-this.yx).toDouble(),h=n.mulDouble(this.xx).toDouble();return this.xd=o,this.yd=a,this.xx=l,this.yy=h,this.xy=u,this.yx=c,this}extractScaleTransform(e,i){const s=Math.sqrt(this.xx*this.xx+this.xy*this.xy),n=Math.sqrt(this.yx*this.yx+this.yy*this.yy);i.setScaleCoords(1/s,1/n),i.multiply(this),e.setScaleCoords(s,n)}setFromTwoTriangles(e,i){let s=!0;for(let c=0;c<3;++c)s=s&&e[c].equals(i[c]);if(s)return this.setIdentity(),!0;const n=new N;n.setSub(e[0],e[1]);const r=new N;r.setSub(e[0],e[2]);const o=new N;o.setSub(i[0],i[1]);const a=new N;a.setSub(i[0],i[2]);const l=4*Number.EPSILON*(Math.abs(n.x*r.y)+Math.abs(r.x*n.y));let u=n.x*r.y-n.y*r.x;return Math.abs(u)>l?(u=1/u,this.xx=(o.x*r.y-n.y*a.x)*u,this.xy=(n.x*a.x-o.x*r.x)*u,this.yx=(o.y*r.y-n.y*a.y)*u,this.yy=(n.x*a.y-o.y*r.x)*u,this.xd=i[0].x-(this.xx*e[0].x+this.xy*e[0].y),this.yd=i[0].y-(this.yx*e[0].x+this.yy*e[0].y),!0):(this.setZero(),!1)}initializeFromControlPoints(e,i,s,n,r=null){return i===0?(this.setIdentity(),void(r&&r.setIdentity())):i===1?(this.setShift(n[0].sub(s[0])),void(r&&r.setShift(s[0].sub(n[0])))):(i<3&&(e=1),void(e===4&&i>2?O3e(this,i,s,n,r):L3e(e,this,i,s,n,r)))}calculateErrors(e,i,s,n){z(e>0&&i!==null&&s!==null);let r=0;for(let o=0;o<e;++o){const a=this.transform(i[o]),l=N.sqrDistance(s[o],a);r+=l,n&&(n[o]=Math.sqrt(l))}return Math.sqrt(r/e)}};const R2=[43,11,41,9,61];function vG(t,e){z(!(e.rows()!==2&&e.rows()!==3||e.cols()!==2&&e.rows()!==3)),t.xx=e.atRowCol(0,0),t.xy=e.atRowCol(0,1),t.yx=e.atRowCol(1,0),t.yy=e.atRowCol(1,1),e.cols()===3?(t.xd=e.atRowCol(0,2),t.yd=e.atRowCol(1,2)):(t.xd=0,t.yd=0)}function O3e(t,e,i,s,n){const r=N.average(i,e),o=N.average(s,e),a=new mf({NN:2,MM:2});a.setZero();const l=new mf({NN:2,MM:2});l.setZero();for(let h=0;h<e;++h)a.setRowCol(0,0,a.atRowCol(0,0)+(i[h].x-r.x)*(i[h].x-r.x)),a.setRowCol(0,1,a.atRowCol(0,1)+(i[h].x-r.x)*(i[h].y-r.y)),a.setRowCol(1,1,a.atRowCol(1,1)+(i[h].y-r.y)*(i[h].y-r.y)),l.setRowCol(0,0,l.atRowCol(0,0)+(s[h].x-o.x)*(i[h].x-r.x)),l.setRowCol(0,1,l.atRowCol(0,1)+(s[h].x-o.x)*(i[h].y-r.y)),l.setRowCol(1,0,l.atRowCol(1,0)+(s[h].y-o.y)*(i[h].x-r.x)),l.setRowCol(1,1,l.atRowCol(1,1)+(s[h].y-o.y)*(i[h].y-r.y));a.setRowCol(1,0,a.atRowCol(0,1));const u=new mf({NN:2,MM:2});a.pseudoInverse(u,!0)||hG("Failed to compute pseudo inverse"),l.mul(u,l),vG(t,l);const c=r.clone();t.transformInPlace(c),t.xd=o.x-c.x,t.yd=o.y-c.y,n&&(l.pseudoInverse(u,!1)||hG("Failed to compute pseudo inverse"),vG(n,u),n.transformInPlace(o),n.xd=r.x-o.x,n.yd=r.y-o.y)}function L3e(t,e,i,s,n,r){z(t===1||t===0||t===2||t===3),e.setIdentity();const o=N.average(s,i),a=N.average(n,i);if(z(t<R2.length&&t>0),8&R2[t]){const u=new mf({NN:2,MM:2});u.setZero();for(let v=0;v<i;++v)u.setRowCol(0,0,u.atRowCol(0,0)+(n[v].x-a.x)*(s[v].x-o.x)),u.setRowCol(1,0,u.atRowCol(1,0)+(n[v].x-a.x)*(s[v].y-o.y)),u.setRowCol(0,1,u.atRowCol(0,1)+(n[v].y-a.y)*(s[v].x-o.x)),u.setRowCol(1,1,u.atRowCol(1,1)+(n[v].y-a.y)*(s[v].y-o.y));const c=new mf({NN:2,MM:2}),h=new mf({NN:2,MM:1}),d=new mf({NN:2,MM:2});u.svd(c,h,d)||hG("Failed to compute svd");const m=new mf({NN:2,MM:2});c.transpose(m);const f=new mf({NN:2,MM:2});d.mul(m,f),!(32&R2[t])&&f.determinant()<0&&(m.setRowCol(1,0,-m.atRowCol(1,0)),m.setRowCol(1,1,-m.atRowCol(1,1)),d.mul(m,f));const _=new Gi;vG(_,f),e.set(_)}if(2&R2[t]){let u=0,c=0;for(let h=0;h<i;++h){const d=s[h].sub(o);u+=d.sqrLength(),e.transformInPlace(d),c+=d.dotProduct(n[h].sub(a))}if(u===0)c===0?e.setIdentity():e.setZero();else{const h=c/u;e.scale(h,h)}}else z(!(4&R2[t]));const l=o.clone();e.transformInPlace(l),e.xd=a.x-l.x,e.yd=a.y-l.y,r&&(r.set(e),r.invertThis(),r.isZero()&&(r.xd=o.x,r.yd=o.y))}const F3e={uniform:0,conformal:1,rigid:2,"rigid-motion":3,general:4},AD=t=>t.map(e=>new N(e.x,e.y));let iL=class{constructor(){this.transform=new Gi}calculateErrors(e,i){const s=e.length,n=i.length;if(s!==n)throw new Error(`The input length (${s}) is not the same as output length (${n})`);const r=[];return{rms:this.transform.calculateErrors(s,AD(e),AD(i),r),errorsOut:r}}flipX(e,i){return this.transform.flipX(e,i),this}flipY(e,i){return this.transform.flipY(e,i),this}initializeFromControlPoints(e,i,s,n){const r=i.length,o=s.length;if(r!==o)throw new Error(`The input length (${r}) is not the same as output length (${o})`);this.transform.initializeFromControlPoints(F3e[e],r,AD(i),AD(s),n==null?void 0:n.transform)}isIdentity(){return this.transform.isIdentity()}rotate(e,i,s){const n=qM(e);return i!=null&&s!=null?this.transform.rotateAngleAbout(n,new N(i,s)):this.transform.rotateAngle(n),this}scale(e,i){return this.transform.scale(e,i),this}setIdentity(){this.transform.setIdentity()}setSwapCoordinates(){return this.transform.setSwapCoordinates(),this}shear(e,i){return this.transform.shear(e,i),this}shift(e,i){return this.transform.shiftCoords(e,i),this}};const Oyt=Object.freeze(Object.defineProperty({__proto__:null,default:iL},Symbol.toStringTag,{value:"Module"}));let Pd=class{*[Symbol.iterator](){let e=this.next();for(;e;)yield e,e=this.next()}},zm=class extends Pd{constructor(e){super(),this.m_iGeom=-1,this.m_aGeoms=e?e.slice():[]}next(){if(this.m_iGeom<this.m_aGeoms.length-1){const e=this.m_aGeoms[++this.m_iGeom];return this.m_aGeoms[this.m_iGeom]=null,e}return null}tock(){return!1}getGeometryID(){return this.m_iGeom}getRank(){return 1}},k3e=class{getOperatorType(){return 10303}supportsCurves(){return!0}accelerateGeometry(e,i,s){return!1}canAccelerateGeometry(e){return!1}executeMany(e,i,s){return new $3e(e,i,s)}execute(e,i,s){const n=e.clone();return n.applyTransformation(i),n}},$3e=class extends Pd{constructor(e,i,s){super(),this.m_index=-1,this.m_transformation=i.clone(),this.m_inputGeometryCursor=e}next(){let e;if(e=this.m_inputGeometryCursor.next()){Um(e),this.m_index=this.m_inputGeometryCursor.getGeometryID();const i=e.clone();return i.applyTransformation(this.m_transformation),i}return null}getGeometryID(){return this.m_index}tock(){return!0}getRank(){return 1}};const I7=new k3e;function U3e(t,e){return I7.execute(t,e,null)}function V3e(t,e){const i=I7.executeMany(new zm(t),e,null);return Array.from(i)}function z3e(){return I7.supportsCurves()}let J=class Ya{static construct(e,i,s,n){return new Ya(e,i,s,n)}constructor(e,i,s,n){this.m_EnvelopeType=2,e===void 0?(this.xmin=Number.NaN,this.ymin=Number.NaN,this.xmax=Number.NaN,this.ymax=Number.NaN):typeof e=="number"?(this.xmin=e,this.ymin=i,this.xmax=s,this.ymax=n):(this.xmin=e.xmin,this.ymin=e.ymin,this.xmax=e.xmax,this.ymax=e.ymax),this.normalize()}static constructEmpty(){return new Ya(Number.NaN,Number.NaN,Number.NaN,Number.NaN)}clone(){return new Ya(this)}assign(e){return this.xmin=e.xmin,this.xmax=e.xmax,this.ymin=e.ymin,this.ymax=e.ymax,this}width(){return this.xmax-this.xmin}height(){return this.ymax-this.ymin}maxDimension(){return Math.max(this.width(),this.height())}minDimension(){return Math.min(this.width(),this.height())}sqrDiagonal(){const e=this.width(),i=this.height();return e*e+i*i}diagonal(){return Math.sqrt(this.sqrDiagonal())}getCenterX(){return .5*(this.xmin+this.xmax)}getCenterY(){return .5*(this.ymin+this.ymax)}getCenter(){return N.construct(this.getCenterX(),this.getCenterY())}queryCenter(e){e.x=.5*(this.xmin+this.xmax),e.y=.5*(this.ymin+this.ymax)}setEmpty(){this.xmin=Number.NaN,this.ymin=Number.NaN,this.xmax=Number.NaN,this.ymax=Number.NaN}setInfinite(){this.xmin=Number.NEGATIVE_INFINITY,this.xmax=Number.POSITIVE_INFINITY,this.ymin=Number.NEGATIVE_INFINITY,this.ymax=Number.POSITIVE_INFINITY}isDegenerate(e){return!this.isEmpty()&&(this.width()<=e||this.height()<=e)}isZero(){return!(this.isEmpty()||this.width()&&this.height())}isEmpty(){return Number.isNaN(this.xmin)||Number.isNaN(this.ymin)||Number.isNaN(this.xmax)||Number.isNaN(this.ymax)}mergeNeCoords(e,i){this.xmin>e?this.xmin=e:this.xmax<e&&(this.xmax=e),this.ymin>i?this.ymin=i:this.ymax<i&&(this.ymax=i)}mergeNe(e){this.mergeNeCoords(e.x,e.y)}mergeCoords(e,i){this.isEmpty()?(this.xmin=e,this.ymin=i,this.xmax=e,this.ymax=i):(this.xmin>e?this.xmin=e:this.xmax<e&&(this.xmax=e),this.ymin>i?this.ymin=i:this.ymax<i&&(this.ymax=i))}merge(e){this.mergeCoords(e.x,e.y)}mergeEnvelope2D(e){e.isEmpty()||(this.mergeCoords(e.xmin,e.ymin),this.mergeNeCoords(e.xmax,e.ymax))}mergePoints(e,i){for(let s=0;s<i;){if(!this.isEmpty()){for(let n=s;n<i;n++)this.mergeNe(e[n]);break}this.setCoords(e[s]),s++}}mergePointsInterleaved(e,i,s){for(let n=2*i,r=n+2*s;n<r;n+=2)this.mergeCoords(e.read(n),e.read(n+1))}inflateCoords(e,i){this.isEmpty()||(this.xmin-=e,this.xmax+=e,this.ymin-=i,this.ymax+=i,(this.xmin>this.xmax||this.ymin>this.ymax)&&this.setEmpty())}getInflatedCoords(e,i){const s=this.clone();return s.inflateCoords(e,i),s}inflate(e){this.inflateCoords(e,e)}getInflated(e){const i=this.clone();return i.inflateCoords(e,e),i}zoom(e,i){this.isEmpty()||this.setCoords({center:this.getCenter(),width:e*this.width(),height:i*this.height()})}scale(e){e<0&&this.setEmpty(),this.xmin*=e,this.xmax*=e,this.ymin*=e,this.ymax*=e}equals(e,i){return!(!this.isEmpty()||!e.isEmpty())||(i?Math.abs(this.xmin-e.xmin)<=i&&Math.abs(this.ymin-e.ymin)<=i&&Math.abs(this.xmax-e.xmax)<=i&&Math.abs(this.ymax-e.ymax)<=i:this.xmin===e.xmin&&this.ymin===e.ymin&&this.xmax===e.xmax&&this.ymax===e.ymax)}setCoords(e){e.xmin!==void 0?(this.xmin=e.xmin,this.xmax=e.xmax,this.ymin=e.ymin,this.ymax=e.ymax):e.x!==void 0?(this.xmin=e.x,this.xmax=e.x,this.ymin=e.y,this.ymax=e.y):e.pt1!==void 0?(this.xmin=e.pt1.x,this.ymin=e.pt1.y,this.xmax=e.pt2.x,this.ymax=e.pt2.y,this.normalize()):e.env2D!==void 0?(this.xmin=e.env2D.xmin,this.xmax=e.env2D.xmax,this.ymin=e.env2D.ymin,this.ymax=e.env2D.ymax,this.normalize()):e.pt!==void 0?(this.xmin=e.pt.x,this.xmax=e.pt.x,this.ymin=e.pt.y,this.ymax=e.pt.y):e.center!==void 0?(this.xmin=e.center.x-.5*e.width,this.xmax=this.xmin+e.width,this.ymin=e.center.y-.5*e.height,this.ymax=this.ymin+e.height,this.normalize()):_i("unrecognized input type for setCoords"),this.normalize()}queryIntervalX(e){this.isEmpty()?e.setEmpty():e.setCoords(this.xmin,this.xmax)}queryIntervalY(e){this.isEmpty()?e.setEmpty():e.setCoords(this.ymin,this.ymax)}setFromPoints(e,i){if(i===0)return void this.setEmpty();if(Array.isArray(e)){const n=e;this.setCoords(n[0]);for(let r=1;r<i;){if(!this.isEmpty()){for(let o=r;o<i;o++)this.mergeNe(n[o]);return}this.setCoords(n[r]),r++}return}const s=e;this.setCoords({x:s[0],y:s[1]});for(let n=1,r=2*i;n<r;n+=2){if(!this.isEmpty()){for(let o=n,a=2*i;o<a;o+=2)this.mergeNeCoords(s[o],s[o+1]);return}this.setCoords({x:s[n],y:s[n+1]}),n+=2}}normalize(){let e=!1;this.xmin<=this.xmax||([this.xmin,this.xmax]=[this.xmax,this.xmin],e=!0),this.ymin<=this.ymax||([this.ymin,this.ymax]=[this.ymax,this.ymin],e=!0),!e||this.xmin<=this.xmax&&this.ymin<=this.ymax||this.setEmpty()}isValid(){return this.isEmpty()||this.xmin<=this.xmax&&this.ymin<=this.ymax}getLowerLeft(){return new N(this.xmin,this.ymin)}getLowerRight(){return new N(this.xmax,this.ymin)}getUpperLeft(){return new N(this.xmin,this.ymax)}getUpperRight(){return new N(this.xmax,this.ymax)}move(e,i){this.isEmpty()||(this.xmin+=e,this.ymin+=i,this.xmax+=e,this.ymax+=i)}centerAtCoords(e,i){this.move(e-this.getCenterX(),i-this.getCenterY())}centerAt(e){this.centerAtCoords(e.x,e.y)}containsCoords(e,i){return e>=this.xmin&&e<=this.xmax&&i>=this.ymin&&i<=this.ymax}contains(e){return this.containsCoords(e.x,e.y)}containsEnvelope(e){return e.xmin>=this.xmin&&e.xmax<=this.xmax&&e.ymin>=this.ymin&&e.ymax<=this.ymax}containsExclusiveCoords(e,i){return e>this.xmin&&e<this.xmax&&i>this.ymin&&i<this.ymax}containsExclusive(e){return this.containsExclusiveCoords(e.x,e.y)}containsExclusiveEnvelope(e){return e.xmin>this.xmin&&e.xmax<this.xmax&&e.ymin>this.ymin&&e.ymax<this.ymax}isIntersecting(e){return(this.xmin<=e.xmin?this.xmax>=e.xmin:e.xmax>=this.xmin)&&(this.ymin<=e.ymin?this.ymax>=e.ymin:e.ymax>=this.ymin)}isIntersectingNe(e){return(this.xmin<=e.xmin?this.xmax>=e.xmin:e.xmax>=this.xmin)&&(this.ymin<=e.ymin?this.ymax>=e.ymin:e.ymax>=this.ymin)}intersect(e){if(this.isEmpty())return!1;if(e.isEmpty())return this.setEmpty(),!1;e.xmin>this.xmin&&(this.xmin=e.xmin),e.xmax<this.xmax&&(this.xmax=e.xmax),e.ymin>this.ymin&&(this.ymin=e.ymin),e.ymax<this.ymax&&(this.ymax=e.ymax);const i=this.xmin<=this.xmax&&this.ymin<=this.ymax;return i||this.setEmpty(),i}queryCorner(e){switch(3&e){case 0:return new N(this.xmin,this.ymin);case 1:return new N(this.xmin,this.ymax);case 2:return new N(this.xmax,this.ymax);default:return new N(this.xmax,this.ymin)}}queryCorners(e){e[0].setCoords(this.xmin,this.ymin),e[1].setCoords(this.xmin,this.ymax),e[2].setCoords(this.xmax,this.ymax),e[3].setCoords(this.xmax,this.ymin)}queryCornersReversed(e){e[0].setCoords(this.xmin,this.ymin),e[1].setCoords(this.xmax,this.ymin),e[2].setCoords(this.xmax,this.ymax),e[3].setCoords(this.xmin,this.ymax)}reaspect(e,i){if(this.isEmpty())return;const s=e/i,n=.5*this.width(),r=.5*this.height()*s;if(n<=r){const o=this.getCenterX();this.xmin=o-r,this.xmax=o+r}else{const o=n/s,a=this.getCenterY();this.ymin=a-o,this.ymax=a+o}this.normalize()}getArea(){return this.isEmpty()?0:this.width()*this.height()}getLength(){return this.isEmpty()?0:2*(this.width()+this.height())}clipCode(e){return(e.x<this.xmin?1:0)|(e.x>this.xmax?1:0)<<1|(e.y<this.ymin?1:0)<<2|(e.y>this.ymax?1:0)<<3}clipLine(e,i){let s=this.clipCode(e),n=this.clipCode(i);if(s&n)return 0;if(!(s|n))return 4;const r=(s?1:0)|(n?2:0);do{const o=i.x-e.x,a=i.y-e.y;if(Math.abs(o)>Math.abs(a)?s&Ya.XMASK?(s&Ya.XLESSXMIN?(e.y+=a*(this.xmin-e.x)/o,e.x=this.xmin):(e.y+=a*(this.xmax-e.x)/o,e.x=this.xmax),s=this.clipCode(e)):n&Ya.XMASK?(n&Ya.XLESSXMIN?(i.y+=a*(this.xmin-i.x)/o,i.x=this.xmin):(i.y+=a*(this.xmax-i.x)/o,i.x=this.xmax),n=this.clipCode(i)):s?(s&Ya.YLESSYMIN?(e.x+=o*(this.ymin-e.y)/a,e.y=this.ymin):(e.x+=o*(this.ymax-e.y)/a,e.y=this.ymax),s=this.clipCode(e)):(n&Ya.YLESSYMIN?(i.x+=o*(this.ymin-i.y)/a,i.y=this.ymin):(i.x+=o*(this.ymax-i.y)/a,i.y=this.ymax),n=this.clipCode(i)):s&Ya.YMASK?(s&Ya.YLESSYMIN?(e.x+=o*(this.ymin-e.y)/a,e.y=this.ymin):(e.x+=o*(this.ymax-e.y)/a,e.y=this.ymax),s=this.clipCode(e)):n&Ya.YMASK?(n&Ya.YLESSYMIN?(i.x+=o*(this.ymin-i.y)/a,i.y=this.ymin):(i.x+=o*(this.ymax-i.y)/a,i.y=this.ymax),n=this.clipCode(i)):s?(s&Ya.XLESSXMIN?(e.y+=a*(this.xmin-e.x)/o,e.x=this.xmin):(e.y+=a*(this.xmax-e.x)/o,e.x=this.xmax),s=this.clipCode(e)):(n&Ya.XLESSXMIN?(i.y+=a*(this.xmin-i.x)/o,i.x=this.xmin):(i.y+=a*(this.xmax-i.x)/o,i.x=this.xmax),n=this.clipCode(i)),s&n)return 0}while(s|n);return r}distanceFromEnvelope(e){return Math.sqrt(this.sqrDistanceEnvelope(e,null,null))}distance(e){return Math.sqrt(this.sqrDistance(e))}sqrDistanceEnvelope(e,i,s){if(!i&&!s){if(this.isEmpty()||e.isEmpty())return Number.NaN;let u,c=0,h=0;return u=this.xmin-e.xmax,u>c&&(c=u),u=this.ymin-e.ymax,u>h&&(h=u),u=e.xmin-this.xmax,u>c&&(c=u),u=e.ymin-this.ymax,u>h&&(h=u),c*c+h*h}if(this.isEmpty()||e.isEmpty())return i&&i.setNAN(),s&&s.setNAN(),Number.NaN;let n,r=0,o=0;const a=Math.max(this.xmin,e.xmin),l=Math.max(this.ymin,e.ymin);return i&&i.setCoords(a,l),s&&s.setCoords(a,l),n=this.xmin-e.xmax,n>r&&(r=n,i&&(i.x=this.xmin),s&&(s.x=e.xmax)),n=this.ymin-e.ymax,n>o&&(o=n,i&&(i.y=this.ymin),s&&(s.y=e.ymax)),n=e.xmin-this.xmax,n>r&&(r=n,i&&(i.x=this.xmax),s&&(s.x=e.xmin)),n=e.ymin-this.ymax,n>o&&(o=n,i&&(i.y=this.ymax),s&&(s.y=e.ymin)),r*r+o*o}sqrDistance(e,i){if(i===void 0){if(this.isEmpty()||e.isNAN())return Number.NaN;let o,a=0,l=0;return o=this.xmin-e.x,o>a&&(a=o),o=this.ymin-e.y,o>l&&(l=o),o=e.x-this.xmax,o>a&&(a=o),o=e.y-this.ymax,o>l&&(l=o),a*a+l*l}if(this.isEmpty()||e.isNAN())return i.setNAN(),Number.NaN;i.assign(e);let s,n=0,r=0;return s=this.xmin-e.x,s>n&&(n=s,i.x=this.xmin),s=this.ymin-e.y,s>r&&(r=s,i.y=this.ymin),s=e.x-this.xmax,s>n&&(n=s,i.x=this.xmax),s=e.y-this.ymax,s>r&&(r=s,i.y=this.ymax),n*n+r*r}sqrMaxMinDistanceEnvelope(e){if(this.isEmpty()||e.isEmpty())return Number.NaN;let i=Number.MAX_VALUE;{const s=N.sqrDistanceCoords(this.xmin,this.ymin,e.xmax,e.ymin),n=N.sqrDistanceCoords(this.xmin,this.ymin,e.xmax,e.ymax),r=N.sqrDistanceCoords(this.xmin,this.ymax,e.xmax,e.ymin),o=N.sqrDistanceCoords(this.xmin,this.ymax,e.xmax,e.ymax),a=Math.max(s,n),l=Math.max(r,o),u=Math.max(a,l);i=Math.min(u,i)}{const s=N.sqrDistanceCoords(this.xmin,this.ymin,e.xmin,e.ymax),n=N.sqrDistanceCoords(this.xmin,this.ymin,e.xmax,e.ymax),r=N.sqrDistanceCoords(this.xmax,this.ymin,e.xmin,e.ymax),o=N.sqrDistanceCoords(this.xmax,this.ymin,e.xmax,e.ymax),a=Math.max(s,n),l=Math.max(r,o),u=Math.max(a,l);i=Math.min(u,i)}{const s=N.sqrDistanceCoords(this.xmax,this.ymin,e.xmin,e.ymin),n=N.sqrDistanceCoords(this.xmax,this.ymin,e.xmin,e.ymax),r=N.sqrDistanceCoords(this.xmax,this.ymax,e.xmin,e.ymin),o=N.sqrDistanceCoords(this.xmax,this.ymax,e.xmin,e.ymax),a=Math.max(s,n),l=Math.max(r,o),u=Math.max(a,l);i=Math.min(u,i)}{const s=N.sqrDistanceCoords(this.xmin,this.ymax,e.xmin,e.ymin),n=N.sqrDistanceCoords(this.xmin,this.ymax,e.xmax,e.ymin),r=N.sqrDistanceCoords(this.xmax,this.ymax,e.xmin,e.ymin),o=N.sqrDistanceCoords(this.xmax,this.ymax,e.xmax,e.ymin),a=Math.max(s,n),l=Math.max(r,o),u=Math.max(a,l);i=Math.min(u,i)}return i}sqrMaxDistanceEnvelope(e){if(this.isEmpty()||e.isEmpty())return Number.NaN;let i=0;const s=he(N,4);this.queryCorners(s);const n=he(N,4);e.queryCorners(n);for(let r=0;r<4;r++)for(let o=0;o<4;o++){const a=N.sqrDistance(s[r],n[o]);a>i&&(i=a)}return i}sqrMaxMinDistance(e){const i=N.sqrDistance(e,this.getLowerLeft()),s=N.sqrDistance(e,this.getUpperLeft()),n=N.sqrDistance(e,this.getLowerRight()),r=N.sqrDistance(e,this.getUpperRight());let o,a=Math.max(i,s);return o=Math.max(i,n),a>o&&(a=o),o=Math.max(s,r),a>o&&(a=o),o=Math.max(n,r),a>o&&(a=o),a}sqrMinDistance(e){return this.contains(e)?0:this.sqrDistance(e)}sqrMaxDistance(e){let i=N.sqrDistance(e,this.getLowerLeft());return i=Math.max(N.sqrDistance(e,this.getUpperLeft()),i),i=Math.max(N.sqrDistance(e,this.getUpperRight()),i),i=Math.max(N.sqrDistance(e,this.getLowerRight()),i),i}snapToBoundary(e){if(e.isNAN())return!1;if(this.isEmpty())return e.setNAN(),!0;let i=!0;if(e.x<this.xmin?e.x=this.xmin:e.x>this.xmax?e.x=this.xmax:i=!1,e.y<this.ymin?e.y=this.ymin:e.y>this.ymax?e.y=this.ymax:i=!1,i)return!0;if(e.x===this.xmin||e.x===this.xmax||e.y===this.ymin||e.y===this.ymax)return!1;const s=this.xmax-e.x,n=e.x-this.xmin,r=this.ymax-e.y,o=e.y-this.ymin;return Math.max(s,n)>Math.max(r,o)?e.y=o<r?this.ymin:this.ymax:e.x=n<s?this.xmin:this.xmax,!0}snapClip(e){const i=Os(e.x,this.xmin,this.xmax),s=Os(e.y,this.ymin,this.ymax);return N.construct(i,s)}boundaryDistance(e){if(this.isEmpty()||e.isNAN())return Number.NaN;if(e.x===this.xmin)return e.y-this.ymin;const i=this.ymax-this.ymin,s=this.xmax-this.xmin;if(e.y===this.ymax)return i+e.x-this.xmin;if(e.x===this.xmax)return i+s+this.ymax-e.y;if(e.y===this.ymin)return 2*i+s+this.xmax-e.x;const n=new N;return n.setCoordsPoint2D(e),this.snapToBoundary(n),this.boundaryDistance(n)}envelopeSide(e){if(this.isEmpty())return-1;let i=this.boundaryDistance(e);const s=this.ymax-this.ymin,n=this.xmax-this.xmin;return i<s?0:(i-=s)<n?1:i-n<s?2:3}querySide(e,i){switch(e){case 0:i.constructFromCoords(this.xmin,this.ymin,this.xmin,this.ymax);break;case 1:i.constructFromCoords(this.xmin,this.ymax,this.xmax,this.ymax);break;case 2:i.constructFromCoords(this.xmax,this.ymax,this.xmax,this.ymin);break;case 3:i.constructFromCoords(this.xmax,this.ymin,this.xmin,this.ymin);break;default:ce("query_side")}return i}isPointOnBoundary(e,i){return Math.abs(e.x-this.xmin)<=i||Math.abs(e.x-this.xmax)<=i||Math.abs(e.y-this.ymin)<=i||Math.abs(e.y-this.ymax)<=i}calculateToleranceFromEnvelope(){return this.isEmpty()?_1():(Math.abs(this.xmin)+Math.abs(this.xmax)+Math.abs(this.ymin)+Math.abs(this.ymax)+1)*_1()}toString(){return`[${this.xmin}, ${this.ymin}, ${this.xmax}, ${this.ymax}]`}};J.XLESSXMIN=1,J.YLESSYMIN=4,J.XMASK=3,J.YMASK=12;const nJ=[0,0,Number.NaN,0,0,0,0,0,-1,-1,0,0,0,0],G3e=[2,1,1,1,3,1,2,3,2,4,1,1,2,1],B3e=[1,1,1,0,2,1,1,1,0,0,0,0,0,1],q3e=[1,1,1,2,0,0,0,0,2,2,4,2,2,1],H3e=[4,8,4,8,1],D7=25;function vm(){return st(D7,Number.NaN)}let Hs=class Vp{getAttributeCount(){return this.m_attributeCount}getSemantics(e){return this.m_indexToSemantics[e]}getSemanticsBitArray(){return this.m_semanticsBitArray}getAttributeIndex(e){return this.m_semanticsToIndexMap[e]}static getInterpolation(e){return B3e[e]}static getPersistence(e){return q3e[e]}static getPersistenceSize(e){return H3e[e]}static getPersistenceSizeFromSemantics(e){return Vp.getPersistenceSize(Vp.getPersistence(e))*Vp.getComponentCount(e)}static getComponentCount(e){return G3e[e]}static maxComponentCount(){return 4}static isInteger(e){return e===2||e===3||e===4}static isIntegerSemantics(e){return Vp.isInteger(Vp.getPersistence(e))}static isTexture(e){return e===5||e===6||e===7}hasAttribute(e){return!!(this.m_semanticsBitArray&1<<e)}hasAttributesFrom(e){return(this.m_semanticsBitArray&e.m_semanticsBitArray)===e.m_semanticsBitArray}hasZ(){return this.hasAttribute(1)}hasM(){return this.hasAttribute(2)}hasID(){return this.hasAttribute(3)}getTotalComponentCount(){return this.m_totalComponentCount}static getDefaultValue(e){return nJ[e]}static isDefaultValue(e,i){return Ma(nJ[e],i)}equals(e){return this===e}getDefaultPointAttributes(){return this.m_defaultPointAttributes}getPointAttributeOffset(e){return this.m_pointAttributeOffsets[e]}constructor(e){this.m_semanticsBitArray=e,this.m_attributeCount=0,this.m_totalComponentCount=0,this.m_semanticsToIndexMap=new Int32Array(14),this.m_indexToSemantics=new Int32Array(14),this.m_pointAttributeOffsets=new Int32Array(14),this.m_defaultPointAttributes=st(D7,Number.NaN),this.m_semanticsToIndexMap.fill(-1),this.m_indexToSemantics.fill(-1);let i=0,s=1,n=14;for(;i<n;i++)e&s&&(this.m_semanticsToIndexMap[i]=this.m_attributeCount,this.m_indexToSemantics[this.m_attributeCount]=i,this.m_attributeCount++,this.m_totalComponentCount+=Vp.getComponentCount(i)),s<<=1;let r=0;for(i=0,n=this.getAttributeCount();i<n;i++){const o=this.getSemantics(i),a=Vp.getComponentCount(o),l=Vp.getDefaultValue(o);this.m_pointAttributeOffsets[i]=r;for(let u=0;u<a;u++)this.m_defaultPointAttributes[r]=l,r++}}};var DU=Hs;function JF(){return st(14,0)}let OP=class lpe{static getInstance(){return lpe.s_thisInstance}constructor(){this.m_map=new Map,this.m_vd2D=new DU(1),this.m_map.set(1,this.m_vd2D),this.m_vd3D=new DU(3),this.m_map.set(3,this.m_vd2D)}GetVD2D(){return this.m_vd2D}GetVD3D(){return this.m_vd3D}FindOrAdd(e){if(e===1)return this.GetVD2D();if(e===3)return this.GetVD3D();const i=this.m_map.get(e);if(i)return i;const s=new DU(e);return this.m_map.set(e,s),s}};function N7(t){return OP.getInstance().FindOrAdd(t)}function JS(t,e){if(!t||!e)return e||t;const i=t.getSemanticsBitArray()|e.getSemanticsBitArray();return(i&t.getSemanticsBitArray())===i?t:(i&e.getSemanticsBitArray())===i?e:N7(i)}function uA(t,e){const i=t.getSemanticsBitArray()|1<<e;return(i&t.getSemanticsBitArray())===i?t:N7(i)}function cA(t,e){const i=(t.getSemanticsBitArray()|1<<e)-(1<<e);return i===t.getSemanticsBitArray()?t:N7(i)}function go(){return OP.getInstance().GetVD2D()}function LP(){return OP.getInstance().GetVD3D()}function e4(t,e,i){if(i.fill(-1),t!==null&&e!==null)for(let s=0,n=t.getAttributeCount();s<n;s++)i[s]=e.getAttributeIndex(t.getSemantics(s))}OP.s_thisInstance=new OP;let gi=class bl{static construct(e,i,s){return new bl(e,i,s)}constructor(e,i,s){e!==void 0?(this.x=e,this.y=i,this.z=s):this.x=this.y=this.z=Number.NaN}get 0(){return this.x}get 1(){return this.y}get 2(){return this.z}set 0(e){this.x=e}set 1(e){this.y=e}set 2(e){this.z=e}clone(){return new bl(this.x,this.y,this.z)}assign(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}setCoords(e,i,s){return this.x=e,this.y=i,this.z=s,this}setCoordsPoint2DZ(e,i){return this.setCoords(e.x,e.y,i)}setCoordsPoint3D(e){this.x=e.x,this.y=e.y,this.z=e.z}setZero(){this.x=0,this.y=0,this.z=0}setNormalized(e){this.assign(e),this.normalizeThis()}normalizeThis(){const e=this.length();return e?(this.x/=e,this.y/=e,this.z/=e):(this.x=1,this.y=0,this.z=0),this}getUnitVector(){const e=new bl;return e.setNormalized(this),e}sqrLength(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthXY(){return z(0),0}static sqrDistance(e,i){return Di(e.x-i.x)+Di(e.y-i.y)+Di(e.z-i.z)}static sqrDistanceCoords(e,i,s,n,r,o){return Di(e-n)+Di(i-r)+Di(s-o)}static distance(e,i){return Math.sqrt(bl.sqrDistance(e,i))}isEqual(e,i){return i===void 0&&(i=0),Math.abs(this.x-e.x)<=i&&Math.abs(this.y-e.y)<=i&&QS(this.z,e.z,i)}static compareByLength(e,i,s,n){return z(0),0}isEqualCoords(e,i,s,n){return z(0),this.x===e&&this.y===i&&this.z===s}isEqualsTols(e,i,s){return z(0),!1}isEqualCoordsTols(e,i,s,n,r){return z(0),!1}static st_isEqual(e,i,s,n){return z(0),!1}equals(e,i){return this.isEqual(e,i)}equalsTols(e,i,s){return z(0),!1}divThis(e){return this.x/=e,this.y/=e,this.z/=e,this}subThis(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}setSub(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this}sub(e){return bl.construct(this.x-e.x,this.y-e.y,this.z-e.z)}addThis(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}add(e){return this.clone().addThis(e)}setAdd(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this}mul(e){return bl.construct(this.x*e,this.y*e,this.z*e)}dotProduct(e){return this.x*e.x+this.y*e.y+this.z*e.z}crossProductVector(e){const i=this.y*e.z-e.y*this.z,s=e.x*this.z-this.x*e.z,n=this.x*e.y-e.x*this.y;return new bl(i,s,n)}setCrossProductVector(e,i){const s=e.y*i.z-i.y*e.z,n=i.x*e.z-e.x*i.z,r=e.x*i.y-i.x*e.y;return this.x=s,this.y=n,this.z=r,this}setScaled(e,i){return this.x=e*i.x,this.y=e*i.y,this.z=e*i.z,this}scaleThis(e){return this.x*=e,this.y*=e,this.z*=e,this}scaleZThis(e){return this.z*=e,this}setNAN(){return z(0),this}isNAN(){return Number.isNaN(this.x)||Number.isNaN(this.y)||Number.isNaN(this.z)}static getNAN(){return bl.construct(Number.NaN,Number.NaN,Number.NaN)}isFinite(){return z(0),!1}isZero(){return this.x===0&&this.y===0&&this.z===0}norm(e){return z(0),0}sqrDistanceFromCenterToSpheroidSurface(e,i){return z(0),0}distanceFromCenterToSpheroidSurface(e,i){return Math.sqrt(this.sqrDistanceFromCenterToSpheroidSurface(e,i))}static getClosestCoordinate(e,i,s,n=!1){return z(0),0}compare(e){return this.y<e.y?-1:this.y>e.y?1:this.x<e.x?-1:this.x>e.x?1:this.z<e.z?-1:this.z>e.z?1:0}compareXYZ(e){return z(0),0}negateThis(){this.x=-this.x,this.y=-this.y,this.z=-this.z}static averageFast(e,i){return z(0),{}}static average(e,i){return z(0),{}}static size(){return bl.dimensions}static lerp(e,i,s){const n=new bl;return ZRe(e,i,s,n),n}static slerp(e,i,s){return z(0),{}}static compareVectors(e,i){return z(0),0}static selectRightHandedBasisFromNormal(e,i,s){const n=e.getUnitVector(),r=n.createAPerpendicular(),o=new bl;o.setCrossProductVector(n,r),o.normalizeThis(),i.setCoordsPoint3D(r),s.setCoordsPoint3D(o)}createAPerpendicular(){const e=[this.crossProductVector(new bl(0,0,1)),this.crossProductVector(new bl(1,0,0)),this.crossProductVector(new bl(0,1,0))],i=[e[0].sqrLength(),e[1].sqrLength(),e[2].sqrLength()],s=e[i.reduce((n,r,o)=>i[n]>i[o]?n:o,0)];return s.normalizeThis(),s}calculateAngle(e){return z(0),0}static crossDotSign(e,i,s){return z(0),0}static isBisectorRobust(e,i,s){return z(0),0}static compareZOrder(e,i){return z(0),!1}};gi.dimensions=3;let Sd=class upe{static constructEmpty(){return new upe(Number.NaN,Number.NaN,Number.NaN,Number.NaN,Number.NaN,Number.NaN)}constructor(e,i,s,n,r,o){this.m_EnvelopeType=3,this.xmin=e,this.ymin=i,this.zmin=s,this.xmax=n,this.ymax=r,this.zmax=o,this.normalize()}inflate(e){this.inflateCoords(e,e,e)}inflateCoords(e,i,s){z(0)}getEnvelope2D(){return new J(this.xmin,this.ymin,this.xmax,this.ymax)}getEnvelopeZs(){return new Me(this.zmin,this.zmax)}setEmptyZ(){this.zmin=Number.NaN,this.zmax=Number.NaN}normalize(){let e=!1;this.xmin<=this.xmax||(this.xmax=Ge(this.xmin,this.xmin=this.xmax),e=!0),this.ymin<=this.ymax||(this.ymax=Ge(this.ymin,this.ymin=this.ymax),e=!0),!e||this.xmin<=this.xmax&&this.ymin<=this.ymax?this.zmin<=this.zmax||(this.zmax=Ge(this.zmin,this.zmin=this.zmax),this.zmin<=this.zmax||this.setEmptyZ()):this.setEmpty()}isEmpty(){return Number.isNaN(this.xmin)||Number.isNaN(this.ymin)||Number.isNaN(this.xmax)||Number.isNaN(this.ymax)}isEmptyZ(){return Number.isNaN(this.zmin)||Number.isNaN(this.zmax)}setEmpty(){this.xmin=Number.NaN,this.ymin=Number.NaN,this.zmin=Number.NaN,this.xmax=Number.NaN,this.ymax=Number.NaN,this.zmax=Number.NaN}mergeEnv3D(e){e.isEmpty()||(this.mergeCoords(e.xmin,e.ymin,e.zmin),this.mergeCoords(e.xmax,e.ymax,e.zmax))}mergeNe(e){this.mergeNeCoords(e.x,e.y,e.z)}mergeNeCoords(e,i,s){this.xmin>e?this.xmin=e:this.xmax<e&&(this.xmax=e),this.ymin>i?this.ymin=i:this.ymax<i&&(this.ymax=i),this.zmin>s?this.zmin=s:this.zmax<s&&(this.zmax=s)}mergeCoords(e,i,s){this.isEmpty()?(this.xmin=e,this.xmax=e,this.ymin=i,this.ymax=i,this.zmin=s,this.zmax=s):(this.isEmptyZ()&&(this.zmin=s,this.zmax=s),this.mergeNeCoords(e,i,s))}setCoords(e,i,s,n,r,o){this.xmin=e,this.ymin=i,this.zmin=s,this.xmax=n,this.ymax=r,this.zmax=o,this.normalize()}sqrDistanceEnvelope3DAndPoints(e,i,s,n=1){return z(0),0}sqrMaxDistance(e,i=1){return z(0),0}};const uw=-559038737;var ny=Hs;function t4(t,e,i){switch(t){case 0:return new j3e(e,i);case 1:return new FP(e,i);case 2:return new Un(e,i);case 3:throw new Error("64 bit int attribute stream not implemented");case 4:return new O7(e,i);default:ce("")}}function R7(t,e){const i=ny.getComponentCount(t);return t4(ny.getPersistence(t),e*i,ny.getDefaultValue(t))}function t3(t,e){const i=ny.getComponentCount(t);return t4(ny.getPersistence(t),e*i)}function Do(t,e){return new Un(t,e)}function _m(t,e){return new O7(t,e)}function Nl(t,e){return new FP(t,e)}let uS=class xG{size(){return this.m_size}checkResize(e,i){e>this.m_size&&this.resize(e,i)}resize(e,i){if((e=Math.trunc(e))===this.m_size)return;const s=!!i||Number.isNaN(i);if(e<this.m_a.length)this.m_a.length>xG.s_resizeMin&&1.25*e<this.m_a.length&&(this.m_a=this.m_a.slice(0,e)),s&&e>this.m_size&&this.m_a.fill(i,this.m_size,e);else if(e>=this.m_a.length){const n=1.25*e,r=new this.m_a.constructor(n);r.set(this.m_a),this.m_a=r,s&&this.m_a.fill(i,this.m_size,e)}this.m_size=e}resizeRounded(e,i){return this.resize(e,i)}reserve(e){}read(e){return this.m_a[e]}readAsDbl(e){return this.read(e)}write(e,i){this.m_a[e]=i}writeAsDbl(e,i){this.write(e,i)}setRange(e,i,s){(i<0||s<0||s+i>this.size())&&ce(),this.m_a.fill(e,i,i+s)}add(e){this.resize(this.m_size+1),this.m_a[this.m_size-1]=e}addArray(e,i){const s=this.m_size;i===void 0?(this.resize(this.m_size+e.length),this.m_a.set(e,s)):(this.resize(this.m_size+i),this.m_a.set(e.slice(0,i),s))}equals(e,i,s,n){return this.getPersistence()!==e.getPersistence()?!1:Y3e(this,e,i,s,n)}insertRange(e,i,s,n){const r=this.m_size;this.checkResize(Math.max(0,n)+s),this.m_a.copyWithin(e+s,e,n>=0?n:r),this.m_a.fill(i,e,e+s)}readRange(e,i){return this.m_a.slice(e,e+i)}insertRangeFromStream(e,i,s,n,r,o,a){z(this.getPersistence()===i.getPersistence());const l=i,u=this.m_size;n&&this.checkResize(Math.max(0,a)+n),this.m_a.copyWithin(e+n,e,a>=0?a:u),this.m_a.set(l.readRange(s,n),e),r||this.reverseRange(e,n,o)}writeRange(e,i,s,n,r,o){z(this.getPersistence()===s.getPersistence());const a=s;if((e<0||i<0||n<0)&&ce(),a.size()<n+i&&ce(),i===0)return;this.size()<i+e&&this.resize(i+e);const l=a.m_a.subarray(n,n+i);X3e(this.m_a,e,i,l)}insertAttributes(e,i,s,n){const r=ny.getComponentCount(s);this.m_a.copyWithin(e+r,e,n>=0?n:this.m_size);for(let o=0;o<r;o++)this.m_a[e+o]=i.getAttributeAsDbl(s,o)}insertAttributesFromPoints(e,i,s,n,r){z(ny.getPersistence(n)===this.getPersistence());const o=ny.getComponentCount(n),a=this.m_size;if(this.checkResize(Math.max(0,r)+o*s),this.m_a.copyWithin(e+o*s,e,r>=0?r:a),n===0){const l=new N;for(let u=e,c=0;c<s;c++,u+=2)i[c].queryXY(l),this.m_a[u]=l.x,this.m_a[u+1]=l.y}else if(o===1)for(let l=e,u=0;u<s;u++,l++)this.m_a[l]=i[u].getAttributeAsDbl(n,0);else for(let l=e,u=0;u<s;u++,l+=o)for(let c=0;c<o;c++)this.m_a[l+c]=i[u].getAttributeAsDbl(n,c)}eraseRange(e,i,s){this.m_size<e+i&&ce(),this.m_a.copyWithin(e,e+i),this.m_size-=i}reverseRange(e,i,s){if((s<1||i%s!=0)&&ce(),this.m_a.subarray(e,e+i).reverse(),s>1)for(let n=e,r=e+i;n<r;n+=s){let o=n,a=n+s-1;for(;o<a;){const l=this.m_a[o];this.m_a[o]=this.m_a[a],this.m_a[a]=l,o++,a--}}}rotate(e,i,s){(i<e||i>s||e>s)&&bi("rotate"),i!==e&&i!==s&&(this.reverseRange(e,i-e,1),this.reverseRange(i,s-i,1),this.reverseRange(e,s-e,1))}sort(e,i,s){this.m_a.subarray(e,i).sort(s)}constructor(e){if(e.move)this.m_a=e.move.m_a,this.m_size=e.move.m_size,e.move.m_a=e.move.m_a.slice(0,0),e.move.m_size=0;else if(e.copy)this.m_size=e.copy.m_size,e.maxSize&&(this.m_size=Math.min(e.maxSize,this.m_size)),this.m_a=e.copy.m_a.slice(0,this.m_size);else{const i=Math.max(e.size,xG.s_constructMin);this.m_a=new e.ctor(i),(e.defaultValue||Number.isNaN(e.defaultValue))&&this.m_a.fill(e.defaultValue),this.m_size=e.size}}};uS.s_constructMin=2,uS.s_resizeMin=30;let O7=class bG extends uS{setBits(e,i){this.m_a[e]|=i}clearBits(e,i){this.m_a[e]&=~i}getPersistence(){return 4}clone(){return new bG({ctor:Int8Array,copy:this})}restrictedClone(e){return new bG({ctor:Int8Array,copy:this,maxSize:e})}constructor(e,i){super(typeof e=="number"?{ctor:Int8Array,size:e,defaultValue:i}:e)}},Un=class wG extends uS{getPersistence(){return 2}clone(){return new wG({ctor:Int32Array,copy:this})}restrictedClone(e){return new wG({ctor:Int32Array,copy:this,maxSize:e})}write(e,i){z(i<=fo()),super.write(e,i)}constructor(e,i){super(typeof e=="number"?{ctor:Int32Array,size:e,defaultValue:i}:e)}},j3e=class SG extends uS{getPersistence(){return 0}clone(){return new SG({ctor:Float32Array,copy:this})}restrictedClone(e){return new SG({ctor:Float32Array,copy:this,maxSize:e})}constructor(e,i){super(typeof e=="number"?{ctor:Float32Array,size:e,defaultValue:i}:e)}},FP=class EG extends uS{getPersistence(){return 1}getArray(){return this.m_a}applyTransformation(e,i,s){(1&i||i+2*s>this.size())&&ce();const n=i===0?this.m_a:this.m_a.subarray(i);e.transformInterleavedPoints(n,s,n)}readPoint2D(e){const i=this.m_a[e],s=this.m_a[e+1];return new N(i,s)}queryPoint2D(e,i){return i.x=this.m_a[e],i.y=this.m_a[e+1],i}writePoint2D(e,i){this.write(e,i.x),this.write(e+1,i.y)}insert(e,i,s){this.checkResize(s+2),this.m_a.copyWithin(e+2,e,s),this.m_a[e]=i.x,this.m_a[e+1]=i.y}insertRangeFromPoints(e,i,s,n,r,o){const a=this.m_size;if(this.checkResize(Math.max(o,0)+2*n),this.m_a.copyWithin(e+2*n,e,o>=0?o:a),r)for(let l=s,u=e,c=0;c<n;++c,++l){const h=i[l];this.m_a[u++]=h.x,this.m_a[u++]=h.y}else for(let l=s+n-1,u=e,c=0;c<n;++c,--l){const h=i[l];this.m_a[u++]=h.x,this.m_a[u++]=h.y}}queryRange(e,i,s,n,r){if((e<0||i<0)&&ce(),!n&&(r<=0||i%r!=0)&&ce(),i===0)return;if(i===1)return void(s[0]=this.m_a[e]);const o=this.m_a.subarray(e,e+i);s.set(o)}writeRangeFromArray(e,i,s,n,r){if((e<0||i<0)&&ce(),i===0)return;if(i===1)return void(this.m_a[e]=s[0]);let o=s;i<s.length&&(o=s.subarray(0,i)),this.m_a.set(o,e)}clone(){return new EG({ctor:Float64Array,copy:this})}restrictedClone(e){return new EG({ctor:Float64Array,copy:this,maxSize:e})}constructor(e,i){super(typeof e=="number"?{ctor:Float64Array,size:e,defaultValue:i}:e)}};function Y3e(t,e,i,s,n){if(t.getPersistence()!==e.getPersistence())return!1;const r=t.getPersistence()<=1,o=t.size(),a=e.size();if(s>o||s>a)return!1;if(n)if(r){for(let l=i;l<s;l++)if(!QS(t.read(l),e.read(l),n))return!1}else for(let l=i;l<s;l++){let u=t.read(l)-e.read(l);if(u<0&&(u=-u),u>n)return!1}else for(let l=i;l<s;l++){const u=t.read(l),c=e.read(l);if(u!==c){if(r&&Number.isNaN(u)&&Number.isNaN(c))continue;return!1}}return!0}function X3e(t,e,i,s,n,r){if((e<0||i<0)&&ce(),i===0)return;if(i===1)return void(t[e]=s[0]);let o=s;i<s.length&&(o=s.subarray(0,i)),t.set(o,e)}let Uy=class CG{constructor(){this.m_minValue=-1,this.m_maxValue=-1,this.m_dy=Number.NaN,this.m_buckets=new Un(0),this.m_bucketedIndices=new Un(0)}static sortEx(e,i,s,n,r=32){if(s-i<=r)return void n.userSort(i,s,e);new CG().sort(e,i,s,n,r)}sort(e,i,s,n,r=32){if(s-i<=r)return void n.userSort(i,s,e);let o=!0,a=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY;for(let c=i;c<s;c++){const h=n.getValue(e.read(c));h<a&&(a=h),h>l&&(l=h)}if(this.reset(s-i,a,l,s-i)){for(let h=i;h<s;h++){const d=e.read(h),m=n.getValue(d),f=this.getBucket(m);this.m_buckets.write(f,this.m_buckets.read(f)+1),this.m_bucketedIndices.write(h-i,d)}let c=this.m_buckets.read(0);this.m_buckets.write(0,0);for(let h=1,d=this.m_buckets.size();h<d;h++){const m=this.m_buckets.read(h);this.m_buckets.write(h,c),c+=m}for(let h=i;h<s;h++){const d=this.m_bucketedIndices.read(h-i),m=n.getValue(d),f=this.getBucket(m),_=this.m_buckets.read(f);e.write(_+i,d),this.m_buckets.write(f,_+1)}o=!1}if(o)return void n.userSort(i,s,e);let u=0;for(let c=0,h=this.m_buckets.size();c<h;c++){const d=u;u=this.m_buckets.read(c),u>d&&n.userSort(i+d,i+u,e)}this.m_buckets.size()>100&&(this.m_buckets.resize(0),this.m_bucketedIndices.resize(0))}reset(e,i,s,n){if(e<2||s===i)return!1;const r=Math.min(CG.c_maxBuckets,e);return this.m_buckets.resize(r),this.m_buckets.setRange(0,0,this.m_buckets.size()),this.m_minValue=i,this.m_maxValue=s,this.m_bucketedIndices.resize(n),this.m_dy=(s-i)/(r-1),!0}getBucket(e){return Math.trunc((e-this.m_minValue)/this.m_dy)}getBucketCount(){return this.m_buckets.size()}};Uy.c_maxBuckets=65536;let xs=class Bs{constructor(e){this.m_buffer=null,this.m_firstFree=-1,this.m_last=0,this.m_size=0,this.m_capacity=0,this.m_bufferSize=0,this.m_stride=0,this.m_stride=e,this.m_realStride=e,this.m_blockSize=Math.trunc(Bs.st_realBlockSize/this.m_realStride)}dbgdelete_(e){return this.m_buffer[e>>Bs.st_blockPower][1+(e&Bs.st_blockMask)]=Bs.st_deadVertex,!0}deleteElement(e){(e>>Bs.st_blockPower)*this.m_blockSize*this.m_realStride+(e&Bs.st_blockMask)<this.m_last*this.m_realStride?(this.m_buffer[e>>Bs.st_blockPower][e&Bs.st_blockMask]=this.m_firstFree,this.m_firstFree=e):this.m_last--,this.m_size--}getField(e,i){return this.m_buffer[e>>Bs.st_blockPower][(e&Bs.st_blockMask)+i]}setField(e,i,s){this.m_buffer[e>>Bs.st_blockPower][(e&Bs.st_blockMask)+i]=s}getStride(){return this.m_stride}newElement(){let e=this.m_firstFree;if(e===-1){if(this.m_last===this.m_capacity){const n=this.m_capacity!==0?Math.trunc(2*(this.m_capacity+1)):1;this.grow(n)}e=(this.m_last/this.m_blockSize<<Bs.st_blockPower)+this.m_last%this.m_blockSize*this.m_realStride,this.m_last++}else this.m_firstFree=this.m_buffer[e>>Bs.st_blockPower][e&Bs.st_blockMask];this.m_size++;const i=this.m_buffer[e>>Bs.st_blockPower],s=e&Bs.st_blockMask;for(let n=0;n<this.m_stride;n++)i[s+n]=-1;return e}elementToIndex(e){return(e>>Bs.st_blockPower)*this.m_blockSize+(e&Bs.st_blockMask)/this.m_realStride}deleteAll(e){this.m_firstFree=-1,this.m_last=0,this.m_size=0,e&&(this.m_buffer=null,this.m_capacity=0)}size(){return this.m_size}setCapacity(e){e>this.m_capacity&&this.grow(e)}capacity(){return this.m_capacity}swap(e,i){const s=this.m_buffer[e>>Bs.st_blockPower],n=this.m_buffer[i>>Bs.st_blockPower],r=e&Bs.st_blockMask,o=i&Bs.st_blockMask;for(let a=0;a<this.m_stride;a++){const l=s[r+a];s[r+a]=n[o+a],n[o+a]=l}}swapField(e,i,s){const n=this.m_buffer[e>>Bs.st_blockPower],r=this.m_buffer[i>>Bs.st_blockPower],o=(e&Bs.st_blockMask)+s,a=(i&Bs.st_blockMask)+s,l=n[o];n[o]=r[a],r[a]=l}static impossibleIndex2(){return-2}static impossibleIndex3(){return-3}static isValidElement(e){return e>=0}ensureBufferBlocksCapacity(e){if(this.m_buffer.length<e){const i=new Array(e);for(let s=0;s<this.m_buffer.length;s++)i[s]=this.m_buffer[s];this.m_buffer=i}}grow(e){this.m_buffer===null&&(this.m_bufferSize=0,this.m_buffer=new Array(8));const i=Math.trunc((e+this.m_blockSize-1)/this.m_blockSize);if(this.ensureBufferBlocksCapacity(i),i===1){let s=0;const n=e*this.m_realStride;for(;n>Bs.st_sizes[s];)s++;const r=new Int32Array(Bs.st_sizes[s]);this.m_bufferSize===1?(r.set(this.m_buffer[0]),this.m_buffer[0]=r):(this.m_buffer[this.m_bufferSize]=r,this.m_bufferSize++),this.m_capacity=Math.trunc(r.length/this.m_realStride)}else{if(this.m_bufferSize===1&&this.m_buffer[0].length<Bs.st_realBlockSize){const s=new Int32Array(Bs.st_realBlockSize);s.set(this.m_buffer[0]),this.m_buffer[0]=s,this.m_capacity=this.m_blockSize}for(;this.m_bufferSize<i;)this.m_buffer[this.m_bufferSize++]=new Int32Array(Bs.st_realBlockSize),this.m_capacity+=this.m_blockSize}}};function W3e(t,e){return{element:t,box:e.clone()}}xs.st_realBlockSize=16384,xs.st_blockMask=16383,xs.st_blockPower=14,xs.st_sizes=[16,32,64,128,256,512,1024,2048,4096,8192,16384],xs.st_deadVertex=-2125315821;class Jo{constructor(e,i,s){this.m_extent=new J,this.m_dataExtent=new J,this.m_childExtents=[new J,new J,new J,new J],this.m_elementNodes=new xs(4),this.m_data=[],this.m_freeData=[],this.m_root=-1,this.m_height=8,s===void 0&&(s=!1),this.m_quadTreeNodes=new xs(s?11:10),this.m_bStoreDuplicates=s,this.reset_(e,i)}reset(e,i){this.m_quadTreeNodes.deleteAll(!1),this.m_elementNodes.deleteAll(!1),this.m_data.length=0,this.m_freeData.length=0,this.reset_(e,i)}insert(e,i){if(this.m_root===-1&&this.createRoot_(),this.m_bStoreDuplicates){const n=this.insertDuplicates_(e,i,0,this.m_extent,this.m_root,!1,-1);return n!==-1&&(this.m_dataExtent.isEmpty()?this.m_dataExtent.setCoords({env2D:i}):this.m_dataExtent.mergeEnvelope2D(i)),n}const s=this.insert_(e,i,0,this.m_extent,this.m_root,!1,-1);return s!==-1&&(this.m_dataExtent.isEmpty()?this.m_dataExtent.setCoords({env2D:i}):this.m_dataExtent.mergeEnvelope2D(i)),s}insertEx(e,i,s){if(this.m_root===-1&&this.createRoot_(),this.m_bStoreDuplicates){const l=this.insertDuplicates_(e,i,0,this.m_extent,this.m_root,!1,-1);return l!==-1&&(this.m_dataExtent.isEmpty()?this.m_dataExtent.setCoords({env2D:i}):this.m_dataExtent.mergeEnvelope2D(i)),l}let n;n=s===-1?this.m_root:this.getQuad_(s);const r=this.getHeight(n),o=this.getExtent(n),a=this.insert_(e,i,r,o,n,!1,-1);return a!==-1&&(this.m_dataExtent.isEmpty()?this.m_dataExtent.setCoords({env2D:i}):this.m_dataExtent.mergeEnvelope2D(i)),a}removeElement(e){z(0)}getElement(e){return this.getElementValue_(this.getData_(e))}getElementAtIndex(e){return z(0),0}getElementExtent(e){const i=this.getData_(e);return this.getBoundingBoxValue_(i).clone()}getElementExtentAtIndex(e){return z(0),{}}getDataExtent(){return this.m_dataExtent.clone()}getQuadTreeExtent(){return z(0),{}}getHeight(e){return this.m_quadTreeNodes.getField(e,6)>>Jo.m_heightBitShift}getMaxHeight(){return this.m_height}getExtent(e){const i=new J;if(i.setCoords({env2D:this.m_extent}),e===this.m_root)return i;const s=[];let n=e;do s.push(this.getQuadrant_(n)),n=this.getParent_(n);while(n!==this.m_root);const r=s.length;for(let o=0;o<r;o++){const a=s.at(-1);s.pop(),a===0?(i.xmin=.5*(i.xmin+i.xmax),i.ymin=.5*(i.ymin+i.ymax)):a===1?(i.xmax=.5*(i.xmin+i.xmax),i.ymin=.5*(i.ymin+i.ymax)):a===2?(i.xmax=.5*(i.xmin+i.xmax),i.ymax=.5*(i.ymin+i.ymax)):(i.xmin=.5*(i.xmin+i.xmax),i.ymax=.5*(i.ymin+i.ymax))}return i}getQuad(e){return this.getQuad_(e)}getElementCount(){return this.m_root===-1?0:this.getSubTreeElementCount_(this.m_root)}getSubTreeElementCount(e){return this.getSubTreeElementCount_(e)}getContainedSubTreeElementCount(e){return this.m_bStoreDuplicates?this.getContainedSubTreeElementCount_(e):this.getSubTreeElementCount_(e)}getIntersectionCount(e,i,s){if(this.m_root===-1)return 0;const n=new J;n.setCoords({env2D:e}),n.inflateCoords(i,i);const r=[],o=[];r.push(this.m_root),o.push(this.m_extent.clone());const a=he(J,4);let l=0;for(;r.length>0;){let u=!1;const c=r.at(-1),h=o.at(-1);if(r.pop(),o.pop(),n.containsEnvelope(h)){if(l+=this.getSubTreeElementCount(c),s>0&&l>=s)return s}else if(n.isIntersecting(h)){for(let d=this.getFirstElement_(c);d!==-1;d=this.getNextElement_(d)){const m=this.getData_(d);if(this.getBoundingBoxValue_(m).isIntersecting(n)&&(l++,s>0&&l>=s))return s}u=this.getHeight(c)+1<=this.m_height}if(u){Jo.setChildExtents_(h,a);for(let d=0;d<4;d++){const m=this.getChild_(c,d);m!==-1&&this.getSubTreeElementCount_(m)>0&&n.isIntersecting(a[d])&&(r.push(m),o.push(a[d].clone()))}}}return l}hasData(e,i){return this.getIntersectionCount(e,i,1)>=1}getIterator(e,i){return new rJ(this,e,i)}getIteratorForQT(){return new rJ(this)}getSortedIterator(e,i){return new oJ(this.getIterator(e,i))}getSortedIteratorForQT(){return new oJ(this.getIteratorForQT())}visitLeavesNearest(e,i,s,n){z(0)}reset_(e,i){(i<0||i>127)&&ce("invalid height"),this.m_height=i,this.m_extent.setCoords({env2D:e}),this.m_dataExtent.setEmpty(),this.m_root=-1}insert_(e,i,s,n,r,o,a){if(!n.containsEnvelope(i))return s===0?-1:this.insert_(e,i,0,this.m_extent,this.m_root,o,a);if(!o)for(let h=r;h!==-1;h=this.getParent_(h))this.setSubTreeElementCount_(h,this.getSubTreeElementCount_(h)+1);const l=new J;l.setCoords({env2D:n});let u,c=r;for(u=s;u<this.m_height&&this.canPushDown_(c);u++){Jo.setChildExtents_(l,this.m_childExtents);let h=!1;for(let d=0;d<4;d++)if(this.m_childExtents[d].containsEnvelope(i)){h=!0;let m=this.getChild_(c,d);m===-1&&(m=this.createChild_(c,d)),this.setSubTreeElementCount_(m,this.getSubTreeElementCount_(m)+1),c=m,l.setCoords({env2D:this.m_childExtents[d]});break}if(!h)break}return this.insertAtQuad_(e,i,u,l,c,o,r,a,-1)}insertDuplicates_(e,i,s,n,r,o,a){if(!o){if(!n.containsEnvelope(i))return-1;this.setSubTreeElementCount_(r,this.getSubTreeElementCount_(r)+1),this.setContainedSubTreeElementCount_(r,this.getContainedSubTreeElementCount_(r)+1)}const l=Math.max(i.width(),i.height());let u=-1;const c=[],h=[],d=[];c.push(r),h.push(n.clone()),d.push(s);const m=he(J,4);for(;c.length>0;){let f=!1;const _=c.at(-1),v=h.at(-1),x=d.at(-1);if(c.pop(),h.pop(),d.pop(),x+1<this.m_height&&this.canPushDown_(_)&&l<=Math.max(v.width(),v.height())/2&&(f=!0),f){Jo.setChildExtents_(v,m);let w=!1;for(let T=0;T<4;T++)if(w=m[T].containsEnvelope(i),w){let C=this.getChild_(_,T);C===-1&&(C=this.createChild_(_,T)),c.push(C),h.push(m[T].clone()),d.push(x+1),this.setSubTreeElementCount_(C,this.getSubTreeElementCount_(C)+1),this.setContainedSubTreeElementCount_(C,this.getContainedSubTreeElementCount_(C)+1);break}if(!w){for(let T=0;T<4;T++)if(m[T].isIntersecting(i)){let C=this.getChild_(_,T);C===-1&&(C=this.createChild_(_,T)),c.push(C),h.push(m[T].clone()),d.push(x+1),this.setSubTreeElementCount_(C,this.getSubTreeElementCount_(C)+1)}}}else u=this.insertAtQuad_(e,i,x,v,_,o,r,a,u),o=!1}return 0}insertAtQuad_(e,i,s,n,r,o,a,l,u){this.getFirstElement_(r);const c=this.getLastElement_(r);let h=-1;if(o){if(r===a)return l;this.disconnectElementHandle_(l),h=l}else u===-1?(h=this.createElement_(),this.setDataValues_(this.getData_(h),e,i)):h=this.createElementFromDuplicate_(u);return this.setQuad_(h,r),c!==-1?(this.setPrevElement_(h,c),this.setNextElement_(c,h)):this.setFirstElement_(r,h),this.setLastElement_(r,h),this.setLocalElementCount_(r,this.getLocalElementCount_(r)+1),this.canFlush_(r)&&this.flush_(s,n,r),h}static setChildExtents_(e,i){const s=.5*(e.xmin+e.xmax),n=.5*(e.ymin+e.ymax);i[0].setCoords({xmin:s,ymin:n,xmax:e.xmax,ymax:e.ymax}),i[1].setCoords({xmin:e.xmin,ymin:n,xmax:s,ymax:e.ymax}),i[2].setCoords({xmin:e.xmin,ymin:e.ymin,xmax:s,ymax:n}),i[3].setCoords({xmin:s,ymin:e.ymin,xmax:e.xmax,ymax:n})}disconnectElementHandle_(e){const i=this.getQuad_(e),s=this.getFirstElement_(i),n=this.getLastElement_(i),r=this.getPrevElement_(e),o=this.getNextElement_(e);s===e?(o!==-1?this.setPrevElement_(o,-1):this.setLastElement_(i,-1),this.setFirstElement_(i,o)):n===e?(this.setNextElement_(r,-1),this.setLastElement_(i,r)):(this.setPrevElement_(o,r),this.setNextElement_(r,o)),this.setPrevElement_(e,-1),this.setNextElement_(e,-1),this.setLocalElementCount_(i,this.getLocalElementCount_(i)-1)}canFlush_(e){return this.getLocalElementCount_(e)===Jo.m_flushingCount&&!this.hasChildren_(e)}flush_(e,i,s){let n;const r=new J;let o=this.getFirstElement_(s),a=-1,l=-1;do l=this.getData_(o),n=this.getElementValue_(l),r.setCoords({env2D:this.getBoundingBoxValue_(l)}),a=this.getNextElement_(o),this.m_bStoreDuplicates?this.insertDuplicates_(n,r,e,i,s,!0,o):this.insert_(n,r,e,i,s,!0,o),o=a;while(o!==-1)}canPushDown_(e){return this.getLocalElementCount_(e)>=Jo.m_flushingCount||this.hasChildren_(e)}hasChildren_(e){return this.getChild_(e,0)!==-1||this.getChild_(e,1)!==-1||this.getChild_(e,2)!==-1||this.getChild_(e,3)!==-1}createChild_(e,i){const s=this.m_quadTreeNodes.newElement();return this.setChild_(e,i,s),this.setSubTreeElementCount_(s,0),this.setLocalElementCount_(s,0),this.setParent_(s,e),this.setHeightAndQuadrant_(s,this.getHeight_(e)+1,i),this.m_bStoreDuplicates&&this.setContainedSubTreeElementCount_(s,0),s}createRoot_(){this.m_root=this.m_quadTreeNodes.newElement(),this.setSubTreeElementCount_(this.m_root,0),this.setLocalElementCount_(this.m_root,0),this.setHeightAndQuadrant_(this.m_root,0,0),this.m_bStoreDuplicates&&this.setContainedSubTreeElementCount_(this.m_root,0)}createElement_(){const e=this.m_elementNodes.newElement();let i;return this.m_freeData.length>0?(i=this.m_freeData.at(-1),this.m_freeData.pop()):(i=this.m_data.length,this.m_data.length=i+1),this.setData_(e,i),e}createElementFromDuplicate_(e){const i=this.m_elementNodes.newElement(),s=this.getData_(e);return this.setData_(i,s),i}freeElementAndBoxNode_(e){z(0)}getChild_(e,i){return this.m_quadTreeNodes.getField(e,i)}setChild_(e,i,s){this.m_quadTreeNodes.setField(e,i,s)}getFirstElement_(e){return this.m_quadTreeNodes.getField(e,4)}setFirstElement_(e,i){this.m_quadTreeNodes.setField(e,4,i)}getLastElement_(e){return this.m_quadTreeNodes.getField(e,5)}setLastElement_(e,i){this.m_quadTreeNodes.setField(e,5,i)}getQuadrant_(e){return this.m_quadTreeNodes.getField(e,6)&Jo.m_quadrantMask}getHeight_(e){return this.m_quadTreeNodes.getField(e,6)>>Jo.m_heightBitShift}setHeightAndQuadrant_(e,i,s){const n=i<<Jo.m_heightBitShift|s;this.m_quadTreeNodes.setField(e,6,n)}getLocalElementCount_(e){return this.m_quadTreeNodes.getField(e,7)}setLocalElementCount_(e,i){this.m_quadTreeNodes.setField(e,7,i)}getSubTreeElementCount_(e){return this.m_quadTreeNodes.getField(e,8)}setSubTreeElementCount_(e,i){this.m_quadTreeNodes.setField(e,8,i)}getParent_(e){return this.m_quadTreeNodes.getField(e,9)}setParent_(e,i){this.m_quadTreeNodes.setField(e,9,i)}getContainedSubTreeElementCount_(e){return this.m_quadTreeNodes.getField(e,10)}setContainedSubTreeElementCount_(e,i){this.m_quadTreeNodes.setField(e,10,i)}getData_(e){return this.m_elementNodes.getField(e,0)}setData_(e,i){this.m_elementNodes.setField(e,0,i)}getPrevElement_(e){return this.m_elementNodes.getField(e,1)}getNextElement_(e){return this.m_elementNodes.getField(e,2)}setPrevElement_(e,i){this.m_elementNodes.setField(e,1,i)}setNextElement_(e,i){this.m_elementNodes.setField(e,2,i)}getQuad_(e){return this.m_elementNodes.getField(e,3)}setQuad_(e,i){this.m_elementNodes.setField(e,3,i)}getElementValue_(e){return this.m_data[e].element}getBoundingBoxValue_(e){return this.m_data[e].box}setDataValues_(e,i,s){this.m_data[e]=W3e(i,s)}}Jo.m_quadrantMask=3,Jo.m_heightBitShift=2,Jo.m_flushingCount=5;let rJ=class{constructor(e,i,s){this.m_bLinear=!1,this.m_queryStart=new N,this.m_queryEnd=new N,this.m_queryBox=new J,this.m_tolerance=0,this.m_currentElementHandle=-1,this.m_nextElementHandle=-1,this.m_quadsStack=[],this.m_extentsStack=[],this.m_childExtents=[new J,new J,new J,new J],this.m_quadTree=e,i&&this.resetIterator(i,s)}resetIterator(e,i){if(i===void 0&&(i=0),e instanceof J)return this.m_quadsStack.length=0,this.m_extentsStack.length=0,this.m_currentElementHandle=-1,this.m_queryBox.setCoords({env2D:e}),this.m_queryBox.inflateCoords(i,i),this.m_tolerance=Number.NaN,void(this.m_quadTree.m_root!==-1&&this.m_queryBox.isIntersecting(this.m_quadTree.m_extent)?(this.m_quadsStack.push(this.m_quadTree.m_root),this.m_extentsStack.push(this.m_quadTree.m_extent.clone()),this.m_nextElementHandle=this.m_quadTree.getFirstElement_(this.m_quadTree.m_root),this.m_bLinear=!1):this.m_nextElementHandle=-1);if(this.m_quadsStack.length=0,this.m_extentsStack.length=0,this.m_currentElementHandle=-1,e.queryLooseEnvelope(this.m_queryBox),this.m_queryBox.inflateCoords(i,i),this.m_quadTree.m_root!==-1&&this.m_queryBox.isIntersecting(this.m_quadTree.m_extent)){const s=e.getGeometryType();if(this.m_bLinear=s===q.enumLine,this.m_bLinear){const n=e;this.m_queryStart.assign(n.getStartXY()),this.m_queryEnd.assign(n.getEndXY()),this.m_tolerance=i}else this.m_tolerance=Number.NaN;this.m_quadsStack.push(this.m_quadTree.m_root),this.m_extentsStack.push(this.m_quadTree.m_extent.clone()),this.m_nextElementHandle=this.m_quadTree.getFirstElement_(this.m_quadTree.m_root)}else this.m_nextElementHandle=-1}next(){if(this.m_quadsStack.length===0)return-1;this.m_currentElementHandle=this.m_nextElementHandle;const e=new N,i=new N,s=new J;let n=!1;for(;!n;){for(;this.m_currentElementHandle!==-1;){const r=this.m_quadTree.getData_(this.m_currentElementHandle);if(s.setCoords({env2D:this.m_quadTree.getBoundingBoxValue_(r)}),s.isIntersecting(this.m_queryBox)){if(!this.m_bLinear){n=!0;break}if(e.setCoordsPoint2D(this.m_queryStart),i.setCoordsPoint2D(this.m_queryEnd),s.inflateCoords(this.m_tolerance,this.m_tolerance),s.clipLine(e,i)>0){n=!0;break}}this.m_currentElementHandle=this.m_quadTree.getNextElement_(this.m_currentElementHandle)}if(this.m_currentElementHandle===-1){const r=this.m_quadsStack.at(-1),o=this.m_extentsStack.at(-1);Jo.setChildExtents_(o,this.m_childExtents),this.m_quadsStack.pop(),this.m_extentsStack.pop();for(let a=0;a<4;a++){const l=this.m_quadTree.getChild_(r,a);if(l!==-1&&this.m_quadTree.getSubTreeElementCount(l)>0&&this.m_childExtents[a].isIntersecting(this.m_queryBox))if(this.m_bLinear){e.setCoordsPoint2D(this.m_queryStart),i.setCoordsPoint2D(this.m_queryEnd);const u=new J;u.setCoords({env2D:this.m_childExtents[a]}),u.inflateCoords(this.m_tolerance,this.m_tolerance),u.clipLine(e,i)>0&&(this.m_quadsStack.push(l),this.m_extentsStack.push(this.m_childExtents[a].clone()))}else this.m_quadsStack.push(l),this.m_extentsStack.push(this.m_childExtents[a].clone())}if(this.m_quadsStack.length===0)return-1;this.m_currentElementHandle=this.m_quadTree.getFirstElement_(this.m_quadsStack.at(-1))}}return this.m_nextElementHandle=this.m_quadTree.getNextElement_(this.m_currentElementHandle),this.m_currentElementHandle}clone(){return z(0),{}}},oJ=class{constructor(e){this.m_bucketSort=new Uy,this.m_sortedHandles=new Un(0),this.m_index=-1,this.m_quadTreeIteratorImpl=e}resetIterator(e,i){this.m_quadTreeIteratorImpl.resetIterator(e,i),this.m_sortedHandles.resize(0),this.m_index=-1}next(){if(this.m_index===-1){let e=-1;for(;(e=this.m_quadTreeIteratorImpl.next())!==-1;)this.m_sortedHandles.add(e);const i=this,s={userSort(n,r,o){o.sort(n,r,(a,l)=>i.m_quadTreeIteratorImpl.m_quadTree.getElement(a)-i.m_quadTreeIteratorImpl.m_quadTree.getElement(l))},getValue:n=>i.m_quadTreeIteratorImpl.m_quadTree.getElement(n)};this.m_bucketSort.sort(this.m_sortedHandles,0,this.m_sortedHandles.size(),s)}return this.m_index===this.m_sortedHandles.size()-1?-1:(this.m_index++,this.m_sortedHandles.read(this.m_index))}clone(){return z(0),{}}},B1=class{constructor(e=!1){this.m_bNotifyOnActions=e}onDelete(e){}onSet(e){}onEndSearch(e){}onAddUniqueElementFailed(e){}onDeleteImpl(e,i){this.m_bNotifyOnActions&&this.onDelete(e.getElement(i))}onSetImpl(e,i){this.m_bNotifyOnActions&&this.onSet(e.getElement(i))}onAddUniqueElementFailedImpl(e){this.m_bNotifyOnActions&&this.onAddUniqueElementFailed(e)}onEndSearchImpl(e){this.m_bNotifyOnActions&&this.onEndSearch(e)}},mr=class Pi{static st_nullNode(){return-1}constructor(){this.m_defaultTreap=-1,this.m_random=124234251,this.m_comparator=null,this.m_treapData=new xs(7),this.m_treapCount=0,this.m_maxDepthEver=0,this.m_bBalancing=!0}setComparator(e){this.m_comparator=e}getComparator(){return this.m_comparator}disableBalancing(){this.m_bBalancing=!1}enableBalancing(){this.m_bBalancing||(z(this.m_treapCount<=1),this.rebalance(-1),this.m_bBalancing=!0)}isAutoBalancing(){return this.m_bBalancing}rebalance(e){if(this.m_bBalancing||(e===-1&&(e=this.m_defaultTreap),this.size(e)===0))return;const i=[];for(let s=this.getFirst(e);s!==-1;s=this.getNext(s))i.push(s),this.setParent_(s,-1),this.setRight_(s,-1),this.setLeft_(s,-1);this.setRoot_(-1,e),this.setFirst_(-1,e),this.setLast_(-1,e),this.setSize_(0,e),this.m_bBalancing=!0;for(const s of i)this.addBiggestElement_(s,e);this.m_bBalancing=!1}setCapacity(e){this.m_treapData.setCapacity(e)}createTreap(e){const i=this.m_treapData.newElement();return this.setSize_(0,i),this.setTreapData_(e,i),this.m_treapCount++,i}deleteTreap(e){this.m_treapData.deleteElement(e),this.m_treapCount--}addElement(e,i=-1){return i===-1&&(this.m_defaultTreap===Pi.st_nullNode()&&(this.m_defaultTreap=this.createTreap(-1)),i=this.m_defaultTreap),this.addElement_(e,0,i)}addUniqueElement(e,i=-1){return i===-1&&(this.m_defaultTreap===Pi.st_nullNode()&&(this.m_defaultTreap=this.createTreap(-1)),i=this.m_defaultTreap),this.addElement_(e,1,i)}addBiggestElement(e,i=-1){i===-1&&(this.m_defaultTreap===Pi.st_nullNode()&&(this.m_defaultTreap=this.createTreap(-1)),i=this.m_defaultTreap);const s=this.newNode_(e);return this.addBiggestElement_(s,i),s}addElementAtPosition(e,i,s,n,r,o=-1){if(o===-1&&(this.m_defaultTreap===Pi.st_nullNode()&&(this.m_defaultTreap=this.createTreap(-1)),o=this.m_defaultTreap),this.getRoot_(o)===Pi.st_nullNode()){const _=this.newNode_(s);return this.setRoot_(_,o),this.addToList_(-1,_,o),_}let a,l,u,c,h;if(r?(a=i!==Pi.st_nullNode()?this.m_comparator.compare(this,s,i):-1,l=e!==Pi.st_nullNode()?this.m_comparator.compare(this,s,e):1):(a=-1,l=1),n&&(a===0||l===0)){this.m_comparator.onAddUniqueElementFailedImpl(s);const _=a===0?i:e;return this.setDuplicateElement_(_,o),-1}h=i!==Pi.st_nullNode()&&e!==Pi.st_nullNode()?this.m_random>Tw(this.m_random)>>1:i!==Pi.st_nullNode(),h?(c=a,u=i):(c=l,u=e);let d=-1,m=-1,f=!0;for(;;){if(c<0){const _=this.getLeft(u);if(_===Pi.st_nullNode()){m=u,d=this.newNode_(s),this.setLeft_(u,d),this.setParent_(d,u);break}u=_}else{const _=this.getRight(u);if(_===Pi.st_nullNode()){m=this.getNext(u),d=this.newNode_(s),this.setRight_(u,d),this.setParent_(d,u);break}u=_}f&&(c*=-1,f=!1)}return this.bubbleUp_(d),this.getParent(d)===Pi.st_nullNode()&&this.setRoot_(d,o),this.addToList_(m,d,o),d}replaceElementAtPosition(e,i,s,n,r=-1){if(n){const o=this.getNext(e);let a=-1;o!==Pi.st_nullNode()&&(a=this.m_comparator.compare(this,i,o));const l=this.getPrev(e);let u=-1;if(l!==Pi.st_nullNode()&&(u=this.m_comparator.compare(this,i,l)),s&&(a===0||u===0)){this.m_comparator.onAddUniqueElementFailedImpl(i);const c=a===0?o:l;return r===Pi.st_nullNode()&&(this.m_defaultTreap===Pi.st_nullNode()&&(this.m_defaultTreap=this.createTreap(-1)),r=this.m_defaultTreap),this.setDuplicateElement_(c,r),-1}}return this.setElement_(e,i),e}getDuplicateElement(e=-1){return e===-1?this.getDuplicateElement_(this.m_defaultTreap):this.getDuplicateElement_(e)}deleteNode(e,i=-1){this.m_comparator&&this.m_comparator.onDeleteImpl(this,e),i===-1&&(i=this.m_defaultTreap),this.m_bBalancing?this.deleteNode_(e,i):this.unbalancedDelete_(e,i)}search(e,i=-1){let s=this.getRoot(i);for(;s!==Pi.st_nullNode();){const n=this.m_comparator.compare(this,e,s);if(!n)return s;s=n<0?this.getLeft(s):this.getRight(s)}return this.m_comparator.onEndSearchImpl(e),Pi.st_nullNode()}searchLowerBound(e,i=-1){let s=this.getRoot(i),n=-1;for(;s!==Pi.st_nullNode();){const r=e.compare(this,s);if(!r)return s;r<0?s=this.getLeft(s):(n=s,s=this.getRight(s))}return n}searchUpperBound(e,i=-1){let s=this.getRoot(i),n=-1;for(;s!==Pi.st_nullNode();){const r=e.compare(this,s);if(!r)return s;r<0?(n=s,s=this.getLeft(s)):s=this.getRight(s)}return n}getElement(e){return this.m_treapData.getField(e,3)}getLeft(e){return this.m_treapData.getField(e,0)}getRight(e){return this.m_treapData.getField(e,1)}getParent(e){return this.m_treapData.getField(e,2)}getNext(e){return this.m_treapData.getField(e,6)}getPrev(e){return this.m_treapData.getField(e,5)}getFirst(e=-1){return e===-1?this.getFirst_(this.m_defaultTreap):this.getFirst_(e)}getLast(e=-1){return e===-1?this.getLast_(this.m_defaultTreap):this.getLast_(e)}getTreapData(e=-1){return e===-1?this.getTreapData_(this.m_defaultTreap):this.getTreapData_(e)}setElement(e,i){this.m_comparator!==null&&this.m_comparator.onSetImpl(this,e),this.setElement_(e,i)}getRoot(e=-1){return e===-1?this.getRoot_(this.m_defaultTreap):this.getRoot_(e)}clear(){this.m_treapData.deleteAll(!1),this.m_defaultTreap=Pi.st_nullNode(),this.m_treapCount=0,this.m_maxDepthEver=0}addToList_(e,i,s){let n;e!==-1?(n=this.getPrev(e),this.setPrev_(e,i)):n=this.getLast_(s),this.setPrev_(i,n),n!==-1&&this.setNext_(n,i),this.setNext_(i,e),e===this.getFirst_(s)&&this.setFirst_(i,s),e===-1&&this.setLast_(i,s),this.setSize_(this.getSize_(s)+1,s)}size(e=-1){return e===-1?this.getSize_(this.m_defaultTreap):this.getSize_(e)}getMaxDepth(e=-1){return this.getMaxDepthHelper_(this.getRoot(e))}getMaxDepthEver(){return this.m_maxDepthEver}static st_isValidNode(e){return xs.isValidElement(e)}dbgCheck_(e){}getPriority_(e){return this.m_treapData.getField(e,4)}bubbleDown_(e){let i=this.getLeft(e),s=this.getRight(e);const n=this.getPriority_(e);for(;i!==Pi.st_nullNode()||s!==Pi.st_nullNode();){const r=i!==Pi.st_nullNode()?this.getPriority_(i):Aa(),o=s!==Pi.st_nullNode()?this.getPriority_(s):Aa();if(n<=Math.min(r,o))return;r<=o?this.rotateRight_(i):this.rotateLeft_(e),i=this.getLeft(e),s=this.getRight(e)}}bubbleUp_(e){if(!this.m_bBalancing)return;const i=this.getPriority_(e);let s=this.getParent(e);for(;s!==Pi.st_nullNode()&&this.getPriority_(s)>i;)this.getLeft(s)===e?this.rotateRight_(e):this.rotateLeft_(s),s=this.getParent(e)}rotateLeft_(e){const i=e,s=this.getRight(e);let n;this.setParent_(s,this.getParent(i)),this.setParent_(i,s),n=this.getLeft(s),this.setRight_(i,n),n!==Pi.st_nullNode()&&this.setParent_(n,i),this.setLeft_(s,i),n=this.getParent(s),n!==Pi.st_nullNode()&&(this.getLeft(n)===i?this.setLeft_(n,s):this.setRight_(n,s))}rotateRight_(e){const i=this.getParent(e),s=e;let n;this.setParent_(s,this.getParent(i)),this.setParent_(i,s),n=this.getRight(s),this.setLeft_(i,n),n!==Pi.st_nullNode()&&this.setParent_(n,i),this.setRight_(s,i),n=this.getParent(s),n!==Pi.st_nullNode()&&(this.getLeft(n)===i?this.setLeft_(n,s):this.setRight_(n,s))}setParent_(e,i){this.m_treapData.setField(e,2,i)}setLeft_(e,i){this.m_treapData.setField(e,0,i)}setRight_(e,i){this.m_treapData.setField(e,1,i)}setPriority_(e,i){this.m_treapData.setField(e,4,i)}setPrev_(e,i){this.m_treapData.setField(e,5,i)}setNext_(e,i){this.m_treapData.setField(e,6,i)}setRoot_(e,i){this.m_treapData.setField(i,0,e)}setFirst_(e,i){this.m_treapData.setField(i,1,e)}setLast_(e,i){this.m_treapData.setField(i,2,e)}setDuplicateElement_(e,i){this.m_treapData.setField(i,3,e)}setSize_(e,i){this.m_treapData.setField(i,4,e)}setTreapData_(e,i){this.m_treapData.setField(i,5,e)}getRoot_(e){return e===-1?Pi.st_nullNode():this.m_treapData.getField(e,0)}getFirst_(e){return e===-1?Pi.st_nullNode():this.m_treapData.getField(e,1)}getLast_(e){return e===-1?Pi.st_nullNode():this.m_treapData.getField(e,2)}getDuplicateElement_(e){return e===-1?Pi.st_nullNode():this.m_treapData.getField(e,3)}getSize_(e){return e===-1?0:this.m_treapData.getField(e,4)}getTreapData_(e){return this.m_treapData.getField(e,5)}newNode_(e){const i=this.m_treapData.newElement();return this.setPriority_(i,this.generatePriority_()),this.setElement_(i,e),i}freeNode_(e,i){e!==Pi.st_nullNode()&&this.m_treapData.deleteElement(e)}generatePriority_(){return this.m_random=Tw(this.m_random),this.m_random&Aa()>>1}maxPriority(){return z(0),0}getMaxDepthHelper_(e){return e===Pi.st_nullNode()?0:1+Math.max(this.getMaxDepthHelper_(this.getLeft(e)),this.getMaxDepthHelper_(this.getRight(e)))}addElement_(e,i,s){if(this.getRoot(s)===Pi.st_nullNode()){const l=this.newNode_(e);return this.setRoot_(l,s),this.addToList_(-1,l,s),this.m_maxDepthEver=Math.max(this.m_maxDepthEver,1),l}let n=this.getRoot_(s),r=-1,o=-1,a=1;for(;;){const l=i===-1?1:this.m_comparator.compare(this,e,n);if(l<0){const u=this.getLeft(n);if(u===Pi.st_nullNode()){o=n,r=this.newNode_(e),this.setLeft_(n,r),this.setParent_(r,n);break}n=u}else{if(i===1&&l===0)return this.m_comparator.onAddUniqueElementFailedImpl(e),this.setDuplicateElement_(n,s),-1;const u=this.getRight(n);if(u===Pi.st_nullNode()){o=this.getNext(n),r=this.newNode_(e),this.setRight_(n,r),this.setParent_(r,n);break}n=u}a++}return this.bubbleUp_(r),this.getParent(r)===Pi.st_nullNode()&&this.setRoot_(r,s),this.addToList_(o,r,s),this.m_maxDepthEver=Math.max(a,this.m_maxDepthEver),r}removeFromList_(e,i){const s=this.getPrev(e),n=this.getNext(e);s!==-1?this.setNext_(s,n):this.setFirst_(n,i),n!==-1?this.setPrev_(n,s):this.setLast_(s,i),this.setSize_(this.getSize_(i)-1,i)}unbalancedDelete_(e,i){this.removeFromList_(e,i);let s=this.getLeft(e),n=this.getRight(e),r=this.getParent(e),o=e;if(s!==-1&&n!==-1){let l;this.m_random=Tw(this.m_random),l=this.m_random>Aa()>>1?this.getNext(e):this.getPrev(e);const u=this.getParent(l)===e;this.m_treapData.swapField(e,l,0),this.m_treapData.swapField(e,l,1),this.m_treapData.swapField(e,l,2),r!==-1?this.getLeft(r)===e?this.setLeft_(r,l):this.setRight_(r,l):this.setRoot_(l,i),u?(s===l?(this.setLeft_(l,e),this.setParent_(n,l)):n===l&&(this.setRight_(l,e),this.setParent_(s,l)),this.setParent_(e,l),r=l):(this.setParent_(s,l),this.setParent_(n,l),r=this.getParent(e),o=l),s=this.getLeft(e),n=this.getRight(e),s!==-1&&this.setParent_(s,e),n!==-1&&this.setParent_(n,e)}const a=s!==-1?s:n;r===-1?this.setRoot_(a,i):this.getLeft(r)===o?this.setLeft_(r,a):this.setRight_(r,a),a!==-1&&this.setParent_(a,r),this.freeNode_(e,i)}deleteNode_(e,i){this.setPriority_(e,Aa());let s=Pi.st_nullNode(),n=Pi.st_nullNode();const r=this.getRoot_(i),o=r===e;if(o&&(s=this.getLeft(r),n=this.getRight(r),s===Pi.st_nullNode()&&n===Pi.st_nullNode()))return this.removeFromList_(r,i),this.freeNode_(r,i),void this.setRoot_(Pi.st_nullNode(),i);this.bubbleDown_(e);const a=this.getParent(e);a!==Pi.st_nullNode()&&(this.getLeft(a)===e?this.setLeft_(a,Pi.st_nullNode()):this.setRight_(a,Pi.st_nullNode())),this.removeFromList_(e,i),this.freeNode_(e,i),o&&this.setRoot_(s===Pi.st_nullNode()||this.getParent(s)!==Pi.st_nullNode()?n:s,i)}setElement_(e,i){this.m_treapData.setField(e,3,i)}addBiggestElement_(e,i){if(this.getRoot_(i)===Pi.st_nullNode())return this.setRoot_(e,i),void this.addToList_(-1,e,i);const s=this.getLast_(i);this.setRight_(s,e),this.setParent_(e,s),this.bubbleUp_(e),this.getParent(e)===Pi.st_nullNode()&&this.setRoot_(e,i),this.addToList_(-1,e,i)}},gf=class zh{constructor(e){this.m_lists=new xs(6),this.m_listOfLists=zh.st_nullNode(),e===void 0?(this.m_listNodes=new xs(3),this.m_bStoreListIndexWithNode=!1):(this.m_listNodes=new xs(e?4:3),this.m_bStoreListIndexWithNode=e)}freeNode_(e){this.m_listNodes.deleteElement(e)}newNode_(){return this.m_listNodes.newElement()}freeList_(e){z(0)}newList_(){return this.m_lists.newElement()}setPrev_(e,i){this.m_listNodes.setField(e,1,i)}setNext_(e,i){this.m_listNodes.setField(e,2,i)}setData_(e,i){z(0)}setList_(e,i){return this.m_listNodes.setField(e,3,i)}setListSize_(e,i){this.m_lists.setField(e,4,i)}setNextList_(e,i){z(0)}setPrevList_(e,i){this.m_lists.setField(e,2,i)}createList(e){const i=this.newList_();return this.m_lists.setField(i,3,this.m_listOfLists),this.m_lists.setField(i,4,0),this.m_lists.setField(i,5,e),this.m_listOfLists!==zh.st_nullNode()&&this.setPrevList_(this.m_listOfLists,i),this.m_listOfLists=i,i}deleteList(e){this.clear(e);const i=this.m_lists.getField(e,2),s=this.m_lists.getField(e,3);return i!==zh.st_nullNode()?this.setNextList_(i,s):this.m_listOfLists=s,s!==zh.st_nullNode()&&this.setPrevList_(s,i),this.freeList_(e),s}reserveLists(e){z(0)}getListData(e){return this.m_lists.getField(e,5)}getList(e){return z(0),0}setListData(e,i){this.m_lists.setField(e,5,i)}addElement(e,i){return this.insertElement(e,-1,i)}insertElement(e,i,s){const n=this.newNode_();let r=-1;if(i!==zh.st_nullNode()&&(r=this.getPrev(i),this.setPrev_(i,n)),this.setNext_(n,i),r!==zh.st_nullNode()&&this.setNext_(r,n),i===this.m_lists.getField(e,0)&&this.m_lists.setField(e,0,n),i===zh.st_nullNode()){const o=this.m_lists.getField(e,1);this.setPrev_(n,o),o!==-1&&this.setNext_(o,n),this.m_lists.setField(e,1,n)}return this.setData(n,s),this.setListSize_(e,this.getListSize(e)+1),this.m_bStoreListIndexWithNode&&this.setList_(n,e),n}deleteElement(e,i){const s=this.getPrev(i),n=this.getNext(i);return s!==zh.st_nullNode()?this.setNext_(s,n):this.m_lists.setField(e,0,n),n!==zh.st_nullNode()?this.setPrev_(n,s):this.m_lists.setField(e,1,s),this.freeNode_(i),this.setListSize_(e,this.getListSize(e)-1),n}reserveNodes(e){this.m_listNodes.setCapacity(e)}getData(e){return this.m_listNodes.getField(e,0)}getElement(e){return this.getData(e)}setData(e,i){this.m_listNodes.setField(e,0,i)}getNext(e){return this.m_listNodes.getField(e,2)}getPrev(e){return this.m_listNodes.getField(e,1)}getFirst(e){return this.m_lists.getField(e,0)}getLast(e){return this.m_lists.getField(e,1)}static st_nullNode(){return-1}clear(e){if(e!==void 0){let i=this.getLast(e);for(;i!==zh.st_nullNode();){const s=i;i=this.getPrev(s),this.freeNode_(s)}return this.m_lists.setField(e,0,-1),this.m_lists.setField(e,1,-1),void this.setListSize_(e,0)}for(let i=this.getFirstList();i!==-1;)i=this.deleteList(i)}isEmpty(e){return z(0),!1}getNodeCount(){return this.m_listNodes.size()}getListCount(){return this.m_lists.size()}getListSize(e){return this.m_lists.getField(e,4)}getFirstList(){return this.m_listOfLists}getNextList(e){return this.m_lists.getField(e,3)}},Z3e=class extends B1{constructor(e){super(),this.m_intervalTree=e}compare(e,i,s){const n=e.getElement(s),r=this.m_intervalTree.getValue_(i),o=this.m_intervalTree.getValue_(n);return r<o?-1:r===o?Xc.isLeft_(i)&&Xc.isRight_(n)?-1:Xc.isLeft_(n)&&Xc.isRight_(i)?1:0:1}},Xc=class qC{constructor(e){this.m_bEnvelopesRef=!1,this.m_intervals=[],this.m_envelopesRef=null,this.m_intervalNodes=new xs(3),this.m_intervalHandles=[],this.m_endIndicesUnique=[],this.m_cCount=-1,this.m_root=-1,this.m_bSortIntervals=!1,this.m_bConstructing=!1,this.m_bConstructionEnded=!1,this.m_bOfflineDynamic=e,this.m_tertiaryNodes=new xs(this.m_bOfflineDynamic?5:4),this.m_secondaryTreaps=new mr,this.m_secondaryTreaps.setComparator(new Z3e(this)),this.m_secondaryLists=new gf}addEnvelopesRef(e){this.reset_(!0,!0),this.m_bEnvelopesRef=!0,this.m_envelopesRef=e,this.m_bConstructing=!1,this.m_bConstructionEnded=!0,this.m_bOfflineDynamic||(this.insertIntervalsStatic_(),this.m_cCount=this.m_envelopesRef.length)}startConstruction(){this.reset_(!0,!1)}addInterval(e){this.m_bConstructing||un(""),this.m_intervals.push(e.clone())}addIntervalCoords(e,i){z(0)}endConstruction(){this.m_bConstructing||un(""),this.m_bConstructing=!1,this.m_bConstructionEnded=!0,this.m_bOfflineDynamic||(this.insertIntervalsStatic_(),this.m_cCount=this.m_intervals.length)}insert(e){if(this.m_bOfflineDynamic&&this.m_bConstructionEnded||un(""),this.m_root===-1){const r=this.m_bEnvelopesRef?this.m_envelopesRef.length:this.m_intervals.length;if(this.m_bSortIntervals){const o=new Un(0);this.querySortedEndPointIndices_(o),this.m_endIndicesUnique.length=0,this.querySortedDuplicatesRemoved_(o),this.m_intervalHandles.length=r,this.m_intervalHandles.fill(-1),this.m_bSortIntervals=!1}else this.m_intervalHandles.fill(-1,0,r);this.m_root=this.createRoot_()}const i=this.insertIntervalEnd_(e<<1,this.m_root),s=this.getSecondaryFromInterval_(i),n=this.m_secondaryTreaps.addElement(1+(e<<1),s);this.setRightEnd_(i,n),this.m_intervalHandles[e]=i,this.m_cCount++}remove(e){this.m_bOfflineDynamic&&this.m_bConstructionEnded||un("");const i=this.m_intervalHandles[e];let s;i===-1&&ce("the interval does not exist in the interval tree"),this.m_intervalHandles[e]=-1,this.m_cCount--;let n=this.getSecondaryFromInterval_(i),r=-1;r=this.m_secondaryTreaps.getTreapData(n),this.m_secondaryTreaps.deleteNode(this.getLeftEnd_(i),n),this.m_secondaryTreaps.deleteNode(this.getRightEnd_(i),n),s=this.m_secondaryTreaps.size(n),s===0&&(this.m_secondaryTreaps.deleteTreap(n),this.setSecondaryToTertiary_(r,-1)),this.m_intervalNodes.deleteElement(i);let o=this.getPptr_(r),a=this.getLptr_(r),l=this.getRptr_(r);for(;!(s>0||r===this.m_root||a!==-1&&l!==-1);)r===this.getLptr_(o)?a!==-1?(this.setLptr_(o,a),this.setPptr_(a,o),this.setLptr_(r,-1),this.setPptr_(r,-1)):l!==-1?(this.setLptr_(o,l),this.setPptr_(l,o),this.setRptr_(r,-1),this.setPptr_(r,-1)):(this.setLptr_(o,-1),this.setPptr_(r,-1)):a!==-1?(this.setRptr_(o,a),this.setPptr_(a,o),this.setLptr_(r,-1),this.setPptr_(r,-1)):l!==-1?(this.setRptr_(o,l),this.setPptr_(l,o),this.setRptr_(r,-1),this.setPptr_(r,-1)):(this.setRptr_(o,-1),this.setPptr_(r,-1)),this.m_tertiaryNodes.deleteElement(r),r=o,n=this.getSecondaryFromTertiary_(r),s=n!==-1?this.m_secondaryTreaps.size(n):0,a=this.getLptr_(r),l=this.getRptr_(r),o=this.getPptr_(r)}size(){return this.m_cCount}getIteratorQuery(e,i){return e instanceof Me?new aJ(this,e,i):(z(0),{})}getIterator(){return new aJ(this)}querySortedEndPointIndices_(e){const i=this.m_bEnvelopesRef?this.m_envelopesRef.length:this.m_intervals.length;for(let s=0;s<2*i;s++)e.add(s);this.sortEndIndices_(e,0,2*i)}querySortedDuplicatesRemoved_(e){let i=Number.NaN;for(let s=0;s<e.size();s++){const n=e.read(s),r=this.getValue_(n);r!==i&&(this.m_endIndicesUnique.push(n),i=r)}}insertIntervalsStatic_(){const e=this.m_bEnvelopesRef?this.m_envelopesRef.length:this.m_intervals.length,i=new Un(0);this.querySortedEndPointIndices_(i),this.m_endIndicesUnique.length=0,this.querySortedDuplicatesRemoved_(i),this.m_intervalNodes.setCapacity(e),this.m_secondaryLists.reserveNodes(2*e);const s=st(e,-1);this.m_root=this.createRoot_();for(let n=0;n<i.size();n++){const r=i.read(n);let o=s[r>>1];if(o!==-1){const a=this.getSecondaryFromInterval_(o);this.setRightEnd_(o,this.m_secondaryLists.addElement(a,r))}else o=this.insertIntervalEnd_(r,this.m_root),s[r>>1]=o}}createRoot_(){const e=this.calculateDiscriminantIndex1_(0,this.m_endIndicesUnique.length-1);return this.createTertiaryNode_(e)}insertIntervalEnd_(e,i){let s=-1,n=i,r=-1,o=-1,a=0,l=this.m_endIndicesUnique.length-1,u=0;const c=e>>1;let h=Number.NaN,d=Number.NaN,m=!0;const f=this.getMin_(c),_=this.getMax_(c);let v=-1;for(;m;){u=a+(l-a>>1),v=this.calculateDiscriminantIndex1_(a,l);const x=this.getDiscriminantFromIndex1_(v);if(_<x){if(n!==-1){if(v===this.getDiscriminantIndex1_(n))s=n,h=x,n=this.getLptr_(n),d=n!==-1?this.getDiscriminant_(n):Number.NaN;else if(d>x){const C=this.createTertiaryNode_(v);x<h?this.setLptr_(s,C):this.setRptr_(s,C),this.setRptr_(C,n),this.m_bOfflineDynamic&&(this.setPptr_(C,s),this.setPptr_(n,C)),s=C,h=x,n=-1,d=Number.NaN}}l=u;continue}if(f>x){if(n!==-1){if(v===this.getDiscriminantIndex1_(n))s=n,h=x,n=this.getRptr_(n),d=n!==-1?this.getDiscriminant_(n):Number.NaN;else if(d<x){const C=this.createTertiaryNode_(v);x<h?this.setLptr_(s,C):this.setRptr_(s,C),this.setLptr_(C,n),this.m_bOfflineDynamic&&(this.setPptr_(C,s),this.setPptr_(n,C)),s=C,h=x,n=-1,d=Number.NaN}}a=u+1;continue}let w=-1;w=n===-1||v!==this.getDiscriminantIndex1_(n)?this.createTertiaryNode_(v):n,r=this.getSecondaryFromTertiary_(w),r===-1&&(r=this.createSecondary_(w),this.setSecondaryToTertiary_(w,r));const T=this.addEndIndex_(r,e);o=this.createIntervalNode_(),this.setSecondaryToInterval_(o,r),this.setLeftEnd_(o,T),n!==-1&&v===this.getDiscriminantIndex1_(n)||(x<h?this.setLptr_(s,w):this.setRptr_(s,w),this.m_bOfflineDynamic&&this.setPptr_(w,s),n!==-1&&(d<x?this.setLptr_(w,n):this.setRptr_(w,n),this.m_bOfflineDynamic&&this.setPptr_(n,w))),m=!1;break}return o}createTertiaryNode_(e){const i=this.m_tertiaryNodes.newElement();return this.setDiscriminantIndex1_(i,e),i}createSecondary_(e){return this.m_bOfflineDynamic?this.m_secondaryTreaps.createTreap(e):this.m_secondaryLists.createList(e)}createIntervalNode_(){return this.m_intervalNodes.newElement()}reset(){this.m_bOfflineDynamic&&this.m_bConstructionEnded||un(""),this.reset_(!1,this.m_bEnvelopesRef)}reset_(e,i){e?(this.m_bEnvelopesRef=!1,this.m_envelopesRef=null,this.m_bSortIntervals=!0,this.m_bConstructing=!0,this.m_bConstructionEnded=!1,this.m_endIndicesUnique.length=0,i?(this.m_intervals.length=0,this.m_bEnvelopesRef=!0):this.m_intervals.length=0):this.m_bSortIntervals=!1,this.m_bOfflineDynamic?this.m_secondaryTreaps.clear():this.m_secondaryLists.clear(),this.m_intervalNodes.deleteAll(!1),this.m_tertiaryNodes.deleteAll(!1),this.m_root=-1,this.m_cCount=0}getDiscriminant_(e){const i=this.getDiscriminantIndex1_(e);return this.getDiscriminantFromIndex1_(i)}getDiscriminantFromIndex1_(e){if(e===-1)return Number.NaN;if(e>0){const n=e-2,r=this.m_endIndicesUnique[n],o=this.m_endIndicesUnique[n+1];return .5*(this.getValue_(r)+this.getValue_(o))}const i=-e-2,s=this.m_endIndicesUnique[i];return this.getValue_(s)}calculateDiscriminantIndex1_(e,i){let s;return e<i?s=e+(i-e>>1)+2:s=-(e+2),s}setDiscriminantIndex1_(e,i){this.m_tertiaryNodes.setField(e,0,i)}setSecondaryToTertiary_(e,i){this.m_tertiaryNodes.setField(e,1,i)}setLptr_(e,i){this.m_tertiaryNodes.setField(e,2,i)}setRptr_(e,i){this.m_tertiaryNodes.setField(e,3,i)}setPptr_(e,i){this.m_tertiaryNodes.setField(e,4,i)}setSecondaryToInterval_(e,i){this.m_intervalNodes.setField(e,0,i)}addEndIndex_(e,i){let s=-1;return s=this.m_bOfflineDynamic?this.m_secondaryTreaps.addElement(i,e):this.m_secondaryLists.addElement(e,i),s}setLeftEnd_(e,i){this.m_intervalNodes.setField(e,1,i)}setRightEnd_(e,i){this.m_intervalNodes.setField(e,2,i)}getFirst_(e){return this.m_bOfflineDynamic?this.m_secondaryTreaps.getFirst(e):this.m_secondaryLists.getFirst(e)}getLast_(e){return this.m_bOfflineDynamic?this.m_secondaryTreaps.getLast(e):this.m_secondaryLists.getLast(e)}static isLeft_(e){return!(1&e)}static isRight_(e){return!(1&~e)}getDiscriminantIndex1_(e){return this.m_tertiaryNodes.getField(e,0)}getSecondaryFromTertiary_(e){return this.m_tertiaryNodes.getField(e,1)}getLptr_(e){return this.m_tertiaryNodes.getField(e,2)}getRptr_(e){return this.m_tertiaryNodes.getField(e,3)}getPptr_(e){return this.m_tertiaryNodes.getField(e,4)}getSecondaryFromInterval_(e){return this.m_intervalNodes.getField(e,0)}getLeftEnd_(e){return this.m_intervalNodes.getField(e,1)}getRightEnd_(e){return this.m_intervalNodes.getField(e,2)}getMin_(e){return this.m_bEnvelopesRef?this.m_envelopesRef[e].xmin:this.m_intervals[e].vmin}getMax_(e){return this.m_bEnvelopesRef?this.m_envelopesRef[e].xmax:this.m_intervals[e].vmax}sortEndIndices_(e,i,s){const n=this,r={userSort(o,a,l){n.sortEndIndicesHelper_(l,o,a)},getValue:o=>n.getValue_(o)};new Uy().sort(e,i,s,r)}sortEndIndicesHelper_(e,i,s){e.sort(i,s,(n,r)=>{const o=this.getValue_(n),a=this.getValue_(r);return o<a||o===a&&qC.isLeft_(n)&&qC.isRight_(r)?-1:1})}getValue_(e){if(!this.m_bEnvelopesRef){const s=this.m_intervals[e>>1];return qC.isLeft_(e)?s.vmin:s.vmax}const i=this.m_envelopesRef[e>>1];return qC.isLeft_(e)?i.xmin:i.xmax}};class aJ{constructor(e,i,s){this.m_query=Me.constructEmpty(),this.m_tertiaryHandle=-1,this.m_nextTertiaryHandle=-1,this.m_forkedHandle=-1,this.m_currentEndHandle=-1,this.m_nextEndHandle=-1,this.m_tertiaryStack=[],this.m_functionIndex=0,this.m_intervalTree=e,this.m_functionStack=new Array(2),this.m_functionStack[0]=this.nullFunc_,this.m_functionStack[1]=this.nullFunc_,i!==void 0&&this.resetIterator(i,s)}nullFunc_(){return We("should not be called"),!1}resetIterator(e,i){if(typeof e=="number"){const s=new Me;s.setCoords(e,e),this.resetIterator(s,i)}else i===void 0&&(i=0),this.m_query.vmin=e.vmin-i,this.m_query.vmax=e.vmax+i,this.m_tertiaryStack.length=0,this.m_functionIndex=0,this.m_functionStack[0]=this.initialize_}next(){if(this.m_intervalTree.m_bConstructionEnded||un(""),this.m_functionIndex<0)return-1;for(;this.m_fi=this.m_functionStack[this.m_functionIndex],this.m_fi(););return this.m_currentEndHandle!==-1?this.getCurrentEndIndex_()>>1:-1}initialize_(){return this.m_tertiaryHandle=-1,this.m_nextTertiaryHandle=-1,this.m_forkedHandle=-1,this.m_currentEndHandle=-1,this.m_intervalTree.m_tertiaryNodes.size()>0?(this.m_functionStack[0]=this.pIn_,this.m_nextTertiaryHandle=this.m_intervalTree.m_root,!0):(this.m_functionIndex=-1,!1)}pIn_(){if(this.m_tertiaryHandle=this.m_nextTertiaryHandle,this.m_tertiaryHandle===-1)return this.m_functionIndex=-1,this.m_currentEndHandle=-1,!1;const e=this.m_intervalTree.getDiscriminant_(this.m_tertiaryHandle);if(this.m_query.vmax<e){const s=this.m_intervalTree.getSecondaryFromTertiary_(this.m_tertiaryHandle);return this.m_nextTertiaryHandle=this.m_intervalTree.getLptr_(this.m_tertiaryHandle),s!==-1&&(this.m_nextEndHandle=this.m_intervalTree.getFirst_(s),this.m_functionStack[++this.m_functionIndex]=this.left_),!0}if(e<this.m_query.vmin){const s=this.m_intervalTree.getSecondaryFromTertiary_(this.m_tertiaryHandle);return this.m_nextTertiaryHandle=this.m_intervalTree.getRptr_(this.m_tertiaryHandle),s!==-1&&(this.m_nextEndHandle=this.m_intervalTree.getLast_(s),this.m_functionStack[++this.m_functionIndex]=this.right_),!0}this.m_functionStack[this.m_functionIndex]=this.pL_,this.m_forkedHandle=this.m_tertiaryHandle;const i=this.m_intervalTree.getSecondaryFromTertiary_(this.m_tertiaryHandle);return this.m_nextTertiaryHandle=this.m_intervalTree.getLptr_(this.m_tertiaryHandle),i!==-1&&(this.m_nextEndHandle=this.m_intervalTree.getFirst_(i),this.m_functionStack[++this.m_functionIndex]=this.all_),!0}pL_(){if(this.m_tertiaryHandle=this.m_nextTertiaryHandle,this.m_tertiaryHandle===-1)return this.m_functionStack[this.m_functionIndex]=this.pR_,this.m_nextTertiaryHandle=this.m_intervalTree.getRptr_(this.m_forkedHandle),!0;if(this.m_intervalTree.getDiscriminant_(this.m_tertiaryHandle)<this.m_query.vmin){const s=this.m_intervalTree.getSecondaryFromTertiary_(this.m_tertiaryHandle);return this.m_nextTertiaryHandle=this.m_intervalTree.getRptr_(this.m_tertiaryHandle),s!==-1&&(this.m_nextEndHandle=this.m_intervalTree.getLast_(s),this.m_functionStack[++this.m_functionIndex]=this.right_),!0}const e=this.m_intervalTree.getSecondaryFromTertiary_(this.m_tertiaryHandle);this.m_nextTertiaryHandle=this.m_intervalTree.getLptr_(this.m_tertiaryHandle),e!==-1&&(this.m_nextEndHandle=this.m_intervalTree.getFirst_(e),this.m_functionStack[++this.m_functionIndex]=this.all_);const i=this.m_intervalTree.getRptr_(this.m_tertiaryHandle);return i!==-1&&this.m_tertiaryStack.push(i),!0}pR_(){if(this.m_tertiaryHandle=this.m_nextTertiaryHandle,this.m_tertiaryHandle===-1)return this.m_functionStack[this.m_functionIndex]=this.pT_,!0;const e=this.m_intervalTree.getDiscriminant_(this.m_tertiaryHandle);if(this.m_query.vmax<e){const n=this.m_intervalTree.getSecondaryFromTertiary_(this.m_tertiaryHandle);return this.m_nextTertiaryHandle=this.m_intervalTree.getLptr_(this.m_tertiaryHandle),n!==-1&&(this.m_nextEndHandle=this.m_intervalTree.getFirst_(n),this.m_functionStack[++this.m_functionIndex]=this.left_),!0}const i=this.m_intervalTree.getSecondaryFromTertiary_(this.m_tertiaryHandle);this.m_nextTertiaryHandle=this.m_intervalTree.getRptr_(this.m_tertiaryHandle),i!==-1&&(this.m_nextEndHandle=this.m_intervalTree.getFirst_(i),this.m_functionStack[++this.m_functionIndex]=this.all_);const s=this.m_intervalTree.getLptr_(this.m_tertiaryHandle);return s!==-1&&this.m_tertiaryStack.push(s),!0}pT_(){if(this.m_tertiaryStack.length===0)return this.m_functionIndex=-1,this.m_currentEndHandle=-1,!1;this.m_tertiaryHandle=this.m_tertiaryStack.at(-1),this.m_tertiaryStack.pop();const e=this.m_intervalTree.getSecondaryFromTertiary_(this.m_tertiaryHandle);return e!==-1&&(this.m_nextEndHandle=this.m_intervalTree.getFirst_(e),this.m_functionStack[++this.m_functionIndex]=this.all_),this.m_intervalTree.getLptr_(this.m_tertiaryHandle)!==-1&&this.m_tertiaryStack.push(this.m_intervalTree.getLptr_(this.m_tertiaryHandle)),this.m_intervalTree.getRptr_(this.m_tertiaryHandle)!==-1&&this.m_tertiaryStack.push(this.m_intervalTree.getRptr_(this.m_tertiaryHandle)),!0}left_(){return this.m_currentEndHandle=this.m_nextEndHandle,this.m_currentEndHandle!==-1&&Xc.isLeft_(this.getCurrentEndIndex_())&&this.m_intervalTree.getValue_(this.getCurrentEndIndex_())<=this.m_query.vmax?(this.m_nextEndHandle=this.getNext_(),!1):(this.m_functionIndex--,!0)}right_(){return this.m_currentEndHandle=this.m_nextEndHandle,this.m_currentEndHandle!==-1&&Xc.isRight_(this.getCurrentEndIndex_())&&this.m_intervalTree.getValue_(this.getCurrentEndIndex_())>=this.m_query.vmin?(this.m_nextEndHandle=this.getPrev_(),!1):(this.m_functionIndex--,!0)}all_(){return this.m_currentEndHandle=this.m_nextEndHandle,this.m_currentEndHandle!==-1&&Xc.isLeft_(this.getCurrentEndIndex_())?(this.m_nextEndHandle=this.getNext_(),!1):(this.m_functionIndex--,!0)}getNext_(){return this.m_intervalTree.m_bOfflineDynamic?this.m_intervalTree.m_secondaryTreaps.getNext(this.m_currentEndHandle):this.m_intervalTree.m_secondaryLists.getNext(this.m_currentEndHandle)}getPrev_(){return this.m_intervalTree.m_bOfflineDynamic?this.m_intervalTree.m_secondaryTreaps.getPrev(this.m_currentEndHandle):this.m_intervalTree.m_secondaryLists.getPrev(this.m_currentEndHandle)}getCurrentEndIndex_(){return this.m_intervalTree.m_bOfflineDynamic?this.m_intervalTree.m_secondaryTreaps.getElement(this.m_currentEndHandle):this.m_intervalTree.m_secondaryLists.getData(this.m_currentEndHandle)}}let hA=class{constructor(){this.m_tolerance=0,this.m_sweepIndexRed=-1,this.m_sweepIndexBlue=-1,this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_intervalTreeRed=null,this.m_intervalTreeBlue=null,this.m_iteratorRed=null,this.m_iteratorBlue=null,this.m_envelopesRed=[],this.m_envelopesBlue=[],this.m_elementsRed=[],this.m_elementsBlue=[],this.m_sortedEndIndicesRed=new Un(0),this.m_sortedEndIndicesBlue=new Un(0),this.m_queuedListRed=-1,this.m_queuedListBlue=-1,this.m_queuedEnvelopes=new gf,this.m_queuedIndicesRed=[],this.m_queuedIndicesBlue=[],this.m_bAddRed=!1,this.m_bAddBlue=!1,this.m_bAddRedRed=!1,this.m_bDone=!0,this.m_function=this.nullFunc_,this.reset_()}startConstruction(){this.reset_(),this.m_bAddRedRed=!0,this.m_elementsRed.length=0,this.m_envelopesRed.length=0}addEnvelope(e,i){this.m_bAddRedRed||un(""),this.m_elementsRed.push(e),this.m_envelopesRed.push(new J(i))}endConstruction(){this.m_bAddRedRed||un(""),this.m_bAddRedRed=!1,this.m_envelopesRed.length>0&&(this.m_function=this.initialize_,this.m_bDone=!1)}startRedConstruction(){this.reset_(),this.m_bAddRed=!0,this.m_elementsRed.length=0,this.m_envelopesRed.length=0}addRedEnvelope(e,i){this.m_bAddRed||un(""),this.m_elementsRed.push(e),this.m_envelopesRed.push(i.clone())}endRedConstruction(){this.m_bAddRed||un(""),this.m_bAddRed=!1,this.m_envelopesRed.length>0&&this.m_envelopesBlue.length>0&&(this.m_function===this.nullFunc_||this.m_function===this.initializeBlue_?this.m_function=this.initializeRedBlue_:this.m_function!==this.initializeRedBlue_&&(this.m_function=this.initializeRed_),this.m_bDone=!1)}startBlueConstruction(){this.reset_(),this.m_bAddBlue=!0,this.m_elementsBlue.length=0,this.m_envelopesBlue.length=0}addBlueEnvelope(e,i){this.m_bAddBlue||un(""),this.m_elementsBlue.push(e),this.m_envelopesBlue.push(i.clone())}endBlueConstruction(){this.m_bAddBlue||un(""),this.m_bAddBlue=!1,this.m_envelopesRed.length>0&&this.m_envelopesBlue.length>0&&(this.m_function===this.nullFunc_||this.m_function===this.initializeRed_?this.m_function=this.initializeRedBlue_:this.m_function!==this.initializeRedBlue_&&(this.m_function=this.initializeBlue_),this.m_bDone=!1)}next(){if(this.m_bDone)return!1;for(;this.m_function(););return!this.m_bDone}getHandleA(){return this.m_envelopeHandleA}getHandleB(){return this.m_envelopeHandleB}setTolerance(e){this.m_tolerance=e}getElement(e){return this.m_elementsRed[e]}getRedEnvelope(e){return this.m_envelopesRed[e]}getBlueEnvelope(e){return this.m_envelopesBlue[e]}getRedElement(e){return this.m_elementsRed[e]}getBlueElement(e){return this.m_elementsBlue[e]}isTop_(e){return!(1&~e)}isBottom_(e){return!(1&e)}reset_(){this.m_bAddRed=!1,this.m_bAddBlue=!1,this.m_bAddRedRed=!1,this.m_sweepIndexRed=-1,this.m_sweepIndexBlue=-1,this.m_queuedListRed=-1,this.m_queuedListBlue=-1,this.m_bDone=!0}initialize_(){if(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_envelopesRed.length<10)return this.m_sweepIndexRed=this.m_envelopesRed.length,this.m_function=this.sweepBruteForce_,!0;this.m_intervalTreeRed||(this.m_intervalTreeRed=new Xc(!0)),this.m_intervalTreeRed.addEnvelopesRef(this.m_envelopesRed),this.m_iteratorRed===null&&(this.m_iteratorRed=this.m_intervalTreeRed.getIterator()),this.m_sortedEndIndicesRed.resize(0);for(let e=0;e<2*this.m_envelopesRed.length;e++)this.m_sortedEndIndicesRed.add(e);return this.sortYEndIndices_(this.m_sortedEndIndicesRed,0,2*this.m_envelopesRed.length,!0),this.m_sweepIndexRed=2*this.m_envelopesRed.length,this.m_function=this.sweep_,!0}initializeRed_(){if(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_envelopesRed.length<10||this.m_envelopesBlue.length<10)return this.m_sweepIndexRed=this.m_envelopesRed.length,this.m_function=this.sweepRedBlueBruteForce_,!0;this.m_intervalTreeRed||(this.m_intervalTreeRed=new Xc(!0)),this.m_intervalTreeRed.addEnvelopesRef(this.m_envelopesRed),this.m_iteratorRed===null&&(this.m_iteratorRed=this.m_intervalTreeRed.getIterator()),this.m_sortedEndIndicesRed.resize(0);for(let e=0;e<2*this.m_envelopesRed.length;e++)this.m_sortedEndIndicesRed.add(e);return this.sortYEndIndices_(this.m_sortedEndIndicesRed,0,this.m_sortedEndIndicesRed.size(),!0),this.m_sweepIndexRed=this.m_sortedEndIndicesRed.size(),this.m_queuedListRed!==-1&&(this.m_queuedEnvelopes.deleteList(this.m_queuedListRed),this.m_queuedIndicesRed.length=0,this.m_queuedListRed=-1),this.m_function=this.sweepRedBlue_,this.resetBlue_()}initializeBlue_(){if(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_envelopesRed.length<10||this.m_envelopesBlue.length<10)return this.m_sweepIndexRed=this.m_envelopesRed.length,this.m_function=this.sweepRedBlueBruteForce_,!0;this.m_intervalTreeBlue||(this.m_intervalTreeBlue=new Xc(!0)),this.m_intervalTreeBlue.addEnvelopesRef(this.m_envelopesBlue),this.m_iteratorBlue==null&&(this.m_iteratorBlue=this.m_intervalTreeBlue.getIterator()),this.m_sortedEndIndicesBlue.resize(0);for(let e=0;e<2*this.m_envelopesBlue.length;e++)this.m_sortedEndIndicesBlue.add(e);return this.sortYEndIndices_(this.m_sortedEndIndicesBlue,0,this.m_sortedEndIndicesBlue.size(),!1),this.m_sweepIndexBlue=this.m_sortedEndIndicesBlue.size(),this.m_queuedListBlue!==-1&&(this.m_queuedEnvelopes.deleteList(this.m_queuedListBlue),this.m_queuedIndicesBlue.length=0,this.m_queuedListBlue=-1),this.m_function=this.sweepRedBlue_,this.resetRed_()}initializeRedBlue_(){if(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_envelopesRed.length<10||this.m_envelopesBlue.length<10)return this.m_sweepIndexRed=this.m_envelopesRed.length,this.m_function=this.sweepRedBlueBruteForce_,!0;this.m_intervalTreeRed||(this.m_intervalTreeRed=new Xc(!0)),this.m_intervalTreeBlue||(this.m_intervalTreeBlue=new Xc(!0)),this.m_intervalTreeRed.addEnvelopesRef(this.m_envelopesRed),this.m_intervalTreeBlue.addEnvelopesRef(this.m_envelopesBlue),this.m_iteratorRed===null&&(this.m_iteratorRed=this.m_intervalTreeRed.getIterator()),this.m_iteratorBlue===null&&(this.m_iteratorBlue=this.m_intervalTreeBlue.getIterator()),this.m_sortedEndIndicesRed.resize(0),this.m_sortedEndIndicesBlue.resize(0);for(let e=0;e<2*this.m_envelopesRed.length;e++)this.m_sortedEndIndicesRed.add(e);for(let e=0;e<2*this.m_envelopesBlue.length;e++)this.m_sortedEndIndicesBlue.add(e);return this.sortYEndIndices_(this.m_sortedEndIndicesRed,0,this.m_sortedEndIndicesRed.size(),!0),this.sortYEndIndices_(this.m_sortedEndIndicesBlue,0,this.m_sortedEndIndicesBlue.size(),!1),this.m_sweepIndexRed=this.m_sortedEndIndicesRed.size(),this.m_sweepIndexBlue=this.m_sortedEndIndicesBlue.size(),this.m_queuedListRed!==-1&&(this.m_queuedEnvelopes.deleteList(this.m_queuedListRed),this.m_queuedIndicesRed.length=0,this.m_queuedListRed=-1),this.m_queuedListBlue!==-1&&(this.m_queuedEnvelopes.deleteList(this.m_queuedListBlue),this.m_queuedIndicesBlue.length=0,this.m_queuedListBlue=-1),this.m_function=this.sweepRedBlue_,!0}sweep_(){const e=this.m_sortedEndIndicesRed.read(--this.m_sweepIndexRed),i=e>>1;if(this.isBottom_(e))return this.m_intervalTreeRed.remove(i),this.m_sweepIndexRed!==0||(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_bDone=!0,!1);const s=Me.construct(this.m_envelopesRed[i].xmin,this.m_envelopesRed[i].xmax);return this.m_iteratorRed.resetIterator(s,this.m_tolerance),this.m_envelopeHandleA=i,this.m_function=this.iterate_,!0}sweepBruteForce_(){return--this.m_sweepIndexRed==-1?(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_bDone=!0,!1):(this.m_envelopeHandleA=this.m_sweepIndexRed,this.m_sweepIndexBlue=this.m_sweepIndexRed,this.m_function=this.iterateBruteForce_,!0)}sweepRedBlueBruteForce_(){return--this.m_sweepIndexRed==-1?(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_bDone=!0,!1):(this.m_envelopeHandleA=this.m_sweepIndexRed,this.m_sweepIndexBlue=this.m_envelopesBlue.length,this.m_function=this.iterateRedBlueBruteForce_,!0)}sweepRedBlue_(){const e=this.m_sortedEndIndicesRed.read(this.m_sweepIndexRed-1),i=this.m_sortedEndIndicesBlue.read(this.m_sweepIndexBlue-1),s=this.getAdjustedValue_(e,!0),n=this.getAdjustedValue_(i,!1);return s>n?this.sweepRed_():s<n?this.sweepBlue_():this.isTop_(e)?this.sweepRed_():this.isTop_(i)?this.sweepBlue_():this.sweepRed_()}sweepRed_(){const e=this.m_sortedEndIndicesRed.read(--this.m_sweepIndexRed),i=e>>1;if(this.isBottom_(e))return this.m_queuedListRed!==-1&&this.m_queuedIndicesRed[i]!==-1?(this.m_queuedEnvelopes.deleteElement(this.m_queuedListRed,this.m_queuedIndicesRed[i]),this.m_queuedIndicesRed[i]=-1):this.m_intervalTreeRed.remove(i),this.m_sweepIndexRed!==0||(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_bDone=!0,!1);if(this.m_queuedListBlue!==-1&&this.m_queuedEnvelopes.getListSize(this.m_queuedListBlue)>0){let s=this.m_queuedEnvelopes.getFirst(this.m_queuedListBlue);for(;s!==-1;){const n=this.m_queuedEnvelopes.getData(s);this.m_intervalTreeBlue.insert(n),this.m_queuedIndicesBlue[n]=-1;const r=this.m_queuedEnvelopes.getNext(s);this.m_queuedEnvelopes.deleteElement(this.m_queuedListBlue,s),s=r}}if(this.m_intervalTreeBlue.size()>0){const s=Me.construct(this.m_envelopesRed[i].xmin,this.m_envelopesRed[i].xmax);this.m_iteratorBlue.resetIterator(s,this.m_tolerance),this.m_envelopeHandleA=i,this.m_function=this.iterateBlue_}else this.m_queuedListRed===-1&&(QO(this.m_queuedIndicesRed,this.m_envelopesRed.length,-1),this.m_queuedListRed=this.m_queuedEnvelopes.createList(1)),this.m_queuedIndicesRed[i]=this.m_queuedEnvelopes.addElement(this.m_queuedListRed,i),this.m_function=this.sweepRedBlue_;return!0}sweepBlue_(){const e=this.m_sortedEndIndicesBlue.read(--this.m_sweepIndexBlue),i=e>>1;if(this.isBottom_(e))return this.m_queuedListBlue!==-1&&this.m_queuedIndicesBlue[i]!==-1?(this.m_queuedEnvelopes.deleteElement(this.m_queuedListBlue,this.m_queuedIndicesBlue[i]),this.m_queuedIndicesBlue[i]=-1):this.m_intervalTreeBlue.remove(i),this.m_sweepIndexBlue!==0||(this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1,this.m_bDone=!0,!1);if(this.m_queuedListRed!==-1&&this.m_queuedEnvelopes.getListSize(this.m_queuedListRed)>0){let s=this.m_queuedEnvelopes.getFirst(this.m_queuedListRed);for(;s!==-1;){const n=this.m_queuedEnvelopes.getData(s);this.m_intervalTreeRed.insert(n),this.m_queuedIndicesRed[n]=-1;const r=this.m_queuedEnvelopes.getNext(s);this.m_queuedEnvelopes.deleteElement(this.m_queuedListRed,s),s=r}}if(this.m_intervalTreeRed.size()>0){const s=Me.construct(this.m_envelopesBlue[i].xmin,this.m_envelopesBlue[i].xmax);this.m_iteratorRed.resetIterator(s,this.m_tolerance),this.m_envelopeHandleB=i,this.m_function=this.iterateRed_}else this.m_queuedListBlue===-1&&(QO(this.m_queuedIndicesBlue,this.m_envelopesBlue.length,-1),this.m_queuedListBlue=this.m_queuedEnvelopes.createList(0)),this.m_queuedIndicesBlue[i]=this.m_queuedEnvelopes.addElement(this.m_queuedListBlue,i),this.m_function=this.sweepRedBlue_;return!0}iterate_(){if(this.m_envelopeHandleB=this.m_iteratorRed.next(),this.m_envelopeHandleB!==-1)return!1;const e=this.m_sortedEndIndicesRed.read(this.m_sweepIndexRed)>>1;return this.m_intervalTreeRed.insert(e),this.m_function=this.sweep_,!0}iterateRed_(){if(this.m_envelopeHandleA=this.m_iteratorRed.next(),this.m_envelopeHandleA!==-1)return!1;this.m_envelopeHandleA=-1,this.m_envelopeHandleB=-1;const e=this.m_sortedEndIndicesBlue.read(this.m_sweepIndexBlue)>>1;return this.m_intervalTreeBlue.insert(e),this.m_function=this.sweepRedBlue_,!0}iterateBlue_(){if(this.m_envelopeHandleB=this.m_iteratorBlue.next(),this.m_envelopeHandleB!==-1)return!1;const e=this.m_sortedEndIndicesRed.read(this.m_sweepIndexRed)>>1;return this.m_intervalTreeRed.insert(e),this.m_function=this.sweepRedBlue_,!0}iterateBruteForce_(){if(--this.m_sweepIndexBlue==-1)return this.m_function=this.sweepBruteForce_,!0;const e=this.m_envelopesRed[this.m_sweepIndexRed].clone(),i=this.m_envelopesRed[this.m_sweepIndexBlue];return e.inflateCoords(this.m_tolerance,this.m_tolerance),!e.isIntersecting(i)||(this.m_envelopeHandleB=this.m_sweepIndexBlue,!1)}iterateRedBlueBruteForce_(){if(--this.m_sweepIndexBlue==-1)return this.m_function=this.sweepRedBlueBruteForce_,!0;const e=this.m_envelopesRed[this.m_sweepIndexRed].clone(),i=this.m_envelopesBlue[this.m_sweepIndexBlue];return e.inflateCoords(this.m_tolerance,this.m_tolerance),!e.isIntersecting(i)||(this.m_envelopeHandleB=this.m_sweepIndexBlue,!1)}resetRed_(){return this.m_sweepIndexRed=this.m_sortedEndIndicesRed.size(),this.m_intervalTreeRed.size()>0&&this.m_intervalTreeRed.reset(),this.m_queuedListRed!==-1&&(this.m_queuedEnvelopes.deleteList(this.m_queuedListRed),this.m_queuedIndicesRed.length=0,this.m_queuedListRed=-1),this.m_bDone=!1,!0}resetBlue_(){return this.m_sweepIndexBlue=this.m_sortedEndIndicesBlue.size(),this.m_intervalTreeBlue.size()>0&&this.m_intervalTreeBlue.reset(),this.m_queuedListBlue!==-1&&(this.m_queuedEnvelopes.deleteList(this.m_queuedListBlue),this.m_queuedIndicesBlue.length=0,this.m_queuedListBlue=-1),this.m_bDone=!1,!0}nullFunc_(){return We("should not be called"),!1}sortYEndIndices_(e,i,s,n){const r=this,o={userSort(a,l,u){r.sortYEndIndicesHelper_(u,a,l,n)},getValue:a=>r.getAdjustedValue_(a,n)};new Uy().sort(e,i,s,o)}sortYEndIndicesHelper_(e,i,s,n){e.sort(i,s,(r,o)=>{const a=this.getAdjustedValue_(r,n),l=this.getAdjustedValue_(o,n);return a<l||a===l&&this.isBottom_(r)&&this.isTop_(o)?-1:1})}getAdjustedValue_(e,i){const s=.5*this.m_tolerance;if(i){const r=this.m_envelopesRed[e>>1];return this.isBottom_(e)?r.ymin-s:r.ymax+s}const n=this.m_envelopesBlue[e>>1];return this.isBottom_(e)?n.ymin-s:n.ymax+s}};var lJ=Hs;let pc=class TG{constructor(e,i){this.tolerance=e!==void 0?e:Number.NaN,this.resolution=i!==void 0?i:Number.NaN}add(e){return new TG(this.tolerance+e,this.resolution)}scale(e){return new TG(this.tolerance*e,this.resolution*e)}total(){return this.tolerance+this.resolution}};function K3e(t,e,i,s,n){const r=s*s,o=t.sub(e),a=i.sub(e),l=o.sqrLength(),u=a.sqrLength();if(l<=r||u<=r)return!0;const c=Di(o.crossProduct(a));return c<=r*l||c<=r*u?o.dotProduct(a)>=0:!1}function cpe(t,e,i){return s=>i===0?(s+t)*e:1*(s-t*e)/e}function L7(t,e){const i=new J;return t.queryLooseEnvelope(i),i.mergeEnvelope2D(e),i}function ID(t,e){const i=J.constructEmpty();t.queryLooseEnvelope(i);const s=J.constructEmpty();return e.queryLooseEnvelope(s),i.mergeEnvelope2D(s),i}function Q3e(t,e){return(Number.isFinite(t)||Number.isNaN(t))&&(Number.isFinite(e)||Number.isNaN(e))}function hpe(t,e){return Number.isFinite(t)&&Number.isFinite(e)}function dpe(t,e,i){const s=J.constructEmpty();return s.setFromPoints(t,e),i4(0,null,s.calculateToleranceFromEnvelope(),i,!1)}function yr(t,e,i){return i4(0,t,e.calculateToleranceFromEnvelope(),i,!1)}function kP(t,e,i){return i4(1,t,e.calculateToleranceFromEnvelope(),i,!1)}function uJ(t,e,i){return kP(t,e.queryInterval(1,0),i)}function Fl(t,e,i){const s=J.constructEmpty();return e.queryEnvelope(s),yr(t,s,i)}function Vy(t,e,i=!1){return i4(0,t,e.calculateToleranceFromEnvelope(),i,!0).total()}function $P(t,e,i){const s=J.constructEmpty();return e.queryEnvelope(s),Vy(t,s,i)}function i4(t,e,i,s,n){const r=new pc(0,0);if(e!==null&&(r.tolerance=e.getTolerance(t),(!n||s)&&e!==null)){const o=e.getResolution(t);r.resolution=o,s&&(r.resolution*=2)}return s&&(i*=4,r.tolerance*=1.01,r.resolution*=1.01),r.total()<i?new pc(i,0):r}function Pu(t){return Math.sqrt(2)*(2*t.tolerance+t.resolution)}function F7(t){return Math.sqrt(2)*(t.tolerance+t.resolution)}function Gm(t){return t>=3}function J3e(t,e){const i=[0];return t.getImpl().getIsSimple(e,i)>=3}function qyt(t,e){t.getImpl().setIsSimple(3,e)}function eOe(t,e,i,s){if(Di(e.x-t.x)+Di(e.y-t.y)<=i*i){const n=t.z,r=e.z;return QS(n,r,s)}return!1}function ry(t){return t>=4}function tOe(t,e){return t===q.enumPolygon?Gm(e):e>=1}function iOe(t,e,i){const s=J.constructEmpty(),n=J.constructEmpty();t.queryLooseEnvelope(s),e.queryLooseEnvelope(n),s.inflateCoords(i,i),n.inflateCoords(i,i);const r=J.constructEmpty();r.setCoords({env2D:s}),r.intersect(n);const o=t.querySegmentIterator(),a=e.querySegmentIterator(),l=J.constructEmpty(),u=J.constructEmpty(),c=new hA;c.setTolerance(i);let h=!1;for(c.startRedConstruction();o.nextPath();)for(;o.hasNextSegment();)o.nextSegment().queryLooseEnvelope(l),l.isIntersecting(r)&&(h=!0,c.addRedEnvelope(o.getStartPointIndex(),l));if(c.endRedConstruction(),!h)return null;let d=!1;for(c.startBlueConstruction();a.nextPath();)for(;a.hasNextSegment();)a.nextSegment().queryLooseEnvelope(u),u.isIntersecting(r)&&(d=!0,c.addBlueEnvelope(a.getStartPointIndex(),u));return c.endBlueConstruction(),d?c:null}function sOe(t,e,i,s,n){t.getGeometryType(),e.getGeometryType();const r=J.constructEmpty(),o=J.constructEmpty();t.queryLooseEnvelope(r),e.queryLooseEnvelope(o),r.inflateCoords(i,i),o.inflateCoords(i,i);const a=J.constructEmpty();a.setCoords({env2D:r}),a.intersect(o);const l=new hA;l.setTolerance(i);let u=!1;l.startRedConstruction();for(let h=0,d=t.getPathCount();h<d;h++)t.queryLoosePathEnvelope(h,r),r.isIntersecting(a)&&(u=!0,l.addRedEnvelope(h,r));if(l.endRedConstruction(),!u)return null;let c=!1;l.startBlueConstruction();for(let h=0,d=e.getPathCount();h<d;h++)e.queryLoosePathEnvelope(h,o),o.isIntersecting(a)&&(c=!0,l.addBlueEnvelope(h,o));return l.endBlueConstruction(),c?l:null}function cJ(t,e,i){const s=J.constructEmpty(),n=J.constructEmpty();t.queryLooseEnvelope(s),e.queryEnvelope(n),s.inflateCoords(i,i),n.inflateCoords(i,i);const r=J.constructEmpty();r.setCoords({env2D:s}),r.intersect(n);const o=t.querySegmentIterator(),a=new hA;a.setTolerance(i);let l=!1;for(a.startRedConstruction();o.nextPath();)for(;o.hasNextSegment();)o.nextSegment().queryLooseEnvelope(s),s.isIntersecting(r)&&(l=!0,a.addRedEnvelope(o.getStartPointIndex(),s));if(a.endRedConstruction(),!l)return null;let u=!1;a.startBlueConstruction();for(let c=0,h=e.getPointCount();c<h;c++){const d=e.getXY(c);r.contains(d)&&(u=!0,a.addBlueEnvelope(c,J.construct(d.x,d.y,d.x,d.y)))}return a.endBlueConstruction(),u?a:null}function nOe(t,e,i){const s=J.constructEmpty(),n=J.constructEmpty();t.queryEnvelope(s),e.queryEnvelope(n),s.inflateCoords(i,i),n.inflateCoords(i,i);const r=J.constructEmpty();r.setCoords({env2D:s}),r.intersect(n);const o=new hA;o.setTolerance(i);let a=!1;o.startRedConstruction();const l=new N;for(let h=0,d=t.getPointCount();h<d;h++)t.queryXY(h,l),r.contains(l)&&(a=!0,o.addRedEnvelope(h,J.construct(l.x,l.y,l.x,l.y)));if(o.endRedConstruction(),!a)return null;let u=!1;o.startBlueConstruction();const c=new N;for(let h=0,d=e.getPointCount();h<d;h++)e.queryXY(h,c),r.contains(c)&&(u=!0,o.addBlueEnvelope(h,J.construct(c.x,c.y,c.x,c.y)));return o.endBlueConstruction(),u?o:null}function rOe(t){const e=new J;return t.queryLooseEnvelope(e),e.inflateCoords(1,1),oOe(t,e)}function oOe(t,e,i){const s=new J;if(t.queryLooseEnvelope(s),s.isEmpty())return null;t.getGeometryType();const n=new Jo(s,8);let r=-1;const o=new J;let a=!1;do for(let l=0,u=t.getPathCount();l<u;l++)if(t.queryLoosePathEnvelope(l,o),o.isIntersecting(e)){if(r=n.insertEx(l,o,r),r===-1){a&&We("build_quad_tree_for_paths"),s.assign(t.calculateEnvelope2D(!1)),a=!0,n.reset(s,8);break}a=!1}while(a);return n}function cS(t,e){if(!e){const l=new J;t.queryLooseEnvelope(l);const u=new Jo(l,8);let c=-1;const h=new J,d=t.querySegmentIterator();let m=!1;for(;d.nextPath();)for(;d.hasNextSegment();){const f=d.nextSegment(),_=d.getStartPointIndex();if(f.queryLooseEnvelope(h),c=u.insertEx(_,h,c),c===-1){m&&We(""),l.assign(t.calculateEnvelope2D(!1)),m=!0,u.reset(l,8),d.resetToFirstPath();break}}return u}const i=new J;t.queryLooseEnvelope(i);const s=new Jo(i,8);let n=-1;const r=new J,o=t.querySegmentIterator();let a=!1;for(;o.nextPath();)for(;o.hasNextSegment();){const l=o.nextSegment(),u=o.getStartPointIndex();if(l.queryLooseEnvelope(r),r.isIntersecting(e)&&(n=s.insertEx(u,r,n),n===-1)){a&&We(""),i.assign(t.calculateEnvelope2D(!1)),a=!0,s.reset(i,8),o.resetToFirstPath();break}}return s}function hJ(t,e){if(e){const i=new Jo(e,8),s=new N,n=new J;let r=!1;for(let o=0;o<t.getPointCount();o++)s.setCoordsPoint2D(t.getXY(o)),e.contains(s)&&(n.setCoords({pt:s}),i.insert(o,n)!==-1||(r&&We(""),r=!0,i.reset(t.calculateEnvelope2D(),8),o=-1));return i}return _i("no-extent version not yet impl"),null}function dJ(t,e,i,s,n){let r=!1;const o=n.vmin,a=n.vmax;for(let l=i;l<e;l+=s){const u=t.read(l);u<o?(r=!0,t.write(l,o)):u>a&&(r=!0,t.write(l,a))}return r}function PG(t,e,i,s){if(!t.hasAttribute(i))return!1;const n=t.getGeometryType();if(n===q.enumGeometryCollection){const r=t,o=r.getGeometryCount();let a=0;for(let l=0;l<o;++l)a|=PG(r.getGeometry(l),e,i,s)?1:0;return!!a}if(ll(n)){const r=t,o=lJ.getPersistence(i),a=lJ.getComponentCount(i),l=r.getPointCount();if(o===1){const u=dJ(r.getAttributeStreamRef(i),l*a,s,a,e);return u&&r.notifyModified(),u}if(o===2){const u=dJ(r.getAttributeStreamRef(i),l*a,s,a,e);return u&&r.notifyModified(),u}We("snap_coordinate not implemented")}if(n===q.enumEnvelope){const r=t,o=r.queryInterval(i,s);let a=!1;return o.vmin<e.vmin&&(a=!0,o.vmin=e.vmin),o.vmax>e.vmax&&(a=!0,o.vmax=e.vmax),a&&r.setIntervalEnvelope(i,s,o),a}if(n===q.enumPoint){const r=t;let o=r.getAttributeAsDbl(i,s),a=!1;return o<e.vmin&&(a=!0,o=e.vmin),o>e.vmax&&(a=!0,o=e.vmax),a&&r.setAttributeBasic(i,s,o),a}if(nr(n)){const r=t;let o=r.getStartAttributeAsDbl(i,s),a=!1;return o<e.vmin&&(a=!0,o=e.vmin),o>e.vmax&&(a=!0,o=e.vmax),a&&r.setStartAttribute(i,s,o),o=r.getEndAttributeAsDbl(i,s),o<e.vmin&&(a=!0,o=e.vmin),o>e.vmax&&(a=!0,o=e.vmax),a&&r.setEndAttribute(i,s,o),a}We("snap_coordinate not implemented")}var Mc=Hs;let Jt=class MG{constructor(e){if(this.m_description=null,this.x=Number.NaN,this.y=Number.NaN,this.m_attribs=null,e){if(!e.copy)return e.move?(this.m_description=e.move.m_description,e.move.m_description=null,this.m_attribs=e.move.m_attribs,e.move.m_attribs=null,this.x=e.move.x,void(this.y=e.move.y)):e.vd?(this.m_description=e.vd,void(e.attribBuffer?(this.m_attribs=e.attribBuffer,e.initDefaultValues&&this.setDefaultAttributeValues()):this.ensureAttributes())):e.pt?(this.m_description=go(),void this.setXY(e.pt)):void("x"in e&&("z"in e?(this.m_description=LP(),this.ensureAttributes(),this.setXYZ(new gi(e.x,e.y,e.z))):(this.m_description=go(),this.setXYCoords(e.x,e.y))));e.copy.copyTo(this)}else this.m_description=go()}assignCopy(e){return this.m_attribs=null,e.copyTo(this),this}assignMove(e){return this.m_attribs=null,e.copyTo(this),e.setEmpty(),this}getXY(){return new N(this.x,this.y)}queryXY(e){e.x=this.x,e.y=this.y}setXY(e){this.x=e.x,this.y=e.y}setXYCoords(e,i){this.x=e,this.y=i}getXYZ(){const e=new gi;return e.x=this.x,e.y=this.y,e.z=this.getZ(),e}setXYZ(e){this.addAttribute(1),this.x=e.x,this.y=e.y,this.m_attribs[0]=e.z}getX(){return this.x}setX(e){this.x=e}getY(){return this.y}setY(e){this.y=e}getZ(){return this.m_description.hasZ()?this.m_attribs[0]:Mc.getDefaultValue(1)}setZ(e){this.addAttribute(1),this.m_attribs[0]=e}getM(){return this.getAttributeAsDbl(2,0)}setM(e){this.addAttribute(2),this.m_description.hasZ()?this.m_attribs[1]=e:this.m_attribs[0]=e}getID(){return this.getAttributeAsInt(3,0)}setID(e){this.setAttributeBasic(3,0,e)}isEqualXY(e,i){return i===void 0&&(i=0),Math.abs(e.x-this.x)<=i&&Math.abs(e.y-this.y)<=i}isEqualXYCoords(e,i,s){return s===void 0&&(s=0),Math.abs(e-this.x)<=s&&Math.abs(i-this.y)<=s}getAttributeAsDbl(e,i){if(e===0){if(i===0)return this.x;if(i===1)return this.y;bi("")}const s=Mc.getComponentCount(e);(i<0||i>=s)&&bi("");const n=this.m_description.getAttributeIndex(e);return n>=0?this.m_attribs[this.m_description.getPointAttributeOffset(n)-2+i]:Mc.getDefaultValue(e)}getAttributeAsInt(e,i){return Math.trunc(this.getAttributeAsDbl(e,i))}setAttributeBasic(e,i,s){if(e===0)return void(i===0?this.x=s:i===1?this.y=s:bi(""));const n=Mc.getComponentCount(e);(i<0||i>=n)&&bi("");let r=this.m_description.getAttributeIndex(e);r<0&&(this.addAttribute(e),r=this.m_description.getAttributeIndex(e)),this.m_attribs[this.m_description.getPointAttributeOffset(r)-2+i]=s}copyAttributesFrom(e,i){if(this===e)return;const s=e.getDescription();for(let n=i&&s.hasZ()?2:1,r=s.getAttributeCount();n<r;++n){const o=s.getSemantics(n),a=Mc.getComponentCount(o);for(let l=0;l<a;++l){const u=e.getAttributeAsDbl(o,l);this.setAttributeBasic(o,l,u)}}}getAttributeArray(){return this.m_attribs}getDescription(){return this.m_description}assignVertexDescription(e){this.m_description!==e&&this.assignVertexDescriptionImpl(e)}mergeVertexDescription(e){this.m_description!==e&&(this.m_description.hasAttributesFrom(e)||this.mergeVertexDescriptionImpl(e))}hasAttribute(e){return this.m_description.hasAttribute(e)}addAttribute(e){if(this.m_description.hasAttribute(e))return;const i=uA(this.m_description,e);this.assignVertexDescription(i)}dropAttribute(e){if(!this.m_description.hasAttribute(e))return;const i=cA(this.m_description,e);this.assignVertexDescription(i)}dropAllAttributes(){const e=go();e!==this.m_description&&this.assignVertexDescription(e)}getGeometryType(){return q.enumPoint}getDimension(){return 0}queryEnvelope(e){if(e instanceof Fo)return e.setEmpty(),e.assignVertexDescription(this.m_description),void e.merge(this);if(e instanceof Sd){if(this.isEmpty())return void e.setEmpty();const i=this.getXYZ();return e.xmin=i.x,e.ymin=i.y,e.zmin=i.z,e.xmax=i.x,e.ymax=i.y,void(e.zmax=i.z)}this.isEmpty()?e.setEmpty():(e.xmin=this.x,e.ymin=this.y,e.xmax=this.x,e.ymax=this.y)}queryLooseEnvelope(e){this.queryEnvelope(e)}queryInterval(e,i){const s=new Me;if(this.isEmpty())return s.setEmpty(),s;const n=this.getAttributeAsDbl(e,i);return s.vmin=n,s.vmax=n,s}applyTransformation(e){if(!this.isEmpty()){if(e.m_TransformationType===1){const i=this.getXY();return e.transformInPlace(i),void this.setXY(i)}_i("3d not impl")}}transformAttribute(e,i,s,n,r){if(this.isEmpty())return;this.addAttribute(e);const o=this.getAttributeAsDbl(e,i),a=cpe(s,n,r);this.setAttributeBasic(e,i,a(o))}createInstance(){return new MG({vd:this.m_description})}copyTo(e){if(this===e)return;e.getGeometryType()!==q.enumPoint&&ce();const i=e;i.x=this.x,i.y=this.y,this.m_attribs?(i.assignVertexDescription(this.m_description),i.m_attribs=this.m_attribs.slice()):(i.releaseAttributes(),i.assignVertexDescription(this.m_description))}isEmpty(){return Number.isNaN(this.x)||Number.isNaN(this.y)}setEmpty(){this.m_description||(this.m_description=go(),this.releaseAttributes()),this.x=Number.NaN,this.y=Number.NaN,this.m_attribs&&Qs(this.m_attribs,this.m_description.getDefaultPointAttributes(),0,2,this.m_description.getTotalComponentCount()-2)}calculateArea2D(){return 0}calculateLength2D(){return 0}calculateLength3D(e){return 0}equals(e,i){if(e===this)return!0;if(e.getGeometryType()!==q.enumPoint)return!1;const s=e;if(this.m_description!==s.m_description||this.isEmpty()!==s.isEmpty())return!1;if(this.isEmpty())return!0;if(i===void 0&&(i=0),Math.abs(this.x-s.x)>i||Math.abs(this.y-s.y)>i)return!1;for(let n=0,r=this.m_description.getTotalComponentCount()-2;n<r;n++)if(!QS(this.m_attribs[n],s.m_attribs[n],i))return!1;return!0}getBoundary(){return null}clone(){const e=new MG({vd:this.m_description});return this.copyTo(e),e}swap(e){if(this===e)return;e.getGeometryType()!==q.enumPoint&&ce("wrong geometry type");const i=e;i.m_description=Ge(this.m_description,this.m_description=i.m_description),i.x=Ge(this.x,this.x=i.x),i.y=Ge(this.y,this.y=i.y),i.m_attribs=Ge(this.m_attribs,this.m_attribs=i.m_attribs)}replaceNaNs(e,i){if(this.addAttribute(e),this.isEmpty())return;const s=Mc.getComponentCount(e);for(let n=0;n<s;n++){const r=this.getAttributeAsDbl(e,n);Number.isNaN(r)&&this.setAttributeBasic(e,n,i)}}lerp(e,i,s){if(e.getDescription()!==i.getDescription()&&ce("Point.lerp"),this.assignVertexDescription(e.getDescription()),e.isEmpty()||i.isEmpty())return this.setEmpty(),this;this.ensureAttributes();const n=vm();e.queryValues(n,n.length);const r=vm();i.queryValues(r,r.length);const o=vm();let a=n,l=r;const u=o;let c=0;for(let h=0,d=this.m_description.getAttributeCount();h<d;h++){const m=this.m_description.getSemantics(h),f=Mc.getInterpolation(m),_=Mc.getComponentCount(m),v=Mc.getDefaultValue(m);KO(f,a,l,u,c,_,s,v),a=a.slice(_),l=l.slice(_),c+=_}return this.setValues(o,c),this}setDefaultAttributeValues(){const e=this.m_description.getTotalComponentCount()-2;e>0&&(this.m_attribs?Qs(this.m_attribs,this.m_description.getDefaultPointAttributes(),0,2,e):this.m_attribs=this.m_description.getDefaultPointAttributes().slice(2))}static sqrDistance2D(e,i){return N.sqrDistanceCoords(e.x,e.y,i.x,i.y)}getImpl(){return this}mergeVertexDescriptionImpl(e){const i=JS(this.getDescription(),e);this.assignVertexDescription(i)}releaseAttributes(){this.m_attribs=null}assignVertexDescriptionImpl(e){this.m_description||(this.m_description=go());const i=JF();e4(e,this.m_description,i);let s=null;e.getTotalComponentCount()-2>0&&(s=e.getDefaultPointAttributes().slice(2));for(let n=1,r=e.getAttributeCount();n<r;n++){const o=i[n];if(o!==-1){const a=this.m_description.getPointAttributeOffset(o)-2,l=e.getPointAttributeOffset(n)-2,u=Mc.getComponentCount(e.getSemantics(n));for(let c=0;c<u;c++)s[l+c]=this.m_attribs[a+c]}}this.m_attribs=s,this.m_description=e}ensureAttributes(){this.m_description.getTotalComponentCount()-2>0&&this.m_attribs===null&&(this.m_attribs=this.m_description.getDefaultPointAttributes().slice(2))}queryValues(e,i){const s=this.m_description.getTotalComponentCount();z(s<=i),e[0]=this.x,e[1]=this.y,Qs(e,this.m_attribs,2,0,s-2)}copyCommonAttributesTo(e){e.x=this.x,e.y=this.y;const i=e.getDescription();if(i===this.m_description)this.m_attribs&&Qs(e.m_attribs,this.m_attribs,0,0,this.m_description.getTotalComponentCount()-2);else{let s=0;for(let n=1,r=i.getAttributeCount();n<r;n++){const o=i.getSemantics(n);let a=Mc.getComponentCount(o);if(this.m_description.hasAttribute(o)){let l=this.m_description.getPointAttributeOffset(this.m_description.getAttributeIndex(o))-2;for(;a!==0;)e.m_attribs[s++]=this.m_attribs[l++],a--}else{const l=Mc.getDefaultValue(o);for(;a!==0;)e.m_attribs[s++]=l,a--}}}}setValues(e,i){const s=this.m_description.getTotalComponentCount();z(s<=i),this.x=e[0],this.y=e[1],Qs(this.m_attribs,e,0,2,s-2)}dbgDefaultAttribs(){}};Jt.type=q.enumPoint;var Qu=Hs;function sL(t,e){return e*(t.getTotalComponentCount()-2)}let ec=class{constructor(e){if(this.m_attributes=null,e)if(e.xmin!==void 0)this.m_envelope2D=new J(e.xmin,e.ymin,e.xmax,e.ymax);else if(e.env2D!==void 0)this.m_envelope2D=new J(e.env2D);else if(e.move)this.m_envelope2D=new J(e.move.m_envelope2D),this.m_attributes=e.move.m_attributes,e.move.m_attributes=null;else{if(!e.moveEnv)throw new Error("unrecognized EnvelopeData constructor options");{const i=e.moveEnv.accessEnvelopeData();this.m_envelope2D=new J(i.m_envelope2D),this.m_attributes=i.m_attributes,i.m_attributes=null}}else this.m_envelope2D=J.constructEmpty()}ensureAttributes(e){const i=e.getTotalComponentCount()-2;!this.m_attributes&&i&&(this.m_attributes=st(2*i,Number.NaN),this.m_attributes.fill(Number.NaN))}copyTo(e,i){const s=i,n=e.getTotalComponentCount()-2;if(s.m_description!==e&&(s.releaseAttributes_(),s.m_description=e,n&&(s.m_data.m_attributes=st(2*n,Number.NaN))),n){z(this.m_attributes&&s.m_data.m_attributes);const r=2*n;Qs(s.m_data.m_attributes,this.m_attributes,0,0,r)}s.m_data.m_envelope2D=new J(this.m_envelope2D)}copyToIfNotNull(e,i){i.m_envelope2D=new J(this.m_envelope2D),i.releaseAttributes(),e.getTotalComponentCount()-2&&this.m_attributes&&(i.m_attributes=this.m_attributes.slice())}releaseAttributes(){this.m_attributes=null}isEmpty(){return this.m_envelope2D.isEmpty()}transformAttribute(e,i,s,n,r){z(0)}queryInterval(e,i,s,n){if(this.isEmpty())return void n.setEmpty();if(i===0)return void(s===0?this.m_envelope2D.queryIntervalX(n):s===1?this.m_envelope2D.queryIntervalY(n):bi(""));const r=Qu.getComponentCount(i);(s<0||s>=r)&&bi("");const o=e.getAttributeIndex(i);if(o>=0)return n.vmin=this.m_attributes[sL(e,0)+e.getPointAttributeOffset(o)-2+s],void(n.vmax=this.m_attributes[sL(e,1)+e.getPointAttributeOffset(o)-2+s]);{const a=Qu.getDefaultValue(i);return void n.setCoords(a,a)}}queryEnvelope3D(e,i){const s=new Me;this.queryInterval(e,1,0,s),i.setCoords(this.m_envelope2D.xmin,this.m_envelope2D.ymin,s.vmin,this.m_envelope2D.xmax,this.m_envelope2D.ymax,s.vmax)}setEmpty(e){this.m_envelope2D.setEmpty();const i=e.getTotalComponentCount()-2;i&&(this.m_attributes?this.dbgAssertSize(i):this.m_attributes=st(2*i,Number.NaN),this.m_attributes.fill(Number.NaN))}dbgAssertSize(e){}},Fo=class i3{constructor(e){if(this.m_EnvelopeType=4,this.m_description=go(),e===void 0)this.m_data=new ec;else if(e.vd!==void 0)this.m_description=e.vd,this.m_data=new ec,this.ensureAttributes_();else if(e!=null&&e.env2D)this.m_data=new ec({env2D:e.env2D});else if(e.xmin!==void 0)this.m_data=new ec({xmin:e.xmin,ymin:e.ymin,xmax:e.xmax,ymax:e.ymax});else if(e.copy)this.m_data=new ec,e.copy.copyTo(this);else if(e.move)this.m_description=e.move.m_description,e.move.m_description=null,this.m_data=new ec({move:e.move.m_data});else{if(!e.centerPoint)throw new Error("unrecognized Envelope constructor options");this.m_description=e.centerPoint.getDescription(),this.m_data=new ec,this.ensureAttributes_(),this.setFromPoint(e.centerPoint,e.width,e.height)}}accessEnvelopeData(){return this.m_description=null,this.m_data}assignMove(e){return this===e||(this.m_description=e.m_description,e.m_description=null,this.m_data=new ec({move:e.m_data})),this}assignCopy(e){return this===e||e.copyTo(this),this}transformAttribute(e,i,s,n,r){z(0)}setAttributeBasic(e,i,s){if(this.addAttribute(e),this.m_data.isEmpty())return;const n=this.queryInterval(e,i);n.vmin=s,n.vmax=s,this.setIntervalEnvelope(e,i,n)}mergeVertexDescriptionImpl(e){const i=JS(this.getDescription(),e);this.assignVertexDescription(i)}asEnvelope2D(){return new J(this.m_data.m_envelope2D)}assignVertexDescription(e){this.m_description!==e&&this.assignVertexDescriptionImpl(e)}getGeometryType(){return q.enumEnvelope}getDimension(){return 2}getXMin(){return this.m_data.m_envelope2D.xmin}getYMin(){return this.m_data.m_envelope2D.ymin}getXMax(){return this.m_data.m_envelope2D.xmax}getYMax(){return this.m_data.m_envelope2D.ymax}width(){return this.m_data.isEmpty()?Number.NaN:this.m_data.m_envelope2D.width()}height(){return this.m_data.isEmpty()?Number.NaN:this.m_data.m_envelope2D.height()}getCenterXY(){return this.m_data.isEmpty()?new N:this.m_data.m_envelope2D.getCenter()}getCenter(e){if(e.assignVertexDescription(this.m_description),this.m_data.isEmpty())return void e.setEmpty();const i=this.m_description.getAttributeCount();for(let s=1;s<i;s++){const n=this.m_description.getSemantics(s),r=Qu.getComponentCount(n);for(let o=0;o<r;o++){const a=.5*(this.getAttributeAsDblImpl(0,n,o)+this.getAttributeAsDblImpl(1,n,o));e.setAttributeBasic(n,o,a)}}e.setXY(this.m_data.m_envelope2D.getCenter())}setCoords(e,i,s,n){this.m_data.m_envelope2D.setCoords({xmin:e,ymin:i,xmax:s,ymax:n})}setEnvelope(e){if(e instanceof J)this.m_data.m_envelope2D=new J(e),this.m_data.m_envelope2D.normalize();else{this.addAttribute(1),this.m_data.m_envelope2D=e.getEnvelope2D(),this.m_data.m_envelope2D.normalize();const i=Me.constructEmpty();i.setCoords(e.zmin,e.zmax),this.setInterval(1,0,i.vmin,i.vmax)}}merge(e){if(e instanceof J)return e.isValid()||ce(""),void this.m_data.m_envelope2D.mergeEnvelope2D(e);if(e instanceof i3){if(e.m_data.isEmpty())return;const i=e.getDescription();this.mergeVertexDescription(i),this.m_data.m_envelope2D.mergeEnvelope2D(e.m_data.m_envelope2D);for(let s=1,n=i.getAttributeCount();s<n;s++){const r=i.getSemantics(s),o=Qu.getComponentCount(r);for(let a=0;a<o;a++){const l=e.queryInterval(r,a),u=this.queryInterval(r,a);u.merge(l),this.setIntervalEnvelope(r,a,u)}}}else if(e instanceof Jt){const i=e;if(i.isEmpty())return;const s=i.getDescription();if(this.mergeVertexDescription(s),this.m_data.isEmpty())return void this.setFromPoint(i);this.m_data.m_envelope2D.merge(i.getXY());for(let n=1,r=s.getAttributeCount();n<r;n++){const o=s.getSemantics(n),a=Qu.getComponentCount(o);for(let l=0;l<a;l++){const u=i.getAttributeAsDbl(o,l),c=this.queryInterval(o,l);c.mergeCoordinate(u),this.setIntervalEnvelope(o,l,c)}}}else _i("unrecognized type for envelope.merge")}intersect(e){if(!this.m_data.m_envelope2D.intersect(e.m_data.m_envelope2D))return this.setEmpty(),!1;const i=e.getDescription();this.mergeVertexDescription(i);for(let s=1,n=this.m_description.getAttributeCount();s<n;s++){const r=this.m_description.getSemantics(s),o=Qu.getComponentCount(r);for(let a=0;a<o;a++){const l=e.queryInterval(r,a),u=this.queryInterval(r,a);u.intersect(l),this.setIntervalEnvelope(r,a,u)}}return!0}intersectCommonAttributes(e){if(!this.m_data.m_envelope2D.intersect(e.m_data.m_envelope2D))return this.setEmpty(),!1;const i=e.getDescription();for(let s=1,n=this.m_description.getAttributeCount();s<n;s++){const r=this.m_description.getSemantics(s);if(!i.hasAttribute(r))continue;const o=Qu.getComponentCount(r);for(let a=0;a<o;a++){const l=e.queryInterval(r,a),u=this.queryInterval(r,a);u.intersect(l),this.setIntervalEnvelope(r,a,u)}}return!0}move(e,i){this.m_data.m_envelope2D.move(e,i)}centerAt(e,i){this.m_data.m_envelope2D.centerAtCoords(e,i)}centerAtPoint(e){this.m_data.m_envelope2D.centerAt(e)}reaspect(e,i){this.m_data.m_envelope2D.reaspect(e,i)}inflateCoords(e,i){this.m_data.m_envelope2D.inflateCoords(e,i)}containsCoords(e,i){return this.m_data.m_envelope2D.containsCoords(e,i)}contains(e){return this.m_data.m_envelope2D.contains(e)}containsPoint(e){return!e.isEmpty()&&this.m_data.m_envelope2D.contains(e.getXY())}containsEnvelope(e){return this.m_data.m_envelope2D.containsEnvelope(e.m_data.m_envelope2D)}setIntervalEnvelope(e,i,s){if(this.addAttribute(e),this.m_data.isEmpty())return;const n=new Me(s);if(n.normalize(),e===0){if(n.isEmpty())return void this.setEmpty();i===0?(this.m_data.m_envelope2D.xmin=n.vmin,this.m_data.m_envelope2D.xmax=n.vmax):i===1?(this.m_data.m_envelope2D.ymin=n.vmin,this.m_data.m_envelope2D.ymax=n.vmax):bi("")}else this.setAttributeAsDblImpl(0,e,i,n.vmin),this.setAttributeAsDblImpl(1,e,i,n.vmax)}setInterval(e,i,s,n){this.setIntervalEnvelope(e,i,new Me(s,n))}queryInterval(e,i){const s=new Me;return this.m_data.queryInterval(this.m_description,e,i,s),s}queryEnvelope(e){e.m_EnvelopeType!==2?e.m_EnvelopeType!==3?e.m_EnvelopeType!==4?_i("unrecognized type for queryEnveloper"):this.copyTo(e):this.m_data.queryEnvelope3D(this.m_description,e):e.setCoords({env2D:this.m_data.m_envelope2D})}applyTransformation(e){e.m_TransformationType!==1?z(0):e.transformEnvInPlace(this.m_data.m_envelope2D)}createInstance(){return new i3({vd:this.m_description})}copyTo(e){e!==this&&this.m_data.copyTo(this.m_description,e)}isEmpty(){return this.m_data.isEmpty()}setEmpty(){this.m_description||(this.m_description=go()),this.m_data.setEmpty(this.m_description)}calculateArea2D(){return this.m_data.m_envelope2D.getArea()}calculateLength2D(){return this.m_data.m_envelope2D.getLength()}calculateLength3D(e){return z(0),0}equals(e,i){if(e===this)return!0;const s=e;if(this.m_description!==s.m_description||this.m_data.isEmpty()!==s.m_data.isEmpty())return!1;if(this.m_data.isEmpty())return!0;if(i===void 0&&(i=0),Math.abs(this.m_data.m_envelope2D.xmin-s.m_data.m_envelope2D.xmin)>i||Math.abs(this.m_data.m_envelope2D.ymin-s.m_data.m_envelope2D.ymin)>i||Math.abs(this.m_data.m_envelope2D.xmax-s.m_data.m_envelope2D.xmax)>i||Math.abs(this.m_data.m_envelope2D.ymax-s.m_data.m_envelope2D.ymax)>i)return!1;for(let n=0,r=2*(this.m_description.getTotalComponentCount()-2);n<r;n++)if(!QS(this.m_data.m_attributes[n],s.m_data.m_attributes[n],i))return!1;return!0}getBoundary(){return _i("getBoundary not available in this context. Use the boundary operator with an envelope parameter"),null}clone(){return new i3({copy:this})}swap(e){if(this===e)return;e.getGeometryType()!==q.enumEnvelope&&ce("wrong geometry type");const i=e;i.m_description=Ge(this.m_description,this.m_description=i.m_description),i.m_data.m_envelope2D=Ge(this.m_data.m_envelope2D,this.m_data.m_envelope2D=i.m_data.m_envelope2D),i.m_data.m_attributes=Ge(this.m_data.m_attributes,this.m_data.m_attributes=i.m_data.m_attributes)}queryCoordinates(e){this.m_data.isEmpty()&&ce(""),this.m_data.m_envelope2D.queryCorners(e)}queryCornerByVal(e,i){(e<0||e>3)&&bi(""),i.assignVertexDescription(this.m_description);const s=this.getDescription().getAttributeCount();for(let n=1;n<s;n++){const r=this.m_description.getSemantics(n),o=Qu.getComponentCount(r);for(let a=0;a<o;a++)i.setAttributeBasic(r,a,this.getAttributeAsDblImpl(e%2,r,a))}i.setXY(this.m_data.m_envelope2D.queryCorner(e))}queryCorner(e,i){i.assign(this.m_data.m_envelope2D.queryCorner(e))}getDescription(){return this.m_description}mergeVertexDescription(e){this.m_description!==e&&(this.m_description&&this.m_description.hasAttributesFrom(e)||this.mergeVertexDescriptionImpl(e))}hasAttribute(e){return this.m_description.hasAttribute(e)}addAttribute(e){if(this.m_description.hasAttribute(e))return;const i=uA(this.m_description,e);this.assignVertexDescription(i)}dropAttribute(e){if(!this.m_description.hasAttribute(e))return;const i=cA(this.m_description,e);this.assignVertexDescription(i)}dropAllAttributes(){const e=go();e!==this.m_description&&this.assignVertexDescription(e)}queryLooseEnvelope(e){this.queryEnvelope(e)}replaceNaNs(e,i){if(this.addAttribute(e),this.m_data.isEmpty())return;const s=Qu.getComponentCount(e);for(let n=0;n<s;n++){const r=this.queryInterval(e,n);r.isEmpty()&&(r.vmin=i,r.vmax=i,this.setIntervalEnvelope(e,n,r))}}getImpl(){return this}setFromPoint(e,i,s){this.m_data.m_envelope2D.setCoords({center:e.getXY(),width:i??0,height:s??0});const n=e.getDescription();for(let r=1,o=n.getAttributeCount();r<o;r++){const a=n.getSemantics(r),l=Qu.getComponentCount(a);for(let u=0;u<l;u++){const c=e.getAttributeAsDbl(a,u);this.setInterval(a,u,c,c)}}}assignVertexDescriptionImpl(e){const i=JF();e4(e,this.m_description,i);let s=null;const n=e.getTotalComponentCount()-2,r=this.m_description?this.m_description.getTotalComponentCount()-2:0;n>0&&(s=st(2*n,Number.NaN));for(let o=1;o<e.getAttributeCount();o++){const a=i[o];if(a!==-1){const l=e.getPointAttributeOffset(o)-2,u=Qu.getComponentCount(e.getSemantics(o)),c=this.m_description.getPointAttributeOffset(a)-2;Qs(s,this.m_data.m_attributes,l,c,u),Qs(s,this.m_data.m_attributes,n+l,r+c,u)}}this.releaseAttributes_(),this.m_data.m_attributes=s,this.m_description=e}getAttributeAsDblImpl(e,i,s){if(this.m_data.isEmpty()&&WF(""),i===0)return e?s?this.m_data.m_envelope2D.ymax:this.m_data.m_envelope2D.xmax:s?this.m_data.m_envelope2D.ymin:this.m_data.m_envelope2D.xmin;s>=Qu.getComponentCount(i)&&bi("");const n=this.m_description.getAttributeIndex(i);return n>=0?this.m_data.m_attributes[sL(this.m_description,e)+this.m_description.getPointAttributeOffset(n)-2+s]:Hs.getDefaultValue(i)}setAttributeAsDblImpl(e,i,s,n){i===0&&(e?s===1?this.m_data.m_envelope2D.ymax=n:s===0?this.m_data.m_envelope2D.xmax=n:bi(""):s===1?this.m_data.m_envelope2D.ymin=n:s===0?this.m_data.m_envelope2D.xmin=n:bi(""));const r=Qu.getComponentCount(i);(s<0||s>=r)&&bi(""),this.addAttribute(i);const o=this.m_description.getAttributeIndex(i);this.m_data.m_attributes[sL(this.m_description,e)+this.m_description.getPointAttributeOffset(o)-2+s]=n}releaseAttributes_(){this.m_data.releaseAttributes()}ensureAttributes_(){this.m_data.ensureAttributes(this.m_description)}};Fo.type=q.enumEnvelope;Object.freeze(Object.defineProperty({__proto__:null,Envelope:Fo,EnvelopeData:ec},Symbol.toStringTag,{value:"Module"}));let DD=class{constructor(){this.posStream=null,this.streams=null}get(e){return e>0?this.streams[e-1]:this.posStream}set(e,i){e>0?this.streams[e-1]=i:this.posStream=i}destroyAndSetSize(e){if(this.streams=null,e>1){this.streams=new Array(e-1);for(let i=0;i<e-1;++i)this.streams[i]=null}this.posStream=null}swap(e){[this.streams,e.streams]=[e.streams,this.streams],[this.posStream,e.posStream]=[e.posStream,this.posStream]}empty(){return this.posStream===null&&this.streams===null}};function aOe(t,e,i,s,n){(e<0||i<0||s<1||e+s*(i-1)+1>t.size())&&ce("Index out of bound");for(let r=e,o=e+s*(i-1)+1;r<o;r+=s)t.writeAsDbl(r,n(t.readAsDbl(r)))}function lOe(t,e,i){if(t)for(let s=e.length-1;s>=0;--s)i(e[s]);else e.forEach(i)}function uOe(t,e){let i=Tw(t);const s=e.length/fo();for(let n=0;n<e.length;++n){const r=Math.trunc(i*s);i=Tw(i);const o=Math.trunc(i*s),a=e[r];e[r]=e[o],e[o]=a}}function cOe(t,e,i){const s=t.getDescription().getTotalComponentCount();t.setX(e[0]),t.setY(e[1]),Qs(t.getAttributeArray(),e,0,2,s-2)}var Yn=Hs;const AG="can not assign an empty point to a vertex";let mpe=class{constructor(e){if(this.m_accelerators=null,e!==void 0&&e.move)this.m_description=e.move.m_description,e.move.m_description=go(),this.m_vertexAttributes=e.move.m_vertexAttributes,e.move.m_vertexAttributes=new DD,this.m_envelopeData=e.move.m_envelopeData,e.move.m_envelopeData=new ec,this.m_pointCount=e.move.m_pointCount,this.m_reservedPointCount=e.move.m_reservedPointCount,this.m_flags=e.move.m_flags,this.m_bFillRule=e.move.m_bFillRule,this.m_bPathStarted=e.move.m_bPathStarted,this.m_bPolygon=e.move.m_bPolygon,this.m_simpleTolerance=e.move.m_simpleTolerance;else{const i=e!==void 0&&e.vd?e.vd:go();this.m_description=i,this.m_vertexAttributes=new DD,this.m_envelopeData=new ec,this.m_pointCount=0,this.m_reservedPointCount=-1,this.m_flags=4063,this.m_bFillRule=this.m_bPathStarted=this.m_bPolygon=!1,this.m_simpleTolerance=0,e!==void 0&&e.copy&&e.copy.copyTo(this)}}equalsBase(e,i){if(!ll(e.getGeometryType()))return!1;const s=e;if(this===s)return!0;if(!this.m_description.equals(s.getDescription())||this.isEmptyImpl()!==s.isEmptyImpl())return!1;if(this.isEmptyImpl())return!0;const n=this.getPointCount();if(n!==s.getPointCount())return!1;for(let r=0;r<this.m_description.getAttributeCount();r++){const o=this.m_description.getSemantics(r),a=this.getAttributeStreamRef(o),l=s.getAttributeStreamRef(o),u=Yn.getComponentCount(o);if(!a.equals(l,0,n*u,i))return!1}if(i){if(!this.equalsImplTol(e,i))return!1}else if(!this.equalsImpl(e))return!1;return!0}transformAttribute(e,i,s,n,r){this.addAttribute(e),this.isEmpty()||s===0&&n===1||(aOe(this.getAttributeStreamRef(e),i,this.getPointCount(),Yn.getComponentCount(e),cpe(s,n,r)),this.notifyModified())}getDescription(){return this.m_description}assignVertexDescription(e){this.m_description!==e&&this.assignVertexDescriptionImpl(e)}mergeVertexDescriptionImpl(e){const i=this.getDescription(),s=JS(i,e);this.assignVertexDescription(s)}mergeVertexDescription(e){this.m_description!==e&&(this.m_description.hasAttributesFrom(e)||this.mergeVertexDescriptionImpl(e))}hasAttribute(e){return this.m_description.hasAttribute(e)}addAttribute(e){if(this.m_description.hasAttribute(e))return;const i=uA(this.m_description,e);this.assignVertexDescription(i)}dropAttribute(e){if(!this.m_description.hasAttribute(e))return;const i=cA(this.m_description,e);this.assignVertexDescription(i)}dropAllAttributes(){const e=go();e!==this.m_description&&this.assignVertexDescription(e)}getAttributeStreamRef(e){this.throwIfEmpty(),this.m_description.hasAttribute(e)||ce("AttributeStream : Geometry does not have the attribute");const i=this.m_description.getAttributeIndex(e);return this.m_vertexAttributes.get(i)}setAttributeStreamRef(e,i){i||ce("stream"),i&&Yn.getPersistence(e)!==i.getPersistence()&&ce(""),this.addAttribute(e);const s=this.m_description.getAttributeIndex(e);this.m_vertexAttributes.empty()&&this.m_vertexAttributes.destroyAndSetSize(this.m_description.getAttributeCount()),this.m_vertexAttributes.set(s,i),this.notifyModifiedFlags(2001)}notifyModifiedFlags(e){e===65535&&(this.m_reservedPointCount=-1,this.notifyModifiedAllImpl()),this.setDirtyFlagProtected(e,!0),this.clearAccelerators(),32&e&&this.verifyAllStreamsAfterSizeChange()}notifyModified(){this.notifyModifiedFlags(2001)}getPointCount(){return this.m_pointCount}getPointByVal(e,i){const s=i;s.assignVertexDescription(this.m_description);for(let n=0;n<this.m_description.getAttributeCount();n++){const r=this.m_description.getSemantics(n);for(let o=0,a=Yn.getComponentCount(r);o<a;o++){const l=this.m_vertexAttributes.get(n).readAsDbl(a*e+o);s.setAttributeBasic(r,o,l)}}}setPointByVal(e,i){const s=i;s.isEmpty()&&ce(AG);const n=s.getDescription();n!==this.m_description&&this.mergeVertexDescription(n);const r=this.m_vertexAttributes.get(0);r.write(2*e,s.getX()),r.write(2*e+1,s.getY());for(let o=1,a=this.m_description.getAttributeCount();o<a;o++){const l=this.m_description.getSemantics(o),u=Yn.getComponentCount(l);for(let c=0;c<u;c++){const h=s.getAttributeAsDbl(l,c);this.m_vertexAttributes.get(o).writeAsDbl(e*u+c,h)}}this.notifyModifiedFlags(2001)}setPointByValFromArray(e,i,s,n){z(0)}getPointByValAsArray(e,i,s,n){z(0)}isEmpty(){return this.isEmptyImpl()}isEmptyImpl(){return this.m_pointCount===0}getAttributeAsDbl(e,i,s){const n=Yn.getComponentCount(e);s>=n&&bi("");const r=this.m_description.getAttributeIndex(e);return r>=0?this.m_vertexAttributes.get(r).readAsDbl(i*n+s):Yn.getDefaultValue(e)}queryAttributeAsDbl(e,i,s,n){const r=Yn.getComponentCount(e);n<r&&bi("");const o=this.m_description.getAttributeIndex(e);if(o>=0){const a=i*r,l=this.m_vertexAttributes.get(o);for(let u=0;u<r;u++)s[u]=l.readAsDbl(a+u)}else{const a=Yn.getDefaultValue(e);for(let l=0;l<r;l++)s[l]=a}}getAttributeAsInt(e,i,s){return Math.trunc(this.getAttributeAsDbl(e,i,s))}queryAttributeAsInt(e,i,s,n){z(0)}setAttribute(e,i,s,n){const r=Yn.getComponentCount(e);s>=r&&bi(""),this.addAttribute(e);const o=this.m_description.getAttributeIndex(e);this.notifyModifiedFlags(2001),this.m_vertexAttributes.get(o).writeAsDbl(i*r+s,n)}setAttributeFromArray(e,i,s,n){(i<0||i>=this.m_pointCount)&&bi("");const r=Yn.getComponentCount(e);n!==r&&bi(""),this.addAttribute(e);const o=this.m_description.getAttributeIndex(e);this.notifyModifiedFlags(2001);const a=this.m_vertexAttributes.get(o);for(let l=0;l<r;++l)a.writeAsDbl(i*r+l,s[l])}getXY(e){return this.m_vertexAttributes.get(0).readPoint2D(2*e)}queryXY(e,i){return this.m_vertexAttributes.get(0).queryPoint2D(2*e,i)}setXY(e,i){this.m_vertexAttributes.get(0).writePoint2D(2*e,i),this.notifyModifiedFlags(2001)}setXYCoords(e,i,s){const n=this.m_vertexAttributes.get(0);n.write(2*e,i),n.write(2*e+1,s),this.notifyModifiedFlags(2001)}getXYZ(e){const i=this.m_vertexAttributes.get(0),s=gi.getNAN();return s.x=i.read(2*e),s.y=i.read(2*e+1),this.m_description.hasAttribute(1)?s.z=this.m_vertexAttributes.get(1).read(e):s.z=Yn.getDefaultValue(1),s}setXYZ(e,i){this.addAttribute(1),this.notifyModifiedFlags(2001);const s=this.m_vertexAttributes.get(0);s.write(2*e,i.x),s.write(2*e+1,i.y),this.m_vertexAttributes.get(1).write(e,i.z)}queryEnvelope(e){e instanceof J||e instanceof Sd?this.updateEnvelope(e):(this.updateAllDirtyIntervals(!0),this.m_envelopeData.copyTo(this.m_description,e))}queryLooseEnvelope(e){this.updateLooseEnvelope(e)}queryInterval(e,i){const s=Me.constructEmpty();return this.isEmptyImpl()||(this.updateAllDirtyIntervals(!0),this.m_envelopeData.queryInterval(this.m_description,e,i,s)),s}setAttributeBasic(e,i,s){this.setAttributeImpl(e,i,s)}setAttributeImpl(e,i,s){if(this.addAttribute(e),this.isEmpty())return;let n=!1;const r=Yn.getComponentCount(e),o=this.getAttributeStreamRef(e),a=Number.isNaN(s);if(o.getPersistence()===1){const l=o;for(let u=i,c=this.m_pointCount*r;u<c;u+=r){const h=l.read(u);(a||h===s)&&Number.isNaN(h)||(l.write(u,s),n=!0)}}else for(let l=i,u=this.m_pointCount*r;l<u;l+=r)o.readAsDbl(l)!==s&&(o.writeAsDbl(l,s),n=!0);n&&this.notifyModifiedFlags(2001)}replaceNaNs(e,i){if(this.addAttribute(e),this.isEmpty())return;let s=!1;const n=Yn.getComponentCount(e),r=this.getAttributeStreamRef(e);for(let o=0;o<n;o++)if(r.getPersistence()===1){const a=r;for(let l=0,u=this.m_pointCount*n;l<u;l++){const c=a.read(l);Number.isNaN(c)&&(a.write(l,i),s=!0)}}else for(let a=0,l=this.m_pointCount*n;a<l;a++){const u=r.readAsDbl(a);Number.isNaN(u)&&(r.writeAsDbl(a,i),s=!0)}s&&this.notifyModifiedFlags(2001)}calculateLength3D(e){return z(0),0}setEnvelopeForImport(e){this.m_description.equals(e.getDescription())||ce(""),this.m_envelopeData=new ec({moveEnv:e}),this.setDirtyFlagProtected(192,!1)}copyTo(e){e.getGeometryType()!==this.getGeometryType()&&ce(""),this!==e&&this.copyToUnchecked(e,!1)}queryCoordinates(e,i,s,n){let r=n<0?this.m_pointCount:n;if(r=Math.min(r,s+i),(s<0||r<s||this.m_pointCount>0&&s>=this.m_pointCount)&&ce(""),this.m_pointCount===0)return r;const o=this.getAttributeStreamRef(0);for(let a=2*s,l=2*r,u=0;a<l;a+=2,u++)o.queryPoint2D(a,e[u]);return r}queryCoordinates3D(e,i,s,n){let r=n<0?this.m_pointCount:n;if(r=Math.min(r,s+i),(s<0||r<s||this.m_pointCount>0&&s>=this.m_pointCount)&&ce(""),this.m_pointCount===0)return r;const o=this.getAttributeStreamRef(0);let a=null;const l=Yn.getDefaultValue(1),u=this.m_description.hasAttribute(1);u&&(a=this.getAttributeStreamRef(1));let c=0;for(let h=s;h<r;h++,c++)e[c].x=o.read(2*h),e[c].y=o.read(2*h+1),e[c].z=u?a.read(h):l;return r}clearAndSetDirtyFlagProtected(e,i){let s=0;const n=e&~i,r=i|n;s=this.m_flags,(s&r)!==i&&(this.m_flags=s&~n|i)}getIsSimple(e,i){i[0]=0;let s=-1;const n=this.m_flags,r=this.m_simpleTolerance;return 1&n||(s=(14&n)>>1,i[0]=r,r<e&&(s=-1)),s}setIsSimple(e,i,s=!1){if(e===2?z(this.getGeometryType()===q.enumPolyline):e===1?z(this.getGeometryType()===q.enumMultiPoint||this.getGeometryType()===q.enumPolyline):e===3&&z(this.getGeometryType()===q.enumPolygon),e===-1)this.setDirtyFlagProtected(17,!0);else{let n=e<<1;s||(n|=16),this.clearAndSetDirtyFlagProtected(31,n),this.m_simpleTolerance!==i&&(this.m_simpleTolerance=i)}}attributeStreamIsAllocated(e){this.throwIfEmpty();const i=this.m_description.getAttributeIndex(e);return i>=0&&this.m_vertexAttributes.get(i)!==null}capacity(){return this.m_reservedPointCount===-1&&this.m_pointCount===0?0:this.m_reservedPointCount}getDescriptionImpl(){return this.m_description}copyToUnchecked(e,i=!1){i&&this.hasDirtyFlag(32)&&IRe("Cannot do shallow clone on unprepared geometry");const s=e,n=this.getGeometryType(),r=s.getGeometryType();z(n===r||n===q.enumPolygon&&r===q.enumPolyline,"failure in copyToUnchcked"),s.clearAccelerators(),s.m_description=this.m_description,s.m_vertexAttributes.destroyAndSetSize(0),s.m_envelopeData.releaseAttributes();const o=this.m_description.getAttributeCount(),a=new DD;if(!this.m_vertexAttributes.empty()){a.destroyAndSetSize(o);for(let l=0;l<o;l++)if(this.m_vertexAttributes.get(l))if(i)a.set(l,this.m_vertexAttributes.get(l));else{const u=Yn.getComponentCount(this.m_description.getSemantics(l));a.set(l,this.m_vertexAttributes.get(l).restrictedClone(this.getPointCount()*u))}}if(this.m_envelopeData.copyToIfNotNull(this.m_description,s.m_envelopeData),s.m_flags=this.m_flags,s.m_simpleTolerance=this.m_simpleTolerance,n!==r){const l=[Number.NaN];s.getIsSimple(0,l)>=3?s.setIsSimple(1,l[0]):s.setIsSimple(-1,0)}s.m_vertexAttributes.swap(a),a.destroyAndSetSize(0),s.m_pointCount=this.m_pointCount,s.hasDirtyFlag(32)?(z(!i),s.m_reservedPointCount=-1):s.m_reservedPointCount=s.m_pointCount;try{this.copyToImpl(s,i)}catch(l){throw s.setEmpty(),l}s.verifyAllStreamsAfterSizeChange()}buildRasterizedGeometryAccelerator(e,i){return!1}getAccelerators(){return this.m_accelerators}clearAccelerators(){this.m_accelerators&&this.m_accelerators.release(),this.m_accelerators=null}ensureUniqueAccelerators(){if(this.m_accelerators&&!this.m_accelerators.uniqueUse()){const e=this.m_accelerators.clone();this.m_accelerators.release(),this.m_accelerators=e}}interpolateTwoVertices(e,i,s,n){(e<0||e>=this.m_pointCount)&&bi(""),(i<0||i>=this.m_pointCount)&&bi(""),n.assignVertexDescription(this.m_description);const r=st(Yn.maxComponentCount(),Number.NaN),o=st(Yn.maxComponentCount(),Number.NaN),a=vm();let l=0;for(let u=0;u<this.m_description.getAttributeCount();u++){const c=this.m_description.getSemantics(u),h=Yn.getInterpolation(c),d=Yn.getComponentCount(c),m=Yn.getDefaultValue(c);this.queryAttributeAsDbl(c,e,r,d),this.queryAttributeAsDbl(c,i,o,d),z(l+d<=D7),KO(h,r,o,a,l,d,s,m),l+=d}cOe(n,a)}getShortestDistance(e,i){return N.distance(this.getXY(e),this.getXY(i))}getShortestSqrDistance(e,i){return N.sqrDistance(this.getXY(e),this.getXY(i))}resizeImpl(e){if(e<0&&ce(),(e=Math.ceil(e))===this.m_pointCount)return;this.m_pointCount=e;const i=this.m_pointCount<=this.m_reservedPointCount?2001:4095;this.notifyModifiedFlags(i)}assignVertexDescriptionImpl(e){if(!this.m_vertexAttributes.empty()){const i=JF();e4(e,this.m_description,i);const s=new DD;s.destroyAndSetSize(e.getAttributeCount());for(let n=0;n<e.getAttributeCount();n++){const r=i[n];r!==-1?s.set(n,this.m_vertexAttributes.get(r)):this.m_reservedPointCount=-1}s.swap(this.m_vertexAttributes)}this.m_description=e,this.m_envelopeData.releaseAttributes(),this.notifyModifiedFlags(4095)}hasDirtyFlag(e){return!!(this.m_flags&e)}setDirtyFlagProtected(e,i){i?this.m_flags|=e:this.m_flags&=~e}notifyModifiedAllImpl(){}verifyAllStreamsAfterSizeChange(){this.hasDirtyFlag(32)&&this.verifyAllStreamsAfterSizeChangeImpl()}verifyAllStreamsAfterSizeChangeImpl(){if(this.hasDirtyFlag(32)){if(this.m_reservedPointCount<this.m_pointCount){this.m_vertexAttributes.empty()&&this.m_vertexAttributes.destroyAndSetSize(this.m_description.getAttributeCount()),this.m_reservedPointCount=Number.MAX_SAFE_INTEGER;let e=0;e=this.m_pointCount<4?3:this.m_pointCount<=128?2*this.m_pointCount:Math.trunc((4*this.m_pointCount+2)/3);for(let i=0;i<this.m_description.getAttributeCount();i++){const s=this.m_description.getSemantics(i);let n=0;if(this.m_vertexAttributes.get(i)!==null){const r=Yn.getComponentCount(s);n=this.m_vertexAttributes.get(i).size()/r,n<this.m_pointCount&&(this.m_vertexAttributes.get(i).resize(e*r,Yn.getDefaultValue(s)),n=e)}else this.m_vertexAttributes.set(i,R7(s,e)),n=e;n<this.m_reservedPointCount&&(this.m_reservedPointCount=n)}}this.verifyStreamsAfterSizeChangeExtraImpl(),this.setDirtyFlagProtected(32,!1)}}verifyStreamsAfterSizeChangeExtraImpl(){}updateAllDirtyIntervals(e){if(e?this.hasDirtyFlag(192):this.hasDirtyFlag(128)){if(this.isEmpty())return this.hasDirtyFlag(192)&&this.m_envelopeData.setEmpty(this.m_description),void this.setDirtyFlagProtected(192,!1);const i=this.updateXYImpl(e),s=new Fo({vd:this.m_description});s.setEnvelope(i);for(let n=1;n<this.m_description.getAttributeCount();n++){const r=this.m_description.getSemantics(n),o=Yn.getComponentCount(r),a=this.m_vertexAttributes.get(n);for(let l=0;l<o;l++){const u=new Me;u.setEmpty();for(let c=0;c<this.m_pointCount;c++){const h=a.readAsDbl(c*o+l);u.mergeCoordinate(h)}s.setIntervalEnvelope(r,l,u)}}(e?this.hasDirtyFlag(192):this.hasDirtyFlag(128))&&(this.m_envelopeData=new ec({moveEnv:s}),this.clearDirtyIntervalsFlag(e))}}updateXYImpl(e){const i=J.constructEmpty(),s=this.m_vertexAttributes.get(0);return i.mergePointsInterleaved(s,0,this.m_pointCount),i}updateEnvelope3D(e){z(0)}updateLooseEnvelope(e){this.updateAllDirtyIntervals(!1),e instanceof J?e.assign(this.m_envelopeData.m_envelope2D):this.m_envelopeData.queryEnvelope3D(this.m_description,e)}updateEnvelope(e){this.updateAllDirtyIntervals(!0),e.assign(this.m_envelopeData.m_envelope2D)}setEmptyImpl(){this.m_pointCount=0,this.m_reservedPointCount=-1,this.m_vertexAttributes.destroyAndSetSize(0),this.notifyModifiedFlags(4095)}clearDirtyIntervalsFlag(e){this.setDirtyFlagProtected(192,!1)}reserveImpl(e,i){if(e<0&&ce(""),e===0)return;let s=e=Math.ceil(e);if(this.m_reservedPointCount<s){this.m_vertexAttributes.empty()&&this.m_vertexAttributes.destroyAndSetSize(this.m_description.getAttributeCount()),i?(this.m_vertexAttributes.get(0)===null&&this.m_vertexAttributes.set(0,t3(0,0)),this.m_vertexAttributes.get(0).resizeRounded(2*s),s=this.m_vertexAttributes.get(0).size()>>1):this.m_vertexAttributes.get(0)===null?this.m_vertexAttributes.set(0,t3(0,s)):this.m_vertexAttributes.get(0).resize(2*s);for(let n=1;n<this.m_description.getAttributeCount();n++){const r=this.m_description.getSemantics(n),o=Yn.getComponentCount(r);this.m_vertexAttributes.get(n)!==null?this.m_vertexAttributes.get(n).resize(s*o):this.m_vertexAttributes.set(n,t3(r,s))}this.reserveImplImpl(s,i),this.m_reservedPointCount=s}}reserveRounded(e){e<0&&ce(),e=Math.ceil(e),this.reserveImpl(e,!0)}reserveImplImpl(e,i){}throwIfEmpty(){this.isEmptyImpl()&&WF("")}},Dn=class ppe extends mpe{constructor(e){super(e),e&&(e.points?this.addPoints2D(e.points,e.pointsSize,0,-1):e.point&&this.add(e.point))}assignCopy(e){return e.copyTo(this),this}assignMove(e){return e.copyTo(this),e.setEmpty(),this}insertPoint2D(e,i){e>this.getPointCount()&&ce("invalid point index"),e<0&&(e=this.getPointCount());const s=this.m_pointCount;this.resizeNoInit(this.m_pointCount+1);for(let n=0,r=this.m_description.getAttributeCount();n<r;n++){const o=this.m_description.getSemantics(n),a=Hs.getComponentCount(o);if(o===0)this.m_vertexAttributes.get(n).insert(a*e,i,a*s);else{const l=Hs.getDefaultValue(o);this.m_vertexAttributes.get(n).insertRange(a*e,l,a,a*s)}}this.notifyModifiedFlags(2001)}insertPoint(e,i){i.isEmpty()&&ce(AG),e<0&&(e=this.getPointCount()),this.mergeVertexDescription(i.getDescription());const s=this.m_pointCount;this.resizeNoInit(this.m_pointCount+1);for(let n=0,r=this.m_description.getAttributeCount();n<r;n++){const o=this.m_description.getSemantics(n),a=Hs.getComponentCount(o);if(i.hasAttribute(o))this.m_vertexAttributes.get(n).insertAttributes(a*e,i,o,a*s);else{const l=Hs.getDefaultValue(o);this.m_vertexAttributes.get(n).insertRange(a*e,l,a,a*s)}}this.notifyModifiedFlags(2001)}insertPoints(e,i,s){if((e>this.getPointCount()||s<0)&&bi(""),e<0&&(e=this.getPointCount()),s===0)return;const n=i[0].getDescription();this.mergeVertexDescription(n);const r=this.m_pointCount;this.resizeNoInit(this.m_pointCount+s);for(let o=0,a=this.m_description.getAttributeCount();o<a;o++){const l=this.m_description.getSemantics(o),u=Hs.getComponentCount(l);if(this.m_vertexAttributes.get(o))if(n.hasAttribute(l))this.m_vertexAttributes.get(o).insertAttributesFromPoints(e*u,i,s,l,r*u);else{const c=Hs.getDefaultValue(l);this.m_vertexAttributes.get(o).insertRange(u*e,c,u*s,u*r)}}this.notifyModifiedFlags(2001)}insertPoints2D(e,i,s){if((e>this.getPointCount()||s<0)&&ce("invalid point index"),e<0&&(e=this.getPointCount()),s===0)return;const n=this.m_pointCount;this.resizeNoInit(this.m_pointCount+s);for(let r=0,o=this.m_description.getAttributeCount();r<o;r++){const a=this.m_description.getSemantics(r),l=Hs.getComponentCount(a);if(this.m_vertexAttributes.get(r))if(a===0)this.m_vertexAttributes.get(r).insertRangeFromPoints(l*e,i,0,s,!0,l*n);else{const u=Hs.getDefaultValue(a);this.m_vertexAttributes.get(r).insertRange(l*e,u,l,l*n)}}this.notifyModifiedFlags(2001)}removePoints(e,i){if((e<0||i<0||e+i>this.getPointCount())&&bi("remove_points"),i!==0){for(let s=0,n=this.m_description.getAttributeCount();s<n;s++)if(this.m_vertexAttributes.get(s)){const r=this.m_description.getSemantics(s),o=Hs.getComponentCount(r);this.m_vertexAttributes.get(s).eraseRange(o*e,o*i,o*this.m_pointCount)}this.m_pointCount-=i,this.m_reservedPointCount>0&&(this.m_reservedPointCount-=i),this.notifyModifiedFlags(2001)}}removePoint(e){for(let i=0,s=this.m_description.getAttributeCount();i<s;i++)if(this.m_vertexAttributes.get(i)){const n=this.m_description.getSemantics(i),r=Hs.getComponentCount(n);this.m_vertexAttributes.get(i).eraseRange(r*e,r,r*this.m_pointCount)}this.m_pointCount--,this.m_reservedPointCount>0&&this.m_reservedPointCount--,this.notifyModifiedFlags(2001)}calculateEnvelope2D(){return this.updateXYImpl(!0)}resizeNoInit(e){this.resizeImpl(e)}resizeAndInitNonPositionAttributes(e){const i=this.m_pointCount;if(this.resizeImpl(e),this.m_pointCount>i)for(let s=1,n=this.m_description.getAttributeCount();s<n;s++){const r=this.m_description.getSemantics(s),o=Hs.getDefaultValue(r),a=Hs.getComponentCount(r);this.m_vertexAttributes.get(s).insertRange(a*i,o,a*(this.m_pointCount-i),a*i)}}queryCoordinates3D(e,i,s,n){let r=n<0?this.m_pointCount:n;if(r=Math.min(r,s+i),(s<0||r<s||this.m_pointCount>0&&s>=this.m_pointCount)&&ce(""),this.m_pointCount===0)return r;const o=this.getAttributeStreamRef(0);let a=null;const l=Hs.getDefaultValue(1),u=this.m_description.hasAttribute(1);u&&(a=this.getAttributeStreamRef(1));let c=0;for(let h=s;h<r;h++,c++)e[c].x=o.read(2*h),e[c].y=o.read(2*h+1),e[c].z=u?a.read(h):l;return r}queryAttributeAsInt(e,i,s,n){z(0)}add(e){e.isEmpty()&&ce(AG),this.resizeAndInitNonPositionAttributes(this.m_pointCount+1),this.setPointByVal(this.m_pointCount-1,e)}addXY(e,i){this.resizeAndInitNonPositionAttributes(this.m_pointCount+1);const s=new N(e,i);this.setXY(this.m_pointCount-1,s)}addXYZ(e,i,s){this.resizeAndInitNonPositionAttributes(this.m_pointCount+1);const n=new gi;n.setCoords(e,i,s),this.setXYZ(this.m_pointCount-1,n)}addPoint2D(e){this.addXY(e.x,e.y)}addPoint3D(e){this.addXYZ(e.x,e.y,e.z)}addPoints(e,i,s){this===e&&ce("Multi_point_impl.add");const n=s<0?e.getPointCount():s;if((i<0||i>e.getPointCount()||n<i)&&ce(""),i===n)return;const r=e.getDescription();this.mergeVertexDescription(r);const o=n-i,a=this.m_pointCount;this.resizeNoInit(this.m_pointCount+o);for(let l=0,u=this.m_description.getAttributeCount();l<u;l++){const c=this.m_description.getSemantics(l),h=Hs.getComponentCount(c),d=this.getAttributeStreamRef(c);if(r.hasAttribute(c)){const m=e.getAttributeStreamRef(c);d.insertRangeFromStream(a*h,m,i*h,o*h,!0,1,a*h)}else{const m=Hs.getDefaultValue(c);d.insertRange(a*h,m,o*h,a*h)}}}addPoints2D(e,i,s,n){let r=i;const o=n<0?r:n;if((r<0||s<0||s>r||o<s)&&ce(""),s===o)return;r=o-s;const a=this.m_pointCount;this.resizeAndInitNonPositionAttributes(this.m_pointCount+r);const l=this.getAttributeStreamRef(0);for(let u=0;u<r;++u)l.writePoint2D(2*(a+u),e[s+u]);this.notifyModifiedFlags(2001)}addPoints3D(e,i,s,n){let r=i;const o=n<0?r:n;if((r<0||s<0||s>r||o<s)&&ce(""),this.addAttribute(1),s===o)return;r=o-s;const a=this.m_pointCount;this.resizeAndInitNonPositionAttributes(this.m_pointCount+r);const l=this.getAttributeStreamRef(0),u=new N;for(let h=0;h<r;h++)u.x=e[s+h].x,u.y=e[s+h].y,l.writePoint2D(2*(a+h),u);const c=this.getAttributeStreamRef(1);for(let h=0;h<r;h++)c.write(a+h,e[s+h].z);this.notifyModifiedFlags(2001)}getGeometryType(){return q.enumMultiPoint}getDimension(){return 0}createInstance(){return new ppe({vd:this.getDescription()})}setEmpty(){this.setEmptyImpl()}applyTransformation(e){if(this.isEmpty()||e.isIdentity())return;const i=this.m_vertexAttributes.get(0);e.m_TransformationType===1?i.applyTransformation(e,0,this.m_pointCount):_i("3d xform not impl"),this.notifyModifiedFlags(2001)}calculateArea2D(){return 0}calculateLength2D(){return 0}calculateLength3D(e){return 0}equals(e,i){return e.getGeometryType()===q.enumMultiPoint&&this.equalsBase(e,i)}queryEnvelope(e){e.m_EnvelopeType===4?(this.updateAllDirtyIntervals(!0),this.m_envelopeData.copyTo(this.m_description,e)):e.m_EnvelopeType===2?this.updateEnvelope(e):_i("")}getImpl(){return this}getBoundary(){return null}reserve(e){this.reserveImpl(e)}clone(){const e=this.createInstance();return this.copyTo(e),e}swap(e){z(0)}buildQuadTreeAccelerator(e){return!1}getHashCodeImpl(){return z(0),0}equalsImpl(e){return!0}equalsImplTol(e,i){return!0}copyToImpl(e,i){}};Dn.type=q.enumMultiPoint;let ua=class IG{constructor(){this.m_EnvelopeType=5,this.envAabb=J.constructEmpty(),this.envRot=J.constructEmpty()}static constructEmpty(){return new IG}width(){return this.envAabb.width()}height(){return this.envAabb.height()}maxDim(){return Math.max(this.width(),this.height())}setEmpty(){this.envAabb.setEmpty(),this.envRot.setEmpty()}setCoords(e){this.envAabb.setCoords(e),this.envRot.setCoords({x:O2(e),y:L2(e)})}setFromPoints(e,i){this.setEmpty(),this.mergePoints(e,i)}mergeNe(e){this.envAabb.mergeNe(e),this.envRot.mergeNeCoords(O2(e),L2(e))}mergePoints(e,i){this.envAabb.mergePoints(e,i);for(let s=0;s<i;){if(!this.envRot.isEmpty()){for(let n=s;n<i;n++){const r=O2(e[n]),o=L2(e[n]);this.envRot.mergeNeCoords(r,o)}break}{const n=O2(e[s]),r=L2(e[s]);this.envRot.setCoords({x:n,y:r}),s++}}}isIntersectingPoint2D(e){return!(!this.envAabb.contains(e)||!this.envRot.containsCoords(O2(e),L2(e)))}isIntersectingW(e){return this.envAabb.isIntersecting(e.envAabb)&&this.envRot.isIntersecting(e.envRot)}containsW(e){return!(!this.envAabb.containsEnvelope(e.envAabb)||!this.envRot.containsEnvelope(e.envRot))}containsPoint2D(e){return this.isIntersectingPoint2D(e)}intersectW(e){const i=this.envAabb.intersect(e.envAabb),s=this.envRot.intersect(e.envRot);return i&&!s&&this.envAabb.setEmpty(),s&&!i&&this.envRot.setEmpty(),i&&s}inflate(e){this.envAabb.inflateCoords(e,e);const i=e*S3e();this.envRot.inflateCoords(i,i),i<0&&IG.st_reduceEmpty(this)}static st_reduceEmpty(e){const i=e.envAabb.isEmpty(),s=e.envRot.isEmpty();i&&!s?e.envRot.setEmpty():s&&!i&&e.envAabb.setEmpty()}};function O2(t){return t.x-t.y}function L2(t){return t.x+t.y}let Et=class d_{constructor(){this.x=ge.getNAN(),this.y=ge.getNAN()}static getNAN(){return new d_}static constructPoint2D(e){const i=new d_;return i.x.set(e.x),i.y.set(e.y),i}static constructCoords(e,i){const s=new d_;return s.x.set(e),s.y.set(i),s}static constructCoordsE(e,i){const s=new d_;return s.setCoordsE(e,i),s}get 0(){return this.x.clone()}set 0(e){this.x.setE(e)}get 1(){return this.y.clone()}set 1(e){this.y.setE(e)}clone(){return new d_().setE(this)}scaleThis(e){return this.x.mulThisE(e),this.y.mulThisE(e),this}setCoords(e,i){return this.x.set(e),this.y.set(i),this}setCoordsE(e,i){return this.x.setE(e),this.y.setE(i),this}set(e){return this.x.set(e.x),this.y.set(e.y),this}setE(e){return this.x.setE(e.x),this.y.setE(e.y),this}setWithEps(e,i){return this.x.setWithEps(e.x,i),this.y.setWithEps(e.y,i),this}getUnitVector(){const e=this.clone();return e.normalize(),e}sqrLength(){return this.x.sqr().addE(this.y.sqr())}length(){return this.sqrLength().sqrt()}mulE(e){const i=new d_;return i.setCoordsE(this.x.mulE(e),this.y.mulE(e)),i}mul(e){const i=new d_;return i.setCoordsE(this.x.mul(e),this.y.mul(e)),i}mulThis(e){return this.x.mulThis(e),this.y.mulThis(e),this}mulThisE(e){return this.x.mulThisE(e),this.y.mulThisE(e),this}divE(e){return this.clone().divThisE(e)}divThisE(e){return this.x.divThisE(e),this.y.divThisE(e),this}normalize(){const e=this.length();e.value()===0?(this.x=Ff.clone(),this.y=ZS.clone()):(this.x.divThisE(e),this.y.divThisE(e))}addE(e){return this.clone().addThisE(e)}addThisE(e){return this.x.addThisE(e.x),this.y.addThisE(e.y),this}subE(e){return this.clone().subThisE(e)}subThisE(e){return this.x.subThisE(e.x),this.y.subThisE(e.y),this}static distance(e,i){return e.subE(i).length()}negateThis(){return this.x.negateThis(),this.y.negateThis(),this}eq(e){return this.x.eq(e.x)&&this.y.eq(e.y)}isZero(){return this.x.isZero()&&this.y.isZero()}isTrueZero(){return!this.x.value()&&!this.y.value()}rotateDirect(e,i){const s=this.x.mulE(e).subThisE(this.y.mulE(i)),n=this.x.mulE(i).addThisE(this.y.mulE(e));return this.x.setE(s),this.y.setE(n),this}rotateReverse(e,i){const s=this.x.mulE(e).addThisE(this.y.mulE(i)),n=this.x.negate().mulThisE(i).addThisE(this.y.mulE(e));return this.x.setE(s),this.y.setE(n),this}dotProduct(e){return this.x.mulE(e.x).addE(this.y.mulE(e.y))}crossProduct(e){return this.x.mulE(e.y).subE(this.y.mulE(e.x))}value(){return N.construct(this.x.value(),this.y.value())}},DG=class fpe{constructor(){this.a11=new ge(1),this.a12=new ge(0),this.a21=new ge(0),this.a22=new ge(1)}clone(){const e=new fpe;return e.a11.setE(this.a11),e.a12.setE(this.a12),e.a21.setE(this.a21),e.a22.setE(this.a22),e}assign(e){return this.a11.setE(e.a11),this.a12.setE(e.a12),this.a21.setE(e.a21),this.a22.setE(e.a22),this}mulThis(e){const i=this.a11.mulE(e.a11).addThisE(this.a12.mulE(e.a21)),s=this.a11.mulE(e.a12).addThisE(this.a12.mulE(e.a22)),n=this.a21.mulE(e.a11).addThisE(this.a22.mulE(e.a21)),r=this.a21.mulE(e.a12).addThisE(this.a22.mulE(e.a22));return this.a11=i,this.a12=s,this.a21=n,this.a22=r,this}mulLeftThis(e){const i=e.clone();return this.assign(i.mulThis(this)),this}det(){return this.a11.mulE(this.a22).subThisE(this.a12.mulE(this.a21))}invertThis(){const e=this.det();if(e.value()!==0){const i=this.a22.divE(e),s=this.a12.negate().divThisE(e),n=this.a21.negate().divThisE(e),r=this.a11.divE(e);this.a11=i,this.a12=s,this.a21=n,this.a22=r}else this.setZero();return!e.isZero()}transposeThis(){return this.a21=Ge(this.a12,this.a12=this.a21),this}eigenSymmetric(e,i){const s=this.a12.clone();s.addThisE(this.a21),s.mulThisByPower2(.5);let n=new ge(1),r=new ge(0);if(s.isZero())e[0].setE(this.a11),e[1].setE(this.a22);else{const o=new ge(1);if(this.a11.ne(this.a22)){const a=this.a11.subE(this.a22).divE(s);a.mulThisByPower2(.5);const l=a.sqr();o.setE(a),o.absThis(),o.subThisE(l.add(1).sqrtThis()),a.gt(ZS)&&o.negateThis();const u=o.sqr().addThis(1).sqrtThis().invThis();r=o.mulE(u),n.setE(u);const c=o.mulE(s);e[0]=this.a11.addE(c),e[1]=this.a22.subE(c)}else n=new ge(1/Math.sqrt(2)),r=n.clone(),e[0]=this.a11.addE(s),e[1]=this.a22.subE(s)}i[0].x=n.toDouble(),i[0].y=r.toDouble(),i[1].x=r.negate().toDouble(),i[1].y=n.toDouble(),Math.abs(e[0].toDouble())>Math.abs(e[1].toDouble())&&(e[1]=Ge(e[0],e[0]=e[1]),i[1]=Ge(i[0],i[0]=i[1]))}setZero(){this.a11.set(0),this.a21.set(0),this.a12.set(0),this.a22.set(0)}};var by=Hs;function Mu(t,e){const i=t.getStartXY();if(i.equals(e.getStartXY())||i.equals(e.getEndXY()))return!0;const s=t.getEndXY();return!!s.equals(e.getStartXY())||!!s.equals(e.getEndXY())}function s4(t,e){let i=t.calculateLowerLength2D();return!(i>e)&&(!!t.isLine()||(i=t.calculateUpperLength2D(),i<=e||e!==0&&t.calculateLength2D()<=e))}function k7(t,e){const i=t.getEndXY().sub(t.getStartXY()).length(),s=t.calculateUpperLength2D()-i<=e[0];return e[0]*=.1,s}function gpe(t,e,i,s,n,r,o,a){let l=t.calculateUpperLength2D(),u=e.calculateUpperLength2D(),c=t,h=e,d=!1;l>u&&(h=Ge(c,c=h),s=Ge(i,i=s),u=Ge(l,l=u),d=!0);const m=i===0;{o[0]=m?1:0;const A=c.getCoord2D(o[0]);a[0]=h.getClosestCoordinate(A,!1);const I=h.getCoord2D(a[0]);if(N.distance(A,I)<=n){const L=[.5,.75,.25,.1,.9];let D=!0;for(let O=0;O<L.length;O++)if(A.assign(c.getCoord2D(L[O])),!h.isCloserThanDistance(A,new Me(0,1),n)){D=!1;break}if(D)return d&&(a[0]=Ge(o[0],o[0]=a[0])),1}}if(l<=3*n)return 0;let f=Os(Math.max(n/l,.1),0,.5),_=.01*n,v=0,x=0,w=f,T=-1,C=0,M=1/32;for(let A=0;;A++){z(A<4095);const I=m?f:1-f,L=c.getCoord2D(I),D=h.getClosestCoordinate(L,!1);if(D===s)return C;const O=h.getCoord2D(D),U=N.distance(L,O);if(A===0&&(T=U),U<=_?(M=.5,x=U,v=f):(w=f,T=U),Math.abs(x-T)>.1*_&&w-v>1e-16)f=es(v,w,M);else{if(o[C]=I,a[C]=D,d&&(a[C]=Ge(o[C],o[C]=a[C])),r===1||C===1)return C===1&&o[0]>o[1]&&(o[1]=Ge(o[0],o[0]=o[1]),a[1]=Ge(a[0],a[0]=a[1])),C+1;C++,v=w,x=T,w=.8,T=-1,f=.8,M=1/32,_=10*n,A=0}}}function HC(t,e,i,s,n,r,o,a,l){if(Vs(i,0,1)&&Vs(s,0,1)&&N.distance(t.getCoord2D(i),e.getCoord2D(s))===0){const c=new Et,h=cn();if(t.queryDerivative(new ge(i,h),c),c.isTrueZero()){const v=i===1?-1e-12:1e-12;t.queryDerivative(new ge(i,h).add(v),c)}i===1&&c.negateThis();const d=new Et;if(e.queryDerivative(new ge(s,h),d),d.isTrueZero()){const v=i===1?-1e-12:1e-12;e.queryDerivative(new ge(s,h).add(v),d)}s===1&&d.negateThis(),c.isZero()||c.normalize(),d.isZero()||d.normalize();const m=c.dotProduct(d),f=c.crossProduct(d);f.scaleError(3);const _=()=>{{const v=t.calculateUpperLength2D(),x=e.calculateUpperLength2D();return Math.min(.01*n/Math.min(v,x),1e-10)}};if(m.ge(ZS)&&(f.isZero()||Math.abs(f.value())<_()))return gpe(t,e,i,s,n,r,o,a)}return 0}function hOe(t,e,i){return z(t.isCurve()||e.isCurve()),!!(t.getStartXY().equals(e.getStartXY())&&HC(t,e,0,0,i,2,[0,0],[0,0])||t.getEndXY().equals(e.getEndXY())&&HC(t,e,1,1,i,2,[0,0],[0,0])||t.getStartXY().equals(e.getEndXY())&&HC(t,e,0,1,i,2,[0,0],[0,0])||t.getEndXY().equals(e.getStartXY())&&HC(t,e,1,0,i,2,[0,0],[0,0]))}function $7(t,e){t.m_XStart=e.x,t.m_YStart=e.y}function mJ(t,e,i){t.m_XStart=e,t.m_YStart=i}function U7(t,e){t.m_XEnd=e.x,t.m_YEnd=e.y}function pJ(t,e,i){t.m_XEnd=e,t.m_YEnd=i}function dOe(t,e,i){e?t.m_XEnd===i.x&&t.m_YEnd===i.y||(t.m_XEnd=i.x,t.m_YEnd=i.y,t.endPointModified()):t.m_XStart===i.x&&t.m_YStart===i.y||(t.m_XStart=i.x,t.m_YStart=i.y,t.endPointModified())}function fJ(t,e){const i=new gi;return e?(i.x=t.m_XEnd,i.y=t.m_YEnd):(i.x=t.m_XStart,i.y=t.m_YStart),i.z=mOe(t,e),i}function mOe(t,e){return t.m_description.hasZ()?t.m_attributes[e*(t.m_description.getTotalComponentCount()-2)]:by.getDefaultValue(1)}function ND(t,e,i){t.m_description.hasZ()||t.addAttribute(1),e?t.m_XEnd===i.x&&t.m_YEnd===i.y||(t.m_XEnd=i.x,t.m_YEnd=i.y,t.endPointModified()):t.m_XStart===i.x&&t.m_YStart===i.y||(t.m_XStart=i.x,t.m_YStart=i.y,t.endPointModified()),t.m_attributes[(t.m_description.getTotalComponentCount()-2)*e]=i.z}function gJ(t,e,i){i.assignVertexDescription(t.m_description);const s=e===0?t.m_XStart:t.m_XEnd,n=e===0?t.m_YStart:t.m_YEnd;i.setXYCoords(s,n);for(let r=1;r<t.m_description.getAttributeCount();r++){const o=t.m_description.getSemantics(r);for(let a=0,l=by.getComponentCount(o);a<l;a++){const u=id(t,e,o,a);i.setAttributeBasic(o,a,u)}}}function _J(t,e,i){i.isEmpty()&&WF(""),dOe(t,e,i.getXY());const s=i.getDescription();s!==t.m_description&&t.mergeVertexDescription(s);for(let n=1,r=s.getAttributeCount();n<r;n++){const o=s.getSemantics(n),a=by.getComponentCount(o);for(let l=0;l<a;l++)pf(t,e,o,l,i.getAttributeAsDbl(o,l))}}function id(t,e,i,s){if((e<0||e>1)&&bi(""),i===0)return(s<0||s>=2)&&bi(""),e===0?s===0?t.m_XStart:t.m_YStart:s===0?t.m_XEnd:t.m_YEnd;const n=by.getComponentCount(i);(s<0||s>=n)&&bi("");const r=t.m_description.getAttributeIndex(i);return r>=0?t.m_attributes[e*(t.m_description.getTotalComponentCount()-2)+t.m_description.getPointAttributeOffset(r)-2+s]:by.getDefaultValue(i)}function pf(t,e,i,s,n){if((e<0||e>1)&&bi(""),i===0)return e===0?s===0?t.m_XStart=n:s===1?t.m_YStart=n:bi(""):e===1?s===0?t.m_XEnd=n:s===1?t.m_YEnd=n:bi(""):bi(""),void t.endPointModified();const r=by.getComponentCount(i);(s<0||s>=r)&&bi("");let o=t.m_description.getAttributeIndex(i);o<0&&(t.addAttribute(i),o=t.m_description.getAttributeIndex(i)),t.m_attributes[e*(t.m_description.getTotalComponentCount()-2)+t.m_description.getPointAttributeOffset(o)-2+s]=n}function _pe(t,e){if(t===e)return;e.isEmpty()&&WF("");const i=e.getDescription();i!==t.m_description&&t.mergeVertexDescription(i);for(let s=1,n=i.getAttributeCount();s<n;s++){const r=i.getSemantics(s),o=by.getComponentCount(r);for(let a=0;a<o;a++){let l=id(e,0,r,a);pf(t,0,r,a,l),l=id(e,1,r,a),pf(t,1,r,a,l)}}}function pOe(t,e){const i=JF();e4(e,t.m_description,i);let s=null;const n=e.getTotalComponentCount()-2,r=t.m_description?t.m_description.getTotalComponentCount()-2:0;if(n>0&&(s=st(2*n,Number.NaN),Qs(s,e.getDefaultPointAttributes(),0,2,n),Qs(s,e.getDefaultPointAttributes(),n,2,n),t.m_description!==null))for(let o=1;o<e.getAttributeCount();o++){const a=i[o];if(a!==-1){const l=t.m_description.getPointAttributeOffset(a)-2,u=e.getPointAttributeOffset(o)-2,c=by.getComponentCount(e.getSemantics(o));for(let h=0;h<c;++h)s[u]=t.m_attributes[l],s[n+u]=t.m_attributes[r+l]}}t.m_attributes=s,t.m_description=e}function Em(t){return t.absNorm()*_1()}function hl(t,e){return Math.max(t.absNorm(),e.absNorm())*_1()}function Au(t,e,i){const s=new ua;t.queryEnvelopeW(Me.unit(),s);const n=new ua;return e.queryEnvelopeW(Me.unit(),n),n.inflate(i),!s.isIntersectingW(n)}function V7(t,e,i){const s=eL(t,i),n=eL(e,i);s.sort((r,o)=>r.compare(o)),n.sort((r,o)=>r.compare(o));for(let r=0;r<3;r++){if(s[r].compare(n[r])<0)return-1;if(s[r].compare(n[r])!==0)return 1}return 0}var Ux=Hs;class dA{constructor(e){if(e.copy)this.m_XStart=e.copy.m_XStart,this.m_YStart=e.copy.m_YStart,this.m_XEnd=e.copy.m_XEnd,this.m_YEnd=e.copy.m_YEnd,this.m_description=e.copy.m_description,this.m_attributes=null,this.m_description&&this.m_description.getTotalComponentCount()-2&&(this.m_attributes=e.copy.m_attributes.slice());else{if(e.move)return this.m_description=e.move.m_description,e.move.m_description=null,this.m_attributes=e.move.m_attributes,e.move.m_attributes=null,this.m_XStart=e.move.m_XStart,this.m_YStart=e.move.m_YStart,this.m_XEnd=e.move.m_XEnd,void(this.m_YEnd=e.move.m_YEnd);if(e.XStart!==void 0)return this.m_XStart=e.XStart,this.m_YStart=e.YStart,this.m_XEnd=e.XEnd,this.m_YEnd=e.YEnd,this.m_attributes=null,this.m_description=e.vd?e.vd:go(),void(e.vd&&this.setDefaultAttributeValues());if(e.ZStart!==void 0)return this.m_XStart=e.XStart,this.m_YStart=e.YStart,this.m_XEnd=e.XEnd,this.m_YEnd=e.YEnd,this.m_description=e.vd?e.vd:LP(),void(e.vd?(this.setDefaultAttributeValues(),this.addAttribute(1),this.m_attributes[0]=e.ZStart,this.m_attributes[this.m_description.getTotalComponentCount()-2]=e.ZEnd):this.m_attributes=[e.ZStart,e.ZEnd]);if(e.start)return this.m_XStart=e.start.x,this.m_YStart=e.start.y,this.m_XEnd=e.end.x,this.m_YEnd=e.end.y,this.m_attributes=null,void(this.m_description=go());if(e.start3D)return this.m_XStart=e.start3D.x,this.m_YStart=e.start3D.y,this.m_XEnd=e.end3D.x,this.m_YEnd=e.end3D.y,this.m_description=e.vd?e.vd:LP(),void(e.vd?(this.setDefaultAttributeValues(),this.addAttribute(1),this.m_attributes[0]=e.start3D.z,this.m_attributes[this.m_description.getTotalComponentCount()-2]=e.end3D.z):this.m_attributes=[e.start3D.z,e.end3D.z]);We("bad constructor params"),this.m_XStart=this.m_YStart=this.m_XEnd=this.m_YEnd=Number.NaN}}setDefaultAttributeValues(){const e=this.m_description.getTotalComponentCount()-2;e>0&&(this.m_attributes===null&&(this.m_attributes=st(2*e,Number.NaN)),Qs(this.m_attributes,this.m_description.getDefaultPointAttributes(),0,2,e),Qs(this.m_attributes,this.m_description.getDefaultPointAttributes(),e,2,e))}absNormXYZ(e){return _i("not implemented"),0}snapControlPoints3D(){return _i("not implemented"),!1}setCoordsForIntersector3D(e,i,s){_i("not implemented")}transformAttribute(e,i,s,n,r){_i("")}mergeVertexDescriptionImpl(e){const i=this.getDescription(),s=JS(i,e);this.assignVertexDescription(s)}changeEndPoints(e,i){const s=e.getXY(),n=i.getXY();this.changeEndPoints2D(s,n);let r=e.getDescription();r!==this.getDescription()&&this.mergeVertexDescription(r),r=i.getDescription(),r!==this.getDescription()&&this.mergeVertexDescription(r);for(let o=1,a=r.getAttributeCount();o<a;o++){const l=r.getSemantics(o),u=Ux.getComponentCount(l);for(let c=0;c<u;c++)pf(this,0,l,c,e.getAttributeAsDbl(l,c)),pf(this,1,l,c,i.getAttributeAsDbl(l,c))}}getStartXY(){return new N(this.m_XStart,this.m_YStart)}setStartXY(e){this.m_XStart=e.x,this.m_YStart=e.y,this.endPointModified()}setStartXYCoords(e,i){this.m_XStart=e,this.m_YStart=i,this.endPointModified()}getStartXYZ(){return fJ(this,0)}setStartXYZ(e){ND(this,0,e)}setStartXYZCoords(e,i,s){ND(this,0,gi.construct(e,i,s))}queryStart(e){gJ(this,0,e)}setStart(e){_J(this,0,e)}setStart2D(e){this.setStartXY(e)}getStartAttributeAsDbl(e,i){return id(this,0,e,i)}getStartAttributeAsInt(e,i){return z(0),0}setStartAttribute(e,i,s){pf(this,0,e,i,s)}setStartAttributesFromPoint(e,i){const s=e.getDescription();for(let n=i&&s.hasZ()?2:1,r=s.getAttributeCount();n<r;++n){const o=s.getSemantics(n),a=Ux.getComponentCount(o);for(let l=0;l<a;++l){const u=e.getAttributeAsDbl(o,l);this.setStartAttribute(o,l,u)}}}setEndAttributesFromPoint(e,i){const s=e.getDescription();for(let n=i&&s.hasZ()?2:1,r=s.getAttributeCount();n<r;++n){const o=s.getSemantics(n),a=Ux.getComponentCount(o);for(let l=0;l<a;++l){const u=e.getAttributeAsDbl(o,l);this.setEndAttribute(o,l,u)}}}getStartX(){return this.m_XStart}getStartY(){return this.m_YStart}getStartZ(){return z(0),0}getEndX(){return this.m_XEnd}getEndY(){return this.m_YEnd}getEndZ(){return z(0),0}getEndXY(){return new N(this.m_XEnd,this.m_YEnd)}setEndXY(e){this.m_XEnd=e.x,this.m_YEnd=e.y,this.endPointModified()}setEndXYCoords(e,i){this.m_XEnd=e,this.m_YEnd=i,this.endPointModified()}getEndXYZ(){return fJ(this,1)}setEndXYZ(e){ND(this,1,e)}setEndXYZCoords(e,i,s){ND(this,1,gi.construct(e,i,s))}queryEnd(e){gJ(this,1,e)}setEnd(e){_J(this,1,e)}setEnd2D(e){this.setEndXY(e)}getEndAttributeAsDbl(e,i){return id(this,1,e,i)}getEndAttributeAsInt(e,i){return z(0),Math.trunc(0)}setEndAttribute(e,i,s){pf(this,1,e,i,s)}getDimension(){return 1}copyTo(e){if(this===e)return;e.getGeometryType()!==this.getGeometryType()&&ce("");const i=e;i.assignVertexDescription(this.m_description),i.m_attributes&&Qs(i.m_attributes,this.m_attributes,0,0,2*(this.m_description.getTotalComponentCount()-2)),i.m_XStart=this.m_XStart,i.m_YStart=this.m_YStart,i.m_XEnd=this.m_XEnd,i.m_YEnd=this.m_YEnd,this.copyToImpl(i)}isEmpty(){return this.isEmptyImpl()}isClosed(){return this.m_XStart===this.m_XEnd&&this.m_YStart===this.m_YEnd}setEmpty(){}calculateArea2D(){return 0}queryInterval(e,i){const s=Me.constructEmpty();return s.vmin=id(this,0,e,i),s.vmax=s.vmin,s.mergeNeCoordinate(id(this,1,e,i)),s}calculateLength3D(e){return z(0),0}getCoord3D(e){return z(0),{}}getCoord2D(e){const i=N.getNAN();return this.queryCoord2D(e,i),i}queryCoord3D(e,i){z(0)}getCoordZ(e){return z(0),0}queryCoord(e,i){i.assignVertexDescription(this.m_description),i.setXY(this.getCoord2D(e));for(let s=1,n=this.m_description.getAttributeCount();s<n;s++){const r=this.m_description.getSemantics(s),o=Ux.getComponentCount(r);for(let a=0;a<o;a++){const l=this.getAttributeAsDbl(e,r,a);i.setAttributeBasic(r,a,l)}}}isCloserThanDistance(e,i,s){const n=J.constructEmpty();if(this.queryLooseEnvelopeOnInterval(i,n),n.distance(e)>s)return!1;const r=this.getClosestCoordinateOnInterval(e,i,s);return!Number.isNaN(r)&&N.distance(e,this.getCoord2D(r))<=s}isMonotoneQuickAndDirty(){return!1}isTrue3D(){return!1}getReversed(){const e=this.clone();return e.reverse(),e}reverse(){this.m_XEnd=Ge(this.m_XStart,this.m_XStart=this.m_XEnd),this.m_YEnd=Ge(this.m_YStart,this.m_YStart=this.m_YEnd),this.reverseImpl();for(let e=1,i=this.m_description.getAttributeCount();e<i;e++){const s=this.m_description.getSemantics(e);for(let n=0,r=Ux.getComponentCount(s);n<r;n++){const o=id(this,0,s,n);pf(this,0,s,n,id(this,1,s,n)),pf(this,1,s,n,o)}}return this.afterCompletedModification(),this}isEmptyImpl(){return!1}isCircular(){return!1}distance(e,i,s,n){if(!i&&this.isIntersecting(e,0,!1)){if(s!==null||n!==null){const u=st(9,Number.NaN),c=st(9,Number.NaN),h=this.intersect(e,null,u,c,0);z(h<=9),h===0&&We(""),s!==null&&(s[0]=u[0]),n!==null&&(n[0]=c[0])}return 0}let r,o=Number.MAX_VALUE,a=-1,l=o;return r=this.getStartXY(),a=e.getClosestCoordinate(r,!1),r.subThis(e.getCoord2D(a)),l=r.length(),l<o&&(o=l,n!==null&&(n[0]=a),s!==null&&(s[0]=0)),r=this.getEndXY(),a=e.getClosestCoordinate(r,!1),r.subThis(e.getCoord2D(a)),l=r.length(),l<o&&(o=l,n!==null&&(n[0]=a),s!==null&&(s[0]=1)),r=e.getStartXY(),a=this.getClosestCoordinate(r,!1),r.subThis(this.getCoord2D(a)),l=r.length(),l<o&&(o=l,s!==null&&(s[0]=a),n!==null&&(n[0]=0)),r=e.getEndXY(),a=this.getClosestCoordinate(r,!1),r.subThis(this.getCoord2D(a)),l=r.length(),l<o&&(o=l,s!==null&&(s[0]=a),n!==null&&(n[0]=1)),o}calculateSubLengthFromStart(e){return this.tToLength(e)}calculateSubLength(e,i){return i===e?0:this.tToLength(i)-this.tToLength(e)}static recalculateParentT(e,i,s){return es(e,i,s)}moveTo(e){const i=this.isClosed(),s=new Gi;s.setShift(e.sub(this.getStartXY())),this.applyTransformation(s),i?this.changeEndPoints2D(e,e):this.changeEndPoints2D(e,this.getEndXY())}moveTo3D(e){z(0)}getDescription(){return this.m_description}assignVertexDescription(e){pOe(this,e)}mergeVertexDescription(e){this.m_description!==e&&(this.m_description.hasAttributesFrom(e)||this.mergeVertexDescriptionImpl(e))}hasAttribute(e){return this.m_description.hasAttribute(e)}addAttribute(e){if(this.m_description.hasAttribute(e))return;const i=uA(this.m_description,e);this.assignVertexDescription(i)}dropAttribute(e){if(!this.m_description.hasAttribute(e))return;const i=cA(this.m_description,e);this.assignVertexDescription(i)}dropAllAttributes(){const e=go();e!==this.m_description&&this.assignVertexDescription(e)}swap(e){if(this===e)return;e.getGeometryType()!==this.getGeometryType()&&ce("wrong geometry type");const i=e;i.m_description=Ge(this.m_description,this.m_description=i.m_description),i.m_XStart=Ge(this.m_XStart,this.m_XStart=i.m_XStart),i.m_YStart=Ge(this.m_YStart,this.m_YStart=i.m_YStart),i.m_XEnd=Ge(this.m_XEnd,this.m_XEnd=i.m_XEnd),i.m_YEnd=Ge(this.m_YEnd,this.m_YEnd=i.m_YEnd),i.m_attributes=Ge(this.m_attributes,this.m_attributes=i.m_attributes),this.swapImpl(i)}equals(e,i){if(this.getGeometryType()!==e.getGeometryType())return!1;const s=i===void 0;s&&(i=0);const n=e;if(this===n)return!0;if(this.m_description!==n.m_description||Math.abs(this.m_XStart-n.m_XStart)>i||Math.abs(this.m_XEnd-n.m_XEnd)>i||Math.abs(this.m_YStart-n.m_YStart)>i||Math.abs(this.m_YEnd-n.m_YEnd)>i)return!1;for(let r=0,o=2*(this.m_description.getTotalComponentCount()-2);r<o;r++)if(!QS(this.m_attributes[r],n.m_attributes[r],i))return!1;return s?this.equalsImpl(n):this.equalsImplTol(n,i)}getImpl(){return this}setAttributeBasic(e,i,s){if(this.addAttribute(e),e===0&&this.isCurve()){(i<0||i>1)&&ce("");const n=new Gi,r=i===0?s:0,o=i===1?s:0;n.setShiftCoords(r,o),i===0?n.xx=0:n.yy=0,this.applyTransformation(n)}else this.setStartAttribute(e,i,s),this.setEndAttribute(e,i,s)}replaceNaNs(e,i){if(this.addAttribute(e),this.isEmpty())return;const s=Ux.getComponentCount(e);for(let n=0;n<s;n++){const r=this.getStartAttributeAsDbl(e,n);Number.isNaN(r)&&this.setStartAttribute(e,n,i);const o=this.getEndAttributeAsDbl(e,n);Number.isNaN(o)&&this.setEndAttribute(e,n,i)}}}dA.s_maxMonotonicPartParams=8;let fOe=class extends Pd{constructor(e,i){super(),this.m_index=-1,this.gc=e,this.dim=i}next(){for(;;){if(this.m_index>=this.gc.getGeometryCount()||(this.m_index++,this.m_index===this.gc.getGeometryCount()))return null;const e=this.gc.getGeometry(this.m_index);if(this.dim===-1||1<<e.getDimension()&this.dim)return e}return null}getGeometryID(){return this.m_index}tock(){return!0}getRank(){return 1}},ype=class NG{constructor(e){this.m_geoms=[],this.m_description=go(),e&&(e.vd?this.m_description=e.vd:e.copy?e.copy.copyTo(this):ce("constructor argument not recognized"))}getGeometryCount(){return this.m_geoms.length}reserve(e){}addGeometry(e){if(e.getGeometryType()===q.enumGeometryCollection){const i=e;for(let s=0,n=i.getGeometryCount();s<n;s++)this.addGeometry(i.getGeometry(s))}else this.m_geoms.push(e.clone()),this.mergeVertexDescription(e.getDescription())}addCursor(e){for(let i=e.next();i!==null;i=e.next())this.addGeometry(i)}getGeometry(e){return(e<0||e>=this.m_geoms.length)&&ce("Geometry_collection.get_geometry"),this.m_geoms[e]}modifiedElementIndex(e){this.mergeVertexDescription(this.getGeometry(e).getDescription())}modifiedElement(e){this.mergeVertexDescription(e.getDescription())}getGeometryType(){return q.enumGeometryCollection}getDimension(){let e=0;for(const i of this.m_geoms)e=Math.max(e,i.getDimension());return e}getDescription(){return this.m_description}assignVertexDescription(e){this.m_description!==e&&this.assignVertexDescriptionImpl(e)}assignVertexDescriptionImpl(e){for(const i of this.m_geoms)i.assignVertexDescription(e);this.m_description=e}mergeVertexDescription(e){this.m_description!==e&&(this.m_description.hasAttributesFrom(e)||this.mergeVertexDescriptionImpl(e))}hasAttribute(e){return this.m_description.hasAttribute(e)}addAttribute(e){if(this.m_description.hasAttribute(e))return;const i=uA(this.m_description,e);this.assignVertexDescription(i)}dropAttribute(e){if(!this.m_description.hasAttribute(e))return;const i=cA(this.m_description,e);this.assignVertexDescription(i)}dropAllAttributes(){const e=go();e!==this.m_description&&this.assignVertexDescription(e)}queryInterval(e,i){let s=new Me;const n=new Me;n.setEmpty();for(const r of this.m_geoms)s=r.queryInterval(e,i),n.merge(s);return n}queryEnvelope(e){if(e.m_EnvelopeType===4){const i=new Fo;e.setEmpty(),e.assignVertexDescription(this.m_description);for(const s of this.m_geoms)s.queryEnvelope(i),e.merge(i)}else if(e.m_EnvelopeType===2){const i=new J;e.setEmpty();for(const s of this.m_geoms)s.queryEnvelope(i),e.mergeEnvelope2D(i)}_i("3d envelope case not implemented")}queryLooseEnvelope(e){if(e.m_EnvelopeType===2){const i=new J;e.setEmpty();for(const s of this.m_geoms)s.queryLooseEnvelope(i),e.mergeEnvelope2D(i)}_i("3d not impl")}isEmpty(){return this.m_geoms.length===0}setEmpty(){this.m_geoms.length=0}applyTransformation(e){if(e.m_TransformationType===1)for(const i of this.m_geoms)i.applyTransformation(e);_i("3d xform not impl")}transformAttribute(e,i,s,n,r){for(const o of this.m_geoms)o.transformAttribute(e,i,s,n,r)}createInstance(){return new NG({vd:this.getDescription()})}copyTo(e){e.getGeometryType()!==q.enumGeometryCollection&&ce("");const i=e;if(i!==this){i.m_geoms.length=0,i.assignVertexDescription(this.m_description);for(const s of this.m_geoms)i.m_geoms.push(s.clone())}}calculateArea2D(){const e=new Wr(0);for(const i of this.m_geoms)e.pe(i.calculateArea2D());return e.getResult()}calculateLength2D(){const e=new Wr(0);for(const i of this.m_geoms)e.pe(i.calculateLength2D());return e.getResult()}calculateLength3D(e){return z(0),0}getBoundary(){const e=this.createInstance(),i=e;for(const s of this.m_geoms){const n=s.getBoundary();n&&i.m_geoms.push(n)}return e}clone(){return new NG({copy:this})}equals(e,i){if(e===this)return!0;if(e.getGeometryType()!==q.enumGeometryCollection)return!1;const s=e;if(this.m_description!==s.m_description||this.m_geoms.length!==s.m_geoms.length)return!1;for(let n=0;n<this.m_geoms.length;++n)if(!this.m_geoms[n].equals(s.m_geoms[n],i))return!1;return!0}swap(e){e.getGeometryType()!==q.enumGeometryCollection&&ce("");const i=e;i!==this&&(this.m_geoms=Ge(i.m_geoms,i.m_geoms=this.m_geoms))}setAttributeBasic(e,i,s){for(const n of this.m_geoms)n.setAttributeBasic(e,i,s)}replaceNaNs(e,i){for(const s of this.m_geoms)s.replaceNaNs(e,i)}getImpl(){return this}mergeVertexDescriptionImpl(e){const i=this.getDescription(),s=JS(i,e);this.assignVertexDescription(s)}};function gOe(t,e=-1){return new fOe(t,e)}ype.type=q.enumGeometryCollection;let mA=class extends dA{constructor(e){super(e)}},_Oe=class extends mA{isTrue3D(){return!0}constructor(e){super(e)}};function Rl(t,e,i){z7(e,t.getStartXY(),t.getEndXY(),i)}function z7(t,e,i,s){zn(e,i,t,s)}function RD(t,e){return es(t.m_XStart,t.m_XEnd,e)}function NU(t,e){return es(t.m_YStart,t.m_YEnd,e)}function yOe(t,e){const i=t.getStartZ(),s=t.getEndZ();return es(i,s,e)}function vOe(t,e,i){const s=Et.constructPoint2D(t.getStartXY()),n=Et.constructPoint2D(t.getEndXY());i.setCoordsE(n.x.subE(s.x),n.y.subE(s.y))}function vpe(t,e,i){e.value()<=.5?tc(2,Et.constructPoint2D(t.getStartXY()),Et.constructPoint2D(t.getEndXY()),e,i):ic(2,Et.constructPoint2D(t.getStartXY()),Et.constructPoint2D(t.getEndXY()),e,i)}function yJ(t,e,i){t.m_XStart=e.x,t.m_YStart=e.y,t.m_XEnd=i.x,t.m_YEnd=i.y,t.afterCompletedModification()}function xOe(t,e){const i=t.getStartXYZ();i.z*=e;const s=t.getEndXYZ();return s.z*=e,i.norm(1)+s.norm(1)}function xpe(t){if(t.m_YEnd<t.m_YStart||t.m_YEnd===t.m_YStart&&t.m_XEnd<t.m_XStart){t.m_XEnd=Ge(t.m_XStart,t.m_XStart=t.m_XEnd),t.m_YEnd=Ge(t.m_YStart,t.m_YStart=t.m_YEnd);for(let e=0,i=t.m_description.getTotalComponentCount()-2;e<i;e++)t.m_attributes[e+i]=Ge(t.m_attributes[e],t.m_attributes[e]=t.m_attributes[e+i])}}function RG(t,e,i,s){let n=0;if((t.m_XStart===e.m_XStart&&t.m_YStart===e.m_YStart||t.m_XStart===e.m_XEnd&&t.m_YStart===e.m_YEnd)&&(n++,!s))return 1;if(t.m_XEnd===e.m_XStart&&t.m_YEnd===e.m_YStart||t.m_XEnd===e.m_XEnd&&t.m_YEnd===e.m_YEnd){if(n++,n===2)return 2;if(!s)return 1}return e.isIntersectingPoint(t.getStartXY(),i,!0)||e.isIntersectingPoint(t.getEndXY(),i,!0)||t.isIntersectingPoint(e.getStartXY(),i,!0)||t.isIntersectingPoint(e.getEndXY(),i,!0)?4:s&&n?0:wOe(t,e)?4:0}function n4(t,e,i,s,n,r,o,a){s!==null&&QO(s,2,Number.NaN),n!==null&&QO(n,2,Number.NaN),i!==null&&n3e(i,N,2);const l=bOe(t,e,2,i,s,n,r,o,a);return s&&(s.length=l),n&&(n.length=l),i&&(i.length=l),l}function bOe(t,e,i,s,n,r,o,a,l){const u=cw(t,e.getStartXY(),o,!1),c=cw(t,e.getEndXY(),o,!1),h=cw(e,t.getStartXY(),o,!1),d=cw(e,t.getEndXY(),o,!1);let m=0,f=0;if(!Number.isNaN(u)){let v=!1;a&&Vs(u,0,1)&&t.getCoord2D(u).isEqualPoint2D(e.getStartXY())&&(m++,v=!0),v||(n&&(n[f]=u),r&&(r[f]=0),s&&s[f].setCoords(e.m_XStart,e.m_YStart),f++)}if(!Number.isNaN(c)){let v=!1;a&&Vs(c,0,1)&&t.getCoord2D(c).isEqualPoint2D(e.getEndXY())&&(m++,v=!0),v||(i>f&&(n&&(n[f]=c),r&&(r[f]=1),s&&s[f].setCoords(e.m_XEnd,e.m_YEnd)),f++)}if(f!==2&&!Number.isNaN(h)&&!(u===0&&h===0||c===0&&h===1)){let v=!1;a&&Vs(h,0,1)&&e.getCoord2D(h).isEqualPoint2D(t.getStartXY())&&(m++,v=!0),v||(i>f&&(n&&(n[f]=0),r&&(r[f]=h),s&&s[f].setCoords(t.m_XStart,t.m_YStart)),f++)}if(f!==2&&!Number.isNaN(d)&&!(u===1&&d===0||c===1&&d===1)){let v=!1;a&&Vs(d,0,1)&&e.getCoord2D(d).isEqualPoint2D(t.getEndXY())&&(m++,v=!0),v||(i>f&&(n&&(n[f]=1),r&&(r[f]=d),s&&s[f].setCoords(e.m_XEnd,e.m_YEnd)),f++)}if(f>0)return l&&(r=Ge(n,n=r)),f===2&&i>=2&&n&&n[0]>n[1]&&(n[1]=Ge(n[0],n[0]=n[1]),r&&(r[1]=Ge(r[0],r[0]=r[1])),s&&(s[1]=Ge(s[0],s[0]=s[1]))),f;if(m>0)return 0;const _=SOe(t,e,o);return Number.isNaN(_.x)?0:(s&&(s[0]=t.getCoord2D(_.x)),n&&(n[0]=_.x),r&&(r[0]=_.y),1)}function wOe(t,e){const i=OD(t,e.m_XStart,e.m_YStart),s=OD(t,e.m_XEnd,e.m_YEnd);if(i<0&&s<0||i>0&&s>0)return!1;const n=OD(e,t.m_XStart,t.m_YStart),r=OD(e,t.m_XEnd,t.m_YEnd);return n<0&&r<0||n>0&&r>0?!1:OG(t)>OG(e)?xJ(t,e):xJ(e,t)}function cw(t,e,i,s){const n=N.getNAN(),r=N.getNAN();let o=!1;t.m_YEnd<t.m_YStart||t.m_YEnd===t.m_YStart&&t.m_XEnd<t.m_XStart?(n.setCoords(t.m_XEnd,t.m_YEnd),r.setCoords(t.m_XStart,t.m_YStart),o=!0):(n.setCoords(t.m_XStart,t.m_YStart),r.setCoords(t.m_XEnd,t.m_YEnd));const a=o?1:0,l=o?0:1,u=N.getNAN();u.setSub(e,n);let c=u.length(),h=3*c*cn();if(c<=Math.max(i,h))return s&&c===0?Number.NaN:a;if(u.setSub(e,r),c=u.length(),h=3*c*cn(),c<=Math.max(i,h))return s&&c===0?Number.NaN:l;u.setCoords(r.x-n.x,r.y-n.y);const d=u.length();if(d>0){const m=1/d;u.scale(m);const f=N.getNAN();f.setSub(e,n);const _=f.dotProduct(u),v=8*f.dotProductAbs(u)*cn();u.leftPerpendicularThis();const x=f.dotProduct(u),w=8*f.dotProductAbs(u)*cn(),T=Math.max(i,v);if(_<-T||_>d+T)return Number.NaN;const C=Math.max(i,w);if(Math.abs(x)<=C){let M=_*m;M=Os(M,0,1);const A=N.getNAN();if(z7(M,n,r,A),N.distance(A,e)<=i){if(M<.5){if(N.distance(A,n)<=i&&N.distance(e,n)<=i)return a}else if(N.distance(A,r)<=i&&N.distance(e,r)<=i)return l;return o?1-M:M}}}return Number.NaN}function OD(t,e,i){const s=N.getNAN();s.setCoords(e,i),s.subThis(t.getStartXY());const n=N.getNAN();n.setSub(t.getEndXY(),t.getStartXY());const r=n.crossProduct(s),o=4*cn()*(Math.abs(n.x*s.y)+Math.abs(n.y*s.x));return r>o?-1:r<-o?1:0}function vJ(t,e,i,s){const n=s?t.m_XStart:t.m_XEnd,r=s?t.m_YStart:t.m_YEnd,o=N.getNAN();return o.x=e.getEndX()-n,o.y=e.getEndY()-r,i.dotProduct(o)>3*cn()*i.dotProductAbs(o)?(o.x=e.getStartX()-n,o.y=e.getStartY()-r,i.dotProduct(o)<=3*cn()*i.dotProductAbs(o)):!0}function xJ(t,e){const i=N.getNAN();return i.x=t.m_XEnd-t.m_XStart,i.y=t.m_YEnd-t.m_YStart,!!vJ(t,e,i,!1)&&(i.negateThis(),!!vJ(t,e,i,!0))}function OG(t){const e=t.m_XStart-t.m_XEnd,i=t.m_YStart-t.m_YEnd;return e*e+i*i}function SOe(t,e,i){const s=t.m_XEnd-t.m_XStart,n=t.m_YEnd-t.m_YStart,r=e.m_XEnd-e.m_XStart,o=e.m_YEnd-e.m_YStart,a=r*n-s*o;if(a===0)return N.getNAN();const l=4*cn()*(Math.abs(r*n)+Math.abs(s*o)),u=e.m_XStart-t.m_XStart,c=e.m_YStart-t.m_YStart,h=r*c-u*o,d=4*cn()*(Math.abs(r*c)+Math.abs(u*o)),m=h/a,f=Math.abs(a),_=(d*f+l*Math.abs(h))/(a*a)+cn()*Math.abs(m);if(m<-_||m>1+_)return N.getNAN();const v=s*c-u*n,x=v/a,w=(4*cn()*(Math.abs(s*c)+Math.abs(u*n))*f+l*Math.abs(v))/(a*a)+cn()*Math.abs(x);if(x<-w||x>1+w)return N.getNAN();let T=Os(m,0,1),C=Os(x,0,1);const M=N.getNAN();Rl(t,T,M);const A=N.getNAN();if(Rl(e,C,A),!i||N.distance(M,A)>i){const I=N.getNAN();zn(M,A,.5,I),T=t.getClosestCoordinate(I,!1),C=e.getClosestCoordinate(I,!1);const L=N.getNAN();Rl(t,T,L);const D=N.getNAN();Rl(e,C,D),L.subThis(D);const O=L.length(),U=(t.absNorm()+e.absNorm())*_1();if(O>Math.max(i,U))return N.getNAN()}return new N(T,C)}let RU=class{constructor(e){if(this.m_segFlagStream=null,this.m_xyStream=null,this.m_bCirculator=!1,this.m_currentSegmentIndex=-1,this.m_nextSegmentIndex=0,this.m_nextPathIndex=0,this.m_currentPathIndex=-1,this.m_parent=e.parent,this.m_buffer=new this.m_parent.m_segmentBufferCTor,this.m_description=e.parent.getDescription(),this.m_segmentCount=this.getSegmentCount(this.m_nextPathIndex),e.pointIndex!==void 0){(e.pointIndex<0||e.pointIndex>=e.parent.getPointCount())&&bi("");const i=e.parent.getPathIndexFromPointIndex(e.pointIndex);this.m_currentPathIndex=i,this.m_nextPathIndex=i+1,this.m_nextSegmentIndex=e.pointIndex-e.parent.getPathStart(i),this.m_segmentCount=this.getSegmentCount(this.m_currentPathIndex)}else if(e.pathIndex!==void 0){(e.pathIndex<0||e.pathIndex>=e.parent.getPathCount()||e.segmentIndex<0)&&bi("");const i=e.parent.isClosedPath(e.pathIndex)?0:1;e.segmentIndex>=e.parent.getPathSize(e.pathIndex)-i&&bi(""),this.m_nextSegmentIndex=e.segmentIndex,this.m_currentPathIndex=e.pathIndex,this.m_nextPathIndex=this.m_nextSegmentIndex+1,this.m_segmentCount=this.getSegmentCount(this.m_nextPathIndex)}this.prepare(),this.m_pathBegin=-1,this.m_bCurrentPathClosed=!1,this.m_bStripAttributes=!1,this.m_prevPathIndex=-1,this.m_prevSegmentIndex=-1,this.m_bNeedsUpdate=!1,this.m_currentPathIndex>-1&&(this.m_pathBegin=this.m_parent.getPathStart(this.m_currentPathIndex),this.m_bCurrentPathClosed=this.m_parent.isClosedPath(this.m_currentPathIndex))}stripAttributes(){this.m_bStripAttributes=!0}prepare(){this.m_bCirculator=!1,this.m_parent.isEmptyImpl()?(this.m_segFlagStream=null,this.m_xyStream=null):(this.m_segFlagStream=this.m_parent.getSegmentFlagsStreamRef(),this.m_xyStream=this.m_parent.getAttributeStreamRef(0))}nextPath(){return this.m_currentPathIndex=this.m_nextPathIndex,!(this.m_currentPathIndex>=this.m_parent.getPathCount())&&(this.m_currentSegmentIndex=-1,this.m_nextSegmentIndex=0,this.m_segmentCount=this.getSegmentCount(this.m_currentPathIndex),this.m_pathBegin=this.m_parent.getPathStart(this.m_currentPathIndex),this.m_bCurrentPathClosed=this.m_parent.isClosedPath(this.m_currentPathIndex),this.m_nextPathIndex++,!0)}previousPath(){return this.m_nextPathIndex!==0&&(this.m_nextPathIndex--,this.m_currentSegmentIndex=-1,this.m_nextSegmentIndex=0,this.m_segmentCount=this.getSegmentCount(this.m_nextPathIndex),this.m_currentPathIndex=this.m_nextPathIndex,this.m_pathBegin=this.m_parent.getPathStart(this.m_currentPathIndex),this.m_bCurrentPathClosed=this.m_parent.isClosedPath(this.m_currentPathIndex),this.resetToLastSegment(),!0)}getSegmentCount(e){return this.m_parent.isEmptyImpl()?0:this.m_parent.getSegmentCountPath(e)}resetToFirstPath(){this.m_currentSegmentIndex=-1,this.m_nextSegmentIndex=-1,this.m_segmentCount=-1,this.m_nextPathIndex=0,this.m_currentPathIndex=-1,this.m_pathBegin=-1,this.m_bCurrentPathClosed=!1}resetToLastPath(){this.m_nextPathIndex=this.m_parent.getPathCount(),this.m_currentPathIndex=-1,this.m_currentSegmentIndex=-1,this.m_nextSegmentIndex=-1,this.m_segmentCount=-1,this.m_pathBegin=-1}resetToPath(e){(e<0||e>this.m_parent.getPathCount())&&bi(""),this.m_nextPathIndex=e,this.m_currentPathIndex=-1,this.m_currentSegmentIndex=-1,this.m_nextSegmentIndex=-1,this.m_segmentCount=-1,this.m_pathBegin=-1,this.m_bCurrentPathClosed=!1}isLastPath(){return this.m_currentPathIndex===this.m_parent.getPathCount()-1}isFirstSegmentInPath(){return this.m_currentSegmentIndex===0}isLastSegmentInPath(){return this.m_currentSegmentIndex===this.m_segmentCount-1}resetToFirstSegment(){this.m_currentSegmentIndex=-1,this.m_nextSegmentIndex=0}resetToLastSegment(){this.m_nextSegmentIndex=this.m_segmentCount,this.m_currentSegmentIndex=-1}resetTo(e){this.m_parent!==e.m_parent&&un(""),this.m_currentSegmentIndex=e.m_currentSegmentIndex,this.m_nextSegmentIndex=e.m_nextSegmentIndex,this.m_currentPathIndex=e.m_currentPathIndex,this.m_nextPathIndex=e.m_nextPathIndex,this.m_segmentCount=e.m_segmentCount,this.m_bCirculator=e.m_bCirculator,this.m_pathBegin=e.m_pathBegin,this.m_bCurrentPathClosed=e.m_bCurrentPathClosed,this.m_bStripAttributes=e.m_bStripAttributes,this.m_description=e.m_description}resetToVertex(e,i){if(this.m_currentPathIndex>=0&&this.m_currentPathIndex<this.m_parent.getPathCount()){const n=this.getPathBegin();if(e>=n&&e<this.m_parent.getPathEnd(this.m_currentPathIndex))return this.m_currentSegmentIndex=-1,void(this.m_nextSegmentIndex=e-n)}let s;s=i>=0&&i<this.m_parent.getPathCount()&&e>=this.m_parent.getPathStart(i)&&e<this.m_parent.getPathEnd(i)?i:this.m_parent.getPathIndexFromPointIndex(e),this.m_nextPathIndex=s+1,this.m_currentPathIndex=s,this.m_currentSegmentIndex=-1,this.m_nextSegmentIndex=e-this.m_parent.getPathStart(s),this.m_segmentCount=this.getSegmentCount(s),this.m_pathBegin=this.m_parent.getPathStart(this.m_currentPathIndex),this.m_bCurrentPathClosed=this.m_parent.isClosedPath(this.m_currentPathIndex)}hasNextSegment(){return this.m_nextSegmentIndex<this.m_segmentCount}hasPreviousSegment(){return this.m_nextSegmentIndex>0}nextSegment(){return this.m_currentSegmentIndex!==this.m_nextSegmentIndex&&this.updateSegment(),this.m_bCirculator?this.m_nextSegmentIndex=(this.m_nextSegmentIndex+1)%this.m_segmentCount:(this.m_nextSegmentIndex===this.m_segmentCount&&bi("Segment_iterator_impl::next_segment"),this.m_nextSegmentIndex++),this.m_buffer.get()}previousSegment(){return this.m_bCirculator?this.m_nextSegmentIndex=(this.m_segmentCount+this.m_nextSegmentIndex-1)%this.m_segmentCount:(this.m_nextSegmentIndex===0&&bi(""),this.m_nextSegmentIndex--),this.m_nextSegmentIndex!==this.m_currentSegmentIndex&&this.updateSegment(),this.m_buffer.get()}nextCurve(){if(!this.m_parent.hasNonLinearSegments())return this.resetToLastSegment(),null;let e=0;for(;;){if(this.m_nextSegmentIndex===this.m_segmentCount||e===this.m_segmentCount)return null;const i=this.getPathBegin()+this.m_nextSegmentIndex;if((31&this.m_segFlagStream.read(i))!==1){this.updateSegment();break}this.m_bCirculator?this.m_nextSegmentIndex=(this.m_nextSegmentIndex+1)%this.m_segmentCount:this.m_nextSegmentIndex++,e++}return this.m_currentSegmentIndex!==this.m_nextSegmentIndex&&this.updateSegment(),this.m_bCirculator?this.m_nextSegmentIndex=(this.m_nextSegmentIndex+1)%this.m_segmentCount:(this.m_nextSegmentIndex===this.m_segmentCount&&bi(""),this.m_nextSegmentIndex++),this.m_buffer.get()}getPathBegin(){return this.m_pathBegin}getPathIndex(){return this.m_currentPathIndex}getStartPointIndex(){return this.getPathBegin()+this.m_currentSegmentIndex}getEndPointIndex(){return this.isClosingSegment()?this.getPathBegin():this.getStartPointIndex()+1}updateSegment(){(this.m_nextSegmentIndex<0||this.m_nextSegmentIndex>=this.m_segmentCount||this.m_currentPathIndex<0)&&bi(""),this.m_currentSegmentIndex=this.m_nextSegmentIndex,this.m_parent.getSegmentFromPath(this.m_currentPathIndex,this.m_currentSegmentIndex,this.m_buffer,this.m_bStripAttributes)}isClosingSegment(){return this.m_bCurrentPathClosed&&this.m_currentSegmentIndex===this.m_segmentCount-1}isCurve(){return this.m_segFlagStream!==null?(31&this.m_segFlagStream.read(this.m_currentSegmentIndex))!==1:!1}isPathClosed(){return this.m_bCurrentPathClosed}setCirculator(e){this.m_bCirculator=e}getImpl(){return this}},bJ=class bpe{constructor(e){this.m_rasterizedGeometry=null,this.m_quadTree=null,this.m_quadTreeForPaths=null,this.m_refCount=1,e&&e.copyTo(this)}getRasterizedGeometry(){return this.m_rasterizedGeometry}copyTo(e){e!==this&&(z(e.uniqueUse()),e.m_quadTree=this.m_quadTree,e.m_quadTreeForPaths=this.m_quadTreeForPaths,e.m_rasterizedGeometry=this.m_rasterizedGeometry)}clone(){const e=new bpe;return this.copyTo(e),e}uniqueUse(){return this.m_refCount===1}addRef(){++this.m_refCount}release(){--this.m_refCount==0&&(this.m_rasterizedGeometry=null,this.m_quadTree=null,this.m_quadTreeForPaths=null)}setRasterizedGeometry(e){z(this.uniqueUse())}setQuadTree(e){z(this.uniqueUse()),this.m_quadTree=e}setQuadTreeForPaths(e){z(this.uniqueUse()),this.m_quadTreeForPaths=e}getQuadTree(){return this.m_quadTree}getQuadTreeForPaths(){return this.m_quadTreeForPaths}};function nL(t){return!(t.isEmpty()||t.getGeometryType()!==q.enumPolyline&&t.getGeometryType()!==q.enumPolygon)&&!(t.getPointCount()<20)}function wpe(t){return!(t.isEmpty()||t.getGeometryType()!==q.enumPolyline&&t.getGeometryType()!==q.enumPolygon)&&!(t.getPointCount()<20)}function EOe(t,e){return t.readPoint2D(e+4)}function OU(t){const e=t.getGeometryType();return e===q.enumEllipticArc?10:e===q.enumBezier?4:e===q.enumRationalBezier2?5:e===q.enumBezier2?2:void We("")}function qu(t){const e=31&t;return e===4?10:e===2?4:e===8?5:e===16?2:0}function zy(t,e,i,s){const n=4*cn()*(Math.abs(e.vmin)+Math.abs(e.vmax)),r=cn();if(t.getMaxDerivative()===1){z(i>0);const c=SJ(t,0,e,cn(),n);return s[0]=c.root,c.cRoots}let o,a=[];const l=new Me(e.vmin-n,e.vmax+n);a.push(new N(l.vmin,l.vmax));let u=0;for(let c=t.getMaxDerivative()-1;c>=0;c--){o=a,a=[];for(let h=0,d=o.length;h<d;h++){if(o[h][0]<o[h][1]){let m,f,_;if(c===t.getMaxDerivative()-1?{root:m,funcAtRoot:f,cRoots:_}=SJ(t,c,Me.construct(o[h][0],o[h][1]),r,.5*n):{root:m,funcAtRoot:f,cRoots:_}=MOe(t,c,Me.construct(o[h][0],o[h][1]),r,.5*n),_===1){if(c===0)u<i&&(o[h][0]<=e.vmin&&o[h][1]>=e.vmin&&m!==e.vmin&&t.getValue(0,e.vmin)===0&&(m=e.vmin),o[h][0]<=e.vmax&&o[h][1]>=e.vmax&&m!==e.vmax&&t.getValue(0,e.vmax)===0&&(m=e.vmax),s[u]=e.snapClip(m),u>0?s[u]-s[u-1]>n&&u++:u++);else{const v=N.getNAN();v[0]=o[h][0],v[1]=m,a.push(v);const x=N.getNAN();x[0]=m,x[1]=o[h][1],a.push(x)}continue}}a.push(o[h])}}return u}function COe(t,e,i,s){const n=new ge,r=UP(new ge(t),new ge(e),i,n);return s[0]=n.value(),r}function y1(t,e,i,s,n,r){const o=he(ge,2),a=Ul(new ge(t),new ge(e),new ge(i),s,n,o);return r[0]=o[0].value(),r[1]=o[1].value(),a}function Spe(t,e,i,s,n,r,o){const a=he(ge,3),l=rL(new ge(t),new ge(e),new ge(i),new ge(s),n,r,a);return o[0]=a[0].value(),o[1]=a[1].value(),o[2]=a[2].value(),l}function wJ(t,e,i,s,n,r,o,a){return POe(t,e,i,s,n,r,o,a)}function TOe(t,e,i,s,n,r){return AOe(t,e,i,s,n,r)}function POe(t,e,i,s,n,r,o,a){const l=st(i*i,Number.NaN);l.fill(0),Qs(a,s,0,0,i);const u=st(i,Number.NaN),c=st(i,Number.NaN),h=st(i,Number.NaN);let d=t(a,i,e);const m=100;let f=0;for(f=0;f<m;f++){const _=d;for(let T=0;T<i;++T)c[T]=a[T];if(f%i==0){l.fill(0);for(let T=0;T<i;T++)l[T*i+T]=1}let v=0,x=0;for(let T=0;T<i;++T){for(let A=0;A<i;++A)u[A]=l[T*i+A];const C=d;d=EJ(t,e,a,u,n,r,i);const M=C-d;M>v&&(x=T,v=M)}for(let T=0;T<i;T++)u[T]=a[T]-c[T],h[T]=a[T]+(a[T]-c[T]);const w=t(h,i,e);if(w<_&&2*(_-2*d+w)*Di(_-d-v)<Di(_-w)*v){d=EJ(t,e,a,u,n,r,i);for(let T=0;T<i;++T)l[x*i+T]=l[(i-1)*i+T],l[(i-1)*i+T]=u[T]}if(_<=d)return t(a,i,e)}return d}function SJ(t,e,i,s,n){const r={root:0,funcAtRoot:0,cRoots:0};let o=i.vmin,a=i.vmax,l=0,u=Number.MAX_VALUE,c=t.getValue(e,o),h=t.getValue(e,a),d=0,m=0,f=0;if(c>=0&&h>=0||c<=0&&h<=0)return Math.abs(c)<Math.abs(h)?(r.funcAtRoot=c,r.root=o,r.cRoots=c===0?1:0,r):(r.funcAtRoot=h,r.root=a,r.cRoots=h===0?1:0,r);Math.abs(c)<Math.abs(h)&&(a=Ge(o,o=a),h=Ge(c,c=h)),l=o,d=c;let _=!0,v=0;for(;h!==0&&Math.abs(o-a)>s*Math.abs(a)+n;v++){let x=v>64;if(!x){m=c!==d&&h!==d?o*h*d/((c-h)*(c-d))+a*c*d/((h-c)*(h-d))+l*c*h/((d-c)*(d-h)):a-h*(a-o)/(h-c);const w=(3*o+a)/4;if(x=!(m>w&&m<a||m>a&&m<w),!x){const T=s*Math.abs(a)+n;if(_){const C=Math.abs(a-l);x=Math.abs(m-a)>=.5*C||C<T}else{const C=Math.abs(l-u);x=Math.abs(m-a)>=.5*C||C<T}}}if(x?(m=(o+a)/2,_=!0):_=!1,f=t.getValue(e,m),f===0)return r.root=m,r.funcAtRoot=f,r.cRoots=1,r;if(!x){const w=o-m,T=m-a;if(Math.abs(w)>10*Math.abs(T)){let C=a+3*T;for(let M=0;M<2;M++){const A=t.getValue(e,C);In(c)*In(A)>0?(o=C,c=A):C=es(o,a,.75)}}else if(Math.abs(T)>10*Math.abs(w)){let C=o-3*w;for(let M=0;M<2;++M){const A=t.getValue(e,C);In(h)*In(A)>0?(a=C,h=A):C=es(o,a,.25)}}}u=l,l=a,d=h,In(c)*In(f)<0?(a=m,h=f):(o=m,c=f),Math.abs(c)<Math.abs(h)&&(a=Ge(o,o=a),h=Ge(c,c=h)),v===128&&We("Root_finder iterations exceeded")}return r.root=a,r.funcAtRoot=h,r.cRoots=1,r}function MOe(t,e,i,s,n){const r={root:0,funcAtRoot:0,cRoots:0};let o=i.vmin,a=t.getValue(e,o),l=i.vmax,u=t.getValue(e,l);if(a>=0&&u>=0||a<=0&&u<=0)return Math.abs(a)<Math.abs(u)?(r.funcAtRoot=a,r.root=o,r.cRoots=a===0?1:0,r):(r.funcAtRoot=u,r.root=l,r.cRoots=u===0?1:0,r);u<0&&(u=Ge(a,a=u),l=Ge(o,o=l));let c=.5*(o+l),h=Math.abs(l-o),d=h,m=t.getValue(e,c),f=t.getValue(e+1,c);const _=1,v=4;let x=v;const w=2;let T=1,C=0,M=0,A=_;const I=32;let L=0;for(;++L<100;){let D;L>I||f===0||A===w&&C>1||A===_&&x<v?(A=_,T>1&&T--):(A=w,M>1&&Math.abs(2*m)>Math.abs(h*f)&&T++),h=d;let O=!1;if(A===_)do{if(M>2){const B=16*Math.abs(h);if(.5*Math.abs(o-l)>B){const V=Math.min(o,l),H=Math.max(o,l);if(c===V){D=c,c=V+B,d=c-D;break}if(c===H){D=c,c=H-B,d=c-D;break}}}d=.5*(l-o),D=c,c=o+d,O=o===c||l===c}while(!1);else for(;;){d=T*m/f,D=c,c-=d,O=c===D;const B=Math.min(o,l),V=Math.max(o,l);if(c<B){if(T>1){c=D,T--;continue}d=D-B,c=B}else if(c>V){if(T>1){c=D,T--;continue}d=D-V,c=V}break}if(O||Math.abs(d)<n){D!==c&&(m=t.getValue(e,c));break}m=t.getValue(e,c),f=t.getValue(e+1,c);const U=o,$=l;m<0?(a=m,o=c):(u=m,l=c),A===w&&(o===U&&l===$||M>1&&Math.abs(d)>=.5001*Math.abs(h))?C++:C=0,A===_?(x++,M=0):(x=0,M++)}return L===100&&We("Root_finder iterations exceeded"),r.root=c,r.funcAtRoot=m,r.cRoots=1,r}function EJ(t,e,i,s,n,r,o){const a=s.slice(0,o);let l=0;for(let x=0;x<o;x++)l+=s[x]*s[x];if(l=Math.sqrt(l),l>0)for(let x=0;x<o;x++)a[x]/=l;let u=Number.NEGATIVE_INFINITY,c=Number.POSITIVE_INFINITY;{const x=st(o,0);for(let w=0;w<o;w++)x[w]=w;x.sort((w,T)=>{const C=Math.abs(a[w]),M=Math.abs(a[T]);return C<M?-1:C>M?1:0});for(let w=0;w<o;w++){const T=x[w];if(a[T]===0)continue;let C=(n[T]-i[T])/a[T],M=(r[T]-i[T])/a[T];M<C&&(M=Ge(C,C=M)),C>u&&(u=C),M<c&&(c=M)}}let h=0;const d=(Math.abs(u)+Math.abs(c))*cn()*100,m=st(o,Number.NaN),f=a.slice();function _(x,w){for(let T=0,C=o;T<C;T++)m[T]=i[T]+x*f[T];return t(m,o,e)}d>0&&(h=TOe(_,null,u,0,c,d));const v=_(h);for(let x=0,w=o;x<w;x++)i[x]=Os(m[x],n[x],r[x]);return v}function AOe(t,e,i,s,n,r){const o=_G();let a=s,l=t(a,e),u=i,c=n,h=t(u,e),d=t(c,e);l>h&&(l=h,a=u),l>d&&(l=d,a=c);let m=u,f=c,_=h,v=d;_>v&&(_=Ge(v,v=_),f=Ge(m,m=f));let x=a-m,w=m-f;const T=.5*Math.min(r,c-u),C=2*T,M=100;let A,I=0;for(A=0;A<M&&!(c-u<=C);++A){const L=u+.5*(c-u);let D=I>0;if(!D&&Math.abs(w)<=T&&(D=!0,I=3),!D){const $=a-m,B=a-f,V=$*(l-v);let H=B*(l-_),Y=B*H-$*V;H=2*(H-V),H>0&&(Y=-Y),H=Math.abs(H),H===0||Math.abs(Y)>=Math.abs(H*w/2)||Y<=H*(u-a)||Y>=H*(c-a)?(D=!0,I=3):(w=x,x=Y/H)}D&&(w=a>=L?u-a:c-a,x=o*w,I--);let O=a+x;O<u+T?O=u+T:O>c-T&&(O=c-T);const U=t(O,e);U<l?(O>=a?(u=a,h=l):(c=a,d=l),f=m,m=a,a=O,v=_,_=l,l=U):(O<a?(u=O,h=U):(c=O,d=U),U<=_||m===a?(f=m,m=O,v=_,_=U):(U<=v||f===a||f===m)&&(f=O,v=U))}return a}function UP(t,e,i,s){return t.isZero()?e.isZero()?-1:0:(s.setE(e.clone().negateThis().divThisE(t)),i.containsCoordinate(s.value())?1:0)}function Ul(t,e,i,s,n,r){if(t.value()===0)return n?(r[0].set(1),s.containsCoordinate(r[0].value())?1:0):UP(e,i,s,r[0]);if(n){let m=2;return r[0].set(1),r[1].setE(i).divThisE(t),r[1].eq(r[0])&&(r[1].set(1),m=1),s.containsCoordinate(r[1].value())||(m=1),s.containsCoordinate(r[0].value())||(m--,r[0].setE(r[1])),m===2&&r[0].value()>r[1].value()&&(r[1]=Ge(r[0],r[0]=r[1])),m}const o=e.clone().sqrThis().subThisE(t.clone().mulThisE(i).mulThisE(jRe));if(o.lt(ZS))return 0;const a=new ge(e.value()>=0?1:-1),l=o.clone().sqrtThis(),u=new ge(-.5).mulThisE(e.clone().addThisE(a.clone().mulThisE(l)));let c=0;r[0].setE(u.divE(t));const h=new ge(r[0].value()),d=new ge(t.value()).mulE(h).addE(new ge(e.value()).mulE(h).addE(new ge(i.value())));return d.isZero()||CJ(r[0],t,e,i,r[0]),s.containsCoordinate(r[0].value())&&c++,l.value()!==0&&u.value()!==0&&(r[c].assign(i.divE(u)),h.set(r[c].value()),d.assign(new ge(t.value()).mulE(h).addE(new ge(e.value()).mulE(h).addE(new ge(i.value())))),d.isZero()||CJ(r[c],t,e,i,r[c]),s.containsCoordinate(r[c].value())&&c++,c===2&&r[0].value()>r[1].value()&&(r[1]=Ge(r[0],r[0]=r[1]))),c}function rL(t,e,i,s,n,r,o){if(t.value()===0)return Ul(e,i,s,n,r,o);if(r){let a=1;o[0].set(1);const l=o.slice(a),u=Ul(t,e.addE(t),s.negate(),n,!1,l);if(u>0){a+=u;for(let h=1;h<a;h++)o[h].eq(Ff)&&(o[a-1]=Ge(o[h],o[h]=o[a-1]),a--)}const c=o.slice(0,a);c.sort((h,d)=>h.value()<d.value()?-1:h.value()>d.value()?1:0);for(let h=0;h<a;++h)o[h]=c[h];return a}return ROe(t,e,i,s,n,o)}function Epe(t,e,i,s,n,r){return(r<e||e<0)&&ce("nth_degree_real_roots"),OOe(t,e,i,s,n)}function LG(t,e,i,s){return{coef0:t.clone(),coef1:e.clone(),coef2:i.clone(),coef3:s.clone(),calcF(n){return this.coef0.clone().mulThis(n).addThisE(this.coef1).mulThis(n).addThisE(this.coef2).mulThis(n).addThisE(this.coef3)},calcDF(n){return this.coef0.clone().mulThis(3).mulThis(n).addThisE(this.coef1.clone().mulThisByPower2(2)).mulThis(n).addThisE(this.coef2)},estimateError(n){const r=Math.abs(n),o=((this.coef0.eps()*r+this.coef1.eps())*r+this.coef2.eps())*r+this.coef3.eps()+this.calcF(n).eps(),a=this.coef0.clone().mulThis(n).mulThis(3).addThisE(this.coef1.clone().mulThis(2)).mulThis(n).addThisE(this.coef2);if(a.isZero()){const l=this.coef0.clone().mulThis(n).mulThis(6).addThisE(this.coef1.clone().mulThis(2));if(l.isZero()){const u=this.coef0.clone().mulThis(6);return Math.pow(6*o/Math.abs(u.value()),1/3)}return Math.sqrt(2*o/Math.abs(l.value()))}return o/Math.abs(a.value())}}}let IOe=class{updateCoefs(e){if(this.lastDeriv1===e)return this.curCoefs=this.derivCoefs1,void(this.lastUsed=1);if(this.lastDeriv2===e)return this.curCoefs=this.derivCoefs2,void(this.lastUsed=2);let i;this.lastUsed===1?(i=this.derivCoefs2,this.lastDeriv2=e,this.lastUsed=2):(i=this.derivCoefs1,this.lastDeriv1=e,this.lastUsed=1),i.length=0;for(let s=0,n=this.truePower-e;s<=n;++s){i.push(this.coefs[s+e].clone());let r=s+e,o=r--;for(let a=1;a<e;a++)o*=r--;i[s].mulThis(o)}this.curCoefs=i}constructor(e,i,s,n){this.derivCoefs1=[],this.derivCoefs2=[],this.lastDeriv1=-1,this.lastDeriv2=-1,this.lastUsed=-1,this.curCoefs=null,this.coefs=e,this.power=i,this.truePower=0;for(let r=i;r>=1;r--)if(this.coefs[r].value()!==0){this.truePower=r;break}}getMaxDerivative(){return this.truePower+1}getValue(e,i){let s=this.coefs;e===0?s=this.coefs:(this.updateCoefs(e),s=this.curCoefs);const n=new Wr(0);let r=1;for(let o=0,a=this.truePower-e;o<=a;++o)n.pe(r*s[o].value()),r*=i;return n.getResult()}getError(e){const i=Math.abs(e),s=new Wr(0),n=new ge(1),r=new ge(0);for(let a=0,l=this.power;a<=l;++a)r.addThisE(this.coefs[a].mulE(n)),s.pe(n.value()*this.coefs[a].eps()),n.mulThis(i);s.pe(r.eps());let o=1;for(let a=1;a<=this.truePower;++a){o*=a,this.updateCoefs(a);const l=new ge(1),u=new ge(0);for(let c=0,h=this.truePower-a;c<=h;++c)u.addThisE(this.curCoefs[c].mulE(l)),l.mulThis(e);if(!u.isZero())return Math.pow(o*s.getResult()/Math.abs(u.value()),1/a)}return 0}};function Cpe(t,e,i,s,n,r){let o=t,a=e,l=a-o;if(!r){let m=s.calcF(t).value(),f=s.calcF(e).value();if((m>0||m>f)&&(a=Ge(o,o=a),f=Ge(m,m=f)),m>=0||f<=0)return!1}let u,c=!1,h=i,d=0;for(;d<100;d++){const m=s.calcF(h);if(u=s.calcDF(h),u.isZero())return!1;if(!m.value()||d>3&&m.isZero()){c=!0;break}r||(m.value()<0?o=h:a=h);const f=m.value()/u.value(),_=h-f;r||(_>=o&&_<=a||_>=a&&_<=o)&&Math.abs(f)<=.5*l?(h=_,l=Math.abs(f)):(l=Math.abs(.5*(a-o)),h=.5*(o+a))}return!!c&&(n.set(h,s.estimateError(h)),!0)}function DOe(t,e,i,s,n,r,o,a){return Cpe(t,e,i.value(),LG(s,n,r,o),a,!1)}let NOe=class{constructor(e,i,s){this.coefs=he(ge,3),this.coefs[0].setE(e),this.coefs[1].setE(i),this.coefs[2].setE(s)}calcF(e){const i=new ge(e);return this.coefs[0].mulE(i).addE(this.coefs[1]).mulE(i).addE(this.coefs[2])}calcDF(e){const i=new ge(e);return ge.st_mulByPower2(this.coefs[0],2).mulE(i).addE(this.coefs[1])}estimateError(e){const i=Math.abs(e),s=(this.coefs[0].eps()*i+this.coefs[1].eps())*i+this.coefs[2].eps()+this.calcF(e).eps(),n=new ge(2).mulE(this.coefs[0]).mul(e).addE(this.coefs[1]);if(n.isZero()){const r=this.coefs[0].value();return Math.sqrt(s/Math.abs(r))}return s/Math.abs(n.value())}};function CJ(t,e,i,s,n){return Cpe(0,0,t.value(),new NOe(e,i,s),n,!0)}function ROe(t,e,i,s,n,r){const o=he(ge,3);let a=0;const l=e.negate().divThisE(t.clone().mulThis(3));n.containsCoordinate(l.value())&&(o[0].setE(l),a=1);const u=he(ge,2),c=Ul(t.mul(3),e.mul(2),i,n,!1,u);if(c<0)return s.isZero()?-1:0;for(let _=0;_<c;_++)n.containsCoordinate(u[_].value())&&o[a++].setE(u[_]);wd(o,0,a,(_,v)=>_.value()<v.value()?-1:_.value()>v.value()?1:0);const h=he(ge,5);h[0].set(n.vmin);for(let _=0;_<a;_++)h[1+_].setE(o[_]);h[1+a].set(n.vmax);const d=a+2;let m=1,f=0;{const _=h[0].clone();if(t.clone().mulThisE(_).addThisE(e).mulThisE(_).addThisE(i).mulThisE(_).addThisE(s).isZero()){const v=LG(t,e,i,s);_.setError(v.estimateError(_.value())),r[f]=_,f++,m++}}for(let _=m;_<d;_++){const v=h[_].clone(),x=t.clone().mulThisE(v).addThisE(e).mulThisE(v).addThisE(i).mulThisE(v).addThisE(s).isZero();if(x||!h[_].eq(h[_-1])){if(x||DOe(h[_-1].value(),h[_].value(),h[_-1].clone().addThisE(h[_]).divThisByPower2(2),t,e,i,s,v)){if(f>0&&v.eq(r[f-1]))continue;if(f>=3&&We("cubic_polynomial_solver_too_many_roots"),x){const w=LG(t,e,i,s);v.setError(w.estimateError(v.value()))}r[f]=v,f++}if(h[_].value()===n.vmax)break;x&&_++}}return f}function OOe(t,e,i,s,n,r){const o=new IOe(t,e,i,cn());let a=0;if(o.truePower===2)a=Ul(t[2],t[1],t[0],i,s,n);else if(o.truePower===1)a=UP(t[1],t[0],i,n[0]);else{if(o.truePower===0)return t[0].value()?0:-1;{const l=[];l.length=e,a=zy(o,i,e,l);for(let u=0;u<a;u++)n[u].set(l[u])}}for(let l=0;l<a;l++)n[l].setError(o.getError(n[l].value()));return a}var LD=Hs;let v1=class Tpe extends mA{constructor(e){e===void 0||KF(e,"vd")?(super({vd:e==null?void 0:e.vd,XStart:0,YStart:0,XEnd:0,YEnd:0}),this.m_cp=new N(0,0)):e.from?(super({XStart:e.from.x,YStart:e.from.y,XEnd:e.to.x,YEnd:e.to.y,...e.vd}),this.m_cp=e.cp.clone()):e.points?(super({XStart:e.points[0].x,YStart:e.points[0].y,XEnd:e.points[2].x,YEnd:e.points[2].y,...e.vd}),this.m_cp=e.points[1].clone()):e.copy?(super(e),this.m_cp=e.copy.m_cp.clone()):We("unexpected constructor args")}getBoundary(){return pd(this)}assignCopy(e){return this!==e&&e.copyTo(this),this}construct(e,i,s){this.setStartXY(e),this.m_cp.assign(i),this.setEndXY(s),$D(this)}constructPoints(e){this.setStartXY(e[0]),this.m_cp.assign(e[1]),this.setEndXY(e[2]),$D(this)}getGeometryType(){return q.enumBezier2}queryEnvelope(e){if(e.m_EnvelopeType!==2)_i("env type not impl");else{if(e.setCoords(this.getStartXY()),e.mergeNe(this.getEndXY()),e.contains(this.m_cp))return;const i=GJ(this);if(i!==null){const s=new N;for(const n of i.specialPoints)this.queryCoord2D(n,s),e.mergeNe(s)}else{const s=[];Gpe(this,s);const n=new N;for(const r of s)this.queryCoord2D(r,n),e.mergeNe(n)}}}applyTransformation(e){if(e.m_TransformationType===1){const i=he(N,3);return this.queryControlPoints(i),e.transformPoints2D(i,3,i),this.setStartXY(i[0]),this.m_cp.assign(i[1]),this.setEndXY(i[2]),void this.afterCompletedModification()}z(0)}createInstance(){return new Tpe({vd:this.m_description})}calculateLength2D(){return lL(this,1,!1)}calculateLowerLength2D(){return N.distance(this.getStartXY(),this.getEndXY())}calculateUpperLength2D(){return this.calculateUpperLength2D_()}calculateUpperLength2D_(){return N.distance(this.getStartXY(),this.m_cp)+N.distance(this.getEndXY(),this.m_cp)}queryCoord2D(e,i){this.queryCoord2DExtended(e,i,!1)}queryCoord2DExtended(e,i,s){const n=he(N,3);this.queryControlPoints(n),eh(n,e,i,s)}queryCoord2DE(e,i){LLe(this,e,i)}getCoordX(e){if(e<0||e>1){const i=new N;return this.queryCoord2DExtended(e,i,!0),i.x}if(e<=.5){const i=Ro(this.getStartX(),this.m_cp.x,e),s=Ro(this.m_cp.x,this.getEndX(),e);return Ro(i,s,e)}{const i=Xr(this.getStartX(),this.m_cp.x,e),s=Xr(this.m_cp.x,this.getEndX(),e);return Xr(i,s,e)}}getCoordY(e){if(e<0||e>1){const i=new N;return this.queryCoord2DExtended(e,i,!0),i.y}if(e<=.5){const i=Ro(this.getStartX(),this.m_cp.x,e),s=Ro(this.m_cp.x,this.getEndX(),e);return Ro(i,s,e)}{const i=Xr(this.getStartY(),this.m_cp.y,e),s=Xr(this.m_cp.y,this.getEndY(),e);return Xr(i,s,e)}}cut(e,i,s){const n=new ii;return this.queryCut(e,i,n,s),n.releaseSegment()}queryCut(e,i,s,n){const r=s.createQuadraticBezier();if(this.cutBezierIgnoreAttributes(e,i,r),n)return;r.assignVertexDescription(this.m_description);const o=this.m_description.getAttributeCount();if(o>1){for(let a=1;a<o;a++){const l=this.m_description.getSemantics(a),u=LD.getComponentCount(l);for(let c=0;c<u;c++){const h=this.getAttributeAsDbl(e,l,c);r.setStartAttribute(l,c,h)}}for(let a=1;a<o;a++){const l=this.m_description.getSemantics(a),u=LD.getComponentCount(l);for(let c=0;c<u;c++){const h=this.getAttributeAsDbl(i,l,c);r.setEndAttribute(l,c,h)}}}}queryDerivative(e,i){kLe(this,e,i)}cutBezierIgnoreAttributes(e,i,s){if((e<0||i>1||e>i)&&ce("Quadratic_bezier.cut_bezier_ignore_attributes"),e===0&&i===1)return s.setStartXY(this.getStartXY()),s.m_cp.assign(this.m_cp),void s.setEndXY(this.getEndXY());const n=he(N,3);this.queryControlPoints(n),XP(n,e,i,n),s.constructPoints(n)}splitBezierIgnoreAttributes(e,i,s){z(0)}getAttributeAsDbl(e,i,s){if(i===0)return s===0?this.getCoordX(e):this.getCoordY(e);const n=this.calculateLength2D(),r=n>0?this.tToLength(e)/n:0,o=LD.getInterpolation(i),a=this.getStartAttributeAsDbl(i,s),l=this.getEndAttributeAsDbl(i,s);return aA(o,a,l,r,LD.getDefaultValue(i))}getClosestCoordinate(e,i){return uL(this,e,Me.unit(),i)}getClosestCoordinateOnInterval(e,i,s=-1){return uL(this,e,i,!1)}getYMonotonicParts(e,i){return this.getMonotonicParts(e,i)}getMonotonicParts(e,i){e.length<2&&ce("");const s=WG(this);let n=0;if(s.specialPointsCount()===2)return 0;z(e.length>=s.specialPointsCount()-1);for(let r=1,o=s.specialPointsCount();r<o;++r)this.queryCut(s.specialPoints[r-1],s.specialPoints[r],e[n],i),n++;for(let r=0;r<n;++r)ZG(e[r].get());return n}intersectionWithAxis2D(e,i,s,n){const r=he(ge,3),o=he(ge,2),a=new Me(0,1);let l=0;if(e){if(r[0]=new ge(this.getStartY()).sub(i),r[1]=new ge(this.m_cp.y).subE(new ge(this.getStartY())).mulThisByPower2(2),r[2]=new ge(this.getStartY()).add(this.getEndY()).subE(new ge(this.m_cp.y).mulThisByPower2(2)),l=Ul(r[2],r[1],r[0],a,!1,o),s)for(let u=0;u<l;u++)s[u]=this.getCoordX(o[u].value())}else if(r[0]=new ge(this.getStartX()).sub(i),r[1]=new ge(this.m_cp.x).subE(new ge(this.getStartX())).mulThisByPower2(2),r[2]=new ge(this.getStartX()).add(this.getEndX()).subE(new ge(this.m_cp.x).mulThisByPower2(2)),l=Ul(r[2],r[1],r[0],a,!1,o),s)for(let u=0;u<l;u++)s[u]=this.getCoordY(o[u].value());if(n)for(let u=0;u<l;u++)n[u]=o[u].value();else s&&gG(s,l);return l}intersectionOfYMonotonicWithAxisX(e,i){if(this.m_YStart===this.m_YEnd)return e===this.m_YStart?i:Number.NaN;if(e===this.m_YStart)return this.m_XStart;if(e===this.m_YEnd)return this.m_XEnd;const s=[0,0],n=this.intersectionWithAxis2D(!0,e,s,null);return z(n!==2),n===-1?i:s[0]}isCurve(){return!0}isLine(){return!1}isDegenerate(e){return s4(this,e)}isDegenerate3D(e,i){return z(0),!1}queryLooseEnvelope(e){if(e.m_EnvelopeType===2)return e.setCoords(this.getStartXY()),e.mergeNe(this.m_cp),void e.mergeNe(this.getEndXY());z(0)}clone(e){const i=this.createInstance();return this.copyTo(i),i}queryInterval(e,i){if(e===0){const s=new J;this.queryEnvelope(s);const n=new Me;return i===0?s.queryIntervalX(n):s.queryIntervalY(n),n}return super.queryInterval(e,i)}queryLooseEnvelopeOnInterval(e,i){const s=he(N,4);this.queryControlPoints(s),XP(s,e.vmin,e.vmax,s),i.setFromPoints(s,4)}changeEndPoints2D(e,i){if(e.isEqual(this.m_XStart,this.m_YStart)&&i.isEqual(this.m_XEnd,this.m_YEnd))return;const s=this.m_cp.isEqual(this.m_XStart,this.m_YStart),n=this.m_cp.isEqual(this.m_XEnd,this.m_YEnd);this.setStartXY(e),this.setEndXY(i),s?this.m_cp.setCoordsPoint2D(e):n&&this.m_cp.setCoordsPoint2D(i),this.normalizeAfterEndpointChange()}tToLength(e){return lL(this,e,!0)}lengthToT(e){return ELe(this,e)}calculateWeightedAreaCentroid2D(e){const i=he(N,3);NLe(this,i);const s=i[2],n=i[1],r=new N,o=s.y*n.x-s.x*n.y;r.x=-(4*s.x+5*n.x)*o/60,r.y=-(4*s.y+5*n.y)*o/60;const a=zJ(this);return r.x+=(i[0].x-e.x)*a,r.y+=(i[0].y-e.y)*a,r}calculateWeightedCentroid2D(){const e=new N;return this.isDegenerate(0)?(e.setCoords(0,0),e):CLe(this)?(e.assign(this.getCoord2D(.5).mul(this.calculateLength2D())),e):(e.assign(MLe(this,1)),e)}getControlPoint1(){return this.m_cp.clone()}setControlPoint1(e){this.m_cp.setCoordsPoint2D(e),this.afterCompletedModification()}queryControlPoints(e){e[0].assign(this.getStartXY()),e[1].assign(this.m_cp),e[2].assign(this.getEndXY())}setControlPoints(e){for(let i=0;i<3;i++)e[i].isNAN()&&ce("NaN control points in bezier are not supported");this.m_XStart=e[0].x,this.m_YStart=e[0].y,this.m_cp.setCoordsPoint2D(e[1]),this.m_XEnd=e[2].x,this.m_YEnd=e[2].y,this.afterCompletedModification()}getTangent(e){const i=Os(e,0,1);let s=$2(this,1,i);return s.isZero()&&(s=$2(this,2,i),i===1&&s.negateThis()),s}getDerivative(e){return $2(this,1,Os(e,0,1))}getCurvature(e){const i=$2(this,1,e),s=$2(this,2,e),n=i.sqrLength();return n===0?Number.NaN:(i.divThis(Math.sqrt(n)),i.crossProduct(s)/n)}isIntersecting(e,i,s){return tE(!1,this,e,i,s)!==0}isIntersectingPoint(e,i,s){if(s&&(e.isEqualPoint2D(this.getStartXY())||e.isEqualPoint2D(this.getEndXY())))return!1;const n=new J;if(this.queryLooseEnvelope(n),n.inflateCoords(i,i),!n.contains(e))return!1;const r=this.getClosestCoordinate(e,!1),o=new N;return this.queryCoord2D(r,o),N.distance(o,e)<=i}isIntersectingPoint3D(e,i,s,n,r=1){return z(0),!1}isMonotoneQuickAndDirty(){return!1}getMonotonicPartParams(e,i){const s=WG(this),n=s.specialPointsCount();if(!i)return s.specialPointsCount();e<n&&ce("");for(let r=0;r<n;r++)i[r]=s.specialPoints[r];return n}normalizeAfterEndpointChange(){return!1}orientBottomUp(){if(this.m_YEnd<this.m_YStart||this.m_YEnd===this.m_YStart&&this.m_XEnd<this.m_XStart){Ge(this.m_XStart,this.m_XStart=this.m_XEnd),Ge(this.m_YStart,this.m_YStart=this.m_YEnd);for(let e=0,i=this.m_description.getTotalComponentCount()-2;e<i;e++)this.m_attributes[e+i]=Ge(this.m_attributes[e],this.m_attributes[e]=this.m_attributes[e+i]);this.m_cachedValues=null}}isDegenerateToLineHelper(e){const i=[e];if(!k7(this,i))return!1;const s=this.getEndXY().sub(this.getStartXY()),n=s.length(),r=this.getControlPoint1();return r.sub(this.getStartXY()),!(Math.abs(r.crossProduct(s))/n>i[0])}copyIgnoreAttributes(e){const i=he(N,3);this.queryControlPoints(i),e.setControlPoints(i)}calculateArea2DHelper(){return zJ(this)}absNorm(){return ILe(this)}queryEnvelopeW(e,i){const s=he(N,3);this.queryControlPoints(s),YP(s,e,i)}setSegmentFromCoords(e,i){this.construct(e[0],this.getControlPoint1(),e[i-1])}snapControlPoints(e){return VLe(this,e)}writeInBufferStream(e,i){const s=new Float64Array(2);return s[0]=this.m_cp.x,s[1]=this.m_cp.y,e.writeRangeFromArray(i,s.length,s,!0,1),i+s.length}readFromBufferStream(e,i){const s=new Float64Array(2);e.queryRange(i,s.length,s,!0,1),this.m_cp.x=s[0],this.m_cp.y=s[1],this.m_cachedValues=null}needsSnapControlPoints(e){return zLe(this,e)}calculateSpecialPointsForCracking(e,i){return 0}ensureXYMonotone(){return ZG(this)}setCoordsForIntersector(e,i,s){ALe(this,e,i,s)}copyToImpl(e){const i=e;i.m_cp.setCoordsPoint2D(this.m_cp),Hpe(i,GJ(this))}reverseImpl(){}equalsImplTol(e,i){const s=e;return!!this.m_cp.isEqualPoint2D(s.m_cp,i)}equalsImpl(e){const i=e;return!!this.m_cp.equals(i.m_cp)}swapImpl(e){const i=e;i.m_cp=Ge(this.m_cp,this.m_cp=i.m_cp),wLe(this,i)}afterCompletedModification(){$D(this)}intersect(e,i,s,n,r){return q1(!1,this,e,i,s,n,r)}intersectPoint(e,i,s){return TLe(this,e,i.length,i,s)}endPointModified(){$D(this)}clearEndPointModified(){}};v1.type=q.enumBezier2;var FD=Hs;let il=class Ppe extends mA{constructor(e){return e===void 0||KF(e,"vd")?(super({vd:e==null?void 0:e.vd,XStart:0,YStart:0,XEnd:0,YEnd:0}),this.m_cp=new N(0,0),void(this.m_weights=[1,0,1])):(e.fromPoint&&e.weight?e={fromPoint:e.fromPoint,controlPoint1:e.controlPoint1,toPoint:e.toPoint,weight0:1,weight1:e.weight,weight2:1}:e.points&&e.weight?e={fromPoint:e.points[0],controlPoint1:e.points[1],toPoint:e.points[2],weight0:1,weight1:e.weight,weight2:1}:e.points&&e.weights&&(e={fromPoint:e.points[0],controlPoint1:e.points[1],toPoint:e.points[2],weight0:e.weights[0],weight1:e.weights[1],weight2:e.weights[2]}),e.fromPoint&&e.weight0?(super({start:e.fromPoint,end:e.toPoint}),(e.weight0<=0||e.weight1<0||e.weight2<=0)&&ce("weights"),this.m_cp=e.controlPoint1.clone(),void(this.m_weights=[e.weight0,e.weight1,e.weight2])):e.copy?(super(e),this.m_cp=e.copy.m_cp.clone(),void(this.m_weights=e.copy.m_weights.slice())):e.move?(super(e),this.m_cp=e.move.m_cp.clone(),void(this.m_weights=e.move.m_weights.slice())):void _i("unexpected constructor param"))}getBoundary(){return pd(this)}assignMove(e){return this}assignCopy(e){return e.copyTo(this),this}construct(e,i,s,n){this.dropAllAttributes(),this.setCpsAndWeights(e,i,s,1,n,1),k2(this)}constructWeights(e,i,s,n,r,o){this.dropAllAttributes(),this.setCpsAndWeights(e,i,s,n,r,o),k2(this)}constructArray(e,i){this.construct(e[0],e[1],e[2],i)}constructArrayWeights(e,i){this.dropAllAttributes(),this.setCpsAndWeightsArray(e,i),k2(this)}convertToStandardForm(){}getStandardFormWeight(){return this.m_weights[1]/Math.sqrt(this.m_weights[0]*this.m_weights[2])}getGeometryType(){return q.enumRationalBezier2}queryEnvelope(e){if(e instanceof J){if(e.setCoords(this.getStartXY()),e.mergeNe(this.getEndXY()),e.contains(this.m_cp))return;const i=OJ(this);if(i!==null){const s=new N;for(const n of i.specialPoints)this.queryCoord2D(n,s),e.mergeNe(s)}else{const s=[],n=he(N,3);this.queryControlPoints(n),Fpe(n,this.m_weights,s);const r=new N;for(const o of s)this.queryCoord2D(o,r),e.mergeNe(r)}}}applyTransformation(e){if(e instanceof Gi){const i=he(N,3);return this.queryControlPoints(i),e.transformPoints2D(i,3,i),this.setStartXY(i[0]),this.m_cp.assign(i[1]),this.setEndXY(i[2]),void this.afterCompletedModification()}}createInstance(){return new Ppe({vd:this.m_description})}calculateLength2D(){return zP(this,1,!1)}calculateLowerLength2D(){return N.distance(this.getStartXY(),this.getEndXY())}calculateUpperLength2D(){return this.calculateUpperLength2D_()}calculateUpperLength2D_(){return this.m_weights[1]>0?N.distance(this.getStartXY(),this.m_cp)+N.distance(this.getEndXY(),this.m_cp):N.distance(this.getStartXY(),this.getEndXY())}queryCoord2D(e,i){return this.queryCoord2DExtension(e,i,!0)}queryCoord2DE(e,i){_Le(this,e,i)}queryCoord2DExtension(e,i,s){if(s){if(e<0)return void Rl(new mi({start:this.getStartXY(),end:this.getStartXY().add(this.getTangent(0).getUnitVector())}),e,i);if(e>1)return void Rl(new mi({start:this.getEndXY(),end:this.getEndXY().add(this.getTangent(1).getUnitVector())}),e-1,i)}const n=he(N,3);this.queryControlPoints(n),kn(n,this.m_weights,e,i)}getCoordX(e){const i=new N;return this.queryCoord2DExtension(e,i,!0),i.x}getCoordY(e){const i=new N;return this.queryCoord2DExtension(e,i,!0),i.y}cut(e,i,s){const n=new ii;return this.queryCut(e,i,n,s),n.releaseSegment()}queryCut(e,i,s,n){const r=s.createQuadraticRationalBezier();if(this.cutBezierIgnoreAttributes(e,i,r),n)return;r.assignVertexDescription(this.m_description);const o=this.m_description.getAttributeCount();if(o>1){for(let a=1;a<o;a++){const l=this.m_description.getSemantics(a),u=FD.getComponentCount(l);for(let c=0;c<u;c++){const h=this.getAttributeAsDbl(e,l,c);r.setStartAttribute(l,c,h)}}for(let a=1;a<o;a++){const l=this.m_description.getSemantics(a),u=FD.getComponentCount(l);for(let c=0;c<u;c++){const h=this.getAttributeAsDbl(i,l,c);r.setEndAttribute(l,c,h)}}}}queryDerivative(e,i){eLe(this,e,i)}cutBezierIgnoreAttributes(e,i,s){(e<0||i>1||e>i)&&ce("Quadratic_rational_bezier.cut_bezier_ignore_attributes");const n=he(N,3);this.queryControlPoints(n);const r=[0,0,0];wy(n,this.m_weights,e,i,n,r),s.setControlPointsAndWeights(n,r)}splitBezierIgnoreAttributes(e,i,s){}getAttributeAsDbl(e,i,s){if(i===0)return s===0?this.getCoordX(e):this.getCoordY(e);const n=this.calculateLength2D(),r=n>0?this.tToLength(e)/n:0,o=FD.getInterpolation(i),a=this.getStartAttributeAsDbl(i,s),l=this.getEndAttributeAsDbl(i,s);return aA(o,a,l,r,FD.getDefaultValue(i))}getClosestCoordinate(e,i){return aL(this,e,Me.unit(),i,-1)}getClosestCoordinateOnInterval(e,i,s=-1){return aL(this,e,i,!1,s)}getYMonotonicParts(e,i){return this.getMonotonicParts(e,i)}getMonotonicParts(e,i){e.length<2&&ce("");const s=VP(this);let n=0;if(s.specialPointsCount()===2)return 0;z(e.length>=s.specialPointsCount()-1);for(let r=1,o=s.specialPointsCount();r<o;++r)this.queryCut(s.specialPoints[r-1],s.specialPoints[r],e[n],i),n++;for(let r=0;r<n;++r)zG(e[r].get());return n}intersectionWithAxis2D(e,i,s,n){s&&(s.length=9),n&&(n.length=9);const r=new Array(3),o=he(ge,2),a=new Me(0,1);let l=0;const u=he(N,3);if(this.queryControlPoints(u),e){if(r[0]=new ge(u[0].y).sub(i).mul(this.m_weights[0]),r[1]=new ge(u[1].y).sub(i).mul(this.m_weights[1]),r[2]=r[0].subE(r[1].mul(2)).addE(new ge(u[2].y).sub(i).mul(this.m_weights[2])),r[1]=r[1].subE(r[0]).mulThisByPower2(2),l=Ul(r[2],r[1],r[0],a,!1,o),s)for(let c=0;c<l;c++)s[c]=this.getCoordX(o[c].value())}else if(r[0]=new ge(u[0].x).sub(i).mul(this.m_weights[0]),r[1]=new ge(u[1].x).sub(i).mul(this.m_weights[1]),r[2]=r[0].subE(r[1].mul(2)).addE(new ge(u[2].x).sub(i).mul(this.m_weights[2])),r[1]=r[1].subE(r[0]).mulThisByPower2(2),l=Ul(r[2],r[1],r[0],a,!1,o),s)for(let c=0;c<l;c++)s[c]=this.getCoordY(o[c].value());if(n)for(let c=0;c<l;c++)n[c]=o[c].value();else s&&wd(s,0,l,Vm);return l}intersectionOfYMonotonicWithAxisX(e,i){if(this.m_YStart===this.m_YEnd)return e===this.m_YStart?i:Number.NaN;if(e===this.m_YStart)return this.m_XStart;if(e===this.m_YEnd)return this.m_XEnd;const s=[Number.NaN,Number.NaN],n=this.intersectionWithAxis2D(!0,e,s,null);return z(n!==2),n===-1?i:s[0]}isCurve(){return!0}isDegenerate(e){return s4(this,e)}isDegenerate3D(e,i){return!1}queryLooseEnvelope(e){if(e instanceof J)return e.setCoords({pt:this.getStartXY()}),e.mergeNe(this.m_cp),void e.mergeNe(this.getEndXY())}clone(e){const i=this.createInstance();return this.copyTo(i),i}queryInterval(e,i){if(e===0){const s=J.constructEmpty();this.queryEnvelope(s);const n=Me.constructEmpty();return i===0?s.queryIntervalX(n):s.queryIntervalY(n),n}return super.queryInterval(e,i)}queryLooseEnvelopeOnInterval(e,i){const s=he(N,3);this.queryControlPoints(s);const n=[0,0,0];wy(s,this.m_weights,e.vmin,e.vmax,s,n),i.setFromPoints(s,3)}changeEndPoints2D(e,i){if(e.isEqual(this.m_XStart,this.m_YStart)&&i.isEqual(this.m_XEnd,this.m_YEnd))return;const s=this.m_cp.isEqual(this.m_XStart,this.m_YStart),n=this.m_cp.isEqual(this.m_XEnd,this.m_YEnd);this.setStartXY(e),this.setEndXY(i),s?this.m_cp.setCoordsPoint2D(e):n&&this.m_cp.setCoordsPoint2D(i),this.normalizeAfterEndpointChange()}tToLength(e){return zP(this,e,!0)}lengthToT(e){return sLe(this,e)}calculateWeightedAreaCentroid2D(e){const i=oLe(this),s=RJ(this);return i.x+=(this.getStartX()-e.x)*s,i.y+=(this.getStartY()-e.y)*s,i}calculateWeightedCentroid2D(){const e=new N;return this.isDegenerate(0)?(e.setCoords(0,0),e):lLe(this)?(e.assign(this.getCoord2D(.5).mul(this.calculateLength2D())),e):(e.assign(hLe(this,1)),e)}getControlPoint1(){return this.m_cp.clone()}setControlPoint1(e){this.m_cp.setCoordsPoint2D(e),this.afterCompletedModification()}queryWeights(e){for(let i=0;i<3;++i)e[i]=this.m_weights[i]}setWeights(e){}queryControlPoints(e){e[0].assign(this.getStartXY()),e[1].assign(this.m_cp),e[2].assign(this.getEndXY())}setControlPointsAndWeights(e,i){this.setCpsAndWeightsArray(e,i),this.afterCompletedModification()}getTangent(e){const i=he(N,3);return this.queryControlPoints(i),VG(i,this.m_weights,e)}getDerivative(e){const i=Os(e,0,1),s=he(N,4);return oL(this,1,i,s),s[1]}getCurvature(e){const i=he(N,4);oL(this,2,e,i);const s=i[1].sqrLength();return s===0?Number.NaN:(i[1].divThis(Math.sqrt(s)),i[1].crossProduct(i[2])/s)}isIntersecting(e,i,s){return!1}isIntersectingPoint(e,i,s){return!1}isIntersectingPoint3D(e,i,s,n,r=1){return!1}isMonotoneQuickAndDirty(){const e=he(N,3);return this.queryControlPoints(e),r4(e)}getMonotonicPartParams(e,i){const s=VP(this),n=s.specialPointsCount();if(!i)return s.specialPointsCount();e<n&&ce("");for(let r=0;r<n;r++)i[r]=s.specialPoints[r];return n}normalizeAfterEndpointChange(){return!1}orientBottomUp(){if(this.m_YEnd<this.m_YStart||this.m_YEnd===this.m_YStart&&this.m_XEnd<this.m_XStart){this.m_XEnd=Ge(this.m_XStart,this.m_XStart=this.m_XEnd),this.m_YEnd=Ge(this.m_YStart,this.m_YStart=this.m_YEnd),this.m_weights[2]=Ge(this.m_weights[0],this.m_weights[0]=this.m_weights[2]);for(let e=0,i=this.m_description.getTotalComponentCount()-2;e<i;e++)this.m_attributes[e+i]=Ge(this.m_attributes[e],this.m_attributes[e]=this.m_attributes[e+i]);this.m_cachedValues=null}}isLine(){return!1}isDegenerateToLineHelper(e){const i=[e];return!!k7(this,i)&&pLe(this,i[0])}copyIgnoreAttributes(e){const i=he(N,3);this.queryControlPoints(i);const s=[0,0,0];this.queryWeights(s),e.setControlPointsAndWeights(i,s)}calculateArea2DHelper(){return RJ(this)}absNorm(){return this.getStartXY().norm(1)+this.getEndXY().norm(1)+this.m_cp.norm(1)}absNormXYZ(e){return z(0),0}queryEnvelopeW(e,i){Upe(this,e,i)}setSegmentFromCoords(e,i){const s=[0,0,0];this.queryWeights(s),this.constructWeights(e[0],this.getControlPoint1(),e[i-1],s[0],s[1],s[2])}writeInBufferStream(e,i){const s=new Float64Array(5);return s[0]=this.m_cp.x,s[1]=this.m_cp.y,s[2]=this.m_weights[0],s[3]=this.m_weights[1],s[4]=this.m_weights[2],e.writeRangeFromArray(i,s.length,s,!0,1),i+s.length}readFromBufferStream(e,i){const s=new Float64Array(5);e.queryRange(i,s.length,s,!0,1),this.m_cp.x=s[0],this.m_cp.y=s[1],this.m_weights[0]=s[2],this.m_weights[1]=s[3],this.m_weights[2]=s[4],this.m_cachedValues=null}snapControlPoints(e){const i=he(N,3);this.queryControlPoints(i);const s=N.sqrDistance(i[1],i[0]),n=N.sqrDistance(i[1],i[2]);let r=i[0].clone(),o=s;s>n&&(r=i[2].clone(),o=n);let a=!1;return o<=e&&o!==0&&(a=!0,this.setControlPoint1(r)),a}needsSnapControlPoints(e){if(!e)return!1;const i=he(N,3);this.queryControlPoints(i);const s=N.sqrDistance(i[1],i[0]),n=N.sqrDistance(i[1],i[2]);i[0].clone();let r=s;return s>n&&(i[2].clone(),r=n),r<=e&&r!==0}calculateSpecialPointsForCracking(e,i){return 0}ensureXYMonotone(){return zG(this)}setCoordsForIntersector(e,i,s){mLe(this,e,i,s)}copyToImpl(e){const i=e;i.m_cp.setCoordsPoint2D(this.m_cp),i.m_weights[0]=this.m_weights[0],i.m_weights[1]=this.m_weights[1],i.m_weights[2]=this.m_weights[2],$pe(i,OJ(this))}reverseImpl(){this.m_weights[2]=Ge(this.m_weights[0],this.m_weights[0]=this.m_weights[2])}equalsImpl(e){const i=e;if(!this.m_cp.equals(i.m_cp))return!1;for(let s=0;s<3;s++)if(this.m_weights[s]!==i.m_weights[s])return!1;return!0}equalsImplTol(e,i){const s=e;if(!this.m_cp.isEqualPoint2D(s.m_cp,i))return!1;const n=he(N,3);this.queryControlPoints(n);const r=he(N,3);s.queryControlPoints(r);const o=[s.m_weights[0],s.m_weights[1],s.m_weights[2]];for(let a=0;a<3;a++){const l=new gi;l.setCoordsPoint2DZ(n[a].mul(this.m_weights[a]),this.m_weights[a]);const u=new gi;if(u.setCoordsPoint2DZ(r[a].mul(o[a]),o[a]),!l.isEqual(u,i))return!1}return!0}swapImpl(e){const i=e;i.m_cp=Ge(this.m_cp,this.m_cp=i.m_cp),i.m_weights=Ge(this.m_weights,this.m_weights=i.m_weights),WOe(this,i)}afterCompletedModification(){k2(this)}intersect(e,i,s,n,r){return q1(!1,this,e,i,s,n,r)}intersectPoint(e,i,s){return cLe(this,e,i,s)}endPointModified(){k2(this)}clearEndPointModified(){}setCpsAndWeights(e,i,s,n,r,o){(n<=0||o<=0||r<0)&&ce("weights"),(e.isNAN()||i.isNAN()||s.isNAN())&&ce("NAN control points in bezier are not supported"),this.setStartXY(e),this.m_cp.assign(i),this.m_weights[0]=n,this.m_weights[1]=r,this.m_weights[2]=o,this.setEndXY(s)}setCpsAndWeightsArray(e,i){this.setCpsAndWeights(e[0],e[1],e[2],i[0],i[1],i[2])}};il.type=q.enumRationalBezier2;let ln=class jC{static constructPoint2D(e){return new jC(nt.constructDouble(e.x),nt.constructDouble(e.y))}constructor(e,i){if(e===void 0)return this.x=new nt().setNAN(),void(this.y=new nt().setNAN());this.x=e.clone(),this.y=i.clone()}assignPoint2D(e){return this.x.setDouble(e.x),this.y.setDouble(e.y),this}setCoords(e,i){return this.x.setThis(e),this.y.setThis(i),this}asPoint2D(){return new N(this.x.value(),this.y.value())}crossProduct(e){return this.x.mul(e.y).sub(this.y.mul(e.x))}leftPerpendicularThis(){const e=this.x.clone();this.x=this.y.clone().negate(),this.y=e}clone(){return new jC(this.x,this.y)}dotProduct(e){return this.x.mul(e.x).add(this.y.mul(e.y))}add(e){return new jC(this.x.add(e.x),this.y.add(e.y))}sub(e){return new jC(this.x.sub(e.x),this.y.sub(e.y))}sqrLength(){return this.x.sqr().addThis(this.y.sqr())}mulThis(e){return this.x.mulThis(e),this.y.mulThis(e),this}mul(e){return this.clone().mulThis(e)}},Mpe=class{constructor(e){return e.coefsT?(this.m_zeroCtor=e.zeroCtor,this.m_elements=e.coefsT.map(i=>i.clone()),z(this.m_elements.length===e.power+1),void this.updatePower()):e.coef0?(this.m_zeroCtor=e.zeroCtor,void(this.m_elements=[e.coef0.clone()])):e.copy?(this.m_zeroCtor=e.copy.m_zeroCtor,void(this.m_elements=e.copy.m_elements.map(i=>i.clone()))):(this.m_zeroCtor=e.zeroCtor,void(this.m_elements=[new this.m_zeroCtor]))}construct(e,i){return this.m_elements=e.map(s=>s.clone()),this.updatePower(),this}construct0(e){return this.m_elements.length=0,this.m_elements.push(e.clone()),this.updatePower(),this}assignCopy(e){return this.m_elements=e.m_elements.map(i=>i.clone()),this.updatePower(),this}assignMove(e){return this.m_elements=e.m_elements,e.m_elements=[],this.updatePower(),this}power(){return this.m_elements.length-1}addElement(e){this.m_elements.push(e.clone())}fmSubThis(e,i){return z(0),this}addThis(e){const i=Math.min(this.power(),e.power());for(let n=0;n<=i;++n)this.m_elements[n].addThis(e.m_elements[n]);const s=e.power();this.m_elements.length=Math.max(this.power(),e.power())+1;for(let n=i+1;n<=s;++n)this.m_elements[n]=e.m_elements[n];return this.updatePower(),this}add0(e){return this.m_elements[0].addThis(e),this.updatePower(),this}addNumber0(e){return z(0),this}sub(e){const i=Math.min(this.power(),e.power());for(let n=0;n<=i;++n)this.m_elements[n].subThis(e.m_elements[n]);const s=e.power();this.m_elements.length=Math.max(this.power(),e.power())+1;for(let n=i+1;n<=s;++n)this.m_elements[n]=e.m_elements[n].clone(),this.m_elements[n].negateThis();return this.updatePower(),this}sub0(e){return z(0),this}subNumber0(e){return z(0),this}subShifted(e,i){const s=this.power(),n=e.power()+i,r=Math.min(this.power(),n);let o=0;for(let a=i;a<=r;++a)this.m_elements[a].subThis(e.m_elements[o]),o++;if(n<=s)return this.updatePower(),this;this.m_elements.length=n+1;for(let a=s+1;a<this.m_elements.length;++a)this.m_elements[a]=new this.m_zeroCtor;for(let a=r+1;a<=n;++a)this.m_elements[a].subThis(e.m_elements[o++]);return this.updatePower(),this}subShiftedWithCoef(e,i,s){const n=this.power(),r=e.power()+s,o=Math.min(this.power(),r);let a=0;for(let l=s;l<=o;++l)this.m_elements[l].fmSubThis(e.m_elements[a],i),a++;if(r<=n)return this.updatePower(),this;this.m_elements.length=r+1;for(let l=n+1;l<this.m_elements.length;++l)this.m_elements[l]=new this.m_zeroCtor;for(let l=o+1;l<=r;++l)this.m_elements[l].fmSubThis(e.m_elements[a++],i);return this.updatePower(),this}mulThis(e){if(this.constructor===e.constructor){const i=e,s=[];for(let n=0,r=this.power();n<=r;n++)for(let o=0,a=i.power();o<=a;o++){const l=this.m_elements[n].clone();l.mulThis(i.m_elements[o]),n+o<s.length?s[n+o].addThis(l):s.push(l)}this.m_elements=s}else for(let i=0,s=this.power();i<=s;i++)this.m_elements[i].mulThis(e);return this.updatePower(),this}mulElementThis(e){for(let i=0,s=this.power();i<=s;i++)this.m_elements[i].mulThis(e);return this.updatePower(),this}mulNumber0(e){return z(0),this}mulBigint0(e){return z(0),this}mulBigIntThis(e){return z(0),this}mulInt320(e){return z(0),this}div0(e){return z(0),this}absThis(){return z(0),this}div(e,i,s){if(this.power()<e.power())return s.assignCopy(this),void i.setZero();s.setZero(),i.setZero();const n=e.getElement(e.power()),r=this.clone();let o=r.power();const a=r.power()-e.power();let l=a;for(i.m_elements=he(i.m_zeroCtor,a+1);;){if(o<e.power()){s.assignMove(r);break}if(o===r.power()){const u=r.getElement(r.power());u.divThis(n),r.subShiftedWithCoef(e,u,r.power()-e.power()),i.m_elements[l]=u.clone()}l--,o--}s.updatePower(),i.updatePower()}divThis(e){return z(0),this}subThis(e){const i=Math.min(this.power(),e.power());for(let n=0;n<=i;++n)this.m_elements[n].subThis(e.m_elements[n]);const s=e.power();this.m_elements.length=Math.max(this.power(),e.power())+1;for(let n=i+1;n<=s;++n)this.m_elements[n]=e.m_elements[n].clone(),this.m_elements[n].negateThis();return this.updatePower(),this}sub0This(e){return this.m_elements[0].subThis(e),this.updatePower(),this}subFrom(e,i){z(0)}isZero(){return this.power()===0&&this.m_elements[0].isZero()}negateThis(){for(let e=this.m_elements.length-1;e>=0;e--)this.m_elements[e].negateThis();return this}getElement(e){return this.m_elements[e].clone()}setElement(e,i){return this.m_elements[e]=i.clone(),this}evaluate(e){const i=this.power(),s=this.m_elements[i].clone();for(let n=i-1;n>=0;--n)s.mulThis(e),s.addThis(this.m_elements[n]);return s}equals(e){if(this===e)return!0;if(this.power()!==e.power())return!1;for(let i=this.m_elements.length-1;i>=0;i--)if(!this.m_elements[i].equals(e.m_elements[i]))return!1;return!0}updatePower(){for(let e=this.m_elements.length-1;e>0&&this.m_elements[e].isZero();e--)this.m_elements.pop();return this}setZero(){return this.m_elements.length=1,this.m_elements[0]=new this.m_zeroCtor,this.updatePower(),this}derivative(e){if(this.power()<e)return this.clone().setZero();if(e===0)return this.clone();const i=new this.constructor({coefsT:this.m_elements.slice(e),power:this.power()-e});for(let s=e,n=this.power();s<=n;s++){let r=BigInt(s);for(let o=s-1,a=s-e;o>a;--o)r*=BigInt(o);i.m_elements[s-e].mulBigIntThis(r)}return i.updatePower(),i}derivative1This(){if(this.m_elements.length>1){this.m_elements=this.m_elements.slice(1);for(let e=1,i=this.power();e<=i;e++)this.m_elements[e].mulThis(nt.constructInt32(e+1))}else this.m_elements.length=0,this.m_elements.push(new this.m_zeroCtor);return this}limitPrecisionThis(e){for(let i=this.power();i>=0;--i)this.m_elements[i].limitPrecisionThis(e);return this.updatePower(),this}hiBitIndex(){return this.m_elements.reduce((e,i)=>{const s=i.hiBitIndex();return e<s?s:e},0)}shiftRight(e){return this.m_elements.splice(0,e),this.updatePower(),this}static evaluateCoefs(e,i,s){const n=e.power();s.construct0(e.getElement(0).evaluate(i));for(let r=1;r<=n;++r)s.addElement(e.getElement(r).evaluate(i));s.updatePower()}},Ki=class Ape extends Mpe{constructor(e){super(e===void 0?{zeroCtor:nt}:{...e,zeroCtor:nt})}clone(){return new Ape({copy:this})}absEvaluate(e){const i=this.power(),s=this.m_elements[i].clone();s.absThis();const n=e.clone();n.absThis();for(let r=i-1;r>=0;--r)s.mulThis(n),s.addThis(this.m_elements[r].abs());return s}},Ka=class Ipe extends Mpe{constructor(e){super(e===void 0?{zeroCtor:Ki}:{...e,zeroCtor:Ki})}clone(){return new Ipe({copy:this})}constructFromMPValues(e,i){this.m_elements.length=0;for(let s=0;s<=i;++s)this.m_elements.push(new Ki({coef0:e[s]}));return this.updatePower(),this}};function LOe(){return{polypoly1:new Ka,polypoly2:new Ka,polyX2:new Ki,polyY2:new Ki,polyX2Deriv:new Ki,polyY2Deriv:new Ki,polypolyX1:new Ka,polypolyY1:new Ka,polypolyX1Deriv:new Ka,polypolyY1Deriv:new Ka,lazyPolypolyD1:new Ka,lazyPolypolyD1Deriv:new Ka,lazyPolyD2:new Ki,lazyPolyD2Deriv:null,polypoly11:new Ka,polypoly12:new Ka,tempPp:new Ka,tempPp1:new Ka,tempPp2:new Ka,tempP:new Ki,tempP1:new Ki,tempP2:new Ki}}function eE(t,e,i,s,n,r,o,a,l,u,c,h,d,m,f,_,v,x=!1){const w=LOe();w.polyX2.construct(o,a),w.polyY2.construct(l,u),w.polypolyX1.constructFromMPValues(t,e),w.polypolyY1.constructFromMPValues(i,s),w.polypoly11.assignCopy(w.polypolyX1),w.polypoly12.assignCopy(w.polypolyY1),c&&(w.lazyPolyD2.construct(c,h),w.polypoly11.mulElementThis(w.lazyPolyD2),w.polypoly12.mulElementThis(w.lazyPolyD2)),n?(w.lazyPolypolyD1.constructFromMPValues(n,r),w.lazyPolypolyD1Deriv=new Ka({copy:w.lazyPolypolyD1}),w.lazyPolypolyD1Deriv.derivative1This(),w.tempPp.assignCopy(w.lazyPolypolyD1),w.tempPp.mulElementThis(w.polyX2),w.polypoly11.subThis(w.tempPp),w.tempPp.assignCopy(w.lazyPolypolyD1),w.tempPp.mulElementThis(w.polyY2),w.polypoly12.subThis(w.tempPp)):(w.polypoly11.sub0This(w.polyX2),w.polypoly12.sub0This(w.polyY2)),w.polypolyX1Deriv.assignCopy(w.polypolyX1),w.polypolyX1Deriv.derivative1This(),w.polypolyY1Deriv.assignCopy(w.polypolyY1),w.polypolyY1Deriv.derivative1This(),n&&(w.polypolyX1Deriv.mulThis(w.lazyPolypolyD1),w.tempPp2.assignCopy(w.lazyPolypolyD1Deriv),w.tempPp2.mulThis(w.polypolyX1),w.polypolyX1Deriv.subThis(w.tempPp2),w.polypolyY1Deriv.mulThis(w.lazyPolypolyD1),w.tempPp2.assignCopy(w.lazyPolypolyD1Deriv),w.tempPp2.mulThis(w.polypolyY1),w.polypolyY1Deriv.subThis(w.tempPp2)),w.polyX2Deriv.assignCopy(w.polyX2),w.polyX2Deriv.derivative1This(),w.polyY2Deriv.assignCopy(w.polyY2),w.polyY2Deriv.derivative1This(),c&&(z(w.lazyPolyD2Deriv===null),w.lazyPolyD2Deriv=new Ki({copy:w.lazyPolyD2}),w.lazyPolyD2Deriv.derivative1This(),w.polyX2Deriv.mulThis(w.lazyPolyD2),w.tempP1.assignCopy(w.lazyPolyD2Deriv),w.tempP1.mulThis(w.polyX2),w.polyX2Deriv.subThis(w.tempP1),w.polyY2Deriv.mulThis(w.lazyPolyD2),w.tempP1.assignCopy(w.lazyPolyD2Deriv),w.tempP1.mulThis(w.polyY2),w.polyY2Deriv.subThis(w.tempP1)),w.polypoly1.assignCopy(w.polypoly11),w.polypoly1.mulElementThis(w.polyX2Deriv),w.tempPp.assignCopy(w.polypoly12),w.tempPp.mulElementThis(w.polyY2Deriv),w.polypoly1.addThis(w.tempPp),w.polypoly2.assignCopy(w.polypolyX1Deriv),w.polypoly2.mulElementThis(w.polyY2Deriv),w.tempPp.assignCopy(w.polypolyY1Deriv),w.tempPp.mulElementThis(w.polyX2Deriv),w.polypoly2.subThis(w.tempPp);let T=[];const C=[];v||(v=[]),_||(_=[]),kG(w.polypoly11,w.polypoly12,w.tempP);let M=57,A=.25*Number.EPSILON;const I=[];let L=R_(w.tempP,d,f,A,M,I);if(L<0)return-1;for(let $=0;$<L;$++){Ki.evaluateCoefs(w.polypoly11,nt.constructDouble(I[$]),w.tempP1);const B=[];let V=R_(w.tempP1,d,m,A,M,B);if(V!==0)if(Ki.evaluateCoefs(w.polypoly12,nt.constructDouble(I[$]),w.tempP2),V<0){V=R_(w.tempP2,d,m,A,M,B),V<0&&We("mp_curve_proximity");for(let H=0;H<V;H++)C.push(gr(B[H],I[$]))}else{const H=w.tempP2.absEvaluate(rd);H.mulThis(nt.constructDouble(1e-12));for(let Y=0;Y<V;Y++){const W=w.tempP2.evaluate(nt.constructDouble(B[Y]));W.absThis(),W.lt(H)&&C.push(gr(B[Y],I[$]))}}}L=C.length,kG(w.polypoly1,w.polypoly2,w.tempP),M=57,A=.25*Number.EPSILON;const D=[];let O=R_(w.tempP,d,f,A,M,D);O<0&&(O=0);for(let $=0;$<O;$++){Ki.evaluateCoefs(w.polypoly1,nt.constructDouble(D[$]),w.tempP1);const B=[];let V=R_(w.tempP1,d,m,A,M,B);if(V!==0)if(Ki.evaluateCoefs(w.polypoly2,nt.constructDouble(D[$]),w.tempP2),V<0){if(V=R_(w.tempP2,d,m,A,M,B),V<0)continue;for(let H=0;H<V;H++)T.push(gr(B[H],D[$]))}else{const H=w.tempP2.absEvaluate(rd);H.mulThis(nt.constructDouble(1e-12));for(let Y=0;Y<V;Y++){const W=w.tempP2.evaluate(nt.constructDouble(B[Y]));W.absThis(),W.lt(H)&&T.push(gr(B[Y],D[$]))}}}if(O=T.length,L===0&&O===0)return 0;T=T.concat(C),T.sort(($,B)=>x?Vm($.second,B.second):Vm($.first,B.first));const U=Qme(T,($,B)=>$.first===B.first&&$.second===B.second);T=T.slice(0,U),_.length=0,v.length=0;for(const $ of T)_.push($.first),v.push($.second);return z(_.length===v.length),v.length}function FOe(t,e,i,s,n,r,o){if(t.power()===0)return t.isZero()?-1:0;const a=t.evaluate(nt.constructInt32(1)).isZero();if(t.power()===1){const l=Dpe(t.getElement(1),t.getElement(0),e,r.at(0));return r[0].limitPrecisionThis(s),l!==1?0:(r[0].limitPrecisionThis(s),1)}return t.power()===2?YC(t.getElement(2),t.getElement(1),t.getElement(0),s,e,a,r):t.power()===3?XC(t.getElement(3),t.getElement(2),t.getElement(1),t.getElement(0),s,e,a,r):t.power()===4?Npe(t.getElement(4),t.getElement(3),t.getElement(2),t.getElement(1),t.getElement(0),s,e,a,r):Ope(t,e,i,s,a,n,r,o)}function kOe(){return{polyIntersect:new Ki,polyX1:new Ki,polyY1:new Ki,polyX1Deriv:new Ki,polyY1Deriv:new Ki,lazyPolyD1:new Ki,lazyPolyD1Deriv:new Ki,tempP:new Ki,tempP1:new Ki,tempP2:new Ki,polypoly1Proximity:new Ka,polypoly2Proximity:new Ka}}function G7(t,e,i,s,n,r,o,a,l,u,c){const h=kOe();h.polyX1.construct(t,e),h.polyY1.construct(i,s),h.polyX1Deriv.assignCopy(h.polyX1),h.polyX1Deriv.derivative1This(),h.polyY1Deriv.assignCopy(h.polyY1),h.polyY1Deriv.derivative1This(),h.polyIntersect.assignCopy(h.polyX1),h.polyIntersect.mulThis(h.polyX1),h.polyIntersect.mulElementThis(o[0]),h.tempP.assignCopy(h.polyY1),h.tempP.mulThis(h.polyY1),h.tempP.mulElementThis(o[1]),h.polyIntersect.addThis(h.tempP),n?(h.lazyPolyD1.construct(n,r),h.tempP.assignCopy(h.lazyPolyD1),h.tempP.mulThis(h.lazyPolyD1),h.tempP.mulElementThis(o[2]),h.polyIntersect.addThis(h.tempP)):h.polyIntersect.add0(o[2]);{const C=o[0].clone(),M=C.clone();M.sqrThis();const A=o[1].clone(),I=A.clone();I.sqrThis();const L=o[2].clone(),D=C.clone();D.subThis(A),h.polyX1.construct(t,e),h.polyX1Deriv.assignCopy(h.polyX1),h.polyX1Deriv.derivative1This(),h.polyY1.construct(i,s),h.polyY1Deriv.assignCopy(h.polyY1),h.polyY1Deriv.derivative1This(),h.tempP.assignCopy(h.polyX1),h.tempP.mulThis(h.polyX1),h.tempP.mulElementThis(I),h.tempP.mulElementThis(L),h.polypoly1Proximity.construct0(h.tempP),h.tempP.assignCopy(h.polyX1),h.tempP.mulThis(A.mul(D).mul(L).ldexpThis(1)),h.polypoly1Proximity.addElement(h.tempP),h.tempP.assignCopy(h.polyX1),h.tempP.mulThis(h.polyX1),h.tempP.mulElementThis(C.mul(I)),h.tempP1.assignCopy(h.polyY1),h.tempP1.mulThis(h.polyY1),h.tempP1.mulElementThis(M.mul(A)),h.tempP.addThis(h.tempP1),h.tempP.add0(D.mul(D).mul(L)),h.polypoly1Proximity.addElement(h.tempP),h.tempP.assignCopy(h.polyX1),h.tempP.mulElementThis(D.mul(C).mul(A).ldexpThis(1)),h.polypoly1Proximity.addElement(h.tempP),h.tempP.construct0(C.mul(D).mul(D)),h.polypoly1Proximity.addElement(h.tempP),h.polypoly1Proximity.updatePower(),h.tempP.construct0(sa),h.polypoly2Proximity.construct0(h.tempP),h.tempP.assignCopy(h.polyX1),h.tempP.mulThis(h.polyX1Deriv),h.tempP1.assignCopy(h.polyY1),h.tempP1.mulThis(h.polyY1Deriv),h.tempP.addThis(h.tempP1),h.tempP.mulElementThis(C.mul(A)),h.polypoly2Proximity.addElement(h.tempP),h.tempP.assignCopy(h.polyX1Deriv),h.tempP.mulElementThis(D.mul(C)),h.polypoly2Proximity.addElement(h.tempP),h.polypoly2Proximity.updatePower()}const d=[],m=[];c||(c=[]);let f=2*h.polyIntersect.power()+58;const _=.5*Number.EPSILON,v=R_(h.polyIntersect,a,l,_,f,m);if(v<0)return-1;kG(h.polypoly1Proximity,h.polypoly2Proximity,h.tempP),f=2*h.tempP.power()+58;let x=R_(h.tempP,a,l,_,f,d);if(x<0&&(x=0),v===0&&x===0)return 0;const w=d.concat(m);c.length=w.length,Qs(c,w,0,0,w.length),KS(c);const T=Qme(c,(C,M)=>Vm(C,M)===0);return c.length=T,c.length}function Dpe(t,e,i,s){return t.isZero()?e.isZero()?-1:0:(s.setThis(e),s.negateThis(),s.divThis(t),i.isEmpty()||i.containsCoordinate(s.value())?1:0)}function YC(t,e,i,s,n,r,o){if(t.isZero())return r?(o[0].setInt32(1),n.containsCoordinate(1)?1:0):Dpe(e,i,n,o[0]);if(r){let m=2;return o[0].setInt32(1),i.equals(t)?(o[1].setInt32(1),m=1):o[1].setThis(i.div(t)),n.containsCoordinate(o[1].value())||(m=1),n.containsCoordinate(o[0].value())||(m--,o[0].setThis(o[1])),m===2&&o[0].value()>o[1].value()&&(o[1]=Ge(o[0],o[0]=o[1])),m}const a=e.clone();a.sqrThis();const l=t.clone();if(l.mulThis(i).ldexpThis(2).negateThis().addThis(a),l.LZ())return 0;const u=s+2,c=nt.sqrt(l,u),h=c.clone();e.LZ()&&h.negateThis(),h.addThis(e).limitPrecisionThis(u).ldexpThis(-1).negateThis();let d=0;return o[0].setThis(h).divThis(nt.constructAssign(t,u)).limitPrecisionThis(s),(n.isEmpty()||n.containsCoordinate(o[0].value()))&&d++,c.isZero()||h.isZero()||(o[d].setThis(i).divThis(h).limitPrecisionThis(s),(n.isEmpty()||n.containsCoordinate(o[d].value()))&&d++,d===2&&o[0].gt(o[1])&&(o[1]=Ge(o[0],o[0]=o[1]))),d}function XC(t,e,i,s,n,r,o,a){if(t.isZero())return YC(e,i,s,n,r,o,a);const l=(U,$)=>{if(U>0){let B=$+U;for(let V=1;V<B;V++)a[V].equals(a[0])&&(a[B-1]=Ge(a[V],a[V]=a[B-1]),B--);$=B}return wd(a,0,$,(B,V)=>B.compare(V)),$};if(s.isZero()){let U=0;return r.containsCoordinate(0)&&(a[0].setInt32(0),U=1),l(YC(t,e,i,n,r,o,a.slice(1)),U)}if(o){let U=0;r.containsCoordinate(1)&&(a[0].setInt32(1),U=1);const $=e.add(t),B=s.negate(),V=t.add($).add(B).isZero();return l(YC(t,$,B,n,r,V,a.slice(U)),U)}const u=new nt,c=new nt,h=new nt,d=e.clone();if(d.isZero())c.setThis(i),c.divThis(t),h.setThis(s),c.divThis(t);else{d.divThis(t).divDoubleThis(3).negateThis();const U=e.clone();U.sqrThis();const $=t.clone();$.sqrThis(),c.setThis(t),c.mulThis(i).mulDoubleThis(3).subThis(U).divThis($).divDoubleThis(3),h.setThis(U),h.mulThis(e),h.ldexpThis(1),u.setThis(t),u.mulThis(e).mulThis(i).mulDoubleThis(9),h.subThis(u),u.setThis($),u.mulThis(s).mulDoubleThis(27),h.addThis(u),h.divThis($).divThis(t).divDoubleThis(27)}if(c.isZero()){const U=h.clone();return U.negateThis(),U.isZero()?(a[0].setThis(d),F2(r,n,a,1)):(a[0].setThis(nt.cubicRoot(h,n).add(d)),F2(r,n,a,1))}const m=h.clone();if(m.sqrThis().ldexpThis(-2),u.setThis(c.clone()),u.sqrThis().mulThis(c).divDoubleThis(27),m.addThis(u),m.isZero())return a[0].setThis(h),a[0].mulDoubleThis(3).divThis(c),a[1].setThis(a[0]),a[1].negateThis(),a[1].ldexpThis(-1),a[0].addThis(d),a[1].addThis(d),F2(r,n,a,2);if(m.GZ())return m.setThis(nt.sqrt(m,n+8)),u.setThis(h),u.ldexpThis(-1).negateThis(),u.addThis(m),a[0].setThis(nt.cubicRoot(u,n+8)),u.setThis(h),u.ldexpThis(-1).negateThis(),u.subThis(m),a[0].addThis(nt.cubicRoot(u,n+8)),a[0].addThis(d),F2(r,n,a,1);u.setThis(c),u.divDoubleThis(3).negateThis(),z(u.GEZ());const f=nt.sqrt(u,n+8),_=f.clone();_.negateThis(),_.addThis(d),f.addThis(d);const v=nt.constructDouble(r.isEmpty()?-Number.MAX_VALUE:r.vmin),x=nt.constructDouble(r.isEmpty()?Number.MAX_VALUE:r.vmax),w=new Ki({zeroCtor:nt});w.construct0(s),w.addElement(i),w.addElement(e),w.addElement(t);const T=new Ki({copy:w});T.derivative1This();let C=0;const M=he(nt,4);M[C++].setThis(v),_.gt(v)&&_.lt(x)&&M[C++].setThis(_),f.gt(v)&&f.lt(x)&&M[C++].setThis(f),M[C++].setThis(x);const A=3*n;let I=52,L=Number.EPSILON;for(;I<A;)2*I<=A?(L*=L,I*=2):(L*=Number.EPSILON,I+=52);I+=2;let D=0,O=!1;for(let U=1;U<C;U++)if($G(w,T,M[U-1],M[U],L,I,a[0])){D=1,O=U+1<C;break}if(!D)return 0;if(O){const U=new Ki({zeroCtor:nt,coef0:a[0]});U.negateThis(),U.addElement(rd);const $=new Ki({zeroCtor:nt}),B=new Ki({zeroCtor:nt});w.div(U,$,B),z($.power()===2),z(B.power()===0);const V=YC($.getElement(2),$.getElement(1),$.getElement(0),n,r,!1,a.slice(1));z(V>=0&&V<=2),D+=V}return F2(r,n,a,D)}function Npe(t,e,i,s,n,r,o,a,l){if(t.isZero())return XC(e,i,s,n,r,o,a,l);const u=(_,v)=>{if(_>0){let x=v+_;for(let w=1;w<x;w++)l[w].equals(l[0])&&(l[x-1]=Ge(l[w],l[w]=l[x-1]),x--);v=x}return wd(l,0,v,(x,w)=>x.compare(w)),v};if(n.isZero()){let _=0;return o.containsCoordinate(0)&&(l[0].setInt32(0),_=1),u(XC(t,e,i,s,r,o,a,l.slice(_)),_)}const c=new Ki({zeroCtor:nt,coef0:n});if(c.addElement(s),c.addElement(i),c.addElement(e),c.addElement(t),a){let _=0;o.containsCoordinate(1)&&(l[0].setInt32(1),_=1);const v=new Ki({zeroCtor:nt,coef0:nt.constructInt32(-1)});v.addElement(nt.constructInt32(1));const x=new Ki({zeroCtor:nt}),w=new Ki({zeroCtor:nt});return c.div(v,x,w),u(XC(x.power()===3?x.getElement(3):sa.clone(),x.power()>=2?x.getElement(2):sa.clone(),x.power()>=1?x.getElement(1):sa.clone(),x.getElement(0),r,o,x.evaluate(rd).isZero(),l.slice(_)),_)}if(c.getElement(0).isZero()){let _=0;for(o.containsCoordinate(0)&&(_=1,l[0].setDouble(0));c.getElement(0).isZero()&&c.power()>0;)c.shiftRight(1);const v=XC(c.power()===3?c.getElement(3):sa.clone(),c.power()>=2?c.getElement(2):sa.clone(),c.power()>=1?c.getElement(1):sa.clone(),c.getElement(0),r,o,!1,l.slice(_));return v>0&&(_+=v),wd(l,0,_,(x,w)=>x.compare(w)),_}let h=52,d=Number.EPSILON;for(;h<r;)2*h<=r?(d*=d,h*=2):(d*=Number.EPSILON,h+=52);h+=2;const m=Lpe(c),f=nt.constructDouble(Math.max(Math.abs(o.vmax),Math.abs(o.vmin)));return d=(m.lt(f)?m:f).mul(nt.constructDouble(d)).toDouble(),Ope(c,o,d,h,a,!1,l,4)}function $Oe(t,e){let i=t,s=e;s.power()>i.power()&&(s=Ge(i,i=s));const n=i.power()-s.power(),r=new Ki({copy:i.getElement(i.power())});i.mulThis(s.getElement(s.power()));for(let o=0,a=i.power();o<a;o++)if(o>=n){const l=new Ki({copy:s.getElement(o-n)});l.mulThis(r);const u=i.getElement(o).sub(l);i.setElement(o,u)}i.setElement(i.power(),i.getElement(i.power()).setZero()),i.updatePower(),FG(i)}function FG(t){let e=0;for(;e<t.power()&&t.getElement(e).isZero();)e++;return e>0&&(t.shiftRight(e),!0)}function kG(t,e,i){const s=t.clone(),n=e.clone();for(FG(s),FG(n);s.power()!==0||n.power()!==0;)$Oe(s,n);i.assignMove(s.getElement(0))}function R_(t,e,i,s,n,r){r.length=0;const o=t.power(),a=he(nt,2*o+4),l=FOe(t,i||Me.unit(),s,n,!1,a,a.length);if(l>0){r.length=0;for(let u=0;u<l;u++){const c=a[u].value();u>0&&c<=r.at(-1)||r.push(c)}return r.length}return l}function Rpe(t,e,i){if(z(i>=1),t.power()===0)return t.isZero()?-1:0;const s=t.getElement(0);return s.negateThis(),s.divThis(t.getElement(1)),e[0].setThis(s),1}function UOe(t,e,i,s){if(t.power()<2)return Rpe(t,i,s);z(s>=1);let n=t.getElement(1);n.mulThis(t.getElement(1));const r=t.getElement(0);if(r.mulThis(t.getElement(2)),r.ldexpThis(2),n.subThis(r),n.LZ())return 0;if(n.isZero()){const u=t.getElement(1);return u.negateThis(),u.divThis(t.getElement(2)),u.ldexpThis(-1),u.limitPrecisionThis(e),i[0].setThis(u),1}z(s>=2),n=nt.sqrt(n,e+8);const o=t.getElement(1);o.negateThis();const a=o.clone();a.subThis(n),a.divThis(t.getElement(2)),a.ldexpThis(-1),a.limitPrecisionThis(e);const l=o.clone();return l.addThis(n),l.divThis(t.getElement(2)),l.ldexpThis(-1),l.limitPrecisionThis(e),a.lt(l)?(i[0].setThis(a),i[1].setThis(l)):(i[1].setThis(a),i[0].setThis(l)),2}function $G(t,e,i,s,n,r,o){let a=i.clone(),l=s.clone();a.limitPrecisionThis(r),l.limitPrecisionThis(r);let u=t.evaluate(a);u.limitPrecisionThis(r+2);let c=t.evaluate(l);if(c.limitPrecisionThis(r+2),u.GEZ()&&c.GEZ()||u.LEZ()&&c.LEZ())return u.absLessAbs(c)?(o=a,u.isZero()):(o=l,c.isZero());const h=c.LZ();h&&(c=Ge(u,u=c),l=Ge(a,a=l));const d=h?l:a,m=h?a:l,f=a.add(l).ldexpThis(-1);f.limitPrecisionThis(r);const _=l.sub(a);_.limitPrecisionThis(r),_.absThis();const v=_.clone();let x=t.evaluate(f),w=e.evaluate(f);const T=new Ki({copy:t}),C=new Ki({copy:e});{const ee=Math.max(t.hiBitIndex(),e.hiBitIndex()),ne=rd.clone();ne.ldexpThis(-(r+2));for(let j=64;j<ee;){T.limitPrecisionThis(j),C.limitPrecisionThis(j);const oe=T.evaluate(f),ve=C.evaluate(f),Ye=oe.sub(x),de=ve.sub(w);if(Ye.divThis(x).absThis().lt(ne)&&(w.isZero()||de.divThis(w).absThis().lt(ne)))break;T.assignCopy(t),C.assignCopy(e),j=Math.min(j+64,ee)}x.limitPrecisionThis(r+2),w.limitPrecisionThis(r+2)}const M=1,A=4;let I=A;const L=2;let D=1,O=0,U=0,$=M;const B=32,V=nt.constructDouble(.25*n),H=nt.constructDouble(.5001);let Y=0;const W=300;for(;++Y<W;){if(Y>B&&O>0||w.isZero()||$===L&&O>1||$===M&&I<A)$=M,D>1&&D--;else if($=L,U>1){const ve=_.mul(w);ve.absThis(),ve.ldexpThis(-3),ve.absLessAbs(x)&&D++}_.setThis(v);const ee=new nt;let ne=!1;if($===M)do{if(U>2){const ve=_.clone();if(ve.absThis(),ve.ldexpThis(4),m.sub(d).ldexpThis(-1).gt(ve)){if(f.equals(d)){ee.setThis(f),f.setThis(d.add(ve)),f.limitPrecisionThis(r),v.setThis(f.sub(ee));break}if(f.equals(m)){ee.setThis(f),f.setThis(m.sub(ve)),f.limitPrecisionThis(r),v.setThis(f.sub(ee));break}}}v.setThis(l.sub(a)),v.ldexpThis(-1),v.limitPrecisionThis(r),ee.setThis(f),f.setThis(a.add(v)),f.limitPrecisionThis(r),f.lt(d)?f.setThis(d):f.gt(m)&&f.setThis(m),ne=a.equals(f)||l.equals(f)}while(!1);else for(;;){if(v.setThis(x.div(w)),v.limitPrecisionThis(r),D!==1&&v.mulDoubleThis(D),ee.setThis(f),f.subThis(v),f.limitPrecisionThis(r),ne=f.equals(ee),f.lt(d)){if(D>1){f.setThis(ee),D--;continue}v.setThis(ee.sub(d)),f.setThis(d)}else if(f.gt(m)){if(D>1){f.setThis(ee),D--;continue}v.setThis(ee.sub(m)),f.setThis(m)}break}if(ne||v.absLessAbs(V)){ee.equals(f)||(x=T.evaluate(f),x.limitPrecisionThis(r+2));break}x=T.evaluate(f),x.limitPrecisionThis(r+2),w=C.evaluate(f),w.limitPrecisionThis(r+2);const j=a.clone(),oe=l.clone();x.LZ()?(u.setThis(x),a.setThis(f)):(c.setThis(x),l.setThis(f)),$===L&&(a.equals(j)&&l.equals(oe)||U>1&&!v.absLessAbs(H.mul(_)))?O++:O=0,$===M?(I++,U=0):(I=0,U++)}return Y>=W&&We("Root_finder iterations exceeded"),o.setThis(f),!0}function VOe(t,e,i,s,n){const r=t.evaluate(i);if(r.isZero())return!0;const o=nt.constructDouble(.5*s),a=i.clone();a.subThis(o);const l=t.evaluate(a),u=i.clone();u.addThis(o);const c=t.evaluate(u);if(l.LZ()&&c.GZ()||l.GZ()&&c.LZ()||(r.GZ()?l.LEZ()||c.LEZ():l.GEZ()||c.GEZ()))return!0;const h=l.LEZ()&&c.LEZ(),d=l.GEZ()&&c.GEZ();let m=!1;return h?r.gt(l)&&r.gt(c)&&(m=!0):d&&r.lt(l)&&r.lt(c)&&(m=!0),!!m&&r.absThis().lt(nt.constructDouble(1e-17))}function Ope(t,e,i,s,n,r,o,a){z(i>0),z(a>=t.power());const l=o,u=[];let c=[];const h=new Ki({zeroCtor:t.m_zeroCtor}),d=new Ki({zeroCtor:t.m_zeroCtor}),m=new Ki({zeroCtor:t.m_zeroCtor}),f=nt.constructDouble(i),_=nt.constructDouble(e.vmin),v=nt.constructDouble(e.vmax),x=_.sub(f),w=v.add(f),T=Lpe(t),C=T.clone();if(C.negateThis(),x.lt(C))x.setThis(C.sub(f));else if(x.gt(T))return 0;if(w.gt(T))w.setThis(T.add(f));else if(w.lt(C))return 0;let M=t,A=null;if(n){const H=new Ki({coef0:nt.constructInt32(-1)});H.addElement(rd),A=new Ki,M=A;const Y=new Ki,W=new Ki;for(t.div(H,Y,W),A.assignCopy(Y);M.evaluate(rd).isZero();)M.div(H,Y,W),A.assignCopy(Y)}let I=!1;if(M.power()>0&&M.getElement(0).isZero())for(I=!0,A||(A=new Ki({copy:M}),M=A);M.getElement(0).isZero();)A.shiftRight(1);let L=s+2*M.power()+2,D=i/Math.pow(2,M.power()+2),O=L;if(sa.gt(x)&&sa.lt(w)){for(let H=0,Y=M.power();H<Y;H++)if(M.getElement(H).isZero()){u.push(sa.clone());break}}for(let H=M.power()-1;H>0;H--)if(D*=2,L-=2,O-=2,M.power()-H!=1)if(M.power()-H!=2){d.assignMove(m),m.assignMove(M.derivative(H-1));let Y=[];for(let W=0,ee=c.length;W<ee;++W)if(c[W].first.lte(c[W].second)){const ne=new nt;if($G(d,h,c[W].first,c[W].second,D,L,ne)){u.push(ne);let j=ne.sub(f);j.limitPrecisionThis(O),Y.push(gr(c[W].first,j)),j=ne.add(f),j.limitPrecisionThis(O),Y.push(gr(j,c[W].second))}else Y.push(c[W])}c=Y,Y=[],h.assignMove(d)}else{d.assignMove(M.derivative(H));const Y=UOe(d,L,l,a);z(Y>=0&&Y<=2);for(let W=0;W<Y;W++)l[W].gt(x)&&l[W].lt(w)&&!l[W].isZero()&&u.push(l[W].clone());if(u.length>1&&u.sort((W,ee)=>W.compare(ee)),u.length>0){let W=u[0].sub(f);W.limitPrecisionThis(O),c.push(gr(x.clone(),W));let ee=u.length===1?w.clone():u[1].sub(f);W=u[0].add(f),W.limitPrecisionThis(O),ee.limitPrecisionThis(O),c.push(gr(W,ee)),u.length>1&&(ee=u.length===2?w.clone():u[2].sub(f),ee.limitPrecisionThis(O),W=u[1].add(f),W.limitPrecisionThis(O),c.push(gr(W,ee)),u.length>2&&(W=u[2].add(f),W.limitPrecisionThis(O),c.push(gr(W,w.clone()))))}else c.push(gr(x.clone(),w.clone()));h.assignCopy(d),m.assignMove(M.derivative(H-1))}else d.assignMove(M.derivative(H)),Rpe(d,l,a)===1&&(l[0].gt(x)&&l[0].lt(w)&&!l[0].isZero()&&u.push(l[0].clone()),h.assignMove(d),m.assignMove(M.derivative(H-1)));u.sort((H,Y)=>H.compare(Y)),c.length===0&&(h.assignMove(M.derivative(M.power())),h.isZero()||c.push(gr(x.clone(),w.clone())));let U=0,$=0,B=0;const V=new nt;for(;;){if($<c.length){if(c[$].first.gt(c[$].second)){$++;continue}let H=!1;if(B<u.length&&u[B].lt(c[$].first)&&(H=!0),!H){$G(M,h,c[$].first,c[$].second,i,s,V)&&(V.lt(_)?l[U++].setThis(_):V.gt(v)?l[U++].setThis(v):l[U++].setThis(V)),$++;continue}}if(!(B<u.length))break;B!==0&&u[B-1].equals(u[B])||VOe(M,h,u[B],i)&&(V.setThis(u[B]),V.lt(_)?V.setThis(_):V.gt(v)&&V.setThis(v),U!==0&&l[U].equals(V)||l[U++].setThis(V)),B++}return I&&sa.gt(x)&&sa.lt(w)&&(l[U++].setThis(sa),wd(l,0,U,(H,Y)=>H.compare(Y))),n&&rd.gt(x)&&rd.lt(w)&&(l[U++].setThis(rd),wd(l,0,U,(H,Y)=>H.compare(Y))),U}function Lpe(t){const e=t.getElement(t.power());e.limitPrecisionThis(53);const i=sa.clone();for(let s=0,n=t.power();s<n;s++){const r=t.getElement(s);r.limitPrecisionThis(53),r.divThis(e).absThis(),r.gt(i)&&i.setThis(r)}return i.addThis(rd),i.mulThis(nt.constructDouble(1+100*Number.EPSILON)),i}function F2(t,e,i,s){let n=s;if(!t.isEmpty()){n=0;for(let r=0;r<s;++r)t.containsCoordinate(i[r].value())&&(n!==r&&i[n].setThis(i[r]),n++)}n>1&&(i[0].gt(i[1])&&(i[1]=Ge(i[0],i[0]=i[1])),n>2&&(i[0].gt(i[2])&&(i[2]=Ge(i[0],i[0]=i[2])),i[1].gt(i[2])&&(i[2]=Ge(i[1],i[1]=i[2]))));for(let r=0;r<n;++r)i[r].limitPrecisionThis(e);return n}const TJ=[[.33998104358485626,.6521451548625461],[.8611363115940526,.34785484513745385]],PJ=[[.1834346424956498,.362683783378362],[.525532409916329,.31370664587788727],[.7966664774136267,.22238103445337448],[.9602898564975363,.10122853629037626]],MJ=[[.09501250983763744,.1894506104550685],[.2816035507792589,.18260341504492358],[.45801677765722737,.16915651939500254],[.6178762444026438,.14959598881657674],[.755404408355003,.12462897125553388],[.8656312023878318,.09515851168249279],[.9445750230732326,.062253523938647894],[.9894009349916499,.027152459411754096]],AJ=[[.04830766568773832,.0965400885147278],[.1444719615827965,.09563872007927486],[.23928736225213706,.09384439908080457],[.33186860228212767,.09117387869576389],[.42135127613063533,.08765209300440381],[.5068999089322294,.08331192422694675],[.5877157572407623,.07819389578707031],[.6630442669302152,.0723457941088485],[.7321821187402897,.06582222277636185],[.7944837959679424,.058684093478535544],[.84936761373257,.050998059262376175],[.8963211557660521,.04283589802222668],[.9349060759377397,.03427386291302143],[.9647622555875064,.02539206530926206],[.9856115115452684,.01627439473090567],[.9972638618494816,.007018610009470096]],IJ=[[.024350292663424433,.048690957009139724],[.07299312178779904,.04857546744150343],[.12146281929612056,.048344762234802954],[.16964442042399283,.04799938859645831],[.21742364374000708,.04754016571483031],[.2646871622087674,.04696818281621002],[.31132287199021097,.046284796581314416],[.3572201583376681,.04549162792741814],[.4022701579639916,.044590558163756566],[.4463660172534641,.04358372452932345],[.48940314570705296,.04247351512365359],[.5312794640198946,.04126256324262353],[.571895646202634,.03995374113272034],[.6111553551723933,.038550153178615626],[.6489654712546573,.03705512854024005],[.6852363130542333,.035472213256882386],[.7198818501716109,.033805161837141606],[.7528199072605319,.03205792835485155],[.7839723589433414,.030234657072402478],[.8132653151227975,.028339672614259483],[.8406292962525803,.02637746971505466],[.8659993981540928,.024352702568710874],[.8893154459951141,.022270173808383253],[.9105221370785028,.02013482315353021],[.9295691721319396,.017951715775697343],[.9464113748584028,.015726030476024718],[.9610087996520538,.013463047896718643],[.973326827789911,.011168139460131128],[.983336253884626,.008846759826363947],[.9910133714767443,.006504457968978363],[.9963401167719553,.004147033260562468],[.9993050417357722,.001783280721696433]],DJ=[[.012223698960615764,.024446180196262518],[.03666379096873349,.024431569097850044],[.06108196960413957,.02440235563384958],[.08546364050451549,.024358557264690626],[.10979423112764375,.024300200167971867],[.13405919946118777,.02422731922281525],[.15824404271422493,.024139957989019287],[.18233430598533718,.024038168681024052],[.2063155909020792,.023922012136703457],[.23017356422666,.023791557781003402],[.2538939664226943,.023646883584447616],[.2774626201779044,.02348807601653591],[.3008654388776772,.02331522999406276],[.32408843502441337,.023128448824387027],[.3471177285976355,.022927844143686846],[.369939555349859,.02271353585023646],[.39254027503326744,.022485652032744968],[.414906379552275,.022244328893799764],[.43702450103710416,.02198971066846049],[.4588814198335522,.021721949538052076],[.48046407240417205,.02144120553920846],[.5017595591361445,.02114764646822135],[.5227551520511755,.02084144778075115],[.5434383024128103,.02052279248696007],[.5637966482266181,.020191871042130043],[.5838180216287631,.01984888123283086],[.6034904561585486,.019494028058706602],[.6228021939105849,.019127523609950944],[.6417416925623075,.01874958694054471],[.660297632272646,.01836044393733134],[.6784589224477192,.017960327185008687],[.6962147083695144,.017549475827117706],[.7135543776835874,.01712813542311138],[.7304675667419088,.016696557801589205],[.746944166797062,.016255000909785187],[.7629743300440948,.015803728659399347],[.7785484755064119,.015343010768865144],[.7936572947621933,.014873122602147314],[.8082917575079137,.014394345004166847],[.8224431169556439,.013906964132951985],[.8361029150609068,.013411271288616333],[.8492629875779689,.012907562739267348],[.8619154689395485,.012396139543950923],[.8740527969580318,.01187730737274028],[.8856677173453972,.011351376324080417],[.8967532880491582,.010818660739503076],[.9073028834017568,.010279479015832158],[.9173101980809605,.009734153415006806],[.9267692508789478,.009183009871660874],[.9356743882779164,.00862637779861675],[.9440202878302202,.008064589890486059],[.9518019613412644,.0074979819256347285],[.9590147578536999,.006926892566898814],[.9656543664319652,.006351663161707189],[.9717168187471366,.005772637542865698],[.9771984914639074,.00519016183267633],[.9820961084357185,.004604584256702955],[.9864067427245862,.004016254983738642],[.9901278184917344,.0034255260409102157],[.9932571129002129,.0028327514714579912],[.9957927585349812,.0022382884309626186],[.997733248625514,.0016425030186690294],[.9990774599773758,.0010458126793403489],[.9998248879471319,.00044938096029209035]];function wm(t,e,i,s){const n=.5*(s-i),r=i+n,o=new Wr(0);for(let a=0,l=Math.trunc(t/2);a<l;++a){let u,c;switch(t){case 4:u=TJ[a][0],c=TJ[a][1];break;case 8:u=PJ[a][0],c=PJ[a][1];break;case 16:u=MJ[a][0],c=MJ[a][1];break;case 32:u=AJ[a][0],c=AJ[a][1];break;case 64:u=IJ[a][0],c=IJ[a][1];break;case 128:u=DJ[a][0],c=DJ[a][1];break;default:throw new Error("Quadrature_integral: invalid n")}const h=WQ(-.5,u,r),d=WQ(n,u,r);o.pe(e(h)*c),o.pe(e(d)*c)}return o.getResult()*n}function hS(t,e,i,s,n,r){return BOe(t,e,i,r,s,n)}function zOe(t,e,i,s,n,r){let o=n;if(s)return r[0]=1,o=.5*(e-t)*(i(t)+i(e)),o;const a=r[0],l=(e-t)/a,u=t,c=new Wr(0);for(let h=1;h<=r[0];++h){const d=(h-.5)*l;c.add(i(u+d))}return o=.5*(o+(e-t)*c.getResult()/a),r[0]*=2,o}function GOe(t,e,i,s,n,r,o){let a=0,l=Math.abs(n-i[t]);const u=st(e,Number.NaN),c=st(e,Number.NaN);for(let f=0;f<e;++f){const _=Math.abs(n-i[t+f]);_<l&&(a=f,l=_),u[f]=s[t+f],c[f]=s[t+f]}let h=0,d=0,m=0;r[0]=s[t+a],a--;for(let f=1;f<e;f++){for(let _=0;_<e-f;_++){if(d=i[t+_]-n,m=i[t+_+f]-n,h=d-m,h===0)return!1;const v=(u[_+1]-c[_])/h;u[_]=d*v,c[_]=m*v}if(2*(a+1)<e-f){const _=a+1;o[0]=u[_]}else{const _=a;o[0]=c[_],a--}r[0]+=o[0]}return!0}function BOe(t,e,i,s,n,r){if(i<e&&ce("xTo < xFrom"),i===e)return 0;const o=[0];let a=Number.MAX_VALUE;const l=[Number.MAX_VALUE];let u=0;const c=32,h=st(c+1,Number.NaN),d=st(c+1,Number.NaN),m=[0];h[0]=1;let f=0,_=0;for(let v=0;v<c;v++){if(u=zOe(e,i,s,v===0,u,m),d[v]=u,v+1>=t){GOe(v+1-t,t,h,d,0,o,l)||We("polynomial_interpolation");const x=n*Math.abs(o[0])+r,w=Math.abs(a-o[0]);if(w<=x&&Math.abs(l[0])<=x){if(f++,f>1&&(w<=.1*_||_===0||f>2))return o[0]}else f=0;_=w,a=o[0]}d[v+1]=d[v],h[v+1]=.25*h[v]}return o[0]}let qOe=class{constructor(){this.length=Number.NaN,this.area=Number.NaN,this.centroidX=Number.NaN,this.centroidY=0,this.specialPoints=[],this.specialPointsLength=[]}specialPointsCount(){return this.specialPoints.length}};function UG(t,e,i,s,n,r,o,a){for(;;){const l=N.distance(e[0],e[2]),u=N.distance(e[0],e[1])+N.distance(e[1],e[2]);if(u-l<=n+s*u)return t+es(l,u,.5);const c=he(N,4),h=I=>(Pw(e,i,1,I,c),c[1].length());if(o===0&&a<8){z(a<8);let I=h(0),L=h(1);r[0]+=2,I>L&&(L=Ge(I,I=L),e[2]=Ge(e[0],e[0]=e[2]),i[2]=Ge(i[0],i[0]=i[2]));let D=I/(I+L),O=1,U=u;for(;D<1/32&&U>=n+s*U;){O/=4;const $=h(O);r[0]++,D=I/($+I);const B=new N;if(kn(e,i,.5*O,B),U=N.distance(B,e[0]),U<=n){const V=new N;kn(e,i,O,V),U+=N.distance(V,B)}}if(O!==1){const $=he(N,3),B=[0,0,0];LJ(e,i,O,e,i,$,B),t=UG(t,$,B,s,n,r,0,a+1),o++,a++;continue}}let d=!1;const m=8;r[0]+=m;const f=wm(m,h,0,1),_=16;r[0]+=_;const v=wm(_,h,0,1);if(d=Math.abs(f-v)>n+s*u,!d)return t+v;if(o<8&&a<9){const I=he(N,3),L=[0,0,0];LJ(e,i,.5,e,i,I,L),t=UG(t,I,L,s,n,r,o+1,a+1),o++,a++;continue}const x=32;r[0]+=x;const w=wm(x,h,0,1);if(d=Math.abs(v-w)>n+s*u,!d)return t+w;const T=64;r[0]+=T;const C=wm(T,h,0,1);if(d=Math.abs(w-C)>n+s*u,!d)return t+C;const M=128;r[0]+=M;const A=wm(M,h,0,1);return d=Math.abs(C-A)>n+s*u,t+A}}function HOe(t,e,i,s,n){if(i===e)return 0;const r=he(N,3),o=[0,0,0];t.queryControlPoints(r),t.queryWeights(o);const a=[0,0,0],l=he(N,3);return wy(r,o,e,i,l,a),UG(0,l,a,s,n,[0],0,0)}let jOe=class{constructor(e,i,s){this.controlPoints=eL(e,3),this.weights=[0,0,0],Qs(this.weights,i,0,0,3),this.point=s.clone()}getMaxDerivative(){return 3}getValue(e,i){if(e===0){const s=new N;kn(this.controlPoints,this.weights,i,s);const n=he(N,4);return Pw(this.controlPoints,this.weights,1,i,n),2*s.sub(this.point).dotProduct(n[1])}if(e===1){const s=new N;kn(this.controlPoints,this.weights,i,s);const n=he(N,4);return Pw(this.controlPoints,this.weights,2,i,n),2*(s.sub(this.point).dotProduct(n[2])+n[1].dotProduct(n[1]))}if(e===2){const s=new N;kn(this.controlPoints,this.weights,i,s);const n=he(N,4);return Pw(this.controlPoints,this.weights,3,i,n),2*(s.sub(this.point).dotProduct(n[3])+3*n[1].dotProduct(n[2]))}return 0}getError(e){return z(0),0}};function YOe(t,e,i,s){const n=uLe(0,0,0,0,N.getNAN()),r=st(18,Number.NaN),o=he(N,3);t.queryControlPoints(o),o[2].subThis(e),o[1].subThis(e),o[0].subThis(e);const a=[0,0,0];t.queryWeights(a);const l=[1,oh(a),1],u=HP(a,i),c=HP(a,s),h=zy(new jOe(o,l,new N(0,0)),Me.construct(u,c),18,r);kn(o,l,u,n.pt),n.t=u,n.d=N.distance(n.pt,new N(0,0));const d=new N;kn(o,l,c,d);const m=N.distance(d,new N(0,0));m<n.d&&(n.d=m,n.t=c,n.pt.assign(d));for(let f=0;f<h;f++){kn(o,l,r[f],d);const _=N.distance(d,new N(0,0));_<n.d&&(n.d=_,n.t=dS(a,r[f]),n.pt.assign(d))}return n}function XOe(t,e,i,s,n){let r=!0;const o=he(N,4),a=hS(5,e,i,s,n,u=>(oL(t,1,u,o),(r?t.getCoordX(u)-t.getStartX():t.getCoordY(u)-t.getStartY())*o[1].length()));r=!1;const l=hS(5,e,i,s,n,u=>(oL(t,1,u,o),(r?t.getCoordX(u)-t.getStartX():t.getCoordY(u)-t.getStartY())*o[1].length()));return new N(a,l)}function k2(t){t.m_cachedValues=null}function WOe(t,e){e.m_cachedValues=Ge(t.m_cachedValues,t.m_cachedValues=e.m_cachedValues)}function VP(t){if(t.m_cachedValues)return t.m_cachedValues;const e=new qOe,i=he(N,3);t.queryControlPoints(i);const s=[0,0,0];return t.queryWeights(s),Fpe(i,s,e.specialPoints),$pe(t,e),e}function Fpe(t,e,i){if(e[1]===0)return i.length=0,i.push(0),void i.push(1);const s=he(ge,8);s[0].set(0);let n=1;{const r=new ge(t[1].x).subThis(t[0].x).mulThis(e[1]).mulThis(e[0]),o=new ge(t[2].x).subThis(t[0].x).mulThis(e[2]).mulThis(e[0]),a=r.subE(o).addThisE(new ge(t[2].x).subThis(t[1].x).mulThis(e[2]).mulThis(e[1]));o.subThisE(r.mul(2));const l=he(ge,2);let u=Ul(a,o,r,new Me(0,1),!1,l);u<0&&(u=0);for(let c=0;c<u;c++)Vs(l[c].value(),0,1)||(s[n]=l[c],n++)}{const r=new ge(t[1].y).subThis(t[0].y).mulThis(e[1]).mulThis(e[0]),o=new ge(t[2].y).subThis(t[0].y).mulThis(e[2]).mulThis(e[0]),a=r.subE(o).addThisE(new ge(t[2].y).subThis(t[1].y).mulThis(e[2]).mulThis(e[1]));o.subThisE(r.mul(2));const l=he(ge,2);let u=Ul(a,o,r,new Me(0,1),!1,l);u<0&&(u=0);for(let c=0;c<u;c++)Vs(l[c].value(),0,1)||(s[n]=l[c],n++)}if(s[n].set(1),n++,n>2){wd(s,0,n,(l,u)=>Vm(l.value(),u.value()));let r=0,o=s[0].value(),a=1;for(let l=1;l<n;l++)s[l].eq(s[l-1])?(o+=s[l].value(),a++):(a>1&&(o/=a,s[r].set(o)),r++,s[r]=s[l],o=s[l].value(),a=1);r++,n=r}s[0].set(0),s[n-1].set(1),i.length=n;for(let r=0;r<n;r++)i[r]=s[r].value()}function zP(t,e,i){if(i){if(e<0)return e;if(e>1)return e-1+zP(t,1,!1)}if(t.isDegenerate(0))return 0;const s=e===1,n=VP(t);if(s&&!Number.isNaN(n.length))return n.length;const r=kpe(t),o=r/t.calculateUpperLength2D();let a=0,l=0;for(let u=1,c=n.specialPointsCount();u<c;u++){const h=n.specialPoints[u];if(a+=HOe(t,l,Math.min(e,h),o,r),e<=h)break;l=h}return s&&(n.length=a),a}function oL(t,e,i,s){const n=he(N,3);t.queryControlPoints(n);const r=[0,0,0];t.queryWeights(r),Pw(n,r,e,i,s)}function Pw(t,e,i,s,n){const r=[t[0],t[1],t[2]],o=[e[0],e[1],e[2]],a=he(N,4);ZOe(r,o,i,s,a);for(let l=0;l<=i;l++)n[l].setCoords(a[l].x,a[l].y)}function ZOe(t,e,i,s,n){z(i>0);const r=[t[0].clone(),t[1].clone(),t[2].clone()];if(!r[0].isZero()){for(let T=1;T<3;++T)r[T].subThis(r[0]);r[0].setCoords(0,0)}const o=kD(r,e,0,s),a=LU(e,0,s),l=o.divide(a);if(n[0].assign(l),i===0)return;const u=[e[1]*e[0],e[2]*e[0]*.5,e[1]*e[2]],c=[t[1].sub(t[0]),t[2].sub(t[0]),t[2].sub(t[1])],h=a*a,d=kD(c,u,0,s).mul(2).divide(h);if(n[1].assign(d),i===1)return;const m=LU(e,1,s),f=2*a*m,_=kD(c,u,1,s).mul(2).sub(d.mul(f)).divide(h);if(n[2].assign(_),i===2)return;const v=kD(c,u,2,s).mul(2),x=2*(m*m+a*LU(e,2,s)),w=v.sub(_.mul(f).mul(2)).sub(d.mul(x)).divide(h);n[3].assign(w),i!==3&&We("")}function kD(t,e,i,s){if(i===0){if(s<=.5){const n=new N;tr(2,t[0].mul(e[0]),t[1].mul(e[1]),s,n);const r=new N;tr(2,t[1].mul(e[1]),t[2].mul(e[2]),s,r);const o=new N;return tr(2,n,r,s,o),o}{const n=new N;ir(2,t[0].mul(e[0]),t[1].mul(e[1]),s,n);const r=new N;ir(2,t[1].mul(e[1]),t[2].mul(e[2]),s,r);const o=new N;return ir(2,n,r,s,o),o}}if(i===1){const n=t[1].mul(e[1]),r=n.sub(t[0].mul(e[0])).mul(1-s).add(t[2].mul(e[2]).sub(n).mul(s));return r.mulThis(2),r}if(i===2){const n=t[1].mul(e[1]),r=t[2].mul(e[2]).sub(n).sub(n.sub(t[0].mul(e[0])));return r.mulThis(2),r}We("")}function NJ(t,e,i,s){if(s.toDouble()<=.5){const n=new Et;tc(2,t[0].mulE(e[0]),t[1].mulE(e[1]),s,n);const r=new Et;tc(2,t[1].mulE(e[1]),t[2].mulE(e[2]),s,r);const o=new Et;return tc(2,n,r,s,o),o}{const n=new Et;ic(2,t[0].mulE(e[0]),t[1].mulE(e[1]),s,n);const r=new Et;ic(2,t[1].mulE(e[1]),t[2].mulE(e[2]),s,r);const o=new Et;return ic(2,n,r,s,o),o}}function LU(t,e,i){if(e===0){const s=es(t[0],t[1],i),n=es(t[1],t[2],i);return es(s,n,i)}if(e===1)return 2*((1-i)*(t[1]-t[0])+(t[2]-t[1])*i);if(e===2)return 2*(t[2]-t[1]-(t[1]-t[0]));We("")}function KOe(t,e,i){if(i.toDouble()<=.5){const s=$c(t[0],t[1],i),n=$c(t[1],t[2],i);return $c(s,n,i)}{const s=Uc(t[0],t[1],i),n=Uc(t[1],t[2],i);return Uc(s,n,i)}}function QOe(t,e,i,s,n){const r=[Et.constructPoint2D(t[0]),Et.constructPoint2D(t[1]),Et.constructPoint2D(t[2])];r[2].subThisE(r[0]),r[1].subThisE(r[0]),r[0].setCoords(0,0),JOe(r,[new ge(e[0]),new ge(e[1]),new ge(e[2])],i,s,n)}function JOe(t,e,i,s,n){z(i>0);const r=[t[0].clone(),t[1].clone(),t[2].clone()];if(!r[0].isZero()){for(let m=1;m<3;++m)r[m].subThisE(r[0]);r[0]=Et.constructCoords(0,0)}const o=NJ(r,e,0,s),a=KOe(e,0,s),l=o.divE(a);n[0].setE(l);const u=[e[1].mulE(e[0]),e[2].mulE(e[0]).mul(.5),e[1].mulE(e[2])],c=NJ([t[1].subE(t[0]),t[2].subE(t[0]),t[2].subE(t[1])],u,0,s).mul(2),h=a.sqr(),d=c.divE(h);n[1].setE(d)}function eLe(t,e,i){const s=he(N,3);t.queryControlPoints(s);const n=st(3,Number.NaN);t.queryWeights(n),tLe(s,n,e,i)}function tLe(t,e,i,s){i.value()<0&&i.set(0,i.eps()),i.value()>1&&i.set(1,i.eps());const n=he(Et,4);QOe(t,e,1,i,n),s.setE(n[1])}function VG(t,e,i){const s=Os(i,0,1),n=he(N,4);if(Pw(t,e,3,s,n),n[1].isZero()){if(n[2].isZero())return n[3];{const r=n[2].clone();return s===1&&r.negateThis(),r}}return n[1]}let iLe=class{constructor(e,i){this.len=0,this.b=e,this.len=i}getMaxDerivative(){return 1}getValue(e,i){return e===0?this.len-zP(this.b,i,!1):0}getError(e){return z(0),0}};function sLe(t,e,i){const s=zP(t,1,!1);if(e<=0)return e;if(e>=s)return e-s+1;const n=[0];return zy(new iLe(t,e),Me.unit(),1,n)!==1&&We(""),n[0]}function RJ(t){const e=he(N,3),i=[0,0,0];return t.queryControlPoints(e),t.queryWeights(i),nLe(e,i)}function nLe(t,e){const i=oh(e);if(i===1)return qpe(t);if(i===0)return 0;const s=[new N(0,0),t[1].sub(t[0]),t[2].sub(t[0])],n=s[1].crossProduct(s[2]);if(i<1){z(i>0);const r=1-i;let o;if(r<.01)o=-1/3+r*(2/15+r*(3/35+r*(16/315+r*(20/693+r*(16/1001+r*(56/6435))))));else{const a=r*(1+i),l=Math.atan2(Math.sqrt(r),Math.sqrt(1+i));o=i*(.5*i-KRe(a)*l)/a}return n*o}{const r=(i-1)*(i+1);return .25*i/Math.pow(r,1.5)*(-2*i*Math.sqrt(r)*n-4*s[1].y*s[2].x*Math.atanh(Math.sqrt((i-1)/(i+1)))-s[1].x*s[2].y*Math.log(2*i*(i-Math.sqrt(r))-1))}}function rLe(t,e){const i=oh(e);if(i===1){const r=he(N,3);j7(t,r);const o=r[2].clone(),a=r[1].clone(),l=new N,u=o.y*a.x-o.x*a.y;return l.x=-(4*o.x+5*a.x)*u/60,l.y=-(4*o.y+5*a.y)*u/60,l}if(i===0)return new N(0,0);z(i>0);const s=t[1].sub(t[0]),n=t[2].sub(t[0]);if(i<1){const r=Math.sqrt(1-i),o=Math.sqrt(1+i),a=(s.y*n.x-s.x*n.y)*i/Math.pow(r*o,5)/12,l=Math.atan2(r,o),u=i*r*o,c=i*i,h=s.mul(2*(2+c)),d=n.mul(2*c-5),m=h.add(d).mul(u),f=n.sub(s.mul(2*c)).mul(6*l);return m.add(f).mul(a)}{const r=Math.sqrt(i-1),o=Math.sqrt(i+1),a=(s.y*n.x-s.x*n.y)*i/Math.pow(r*o,5)/12,l=Math.atanh(r/o),u=i*r*o,c=i*i,h=s.mul(4).sub(n.mul(5)),d=s.add(n).mul(2*c),m=h.add(d).mul(u),f=n.sub(s.mul(2*c)).mul(6*l);return m.add(f).mul(a)}}function oLe(t){const e=he(N,3),i=[0,0,0];return t.queryControlPoints(e),t.queryWeights(i),rLe(e,i)}function kpe(t){return aLe(t.calculateUpperLength2D())}function aLe(t){return 256*cn()*t}function lLe(t){if(t.m_weights[1]===0)return!0;const e=N.distance(t.getStartXY(),t.getEndXY()),i=t.calculateUpperLength2D();return i-e<=8*Number.EPSILON*i}function OJ(t){return t.m_cachedValues}function $pe(t,e){t.m_cachedValues=e}function aL(t,e,i,s,n){const r=he(N,3);t.queryControlPoints(r);const o=[0,0,0];t.queryWeights(o);const a=[0];return B7(r,o,e,Me.unit(),s,n,1,a)===1?a[0]:Number.NaN}function B7(t,e,i,s,n,r,o,a){RP(Me.unit().contains(s)&&o>0,""),(r<0||Number.isNaN(r))&&(r=Number.MAX_VALUE);const l=new Array(3);for(let ne=0;ne<3;++ne)l[ne]=t[ne].sub(i);const u=oh(e),c=ln.constructPoint2D(l[0]),h=ln.constructPoint2D(l[1]),d=ln.constructPoint2D(l[2]),m=nt.constructDouble(u),f=m.clone();f.ldexpThis(1);const _=c.dotProduct(h.sub(c)).mul(m),v=m.mul(m.addDouble(2)),x=d.sub(h.mul(v.ldexp(1))),w=h.sqrLength().mul(m.mul(m).ldexp(1)).add(c.sqrLength().mul(m.ldexp(2).subDouble(1))).add(c.dotProduct(x)),T=d.sub(h.mul(f)).add(c.mul(f.subDouble(1))),C=h.mul(m).sub(c).dotProduct(T).mulDouble(3),M=h.dotProduct(d).mul(m.subDouble(3).mul(m)).ldexp(1),A=h.sqrLength().mul(m.mul(m).ldexp(2)),I=c.sqrLength().mul(m.ldexp(2).subDouble(3)),L=c.dotProduct(d.sub(h.mul(m.mulDouble(3).subDouble(1)).mul(m))).ldexp(1),D=d.sqrLength().addThis(M).addThis(A).addThis(I).addThis(L),O=c.add(d).sub(h.mul(f)),U=m.subDouble(1),$=d.sub(c).dotProduct(O).mul(U),B=new N(0,0),V=[];let H=new N;kn(l,e,s.vmin,H);let Y=N.distance(H,B);if(Y<=r&&V.push(new N(s.vmin,Y)),s.vmin!==s.vmax&&(kn(l,e,s.vmax,H),Y=N.distance(H,B),Y<=r&&V.push(new N(s.vmax,Y))),s.width()>0){const ne=l[2].isZero(),j=he(nt,4),oe=Npe($,D,C,w,_,58,s,ne,j);for(let ve=0;ve<oe;ve++){if(!s.containsExclusiveCoordinate(j[ve].toDouble()))continue;let Ye=j[ve].toDouble();Ye=dS(e,Ye);const de=new N;kn(l,e,Ye,de),Y=N.distance(de,B),Y<=r&&V.push(new N(Ye,Y))}}if(n){z(s.equals(Me.unit()));{kn(l,e,-1,H,!0);const ne=new N;kn(l,e,0,ne);const j=new mi({start:H,end:ne}),oe=j.getClosestCoordinate(B,!0);oe<1&&(H=j.getCoord2D(oe),Y=N.distance(H,B),Y<=r&&V.push(new N(oe-1,Y)))}{kn(l,e,2,H,!0);const ne=new N;kn(l,e,s.vmax,ne);const j=new mi({start:ne,end:H}),oe=j.getClosestCoordinate(B,!0);oe>0&&(H=j.getCoord2D(oe),Y=N.distance(H,B),Y<=r&&V.push(new N(1+oe,Y)))}}if(!V.length)return 0;V.sort((ne,j)=>ne.compare(j));let W=0;const ee=V[0].x;if(a[W++]=ee,W<o){const ne=dpe(l,4,!1).total(),j=V[0].y;for(let oe=1,ve=V.length;oe<ve;oe++)if(V[oe].y>j+ne){V.length=oe;break}V.sort((oe,ve)=>Vm(oe.x,ve.x)),W=0,a[W++]=V[0].x;for(let oe=1,ve=V.length;oe<ve;oe++)V[oe].x!==a[W-1]&&W<o&&(a[W++]=V[oe].x)}return W}function uLe(t,e,i,s,n){return{tmin:t,tmax:e,t:i,d:s,pt:n.clone()}}function cLe(t,e,i,s,n){const r=new ua;if(Upe(t,Me.unit(),r),r.inflate(s),!r.isIntersectingPoint2D(e))return 0;const o=VP(t);let a=0;const l=[];let u=o.specialPoints[0];for(let c=1,h=o.specialPoints.length;c<h;++c){const d=o.specialPoints[c],m=YOe(t,e,u,d);if(l.length===0)l.push(m);else if(m.t===m.tmin)z(l.at(-1).d<=m.d),l.at(-1).tmax=m.tmax;else if(l.at(-1).t===l.at(-1).tmax){z(l.at(-1).d>=m.d);const f=l.at(-1).tmin;l[l.length-1]=m,l.at(-1).tmin=f}else l.push(m);u=d}for(const c of l)if(c.d<=s){const h=c.t;i&&(i[a]=h),a++}return a}function Upe(t,e,i){const s=he(N,3);t.queryControlPoints(s);const n=[0,0,0];t.queryWeights(n),GP(s,n,e,i)}function GP(t,e,i,s){if(i.equalsRange(0,1))return void s.setFromPoints(t,3);const n=he(N,3),r=[0,0,0];wy(t,e,i.vmin,i.vmax,n,r),s.setFromPoints(n,3)}function r4(t){const e=an(t[0].y,t[1].y),i=an(t[1].y,t[2].y);if(e>=0&&i>=0||e<=0&&i<=0){const s=an(t[0].x,t[1].x),n=an(t[1].x,t[2].x);if(s>=0&&n>=0||s<=0&&n<=0)return!0}return!1}function zG(t){const e=he(N,3);t.queryControlPoints(e);const i=x1(e);return i&&(t.m_cp.setCoordsPoint2D(e[1]),t.afterCompletedModification()),i}function x1(t){let e=!1;for(let i=0;i<2;i++){const s=an(t[0][i],t[2][i]);s>0?(an(t[0][i],t[1][i])<0&&(t[1][i]=t[0][i],e=!0),an(t[1][i],t[2][i])<0&&(t[1][i]=t[2][i],e=!0)):s<0?(an(t[0][i],t[1][i])>0&&(t[1][i]=t[0][i],e=!0),an(t[1][i],t[2][i])>0&&(t[1][i]=t[2][i],e=!0)):t[1][i]!==t[0][i]&&(t[1][i]=t[0][i],e=!0)}return e}function hLe(t,e,i){i===void 0&&(i=e,e=0);const s=new N;if(e<0||i>1)return s.setNAN(),s;if(e>i&&ce("calculate_sub_weighted_centroid"),e===i||t.isDegenerate(0))return s.setCoords(0,0),s;const n=VP(t),r=kpe(t),o=r/t.calculateUpperLength2D();let a=e,l=0;for(let u=1,c=n.specialPointsCount();u<c;u++)if(e<n.specialPoints[u]){l=u-1;break}s.setCoords(0,0);for(let u=l+1,c=n.specialPointsCount();u<c;u++){const h=Math.min(n.specialPoints[u],i),d=XOe(t,a,h,o,r);if(s.addThis(d),a=h,i<=n.specialPoints[u])break}return s.add(t.getStartXY().mul(t.calculateLength2D()))}function LJ(t,e,i,s,n,r,o){z(i>=0&&i<=1&&s!==r&&n!==o),z(e[0]>0&&e[2]>0&&e[1]>=0);const a=[1,oh(e),1],l=HP(e,i),u=eL(t,3),c=he(gi,3);Vpe(u,a,c);const h=he(gi,3),d=he(gi,3);jG(c,l,s?h:null,r?d:null),YG(e,i,n,o);const m=r4(u);if(s){for(let f=0;f<3;++f)qG(h[f],s[f]);XG(u,s),m&&x1(s)}if(r){for(let f=0;f<3;++f)qG(d[f],r[f]);XG(u,r),m&&x1(r)}}function wy(t,e,i,s,n,r){if(z(i>=0&&s<=1&&i<=s),i===s){const c=new N,h=zpe(t,e,i,c);return q7(t,c),n[0].assign(c),n[1].assign(c),n[2].assign(c),r[0]=h,r[1]=h,void(r[2]=h)}if(i===0&&s===1)return n[0].assign(t[0]),n[1].assign(t[1]),n[2].assign(t[2]),r[0]=e[0],r[1]=e[1],void(r[2]=e[2]);const o=he(gi,3);{const c=[1,oh(e),1],h=HP(e,i),d=HP(e,s);Vpe(t,c,o),jG(o,d,o,null),jG(o,h>=d?1:h/d,null,o)}const a=[0,0,0];YG(e,s,a,null),YG(a,i/s,null,a);const l=r4(t),u=he(N,3);qG(o[1],u[1]),kn(t,e,i,u[0]),kn(t,e,s,u[2]),XG(t,u);for(let c=0;c<3;++c)n[c].assign(u[c]),r[c]=a[c];l&&x1(n)}function dLe(t,e,i){const s=oh(e),n=[1,s,1],r=4*s/(3*(1+s));i[0].assign(t[0]),i[3].assign(t[2]),zn(t[0],t[1],r,i[1]),zn(t[2],t[1],r,i[2]),new hc({cp:i}),new il({points:t,weight:s});let o=0,a=.1,l=0;for(let u=0;u<9;u++,a+=.1){const c=new N;kn(t,n,a,c);const h=new N;xn(i,a,h);const d=N.sqrDistance(c,h);d>o&&(o=d,l=a)}{const u=new N;kn(t,n,l,u);const c=[0];S1(i,u,Me.unit(),!1,-1,1,c);const h=new N;return xn(i,c[0],h),o=N.sqrDistance(u,h),Math.sqrt(o)}}function mLe(t,e,i,s){if(e.isEqual(t.m_XStart,t.m_YStart)&&i.isEqual(t.m_XEnd,t.m_YEnd))return;const n=!!s&&t.isMonotoneQuickAndDirty(),r=new Gi,o=he(N,3);o[0].setCoords(t.m_XStart,t.m_YStart),o[2].setCoords(t.m_XEnd,t.m_YEnd);const a=new N;a.setSub(o[2],o[0]),a.leftPerpendicularThis(),o[1].setAdd(o[0],a);const l=he(N,3);l[0].setCoordsPoint2D(e),l[2].setCoordsPoint2D(i),a.setSub(l[2],l[0]),a.leftPerpendicularThis(),l[1].setAdd(l[0],a),r.setFromTwoTriangles(o,l)?r.transformInPlace(t.m_cp):zn(e,i,.5,t.m_cp),t.changeEndPoints2D(e,i),n&&zG(t)}function FJ(t,e,i,s,n){if(n){if(Gl(e,i)!==0)return t?4:2}else if(Mu(e,i))return 1;return b1(t,e,i,null,null,null,s,n!==void 0&&n,!0,!1)!==0?4:0}function kJ(t,e,i,s,n){if(n){if(Gl(e,i)!==0)return t?4:2}else if(Mu(e,i))return 1;return GG(t,e,i,null,null,null,s,n??!1,!0,!1)!==0?4:0}function pLe(t,e){const i=t.getEndXY().sub(t.getStartXY()),s=i.length(),n=t.getControlPoint1();return n.subThis(t.getStartXY()),!(Math.abs(n.crossProduct(i))/s>e)}function fLe(t,e,i,s,n){if(n){const r=Gl(e,i);if(r!==0){if(t){if(r===1){if(e.m_weights[0]===i.m_weights[0]&&e.m_weights[1]===i.m_weights[1]&&e.m_weights[2]===i.m_weights[2])return 2}else if(e.m_weights[0]===i.m_weights[2]&&e.m_weights[1]===i.m_weights[1]&&e.m_weights[2]===i.m_weights[0])return 2;return 4}return 2}}else if(Mu(e,i))return 1;return BP(t,e,i,null,null,null,s,n!==void 0&&n,!0,!1)!==0?4:0}function $J(t,e,i,s,n){if(n){if(Gl(e,i)!==0)return t?4:2}else if(Mu(e,i))return 1;return BG(t,e,i,null,null,null,s,n??!1,!0,!1)!==0?4:0}function b1(t,e,i,s,n,r,o,a,l,u){if(n!==null&&(n.length=0),r!==null&&(r.length=0),s!==null&&(s.length=0),i.isDegenerate(0)){const fe=[0,0],Ne=e.intersectPoint(i.getStartXY(),fe,o);if(Ne>0){if(n!==null)for(let je=0;je<Ne;je++)n.push(fe[je]);if(r!=null)for(let je=0;je<Ne;je++)r.push(0);if(s!=null)for(let je=0;je<Ne;je++){const Ee=new N;e.queryCoord2D(fe[je],Ee),s.push(Ee)}}return Ne}const c=hl(e,i);if(o=Math.max(o,c),e.isDegenerateToLineHelper(c)){const fe=new mi({start:e.getStartXY(),end:e.getEndXY()}),Ne=n4(fe,i,s,n,r,o,a,u);if(n)for(let je=0;je<Ne;++je){const Ee=fe.getCoord2D(n[je]);n[je]=e.getClosestCoordinate(Ee,!1)}return Ne}if(Au(e,i,o))return 0;const h=he(N,3);e.queryControlPoints(h);const d=[0,0,0];e.queryWeights(d);const m=[1,oh(d),1],f=i.getEndXY().sub(i.getStartXY()),_=f.clone();_.leftPerpendicularThis();const v=h[0].clone(),x=h[1].clone(),w=h[2].clone(),T=x.sub(v),C=w.sub(v),M=w.sub(x),A=m[0],I=m[1],L=m[2],D=A*I,O=A*L,U=I*L,$=T.dotProduct(_)*D,B=C.dotProduct(_)*O;let V=$,H=B-2*$,Y=M.dotProduct(_)*U+B-B;const W=st(13,Number.NaN),ee=st(13,Number.NaN);let ne=y1(Y,H,V,Me.unit(),!1,W);ne<0&&(W[0]=0,W[1]=1,ne=2);let j=0;for(let fe=0,Ne=j;fe<ne;++fe){const je=new N;kn(h,m,W[fe+Ne],je),ee[j]=i.getClosestCoordinate(je,!1),N.distance(je,i.getCoord2D(ee[j]))<=o&&(W[j]=W[fe+Ne],j++)}const oe=he(N,3),ve=he(N,3);if(e.queryControlPoints(ve),ve[0].subThis(i.getStartXY()),ve[1].subThis(i.getStartXY()),ve[2].subThis(i.getStartXY()),gLe(ve,m,oe,!1),Math.abs(f.x)>=Math.abs(f.y)){const fe=f.y/f.x;Y=oe[2].y-oe[2].x*fe,H=oe[1].y-oe[1].x*fe,V=oe[0].y-oe[0].x*fe}else{const fe=f.x/f.y;Y=oe[2].x-oe[2].y*fe,H=oe[1].x-oe[1].y*fe,V=oe[0].x-oe[0].y*fe}const Ye=e.getEndXY().equals(i.getStartXY())||e.getEndXY().equals(i.getEndXY()),de=[0,0];ne=y1(Y,H,V,Me.unit(),Ye,de);for(let fe=0,Ne=j;fe<ne;++fe){W[fe+Ne]=de[fe];const je=new N;kn(h,m,W[fe+Ne],je),ee[j]=i.getClosestCoordinate(je,!1),N.distance(je,i.getCoord2D(ee[j]))<=o&&(W[j]=W[fe+Ne],j++)}z(j<W.length+4);for(let fe=0;fe<j;fe++)W[fe]=dS(d,W[fe]);ne=e.intersectPoint(i.getStartXY(),de,o);for(let fe=0;fe<ne;fe++)W[j]=de[fe],ee[j++]=0;ne=e.intersectPoint(i.getEndXY(),de,o);for(let fe=0;fe<ne;fe++)W[j]=de[fe],ee[j++]=1;ne=i.intersectPoint(e.getStartXY(),de,o);for(let fe=0;fe<ne;fe++)ee[j]=de[fe],W[j++]=0;ne=i.intersectPoint(e.getEndXY(),de,o);for(let fe=0;fe<ne;fe++)ee[j]=de[fe],W[j++]=1;return j===0?0:Iu(t,e,i,W,ee,j,s,n,r,o,a,l,u)}function GG(t,e,i,s,n,r,o,a,l,u){if(Us(i))return b1(t,e,new mi({start:i.getStartXY(),end:i.getEndXY()}),s,n,r,o,a,l,u);const c=hl(e,i);if(Au(e,i,o=Math.max(o,c)))return 0;const h=[],d=[],m=he(N,4);{e.queryControlPoints(m);const _=he(N,4),v=new Gi;i.canonicToWorldTransformation(v);const x=new Gi;x.setInvert(v),x.transformPoints2D(m,4,_);const w=he(nt,3),T=he(nt,3),C=he(nt,3),M=[0,0,0];e.queryWeights(M),qP(_,M,w,T,C);const A=he(nt,3);A[0].setDouble(i.getSemiMinorAxis()),A[0].sqrThis(),A[1].setDouble(i.getSemiMajorAxis()),A[1].sqrThis(),A[2].setThis(A[0]),A[2].mulThis(A[1]),A[2].negateThis();const I=G7(w,2,T,2,C,2,A,!0,Me.unit(),Me.unit(),h);if(I>0){let L=0;for(let D=0;D<I;D++){const O=new N;e.queryCoord2D(h[D],O);const U=i.getClosestCoordinate(O,!1),$=new N;i.queryCoord2D(U,$),N.distance(O,$)<=o&&(h[L]=h[D],d.push(U),L++)}h.length=L}}const f=[0,1];for(let _=0;_<2;_++){const v=_===0?i.getStartXY():i.getEndXY(),x=aL(e,v,Me.unit(),!1,-1),w=new N;e.queryCoord2D(x,w),N.distance(v,w)<=o&&(h.push(x),d.push(f[_]))}for(let _=0;_<2;_++){const v=[0,3];{const x=i.getClosestCoordinate(m[v[_]],!1),w=new N;i.queryCoord2D(x,w),N.distance(m[v[_]],w)<=o&&(h.push(f[_]),d.push(x))}}return Iu(t,e,i,h,d,h.length,s,n,r,o,a,l,u)}function BP(t,e,i,s,n,r,o,a,l,u){const c=he(N,3);e.queryControlPoints(c);const h=he(N,3);if(i.queryControlPoints(h),V7(c,h,3)<0)return BP(t,i,e,s,r,n,o,a,l,!u);const d=hl(e,i);if(e.isDegenerateToLineHelper(d)){const A=new mi({start:e.getStartXY(),end:e.getEndXY()}),I=b1(t,i,A,s,r,n,o,a,l,!u);if(n)for(let L=0;L<I;++L){const D=A.getCoord2D(n[L]);n[L]=e.getClosestCoordinate(D,!1)}return I}if(i.isDegenerateToLineHelper(d)){const A=new mi({start:i.getStartXY(),end:i.getEndXY()}),I=b1(t,e,A,s,n,r,o,a,l,u);if(r)for(let L=0;L<I;++L){const D=A.getCoord2D(r[L]);r[L]=i.getClosestCoordinate(D,!1)}return I}if(Au(e,i,o=Math.max(o,d)))return 0;const m=st(3,Number.NaN);e.queryWeights(m);const f=st(3,Number.NaN);i.queryWeights(f);const _=[1,oh(m),1],v=[1,oh(f),1],x=new Me(0,1),w=new Me(0,1);{const A=ua.constructEmpty();GP(c,_,new Me(0,1),A);const I=ua.constructEmpty();GP(h,v,new Me(0,1),I);const L=Math.max(A.maxDim(),I.maxDim());if(A.inflate(3*o),I.inflate(3*o),!A.intersectW(I))return 0;if(A.maxDim()<.1*L){if(HG(c,_,A,x),HG(h,v,A,w),x.isEmpty()||w.isEmpty())return 0;wy(c,_,x.vmin,x.vmax,c,_),wy(h,v,w.vmin,w.vmax,h,v)}}const T=iE(c,2,h,2,o);if(T===0)return 0;const C=[],M=[];if(T===-1){const A=he(nt,3),I=he(nt,3),L=he(nt,3);qP(c,_,A,I,L);const D=he(nt,3),O=he(nt,3),U=he(nt,3);qP(h,v,D,O,U);const $=[],B=[],V=eE(A,2,I,2,L,2,D,2,O,2,U,2,!0,Me.unit(),Me.unit(),$,B);if(V>0)for(let H=0;H<V;H++){const Y=new N;kn(h,v,B[H],Y);const W=new N;kn(c,_,$[H],W),N.distance(W,Y)<=o&&(C.push($[H]),M.push(B[H]))}}for(let A=0;A<2;A++){let I,L,D;A===0?(I=c,L=h,D=v):(I=h,L=c,D=_);for(let O=0;O<2;O++){const U=O===0?0:I.length-1,$=new N,B=[0],V=B7(L,D,I[U],Me.unit(),!1,-1,1,B);z(V===1),kn(L,D,B[0],$),N.distance(I[U],$)<=o&&(A===0?(C.push(U===0?0:1),M.push(B[0])):(M.push(U===0?0:1),C.push(B[0])))}}if(C.length===0)return 0;if(!x.equalsRange(0,1))for(let A=0;A<C.length;++A)C[A]=il.recalculateParentT(x.vmin,x.vmax,C[A]);if(!w.equalsRange(0,1))for(let A=0;A<M.length;++A)M[A]=il.recalculateParentT(w.vmin,w.vmax,M[A]);for(let A=0;A<C.length;++A)C[A]=dS(m,C[A]);for(let A=0;A<M.length;++A)M[A]=dS(f,M[A]);return Iu(t,e,i,C,M,C.length,s,n,r,o,a,l,u)}function BG(t,e,i,s,n,r,o,a,l,u){if(e.isLine())return WP(t,i,new mi({start:e.getStartXY(),end:e.getEndXY()}),s,r,n,o,a,l,!u);if(i.isLine())return b1(t,e,new mi({start:i.getStartXY(),end:i.getEndXY()}),s,n,r,o,a,l,u);const c=hl(e,i);if(Au(e,i,o=Math.max(o,c)))return 0;const h=he(N,3);e.queryControlPoints(h);const d=he(N,3);i.queryControlPoints(d);const m=iE(h,2,d,2,o);if(m===0)return 0;const f=[],_=[];if(m===-1){const v=he(nt,3),x=he(nt,3),w=he(nt,3),T=[0,0,0];e.queryWeights(T),qP(h,T,v,x,w);const C=he(ln,3);mS(d,C);const M=eE(v,2,x,2,w,2,[C[0].x,C[1].x,C[2].x],2,[C[0].y,C[1].y,C[2].y],2,null,0,!0,Me.unit(),Me.unit(),f,_);if(M>0){let A=0;for(let I=0;I<M;I++){const L=new N;i.queryCoord2D(_[I],L);const D=new N;e.queryCoord2D(f[I],D),N.distance(D,L)<=o&&(f[A]=f[I],_[A]=_[I],A++)}f.length=A,_.length=A}}for(let v=0;v<2;v++){let x;x=v===0?h:d;for(let w=0;w<2;w++){const T=w===0?0:x.length-1;let C;const M=new N;v===0?(C=uL(i,x[T],Me.unit(),!1),i.queryCoord2D(C,M)):(C=aL(e,x[T],Me.unit(),!1,-1),e.queryCoord2D(C,M)),N.distance(x[T],M)<=o&&(v===0?(f.push(T===0?0:1),_.push(C)):(_.push(T===0?0:1),f.push(C)))}}return Iu(t,e,i,f,_,f.length,s,n,r,o,a,l,u)}function gLe(t,e,i,s=!1){const n=he(N,3);s?(n[0].setCoordsPoint2D(t[0]),n[1].setCoordsPoint2D(t[1]),n[1].subThis(n[0]),n[2].setCoordsPoint2D(t[2]),n[2].subThis(n[0]),n[0].setCoords(0,0)):(n[0].setCoordsPoint2D(t[0]),n[1].setCoordsPoint2D(t[1]),n[2].setCoordsPoint2D(t[2])),n[0].mulThis(e[0]),n[1].mulThis(e[1]),n[2].mulThis(e[2]),i[1].setCoords(n[1].x-n[0].x,n[1].y-n[0].y),i[2].setCoordsPoint2D(n[2].sub(n[1])),i[2].subThis(i[1]),i[1].x*=2,i[1].y*=2,i[0].setCoordsPoint2D(n[0])}function qP(t,e,i,s,n){const r=nt.constructDouble(e[0]),o=nt.constructDouble(e[1]),a=nt.constructDouble(e[2]);i[0].setDouble(t[0].x),i[0].mulThis(r),i[1].setDouble(t[1].x),i[1].mulThis(o),i[2].setDouble(t[2].x),i[2].mulThis(a),i[2].subThis(i[1]),i[1].subThis(i[0]),i[2].subThis(i[1]),i[1].ldexpThis(1),s[0].setDouble(t[0].y),s[0].mulThis(r),s[1].setDouble(t[1].y),s[1].mulThis(o),s[2].setDouble(t[2].y),s[2].mulThis(a),s[2].subThis(s[1]),s[1].subThis(s[0]),s[2].subThis(s[1]),s[1].ldexpThis(1),n[0].setDouble(e[0]),n[1].setDouble(e[1]),n[2].setThis(n[1]),n[2].ldexpThis(1),n[2].negateThis(),n[2].addThis(n[0]),n[2].addDoubleThis(e[2]),n[1].subThis(n[0]),n[1].ldexpThis(1)}function Vpe(t,e,i){for(let s=0;s<3;++s)i[s].setCoordsPoint2DZ(t[s].mul(e[s]),e[s])}function zpe(t,e,i,s){if(i===0)return s.assign(t[0]),e[0];if(i===1)return s.assign(t[2]),e[2];const n=[t[0].x*e[0],t[1].x*e[1],t[2].x*e[2]],r=[t[0].y*e[0],t[1].y*e[1],t[2].y*e[2]],o=[e[0],e[1],e[2]],a=i;let l,u,c;if(i<=.5){const h=Ro(n[0],n[1],a),d=Ro(n[1],n[2],a);l=es(h,d,a);const m=Ro(r[0],r[1],a),f=Ro(r[1],r[2],a);u=es(m,f,a);const _=Ro(o[0],o[1],a),v=Ro(o[1],o[2],a);c=Ro(_,v,a)}else{const h=Xr(n[0],n[1],a),d=Xr(n[1],n[2],a);l=Xr(h,d,a);const m=Xr(r[0],r[1],a),f=Xr(r[1],r[2],a);u=Xr(m,f,a);const _=Xr(o[0],o[1],a),v=Xr(o[1],o[2],a);c=Xr(_,v,a)}return l/=c,u/=c,s.setCoords(l,u),q7(t,s),c}function _Le(t,e,i){const s=he(N,3);t.queryControlPoints(s);const n=[0,0,0];t.queryWeights(n),yLe([Et.constructPoint2D(s[0]),Et.constructPoint2D(s[1]),Et.constructPoint2D(s[2])],[new ge(n[0]),new ge(n[1]),new ge(n[2])],e,i)}function yLe(t,e,i,s){if(i.value()===0)return void s.setE(t[0]);if(i.value()===1)return void s.setE(t[2]);const n=[t[0].x.mulE(e[0]),t[1].x.mulE(e[1]),t[2].x.mulE(e[2])],r=[t[0].y.mulE(e[0]),t[1].y.mulE(e[1]),t[2].y.mulE(e[2])],o=[e[0].clone(),e[1].clone(),e[2].clone()],a=new ge,l=new ge,u=new ge;if(i.value()<=.5){const h=$c(n[0],n[1],i),d=$c(n[1],n[2],i);a.setE($c(h,d,i));const m=$c(r[0],r[1],i),f=$c(r[1],r[2],i);l.setE($c(m,f,i));const _=$c(o[0],o[1],i),v=$c(o[1],o[2],i);u.setE($c(_,v,i))}else{const h=Uc(n[0],n[1],i),d=Uc(n[1],n[2],i);a.setE(Uc(h,d,i));const m=Uc(r[0],r[1],i),f=Uc(r[1],r[2],i);l.setE(Uc(m,f,i));const _=Uc(o[0],o[1],i),v=Uc(o[1],o[2],i);u.setE(Uc(_,v,i))}a.divThisE(u),l.divThisE(u);const c=new N(a.value(),l.value());q7([t[0].value(),t[1].value(),t[2].value()],c),s.x.set(c.x,a.eps()),s.y.set(c.y,l.eps())}function qG(t,e){return e.setCoords(t.x/t.z,t.y/t.z),t.z}function kn(t,e,i,s,n){if(n){if(i<0)return void Rl(new mi({start:t[0],end:t[0].add(VG(t,e,0).getUnitVector())}),i,s);if(i>1)return void Rl(new mi({start:t[2],end:t[2].add(VG(t,e,1).getUnitVector())}),i-1,s)}zpe(t,e,i,s)}function HG(t,e,i,s){s.setEmpty();const n=[];n.push(new Me(0,1));const r=.5*Math.max(i.width(),i.height());for(;n.length;){const o=n.at(-1);n.pop();const a=new ua;if(GP(t,e,o,a),a.isIntersectingW(i)){const l=Math.max(a.width(),a.height());if(i.containsW(a)||l<=r||o.width()<1e-12)s.merge(o);else{const u=o.getCenter();n.push(Me.construct(o.vmin,u)),n.push(Me.construct(u,o.vmax))}}}}function oh(t){return t[1]/Math.sqrt(t[0]*t[2])}function dS(t,e){const i=Math.sqrt(t[2]/t[0]);return e/es(i,1,e)}function HP(t,e){const i=Math.sqrt(t[0]/t[2]);return e/es(i,1,e)}function jG(t,e,i,s){z(e>=0&&e<=1),new gi().setCoordsPoint3D(t[0]),new gi().setCoordsPoint3D(t[1]),new gi().setCoordsPoint3D(t[2]);const n=new gi,r=new gi,o=new gi;jT(3,t[0],t[1],e,n),jT(3,t[1],t[2],e,r),jT(3,n,r,e,o);const a=t[2].clone();i&&(i[0].assign(t[0]),i[1].assign(n),i[2].assign(o)),s&&(s[0].assign(o),s[1].assign(r),s[2].assign(a))}function YG(t,e,i,s){const n=[t[0],t[1],t[2]];z(e>=0&&e<=1&&i!==s);const r=es(n[0],n[1],e),o=es(n[1],n[2],e),a=es(r,o,e);i&&(i[0]=n[0],i[1]=r,i[2]=a),s&&(s[0]=a,s[1]=o,s[2]=n[2])}function q7(t,e){const i=Me.constructEmpty();i.vmin=i.vmax=t[0].x,i.mergeNeCoordinate(t[1].x),i.mergeNeCoordinate(t[2].x),e.x=Os(e.x,i.vmin,i.vmax),i.vmin=i.vmax=t[0].y,i.mergeNeCoordinate(t[1].y),i.mergeNeCoordinate(t[2].y),e.y=Os(e.y,i.vmin,i.vmax)}function XG(t,e){const i=new Me;i.vmin=i.vmax=t[0].x,i.mergeNeCoordinate(t[1].x),i.mergeNeCoordinate(t[2].x),e[0].x=Os(e[0].x,i.vmin,i.vmax),e[1].x=Os(e[1].x,i.vmin,i.vmax),e[2].x=Os(e[2].x,i.vmin,i.vmax),i.vmin=i.vmax=t[0].y,i.mergeNeCoordinate(t[1].y),i.mergeNeCoordinate(t[2].y),e[0].y=Os(e[0].y,i.vmin,i.vmax),e[1].y=Os(e[1].y,i.vmin,i.vmax),e[2].y=Os(e[2].y,i.vmin,i.vmax)}let vLe=class{constructor(){this.area=Number.NaN,this.centroid_x=Number.NaN,this.centroid_y=0,this.specialPoints=[],this.specialPointsLength=[]}specialPointsCount(){return this.specialPoints.length}},xLe=class{constructor(e,i){this.b=e,this.len=i}getMaxDerivative(){return 1}getValue(e,i){return e===0?this.len-lL(this.b,i,!1):0}getError(e){return z(0),0}};function bLe(t,e,i,s,n){let r=!0;const o=he(N,3);t.queryControlPoints(o);let a=r?0:1,l=o[1][a]-o[0][a],u=o[2][a]-o[0][a];const c=hS(5,e,i,s,n,d=>{let m;if(d<=.5){const f=Ro(0,l,d),_=Ro(l,u,d);m=Ro(f,_,d)}else{const f=Xr(0,l,d),_=Xr(l,u,d);m=Xr(f,_,d)}return m*jP(o,1,d).length()});r=!1,a=r?0:1,l=o[1][a]-o[0][a],u=o[2][a]-o[0][a];const h=hS(5,e,i,s,n,d=>{let m;if(d<=.5){const f=Ro(0,l,d),_=Ro(l,u,d);m=Ro(f,_,d)}else{const f=Xr(0,l,d),_=Xr(l,u,d);m=Xr(f,_,d)}return m*jP(o,1,d).length()});return new N(c,h)}function $D(t){t.m_cachedValues=null}function wLe(t,e){e.m_cachedValues=Ge(t.m_cachedValues,t.m_cachedValues=e.m_cachedValues)}function WG(t){if(t.m_cachedValues)return t.m_cachedValues;const e=new vLe;return Gpe(t,e.specialPoints),Hpe(t,e),e}function Gpe(t,e){const i=he(N,3);t.queryControlPoints(i);const s=he(ge,8);s[0].set(0);let n=1;{const r=he(ge,3);RLe(i,r,!1);const o=he(ge,2),a=new Me(0,1);let l=UP(r[2].mul(2),r[1],a,o[0]);l<0&&(l=0);for(let u=0;u<l;u++)Vs(o[u].value(),0,1)||(s[n]=o[u],n++)}{const r=he(ge,3);OLe(i,r,!1);const o=he(ge,2),a=new Me(0,1);let l=UP(r[2].mul(2),r[1],a,o[0]);l<0&&(l=0);for(let u=0;u<l;u++)Vs(o[u].value(),0,1)||(s[n]=o[u],n++)}if(s[n].set(1),n++,n>2){wd(s,0,n,(l,u)=>l.value()-u.value());let r=0,o=s[0].value(),a=1;for(let l=1;l<n;l++)s[l].eq(s[l-1])?(o+=s[l].value(),a++):(a>1&&(o/=a,s[r].set(o)),r++,s[r]=s[l],o=s[l].value(),a=1);r++,n=r}s[0].set(0),s[n-1].set(1),e.length=n;for(let r=0;r<n;r++)e[r]=s[r].value()}function lL(t,e,i){const s=he(N,3);return t.queryControlPoints(s),Bpe(s,e,i)}function Bpe(t,e,i){if(i){if(e<0)return e;if(e>1)return e-1+Bpe(t,1,!1)}if(e===1)return UJ(t);const s=he(N,3);return KG(t,e,s,null),UJ(s)}function UJ(t){if(t[0].equals(t[1]))return N.distance(t[2],t[0]);if(t[1].equals(t[2]))return N.distance(t[0],t[2]);const e=N.distance(t[0],t[1])+N.distance(t[2],t[1]),i=N.distance(t[0],t[2]);if(e-i<=e*Number.EPSILON)return i;const s=1,n=he(N,3);j7(t,n,!0);const r=4*(Di(n[2].x)+Di(n[2].y)),o=2*(n[2].x*n[1].x+n[2].y*n[1].y),a=Di(n[1].x)+Di(n[1].y);if(1e-14*(Math.abs(o)+Math.abs(a))>=Math.abs(r))return 1e-14*Math.abs(a)>=Math.abs(o)?Math.sqrt(a)*s:2/(3*o)*(Math.pow(o*s+a,1.5)-Math.pow(a,1.5));const l=o/r,u=a/r,c=u-l*l,h=s+l;if(c===0)return l>=0&&h>=0||l<=0&&h<=0?Math.abs(.5*Math.sqrt(r)*(h*h-l*l)):.5*Math.sqrt(r)*(h*h+l*l);const d=Math.sqrt(c+h*h),m=Math.sqrt(u);return .5*Math.sqrt(r)*(h*d-l*m+c*Math.log(Math.abs((h+d)/(l+m))))}function VJ(t,e){const i=Os(e,0,1);let s=jP(t,1,i);return s.isZero()&&(s=jP(t,2,i)),s}function $2(t,e,i){const s=he(N,3);return t.queryControlPoints(s),jP(s,e,i)}function jP(t,e,i){if(e===1){const s=t[1].sub(t[0]).mul(1-i).add(t[2].sub(t[1]).mul(i));return s.mulThis(2),s}return e===2?t[2].sub(t[1]).sub(t[1].sub(t[0]).mul(2)):N.construct(0,0)}function SLe(t,e,i){{const s=Et.constructPoint2D(t[1]).subE(Et.constructPoint2D(t[0])),n=new ge(1).subE(i),r=Et.constructPoint2D(t[2]).subE(Et.constructPoint2D(t[1])),o=s.mulE(n).addE(r.mulE(i));return o.mulThisE(new ge(2)),o}}function ELe(t,e,i){const s=lL(t,1,!1);if(e<=0)return e;if(e>=s)return e-s+1;const n=[0];return zy(new xLe(t,e),Me.unit(),1,n)!==1&&We(""),n[0]}function zJ(t){const e=he(N,3);return t.queryControlPoints(e),qpe(e)}function qpe(t){return-t[1].sub(t[0]).crossProduct(t[2].sub(t[0]))/3}function CLe(t){const e=N.distance(t.getStartXY(),t.getEndXY()),i=t.calculateUpperLength2D();return i-e<=8*Number.EPSILON*i}function GJ(t){return t.m_cachedValues}function Hpe(t,e){t.m_cachedValues=e}function uL(t,e,i,s,n){RP(Me.unit().contains(i),"QuadraticBezierHelper::getClosestCoordinateSegment");const r=he(N,3);t.queryControlPoints(r);let o=Number.MAX_VALUE;const a=[0],l=o4(r,e,a);if(i.containsCoordinate(a[0]))o=N.distance(e,l);else{a[0]=i.vmin,eh(r,a[0],l),o=N.distance(l,e);const u=new N;eh(r,i.vmax,u);const c=N.distance(u,e);o>c&&(l.setCoordsPoint2D(u),a[0]=i.vmax,o=c)}if(!s)return a[0];if(i.vmin<=0){const u=new N;t.queryCoord2DExtended(-1,u,!0);const c=new N;t.queryCoord2D(i.vmin,c);const h=new mi({start:u,end:c}),d=h.getClosestCoordinate(e,!0);if(d<1){const m=h.getCoord2D(d),f=N.distance(m,e);f<o&&(o=f,a[0]=d-1,l.assign(m))}}if(i.vmin>=1){const u=new N;t.queryCoord2DExtended(2,u,!0);const c=new N;t.queryCoord2D(i.vmax,c);const h=new mi({start:c,end:u}),d=h.getClosestCoordinate(e,!0);if(d>0){const m=h.getCoord2D(d),f=N.distance(m,e);f<o&&(o=f,a[0]=1+d,l.assign(m))}}return a[0]}function o4(t,e,i){const s=t[2].sub(t[1]).sub(t[1].sub(t[0])),n=t[1].sub(t[0]),r=t[0].sub(e),o=r.dotProduct(n),a=r.dotProduct(s)+2*n.dotProduct(n),l=3*n.dotProduct(s),u=s.dotProduct(s),c=st(3,Number.NaN),h=Spe(u,l,a,o,Me.unit(),!1,c),d=t[0].clone();let m=0,f=N.sqrDistance(t[0],e),_=N.sqrDistance(t[2],e);_<f&&(m=1,d.assign(t[2]),f=_);for(let v=0;v<h;v++){const x=new N;eh(t,c[v],x),_=N.sqrDistance(x,e),_<f&&(f=_,d.assign(x),m=c[v])}return i&&(i[0]=m),d}function TLe(t,e,i,s,n,r){const o=new ua;if(PLe(t,Me.unit(),o),o.inflate(n),!o.isIntersectingPoint2D(e))return 0;const a=new N,l=uL(t,e,Me.unit(),!1);return t.queryCoord2D(l,a),N.distance(a,e)<=n?(s&&(s[0]=l),1):0}function PLe(t,e,i){const s=he(N,3);t.queryControlPoints(s),YP(s,e,i)}function YP(t,e,i){if(e.equalsRange(0,1))return void i.setFromPoints(t,3);const s=he(N,3);XP(t,e.vmin,e.vmax,s),i.setFromPoints(s,3)}function BJ(t,e,i){i.setEmpty();const s=[];s.push(new Me(0,1));const n=.5*Math.max(e.width(),e.height());for(;s.length;){const r=s.at(-1);s.pop();const o=new ua;if(YP(t,r,o),o.isIntersectingW(e)){const a=Math.max(o.width(),o.height());if(e.containsW(o)||a<=n||r.width()<1e-12)i.merge(r);else{const l=r.getCenter();s.push(Me.construct(r.vmin,l)),s.push(Me.construct(l,r.vmax))}}}}function ZG(t){const e=he(N,3);t.queryControlPoints(e);const i=jpe(e);return i&&(t.m_cp.setCoordsPoint2D(e[1]),t.afterCompletedModification()),i}function jpe(t){let e=!1;for(let i=0;i<2;i++){const s=an(t[0][i],t[2][i]);s>0?(an(t[0][i],t[1][i])<0&&(t[1][i]=t[0][i],e=!0),an(t[1][i],t[2][i])<0&&(t[1][i]=t[2][i],e=!0)):s<0?(an(t[0][i],t[1][i])>0&&(t[1][i]=t[0][i],e=!0),an(t[1][i],t[2][i])>0&&(t[1][i]=t[2][i],e=!0)):t[1][i]!==t[0][i]&&(t[1][i]=t[0][i],e=!0)}return e}function MLe(t,e,i){i===void 0&&(i=e,e=0);const s=new N;if(e<0||i>1)return s.setNAN(),s;if(e>i&&ce("calculate_sub_weighted_centroid"),e===i||t.isDegenerate(0))return s.setCoords(0,0),s;const n=WG(t),r=Em(t),o=Math.min(r/t.calculateUpperLength2D(),1e-7);let a=e,l=0;for(let u=1,c=n.specialPointsCount();u<c;u++)if(e<n.specialPoints[u]){l=u-1;break}s.setCoords(0,0);for(let u=l+1,c=n.specialPointsCount();u<c;u++){const h=Math.min(n.specialPoints[u],i),d=bLe(t,a,h,o,r);if(s.addThis(d),a=h,i<=n.specialPoints[u])break}return s.add(t.getStartXY().mul(t.calculateLength2D()))}function KG(t,e,i,s){new N().setCoordsPoint2D(t[0]),new N().setCoordsPoint2D(t[1]),new N().setCoordsPoint2D(t[2]);const n=new N,r=new N,o=new N;if(zn(t[0],t[1],e,n),zn(t[1],t[2],e,r),zn(n,r,e,o),i&&(i[0].assign(t[0]),i[1].assign(n),i[2].assign(o)),s){const a=t[2];s[0].assign(o),s[1].assign(r),s[2].assign(a)}}function XP(t,e,i,s){if(e===i){const r=new N;return eh(t,e,r),s[0]=r,s[1]=r,void(s[2]=r)}const n=he(N,3);KG(t,i,n,null),KG(n,e/i,null,n),eh(t,e,n[0]),eh(t,i,n[2]),s[0].setCoordsPoint2D(n[0]),s[1].setCoordsPoint2D(n[1]),s[2].setCoordsPoint2D(n[2])}function ALe(t,e,i,s){if(e.isEqual(t.m_XStart,t.m_YStart)&&i.isEqual(t.m_XEnd,t.m_YEnd))return;const n=!!s&&t.isMonotoneQuickAndDirty(),r=new Gi,o=he(N,3);o[0].setCoords(t.m_XStart,t.m_YStart),o[2].setCoords(t.m_XEnd,t.m_YEnd);const a=new N;a.setSub(o[2],o[0]),a.leftPerpendicularThis(),o[1].setAdd(o[0],a);const l=he(N,3);l[0].setCoordsPoint2D(e),l[2].setCoordsPoint2D(i),a.setSub(l[2],l[0]),a.leftPerpendicularThis(),l[1].setAdd(l[0],a),r.setFromTwoTriangles(o,l)?r.transformInPlace(t.m_cp):zn(e,i,.5,t.m_cp),t.changeEndPoints2D(e,i),n&&ZG(t)}function ILe(t){return t.getStartXY().norm(1)+t.getEndXY().norm(1)+t.m_cp.norm(1)}function qJ(t,e,i,s,n){if(n){if(Gl(e,i)!==0)return t?4:2}else if(Mu(e,i))return 1;return WP(t,e,i,null,null,null,s,n??!1,!0,!1)!==0?4:0}function HJ(t,e,i,s,n){if(n){if(Gl(e,i)!==0)return t?4:2}else if(Mu(e,i))return 1;return QG(t,e,i,null,null,null,s,n??!1,!0,!1)!==0?4:0}function DLe(t,e,i,s,n){if(n){if(Gl(e,i)!==0)return 2}else if(Mu(e,i))return 1;return H7(t,e,i,null,null,null,s,n??!1,!0,!1)!==0?4:0}function WP(t,e,i,s,n,r,o,a,l,u){if(n!=null&&(n.length=0),r!==null&&(r.length=0),s!==null&&(s.length=0),i.isDegenerate(0)){const O=[0,0],U=e.intersectPoint(i.getStartXY(),O,o);if(U>0){if(n!==null)for(let $=0;$<U;$++)n.push(O[$]);if(r!==null)for(let $=0;$<U;$++)r.push(0);if(s!==null)for(let $=0;$<U;$++){const B=new N;e.queryCoord2D(O[$],B),s.push(B)}}return U}const c=hl(e,i);if(o=Math.max(o,c),e.isDegenerateToLineHelper(c)){const O=new mi({start:e.getStartXY(),end:e.getEndXY()}),U=n4(O,i,s,n,r,o,a,u);if(n)for(let $=0;$<U;++$){const B=O.getCoord2D(n[$]);n[$]=e.getClosestCoordinate(B,!1)}return U}if(Au(e,i,o))return 0;const h=ln.constructPoint2D(i.getStartXY()),d=ln.constructPoint2D(i.getEndXY()).sub(h),m=d.clone();m.leftPerpendicularThis();const f=ln.constructPoint2D(e.m_cp).sub(ln.constructPoint2D(e.getStartXY())),_=ln.constructPoint2D(e.getEndXY()).sub(ln.constructPoint2D(e.m_cp));let v=f.dotProduct(m).toDouble(),x=_.sub(f).dotProduct(m).toDouble();const w=st(12,Number.NaN),T=st(12,Number.NaN);let C=COe(x,v,Me.unit(),w);C<0&&(w[0]=0,w[1]=1,C=2);let M,A=0;for(let O=0,U=A;O<C;++O){const $=e.getCoord2D(w[O+U]);T[A]=i.getClosestCoordinate($,!1),N.distance($,i.getCoord2D(T[A]))<=o&&(w[A]=w[O+U],A++)}const I=he(N,3);e.queryControlPoints(I);{const O=he(ln,3);if(mS(I,O,!1),O[0]=O[0].sub(h),d.x.abs().gte(d.y.abs())){const U=d.y.div(d.x);x=O[2].y.sub(O[2].x.mul(U)).toDouble(),v=O[1].y.sub(O[1].x.mul(U)).toDouble(),M=O[0].y.sub(O[0].x.mul(U)).toDouble()}else{const U=d.x.div(d.y);x=O[2].x.sub(O[2].y.mul(U)).toDouble(),v=O[1].x.sub(O[1].y.mul(U)).toDouble(),M=O[0].x.sub(O[0].y.mul(U)).toDouble()}}const L=e.getEndXY().equals(i.getStartXY())||e.getEndXY().equals(i.getEndXY()),D=[0,0];C=y1(x,v,M,Me.unit(),L,D);for(let O=0,U=A;O<C;++O){w[O+U]=D[O];const $=e.getCoord2D(w[O+U]);T[A]=i.getClosestCoordinate($,!1),N.distance($,i.getCoord2D(T[A]))<=o&&(w[A]=w[O+U],A++)}z(A<w.length+4),C=e.intersectPoint(i.getStartXY(),D,o);for(let O=0;O<C;O++)w[A]=D[O],T[A++]=0;C=e.intersectPoint(i.getEndXY(),D,o);for(let O=0;O<C;O++)w[A]=D[O],T[A++]=1;C=i.intersectPoint(e.getStartXY(),D,o);for(let O=0;O<C;O++)T[A]=D[O],w[A++]=0;C=i.intersectPoint(e.getEndXY(),D,o);for(let O=0;O<C;O++)T[A]=D[O],w[A++]=0;return A===0?0:Iu(t,e,i,w,T,A,s,n,r,o,a,l,u)}function QG(t,e,i,s,n,r,o,a,l,u){if(Us(i))return WP(t,e,new mi({start:i.getStartXY(),end:i.getEndXY()}),s,n,r,o,a,l,u);const c=hl(e,i);if(Au(e,i,o=Math.max(o,c)))return 0;const h=[],d=[],m=he(N,3);{e.queryControlPoints(m);const _=he(N,3),v=new Gi;i.canonicToWorldTransformation(v);const x=new Gi;x.setInvert(v),x.transformPoints2D(m,3,_);const w=he(ln,3);mS(_,w);const T=[w[0].x,w[1].x,w[2].x],C=[w[0].y,w[1].y,w[2].y],M=he(nt,3);M[0].setDouble(i.getSemiMinorAxis()),M[0].sqrThis(),M[1].setDouble(i.getSemiMajorAxis()),M[1].sqrThis(),M[2]=M[0],M[2].mul(M[1]),M[2].negate();const A=G7(T,2,C,2,null,0,M,!0,Me.unit(),Me.unit(),h);if(A>0){let I=0;for(let L=0;L<A;L++){const D=new N;e.queryCoord2D(h[L],D);const O=i.getClosestCoordinate(D,!1),U=new N;i.queryCoord2D(O,U),N.distance(D,U)<=o&&(h[I]=h[L],d.push(O),I++)}h.length=I}}const f=[0,1];for(let _=0;_<2;_++){const v=_===0?i.getStartXY():i.getEndXY(),x=[0];o4(m,v,x);const w=new N;eh(m,x[0],w),N.distance(v,w)<=o&&(h.push(x[0]),d.push(f[_]))}for(let _=0;_<2;_++){const v=[0,2];{const x=i.getClosestCoordinate(m[v[_]],!1),w=new N;i.queryCoord2D(x,w),N.distance(m[v[_]],w)<=o&&(h.push(f[_]),d.push(x))}}return Iu(t,e,i,h,d,h.length,s,n,r,o,a,l,u)}function H7(t,e,i,s,n,r,o,a,l,u){const c=he(N,3);e.queryControlPoints(c);const h=he(N,3);if(i.queryControlPoints(h),V7(c,h,3)<0)return H7(t,i,e,s,r,n,o,a,l,!u);const d=hl(e,i);if(Au(e,i,o=Math.max(o,d)))return 0;if(GLe(e,i,s,n,r,o,a,l,u))return 2;const m=new Me(0,1),f=new Me(0,1);{const w=new ua;YP(c,Me.unit(),w);const T=new ua;YP(h,Me.unit(),T);const C=Math.max(w.maxDim(),T.maxDim());if(w.inflate(3*o),T.inflate(3*o),!w.intersectW(T))return 0;if(w.maxDim()<.1*C){if(BJ(c,w,m),BJ(h,w,f),m.isEmpty()||f.isEmpty())return 0;XP(c,m.vmin,m.vmax,c),XP(h,f.vmin,f.vmax,h)}}const _=iE(c,2,h,2,o);if(_===0)return 0;const v=[],x=[];if(_===-1){const w=he(ln,3);mS(c,w);const T=[w[0].x,w[1].x,w[2].x],C=[w[0].y,w[1].y,w[2].y],M=he(ln,3);mS(h,M);const A=eE(T,2,C,2,null,0,[M[0].x,M[1].x,M[2].x],2,[M[0].y,M[1].y,M[2].y],2,null,0,!0,Me.unit(),Me.unit(),v,x,u);if(A>0){let I=0;for(let L=0;L<A;L++){const D=new N,O=new N;eh(h,x[L],O),eh(c,v[L],D),N.distance(D,O)<=o&&(v[I]=v[L],x[I]=x[L],I++)}v.length=I,x.length=I}}for(let w=0;w<2;w++){const T=w===0?c:h,C=w===0?h:c;for(let M=0;M<2;M++){const A=M===0?0:2,I=[0];o4(C,T[A],I);const L=new N;eh(C,I[0],L),N.distance(T[A],L)<=o&&(w===0?(v.push(A===0?0:1),x.push(I[0])):(x.push(A===0?0:1),v.push(I[0])))}}if(v.length===0)return 0;if(!m.equalsRange(0,1))for(let w=0;w<v.length;++w)v[w]=v1.recalculateParentT(m.vmin,m.vmax,v[w]);if(!f.equalsRange(0,1))for(let w=0;w<x.length;++w)x[w]=v1.recalculateParentT(f.vmin,f.vmax,x[w]);return Iu(t,e,i,v,x,v.length,s,n,r,o,a,l,u)}function j7(t,e,i=!1){const s=t[1].sub(t[0]);e[1].assign(s.mul(2)),e[2].assign(t[2].sub(t[1]).sub(s)),i?e[0].setCoords(0,0):e[0].assign(t[0])}function NLe(t,e,i=!1){const s=he(N,3);t.queryControlPoints(s),j7(s,e,i)}function RLe(t,e,i=!1){const n=new ge(t[1][0]).subE(new ge(t[0][0]));e[1]=n.mul(2),e[2]=new ge(t[2][0]).subE(new ge(t[1][0])).subE(n),i?e[0].set(0):e[0].set(t[0][0])}function OLe(t,e,i=!1){const n=new ge(t[1][1]).subE(new ge(t[0][1]));e[1]=n.mul(2),e[2]=new ge(t[2][1]).subE(new ge(t[1][1])).subE(n),i?e[0].set(0):e[0].set(t[0][1])}function mS(t,e,i=!1){const s=ln.constructPoint2D(t[1]),n=s.sub(ln.constructPoint2D(t[0]));e[1]=n.mul(nt.constructInt32(2)),e[2]=ln.constructPoint2D(t[2]).sub(s).sub(n),e[0]=i?new ln(sa,sa):ln.constructPoint2D(t[0])}function eh(t,e,i,s){if(s){if(e<0)return void Rl(new mi({start:t[0],end:t[0].add(VJ(t,0).getUnitVector())}),e,i);if(e>1)return void Rl(new mi({start:t[2],end:t[2].add(VJ(t,1).getUnitVector())}),e-1,i)}if(e<=.5){const n=t[1].clone(),r=new N;tr(2,t[0],n,e,r);const o=new N;tr(2,n,t[2],e,o);const a=new N;tr(2,r,o,e,a),i.assign(a)}else{const n=t[1].clone(),r=new N;ir(2,t[0],n,e,r);const o=new N;ir(2,n,t[2],e,o);const a=new N;ir(2,r,o,e,a),i.assign(a)}}function LLe(t,e,i){const s=he(N,3);t.queryControlPoints(s),FLe(s,e,i)}function FLe(t,e,i){if(e.value()<=.5){const s=Et.constructPoint2D(t[1]),n=new Et;tc(2,Et.constructPoint2D(t[0]),s,e,n);const r=new Et;tc(2,s,Et.constructPoint2D(t[2]),e,r);const o=new Et;tc(2,n,r,e,o),i.setE(o)}else{const s=Et.constructPoint2D(t[1]),n=new Et;ic(2,Et.constructPoint2D(t[0]),s,e,n);const r=new Et;ic(2,s,Et.constructPoint2D(t[2]),e,r);const o=new Et;ic(2,n,r,e,o),i.setE(o)}}function kLe(t,e,i){const s=he(N,4);t.queryControlPoints(s),$Le(s,e,i)}function $Le(t,e,i){e.value()<0&&e.set(0,e.eps()),e.value()>1&&e.set(1,e.eps()),i.setE(SLe(t,1,e))}function ULe(t,e){e[0].assign(t[0]),e[3].assign(t[2]),zn(t[0],t[1],2/3,e[1]),zn(t[1],t[2],1/3,e[2])}function VLe(t,e){const i=he(N,3);t.queryControlPoints(i);const s=N.sqrDistance(i[1],i[0]),n=N.sqrDistance(i[1],i[2]);let r=i[0].clone(),o=s;s>n&&(r=i[2].clone(),o=n);let a=!1;return o<=e&&o!==0&&(a=!0,t.setControlPoint1(r)),a}function zLe(t,e){if(!e)return!1;const i=he(N,3);t.queryControlPoints(i);const s=N.sqrDistance(i[1],i[0]),n=N.sqrDistance(i[1],i[2]);i[0].clone();let r=s;return s>n&&(i[2].clone(),r=n),r<=e&&r!==0}function GLe(t,e,i,s,n,r,o,a,l){const u=he(N,3);t.queryControlPoints(u);const c=he(N,3);if(e.queryControlPoints(c),u[0].equals(c[0])){if(u[1].equals(c[1])&&u[2].equals(c[2]))return i&&(i.length=0,i.push(u[0]),i.push(u[2])),s&&(s.length=0,s.push(0),s.push(1)),n&&(n.length=0,n.push(0),n.push(1)),!0;if(!u[0].equals(c[2]))return!1}return!!(u[0].equals(c[2])&&u[1].equals(c[1])&&u[2].equals(c[0]))&&(s&&(s.length=0,s.push(0),s.push(1),l&&(s[1]=Ge(s[0],s[0]=s[1]))),n&&(n.length=0,n.push(1),n.push(0),l&&(n[1]=Ge(n[0],n[0]=n[1]))),i&&(i.length=0,i.push(u[0]),i.push(u[2]),l&&(i[1]=Ge(i[0],i[0]=i[1]))),!0)}var UD=Hs;let hc=class Ype extends mA{constructor(e){e&&e.cp?(super({start:e.cp[0],end:e.cp[3],vd:e.vd}),this.m_cp=he(N,2),this.m_cp[0].assign(e.cp[1]),this.m_cp[1].assign(e.cp[2])):e===void 0||KF(e,"vd")?(super({vd:e==null?void 0:e.vd,XStart:0,YStart:0,XEnd:0,YEnd:0}),this.m_cp=he(N,2),this.m_cp[0].setCoords(0,0),this.m_cp[1].setCoords(0,0)):e.from?(super({start:e.from,end:e.to,vd:e.vd}),this.m_cp=he(N,2),this.m_cp[0].assign(e.cp1),this.m_cp[1].assign(e.cp2)):(super({XStart:0,YStart:0,XEnd:0,YEnd:0,vd:e.vd}),We("unrecognized constructor params"),this.m_cp=he(N,2),this.m_cp[0].setCoords(0,0),this.m_cp[1].setCoords(0,0)),this.m_cachedValues=0}getBoundary(){return pd(this)}construct(e,i,s,n){this.m_XStart=e.x,this.m_YStart=e.y,this.m_XEnd=n.x,this.m_YEnd=n.y,this.m_cp[0].assign(i),this.m_cp[1].assign(s),this.afterCompletedModification()}constructPoints(e){this.m_XStart=e[0].x,this.m_YStart=e[0].y,this.m_XEnd=e[3].x,this.m_YEnd=e[3].y,this.m_cp[0].assign(e[1]),this.m_cp[1].assign(e[2]),this.afterCompletedModification()}constructFromQuadratic(e){const i=he(N,4);ULe(e,i),this.constructPoints(i)}constructFromQuadraticSegment(e){this.dropAllAttributes(),this.assignVertexDescription(e.getDescription()),this.m_XStart=e.getStartX(),this.m_YStart=e.getStartY(),this.m_XEnd=e.getEndX(),this.m_YEnd=e.getEndY(),jT(2,e.getStartXY(),e.getControlPoint1(),2/3,this.m_cp[0]),jT(2,e.getControlPoint1(),e.getEndXY(),1/3,this.m_cp[1]),this.afterCompletedModification(),_pe(this,e)}getGeometryType(){return q.enumBezier}queryEnvelope(e){if(e.m_EnvelopeType!==2)return void z(0);if(e.setCoords(this.getStartXY()),e.mergeNe(this.getEndXY()),e.contains(this.m_cp[0])&&e.contains(this.m_cp[1]))return;const i=jJ(this);if(i!==null){const a=new N;for(const l of i.specialPoints)this.queryCoord2D(l,a),e.mergeNe(a);return}const s=he(ge,8),n=he(N,4);this.queryControlPoints(n);const r=sfe(n,s),o=new N;for(let a=1;a<r-1;a++)this.queryCoord2D(s[a].value(),o),e.mergeNe(o)}applyTransformation(e){if(e.m_TransformationType===1){const i=he(N,4);return this.queryControlPoints(i),e.transformPoints2D(i,4,i),this.setStartXY(i[0]),this.m_cp[0].assign(i[1]),this.m_cp[1].assign(i[2]),this.setEndXY(i[3]),void FU(this)}z(0)}createInstance(){return new Ype({vd:this.m_description})}calculateLength2D(){return ZP(this,1,!1)}calculateLowerLength2D(){return N.distance(this.getStartXY(),this.getEndXY())}calculateUpperLength2D(){return N.distance(this.getStartXY(),this.m_cp[0])+N.distance(this.m_cp[0],this.m_cp[1])+N.distance(this.getEndXY(),this.m_cp[1])}queryCoord2D(e,i){return this.queryCoord2DExtends(e,i,!0)}queryCoord2DExtends(e,i,s){const n=he(N,4);this.queryControlPoints(n),xn(n,e,i,s)}queryCoord2DE(e,i){sFe(this,e,i)}getCoordX(e){if(e<0||e>1){const a=new N;return this.queryCoord2DExtends(e,a,!0),a.x}const i=es(this.getStartX(),this.m_cp[0].x,e),s=es(this.m_cp[0].x,this.m_cp[1].x,e),n=es(this.m_cp[1].x,this.getEndX(),e),r=es(i,s,e),o=es(s,n,e);return es(r,o,e)}getCoordY(e){if(e<0||e>1){const a=new N;return this.queryCoord2DExtends(e,a,!0),a.y}const i=es(this.getStartY(),this.m_cp[0].y,e),s=es(this.m_cp[0].y,this.m_cp[1].y,e),n=es(this.m_cp[1].y,this.getEndY(),e),r=es(i,s,e),o=es(s,n,e);return es(r,o,e)}cut(e,i,s){const n=new ii;return this.queryCut(e,i,n,s),n.releaseSegment()}queryCut(e,i,s,n){const r=s.createCubicBezier();if(this.cutBezierIgnoreAttributes(e,i,r),n)return;r.assignVertexDescription(this.m_description);const o=this.m_description.getAttributeCount();if(o>1){for(let a=1;a<o;a++){const l=this.m_description.getSemantics(a),u=UD.getComponentCount(l);for(let c=0;c<u;c++){const h=this.getAttributeAsDbl(e,l,c);r.setStartAttribute(l,c,h)}}for(let a=1;a<o;a++){const l=this.m_description.getSemantics(a),u=UD.getComponentCount(l);for(let c=0;c<u;c++){const h=this.getAttributeAsDbl(i,l,c);r.setEndAttribute(l,c,h)}}}}queryDerivative(e,i){efe(this,e,i)}cutBezierIgnoreAttributes(e,i,s){(e<0||i>1||e>i)&&ce("Cubic_bezier.cut_bezier_ignore_attributes");const n=he(N,4);this.queryControlPoints(n);const r=he(N,4);w1(n,e,i,r),s.setControlPoints(r)}splitBezierIgnoreAttributes(e,i,s){this===i&&this===s&&ce("Cubic_bezier.split_bezier_ignore_attributes");const n=he(N,4);this.queryControlPoints(n);const r=he(N,4),o=he(N,4);QP(n,e,r,o),i&&i.setControlPoints(r),s&&s.setControlPoints(o)}getAttributeAsDbl(e,i,s){if(i===0)return s===0?this.getCoordX(e):this.getCoordY(e);if(e===0)return this.getStartAttributeAsDbl(i,s);if(e===1)return this.getEndAttributeAsDbl(i,s);const n=this.getStartAttributeAsDbl(i,s),r=this.getEndAttributeAsDbl(i,s),o=this.calculateLength2D(),a=o>0?this.tToLength(e)/o:0,l=UD.getInterpolation(i);return aA(l,n,r,a,UD.getDefaultValue(i))}getClosestCoordinate(e,i){const s=[Number.NaN];return hL(this,e,Me.unit(),i,-1,1,s),s[0]}getClosestCoordinateOnInterval(e,i,s=-1){const n=[Number.NaN];return hL(this,e,i,!1,s,1,n)===0?Number.NaN:n[0]}getYMonotonicParts(e,i=!1){return this.getMonotonicParts(e,i)}getMonotonicParts(e,i){e.length<2&&ce("");const s=KP(this);if(s.specialPointsCount()===2&&this.isMonotoneQuickAndDirty())return 0;let n=0;z(e.length>=s.specialPointsCount()-1);for(let r=1,o=s.specialPointsCount();r<o;++r)this.queryCut(s.specialPoints[r-1],s.specialPoints[r],e[n],i),n++;for(let r=0;r<n;++r)cL(e[r].get());return n}intersectionWithAxis2D(e,i,s,n){const r=he(N,4);return this.queryControlPoints(r),dFe(r,e,i,s,n)}intersectionOfYMonotonicWithAxisX(e,i){if(this.m_YStart===this.m_YEnd)return e===this.m_YStart?i:Number.NaN;if(e===this.m_YStart)return this.m_XStart;if(e===this.m_YEnd)return this.m_XEnd;const s=[0,0],n=this.intersectionWithAxis2D(!0,e,s,null);return z(n!==2),n===-1?i:s[0]}isCurve(){return!0}isDegenerate(e){return s4(this,e)}isDegenerate3D(e,i){return z(0),!1}queryLooseEnvelope(e){if(e.m_EnvelopeType===2)return e.setCoords({pt:this.getStartXY()}),e.mergeNe(this.m_cp[0]),e.mergeNe(this.m_cp[1]),void e.mergeNe(this.getEndXY());z(0)}clone(e){const i=this.createInstance();return this.copyTo(i),i}queryInterval(e,i){if(e===0){const s=J.constructEmpty();this.queryEnvelope(s);const n=Me.constructEmpty();return i===0?s.queryIntervalX(n):s.queryIntervalY(n),n}return super.queryInterval(e,i)}queryLooseEnvelopeOnInterval(e,i){const s=he(N,4);this.queryControlPoints(s),w1(s,e.vmin,e.vmax,s),i.setFromPoints(s,4)}changeEndPoints2D(e,i){if(e.isEqual(this.m_XStart,this.m_YStart)&&i.isEqual(this.m_XEnd,this.m_YEnd))return;const s=this.m_cp[0].isEqual(this.m_XStart,this.m_YStart),n=this.m_cp[0].isEqual(this.m_XEnd,this.m_YEnd),r=this.m_cp[1].isEqual(this.m_XStart,this.m_YStart),o=this.m_cp[1].isEqual(this.m_XEnd,this.m_YEnd);this.setStartXY(e),this.setEndXY(i),s?this.m_cp[0].setCoordsPoint2D(e):n&&this.m_cp[0].setCoordsPoint2D(i),o?this.m_cp[1].setCoordsPoint2D(i):r&&this.m_cp[1].setCoordsPoint2D(e),this.normalizeAfterEndpointChange()}tToLength(e){return ZP(this,e,!0)}lengthToT(e){return jLe(this,e)}calculateWeightedAreaCentroid2D(e){const i=he(N,4);Wpe(this,i);const s=i[3],n=i[2],r=i[1],o=new N;o.x=(5*s.x*s.x*(7*n.y+16*r.y)+s.x*(-35*s.y*n.x+40*n.x*n.y-80*s.y*r.x+140*n.x*r.y+112*r.x*r.y)-2*(s.y*(20*n.x*n.x+70*n.x*r.x+56*r.x*r.x)-7*(4*n.x+5*r.x)*(-n.y*r.x+n.x*r.y)))/840,o.y=(-5*s.y*s.y*(7*n.x+16*r.x)+s.y*(5*s.x*(7*n.y+16*r.y)-4*(10*n.x*n.y+35*n.y*r.x+28*r.x*r.y))+2*(-7*(4*n.y+5*r.y)*(n.y*r.x-n.x*r.y)+s.x*(20*n.y*n.y+70*n.y*r.y+56*r.y*r.y)))/840;const a=YJ(this);return o.x+=(i[0].x-e.x)*a,o.y+=(i[0].y-e.y)*a,o}calculateWeightedCentroid2D(){const e=new N;return this.isDegenerate(0)?(e.setCoords(0,0),e):HLe(this)?(e.assign(this.getCoord2D(.5).mul(this.calculateLength2D())),e):(e.assign(YLe(this,1)),e)}getControlPoint1(){return this.m_cp[0].clone()}setControlPoint1(e){this.m_cp[0].setCoordsPoint2D(e),this.afterCompletedModification()}getControlPoint2(){return this.m_cp[1].clone()}setControlPoint2(e){this.m_cp[1].setCoordsPoint2D(e),this.afterCompletedModification()}queryControlPoints(e){e[0].assign(this.getStartXY()),e[1].assign(this.m_cp[0]),e[2].assign(this.m_cp[1]),e[3].assign(this.getEndXY())}setControlPoints(e){for(let i=0;i<4;i++)e[i].isNAN()&&ce("NAN control points in bezier are not supported");this.m_XStart=e[0].x,this.m_YStart=e[0].y,this.m_cp[0].setCoordsPoint2D(e[1]),this.m_cp[1].setCoordsPoint2D(e[2]),this.m_XEnd=e[3].x,this.m_YEnd=e[3].y,this.afterCompletedModification()}getTangent(e){const i=he(N,4);return this.queryControlPoints(i),JG(i,e)}getDerivative(e){const i=he(N,4);return this.queryControlPoints(i),Qo(i,1,e)}getCurvature(e){const i=Wv(this,1,e),s=Wv(this,2,e),n=i.sqrLength();return n===0?Number.NaN:(i.divThis(Math.sqrt(n)),i.crossProduct(s)/n)}isIntersectingPoint(e,i,s){if(s&&(e.equals(this.getStartXY())||e.equals(this.getEndXY())))return!1;const n=new J;if(this.queryLooseEnvelope(n),n.inflateCoords(i,i),!n.contains(e))return!1;const r=this.getClosestCoordinate(e,!1),o=new N;return this.queryCoord2D(r,o),N.distance(o,e)<=i}isIntersectingPoint3D(e,i,s,n,r=1){return z(0),!1}isMonotoneQuickAndDirty(){const e=he(N,4);return this.queryControlPoints(e),tFe(e)}getMonotonicPartParams(e,i){const s=KP(this),n=s.specialPointsCount();if(z(dA.s_maxMonotonicPartParams>=n),!i)return s.specialPointsCount();e<n&&ce("");for(let r=0;r<n;r++)i[r]=s.specialPoints[r];return n}normalizeAfterEndpointChange(){return!1}orientBottomUp(){if(this.m_YEnd<this.m_YStart||this.m_YEnd===this.m_YStart&&this.m_XEnd<this.m_XStart){this.m_XEnd=Ge(this.m_XStart,this.m_XStart=this.m_XEnd),this.m_YEnd=Ge(this.m_YStart,this.m_YStart=this.m_YEnd);for(let e=0,i=this.m_description.getTotalComponentCount()-2;e<i;e++)this.m_attributes[e+i]=Ge(this.m_attributes[e],this.m_attributes[e]=this.m_attributes[e+i]);this.m_cp[1]=Ge(this.m_cp[0],this.m_cp[0]=this.m_cp[1]),this.m_cachedValues=null}}findMinDeriv(){const e=new ge;return Jpe(this,e),e.value()}isLine(){return!1}isDegenerateToLineHelper(e){const i=this.getEndXY().sub(this.getStartXY()),s=i.length(),n=.1*e;let r=this.getControlPoint1();r.subThis(this.getStartXY());let o=Math.abs(r.crossProduct(i))/s;return!(o>n)&&(r=this.getControlPoint2(),r.subThis(this.getStartXY()),o=Math.abs(r.crossProduct(i))/s,!(o>n))}copyIgnoreAttributes(e){const i=he(N,4);this.queryControlPoints(i),e.setControlPoints(i)}calculateArea2DHelper(){return YJ(this)}absNorm(){return aFe(this)}queryEnvelopeW(e,i){tfe(this,e,i)}setSegmentFromCoords(e,i){uFe(this,e,i)}writeInBufferStream(e,i){const s=new Float64Array(4);return this.writeInBuffer_(s),e.writeRangeFromArray(i,s.length,s,!0,1),i+s.length}writeInBuffer_(e){return e[0]=this.m_cp[0].x,e[1]=this.m_cp[0].y,e[2]=this.m_cp[1].x,e[3]=this.m_cp[1].y,4}readFromBufferStream(e,i){const s=new Float64Array(4);e.queryRange(i,s.length,s,!0,1),this.readFromBuffer_(s)}readFromBuffer_(e){this.m_cp=he(N,2),this.m_cp[0].x=e[0],this.m_cp[0].y=e[1],this.m_cp[1].x=e[2],this.m_cp[1].y=e[3],this.m_cachedValues=null}snapControlPoints(e){const i=he(N,4);this.queryControlPoints(i);const s=(o,a,l)=>{let u=!1;return N.sqrDistance(o,l)<=e&&(u=!o.equals(l),o.setCoordsPoint2D(l),N.sqrDistance(a,l)<=e&&(u||(u=!a.equals(l)),a.setCoordsPoint2D(l))),u},n=s(i[1],i[2],i[0]),r=s(i[2],i[1],i[3]);return(n||r)&&this.setControlPoints(i),n||r}needsSnapControlPoints(e){if(!e)return!1;const i=he(N,4);this.queryControlPoints(i);const s=(o,a,l)=>{let u=!1;return N.sqrDistance(o,l)<=e&&(u=!o.equals(l),o.setCoordsPoint2D(l),N.sqrDistance(a,l)<=e&&(u||(u=!a.equals(l)),a.setCoordsPoint2D(l))),u},n=s(i[1],i[2],i[0]),r=s(i[2],i[1],i[3]);return n||r}calculateSpecialPointsForCracking(e,i){return mFe(this,e,i)}ensureXYMonotone(){return cL(this)}setCoordsForIntersector(e,i,s){WLe(this,e,i,s)}copyToImpl(e){const i=e;i.m_cp[0].assign(this.m_cp[0]),i.m_cp[1].assign(this.m_cp[1]),Qpe(i,jJ(this))}reverseImpl(){this.m_cp[1]=Ge(this.m_cp[0],this.m_cp[0]=this.m_cp[1])}equalsImpl(e){const i=e;return!!this.m_cp[0].equals(i.m_cp[0])&&!!this.m_cp[1].equals(i.m_cp[1])}equalsImplTol(e,i){const s=e;return!!this.m_cp[0].isEqualPoint2D(s.m_cp[0],i)&&!!this.m_cp[1].isEqualPoint2D(s.m_cp[1],i)}swapImpl(e){const i=e;i.m_cp[0]=Ge(this.m_cp[0],this.m_cp[0]=i.m_cp[0]),i.m_cp[1]=Ge(this.m_cp[1],this.m_cp[1]=i.m_cp[1]),XLe(this,i)}afterCompletedModification(){FU(this)}isIntersecting(e,i,s){return tE(!1,this,e,i,s)!==0}intersect(e,i,s,n,r){return q1(!1,this,e,i,s,n,r)}intersectPoint(e,i,s){return oFe(this,e,i,s)}endPointModified(){FU(this)}clearEndPointModified(){}};hc.type=q.enumBezier;let BLe=class{constructor(){this.length=Number.NaN,this.specialPoints=[]}specialPointsCount(){return this.specialPoints.length}};function Xpe(t){return qLe(t.calculateUpperLength2D())}function qLe(t){return 256*cn()*t}function HLe(t){const e=N.distance(t.getStartXY(),t.getEndXY()),i=t.calculateUpperLength2D();return i-e<=8*Number.EPSILON*i}function Wpe(t,e,i=!1){e[1].setCoords(t.m_cp[0].x-t.getStartX(),t.m_cp[0].y-t.getStartY()),e[1].mulThis(3),e[2].setCoords(t.m_cp[1].x-t.m_cp[0].x,t.m_cp[1].y-t.m_cp[0].y),e[2].mulThis(3),e[3]=t.getEndXY().sub(t.getStartXY()),e[3].subThis(e[2]),e[2].subThis(e[1]),i?e[0].setCoords(0,0):e[0]=t.getStartXY()}function Zpe(t,e,i){const s=he(N,4);t.queryControlPoints(s),Y7(s,e,i)}function Kpe(t,e,i){const s=he(N,4);t.queryControlPoints(s),X7(s,e,i)}function Y7(t,e,i){let s=t[1].x;s-=t[0].x,s*=3;let n=t[2].x;n-=t[1].x,n*=3;let r=t[3].x;r-=t[0].x,r-=n,n-=s,e[3].setWithEps(r),e[2].setWithEps(n),e[1].setWithEps(s),i?e[0].set(0):e[0].set(t[0].x)}function X7(t,e,i){let s=t[1].y;s-=t[0].y,s*=3;let n=t[2].y;n-=t[1].y,n*=3;let r=t[3].y;r-=t[0].y,r-=n,n-=s,e[3].setWithEps(r),e[2].setWithEps(n),e[1].setWithEps(s),i?e[0].set(0):e[0].set(t[0].y)}function pS(t,e,i=!1){const s=he(ln,4);s[0].assignPoint2D(t[0]),s[1].assignPoint2D(t[1]),s[2].assignPoint2D(t[2]),s[3].assignPoint2D(t[3]),e[1].setCoords(s[1].x.sub(s[0].x),s[1].y.sub(s[0].y)),e[1].mulThis(nt.constructInt32(3)),e[2].setCoords(s[2].x.sub(s[1].x),s[2].y.sub(s[1].y)),e[2].mulThis(nt.constructInt32(3)),e[3]=s[3].sub(s[0]),e[3]=e[3].sub(e[2]),e[2]=e[2].sub(e[1]),i?e[0].setCoords(sa,sa):e[0]=s[0].clone()}function ZP(t,e,i){if(i){if(e<0)return e;if(e>1)return e-1+ZP(t,1,!1)}if(t.isDegenerate(0))return 0;const s=e===1,n=KP(t);if(s&&!Number.isNaN(n.length)&&!Number.isNaN(n.length))return n.length;const r=Xpe(t),o=r/t.calculateUpperLength2D();let a=0,l=0;for(let u=1,c=n.specialPointsCount();u<c;u++){const h=n.specialPoints[u];if(a+=fFe(t,l,Math.min(e,h),o,r),e<=h)break;l=h}return s&&(n.length=a),a}function jLe(t,e,i){const s=ZP(t,1,!1);if(e<=0)return e;if(e>=s)return e-s+1;const n=[0];return zy(new pFe(t,e),Me.unit(),1,n)!==1&&We(""),n[0]}function YLe(t,e,i){i===void 0&&(i=e,e=0);const s=new N;if(e<0||i>1)return s.setNAN(),s;if(e>i&&ce("calculate_sub_weightedCentroid"),e===i||t.isDegenerate(0))return s.setCoords(0,0),s;const n=KP(t),r=Xpe(t),o=r/t.calculateUpperLength2D();let a=e,l=0;for(let u=1,c=n.specialPointsCount();u<c;u++)if(e<n.specialPoints[u]){l=u-1;break}s.setCoords(0,0);for(let u=l+1,c=n.specialPointsCount();u<c;u++){const h=Math.min(n.specialPoints[u],i),d=gFe(t,a,h,o,r);if(s.addThis(d),a=h,i<=n.specialPoints[u])break}return s.add(t.getStartXY().mul(t.calculateLength2D()))}function KP(t){if(t.m_cachedValues)return t.m_cachedValues;const e=new BLe,i=he(ge,8),s=he(N,4);t.queryControlPoints(s);const n=sfe(s,i);e.specialPoints=[];for(let r=0;r<n;r++)e.specialPoints.push(i[r].value());return Qpe(t,e),e}function jJ(t){let e=null;return e=t.m_cachedValues,e}function Qpe(t,e){t.m_cachedValues=e}function FU(t){t.m_cachedValues=null}function XLe(t,e){e.m_cachedValues=Ge(t.m_cachedValues,t.m_cachedValues=e.m_cachedValues)}function WLe(t,e,i,s){if(e.isEqual(t.m_XStart,t.m_YStart)&&i.isEqual(t.m_XEnd,t.m_YEnd))return;const n=!!s&&t.isMonotoneQuickAndDirty(),r=new Gi,o=he(N,3);o[0].setCoords(t.m_XStart,t.m_YStart),o[2].setCoords(t.m_XEnd,t.m_YEnd);const a=new N;a.setSub(o[2],o[0]),a.leftPerpendicularThis(),o[1].setAdd(o[0],a);const l=he(N,3);l[0].setCoordsPoint2D(e),l[2].setCoordsPoint2D(i),a.setSub(l[2],l[0]),a.leftPerpendicularThis(),l[1].setAdd(l[0],a),r.setFromTwoTriangles(o,l)?r.transformPoints2D(t.m_cp,2,t.m_cp):(zn(e,i,1/3,t.m_cp[0]),zn(e,i,2/3,t.m_cp[1])),t.changeEndPoints2D(e,i),n&&cL(t)}function ZLe(t,e,i,s,n){return{tmin:t,tmax:e,t:i,d:s,pt:n.clone()}}function KLe(t,e,i,s){const n=st(18,Number.NaN),r=he(N,4);t.queryControlPoints(r);const o=zy(new ife(r,e),Me.construct(i,s),18,n),a=new N;t.queryCoord2D(i,a);let l=i,u=N.distance(a,e);const c=new N;t.queryCoord2D(s,c);const h=N.distance(c,e);h<u&&(u=h,l=s,a.assign(c));for(let d=0;d<o;d++){t.queryCoord2D(n[d],c);const m=N.distance(c,e);m<u&&(u=m,l=n[d],a.assign(c))}return ZLe(i,s,l,u,a)}function Jpe(t,e){const i=he(ge,4);Zpe(t,i,!0);const s=he(ge,4);Kpe(t,s,!0);const n=i[3].clone(),r=i[2].clone(),o=i[1].clone(),a=s[3].clone(),l=s[2].clone(),u=s[1].clone(),c=r.mulE(o).addE(l.mulE(u)).mul(4),h=r.mulE(r).mul(8).addE(n.mulE(o).mul(12)).addE(l.mulE(l).mul(8).addE(a.mulE(u).mul(12))),d=n.mulE(r).addE(a.mulE(l)).mul(36),m=n.mulE(n).addE(a.mulE(a)).mul(36),f=he(ge,3),_=rL(m,d,h,c,new Me(0,1),!1,f);if(z(_<=3),_>0){const v=Wv(t,1,0).sqrLength(),x=Wv(t,1,1).sqrLength();let w=v;e.set(0),w<x&&(w=x,e.set(1));for(let T=0;T<_;T++){const C=Wv(t,1,f[T].value()).sqrLength();C<w&&(w=C,e=f[T])}}}function QLe(t,e,i,s){if(e===1){const n=1-i,r=n*n,o=i*i,a=t[1].sub(t[0]),l=t[2].sub(t[1]),u=t[3].sub(t[2]),c=a.mul(r).add(l.mul(2*n*i)).add(u.mul(o));s.assign(c.mul(3))}else if(e===2){const n=1-i,r=t[2].sub(t[1]).sub(t[1].sub(t[0])),o=t[3].sub(t[2]).sub(t[2].sub(t[1])),a=r.mul(n).add(o.mul(i));s.assign(a.mul(6))}else if(e===3){const n=t[2].sub(t[1]),r=t[3].sub(n.mul(3)).sub(t[0]);s.assign(r.mul(6))}else s.setCoords(0,0)}function JLe(t,e,i,s){{const n=Ff.subE(i),r=n.sqr(),o=i.sqr(),a=t[1].subE(t[0]).mulE(r).addE(t[2].subE(t[1]).mulE(new ge(2).mulE(n).mulE(i))).addE(t[3].subE(t[2]).mulE(o));s.setE(a.mulE(new ge(3)))}}function Qo(t,e,i){const s=new N;return QLe(t,e,i,s),s}function eFe(t,e,i){const s=[Et.constructPoint2D(t[0]),Et.constructPoint2D(t[1]),Et.constructPoint2D(t[2]),Et.constructPoint2D(t[3])],n=new Et;return JLe(s,e,i,n),n}function Wv(t,e,i){const s=he(N,4);return t.queryControlPoints(s),Qo(s,e,i)}function YJ(t){const e=t.m_cp[0].sub(t.getStartXY()),i=t.m_cp[1].sub(t.m_cp[0]),s=t.getEndXY().sub(t.getStartXY());return e.mulThis(3),i.mulThis(3),s.subThis(i),i.subThis(e),(3*s.x*(2*i.y+5*e.y)-3*s.y*(2*i.x+5*e.x)+10*(i.x*e.y-i.y*e.x))/60}function cL(t){const e=he(N,4);t.queryControlPoints(e);const i=a4(e);return i&&(t.m_cp[0].setCoordsPoint2D(e[1]),t.m_cp[1].setCoordsPoint2D(e[2]),t.afterCompletedModification()),i}function a4(t){let e=!1;for(let i=0;i<2;i++){const s=an(t[0][i],t[3][i]);s>0?(an(t[0][i],t[1][i])<0&&(t[1][i]=t[0][i],e=!0),an(t[1][i],t[3][i])<0&&(t[1][i]=t[3][i],e=!0),an(t[0][i],t[2][i])<0&&(t[2][i]=t[0][i],e=!0),an(t[2][i],t[3][i])<0&&(t[2][i]=t[3][i],e=!0),an(t[1][i],t[2][i])<0&&(t[2][i]=t[1][i],e=!0)):s<0?(an(t[0][i],t[1][i])>0&&(t[1][i]=t[0][i],e=!0),an(t[1][i],t[3][i])>0&&(t[1][i]=t[3][i],e=!0),an(t[0][i],t[2][i])>0&&(t[2][i]=t[0][i],e=!0),an(t[2][i],t[3][i])>0&&(t[2][i]=t[3][i],e=!0),an(t[1][i],t[2][i])>0&&(t[2][i]=t[1][i],e=!0)):t[1][i]===t[0][i]&&t[2][i]===t[0][i]||(t[1][i]=t[0][i],t[2][i]=t[0][i],e=!0)}return e}function tFe(t){const e=an(t[0].y,t[1].y),i=an(t[1].y,t[2].y),s=an(t[2].y,t[3].y);if(e>=0&&i>=0&&s>=0||e<=0&&i<=0&&s<=0){const n=an(t[0].x,t[1].x),r=an(t[1].x,t[2].x),o=an(t[2].x,t[3].x);if(n>=0&&r>=0&&o>=0||n<=0&&r<=0&&o<=0)return!0}return!1}function VD(t,e,i){const s=new N,n=new N,r=new N,o=new N,a=new N;e<=.5?(tr(2,t[0],t[1],e,s),tr(2,t[1],t[2],e,n),tr(2,t[2],t[3],e,r),tr(2,s,n,e,o),tr(2,n,r,e,a),tr(2,o,a,e,i)):(ir(2,t[0],t[1],e,s),ir(2,t[1],t[2],e,n),ir(2,t[2],t[3],e,r),ir(2,s,n,e,o),ir(2,n,r,e,a),ir(2,o,a,e,i))}function QP(t,e,i,s){z(e>=0&&e<=1);const n=new N,r=new N,o=new N,a=new N,l=new N,u=new N;e<=.5?(tr(2,t[0],t[1],e,n),tr(2,t[1],t[2],e,r),tr(2,t[2],t[3],e,o),tr(2,n,r,e,a),tr(2,r,o,e,l),tr(2,a,l,e,u)):(ir(2,t[0],t[1],e,n),ir(2,t[1],t[2],e,r),ir(2,t[2],t[3],e,o),ir(2,n,r,e,a),ir(2,r,o,e,l),ir(2,a,l,e,u));const c=t[3].clone();i&&(i[0].assign(t[0]),i[1].assign(n),i[2].assign(a),i[3].assign(u)),s&&(s[0].assign(u),s[1].assign(l),s[2].assign(o),s[3].assign(c))}function w1(t,e,i,s){if(z(e>=0&&i<=1&&e<=i),e===i){const r=new N;return xn(t,e,r),s[0].assign(r),s[1].assign(r),s[2].assign(r),void s[3].assign(r)}if(e===0&&i===1){for(let r=0;r<4;++r)s[r].assign(t[r]);return}const n=he(N,4);QP(t,i,n,null),QP(n,i>0?e/i:0,null,n),xn(t,e,n[0]),xn(t,i,n[3]),s[0].setCoordsPoint2D(n[0]),s[1].setCoordsPoint2D(n[1]),s[2].setCoordsPoint2D(n[2]),s[3].setCoordsPoint2D(n[3])}function xn(t,e,i,s){if(s){if(e<0)return void Rl(new mi({start:t[0],end:t[0].add(JG(t,0).getUnitVector())}),e,i);if(e>1)return void Rl(new mi({start:t[3],end:t[3].add(JG(t,1).getUnitVector())}),e-1,i)}if(e<=.5){const n=new N;tr(2,t[0],t[1],e,n);const r=new N;tr(2,t[1],t[2],e,r);const o=new N;tr(2,t[2],t[3],e,o);const a=new N;tr(2,n,r,e,a);const l=new N;tr(2,r,o,e,l),tr(2,a,l,e,i)}else{const n=new N;ir(2,t[0],t[1],e,n);const r=new N;ir(2,t[1],t[2],e,r);const o=new N;ir(2,t[2],t[3],e,o);const a=new N;ir(2,n,r,e,a);const l=new N;ir(2,r,o,e,l),ir(2,a,l,e,i)}}function iFe(t,e,i){if(e.value()<=.5){const s=new Et;tc(2,Et.constructPoint2D(t[0]),Et.constructPoint2D(t[1]),e,s);const n=new Et;tc(2,Et.constructPoint2D(t[1]),Et.constructPoint2D(t[2]),e,n);const r=new Et;tc(2,Et.constructPoint2D(t[2]),Et.constructPoint2D(t[3]),e,r);const o=new Et;tc(2,s,n,e,o);const a=new Et;tc(2,n,r,e,a),tc(2,o,a,e,i)}else{const s=new Et;ic(2,Et.constructPoint2D(t[0]),Et.constructPoint2D(t[1]),e,s);const n=new Et;ic(2,Et.constructPoint2D(t[1]),Et.constructPoint2D(t[2]),e,n);const r=new Et;ic(2,Et.constructPoint2D(t[2]),Et.constructPoint2D(t[3]),e,r);const o=new Et;ic(2,s,n,e,o);const a=new Et;ic(2,n,r,e,a),ic(2,o,a,e,i)}}function sFe(t,e,i){const s=he(N,4);t.queryControlPoints(s),iFe(s,e,i)}function JG(t,e){const i=Os(e,0,1);let s=Qo(t,1,i);return s.isZero()&&(s=Qo(t,2,i),s.isZero()?s=Qo(t,3,i):i===1&&s.negateThis()),s}function efe(t,e,i){const s=he(N,4);t.queryControlPoints(s),nFe(s,e,i)}function nFe(t,e,i){e.value()<0&&e.set(0,e.eps()),e.value()>1&&e.set(1,e.eps()),i.setE(eFe(t,1,e))}function XJ(t,e,i,s,n){if(n){if(Gl(e,i)!==0)return t?4:2}else if(Mu(e,i))return 1;return JP(t,e,i,null,null,null,s,n!==void 0&&n,!0,!1)!==0?4:0}function WJ(t,e,i,s,n){if(n){if(Gl(e,i)!==0)return t?4:2}else if(Mu(e,i))return 1;return eB(t,e,i,null,null,null,s,n!==void 0&&n,!0,!1)!==0?4:0}function rFe(t,e,i,s,n){if(n){if(Gl(e,i)!==0)return 2}else if(Mu(e,i))return 1;return W7(t,e,i,null,null,null,s,n!==void 0&&n,!0,!1)!==0?4:0}function ZJ(t,e,i,s,n){if(n){if(Gl(e,i)!==0)return t?4:2}else if(Mu(e,i))return 1;return tB(t,e,i,null,null,null,s,n!==void 0&&n,!0,!1)!==0?4:0}function KJ(t,e,i,s,n){if(n){if(Gl(e,i)!==0)return t?4:2}else if(Mu(e,i))return 1;return iB(t,e,i,null,null,null,s,n??!1,!0,!1)!==0?4:0}function JP(t,e,i,s,n,r,o,a,l,u){if(n!==null&&(n.length=0),r!=null&&(r.length=0),s!==null&&(s.length=0),i.isDegenerate(0)){const L=[0,0,0],D=e.intersectPoint(i.getStartXY(),L,o);if(D>0){if(n!==null)for(let O=0;O<D;O++)n.push(L[O]);if(r!==null)for(let O=0;O<D;O++)r.push(0);if(s!=null)for(let O=0;O<D;O++){const U=new N;e.queryCoord2D(L[O],U),s.push(U)}}return D}const c=hl(e,i);if(Au(e,i,o=Math.max(o,c)))return 0;const h=he(N,4);Wpe(e,h);const d=i.getEndXY();d.subThis(i.getStartXY());const m=d.clone();m.leftPerpendicularThis();let f=3*h[3].dotProduct(m),_=2*h[2].dotProduct(m),v=h[1].dotProduct(m);const x=st(15,Number.NaN),w=st(15,Number.NaN);let T=y1(f,_,v,Me.unit(),!1,x);T<0&&(x[0]=0,x[1]=1,T=2);let C,M=0;for(let L=0,D=M;L<T;++L){const O=e.getCoord2D(x[L+D]);w[M]=i.getClosestCoordinate(O,!1),N.distance(O,i.getCoord2D(w[M]))<=o&&(x[M]=x[L+D],M++)}if(h[0].subThis(i.getStartXY()),Math.abs(d.x)>=Math.abs(d.y)){const L=d.y/d.x;f=h[3].y-h[3].x*L,_=h[2].y-h[2].x*L,v=h[1].y-h[1].x*L,C=h[0].y-h[0].x*L}else{const L=d.x/d.y;f=h[3].x-h[3].y*L,_=h[2].x-h[2].y*L,v=h[1].x-h[1].y*L,C=h[0].x-h[0].y*L}const A=e.getEndXY().equals(i.getStartXY())||e.getEndXY().equals(i.getEndXY()),I=[0,0,0];T=Spe(f,_,v,C,Me.unit(),A,I);for(let L=0,D=M;L<T;++L){x[L+D]=I[L];const O=e.getCoord2D(x[L+D]);w[M]=i.getClosestCoordinate(O,!1),N.distance(O,i.getCoord2D(w[M]))<=o&&(x[M]=x[L+D],M++)}T=e.intersectPoint(i.getStartXY(),I,o);for(let L=0;L<T;L++)x[M]=I[L],w[M++]=0;T=e.intersectPoint(i.getEndXY(),I,o);for(let L=0;L<T;L++)x[M]=I[L],w[M++]=1;return i.intersectPoint(e.getStartXY(),I,o)!==0&&(w[M]=I[0],x[M++]=0),i.intersectPoint(e.getEndXY(),I,o)!==0&&(w[M]=I[0],x[M++]=1),M===0?0:Iu(t,e,i,x,w,M,s,n,r,o,a,l,u)}function eB(t,e,i,s,n,r,o,a,l,u){if(Us(i))return JP(t,e,new mi({start:i.getStartXY(),end:i.getEndXY()}),s,n,r,o,a,l,u);const c=hl(e,i);if(Au(e,i,o=Math.max(o,c)))return 0;const h=[],d=[],m=[],f=he(N,4);{e.queryControlPoints(f);const v=he(N,4),x=new Gi;i.canonicToWorldTransformation(x);const w=new Gi;w.setInvert(x),w.transformPoints2D(f,4,v);const T=he(ln,4);pS(v,T);const C=[T[0].x,T[1].x,T[2].x,T[3].x],M=[T[0].y,T[1].y,T[2].y,T[3].y],A=he(nt,3);A[0].setDouble(i.getSemiMinorAxis()),A[0].sqrThis(),A[1].setDouble(i.getSemiMajorAxis()),A[1].sqrThis(),A[2].setThis(A[0]),A[2].mulThis(A[1]),A[2].negateThis();const I=G7(C,3,M,3,null,0,A,!0,Me.unit(),Me.unit(),d);if(I>0){let L=0;for(let D=0;D<I;D++){const O=new N;e.queryCoord2D(d[D],O);const U=i.getClosestCoordinate(O,!1),$=new N;i.queryCoord2D(U,$),N.distance(O,$)<=o&&(h.push(O.clone()),d[L]=d[D],m.push(U),L++)}d.length=L,h.length=L}}const _=[0,1];for(let v=0;v<2;v++){const x=v===0?i.getStartXY():i.getEndXY(),w=[0];S1(f,x,Me.unit(),!1,-1,1,w);const T=new N;xn(f,w[0],T),N.distance(x,T)<=o&&(d.push(w[0]),m.push(_[v]),h.push(T.clone()))}for(let v=0;v<2;v++){const x=[0,3];{const w=i.getClosestCoordinate(f[x[v]],!1),T=new N;i.queryCoord2D(w,T),N.distance(f[x[v]],T)<=o&&(d.push(_[v]),m.push(w),h.push(T.clone()))}}return Iu(t,e,i,d,m,d.length,s,n,r,o,a,l,u)}function W7(t,e,i,s,n,r,o,a,l,u){const c=he(N,4);e.queryControlPoints(c);const h=he(N,4);if(i.queryControlPoints(h),V7(c,h,4)<0)return W7(t,i,e,s,r,n,o,a,l,!u);const d=hl(e,i);if(Au(e,i,o=Math.max(o,d)))return 0;if(_Fe(e,i,s,n,r,o,a,l,u))return 2;const m=new Me(0,1),f=new Me(0,1);{const C=new ua;eM(c,new Me(0,1),C);const M=new ua;eM(h,new Me(0,1),M);const A=Math.max(C.maxDim(),M.maxDim());if(C.inflate(3*o),M.inflate(3*o),!C.intersectW(M))return 0;if(C.maxDim()<.1*A){if(sB(c,C,m),sB(h,C,f),m.isEmpty()||f.isEmpty())return 0;w1(c,m.vmin,m.vmax,c),w1(h,f.vmin,f.vmax,h)}}const _=iE(c,3,h,3,o);if(_===0)return 0;const v=[],x=[],w=[];let T=!1;if(_===-1){const C=he(ln,4);pS(c,C);const M=[C[0].x,C[1].x,C[2].x,C[3].x],A=[C[0].y,C[1].y,C[2].y,C[3].y],I=he(ln,4);pS(h,I);const L=[],D=[],O=eE(M,3,A,3,null,0,[I[0].x,I[1].x,I[2].x,I[3].x],3,[I[0].y,I[1].y,I[2].y,I[3].y],3,null,0,!0,Me.unit(),Me.unit(),L,D);if(O>0)for(let U=0;U<O;U++){const $=new N;xn(h,D[U],$);const B=new N;xn(c,L[U],B),N.distance(B,$)<=o&&(v.push(B.clone()),w.push(D[U]),x.push(L[U]))}else O===-1&&(T=!0)}for(let C=0;C<2;C++){const M=C===0?c:h,A=C===0?h:c;for(let I=0;I<2;I++){const L=I===0?0:3,D=[0];S1(A,M[L],Me.unit(),!1,-1,1,D);const O=new N;xn(A,D[0],O),N.distance(M[L],O)<=o&&(C===0?(x.push(L===0?0:1),w.push(D[0])):(w.push(L===0?0:1),x.push(D[0])),v.push(O.clone()))}}if(x.length===0&&T){const C=e.calculateUpperLength2D()>i.calculateUpperLength2D();{const M=[0,0];if(cFe(C?e:i,M,!0)===2&&(z(Me.unit().containsCoordinate(M[0])),!Me.unit().containsCoordinate(M[1]))){const A=new N;xn(C?c:h,M[0],A);const I=[0,0];S1(C?h:c,A,Me.unit(),!1,-1,2,I)===1&&(v.push(A.clone()),x.push(C?M[0]:I[0]),w.push(C?I[0]:M[0]))}}}if(x.length===0)return 0;if(!m.equalsRange(0,1))for(let C=0;C<x.length;++C)x[C]=hc.recalculateParentT(m.vmin,m.vmax,x[C]);if(!f.equalsRange(0,1))for(let C=0;C<w.length;++C)w[C]=hc.recalculateParentT(f.vmin,f.vmax,w[C]);return Iu(t,e,i,x,w,x.length,s,n,r,o,a,l,u)}function tB(t,e,i,s,n,r,o,a,l,u){const c=hl(e,i);if(i.isDegenerateToLineHelper(c)){const M=new mi({start:i.getStartXY(),end:i.getEndXY()}),A=JP(t,e,M,s,n,r,o,a,l,u);if(r)for(let I=0;I<A;++I){const L=M.getCoord2D(r[I]);r[I]=i.getClosestCoordinate(L,!1)}return A}if(Au(e,i,o=Math.max(o,c)))return 0;const h=he(N,4);e.queryControlPoints(h);const d=he(N,3);i.queryControlPoints(d);const m=new Me(0,1),f=new Me(0,1),_=[0,0,0];i.queryWeights(_);const v=[1,oh(_),1];{const M=new ua;eM(h,new Me(0,1),M);const A=new ua;GP(d,v,new Me(0,1),A);const I=Math.max(M.maxDim(),A.maxDim());if(M.inflate(3*o),A.inflate(3*o),!M.intersectW(A))return 0;if(M.maxDim()<.1*I){if(sB(h,M,m),HG(d,v,M,f),m.isEmpty()||f.isEmpty())return 0;w1(h,m.vmin,m.vmax,h),wy(d,v,f.vmin,f.vmax,d,v)}}const x=iE(h,3,d,2,o);if(x===0)return 0;const w=[],T=[],C=[];if(x===-1){const M=he(ln,4);pS(h,M);const A=[M[0].x,M[1].x,M[2].x,M[3].x],I=[M[0].y,M[1].y,M[2].y,M[3].y],L=he(nt,3),D=he(nt,3),O=he(nt,3);qP(d,v,L,D,O);const U=[],$=[],B=eE(L,2,D,2,O,2,A,3,I,3,null,0,!0,Me.unit(),Me.unit(),$,U);if(B>0)for(let V=0;V<B;V++){const H=new N;xn(h,U[V],H);const Y=new N;kn(d,v,$[V],Y),N.distance(H,Y)<=o&&(w.push(H.clone()),T.push(U[V]),C.push($[V]))}}for(let M=0;M<2;M++){let A,I;M===0?(A=h,I=d):(I=h,A=d);for(let L=0;L<2;L++){const D=L===0?0:A.length-1,O=[0],U=new N;if(M===0){const $=B7(I,v,A[D],Me.unit(),!1,-1,1,O);z($===1),kn(I,v,O[0],U)}else{const $=S1(I,A[D],Me.unit(),!1,-1,1,O);z($===1),xn(I,O[0],U)}N.distance(A[D],U)<=o&&(M===0?(T.push(D===0?0:1),C.push(O[0])):(C.push(D===0?0:1),T.push(O[0])),w.push(U.clone()))}}if(T.length===0)return 0;if(!m.equalsRange(0,1))for(let M=0;M<T.length;++M)T[M]=hc.recalculateParentT(m.vmin,m.vmax,T[M]);if(!f.equalsRange(0,1))for(let M=0;M<C.length;++M)C[M]=il.recalculateParentT(f.vmin,f.vmax,C[M]);for(let M=0;M<C.length;++M)C[M]=dS(_,C[M]);return Iu(t,e,i,T,C,T.length,s,n,r,o,a,l,u)}function iB(t,e,i,s,n,r,o,a,l,u){const c=hl(e,i);if(Au(e,i,o=Math.max(o,c)))return 0;const h=he(N,4);e.queryControlPoints(h);const d=he(N,3);i.queryControlPoints(d);const m=iE(h,3,d,2,o);if(m===0)return 0;const f=[],_=[],v=[];if(m===-1){const x=he(ln,4);pS(h,x);const w=[x[0].x,x[1].x,x[2].x,x[3].x],T=[x[0].y,x[1].y,x[2].y,x[3].y],C=he(ln,3);mS(d,C);const M=eE([C[0].x,C[1].x,C[2].x],2,[C[0].y,C[1].y,C[2].y],2,null,0,w,3,T,3,null,0,!0,Me.unit(),Me.unit(),v,_);if(M>0){let A=0;for(let I=0;I<M;I++){const L=new N;e.queryCoord2D(_[I],L);const D=new N;i.queryCoord2D(v[I],D),N.distance(L,D)<=o&&(f.push(L.clone()),_[A]=_[I],v[A]=v[I],A++)}_.length=A,f.length=A}}for(let x=0;x<2;x++){let w,T;x===0?(w=h,T=d):(T=h,w=d);for(let C=0;C<2;C++){const M=C===0?0:w.length-1,A=[0],I=new N;if(x===0)o4(T,w[M],A),eh(T,A[0],I);else{const L=S1(T,w[M],Me.unit(),!1,-1,1,A);z(L===1),xn(T,A[0],I)}N.distance(w[M],I)<=o&&(x===0?(_.push(M===0?0:1),v.push(A[0])):(v.push(M===0?0:1),_.push(A[0])),f.push(I.clone()))}}return Iu(t,e,i,_,v,_.length,s,n,r,o,a,l,u)}function oFe(t,e,i,s,n){const r=new ua;if(tfe(t,Me.unit(),r),r.inflate(s),!r.isIntersectingPoint2D(e))return 0;const o=KP(t);let a=0,l=o.specialPoints[0];const u=[];for(let c=1,h=o.specialPoints.length;c<h;++c){const d=o.specialPoints[c],m=KLe(t,e,l,d);if(u.length===0)u.push(m);else if(m.t===m.tmin)z(u.at(-1).d<=m.d),u.at(-1).tmax=m.tmax;else if(u.at(-1).t===u.at(-1).tmax){z(u.at(-1).d>=m.d);const f=u.at(-1).tmin;u[u.length-1]=m,u.at(-1).tmin=f}else u.push(m);l=d}for(const c of u)if(c.d<=s){const h=c.t;i&&(a>=i.length&&bi(""),i[a]=h),a++}return a}function tfe(t,e,i){const s=he(N,4);t.queryControlPoints(s),eM(s,e,i)}function eM(t,e,i){if(e.equalsRange(0,1))return void i.setFromPoints(t,4);const s=he(N,4);w1(t,e.vmin,e.vmax,s),i.setFromPoints(s,4)}let ife=class{constructor(e,i){this.controlPoints=e,this.point=i.clone()}getMaxDerivative(){return 6}getValue(e,i){switch(e){case 0:{const s=new N;xn(this.controlPoints,i,s);const n=Qo(this.controlPoints,1,i);return 2*s.sub(this.point).dotProduct(n)}case 1:{const s=new N;xn(this.controlPoints,i,s);const n=Qo(this.controlPoints,1,i),r=Qo(this.controlPoints,2,i);return 2*(s.sub(this.point).dotProduct(r)+n.dotProduct(n))}case 2:{const s=new N;xn(this.controlPoints,i,s);const n=Qo(this.controlPoints,1,i),r=Qo(this.controlPoints,2,i),o=Qo(this.controlPoints,3,i);return 2*(s.sub(this.point).dotProduct(o)+3*n.dotProduct(r))}case 3:{const s=Qo(this.controlPoints,1,i),n=Qo(this.controlPoints,2,i),r=Qo(this.controlPoints,3,i);return 2*(4*s.dotProduct(r)+3*n.sqrLength())}case 4:{const s=Qo(this.controlPoints,2,i),n=Qo(this.controlPoints,3,i);return 2*(10*s.dotProduct(n))}case 5:{const s=Qo(this.controlPoints,3,i);return 2*(10*s.dotProduct(s))}default:return 0}}getError(e){return 0}};function S1(t,e,i,s,n,r,o){RP(Me.unit().contains(i)&&r>0,"getClosestCoordinate"),(n<0||Number.isNaN(n))&&(n=Number.MAX_VALUE);const a=[],l=new N;xn(t,i.vmin,l);let u=N.distance(l,e);if(u<=n&&a.push(new N(i.vmin,u)),i.vmin!==i.vmax&&(xn(t,i.vmax,l),u=N.distance(l,e),u<=n&&a.push(new N(i.vmax,u))),i.width()>0){const d=st(18,Number.NaN),m=zy(new ife(t,e),i,18,d);for(let f=0;f<m;f++)xn(t,d[f],l),u=N.distance(l,e),u>n||a.push(new N(d[f],u))}if(s){z(i.equals(Me.unit()));{xn(t,-1,l,!0);const d=new N;xn(t,0,d);const m=new mi({start:l,end:d}),f=m.getClosestCoordinate(e,!0);f<1&&(l.assign(m.getCoord2D(f)),u=N.distance(l,e),u<=n&&a.push(new N(f-1,u)))}{xn(t,2,l,!0);const d=new N;xn(t,i.vmax,d);const m=new mi({start:d,end:l}),f=m.getClosestCoordinate(e,!0);f>0&&(l.assign(m.getCoord2D(f)),u=N.distance(l,e),u<=n&&a.push(new N(1+f,u)))}}if(!a.length)return 0;a.sort((d,m)=>d.compare(m));let c=0;const h=a[0].x;if(o[c++]=h,c<r){const d=dpe(t,4,!1).total(),m=a[0].y;for(let f=1,_=a.length;f<_;f++)if(a[f].y>m+d){a.length=f;break}a.sort((f,_)=>Vm(f.x,_.x)),c=0,o[c++]=a[0].x;for(let f=1,_=a.length;f<_;f++)a[f].x!==o[c-1]&&c<r&&(o[c++]=a[f].x)}return c}function hL(t,e,i,s,n,r,o){const a=he(N,4);return t.queryControlPoints(a),S1(a,e,i,s,n,r,o)}function aFe(t){return t.getStartXY().norm(1)+t.getEndXY().norm(1)+t.m_cp[0].norm(1)+t.m_cp[1].norm(1)}function lFe(t){return t[0].norm(1)+t[1].norm(1)+t[2].norm(1)+t[3].norm(1)}function uFe(t,e,i){if(z(i>=2),i===2){const f=new N;zn(e[0],e[i-1],1/3,f);const _=new N;return zn(e[0],e[i-1],2/3,_),void t.construct(e[0],f,_,e[i-1])}const s=e[0],n=e[i-1],r=[0,0],o=hL(t,s,Me.unit(),!1,Number.NaN,2,r),a=[0,0],l=hL(t,n,Me.unit(),!1,Number.NaN,2,a),u=[];for(let f=0;f<o;f++)for(let _=0;_<l;_++){const v=r[f],x=a[_],w=(A,I)=>{const L=st(i-2,Number.NaN),D=()=>{let ne=0;for(let j=1,oe=i-1;j<oe;j++){ne+=N.distance(e[j-1],e[j]);const ve=ne;L[j-1]=ve}ne+=N.distance(e[i-2],e[i-1]);for(let j=1,oe=i-1;j<oe;j++)L[j-1]/=ne};let O=!1,U=!1;{const ne=new ii;v<=x?(t.queryCut(v,x,ne,!0),A.assign(ne.get().getControlPoint1()),I.assign(ne.get().getControlPoint2())):(t.queryCut(x,v,ne,!0),A.assign(ne.get().getControlPoint2()),I.assign(ne.get().getControlPoint1())),s.equals(A)&&(O=!0),n.equals(I)&&(U=!0)}D();let $=Number.MAX_VALUE;const B=A.clone(),V=I.clone();for(let ne=0;ne<5;ne++)$=kU(!0,!1,s,B,V,n,O,U,L,i-2,e,i);for(let ne=0;ne<30;ne++){const j=B.clone();V.clone();const oe=kU(!0,!0,s,B,V,n,O,U,L,i-2,e,i);if($<=oe&&j.equals(B)&&j.equals(V))break;$=oe}D();let H=!1,Y=Number.EPSILON;const W=A.clone(),ee=I.clone();for(let ne=0;ne<30;ne++){const j=W.clone();ee.clone();const oe=kU(H,!0,s,W,ee,n,O,U,L,i-2,e,i);if(Y<=oe&&j.equals(W)&&j.equals(ee))break;H=!0,Y=oe}return Y<$?(A.assign(W),I.assign(ee)):(A.assign(B),I.assign(V),Y=$),Y},T=new N,C=new N,M=[w(T,C),N.distance(s,T)+N.distance(T,C)+N.distance(C,n),T.x,T.y,C.x,C.y];u.splice(u.length,0,...M)}let c=u[0],h=u[1],d=0;for(let f=6;f<u.length;f+=6)u[f]<c&&(c=u[f],h=u[f+1],d=f);let m=d;for(let f=0;f<u.length;f+=6)f!==d&&u[f+1]<h&&Math.abs(c-u[f])<10*c&&(h=u[f+1],m=f);t.construct(s,new N(u[m+2],u[m+3]),new N(u[m+4],u[m+5]),n)}function cFe(t,e,i=!1){const s=he(N,4);t.queryControlPoints(s);const n=he(ln,4);let r,o,a;pS(s,n,!0);const l=n[3].x.isZero(),u=n[3].y.isZero();if(l||u)if(l&&!u){if(n[2].x.isZero())return 0;r=n[1].x.div(n[2].x).negate(),o=n[2].y.div(n[3].y),a=n[1].y.div(n[3].y)}else{if(l||!u||n[2].y.isZero())return 0;r=n[1].y.div(n[2].y).negate(),o=n[2].x.div(n[3].x),a=n[1].x.div(n[3].x)}else{n[2].x.divThis(n[3].x),n[1].x.divThis(n[3].x),n[2].y.divThis(n[3].y),n[1].y.divThis(n[3].y);const m=n[2].x.sub(n[2].y);if(m.isZero())return 0;r=n[1].x.sub(n[1].y).div(m).negate(),o=n[2].x.clone(),a=n[1].x.clone()}if(!i&&r.abs().value()>2)return 0;const c=[0,0],h=t.getStartXY().equals(t.getEndXY()),d=y1(1,-r.toDouble(),r.add(o).mul(r).add(a).toDouble(),Me.unit(),h,c);if(d===0)return 0;if(c[0]>=0&&c[0]<=1){const m=r.toDouble()-c[0];if(i||m>=0&&m<=1)return e[0]=c[0],e[1]=m,e[0]>e[1]&&(e[1]=Ge(e[0],e[0]=e[1])),2}if(d===2&&c[1]>=0&&c[1]<=1){const m=r.toDouble()-c[1];if(i||m>=0&&m<=1)return e[0]=c[1],e[1]=m,e[0]>e[1]&&(e[1]=Ge(e[0],e[0]=e[1])),2}return 0}function hFe(t,e,i){const s=t[1].mulE(e[2]).subThisE(t[2].mulE(e[1])),n=t[1].mulE(e[3]).subThisE(t[3].mulE(e[1])).mulThis(3),r=t[2].mulE(e[3]).subThisE(t[3].mulE(e[2])).mulThis(3),o=he(ge,2);let a=Ul(r,n,s,new Me(0,1),!1,o);a<0&&(a=0);let l=0;for(let u=0;u<a;u++)Vs(o[u].value(),0,1)||(i[l].setE(o[u]),l++);return l}function sfe(t,e){e[0].set(0);let i=1;const s=he(ge,4);Y7(t,s,!0);const n=he(ge,4);X7(t,n,!0);{const r=s[3].mul(3),o=s[2].mul(2),a=s[1].clone(),l=he(ge,2);let u=Ul(r,o,a,new Me(0,1),!1,l);u<0&&(u=0);for(let c=0;c<u;c++)Vs(l[c].value(),0,1)||(e[i]=l[c],i++)}{const r=n[3].mul(3),o=n[2].mul(2),a=n[1].clone(),l=he(ge,2);let u=Ul(r,o,a,new Me(0,1),!1,l);u<0&&(u=0);for(let c=0;c<u;c++)Vs(l[c].value(),0,1)||(e[i]=l[c],i++)}if(i+=hFe(s,n,e.slice(i)),e[i].set(1),i++,i>2){wd(e,0,i,(c,h)=>{const d=c.value(),m=h.value();return d<m?-1:d>m?1:0});let r=0;const o=e[0].clone();let a=0;const l=lFe(t)*cn(),u=new N;VD(t,e[0].value(),u);for(let c=1;c<i;c++){const h=new N;if(VD(t,e[c].value(),h),e[c].eq(o)||h.isEqualPoint2D(u,l)){if(r!==0){if(e[c].eps()===0)o.setE(e[c]),a=0;else if(a!==0){const d=Di(1/e[c].eps()),m=1/a,f=d+m;o.set((e[c].value()*d+o.value()*m)/f),a=1/f,o.setError(Math.sqrt(a))}e[r].setE(o),VD(t,o.value(),u)}}else r++,e[r].setE(e[c]),o.setE(e[c]),VD(t,o.value(),u),a=Di(e[c].eps())}r++,i=r}return i===1&&(i=2,e[1].set(1)),z(e[0].value()===0),z(e[i-1].value()===1),i}function dFe(t,e,i,s,n){const r=he(ge,4),o=he(ge,3),a=new Me(0,1);let l=0;if(e){if(X7(t,r,!1),l=rL(r[3],r[2],r[1],r[0].sub(i),a,!1,o),s)for(let u=0;u<l;u++){const c=new N;xn(t,o[u].value(),c),s[u]=c.x}}else if(Y7(t,r,!1),l=rL(r[3],r[2],r[1],r[0].sub(i),a,!1,o),s)for(let u=0;u<l;u++){const c=new N;xn(t,o[u].value(),c),s[u]=c.y}if(n)for(let u=0;u<l;u++)n[u]=o[u].value();else s&&wd(s,0,l,Vm);return l}function sB(t,e,i){i.setEmpty();const s=[];s.push(new Me(0,1));const n=.5*Math.max(e.width(),e.height());for(;s.length;){const r=s.at(-1);s.pop();const o=new ua;if(eM(t,r,o),o.isIntersectingW(e)){const a=Math.max(o.width(),o.height());if(e.containsW(o)||a<=n||r.width()<1e-12)i.merge(r);else{const l=r.getCenter();s.push(Me.construct(r.vmin,l)),s.push(Me.construct(l,r.vmax))}}}}function mFe(t,e,i){i.length=0;{const L=new ge;Jpe(t,L);const D=new Et;if(efe(t,L,D),D.isZero())return L.isZero()||L.eq(new ge(1))?0:(i.push(L.value()),1)}const s=he(ge,4);Zpe(t,s,!0);const n=he(ge,4);Kpe(t,n,!0);const r=he(ge,6),o=s[3].negate().mulE(n[1]).addE(s[2].mulE(n[2]).mul(2)).addE(s[1].mulE(n[3])),a=s[3].negate().mulE(n[1]).subE(s[2].mulE(n[2]).mul(2)).addE(s[1].mulE(n[3])),l=s[2].mulE(s[2]).subE(n[2].mulE(n[2]));r[0]=n[1].mulE(n[1]).mulE(o).addE(s[1].mulE(s[1]).mulE(a)).addE(s[1].mulE(n[1]).mulE(l).mul(2)).mul(6),r[1]=s[2].mulE(n[1]).subE(s[1].mulE(n[2])).mulE(s[2].mulE(s[2]).addE(s[1].mulE(s[3]).mul(2)).addE(n[2].mulE(n[2])).addE(n[1].mulE(n[3]).mul(2))).mul(24);const u=s[1].mulE(n[2]).mulE(n[2]).mulE(n[3]),c=s[2].mulE(s[2]).mulE(s[3]).mulE(n[1]).subE(u).mul(156),h=s[3].mulE(n[1]).subE(s[1].mulE(n[3])),d=s[3].mulE(n[1]).subE(s[1].mulE(n[3])),m=s[1].mulE(s[3]).mulE(d).addE(n[1].mulE(n[3]).mulE(h)).mul(72),f=n[1].mulE(n[3]).subE(s[1].mulE(s[3])),_=s[2].mulE(n[2]).mulE(f).mul(120),v=s[1].mulE(s[2]).mulE(s[2]).mulE(n[3]),x=s[3].mulE(n[1]).mulE(n[2]).mulE(n[2]).subE(v).mul(36);r[2]=c.addE(m).addE(_).addE(x);const w=s[2].mulE(s[3]).mulE(s[3]).mulE(n[1]).subE(s[1].mulE(n[2]).mulE(n[3]).mulE(n[3])).mul(360),T=s[2].mulE(n[2]).mulE(s[2].mulE(s[3]).subE(n[2].mulE(n[3]))).addE(s[3].mulE(n[2]).mulE(n[2]).mulE(n[2])).subE(s[2].mulE(s[2]).mulE(s[2]).mulE(n[3])).mul(24),C=s[2].mulE(n[1]).mulE(n[3]).mulE(n[3]).subE(s[1].mulE(s[3]).mulE(s[3]).mulE(n[2])).mul(72),M=s[3].mulE(n[3]).mulE(n[1].mulE(n[2]).subE(s[1].mulE(s[2]))).mul(288);r[3]=w.addE(T).addE(C).addE(M),r[4]=n[3].mulE(n[3]).addE(s[3].mulE(s[3])).mulE(s[3].mulE(n[1]).subE(s[1].mulE(n[3]))).mul(270).addE(s[3].mulE(n[2]).subE(s[2].mulE(n[3]))).mulE(s[2].mulE(s[3]).addE(n[2].mulE(n[3]))).mul(180),r[5]=s[3].mulE(n[2]).subE(s[2].mulE(n[3])).mulE(s[3].mulE(s[3]).addE(n[3].mulE(n[3]))).mul(216);const A=he(ge,5),I=Epe(r,5,new Me(0,1),!1,A,5);if(I>0){let L=Math.abs(t.getCurvature(0)),D=0;const O=Math.abs(t.getCurvature(1));(O>L||!Number.isFinite(O))&&(D=1);for(let U=0;U<I;U++){const $=Math.abs(t.getCurvature(A[U].value()));t.getCoord2D(A[U].value()),($>L||!Number.isFinite($))&&(L=$,D=A[U].value())}if((!Number.isFinite(L)||1/L<e)&&!Vs(D,0,1)){const U=t.getCoord2D(D);if(!U.equals(t.getStartXY())&&!U.equals(t.getEndXY()))return i.push(D),1}}return 0}let pFe=class{constructor(e,i){this.b=e,this.len=i}getMaxDerivative(){return 1}getValue(e,i){return e===0?this.len-ZP(this.b,i,!1):0}getError(e){return 0}};function nB(t,e,i,s,n,r,o){for(;;){const a=N.distance(e[0],e[3]),l=N.distance(e[0],e[1])+N.distance(e[1],e[2])+N.distance(e[2],e[3]);if(l-a<=s+i*l)return t+es(a,l,.5);const u=M=>Qo(e,1,M).length();if(r===0){z(o<8);let M=u(0),A=u(1);n[0]+=2,M>A&&(A=Ge(M,M=A),e[3]=Ge(e[0],e[0]=e[3]),e[2]=Ge(e[1],e[1]=e[2]));let I=M/(M+A),L=1,D=l;for(;I<1/32&&D>=32*(s+i*D);){L/=4;const O=u(L);n[0]++,I=M/(O+M);const U=new N;if(xn(e,.5*L,U),D=N.distance(U,e[0]),D<=s){const $=new N;xn(e,L,$),D+=N.distance($,U)}}if(L!==1){const O=he(N,4);QP(e,L,e,O),t=nB(t,O,i,s,n,0,o+1),r++,o++;continue}}const c=8;n[0]+=c;const h=wm(c,u,0,1),d=16;n[0]+=d;const m=wm(d,u,0,1);let f=Math.abs(h-m)>s+i*l;if(!f)return t+m;if(r<3){const M=he(N,4);QP(e,.5,e,M),t=nB(t,M,i,s,n,r+1,o+1),r++,o++;continue}const _=32;n[0]+=_;const v=wm(_,u,0,1);if(f=Math.abs(m-v)>s+i*l,!f)return t+v;const x=64;n[0]+=x;const w=wm(x,u,0,1);if(f=Math.abs(v-w)>s+i*l,!f)return t+w;const T=128;n[0]+=T;const C=wm(T,u,0,1);return f=Math.abs(w-C)>s+i*l,t+C}}function fFe(t,e,i,s,n){if(i===e)return 0;const r=he(N,4);t.queryControlPoints(r);const o=he(N,4);return w1(r,e,i,o),nB(0,o,s,n,[0],0,0)}function gFe(t,e,i,s,n){let r=!0;const o=hS(5,e,i,s,n,l=>{const u=Wv(t,1,l);return(r?t.getCoordX(l)-t.getStartX():t.getCoordY(l)-t.getStartY())*u.length()});r=!1;const a=hS(5,e,i,s,n,l=>{const u=Wv(t,1,l);return(r?t.getCoordX(l)-t.getStartX():t.getCoordY(l)-t.getStartY())*u.length()});return new N(o,a)}function _Fe(t,e,i,s,n,r,o,a,l){const u=he(N,4);t.queryControlPoints(u);const c=he(N,4);if(e.queryControlPoints(c),u[0].equals(c[0])){if(u[1].equals(c[1])&&u[2].equals(c[2])&&u[3].equals(c[3]))return i&&(i.length=0,i.push(u[0]),i.push(u[3])),s&&(s.length=0,s.push(0),s.push(1)),n&&(n.length=0,n.push(0),n.push(1)),!0;if(!u[0].equals(c[3]))return!1}return!!(u[0].equals(c[3])&&u[1].equals(c[2])&&u[2].equals(c[1])&&u[3].equals(c[0]))&&(s&&(s.length=0,s.push(0),s.push(1),l&&(s[1]=Ge(s[0],s[0]=s[1]))),n&&(n.length=0,n.push(1),n.push(0),l&&(n[1]=Ge(n[0],n[0]=n[1]))),i&&(i.length=0,i.push(u[0]),i.push(u[3]),l&&(i[1]=Ge(i[0],i[0]=i[1]))),!0)}function kU(t,e,i,s,n,r,o,a,l,u,c,h){let d=0,m=0,f=0,_=0,v=0,x=0,w=0;for(let C=1,M=h-1;C<M;C++){let A,I,L,D,O,U,$=-1,B=l[C-1];t&&(C>2?(B=Os(2*l[C-2]-l[C-3],0,1),l[C-1]=B):C===2&&B<=l[0]&&(B=l[0]));for(let Y=0;Y<11&&(A=l[C-1],I=A*A,L=I*A,D=1-A,O=D*D,U=O*D,t)&&!(Math.abs(A-$)<1e-12)&&Y!==10;Y++){const W=i.x-2*s.x+n.x,ee=i.x-3*s.x+3*n.x-r.x,ne=i.y-2*s.y+n.y,j=i.y-3*s.y+3*n.y-r.y,oe=i.x-s.x-2*W*A+ee*I,ve=-c[C].x+i.x*U+A*(3*s.x*O+A*(3*n.x-3*n.x*A+r.x*A)),Ye=i.y-s.y-2*ne*A+j*I,de=-c[C].y+i.y*U+A*(3*s.y*O+A*(3*n.y-3*n.y*A+r.y*A));$=A;const fe=A- -6*(oe*ve+Ye*de)/(6*(3*Di(oe)-(-2*W+2*ee*A)*ve)+6*(3*Di(Ye)-(-2*ne+2*j*A)*de));l[C-1]=Os(fe,C>1?l[C-2]:0,1)}d+=3*I*O*O,m+=3*L*U,f+=3*I*I*O;const V=-(U*i.x+L*r.x-c[C].x);_+=V*A*O,v+=V*I*D;const H=-(U*i.y+L*r.y-c[C].y);x+=H*A*O,w+=H*I*D}if(e){const C=d*f-m*m;Math.abs(C)>=1e-12*(Math.abs(d*f)+Math.abs(m*m))+1e-10?(o||(s.x=(_*f-v*m)/C,s.y=(x*f-w*m)/C),a||(n.x=(d*v-m*_)/C,n.y=(d*w-m*x)/C)):(zn(i,r,.3,s),zn(i,r,.6,n))}let T=0;for(let C=1,M=h-1;C<M;C++){const A=l[C-1],I=1-A,L=i.mul(YQ(I)),D=s.mul(3*A*I*I),O=n.mul(3*A*A*I),U=r.mul(YQ(A));T+=L.add(D).add(O).add(U).sub(c[C]).sqrLength()}return T}function QJ(t,e,i,s){const n=t.getPathStart(e),r=t.getPathEnd(e);if(r-n<3)return;const o=2*n,a=N.getNAN();i.queryPoint2D(o,a);const l=a.x,u=a.y,c=N.getNAN();i.queryPoint2D(o+2,c);const h=N.getNAN();for(let d=o+4,m=2*r;d<m;d+=2)i.queryPoint2D(d,h),s.pe((h.x-a.x)*(c.y-u)),a.setCoordsPoint2D(c),c.setCoordsPoint2D(h);s.pe((l-a.x)*(c.y-u))}function yFe(t,e,i){for(;e.hasNextSegment();){const s=e.nextCurve();if(s===null)break;i.pe(2*s.calculateArea2DHelper())}}var ps=Hs;let wp=class{static toSegType(e){let i=0;switch(e){case q.enumLine:i=1;break;case q.enumBezier:i=2;break;case q.enumEllipticArc:i=4;break;case q.enumRationalBezier2:i=8;break;case q.enumBezier2:i=16;break;default:We("")}return i}constructor(){this.m_segmentFlags=null,this.m_segmentParamIndex=null,this.m_segmentParams=null,this.m_curveCount=0,this.m_bezierCount=0,this.m_arcCount=0,this.m_rbezier2Count=0,this.m_bezier2Count=0,this.m_curveParamWritePoint=0}assignCopy(e){return this.m_segmentFlags=e.m_segmentFlags,this.m_segmentParamIndex=e.m_segmentParamIndex,this.m_segmentParams=e.m_segmentParams,this.m_curveCount=e.m_curveCount,this.m_bezierCount=e.m_bezierCount,this.m_arcCount=e.m_arcCount,this.m_rbezier2Count=e.m_rbezier2Count,this.m_bezier2Count=e.m_bezier2Count,this.m_curveParamWritePoint=e.m_curveParamWritePoint,this}},Z7=class tu extends mpe{constructor(e){super(e),this.m_cachedRingAreas2D=null,this.m_paths=null,this.m_pathFlags=null,this.m_curveData=null,e.move?(this.m_bPolygon=e.move.m_bPolygon,this.m_cachedLength2D=e.move.m_cachedLength2D,this.m_cachedArea2D=e.move.m_cachedArea2D,this.m_currentPathIndex=e.move.m_currentPathIndex,this.m_cachedRingAreas2D=e.move.m_cachedRingAreas2D,this.m_paths=e.move.m_paths,this.m_pathFlags=e.move.m_pathFlags,this.m_curveData=e.move.m_curveData,e.move.m_curveData=null,e.move.setEmpty()):(this.m_bPolygon=e.bPolygon,this.m_cachedLength2D=0,this.m_cachedArea2D=0,this.m_currentPathIndex=0)}getGeometryType(){return this.m_bPolygon?q.enumPolygon:q.enumPolyline}getDimension(){return this.m_bPolygon?2:1}changeRingStartPoint(e){z(this.m_bPolygon);const i=this.getPathIndexFromPointIndex(e),s=this.getPathStart(i);if(s===e)return;const n=this.getPathEnd(i);(e>=n||e<s)&&ce("change_ring_start_point");for(let r=0,o=this.m_description.getAttributeCount();r<o;r++){const a=this.m_description.getSemantics(r),l=ps.getComponentCount(a);this.m_vertexAttributes.get(r).rotate(s*l,e*l,n*l)}this.hasNonLinearSegments()&&(this.m_curveData.m_segmentFlags.rotate(s,e,n),this.m_curveData.m_segmentParamIndex.rotate(s,e,n))}setFillRule(e){this.m_bFillRule=e===1}getFillRule(){return this.m_bFillRule?1:0}isExteriorRingOGC(e){return!!this.m_bPolygon&&(this.updateOGCFlagsProtected(),!!(8&this.m_pathFlags.read(e)))}isExteriorRing(e){return this.calculateRingArea2D(e)>0}calculateRingArea2D(e){return this.m_bPolygon?(this.updateRingAreas2DProtected(),this.m_cachedRingAreas2D.read(e)):0}updateRingAreas2DProtected(){if(!this.hasDirtyFlag(1024))return;const e=this.getPathCount();if(e===0)return this.hasDirtyFlag(1024)&&(this.m_cachedArea2D=0),void this.setDirtyFlagProtected(1024,!1);const i=new FP(e),s=new Wr(0),n=new Wr(0);if(this.m_pointCount!==0){const r=this.getAttributeStreamRef(0);if(this.hasNonLinearSegments()){const o=new RU({parent:this});for(o.stripAttributes();o.nextPath();){n.reset();const a=o.getPathIndex();QJ(this,a,r,n),yFe(this,o,n);const l=.5*n.getResult();s.add(l),i.write(a,l)}}else for(let o=0;o<e;o++){n.reset(),QJ(this,o,r,n);const a=.5*n.getResult();s.add(a),i.write(o,a)}}this.hasDirtyFlag(1024)&&(this.m_cachedArea2D=s.getResult(),this.m_cachedRingAreas2D=i,this.setDirtyFlagProtected(1024,!1))}getOGCPolygonCount(){if(!this.m_bPolygon)return 0;this.updateOGCFlagsProtected();let e=0;const i=this.getPathCount();for(let s=0;s<i;s++)8&this.m_pathFlags.read(s)&&e++;return e}getHashCodeImpl(){return z(0),0}equalsImpl(e){const i=e,s=this.getPathCount();if(s!==i.getPathCount())return!1;const n=this.hasNonLinearSegments();if(n!==i.hasNonLinearSegments()||n&&(this.m_curveData.m_curveCount!==i.m_curveData.m_curveCount||this.m_curveData.m_bezierCount!==i.m_curveData.m_bezierCount)||this.m_paths&&!this.m_paths.equals(i.m_paths,0,s+1)||this.m_bFillRule!==i.m_bFillRule||!this.m_bPolygon&&this.m_pathFlags&&!this.m_pathFlags.equals(i.m_pathFlags,0,s))return!1;if(this.hasNonLinearSegments()){if(!this.m_curveData.m_segmentFlags.equals(i.m_curveData.m_segmentFlags,0,this.getPointCount()))return!1;for(let r=0,o=this.getPointCount();r<o;r++){const a=this.m_curveData.m_segmentFlags.read(r);if(!tu.isNonLinearSegmentFlag(a))continue;const l=this.m_curveData.m_segmentParamIndex.read(r),u=i.m_curveData.m_segmentParamIndex.read(r),c=qu(a);for(let h=0;h<c;h++){const d=this.m_curveData.m_segmentParams.read(l+h),m=i.m_curveData.m_segmentParams.read(u+h);if(!Ma(d,m))return!1}}}return!0}equalsImplTol(e,i){const s=e,n=this.getPathCount();if(n!==s.getPathCount())return!1;const r=this.hasNonLinearSegments();if(r!==s.hasNonLinearSegments()||r&&(this.m_curveData.m_curveCount!==s.m_curveData.m_curveCount||this.m_curveData.m_bezierCount!==s.m_curveData.m_bezierCount)||this.m_paths&&!this.m_paths.equals(s.m_paths,0,n+1)||this.m_bFillRule!==s.m_bFillRule||!this.m_bPolygon&&this.m_pathFlags&&!this.m_pathFlags.equals(s.m_pathFlags,0,n))return!1;if(!r)return!0;if(!this.m_curveData.m_segmentFlags.equals(s.m_curveData.m_segmentFlags,0,this.getPointCount()))return!1;const o=this.querySegmentIterator(),a=s.querySegmentIterator();for(;o.nextPath();){if(!a.nextPath())return!1;for(;o.hasNextSegment();){const l=o.nextCurve(),u=a.nextCurve();if(!(l&&u&&l.equals(u,i))){if(!l&&!u)break;return!1}}}return!0}reserveImplImpl(e,i){this.m_curveData&&this.m_curveData.m_segmentFlags&&(this.m_curveData.m_segmentFlags.resize(e,1),this.m_curveData.m_segmentParamIndex.resize(e,-1),this.checkCompactSegmentParams())}verifyStreamsAfterSizeChangeExtraImpl(){this.m_paths||(this.m_paths=Do(1,0),this.m_pathFlags=_m(1,0)),this.m_curveData&&this.m_curveData.m_segmentFlags&&(this.m_curveData.m_segmentFlags.resize(this.m_reservedPointCount,1),this.m_curveData.m_segmentParamIndex.resize(this.m_reservedPointCount,-1),this.checkCompactSegmentParams())}copyToImpl(e,i){const s=e;s.m_bPathStarted=!1,s.m_bFillRule=this.m_bFillRule,this.m_paths?s.m_paths=i?this.m_paths:this.m_paths.clone():s.m_paths=null,this.m_pathFlags?s.m_pathFlags=i?this.m_pathFlags:this.m_pathFlags.clone():s.m_pathFlags=null,this.m_curveData&&(s.m_curveData||(s.m_curveData=new wp),s.m_curveData.assignCopy(this.m_curveData),s.m_curveData.m_curveCount=0,s.updateCurveCounter(this.m_curveData.m_curveCount),i||(this.m_curveData.m_segmentParamIndex?s.m_curveData.m_segmentParamIndex=this.m_curveData.m_segmentParamIndex.clone():s.m_curveData.m_segmentParamIndex=null,this.m_curveData.m_segmentFlags?s.m_curveData.m_segmentFlags=this.m_curveData.m_segmentFlags.clone():s.m_curveData.m_segmentFlags=null,this.m_curveData.m_segmentParams?s.m_curveData.m_segmentParams=this.m_curveData.m_segmentParams.clone():s.m_curveData.m_segmentParams=null)),s.hasDirtyFlag(512)||(s.m_cachedLength2D=this.m_cachedLength2D),s.m_cachedRingAreas2D=null,s.hasDirtyFlag(1024)||(s.m_cachedArea2D=this.m_cachedArea2D,this.m_cachedRingAreas2D!==null&&(s.m_cachedRingAreas2D=i?this.m_cachedRingAreas2D:this.m_cachedRingAreas2D.clone()))}calculateArea2D(){return this.m_bPolygon?(this.updateRingAreas2DProtected(),this.m_cachedArea2D):0}calculateLength2D(){if(!this.hasDirtyFlag(512))return this.m_cachedLength2D;const e=this.querySegmentIterator(),i=new Wr(0);for(;e.nextPath();)for(;e.hasNextSegment();)i.add(e.nextSegment().calculateLength2D());return this.hasDirtyFlag(512)&&(this.m_cachedLength2D=i.getResult()),this.setDirtyFlagProtected(512,!1),i.getResult()}calculatePathLength2D(e){const i=this.querySegmentIteratorAtVertex(this.getPathStart(e)),s=new Wr(0);for(;i.hasNextSegment();)s.add(i.nextSegment().calculateLength2D());return s.getResult()}calculateLength3D(e){return z(0),0}calculatePathLength3D(e,i){return z(0),0}copyTo(e){Ei(e.getGeometryType())||ce(""),this!==e&&super.copyTo(e)}swap(e){z(0)}hasNonLinearSegments(){return this.getCurveCount()!==0}getSegmentCount(){let e=this.getPointCount();if(!this.m_bPolygon){e-=this.getPathCount();for(let i=0,s=this.getPathCount();i<s;i++)this.isClosedPath(i)&&e++}return e}getSegmentCountPath(e){let i=this.getPathSize(e);return!this.isClosedPath(e)&&i>0&&i--,i}add(e,i){this===e&&ce("Multi_path_impl::add");for(let s=0,n=e.getPathCount();s<n;s++)this.addPath(e,s,!i)}addPath(e,i,s){this.insertPath(-1,e,i,s)}addPathPoint2D(e,i,s){this.insertPath2D(-1,e,0,i,s)}addPathMultiPoint(e,i,s,n){s<0&&(s=e.getPointCount()-i),this.insertPointsFromMultipoint(-1,0,e,i,s,n)}addSegmentsFromPath(e,i,s,n,r){if(this===e&&ce("Multi_path_impl.add_segments_from_path"),r||this.getPathCount()!==0||(r=!0),i<0&&(i=e.getPathCount()-1),(i>=e.getPathCount()||s<0||n<0||s+n>e.getSegmentCountPath(i))&&bi("add_segments_from_path"),n===0)return;const o=e.getPathStart(i),a=e.isClosedPath(i)&&s+n===e.getSegmentCountPath(i);this.m_bPathStarted=!1,this.mergeVertexDescription(e.getDescription());let l=n;const u=o+s;let c=u+1;r&&(l++,c--),!r&&e.hasNonLinearSegments()&&e.m_curveData.m_segmentFlags.read(u)!==1&&(e.getXY(u).equals(this.getXY(this.m_pointCount-1))||ce("add_segments_from_path: start point mismatch"));const h=this.m_pointCount;if(this.resizeImpl(this.m_pointCount+l),this.verifyAllStreamsAfterSizeChange(),r){if(l===0)return;this.m_paths.add(this.m_pointCount);let m=e.m_pathFlags.read(i);this.m_bPolygon&&(m|=1),this.m_pathFlags.write(this.m_pathFlags.size()-1,m),this.m_pathFlags.add(0)}else this.m_paths.write(this.m_pathFlags.size()-1,this.m_pointCount);const d=a?l-1:l;for(let m=0,f=this.m_description.getAttributeCount();m<f;m++){const _=this.m_description.getSemantics(m),v=ps.getComponentCount(_),x=e.m_description.getAttributeIndex(_);if(d>0){if(x<0||!e.m_vertexAttributes.get(x)){const w=ps.getDefaultValue(_);this.m_vertexAttributes.get(m).insertRange(v*h,w,d*v,v*h),a&&this.m_vertexAttributes.get(m).insertRange(v*h+d*v,w,v,v*h);continue}this.m_vertexAttributes.get(m).insertRangeFromStream(v*h,e.m_vertexAttributes.get(x),v*c,d*v,!0,v,v*h)}a&&this.m_vertexAttributes.get(m).insertRangeFromStream(v*(h+d),e.m_vertexAttributes.get(x),v*o,v,!0,v,v*(h+d))}if(this.hasNonLinearSegments()&&this.initSegmentData(0),e.hasNonLinearSegments()){let m=0;for(let f=0,_=u;f<n;f++)m+=qu(e.m_curveData.m_segmentFlags.read(_)),_++;if(m>0){this.initSegmentData(m);let f=u,_=h-(r?0:1),v=0;for(let x=0;x<n;x++){const w=e.m_curveData.m_segmentFlags.read(f);if(this.m_curveData.m_segmentFlags.write(_,w),tu.isNonLinearSegmentFlag(w)){v++;let T=e.m_curveData.m_segmentParamIndex.read(f);const C=qu(w);this.m_curveData.m_segmentParamIndex.write(_,this.m_curveData.m_curveParamWritePoint);for(let M=0;M<C;M++){const A=e.m_curveData.m_segmentParams.read(T);this.m_curveData.m_segmentParams.write(this.m_curveData.m_curveParamWritePoint,A),this.m_curveData.m_curveParamWritePoint++,T++}this.incCurveType(w,1)}else this.m_curveData.m_segmentParamIndex.write(_,-1);_++,f++}this.modifyCurveCounter(v)}}if(a){const m=this.getPathCount()-1,f=this.getPathStart(m),_=this.getPathEnd(m)-1,v=this.getXY(f),x=this.getXY(_);v.isEqualPoint2D(x)&&(--this.m_pointCount,this.m_paths.write(m+1,this.m_pointCount))}this.notifyModifiedFlags(2001)}reverseAllPaths(){for(let e=0,i=this.getPathCount();e<i;e++)this.reversePath(e)}reversePath(e){e>=this.getPathCount()&&ce("");const i=this.getPathSize(e);if(i===0)return;const s=this.getPathStart(e),n=this.isClosedPath(e);if(this.hasNonLinearSegments()){let a=s;const l=new this.m_segmentBufferCTor;let u=!1;for(let c=0;c<i;c++,a++){const h=this.m_curveData.m_segmentFlags.read(a);if(!tu.isNonLinearSegmentFlag(h))continue;u=!0,this.querySegment(a,l,!0),l.get().reverse();const d=this.m_curveData.m_segmentParamIndex.read(a);l.get().writeInBufferStream(this.m_curveData.m_segmentParams,d)}if(u){const c=n?0:1;this.m_curveData.m_segmentFlags.reverseRange(s,i-c,1),this.m_curveData.m_segmentParamIndex.reverseRange(s,i-c,1)}}const r=n?1:0;for(let a=0,l=this.m_description.getAttributeCount();a<l;a++)if(this.m_vertexAttributes.get(a)){const u=this.m_description.getSemantics(a),c=ps.getComponentCount(u);this.m_vertexAttributes.get(a).reverseRange(c*(s+r),c*(i-r),c)}const o=6&this.m_pathFlags.read(e);if(o){let a=0;4&o&&(a|=2),2&o&&(a|=4),this.m_pathFlags.clearBits(e,6),this.m_pathFlags.setBits(e,a)}this.notifyModifiedFlags(1233)}removePath(e){const i=this.getPathCount();e<0&&(e=i-1),e>=i&&ce("");const s=this.getPathStart(e),n=this.getPathSize(e);for(let r=0,o=this.m_description.getAttributeCount();r<o;r++)if(this.m_vertexAttributes.get(r)){const a=this.m_description.getSemantics(r),l=ps.getComponentCount(a);this.m_vertexAttributes.get(r).eraseRange(l*s,l*n,l*this.m_pointCount)}if(this.hasNonLinearSegments()){let r=0;for(let o=s,a=s+n;o<a;o++){const l=this.m_curveData.m_segmentFlags.read(o);tu.isNonLinearSegmentFlag(l)&&(this.incCurveType(l,-1),r++)}this.modifyCurveCounter(-r),this.m_curveData.m_segmentFlags.eraseRange(s,n,this.m_pointCount),this.m_curveData.m_segmentParamIndex.eraseRange(s,n,this.m_pointCount)}for(let r=e+1;r<=i;r++){const o=this.m_paths.read(r);this.m_paths.write(r-1,o-n)}if(this.m_pathFlags)for(let r=e+1;r<=i;r++){const o=this.m_pathFlags.read(r);this.m_pathFlags.write(r-1,o)}this.m_paths.resize(i),this.m_pathFlags.resize(i),this.m_pointCount-=n,this.m_reservedPointCount-=n,e===i-1&&(this.m_bPathStarted=!1),this.notifyModifiedFlags(2001),this.checkCompactSegmentParams(),this.dbgVerifyCurves()}dbgVerifyCurves(){}insertPath(e,i,s,n){this===i&&ce("Multi_path_impl::insert_path");const r=this.getPathCount();if(!n&&i.hasNonLinearSegmentsPath(s))return e=this.insertPath(e,i,s,!0),this.reversePath(e),e;s>=i.getPathCount()&&ce(""),e>r&&ce(""),e<0&&(e=r),s<0&&(s=i.getPathCount()-1),this.m_bPathStarted=!1,this.mergeVertexDescription(i.getDescription());const o=i.getPathStart(s),a=i.getPathSize(s);if(a===0)return this.insertPath2D(e,null,0,0,!0);const l=this.m_pointCount,u=i.isClosedPath(s)&&!n?1:0;this.resizeImpl(this.m_pointCount+a),this.verifyAllStreamsAfterSizeChange();const c=e<r?this.getPathStart(e):l;for(let m=0,f=this.m_description.getAttributeCount();m<f;m++){const _=this.m_description.getSemantics(m),v=i.getDescription().getAttributeIndex(_),x=ps.getComponentCount(_);if(v>=0&&i.m_vertexAttributes.get(v))u!==0&&this.m_vertexAttributes.get(m).insertRangeFromStream(c*x,i.m_vertexAttributes.get(v),x*o,x,!0,x,x*l),this.m_vertexAttributes.get(m).insertRangeFromStream((c+u)*x,i.m_vertexAttributes.get(v),x*(o+u),x*(a-u),n,x,x*(l+u));else{const w=ps.getDefaultValue(_);this.m_vertexAttributes.get(m).insertRange(c*x,w,x*a,x*l)}}const h=l+a;this.m_paths.add(h);for(let m=r;m>=e+1;m--){const f=this.m_paths.read(m-1);this.m_paths.write(m,f+a)}this.m_pathFlags.add(0);for(let m=r-1;m>=e+1;m--){let f=this.m_pathFlags.read(m);f&=-9,this.m_pathFlags.write(m+1,f)}let d=i.getPathFlagsStreamRef().read(s);if(d&=-9,this.m_bPolygon&&(d|=1),this.m_pathFlags.write(e,d),i.hasNonLinearSegments()){this.initSegmentData(0);let m=o,f=0;for(let _=0;_<a;_++)f+=qu(i.m_curveData.m_segmentFlags.read(m)),m++;if(f>0){this.m_curveData.m_segmentFlags===null?(this.m_curveData.m_segmentFlags=_m(this.m_pointCount,1),this.m_curveData.m_segmentParamIndex=Do(this.m_pointCount,-1)):(this.m_curveData.m_segmentFlags.insertRange(c,1,a,l),this.m_curveData.m_segmentParamIndex.insertRange(c,-1,a,l)),this.m_curveData.m_segmentParams?this.m_curveData.m_segmentParams.resize(this.m_curveData.m_curveParamWritePoint+f):this.m_curveData.m_segmentParams=Nl(f),m=o;let _=c,v=0;for(let x=0;x<a;x++){const w=i.m_curveData.m_segmentFlags.read(m);if(tu.isNonLinearSegmentFlag(w)){this.m_curveData.m_segmentFlags.write(_,w),this.m_curveData.m_segmentParamIndex.write(_,this.m_curveData.m_curveParamWritePoint);const T=qu(w);let C=i.m_curveData.m_segmentParamIndex.read(m);for(let M=0;M<T;M++){const A=i.m_curveData.m_segmentParams.read(C);this.m_curveData.m_segmentParams.write(this.m_curveData.m_curveParamWritePoint,A),this.m_curveData.m_curveParamWritePoint++,C++}v++,this.incCurveType(w,1)}m++,_++}this.modifyCurveCounter(v)}}return this.notifyModifiedFlags(2001),e}insertPath2D(e,i,s,n,r){const o=this.getPathCount();(e>o||s<0)&&ce(""),e<0&&(e=o),this.m_bPathStarted=!1;const a=this.m_pointCount;this.resizeImpl(this.m_pointCount+n),n===0&&this.notifyModifiedFlags(32),this.verifyAllStreamsAfterSizeChange();const l=e<o?this.getPathStart(e):a;if(i)this.m_vertexAttributes.get(0).insertRangeFromPoints(2*l,i,s,n,r,2*a);else{const u=ps.getDefaultValue(0);this.m_vertexAttributes.get(0).insertRange(2*l,u,2*n,2*a)}for(let u=1,c=this.m_description.getAttributeCount();u<c;u++){const h=this.m_description.getSemantics(u),d=ps.getComponentCount(h),m=ps.getDefaultValue(h);this.m_vertexAttributes.get(u).insertRange(l*d,m,d*n,d*a)}this.m_paths.add(this.m_pointCount);for(let u=o;u>=e+1;u--){const c=this.m_paths.read(u-1);this.m_paths.write(u,c+n)}this.m_pathFlags.add(0);for(let u=o-1;u>=e+1;u--){let c=this.m_pathFlags.read(u);c&=-9,this.m_pathFlags.write(u+1,c)}return this.m_bPolygon&&this.m_pathFlags.write(e,1),this.hasNonLinearSegments()&&(this.m_curveData.m_segmentFlags.insertRange(l,1,n,a),this.m_curveData.m_segmentParamIndex.insertRange(l,-1,n,a)),this.notifyModifiedFlags(2001),e}insertPathFromMultipoint(e,i,s,n,r){const o=i.getImpl(),a=this.getPathCount();(e>a||s<0)&&ce("");const l=n<0?o.getPointCount()-s:n;if(l>o.getPointCount()&&ce(""),s>=o.getPointCount()&&ce("pointsOffset"),e<0&&(e=a),this.m_bPathStarted=!1,this.mergeVertexDescription(o.getDescription()),l===0)return void this.insertPath2D(e,null,0,0,!0);const u=this.m_pointCount,c=s;this.resizeImpl(this.m_pointCount+l),this.verifyAllStreamsAfterSizeChange();const h=e<a?this.getPathStart(e):u;for(let f=0,_=this.m_description.getAttributeCount();f<_;f++){const v=this.m_description.getSemantics(f),x=o.getDescription().getAttributeIndex(v),w=ps.getComponentCount(v);if(x>=0){const T=o.getAttributeStreamRef(v);this.m_vertexAttributes.get(f).insertRangeFromStream(h*w,T,w*c,w*l,r,w,w*u)}else{const T=ps.getDefaultValue(v);this.m_vertexAttributes.get(f).insertRange(h*w,T,w*l,w*u)}}const d=u+l;this.m_paths.add(d);for(let f=a;f>=e+1;f--){const _=this.m_paths.read(f-1);this.m_paths.write(f,_+l)}this.m_pathFlags.add(0);for(let f=a-1;f>=e+1;f--){let _=this.m_pathFlags.read(f);_&=-9,this.m_pathFlags.write(f+1,_)}let m=0;this.m_bPolygon&&(m|=1),this.m_pathFlags.write(e,m),this.notifyModifiedFlags(2001)}insertPoints(e,i,s,n,r,o,a){var m;if(this===s&&ce("Multi_path_impl.insert_points"),e<0&&(e=this.getPathCount()),n<0&&(n=s.getPathCount()-1),(e>this.getPathCount()||i>=0&&i>this.getPathSize(e)||n>=s.getPathCount()||o>s.getPathSize(n))&&bi(""),!o)return;if(this.mergeVertexDescription(s.m_description),e===this.getPathCount()){this.m_paths.add(this.m_pointCount);let f=s.m_pathFlags.read(n);f&=-9,this.m_bPolygon?this.m_pathFlags.add(1|f):this.m_pathFlags.add(f)}i<0&&(i=this.getPathSize(e));const l=this.m_pointCount;this.resizeImpl(this.m_pointCount+o),this.verifyAllStreamsAfterSizeChange();const u=this.getPathStart(e),c=u+i;o<0&&(o=s.getPathSize(n));const h=s.getPathStart(n),d=h+o;for(let f=0,_=this.m_description.getAttributeCount();f<_;f++){const v=this.m_description.getSemantics(f),x=ps.getComponentCount(v),w=s.m_description.getAttributeIndex(v);if(w<0||!s.m_vertexAttributes.get(w)){const T=ps.getDefaultValue(v);this.m_vertexAttributes.get(f).insertRange(x*c,T,d*x,x*l)}else(m=this.m_vertexAttributes.get(f))==null||m.insertRangeFromStream(x*(u+i),s.m_vertexAttributes.get(w),x*(h+r),o*x,a,x,x*l)}this.hasNonLinearSegments()&&(this.m_curveData.m_segmentFlags.insertRange(u+i,1,o,l),this.m_curveData.m_segmentParamIndex.insertRange(u+i,-1,o,l),i>0&&this.isNonLinearSegment(u+i-1)&&(this.incCurveType(this.m_curveData.m_segmentFlags.read(u+i-1),-1),this.m_curveData.m_segmentFlags.write(u+i-1,1),this.m_curveData.m_segmentParamIndex.write(u+i-1,-1),this.modifyCurveCounter(-1)));for(let f=e+1,_=this.getPathCount();f<=_;f++){const v=this.m_paths.read(f);this.m_paths.write(f,v+o)}this.notifyModifiedFlags(2001)}insertPointsFromPoints(e,i,s,n,r,o){if(e<0&&(e=this.getPathCount()),(e>this.getPathCount()||i>this.getPathSize(e)||n<0)&&bi(""),!r)return;e===this.getPathCount()&&(this.m_paths.add(this.m_pointCount),this.m_bPolygon?this.m_pathFlags.add(1):this.m_pathFlags.add(0)),i<0&&(i=this.getPathSize(e));const a=this.m_pointCount;this.resizeImpl(this.m_pointCount+r),this.verifyAllStreamsAfterSizeChange();const l=this.getPathStart(e);this.m_vertexAttributes.get(0).insertRangeFromPoints(2*(l+i),s,n,r,o,2*a);for(let u=1,c=this.m_description.getAttributeCount();u<c;u++){const h=this.m_description.getSemantics(u),d=ps.getComponentCount(h),m=ps.getDefaultValue(h);this.m_vertexAttributes.get(u).insertRange((l+i)*d,m,d*r,d*a)}this.hasNonLinearSegments()&&(this.m_curveData.m_segmentFlags.insertRange(l+i,1,r,a),this.m_curveData.m_segmentParamIndex.insertRange(l+i,-1,r,a),i>0&&this.isNonLinearSegment(l+i-1)&&(this.incCurveType(this.m_curveData.m_segmentFlags.read(l+i-1),-1),this.m_curveData.m_segmentFlags.write(l+i-1,1),this.m_curveData.m_segmentParamIndex.write(l+i-1,-1),this.modifyCurveCounter(-1)));for(let u=e+1,c=this.getPathCount();u<=c;u++)this.m_paths.write(u,this.m_paths.read(u)+r);this.notifyModifiedFlags(2001)}insertPointsFromMultipoint(e,i,s,n,r,o){const a=s.getImpl(),l=this.getPathCount();e<0&&(e=this.getPathCount());const u=a.getPointCount();if((n<0||n>u)&&bi(""),(r<0||n+r>u)&&(r=u-n),i<0&&(i=e<l?this.getPathSize(e):0),(e>l||e<l&&i>this.getPathSize(e)||e===l&&i>0||r<0)&&bi(""),!r)return;if(this.mergeVertexDescription(a.getDescription()),e===l){this.m_paths.add(this.m_pointCount);const _=0;this.m_bPolygon?this.m_pathFlags.add(1|_):this.m_pathFlags.add(_)}i<0&&(i=this.getPathSize(e));const c=this.m_pointCount;this.resizeImpl(this.m_pointCount+r),this.verifyAllStreamsAfterSizeChange();const h=this.getPathStart(e),d=h+i,m=0,f=m+r;for(let _=0,v=this.m_description.getAttributeCount();_<v;_++){const x=this.m_description.getSemantics(_),w=ps.getComponentCount(x);if(a.getDescription().getAttributeIndex(x)<0){const C=ps.getDefaultValue(x);this.m_vertexAttributes.get(_).insertRange(w*d,C,f*w,w*c);continue}const T=a.getAttributeStreamRef(x);this.m_vertexAttributes.get(_).insertRangeFromStream(w*(h+i),T,w*(m+n),r*w,o,w,w*c)}this.hasNonLinearSegments()&&(this.m_curveData.m_segmentFlags.insertRange(h+i,1,r,c),this.m_curveData.m_segmentParamIndex.insertRange(h+i,-1,r,c),i>0&&this.isNonLinearSegment(h+i-1)&&(this.incCurveType(this.m_curveData.m_segmentFlags.read(h+i-1),-1),this.m_curveData.m_segmentFlags.write(h+i-1,1),this.m_curveData.m_segmentParamIndex.write(h+i-1,-1),this.modifyCurveCounter(-1)));for(let _=e+1,v=this.getPathCount();_<=v;_++){const x=this.m_paths.read(_);this.m_paths.write(_,x+r)}this.notifyModifiedFlags(2001)}insertPoint2D(e,i,s){const n=this.getPathCount();e<0&&(e=n),(e>n||e<n&&i>this.getPathSize(e))&&bi(""),e===n&&this.addPathPoint2D(null,0,!0);const r=this.m_pointCount;this.resizeImpl(this.m_pointCount+1),this.verifyAllStreamsAfterSizeChange();const o=this.getPathStart(e),a=i<0?this.getPathSize(e)+o:i+o,l=this.m_vertexAttributes.get(0);if(a===r)this.m_paths.write(e+1,r+1),l.writePoint2D(2*a,s);else{l.insert(2*a,s,2*r);for(let u=1,c=this.m_description.getAttributeCount();u<c;u++){const h=this.m_description.getSemantics(u),d=ps.getComponentCount(h),m=ps.getDefaultValue(h);this.m_vertexAttributes.get(u).insertRange(d*a,m,d,d*r)}this.m_curveData&&this.m_curveData.m_segmentFlags&&(this.m_curveData.m_segmentFlags.insertRange(a,1,1,r),this.m_curveData.m_segmentParamIndex.insertRange(a,-1,1,r));for(let u=e+1,c=n;u<=c;u++)this.m_paths.write(u,this.m_paths.read(u)+1)}this.m_curveData&&this.m_curveData.m_segmentFlags&&a>o&&this.isNonLinearSegment(a-1)&&(this.incCurveType(this.m_curveData.m_segmentFlags.read(a-1),-1),this.modifyCurveCounter(-1),this.m_curveData.m_segmentFlags.write(a-1,1),this.m_curveData.m_segmentParamIndex.write(a-1,-1)),this.notifyModifiedFlags(2001)}insertPoint(e,i,s){const n=this.getPathCount();e<0&&(e=n),(e>n||e<n&&i>this.getPathSize(e))&&bi(""),e===n&&this.addPathPoint2D(null,0,!0);const r=this.m_pointCount;this.resizeImpl(this.m_pointCount+1),this.verifyAllStreamsAfterSizeChange();const o=this.getPathStart(e),a=i<0?this.getPathSize(e)+o:i+o;if(a===r)this.m_paths.write(e+1,r+1),this.setPointByVal(a,s);else{const l=s.getDescription();this.m_description!==l&&this.mergeVertexDescription(l);for(let u=0,c=this.m_description.getAttributeCount();u<c;u++){const h=this.m_description.getSemantics(u),d=ps.getComponentCount(h);if(l.hasAttribute(h))this.m_vertexAttributes.get(u).insertAttributes(d*a,s,h,d*r);else{const m=ps.getDefaultValue(h);this.m_vertexAttributes.get(u).insertRange(d*a,m,d,d*r)}}this.m_curveData&&this.m_curveData.m_segmentFlags&&(this.m_curveData.m_segmentFlags.insertRange(a,1,1,r),this.m_curveData.m_segmentParamIndex.insertRange(a,-1,1,r));for(let u=e+1,c=n;u<=c;u++)this.m_paths.write(u,this.m_paths.read(u)+1)}this.m_curveData&&this.m_curveData.m_segmentFlags&&a>o&&this.isNonLinearSegment(a-1)&&(this.incCurveType(this.m_curveData.m_segmentFlags.read(a-1),-1),this.modifyCurveCounter(-1),this.m_curveData.m_segmentFlags.write(a-1,1),this.m_curveData.m_segmentParamIndex.write(a-1,-1)),this.notifyModifiedFlags(2001)}removePointFromPath(e,i){const s=this.getPathCount();e<0&&(e=s-1),(e>=s||i>=this.getPathSize(e))&&bi("Multi_path.remove_point");const n=this.getPathStart(e),r=this.isClosedPath(e);i<0&&(i=this.getPathSize(e)-1),i<0&&bi("Multi_path.remove_point");const o=n+i;for(let a=0,l=this.m_description.getAttributeCount();a<l;a++)if(this.m_vertexAttributes.get(a)){const u=this.m_description.getSemantics(a),c=ps.getComponentCount(u);this.m_vertexAttributes.get(a).eraseRange(c*o,c,c*this.m_pointCount)}if(this.m_curveData&&this.m_curveData.m_segmentFlags){this.checkCompactSegmentParams();let a=0;if(o>n&&this.isNonLinearSegment(o-1))a+=1,this.incCurveType(this.m_curveData.m_segmentFlags.read(o-1),-1),this.m_curveData.m_segmentFlags.write(o-1,1),this.m_curveData.m_segmentParamIndex.write(o-1,-1);else{const l=this.getPathEnd(e);r&&n+1<l&&this.isNonLinearSegment(l-1)&&(this.incCurveType(this.m_curveData.m_segmentFlags.read(l-1),-1),this.m_curveData.m_segmentFlags.write(l-1,1),this.m_curveData.m_segmentParamIndex.write(l-1,-1),a+=1)}this.isNonLinearSegment(o)&&(this.incCurveType(this.m_curveData.m_segmentFlags.read(o),-1),a+=1),a>0&&this.modifyCurveCounter(-a),this.m_curveData.m_segmentFlags.eraseRange(o,1,this.m_pointCount),this.m_curveData.m_segmentParamIndex.eraseRange(o,1,this.m_pointCount)}for(let a=s;a>=e+1;a--){const l=this.m_paths.read(a);this.m_paths.write(a,l-1)}this.m_pointCount--,this.m_reservedPointCount--,this.notifyModifiedFlags(2001)}removePoint(e){let i;i=e<0?this.getPathCount()-1:this.getPathIndexFromPointIndex(e),this.removePointFromPath(i,e-this.getPathStart(i))}getNumberOfCurves(e){if(!this.hasNonLinearSegments())return 0;let i=0;for(let s=this.getPathStart(e),n=this.getPathEnd(e);s<n;s++)tu.isNonLinearSegmentFlag(this.m_curveData.m_segmentFlags.read(s))&&++i;return i}getPathCount(){return this.m_paths?this.m_paths.size()-1:0}getPathSize(e){return this.m_paths.read(e+1)-this.m_paths.read(e)}getPathStart(e){return this.m_paths.read(e)}getPathEnd(e){return this.m_paths.read(e+1)}getPathIndexFromPointIndex(e,i=-1){i===-1&&(i=this.m_currentPathIndex);const s=this.getPathCount(),n=tu.getPathIndexFromPointIndexImpl(this.m_paths,s,e,i);return this.m_currentPathIndex=n,n}startPathCoords(e,i){this.startPathPoint(new Jt({x:e,y:i}))}startPath(e){this.startPathPoint(new Jt({pt:e}))}startPath3D(e){this.startPathPoint(new Jt({x:e.x,y:e.y,z:e.z}))}startPath3DCoords(e,i,s){this.startPathPoint(new Jt({x:e,y:i,z:s}))}startPathPoint(e){e.isEmpty()&&ce("");const i=e.getDescription();let s;if(this.m_description!==i){this.mergeVertexDescription(i);const n=new Jt({vd:this.m_description});e.copyCommonAttributesTo(n),s=n}else s=e;this.m_bPathStarted?this.setPointByVal(this.m_pointCount-1,s):(this.insertPoint(-1,-1,s),this.m_bPathStarted=!0)}beforeNewSegmentHelper2(){this.m_paths=Do(2),this.m_paths.write(0,0),this.m_pathFlags=_m(2,0),this.m_bPolygon&&this.m_pathFlags.write(0,1)}beforeNewSegmentHelper1(){this.m_paths!==null?(this.m_paths.add(0),this.m_pathFlags.add(0),this.m_bPolygon&&this.m_pathFlags.write(this.m_pathFlags.size()-2,1)):this.beforeNewSegmentHelper2()}beforeNewSegment(e){this.m_pointCount!==0||this.m_bPathStarted||this.startPathCoords(0,0);const i=this.m_pointCount,s=this.m_paths.size()-1,n=i+e;this.m_paths.write(s,n),this.resizeImpl(n),this.m_bPathStarted&&(this.m_bPathStarted=!1)}finishLineTo(){if(this.hasNonLinearSegments()){const e=this.m_curveData.m_segmentFlags.read(this.m_pointCount-1);e!==1&&(this.m_curveData.m_segmentFlags.write(this.m_pointCount-1,1),this.m_curveData.m_segmentParamIndex.write(this.m_pointCount-1,-1),this.modifyCurveCounter(-1),this.incCurveType(e,-1))}}lineToCoords(e,i){if(this.beforeNewSegment(1),this.m_description.getAttributeCount()===1)this.setXYCoords(this.m_pointCount-1,e,i);else{const s=vm(),n=new Jt({vd:this.m_description,attribBuffer:s,initDefaultValues:!0});n.setXYCoords(e,i),this.setPointByVal(this.m_pointCount-1,n)}this.finishLineTo()}lineTo(e){this.lineToCoords(e.x,e.y)}lineTo3D(e){this.beforeNewSegment(1);const i=JS(this.m_description,LP()),s=vm(),n=new Jt({vd:i,attribBuffer:s,initDefaultValues:!0});n.setXYZ(e),this.setPointByVal(this.m_pointCount-1,n),this.finishLineTo()}lineTo3DCoords(e,i,s){this.lineTo3D(new gi(e,i,s))}lineToPoint(e){if(this.beforeNewSegment(1),this.m_description===e.getDescription())this.setPointByVal(this.m_pointCount-1,e);else{this.mergeVertexDescription(e.getDescription());const i=vm(),s=new Jt({vd:this.m_description,attribBuffer:i,initDefaultValues:!1});e.copyCommonAttributesTo(s),this.setPointByVal(this.m_pointCount-1,s)}this.finishLineTo()}openPathAndDuplicateStartVertex(e){this.m_bPolygon&&We("");const i=this.getPathCount();if(e>i&&ce(""),!this.isClosedPath(e))return;this.m_pathFlags||We("");const s=this.m_pointCount,n=this.getPathStart(e),r=this.getPathEnd(e);if(r-n!=0){this.resizeImpl(this.m_pointCount+1),this.verifyAllStreamsAfterSizeChange();for(let o=0,a=this.m_description.getAttributeCount();o<a;o++)if(this.m_vertexAttributes.get(o)){const l=this.m_description.getSemantics(o),u=ps.getComponentCount(l);this.m_vertexAttributes.get(o).insertRangeFromStream(u*r,this.m_vertexAttributes.get(o),u*n,u,!0,1,u*s)}for(let o=i;o>e;o--){const a=this.m_paths.read(o);this.m_paths.write(o,a+1)}this.hasNonLinearSegments()&&(this.m_curveData.m_segmentFlags.insertRange(r,1,1,s),this.m_curveData.m_segmentParamIndex.insertRange(r,-1,1,s)),this.m_pathFlags.clearBits(e,1)}}openPath(e){this.m_bPolygon&&We(""),e>this.getPathCount()&&ce(""),this.m_pathFlags||We(""),this.m_pathFlags.clearBits(e,1)}isStrongPathStart(e){return!!(2&this.m_pathFlags.read(e))}setStrongPathStart(e,i){i?this.m_pathFlags.setBits(e,2):this.m_pathFlags.clearBits(e,2)}isStrongPathEnd(e){return!!(4&this.m_pathFlags.read(e))}setStrongPathEnd(e,i){i?this.m_pathFlags.setBits(e,4):this.m_pathFlags.clearBits(e,4)}clearStrongPathEnds(){for(let e=0,i=this.getPathCount();e<i;++e)this.m_pathFlags.clearBits(e,6)}openAllPathsAndDuplicateStartVertex(){if(this.m_bPolygon&&We(""),this.isEmpty())return;this.m_pathFlags||We("");let e=0;const i=this.getPathCount();for(let c=0;c<i;c++)this.isClosedPath(c)&&(this.getPathSize(c)>0?e++:this.m_pathFlags.clearBits(c,1));if(e===0)return;const s=this.hasNonLinearSegments();let n=0;const r=this.getPathCount(),o=this.m_description.getAttributeCount(),a=new Array(o);let l=null,u=null;for(let c=0;c<r;++c){const h=this.getPathStart(c),d=this.getPathSize(c),m=this.isClosedPath(c);if(d>0){const f=h+n;for(let _=0;_<o;_++)if(this.m_vertexAttributes.get(_)){const v=this.m_description.getSemantics(_),x=ps.getComponentCount(v);if(!a[_]){const w=x*(this.m_pointCount+e),T=t3(v,w);a[_]=T}a[_].writeRange(f*x,d*x,this.m_vertexAttributes.get(_),h*x,!0,1),m&&a[_].writeRange((f+d)*x,x,this.m_vertexAttributes.get(_),h*x,!0,1)}if(s){if(l===null){const _=this.m_pointCount+e;l=_m(_),u=Do(_)}l.writeRange(f,d,this.m_curveData.m_segmentFlags,h,!0,1),u.writeRange(f,d,this.m_curveData.m_segmentParamIndex,h,!0,1),m&&(l.write(f+d,1),u.write(f+d,-1))}}this.m_paths.write(c,h+n),m&&(this.m_pathFlags.clearBits(c,1),++n)}this.m_paths.write(r,this.m_pointCount+e),this.m_pathFlags.clearBits(r,1);for(let c=0;c<o;c++)this.m_vertexAttributes.get(c)&&this.m_vertexAttributes.set(c,a[c]);s&&(this.m_curveData.m_segmentFlags=l,this.m_curveData.m_segmentParamIndex=u),this.m_pointCount+=e,this.m_reservedPointCount>0&&(this.m_reservedPointCount=this.m_pointCount)}closePathWithLine(e){e===void 0&&(e=this.getPathCount()-1),this.throwIfEmpty(),(e<0||e>=this.getPathCount())&&ce("close_path_with_line"),e===this.getPathCount()-1&&(this.m_bPathStarted=!1);const i=this.m_pathFlags.read(e);if(1&i||this.m_pathFlags.write(e,1|i),this.m_curveData&&this.m_curveData.m_segmentFlags){const s=this.getPathEnd(e)-1,n=this.m_curveData.m_segmentFlags.read(s);n!==1&&(this.m_curveData.m_segmentFlags.write(s,1),this.m_curveData.m_segmentParamIndex.write(s,-1),n!==1&&(this.incCurveType(n,-1),this.modifyCurveCounter(-1)))}this.notifyModifiedFlags(2001)}closeLastPathWithSegment(e){this.closePathWithSegment(this.getPathCount()-1,e)}closePathWithSegment(e,i){if(this.throwIfEmpty(),(e<0||e>=this.getPathCount())&&ce("close_path_with_line"),i.getEndXY().equals(this.getXY(this.getPathStart(e)))||ce("close_path_with_segment: end point mismatch"),e===this.getPathCount()-1)this.m_bPathStarted=!1,this.addSegment(i,!1),--this.m_pointCount,this.m_paths.write(e+1,this.m_pointCount);else{this.mergeVertexDescription(i.getDescription());const n=i.getStartXY(),r=this.getPathEnd(e)-1;n.equals(this.getXY(r))||ce("close_path_with_segment: start point mismatch");const o=i.getGeometryType();if(o===q.enumLine)return void this.closePathWithLine(e);{const a=OU(i);this.initSegmentData(a);const l=wp.toSegType(o),u=this.m_curveData.m_segmentFlags.read(r);if(u!==l)this.m_curveData.m_segmentParamIndex.write(r,this.m_curveData.m_curveParamWritePoint),i.writeInBufferStream(this.m_curveData.m_segmentParams,this.m_curveData.m_curveParamWritePoint),this.m_curveData.m_curveParamWritePoint+=a,this.incCurveType(l,1),u!==1?this.incCurveType(u,-1):this.modifyCurveCounter(1);else{const c=this.m_curveData.m_segmentParamIndex.read(r);i.writeInBufferStream(this.m_curveData.m_segmentParams,c)}this.m_curveData.m_segmentFlags.write(r,l)}}const s=this.m_pathFlags.read(e);1&s||this.m_pathFlags.write(e,1|s),this.notifyModifiedFlags(2001)}closeAllPaths(){if(this.m_bPolygon||this.isEmptyImpl())return;this.m_bPathStarted=!1;let e=!1;for(let i=0,s=this.m_paths.size()-1;i<s;i++){if(this.isClosedPath(i))continue;const n=this.m_pathFlags.read(i);this.m_pathFlags.write(i,1|n),e=!0}e&&this.notifyModifiedFlags(512)}isClosedPath(e){return!!(1&this.m_pathFlags.read(e))}isClosedPathInXYPlane(e){if(this.isClosedPath(e))return!0;const i=this.getPathStart(e),s=this.getPathEnd(e)-1;if(i>s)return!1;const n=this.getXY(i),r=this.getXY(s);return n.isEqualPoint2D(r)}isClosedPathIn3D(e){return z(0),!1}hasNonLinearSegmentsPath(e){if(!this.hasNonLinearSegments())return!1;for(let i=this.getPathStart(e),s=this.getPathEnd(e);i<s;i++)if(tu.isNonLinearSegmentFlag(this.m_curveData.m_segmentFlags.read(i)))return!0;return!1}isNonLinearSegment(e){return!(1&this.getSegmentFlags(e))}addEnvelope(e,i){if(e.isEmpty())return;const s=this.m_pointCount===0;if(e instanceof J)this.startPathCoords(e.xmin,e.ymin),i?(this.lineToCoords(e.xmax,e.ymin),this.lineToCoords(e.xmax,e.ymax),this.lineToCoords(e.xmin,e.ymax)):(this.lineToCoords(e.xmin,e.ymax),this.lineToCoords(e.xmax,e.ymax),this.lineToCoords(e.xmax,e.ymin));else{const n=e.getDescription(),r=vm(),o=new Jt({vd:n,attribBuffer:r,initDefaultValues:!1});for(let a=0,l=4;a<l;a++){const u=i?l-a-1:a;e.queryCornerByVal(u,o),a===0?this.startPathPoint(o):this.lineToPoint(o)}}this.closePathWithLine(),this.m_bPathStarted=!1,s&&!i&&(this.setDirtyFlagProtected(256,!1),this.m_bPolygon&&Math.min(e.width(),e.height())>0&&this.setIsSimple(3,0))}addPathFromClosedSegment(e,i){if(e.isClosed()||ce("add_path_from_closedSegment: segment must be closed"),i){const s=e.getReversed(),n=new Jt;s.queryStart(n),this.startPathPoint(n),this.closeLastPathWithSegment(s)}else{const s=new Jt;e.queryStart(s),this.startPathPoint(s),this.closeLastPathWithSegment(e)}}addSegment_(e,i){const s=e.getDescription();this.mergeVertexDescription(s);const n=vm(),r=new Jt({vd:s,attribBuffer:n,initDefaultValues:!1}),o=e.getGeometryType();if(o===q.enumLine)(i||this.isEmptyImpl())&&(e.queryStart(r),this.startPathPoint(r)),e.queryEnd(r),this.lineToPoint(r);else{let a=!1;if((i||this.isEmptyImpl())&&(a=!0),!a&&(e.getStartXY().equals(this.getXY(this.m_pointCount-1))||ce("add_segment: start point mismatch")),a&&(e.queryStart(r),this.startPathPoint(r)),this.beforeNewSegment(1),e.queryEnd(r),r.getDescription()===this.m_description)this.setPointByVal(this.m_pointCount-1,r);else{const c=vm(),h=new Jt({vd:this.m_description,attribBuffer:c,initDefaultValues:!1});r.copyCommonAttributesTo(h),this.setPointByVal(this.m_pointCount-1,h)}const l=OU(e);this.initSegmentData(l),this.m_curveData.m_segmentParamIndex.write(this.m_pointCount-2,this.m_curveData.m_curveParamWritePoint),e.writeInBufferStream(this.m_curveData.m_segmentParams,this.m_curveData.m_curveParamWritePoint),this.m_curveData.m_curveParamWritePoint+=l;const u=wp.toSegType(o);this.incCurveType(u,1),this.modifyCurveCounter(1),this.m_curveData.m_segmentFlags.write(this.m_pointCount-2,u)}}addSegment(e,i,s){s?i?this.addPathFromClosedSegment(e,!1):this.closeLastPathWithSegment(e):this.addSegment_(e,i)}interpolateAttributesRange(e,i,s,n){for(let a=e;a<s-1;a++)this.isClosedPath(a)&&ce("cannot interpolate across closed paths");const r=this.m_description.getAttributeCount();if(r===1)return;const o=this.calculateSubLength2D(e,i,s,n);if(o!==0)for(let a=1;a<r;a++){const l=this.m_description.getSemantics(a);this.interpolateAttributesSemanticsImpl(l,e,i,s,n,o)}}interpolateAttributesSemantics(e,i,s,n,r){if(e===0)return;this.hasAttribute(e)||ce("does not have the given attribute"),ps.getInterpolation(e)===2&&ce("angular interpolation");for(let a=i;a<n-1;a++)this.isClosedPath(a)&&ce("cannot interpolate across closed paths");const o=this.calculateSubLength2D(i,s,n,r);o!==0&&this.interpolateAttributesSemanticsImpl(e,i,s,n,r,o)}interpolateAttributesPath(e,i,s){const n=this.m_description.getAttributeCount();if(n===1||i===s)return;const r=this.calculatePathSubLength2D(e,i,s);for(let o=1;o<n;o++){const a=this.m_description.getSemantics(o);this.interpolateAttributesSemanticsPathImpl(a,e,i,s,r)}}interpolateAttributesSemanticsPath(e,i,s,n){if(e===0)return;this.hasAttribute(e)||ce("does not have the given attribute"),ps.getInterpolation(e)===2&&ce("angular interpolation");const r=this.calculatePathSubLength2D(i,s,n);r!==0&&this.interpolateAttributesSemanticsPathImpl(e,i,s,n,r)}interpolateAttributesSemanticsImpl(e,i,s,n,r,o){const a=this.querySegmentIterator(),l=this.getPathStart(i)+s,u=this.getPathStart(n)+r,c=ps.getComponentCount(e),h=st(ps.maxComponentCount(),Number.NaN);this.queryAttributeAsDbl(e,l,h,c);const d=st(ps.maxComponentCount(),Number.NaN);this.queryAttributeAsDbl(e,u,d,c);const m=st(ps.maxComponentCount(),Number.NaN);Qs(m,h,0,0,c);let f=0;const _=ps.getDefaultValue(e),v=ps.getInterpolation(e);a.resetToVertex(l,i);do if(a.hasNextSegment()){if(a.nextSegment(),a.getStartPointIndex()===u)return;this.setAttributeFromArray(e,a.getStartPointIndex(),m,c),a.previousSegment();do{const x=a.nextSegment();if(a.getEndPointIndex()===u)return;f+=x.calculateLength2D(),KO(v,h,d,m,0,c,f/o,_),a.isClosingSegment()||this.setAttributeFromArray(e,a.getEndPointIndex(),m,c)}while(a.hasNextSegment())}while(a.nextPath())}interpolateAttributesSemanticsPathImpl(e,i,s,n,r){const o=this.querySegmentIterator(),a=ps.getInterpolation(e),l=this.getPathStart(i)+s,u=this.getPathStart(i)+n;if(u===l)return;const c=ps.getComponentCount(e),h=st(ps.maxComponentCount(),Number.NaN);this.queryAttributeAsDbl(e,l,h,c);const d=st(ps.maxComponentCount(),Number.NaN);this.queryAttributeAsDbl(e,u,d,c);const m=new Wr(0);o.resetToVertex(l,i),o.setCirculator(this.isClosedPath(i));const f=ps.getDefaultValue(e),_=st(ps.maxComponentCount(),Number.NaN);Qs(_,h,0,0,c);const v=r===0;let x=.5;do{const w=o.nextSegment();if(this.setAttributeFromArray(e,o.getStartPointIndex(),_,c),!v){const T=w.calculateLength2D();m.pe(T),x=m.getResult()/r}KO(a,h,d,_,0,c,x,f)}while(o.getEndPointIndex()!==u)}querySegment(e,i,s){const n=this.getPathIndexFromPointIndex(e),r=e-this.getPathStart(n);r>=this.getSegmentCountPath(n)&&ce("get_segment"),this.getSegmentFromPath(n,r,i,s)}getSegment(e,i){const s=new this.m_segmentBufferCTor;return this.getSegmentBuffer(e,s,i),s.releaseSegment()}getSegmentType(e){const i=this.getPathIndexFromPointIndex(e),s=e-this.getPathStart(i);return s>=this.getSegmentCountPath(i)&&ce("get_segment"),this.getSegmentTypeFromPath(i,s)}getSegmentFromPath(e,i,s,n){const r=this.getPathStart(e)+i,o=this.getSegmentFlagsStreamRef();let a=1;switch(o&&(a=31&o.read(r)),a){case 1:s.createLine();break;case 2:s.createCubicBezier();break;case 4:s.createEllipticArc();break;case 8:s.createQuadraticRationalBezier();break;case 16:s.createQuadraticBezier();break;default:We("")}const l=s.get();let u,c=null;if(n?(c=go(),l.assignVertexDescription(c)):l.assignVertexDescription(this.m_description),u=r===this.getPathEnd(e)-1&&this.isClosedPath(e)?this.getPathStart(e):r+1,$7(l,this.getXY(r)),U7(l,this.getXY(u)),!n)for(let h=1,d=this.m_description.getAttributeCount();h<d;h++){const m=this.m_description.getSemantics(h),f=ps.getComponentCount(m);for(let _=0;_<f;_++){const v=this.getAttributeAsDbl(m,r,_);l.setStartAttribute(m,_,v);const x=this.getAttributeAsDbl(m,u,_);l.setEndAttribute(m,_,x)}}if(tu.isNonLinearSegmentFlag(a)){const h=this.m_curveData.m_segmentParamIndex.read(r);l.readFromBufferStream(this.m_curveData.m_segmentParams,h)}}replaceLinearEllipticalArcsWithTrueLines(){if(!this.hasNonLinearSegments()||this.m_curveData.m_arcCount===0)return!1;let e=!1;for(let i=0,s=this.getPointCount();i<s;i++)if(this.m_curveData.m_segmentFlags.read(i)===4){const n=this.m_curveData.m_segmentParamIndex.read(i);EOe(this.m_curveData.m_segmentParams,n).isNAN()&&(this.m_curveData.m_segmentFlags.write(i,1),this.m_curveData.m_segmentParamIndex.write(i,-1),this.incCurveType(4,-1),this.modifyCurveCounter(-1),e=!0)}return e&&this.checkCompactSegmentParams(),e}queryPointAlongPath(e,i,s,n=!1){const r={iSegment:-1},o=n?r:{tSegment:0};if(s.setEmpty(),this.isEmpty()||((e<0||e>=this.getPathCount())&&ce("query_point_along_path"),i<0))return r;const a=this.getPathSize(e);if(a===0)return r;if(a===1)return this.getPointByVal(this.getPathStart(e),s),o.tSegment=0,r.iSegment=this.getPathStart(e),r;const l=this.querySegmentIteratorAtVertex(this.getPathStart(e)),u=new Wr(0);for(;l.hasNextSegment();){const c=l.nextSegment(),h=c.calculateLength2D(),d=u.getResult();if(u.add(h),u.getResult()>=i){let m=i-d;m>h&&(m=h);const f=c.lengthToT(m);return c.queryCoord(f,s),o.tSegment=f,r.iSegment=l.getStartPointIndex(),r}}if(this.isClosedPath(e)){const c=this.getPathStart(e);return this.getPointByVal(c,s),o.tSegment=1,r.iSegment=this.getPathEnd(e)-1,r}{const c=this.getPathEnd(e)-1;return this.getPointByVal(c,s),this.getPathSize(e)>1?(o.tSegment=1,r.iSegment=this.getPathEnd(e)-2,r):(o.tSegment=0,r.iSegment=this.getPathStart(e),r)}}queryPointsAlongPath(e,i,s,n,r,o){{let f=0;for(let _=0;_<i;++_)n&&n[_].setEmpty(),r&&(r[_]=-1),o&&(o[_]=0),f>s[_]&&ce("query_points_along"),f=s[_]}const a=this.getPathSize(e);if(i===0||a===0)return 0;if(a===1){const f=this.getPathStart(e);return n&&this.getPointByVal(f,n[0]),o&&(o[0]=0),r&&(r[0]=f),1}const l=this.getPathStart(e),u=new Wr(0),c=this.querySegmentIteratorAtVertex(l);let h=0,d=0,m=s[h];for(;c.hasNextSegment();){const f=c.nextSegment(),_=f.calculateLength2D(),v=u.getResult();for(u.add(_);u.getResult()>=m;){let x=m-v;x>_&&(x=_);const w=f.lengthToT(x);if(n&&f.queryCoord(w,n[d]),o&&(o[d]=w),r&&(r[d]=c.getStartPointIndex()),d++,h++,m=s[h],h===i)return d}}if(this.isClosedPath(e)){const f=this.getPathStart(e),_=0;n&&this.getPointByVal(f,n[d]),o&&(o[d]=_),r&&(r[d]=f),d++}else if(this.getPathSize(e)>1){const f=this.getPathEnd(e)-2,_=1;n&&this.getPointByVal(f+1,n[d]),o&&(o[d]=_),r&&(r[d]=f),d++}return d}queryPointsAlong(e,i,s,n,r){{let d=0;for(let m=0;m<e;++m)s&&s[m].setEmpty(),n&&(n[m]=-1),r&&(r[m]=0),d>i[m]&&ce("query_points_along"),d=i[m]}if(e===0)return 0;const o=new Wr(0),a=this.querySegmentIterator();let l=-1,u=0,c=0,h=i[u];for(;a.nextPath();)for(;a.hasNextSegment();){l=a.getPathIndex();const d=a.nextSegment(),m=d.calculateLength2D(),f=o.getResult();for(o.add(m);o.getResult()>=h;){let _=h-f;_>m&&(_=m);const v=d.lengthToT(_);if(s&&d.queryCoord(v,s[c]),r&&(r[c]=v),n&&(n[c]=a.getStartPointIndex()),c++,u++,h=i[u],u===e)return c}}if(l<0)return 0;if(this.isClosedPath(l)){const d=this.getPathStart(l),m=0;s&&this.getPointByVal(d,s[c]),r&&(r[c]=m),n&&(n[c]=d),c++}else if(this.getPathSize(l)>1){const d=this.getPathEnd(l)-2,m=1;s&&this.getPointByVal(d+1,s[c]),r&&(r[c]=m),n&&(n[c]=d),c++}return c}querySegmentIterator(){return new RU({parent:this})}querySegmentIteratorAtVertex(e){return new RU({parent:this,pointIndex:e})}queryPathEnvelope(e,i){this.queryPathEnvelopeImpl(e,i,!0)}queryLoosePathEnvelope(e,i){this.queryPathEnvelopeImpl(e,i,!1)}queryPathEnvelopeImpl(e,i,s){if(i instanceof Fo&&z(0,"not implemented for Envelope"),i instanceof Sd&&z(0,"not implemented for Envelope3D"),(e>=this.getPathCount()||e<0)&&ce(""),this.isEmpty())return void i.setEmpty();const n=this.getAttributeStreamRef(0),r=J.constructEmpty();r.setEmpty();for(let o=2*this.getPathStart(e),a=2*this.getPathEnd(e);o<a;){const l=a-o;z(!(1&l)),r.mergePointsInterleaved(n,o/2,l/2),o+=l}if(i.setCoords({env2D:r}),this.hasNonLinearSegmentsPath(e)){const o=this.querySegmentIterator();if(o.resetToPath(e),o.nextPath())for(;o.hasNextSegment();){const a=o.nextCurve();if(!a)break;{const l=J.constructEmpty();s?a.queryEnvelope(l):a.queryLooseEnvelope(l),i.mergeEnvelope2D(l)}}else z(0)}}checkCompactSegmentParams(){if(!this.m_curveData||this.m_curveData.m_segmentParams===null||this.m_curveData.m_segmentParams.size()<=this.m_vertexAttributes.get(0).size())return!1;const e=10,i=qu(4)*this.m_curveData.m_arcCount+qu(2)*this.m_curveData.m_bezierCount+qu(8)*this.m_curveData.m_rbezier2Count+qu(16)*this.m_curveData.m_bezier2Count;return this.m_curveData.m_segmentParams.size()>Math.max(3*i>>1,e)?(this.forceCompactSegmentParams(),!0):(this.m_pointCount===0&&(this.m_curveData.m_curveParamWritePoint=0),!1)}forceCompactSegmentParams(){let e=0;for(let n=0,r=this.getPointCount();n<r;n++){const o=this.m_curveData.m_segmentFlags.read(n);tu.isNonLinearSegmentFlag(o)&&(e+=qu(o))}const i=Nl(e);let s=0;for(let n=0,r=this.getPointCount();n<r;n++){const o=this.m_curveData.m_segmentFlags.read(n);if(tu.isNonLinearSegmentFlag(o)){let a=this.m_curveData.m_segmentParamIndex.read(n);this.m_curveData.m_segmentParamIndex.write(n,s);const l=qu(o);for(let u=0;u<l;u++)i.write(s,this.m_curveData.m_segmentParams.read(a)),s++,a++}}this.m_curveData.m_segmentParams=i,this.m_curveData.m_curveParamWritePoint=s}setEmpty(){this.m_curveData&&(this.removeAllCurvesFromGlobalCounter(),this.m_curveData=null),this.m_bPathStarted=!1,this.m_paths=null,this.m_pathFlags=null,this.setEmptyImpl()}applyTransformation(e){this.applyTransformationToPath(e,-1)}applyTransformation3D(e){z(0)}getImpl(){return this}reserve(e){this.reserveImpl(e),e>0&&!this.m_paths&&(this.m_paths=Do(0),this.m_pathFlags=_m(0),this.m_paths.reserve(2),this.m_pathFlags.reserve(2),this.m_paths.resize(1,0),this.m_pathFlags.resize(1,this.m_bPolygon?1:0))}reserveParts(e,i){this.reserveImpl(e),i>0&&(this.m_paths?(this.m_paths.reserve(i+1),this.m_pathFlags.reserve(i+1)):(this.m_paths=Do(0),this.m_pathFlags=_m(0),this.m_paths.reserve(i+1),this.m_pathFlags.reserve(i+1),this.m_paths.resize(1,0),this.m_pathFlags.resize(1,this.m_bPolygon?1:0)))}clone(){const e=this.createInstance();return this.copyTo(e),e}queryLimitedSegmentIterator(e){return new vFe(this,e)}getPathStreamRef(){return this.throwIfEmpty(),this.m_paths}setPathStreamRef(e){this.m_paths=e}getSegmentFlagsStreamRef(){return this.throwIfEmpty(),this.m_curveData!=null?this.m_curveData.m_segmentFlags:null}getPathFlagsStreamRef(){return this.throwIfEmpty(),this.m_pathFlags}setPathFlagsStreamRef(e){this.m_pathFlags=e}getSegmentIndexStreamRef(){return this.throwIfEmpty(),this.m_curveData!==null?this.m_curveData.m_segmentParamIndex:null}getSegmentDataStreamRef(){return this.throwIfEmpty(),this.m_curveData!==null?this.m_curveData.m_segmentParams:null}setSegmentData(e,i,s,n){this.m_curveData||(this.m_curveData=new wp),this.m_curveData.m_segmentFlags=s,this.m_curveData.m_segmentParams=i,this.m_curveData.m_segmentParamIndex=e,this.m_curveData.m_curveParamWritePoint=n}static getPathIndexFromPointIndexImpl(e,i,s,n){if(n>=0&&n<i){if(s>=e.read(n)){if(s<e.read(n+1))return n;n++}else n--;if(n>=0&&n<i&&s>=e.read(n)&&s<e.read(n+1))return n}if(i<5){for(let a=0;a<i;a++)if(s<e.read(a+1))return a;jme("")}let r=0,o=i-1;for(;o>r;){const a=r+(o-r>>1);if(s<e.read(a))o=a-1;else{if(!(s>=e.read(a+1)))return a;r=a+1}}return r}getHighestPointIndex(e){z(e>=0&&e<this.getPathCount());const i=this.getAttributeStreamRef(0),s=this.getPathEnd(e),n=this.getPathStart(e);let r=-1;const o=new N;o.y=Number.NEGATIVE_INFINITY,o.x=Number.NEGATIVE_INFINITY;for(let a=n+0;a<s;a++){const l=i.readPoint2D(2*a);o.compare(l)===-1&&(r=a,o.setCoordsPoint2D(l))}return r}applyTransformationToPath(e,i){if(i>=this.getPathCount()&&ce("apply_transformation"),this.isEmpty()||e.isIdentity())return;const s=this.m_vertexAttributes.get(0);if(!(i<0?this.hasNonLinearSegments():this.hasNonLinearSegmentsPath(i))){let a,l;return i<0?(a=0,l=this.m_pointCount):(a=this.getPathStart(i),l=this.getPathEnd(i)),s.applyTransformation(e,2*a,l-a),void this.notifyModifiedFlags(2001)}const n=new this.m_segmentBufferCTor,r=this.getPathCount();let o=i<0?0:i;do{const a=this.getPathStart(o),l=this.getPathEnd(o),u=this.isClosedPath(o),c=s.readPoint2D(2*a);if(!this.hasNonLinearSegmentsPath(o)){s.applyTransformation(e,2*a,l-a);continue}const h=N.getNAN();for(let d=a;d<l;++d){if((31&this.m_curveData.m_segmentFlags.read(d))!==1){const f=u&&d+1===l;f&&s.writePoint2D(2*a,c),this.getSegmentBuffer(d,n,!0),n.get().applyTransformation(e);const _=this.m_curveData.m_segmentParamIndex.read(d);n.get().writeInBufferStream(this.m_curveData.m_segmentParams,_),s.writePoint2D(2*d,n.get().getStartXY()),f&&s.writePoint2D(2*a,n.get().getEndXY());continue}const m=2*d;s.queryPoint2D(m,h),e.transformInPlace(h),s.writePoint2D(m,h)}if(o===i)break}while(++o<r);this.notifyModifiedFlags(2001)}calculateSubLength2D(e,i,s,n){const r=this.getPathStart(e)+i,o=this.getPathStart(s)+n;(o<r||r<0||o>this.getPointCount()-1)&&un("");const a=this.querySegmentIterator();let l=0;a.resetToVertex(r,e);do{for(;a.hasNextSegment();){const u=a.nextSegment();if(a.getStartPointIndex()===o)break;l+=u.calculateLength2D()}if(a.getStartPointIndex()===o)break}while(a.nextPath());return l}calculatePathSubLength2D(e,i,s){const n=this.getPathStart(e)+i,r=this.getPathStart(e)+s;(n<0||r>this.getPointCount()-1)&&un("");const o=this.querySegmentIterator();if(n>r&&(this.isClosedPath(e)||ce("cannot iterate across an open path"),o.setCirculator(!0)),n===r)return 0;let a=0,l=0;o.resetToVertex(n,e);do l+=a,a=o.nextSegment().calculateLength2D();while(o.getStartPointIndex()!==r);return l}calculateEnvelope2D(e){return this.updateXYImpl(e)}updateXYImpl(e){const i=super.updateXYImpl(e);if(this.hasNonLinearSegments()){const s=J.constructEmpty(),n=this.querySegmentIterator();for(;n.nextPath();)for(;n.hasNextSegment();){const r=n.nextCurve();if(!r)break;e?r.queryEnvelope(s):r.queryLooseEnvelope(s),i.mergeEnvelope2D(s)}}return i}notifyModifiedAllImpl(){this.m_paths!==null&&this.m_paths.size()?this.m_pointCount=this.m_paths.read(this.m_paths.size()-1):this.m_pointCount=0}setDirtyOGCFlags(e){this.setDirtyFlagProtected(16,e)}hasDirtyOGCStartFlags(){return this.hasDirtyFlag(16)}setDirtyRingAreas2D(e){this.setDirtyFlagProtected(1024,e)}hasDirtyRingAreas2D(){return this.hasDirtyFlag(1024)}static isNonLinearSegmentFlag(e){return!(1&e)}addAndExplicitlyOpenAllPaths(e,i){this===e&&ce("Multi_path_impl::add");let s=this.getPathCount();for(let n=0,r=e.getPathCount();n<r;n++)this.addPath(e,n,!i),this.openPathAndDuplicateStartVertex(s),s++}getSegmentFlags(e){return this.m_curveData!==null&&this.m_curveData.m_segmentFlags!==null?this.m_curveData.m_segmentFlags.read(e):1}getSegmentBuffer(e,i,s){const n=this.getPathIndexFromPointIndex(e),r=e-this.getPathStart(n);r>=this.getSegmentCountPath(n)&&ce("getSegmentBuffer"),this.getSegmentFromPath(n,r,i,s)}getSegmentTypeFromPath(e,i){const s=this.getPathStart(e)+i,n=this.getSegmentFlagsStreamRef();let r=1;switch(n&&(r=31&n.read(s)),r){case 1:return q.enumLine;case 2:return q.enumBezier;case 4:return q.enumEllipticArc;case 8:return q.enumRationalBezier2;case 16:return q.enumBezier2;default:We("")}}ensureXYMonotoneSegments(){if(!this.m_curveData)return!1;let e=!1;for(let i=0,s=this.getPathCount();i<s;i++){const n=this.getPathStart(i),r=this.getPathEnd(i),o=r-n;for(let a=n;a<r;a++){const l=31&this.m_curveData.m_segmentFlags.read(a);if(l===1)continue;l!==2&&_i("ensure_xy_monotone_segments");const u=(a-n+1)%o+n,c=this.m_curveData.m_segmentParamIndex.read(a),h=he(N,4);h[0]=this.getXY(a),h[3]=this.getXY(u),h[1].x=this.m_curveData.m_segmentParams.read(c),h[1].y=this.m_curveData.m_segmentParams.read(c+1),h[2].x=this.m_curveData.m_segmentParams.read(c+2),h[2].y=this.m_curveData.m_segmentParams.read(c+3),a4(h)&&(e=!0,this.m_curveData.m_segmentParams.write(c,h[1].x),this.m_curveData.m_segmentParams.write(c+1,h[1].y),this.m_curveData.m_segmentParams.write(c+2,h[2].x),this.m_curveData.m_segmentParams.write(c+3,h[2].y))}}return e&&this.notifyModifiedFlags(2001),e}buildRasterizedGeometryAccelerator(e,i){return!1}buildQuadTreeAccelerator(e){if(this.m_accelerators||(this.m_accelerators=new bJ),this.m_accelerators.getQuadTree()!==null)return!0;this.ensureUniqueAccelerators(),this.m_accelerators.setQuadTree(null);const i=cS(this);return this.m_accelerators.setQuadTree(i),!0}buildQuadTreeForPathsAccelerator(e){if(this.m_accelerators||(this.m_accelerators=new bJ),this.m_accelerators.getQuadTreeForPaths()!==null)return!0;this.ensureUniqueAccelerators(),this.m_accelerators.setQuadTreeForPaths(null);const i=rOe(this);return this.m_accelerators.setQuadTreeForPaths(i),!0}updateCurveCounter(e){this.modifyCurveCounter(e-this.getCurveCount())}removeAllCurvesFromGlobalCounter(){this.m_curveData&&(tu.st_totalCurveCount-=this.m_curveData.m_curveCount,this.m_curveData.m_curveCount=0,this.m_curveData.m_bezierCount=0,this.m_curveData.m_arcCount=0,this.m_curveData.m_bezier2Count=0,this.m_curveData.m_rbezier2Count=0,this.m_curveData.m_curveParamWritePoint=0)}modifyCurveCounter(e){e&&(this.m_curveData||(this.m_curveData=new wp),tu.st_totalCurveCount+=e,this.m_curveData.m_curveCount+=e)}getCurveCount(){return this.m_curveData?this.m_curveData.m_curveCount:0}incCurveType(e,i){this.m_curveData||(this.m_curveData=new wp),2&e?this.m_curveData.m_bezierCount+=i:4&e?this.m_curveData.m_arcCount+=i:8&e?this.m_curveData.m_rbezier2Count+=i:16&e&&(this.m_curveData.m_bezier2Count+=i)}getCurveWritePoint(){return this.m_curveData!==null?this.m_curveData.m_curveParamWritePoint:0}initSegmentData(e){this.m_curveData===null&&(this.m_curveData=new wp);const i=this.m_reservedPointCount>0?this.m_reservedPointCount:this.m_pointCount;this.m_curveData.m_segmentParamIndex===null&&(this.m_curveData.m_segmentFlags=_m(i,1),this.m_curveData.m_segmentParamIndex=Do(i,-1));const s=this.m_curveData.m_curveParamWritePoint+e;this.m_curveData.m_segmentParams===null?this.m_curveData.m_segmentParams=Nl(s):s!==this.m_curveData.m_segmentParams.size()&&this.m_curveData.m_segmentParams.resize(s,0),this.m_curveData.m_segmentFlags.size()<i&&(this.m_curveData.m_segmentFlags.resize(i,1),this.m_curveData.m_segmentParamIndex.resize(i,-1))}updateCurveWritePoint(e){this.m_curveData===null&&(this.m_curveData=new wp),this.m_curveData.m_curveParamWritePoint=e}updateOGCFlagsHelper(){const e=this.getPathCount();if(e===0)return;const i=this.m_pathFlags;let s=0;for(let n=0;n<e;n++){const r=this.m_cachedRingAreas2D.read(n);s===0&&(s=In(r)),r*s>0||s===0?i.setBits(n,8):i.clearBits(n,8)}}updateOGCFlagsProtected(){this.hasDirtyFlag(16)&&(this.updateRingAreas2DProtected(),this.updateOGCFlagsHelper(),this.setDirtyFlagProtected(16,!1))}replaceSegment(e,i,s){(e<0||e>=this.getPointCount())&&ce("Multi_path_impl.replace_segment"),z(i.isCurve());const n=this.getPathIndexFromPointIndex(e),r=this.getPathStart(n),o=(e-r+1)%this.getPathSize(n)+r;{const x=this.getXY(e),w=this.getXY(o),T=!x.isEqualPoint2D(i.getStartXY())||!w.isEqualPoint2D(i.getEndXY());z(!T)}const a=i.getDescription();this.mergeVertexDescription(a);const l=st(32,Number.NaN),u=new Jt({vd:a,attribBuffer:l,initDefaultValues:!1}),c=this.m_curveData===null?1:31&this.m_curveData.m_segmentFlags.read(e),h=qu(c),d=OU(i);let m,f=!1;h>=d?(z(this.m_curveData!==null),f=!0,m=this.m_curveData.m_segmentParamIndex.read(e)):(this.initSegmentData(d),f=!1,m=this.m_curveData.m_curveParamWritePoint);const _=i.getGeometryType(),v=wp.toSegType(_);s||(i.queryStart(u),this.setPointByVal(e,u),i.queryEnd(u),this.setPointByVal(o,u)),this.m_curveData.m_segmentParamIndex.write(e,v!==1?m:-1),this.m_curveData.m_segmentFlags.write(e,v),v!==1&&i.writeInBufferStream(this.m_curveData.m_segmentParams,m),f||(this.m_curveData.m_curveParamWritePoint+=d),c!==v&&(this.incCurveType(c,-1),this.incCurveType(v,1),this.modifyCurveCounter(c===1?1:-1))}setAttributeImpl(e,i,s){if(this.addAttribute(e),!this.isEmpty())if(this.hasNonLinearSegments()&&e===0){(i<0||i>1)&&ce("");const n=new Gi,r=i===0?s:0,o=i===0?0:1;n.setShiftCoords(r,o),i===0?n.xx=0:n.yy=0,this.applyTransformation(n)}else super.setAttributeImpl(e,i,s)}};Z7.st_totalCurveCount=0;let vFe=class{constructor(e,i){this.m_segIter=null,this.m_quadTree=null,this.m_qtIter=null,this.m_extentOfInterest=new J(i),this.m_bfirst=!0,this.m_prevIndex=-100,this.m_parent=e}nextSegment(){return this.m_bfirst&&this.prepare_(),this.m_quadTree?this.nextSegmentQt():this.nextSegmentNoQt()}getPathIndex(){return this.m_segIter.getPathIndex()}getStartPointIndex(){return this.m_segIter.getStartPointIndex()}getEndPointIndex(){return this.m_segIter.getEndPointIndex()}isClosingSegment(){return this.m_segIter.isClosingSegment()}isPathClosed(){return this.m_segIter.isPathClosed()}prepare_(){const e=this.m_parent.getAccelerators();e&&(this.m_quadTree=e.getQuadTree(),this.m_quadTree&&(this.m_qtIter=this.m_quadTree.getSortedIterator(this.m_extentOfInterest,0))),this.m_segIter=this.m_parent.querySegmentIterator()}nextSegmentQt(){this.m_bfirst=!1;const e=this.m_qtIter.next();if(e===-1)return null;const i=this.m_quadTree.getElement(e);return(i!==this.m_prevIndex+1||this.m_segIter.isLastSegmentInPath())&&(this.m_segIter.resetToVertex(i,this.m_segIter.getPathIndex()),this.m_prevIndex=i),this.m_segIter.nextSegment()}nextSegmentNoQt(){for(;;){if(!this.m_bfirst&&this.m_segIter.hasNextSegment()){const e=this.m_segIter.nextSegment(),i=J.constructEmpty();if(e.queryLooseEnvelope(i),!i.isIntersecting(this.m_extentOfInterest))continue;return e}if(this.m_bfirst=!1,!this.m_segIter.nextPath())return null}}},Qi=class rB extends Z7{constructor(e){e?e.vd?(super({vd:e.vd,bPolygon:!1}),this.m_segmentBufferCTor=ii):e.copy?(super({vd:e.copy.getDescription(),bPolygon:!1}),this.m_segmentBufferCTor=ii,e.copy.copyTo(this)):e.move?(super({move:e.move}),this.m_segmentBufferCTor=ii):e.start?(super({vd:e.start.getDescription(),bPolygon:!1}),this.m_segmentBufferCTor=ii,this.startPathPoint(e.start),this.lineToPoint(e.end)):e.path?(super({bPolygon:!1}),this.m_segmentBufferCTor=ii,this.addPathPoint2D(e.path,e.pointCount,e.bForward)):We("bad constructor arg"):(super({bPolygon:!1}),this.m_segmentBufferCTor=ii)}getBoundary(){return pd(this)}assignCopy(e){return this!==e&&e.copyTo(this),this}assignMove(e){return e.copyTo(this),this}getGeometryType(){return rB.type}getDimension(){return 1}createInstance(){return new rB({vd:this.getDescription()})}equals(e,i){return this.equalsBase(e,i)}};Qi.type=q.enumPolyline;var Z_=q;function Cv(t,e){if(t.isEmpty())return!1;const i=t.getGeometryType();if(i===Z_.enumPolygon)return t.calculateArea2D()!==0;if(i===Z_.enumPolyline)return nfe(t.getImpl(),e,!0).bNotEmpty;if(i===Z_.enumEnvelope)return!0;if(nr(i))return!!t.isClosed();if(lS(i))return!1;if(i===Z_.enumGeometryCollection){const s=t;for(let n=0,r=s.getGeometryCount();n<r;n++)if(Cv(s.getGeometry(n),e))return!0;return!1}_i("")}function pd(t,e){const i=t.getGeometryType();if(i===Z_.enumPolygon){const s=new Qi({vd:t.getDescription()});return t.isEmpty()||t.copyToUnchecked(s),s}if(i===Z_.enumPolyline)return nfe(t.getImpl(),e,!1).boundary;if(i===Z_.enumEnvelope){const s=new Qi({vd:t.getDescription()});return t.isEmpty()||s.addEnvelope(t,!1),s}if(nr(i)){const s=new Dn({vd:t.getDescription()});if(!t.isEmpty()&&!t.isClosed()){const n=new Jt;s.reserve(2),t.queryStart(n),s.add(n),t.queryEnd(n),s.add(n)}return s}if(i===Z_.enumGeometryCollection){const s=t;let n=null;for(let r=0,o=s.getGeometryCount();r<o;r++){const a=pd(s.getGeometry(r),e);if(a!==null){n===null&&(n=t.createInstance());const l=a;n.addGeometry(l)}}return n}if(lS(i))return new Jt({vd:t.getDescription()});_i("")}function nfe(t,e,i){const n=t;let r=null;if(i||(r=new Dn({vd:n.getDescription()})),!n.isEmpty()){const o=new Un(0);for(let a=0,l=n.getPathCount();a<l;a++)if(n.getPathSize(a)>0&&!n.isClosedPathInXYPlane(a)){const u=n.getPathStart(a);o.add(u);const c=n.getPathEnd(a)-1;o.add(c)}if(o.size()>0){const a=new Uy,l=n.getAttributeStreamRef(0),u={userSort(f,_,v){const x=N.getNAN(),w=N.getNAN();v.sort(f,_,(T,C)=>(l.queryPoint2D(2*T,x),l.queryPoint2D(2*C,w),x.compare(w)))},getValue:f=>l.read(2*f+1)};a.sort(o,0,o.size(),u);let c=l.readPoint2D(2*o.read(0)),h=0,d=1;const m=new Jt;for(let f=1,_=o.size();f<_;f++){const v=l.readPoint2D(2*o.read(f));if(v.isEqualPoint2D(c))o.read(h)>o.read(f)?(o.write(h,Aa()),h=f):o.write(f,Aa()),d++;else{if(1&d){if(i)return{bNotEmpty:!0,boundary:new Dn({})}}else o.write(h,Aa());c=v,h=f,d=1}}if(1&d){if(i)return{bNotEmpty:!0,boundary:new Dn({})}}else o.write(h,Aa());if(!i){o.sort(0,o.size());for(let f=0,_=o.size();f<_&&o.read(f)!==Aa();f++)n.getPointByVal(o.read(f),m),r.add(m)}}}return i?{bNotEmpty:!1,boundary:new Dn({})}:{bNotEmpty:!1,boundary:r}}const xFe=A7/180,bFe=180/A7;function wFe(t){let e=t;return e>=-360&&e<720?(e<0?e+=360:e>=360&&(e-=360),e):(e=xy(e,360),e<0&&(e+=360),e)}function rfe(t){let e=t;return e=wFe(e),e>180&&(e-=360),e}function ofe(t){return t*xFe}function s3(t){return t*bFe}function afe(t){const e=ia();let i=t;return i>=-e&&i<2*e?(i<0&&(i+=e),i>=e&&(i-=e),i):(i=xy(i,e),i<0&&(i+=e),i)}function JJ(t){const e=Zi();let i=t;return i>-e&&i<=e||(i=afe(i),i>e&&(i-=ia())),i}function eee(t,e){return rfe(e-t)}var U2=Hs;let Ed=class oB extends mA{constructor(e){if(e===void 0||KF(e,"vd"))return super({vd:e==null?void 0:e.vd,XStart:0,YStart:0,XEnd:0,YEnd:0}),this.m_semiMajorAxis=0,this.m_minorMajorRatio=1,this.m_rotation=0,this.m_cosr=1,this.m_sinr=0,this.m_center=new N(0,0),this.m_sweepAngle=0,this.m_startAngle=0,this.m_interior=new N(0,0),void(this.m_bits=0);if(e.copy)return super(e),void(this!==e.copy&&(this.m_center=new N(0,0),this.m_interior=new N(0,0),e.copy.copyToImpl(this)));if(e.move)super(e),this.m_semiMajorAxis=e.move.m_semiMajorAxis,this.m_minorMajorRatio=e.move.m_minorMajorRatio,this.m_rotation=e.move.m_rotation,this.m_cosr=e.move.m_cosr,this.m_sinr=e.move.m_sinr,this.m_center=e.move.m_center.clone(),this.m_sweepAngle=e.move.m_sweepAngle,this.m_startAngle=e.move.m_startAngle,this.m_interior=e.move.m_interior.clone(),this.m_bits=e.move.m_bits,this.m_cachedValues=e.move.m_cachedValues,e.move.m_cachedValues=null;else{if(e.fromPoint)return super({XStart:0,YStart:0,XEnd:0,YEnd:0}),this.m_center=new N(0,0),this.m_interior=new N(0,0),void this.constructCircularArcThreePoint(e.fromPoint,e.toPoint,e.interiorPoint);if(e.center)return super({XStart:0,YStart:0,XEnd:0,YEnd:0}),this.m_center=new N(0,0),this.m_interior=new N(0,0),void this.constructCircleRadius(e.radius,e.center,e.bIsCounterClockwise);if(e.semiMajorAxis)return super({XStart:0,YStart:0,XEnd:0,YEnd:0}),void this.constructEllipticArcEndPoints(e.fromPoint,e.toPoint,e.semiMajorAxis,e.minorMajorRatio,e.axisXRotationRad,e.bBigArc,e.bIsCounterClockwise)}}getBoundary(){return pd(this)}assignCopy(e){return this!==e&&e.copyTo(this),this}constructCircleRadius(e,i,s=!1){return this.constructEllipse(e,1,i,0,s),this.setProjectionBehavior(0),this.afterCompletedModification(),this}constructCircleCenterAndPoint(e,i,s=!1){const n=N.distance(e,i);return this.constructEllipticArcEndPointsCenter(i,i,n,1,0,!0,s,e),this.setProjectionBehavior(0),this.afterCompletedModification(),this}constructTwoPointCircle(e,i,s=!1){const n=N.lerp(e,i,.5);return this.constructCircleCenterAndPoint(n,e,s),this}constructLineEllipticArc(e,i){return ac(this,e,i,1),this}constructLineCircularArc(e,i){return ac(this,e,i,0),this}constructEllipse(e,i,s,n,r=!1){this.m_semiMajorAxis=Math.abs(e),this.m_minorMajorRatio=Math.abs(i),this.m_minorMajorRatio>1&&(this.m_semiMajorAxis*=this.m_minorMajorRatio,this.m_minorMajorRatio=1/this.m_minorMajorRatio);const o=new N(0,this.m_minorMajorRatio*this.m_semiMajorAxis),a=Math.cos(n),l=Math.sin(n);return o.rotateDirect(a,l),o.addThis(s),this.constructEllipticArcEndPointsCenter(o,o,this.m_semiMajorAxis,this.m_minorMajorRatio,n,!0,r,s),this}inflate(e){if(this.isDegenerateToLine())return;let i=this.getSemiMinorAxis()+e;if(i=i<=0?0:(this.getSemiMajorAxis()+e)/this.getSemiMajorAxis(),this.isCircular()){const s=new Gi;s.setShiftCoords(-this.m_center.x,-this.m_center.y),s.scale(i,i),s.shiftCoords(this.m_center.x,this.m_center.y),this.applyTransformation(s)}else{const s=new Gi;this.canonicToWorldTransformation(s);const n=s.clone();n.invertPreciseThis(),n.scale(i,i),n.multiply(s),this.applyTransformation(n)}}constructEnclosingCircle(e,i,s=!1){return VFe(this,e,i,s),this}constructThreePointCircle(e,i,s,n=!1){if(e.equals(i)||i.equals(s)||e.equals(s)){const r=e.clone(),o=i.clone(),a=s.clone();return r.equals(o)&&o.assign(a),this.constructTwoPointCircle(r,o,n)}{const r=N.calculateCircleCenterFromThreePoints(e,i,s);if(!r.isFinite()||!Number.isFinite(N.distance(e,r))){const o=N.distance(e,i),a=N.distance(e,s);this.constructLineCircularArc(e,o>=a?i:s)}return this.constructCircleCenterAndPoint(r,e,n)}}constructCircularArcThreePoint(e,i,s){const n=new ge(e.x),r=new ge(i.x),o=new ge(s.x),a=new ge(e.y),l=new ge(i.y),u=new ge(s.y),c=new ge(.5),h=r.subE(n),d=l.subE(a),m=o.subE(n),f=u.subE(a),_=h.mulE(f).subThisE(d.mulE(m));if(_.scaleError(10),_.isZero()){if(!h.isZero()||!d.isZero())return ac(this,e,i,0),this;{const ee=e.clone().addThis(i).mulThis(.5).addThis(s).mulThis(.5),ne=s.sub(ee).length();this.constructEllipticArcEndPointsCenter(e,i,ne,1,0,!0,!1,ee),this.m_interior.assign(s)}return this.setProjectionBehavior(0),this}const v=h.sqr().addThisE(d.sqr()).mulThisE(c),x=m.sqr().addThisE(f.sqr()).mulThisE(c),w=v.mulE(f).subThisE(x.mulE(d)),T=h.mulE(x).subThisE(m.mulE(v));w.divThisE(_),T.divThisE(_);const C=w.sqr().addThisE(T.sqr());C.sqrtThis();const M=w.addE(n),A=T.addE(a);let I=e.x-M.value(),L=e.y-A.value();const D=Math.atan2(L,I);I=i.x-M.value(),L=i.y-A.value();const O=Math.atan2(L,I);I=s.x-M.value(),L=s.y-A.value();const U=Math.atan2(L,I);let $=U-2*Zi();for(;$<D;)$+=2*Zi();let B=O-2*Zi();for(;B<$;)B+=2*Zi();let V=U+2*Zi();for(;V>D;)V-=2*Zi();let H,Y=O+2*Zi();for(;Y>V;)Y-=2*Zi();H=B-D<D-Y?B-D:Y-D;const W=new N(M.value(),A.value());return this.constructEllipticArcEndPointsCenter(e,i,C.value(),1,0,Math.abs(H)>Zi(),H>0,W),this.m_interior.assign(s),this.setProjectionBehavior(0),this.afterCompletedModification(),this}constructCircularArc(e,i,s,n){return this.constructEllipticArcGeneral(e,1,i,s,n,0),this.setProjectionBehavior(0),this.afterCompletedModification(),this}constructEllipticArcEndPoints(e,i,s,n,r,o,a){return oee(this,e,i,s,n,r,o,a)}constructEllipticArcEndPointsCenter(e,i,s,n,r,o,a,l){return oee(this,e,i,s,n,r,o,a,l)}constructEllipticArcGeneral(e,i,s,n,r,o){this.m_semiMajorAxis=Math.abs(e),this.m_minorMajorRatio=Math.abs(i),this.m_minorMajorRatio>1&&(this.m_semiMajorAxis*=this.m_minorMajorRatio,this.m_minorMajorRatio=1/this.m_minorMajorRatio);const a=JJ(o),l=Math.cos(a),u=Math.sin(a),c=new N(this.m_semiMajorAxis,this.m_minorMajorRatio*this.m_semiMajorAxis),h=N.getNAN(),d=JJ(n);h.x=c.x*Math.cos(d),h.y=c.y*Math.sin(d),h.rotateDirect(l,u),h.addThis(s);const m=E3e(r,ia());let f=m;Math.abs(f)===ia()&&(f=0);const _=N.getNAN();return _.x=c.x*Math.cos(d+f),_.y=c.y*Math.sin(d+f),_.rotateDirect(l,u),_.addThis(s),this.constructEllipticArcEndPointsCenter(h,_,this.m_semiMajorAxis,this.m_minorMajorRatio,a,Math.abs(m)>Zi(),m>0,s)}constructEllipticArcAsNURB(e,i,s,n){return(n>=1||n<0)&&ce("construct_elliptic_arc_as_NURB: weight"),i.isFinite()||ce("construct_elliptic_arc_as_NURB: control_point"),tM([e,i,s],n*n,null,!1,this),this}constructCanonic(e){return this.assignCopy(e),e.isDegenerateToLine()||e.m_center.isEqual(0,0)&&this.m_rotation===0||(this.m_XStart=e.getSemiMajorAxis()*Math.cos(e.m_startAngle),this.m_YStart=e.getSemiMinorAxis()*Math.sin(e.m_startAngle),this.m_XEnd=e.getSemiMajorAxis()*Math.cos(e.getEndAngle()),this.m_YEnd=e.getSemiMinorAxis()*Math.sin(e.getEndAngle()),this.m_center.setCoords(0,0),this.m_rotation=0,this.m_cosr=1,this.m_sinr=0,hw(this),this.afterCompletedModification(),e!==this&&_pe(this,e)),this}isCircular(){return this.m_minorMajorRatio===1&&this.m_rotation===0&&!this.isDegenerateToLine()}isDegenerateToLineHelper(e){return!!k7(this,[e])&&Us(this)}isDegenerateToLine(){return Us(this)}getCenter(){return this.m_center.clone()}setCenter(e){if(!this.m_center.isNAN()){const i=e.sub(this.m_center);this.m_XStart+=i.x,this.m_YStart+=i.y,this.m_XEnd+=i.x,this.m_YEnd+=i.y,this.m_interior.addThis(i),this.m_center.assign(e),this.endPointModified(),this.normalizeAfterEndpointChange()}}getAxisXRotation(){return this.m_rotation}getSemiAxes(){return N.construct(this.m_semiMajorAxis,this.m_semiMajorAxis*this.m_minorMajorRatio)}getSemiMajorAxis(){return this.m_semiMajorAxis}getSemiMinorAxis(){return this.m_semiMajorAxis*this.m_minorMajorRatio}getMinorMajorRatio(){return this.m_minorMajorRatio}isClockwise(){return!fS(this)}isMajor(){return tj(this)}getSweepAngle(){return this.m_sweepAngle}getStartAngle(){return this.m_startAngle}getEndAngle(){return this.m_startAngle+this.m_sweepAngle}getGeometryType(){return q.enumEllipticArc}queryEnvelope(e){if(e.m_EnvelopeType===4){e.setEmpty(),e.assignVertexDescription(this.m_description);const i=J.constructEmpty();this.queryEnvelope(i),e.setEnvelope(i);for(let s=1,n=this.m_description.getAttributeCount();s<n;s++){const r=this.m_description.getSemantics(s);for(let o=0,a=U2.getComponentCount(r);s<a;s++){const l=this.queryInterval(r,o);e.setIntervalEnvelope(r,o,l)}}}else e.m_EnvelopeType===2?cee(this,Me.unit(),e):_i("3d not impl")}applyTransformation(e){ej(this,e,!1)}createInstance(){return new oB}calculateLength2D(){return RFe(this,0,1)}queryCoord2D(e,i){if(Us(this))z7(e,this.getStartXY(),this.getEndXY(),i);else if(e===0)i.assign(N.construct(this.m_XStart,this.m_YStart));else if(e===1)i.assign(N.construct(this.m_XEnd,this.m_YEnd));else{const s=Vc(this,e),n=new N(this.m_semiMajorAxis*Math.cos(s),this.getSemiMinorAxis()*Math.sin(s));n.rotateDirect(this.m_cosr,this.m_sinr),n.addThis(this.m_center),i.assign(n)}}queryCoord2DE(e,i){AFe(this,e,i)}getCoordX(e){const i=new N;return this.queryCoord2D(e,i),i.x}getCoordY(e){const i=new N;return this.queryCoord2D(e,i),i.y}cut(e,i,s){const n=new ii;return this.queryCut(e,i,n,s),n.releaseSegment()}queryCut(e,i,s,n){const r=s.createEllipticArc();let o=e===0&&i===1;if(o&&!n)return void this.copyTo(r);const a=N.getNAN();this.queryCoord2D(e,a);const l=N.getNAN();if(this.queryCoord2D(i,l),!o){if(a.equals(l))i-e>.5&&this.isMajor()&&this.isClosed()?(o=!0,e=0,i=1):i===1?e=i:i=e;else if(e>0&&a.isEqual(this.m_XStart,this.m_YStart)&&(e=0),i<1&&l.isEqual(this.m_XEnd,this.m_YEnd)&&(i=1),o=e===0&&i===1,o&&!n)return void this.copyTo(r)}if(r.m_center.assign(this.m_center),r.m_semiMajorAxis=this.m_semiMajorAxis,r.m_minorMajorRatio=this.m_minorMajorRatio,r.m_interior.assign(this.m_interior),r.m_rotation=this.m_rotation,r.m_cosr=this.m_cosr,r.m_sinr=this.m_sinr,r.m_sweepAngle=this.m_sweepAngle,r.m_startAngle=this.m_startAngle,r.m_bits=this.m_bits,mJ(r,a.x,a.y),pJ(r,l.x,l.y),o)return void VU(r,UU(this));r.m_startAngle=Vc(this,e),r.m_sweepAngle=Vc(this,i)-r.m_startAngle,r.m_startAngle=Zv(r.m_startAngle),gS(r,Math.abs(r.m_sweepAngle)>Zi()),r.assignVertexDescription(this.m_description),hw(r),lB(r);const u=this.m_description.getAttributeCount();if(u>1){for(let c=1;c<u;c++){const h=this.m_description.getSemantics(c),d=U2.getComponentCount(h);for(let m=0;m<d;m++){const f=this.getAttributeAsDbl(e,h,m);r.setStartAttribute(h,m,f)}}for(let c=1;c<u;c++){const h=this.m_description.getSemantics(c),d=U2.getComponentCount(h);for(let m=0;m<d;m++){const f=this.getAttributeAsDbl(i,h,m);r.setEndAttribute(h,m,f)}}}r.afterCompletedModification()}queryDerivative(e,i){BFe(this,e,i)}cutArcIgnoreAttributes(e,i,s){let n=e===0&&i===1;const r=new N;this.queryCoord2D(e,r);const o=new N;this.queryCoord2D(i,o),n||(r.equals(o)?i-e>.5&&this.isMajor()&&this.isClosed()?(n=!0,e=0,i=1):i===1?e=i:i=e:(e>0&&r.isEqual(this.m_XStart,this.m_YStart)&&(e=0),i<1&&o.isEqual(this.m_XEnd,this.m_YEnd)&&(i=1),n=e===0&&i===1)),s.m_center.assign(this.m_center),s.m_semiMajorAxis=this.m_semiMajorAxis,s.m_minorMajorRatio=this.m_minorMajorRatio,s.m_interior.assign(this.m_interior),s.m_rotation=this.m_rotation,s.m_cosr=this.m_cosr,s.m_sinr=this.m_sinr,s.m_sweepAngle=this.m_sweepAngle,s.m_startAngle=this.m_startAngle,s.m_bits=this.m_bits,mJ(s,r.x,r.y),pJ(s,o.x,o.y),n?VU(s,UU(this)):(s.m_startAngle=Vc(this,e),s.m_sweepAngle=Vc(this,i)-s.m_startAngle,s.m_startAngle=Zv(s.m_startAngle),gS(s,Math.abs(s.m_sweepAngle)>Math.PI),hw(s),s.afterCompletedModification())}changeEndPoints2D(e,i){ree(this,e,i,!1)}getAttributeAsDbl(e,i,s){if(i===0)return s===0?this.getCoordX(e):this.getCoordY(e);if(e===0)return this.getStartAttributeAsDbl(i,s);if(e===1)return this.getEndAttributeAsDbl(i,s);const n=this.calculateLength2D(),r=n>0?this.tToLength(e)/n:0,o=U2.getInterpolation(i),a=this.getStartAttributeAsDbl(i,s),l=this.getEndAttributeAsDbl(i,s);return aA(o,a,l,r,U2.getDefaultValue(i))}getClosestCoordinate(e,i){return hee(this,e,Me.unit(),i)}getClosestCoordinateOnInterval(e,i,s=-1){return hee(this,e,i,!1)}getYMonotonicParts(e,i=!1){e.length<2&&ce("");const s=this.getSemiAxes(),n=Math.atan2(s.y*this.m_cosr,s.x*this.m_sinr),r=n+Zi(),o=st(3,Number.NaN);let a=0;if(o[0]=Fn(this,n),o[0]>0&&o[0]<1&&a++,o[1]=Fn(this,r),o[1]>0&&o[1]<1&&(o[a]=o[1],a++),a===0)return 0;o[a]=1,a++,z(e.length>=a);let l=0;for(let u=0;u<a;u++){const c=o[u];this.queryCut(l,c,e[u],i),l=c}return a}getMonotonicParts(e,i){if(e.length<4&&ce(""),this.isDegenerateToLine())return e[0].createEllipticArc().assignCopy(this),i&&e[0].get().dropAllAttributes(),1;const s=this.getSemiAxes(),n=st(4,Number.NaN);n[0]=Math.atan2(s.y*this.m_cosr,s.x*this.m_sinr),n[1]=n[0]+Zi(),n[2]=Math.atan2(-s.y*this.m_sinr,s.x*this.m_cosr),n[3]=n[2]+Zi();const r=st(5,Number.NaN);let o=0;for(let l=0;l<4;l++)r[o]=Fn(this,n[l]),r[o]>0&&r[o]<1&&o++;if(o===0)return 0;gG(r,o),r[o-1]<1&&(r[o]=1,o++),z(e.length>=o);let a=0;for(let l=0;l<o;l++){const u=r[l];this.queryCut(a,u,e[l],i),a=u}return o}intersectionWithAxis2D(e,i,s,n){if(Us(this))return new mi({start:this.getStartXY(),end:this.getEndXY()}).intersectionWithAxis2D(e,i,s,n);let r,o;const a=new ge(i),l=this.getSemiAxes();if(e){if(i>this.m_center.y+l.x||i<this.m_center.y-l.x)return 0;r=new ge(l.x).mulThis(this.m_sinr),o=new ge(l.y).mulThis(this.m_cosr),a.subThis(this.m_center.y)}else{if(i>this.m_center.x+l.x||i<this.m_center.x-l.x)return 0;r=new ge(l.x).mulThis(this.m_cosr),o=new ge(l.y).mulThis(-this.m_sinr),a.subThis(this.m_center.x)}const u=r.sqr(),c=o.sqr(),h=u.addE(c),d=o.mulE(a).mulThis(-2),m=a.sqr().subThisE(u),f=d.sqr().subThisE(h.mulE(m).mulThis(4)),_=r.mulE(a).mulThis(-2),v=a.sqr().subThisE(c),x=_.sqr().subThisE(h.mulE(v).mulThis(4));let w=f.eps()*Math.abs(x.value())<=x.eps()*Math.abs(f.value());w?r.isZero()&&(w=!1):o.isZero()&&(w=!0),w||(d.setE(_),m.setE(v));const T=he(ge,2);let C=Ul(h,d,m,Me.construct(-1,1),!1,T);if(C===0)return 0;const M=[0,0];let A=0;for(let I=0;I<C;I++){const L=new ge,D=new ge;w?(L.setE(T[I]),D.setE(a.subE(o.mulE(T[I])).divThisE(r))):(D.setE(T[I]),L.setE(a.subE(r.mulE(T[I])).divThisE(o)));const O=Fn(this,Math.atan2(L.value(),D.value()));O>=0&&O<=1&&(M[A]=O,A++)}return C=A,C===0?0:(C===2&&M[0]>M[1]&&(M[1]=Ge(M[0],M[0]=M[1])),n&&Qs(n,M,0,0,C),s&&(s[0]=e?this.getCoordX(M[0]):this.getCoordY(M[0]),C>1&&(s[1]=e?this.getCoordX(M[1]):this.getCoordY(M[1]),!n&&s[0]>s[1]&&(s[1]=Ge(s[0],s[0]=s[1])))),C)}intersectionOfYMonotonicWithAxisX(e,i){if(this.m_YStart===this.m_YEnd)return e===this.m_YStart?i:Number.NaN;if(e===this.m_YStart)return this.m_XStart;if(e===this.m_YEnd)return this.m_XEnd;const s=[0,0];return this.intersectionWithAxis2D(!0,e,s,null)===-1?i:s[0]}isCurve(){return!0}isDegenerate(e){return s4(this,e)}isDegenerate3D(e,i){return z(0),!1}queryLooseEnvelope(e){e.m_EnvelopeType!==3?this.queryLooseEnvelopeOnInterval(new Me(0,1),e):_i("3d not impl")}clone(e){const i=new oB;return this.copyTo(i),i}queryInterval(e,i){if(e===0){if(Us(this))return i===0?Me.construct(this.getStartX(),this.getEndX()):Me.construct(this.getStartY(),this.getEndY());let s;const n=this.getSemiAxes();s=i===0?Math.atan2(-n.y*this.m_sinr,n.x*this.m_cosr):Math.atan2(n.y*this.m_cosr,n.x*this.m_sinr);const r=s+Math.PI,o=[0,0];o[0]=Fn(this,s),o[1]=Fn(this,r);const a=i===0?Me.construct(this.getStartX(),this.getEndX()):Me.construct(this.getStartY(),this.getEndY()),l=new N;for(let u=0;u<2;u++){const c=o[u];c>0&&c<1&&(this.queryCoord2D(c,l),a.mergeNeCoordinate(i===0?l.x:l.y))}return a}return super.queryInterval(e,i)}queryLooseEnvelopeOnInterval(e,i){const s=new Me(0,1);if(s.intersect(e),s.isEmpty())return void i.setEmpty();if(Us(this))return i.setCoords(this.getCoord2D(s.vmin)),void i.mergeNe(this.getCoord2D(s.vmax));const n=this.getCoord2D(s.vmin),r=this.getCoord2D(s.vmax);if(this.m_minorMajorRatio===1&&Math.abs(this.m_sweepAngle)*s.width()<=zi){let o=N.lerp(n,r,.5);const a=o.sub(this.m_center);return a.normalize(),o=o.add(a.mul(.5*N.distance(n,r))),i.setCoords(n),i.mergeNe(r),void i.mergeNe(o)}cee(this,s,i)}tToLength(e){return Us(this)?e*N.distance(this.getStartXY(),this.getEndXY()):this.m_minorMajorRatio===1?Math.abs(this.getSweepAngle()*e)*this.m_semiMajorAxis:uB(this,e)}parametricAngleToT(e){return Fn(this,e)}tToParametricAngle(e){return Vc(this,e)}lengthToT(e){if(Us(this)){const i=N.distance(this.getStartXY(),this.getEndXY());return i===0?0:e/i}if(this.m_minorMajorRatio===1){const i=Math.abs(this.getSweepAngle())*this.m_semiMajorAxis;return i===0?0:e/i}return FFe(this,e)}calculateWeightedAreaCentroid2D(e){if(Us(this)){const c=new N;return c.setCoords(0,0),c}const i=lee(this),s=this.getStartXY().sub(this.m_center),n=this.getEndXY().sub(this.m_center),r=this.m_semiMajorAxis,o=this.getSemiMinorAxis(),a=this.m_startAngle+this.m_sweepAngle,l=new N;l.x=r*o*(r*this.m_cosr*(-Math.sin(a)+Math.sin(this.m_startAngle))+o*(-Math.cos(a)+Math.cos(this.m_startAngle))*this.m_sinr)/3,l.y=r*o*(o*(Math.cos(a)-Math.cos(this.m_startAngle))*this.m_cosr+r*(-Math.sin(a)+Math.sin(this.m_startAngle))*this.m_sinr)/3;const u=n.add(s).mul(n.crossProduct(s)/6);return l.x-=u.x,l.y-=u.y,l.add(this.m_center.sub(e).mul(i))}calculateWeightedCentroid2D(){const e=new N;if(this.isDegenerate(0))return e.setCoords(0,0),e;if(Us(this))return e.assign(this.getCoord2D(.5).mul(this.calculateLength2D())),e;let i=this.m_startAngle,s=this.m_startAngle+this.m_sweepAngle;if(s<i){const l=i;i=s,s=l}const n=Math.sin(i),r=Math.sin(s),o=Math.cos(i),a=Math.cos(s);if(this.m_minorMajorRatio===1){const l=this.getSemiMajorAxis(),u=l*l,c=u*(r-n),h=u*(o-a);e.setCoords(c,h)}else{const l=this.getSemiMajorAxis(),u=this.getSemiMinorAxis(),c=l*l,h=u*u,d=l*u,m=c-h,f=m/h,_=m/c,v=Math.sqrt(f),x=Math.sqrt(_),w=.5*d*(Math.asinh(v*r)/v+r*Math.sqrt(1+f*r*r))-.5*d*(Math.asinh(v*n)/v+n*Math.sqrt(1+f*n*n)),T=-.5*d*(Math.asin(x*a)/x+a*Math.sqrt(1-_*a*a))- -.5*d*(Math.asin(x*o)/x+o*Math.sqrt(1-_*o*o));e.setCoords(w,T)}return e.rotateDirect(this.m_cosr,this.m_sinr),e.assign(e.add(this.m_center.mul(this.calculateLength2D()))),e}isIntersectingPoint(e,i,s){if(s&&(e.isEqualPoint2D(this.getStartXY())||e.isEqualPoint2D(this.getEndXY())))return!1;if(!Us(this)){const o=N.distance(e,this.m_center),a=this.getSemiAxes();if(o<a.x-i||o>a.y+i)return!1}const n=this.getClosestCoordinate(e,!1),r=new N;return this.queryCoord2D(n,r),N.distance(r,e)<=i}isIntersectingPoint3D(e,i,s,n,r=1){return z(0),!1}getTangent(e){if(Us(this))return this.getEndXY().sub(this.getStartXY());{const i=Vc(this,e),s=new N;return s.setCoords(-this.m_semiMajorAxis*Math.sin(i),this.getSemiMinorAxis()*Math.cos(i)),this.m_rotation&&s.rotateDirect(this.m_cosr,this.m_sinr),s.scale(this.getSweepAngle()),s}}getDerivative(e){if(Us(this))return this.getEndXY().sub(this.getStartXY());{const i=Vc(this,e),s=new N;return s.setCoords(-this.m_semiMajorAxis*Math.sin(i),this.getSemiMinorAxis()*Math.cos(i)),this.m_rotation&&s.rotateDirect(this.m_cosr,this.m_sinr),s.scale(this.getSweepAngle()),s}}normalizeAfterEndpointChange(){return!!ij(this)&&(Us(this)?(Cf(this),!1):dfe(this,!1))}projectionBehavior(){return(4&this.m_bits)>>2}setProjectionBehavior(e){this.m_bits=-5&this.m_bits|e<<2}convertToCanonic(e){const i=new N(e.x,e.y);return i.subThis(this.m_center),i.rotateReverse(this.m_cosr,this.m_sinr),i}convertFromCanonic(e){const i=new N(e.x,e.y);return i.rotateDirect(this.m_cosr,this.m_sinr),i.addThis(this.m_center),i}canonicToWorldTransformation(e){e.setRotate(this.m_cosr,this.m_sinr),e.shiftCoords(this.m_center.x,this.m_center.y)}getCurvature(e){const i=Vc(this,e),s=new N,n=this.getSemiMinorAxis();s.setCoords(-this.m_semiMajorAxis*Math.sin(i),n*Math.cos(i));const r=new N;r.setCoords(-this.m_semiMajorAxis*Math.cos(i),-n*Math.sin(i)),this.m_rotation&&(s.rotateDirect(this.m_cosr,this.m_sinr),r.rotateDirect(this.m_cosr,this.m_sinr));const o=s.sqrLength();if(o===0)return Number.NaN;const a=Math.sqrt(o);return s.divThis(a),s.crossProduct(r)/o}getMonotonicPartParams(e,i){const s=st(6,Number.NaN);s[0]=0;let n=1;if(this.isDegenerateToLine())s[1]=1,n=2;else{const r=this.getSemiAxes(),o=st(4,Number.NaN);this.m_rotation?(o[0]=Math.atan2(r.y*this.m_cosr,r.x*this.m_sinr),o[1]=o[0]+Math.PI,o[2]=Math.atan2(-r.y*this.m_sinr,r.x*this.m_cosr),o[3]=o[2]+Math.PI):(o[0]=0,o[1]=Math.PI,o[2]=.5*Math.PI,o[3]=T3e());for(let a=0;a<4;a++){const l=Fn(this,o[a]);l>0&&l<1&&(s[n]=l,n++)}n>2&&gG(s,n),s[n]=1,n++}if(i){e<n&&ce("");for(let r=0;r<n;r++)i[r]=s[r]}return n}calculateLowerLength2D(){const e=N.distance(this.getStartXY(),this.getEndXY());if(this.isDegenerateToLine())return e;const i=Math.abs(this.m_sweepAngle)*this.getSemiMinorAxis();return Math.max(i,e)}calculateUpperLength2D(){const e=N.distance(this.getStartXY(),this.getEndXY());if(this.isDegenerateToLine())return e;const i=Math.abs(this.m_sweepAngle)*this.getSemiMajorAxis();return Math.max(i,e)}orientBottomUp(){if(this.m_YEnd<this.m_YStart||this.m_YEnd===this.m_YStart&&this.m_XEnd<this.m_XStart){this.m_XEnd=Ge(this.m_XStart,this.m_XStart=this.m_XEnd),this.m_YEnd=Ge(this.m_YStart,this.m_YStart=this.m_YEnd);for(let e=0,i=this.m_description.getTotalComponentCount()-2;e<i;e++)this.m_attributes[e+i]=Ge(this.m_attributes[e],this.m_attributes[e]=this.m_attributes[e+i]);this.m_startAngle=this.m_startAngle+this.m_sweepAngle,this.m_sweepAngle=-this.m_sweepAngle}}isLine(){return Us(this)}copyIgnoreAttributes(e){e.m_XStart=this.m_XStart,e.m_YStart=this.m_YStart,e.m_XEnd=this.m_XEnd,e.m_YEnd=this.m_YEnd,e.m_center.assign(this.m_center),e.m_semiMajorAxis=this.m_semiMajorAxis,e.m_minorMajorRatio=this.m_minorMajorRatio,e.m_interior.assign(this.m_interior),e.m_rotation=this.m_rotation,e.m_cosr=this.m_cosr,e.m_sinr=this.m_sinr,e.m_sweepAngle=this.m_sweepAngle,e.m_startAngle=this.m_startAngle,e.m_bits=this.m_bits,n3(e)}calculateArea2DHelper(){return lee(this)}absNorm(){let e=this.getStartXY().norm(1)+this.getEndXY().norm(1);return this.isDegenerateToLine()||(e+=this.m_center.norm(1),e+=this.m_semiMajorAxis),e}queryEnvelopeW(e,i){if(i.setCoords(this.getCoord2D(e.vmin)),i.mergeNe(this.getCoord2D(e.vmax)),Us(this))return;const s=this.getSemiAxes(),n=st(8,Number.NaN);{const o=Math.atan2(-s.y*this.m_sinr,s.x*this.m_cosr),a=o+Math.PI,l=Math.atan2(s.y*this.m_cosr,s.x*this.m_sinr),u=l+Math.PI;n[0]=Fn(this,o),n[1]=Fn(this,a),n[2]=Fn(this,l),n[3]=Fn(this,u)}{const o=this.m_cosr+this.m_sinr,a=this.m_cosr-this.m_sinr,l=Math.atan2(-s.y*o,s.x*a),u=l+Math.PI,c=Math.atan2(s.y*a,s.x*o),h=c+Math.PI;n[4]=Fn(this,l),n[5]=Fn(this,u),n[6]=Fn(this,c),n[7]=Fn(this,h)}const r=N.getNAN();for(let o=0;o<8;o++){const a=n[o];e.containsExclusiveCoordinate(a)&&(this.queryCoord2D(a,r),i.mergeNe(r))}}setSegmentFromCoords(e,i){OFe(this,e,i)}writeInBufferStream(e,i){const s=new Float64Array(10);return s[0]=this.m_bits,s[1]=this.m_semiMajorAxis,s[2]=this.m_minorMajorRatio,s[3]=this.m_rotation,s[4]=this.m_center.x,s[5]=this.m_center.y,s[6]=this.m_sweepAngle,s[7]=this.m_startAngle,s[8]=this.m_interior.x,s[9]=this.m_interior.y,e.writeRangeFromArray(i,s.length,s,!0,1),i+s.length}readFromBufferStream(e,i){const s=new Float64Array(10);e.queryRange(i,s.length,s,!0,1),this.m_bits=s[0],this.m_semiMajorAxis=s[1],this.m_minorMajorRatio=s[2],this.m_rotation=s[3],this.m_center.x=s[4],this.m_center.y=s[5],this.m_sweepAngle=s[6],this.m_startAngle=s[7],this.m_interior.x=s[8],this.m_interior.y=s[9],this.m_cosr=Math.cos(this.m_rotation),this.m_sinr=Math.sin(this.m_rotation),this.m_cachedValues=null}snapControlPoints(e){return!1}needsSnapControlPoints(e){return!1}calculateSpecialPointsForCracking(e,i){return We("should not1; be called"),0}ensureXYMonotone(){if(Us(this))return!1;if(this.getStartXY().equals(this.getEndXY()))return ac(this,this.getStartXY(),this.getEndXY(),this.projectionBehavior()),!0;const e=he(N,3);let i=sj(this,e);if(x1(e)){let s=!1;if(this.projectionBehavior()===0){const n=new J;n.setCoords({pt:e[0]}),n.mergeNe(e[2]);const r=new N;r.setSub(e[2],e[0]),r.leftPerpendicularThis(),r.normalize(),r.scale(N.distance(e[2],e[0]));const o=N.lerp(e[2],e[0],.5),a=o.sub(r),l=o.add(r);n.clipLine(a,l);const u=N.getClosestCoordinate(a,l,e[1],!1);e[1]=N.lerp(a,l,u);const c=e[2].sub(e[1]),h=e[0].sub(e[1]),d=c.crossProduct(h),m=c.dotProduct(h);i=aa()-Math.abs(.5*Math.atan2(d,m)),s=!0}return tM(e,i*i,null,s,this),!0}return!1}setCoordsForIntersector(e,i,s){ree(this,e,i,s)}getInteriorPoint(){return this.m_interior.clone()}copyToImpl(e){const i=e;i.m_center.assign(this.m_center),i.m_semiMajorAxis=this.m_semiMajorAxis,i.m_minorMajorRatio=this.m_minorMajorRatio,i.m_interior.assign(this.m_interior),i.m_rotation=this.m_rotation,i.m_cosr=this.m_cosr,i.m_sinr=this.m_sinr,i.m_sweepAngle=this.m_sweepAngle,i.m_startAngle=this.m_startAngle,i.m_bits=this.m_bits,VU(i,UU(this))}reverseImpl(){l4(this,!fS(this)),lB(this),(this.projectionBehavior()!==0||this.getStartXY().equals(this.getEndXY()))&&hw(this)}equalsImpl(e){const i=e;if(this.m_bits!==i.m_bits||this.m_semiMajorAxis!==i.m_semiMajorAxis||this.m_minorMajorRatio!==i.m_minorMajorRatio||!(this.m_center.isEqualPoint2D(i.m_center)||this.m_center.isNAN()&&i.m_center.isNAN())||this.m_rotation!==i.m_rotation||!this.m_interior.equals(i.m_interior))return!1;const s=i.m_sweepAngle;if(this.m_sweepAngle!==s)return!1;const n=i.m_startAngle;return this.m_startAngle===n}equalsImplTol(e,i){const s=e;if(this.m_bits!==s.m_bits)return!1;if(this.m_center.isNAN()&&s.m_center.isNAN())return!0;if(this.m_center.isNAN()!==s.m_center.isNAN()||!this.getSemiAxes().isEqualPoint2D(s.getSemiAxes(),i)||!this.m_center.isEqualPoint2D(s.m_center,i))return!1;const n=Math.abs(ofe(rfe(s3(this.m_rotation-s.m_rotation)))),r=Math.abs(Zi()-n),o=Math.min(n,r);if(this.m_semiMajorAxis*Math.abs(o)>i)return!1;const a=this.getCoord2D(.5),l=s.getCoord2D(.5);return!!a.isEqualPoint2D(l,i)}swapImpl(e){const i=e;this.m_center=Ge(i.m_center,i.m_center=this.m_center),this.m_semiMajorAxis=Ge(i.m_semiMajorAxis,i.m_semiMajorAxis=this.m_semiMajorAxis),this.m_minorMajorRatio=Ge(i.m_minorMajorRatio,i.m_minorMajorRatio=this.m_minorMajorRatio),this.m_interior=Ge(i.m_interior,i.m_interior=this.m_interior),this.m_rotation=Ge(i.m_rotation,i.m_rotation=this.m_rotation),this.m_cosr=Ge(i.m_cosr,i.m_cosr=this.m_cosr),this.m_sinr=Ge(i.m_sinr,i.m_sinr=this.m_sinr),this.m_sweepAngle=Ge(i.m_sweepAngle,i.m_sweepAngle=this.m_sweepAngle),this.m_startAngle=Ge(i.m_startAngle,i.m_startAngle=this.m_startAngle),this.m_bits=Ge(i.m_bits,i.m_bits=this.m_bits),kFe(this,i)}afterCompletedModification(){Cf(this),n3(this)}intersect(e,i,s,n,r){return q1(!1,this,e,i,s,n,r)}intersectPoint(e,i,s){if(i.length<2&&bi(""),Us(this))return new mi({start:this.getStartXY(),end:this.getEndXY()}).intersectPoint(e,i,s);{const o=N.distance(e,this.m_center);if(o>this.m_semiMajorAxis+s||o<this.getSemiMinorAxis()-s)return 0}const n=this.getClosestCoordinate(e,!1),r=N.getNAN();return this.queryCoord2D(n,r),N.distance(r,e)<=s?Vs(n,0,1)&&(this.queryCoord2D(n===0?1:0,r),N.distance(r,e)<=s)?(i&&(i[0]=0,i[1]=1),2):(i&&(i[0]=n),1):0}isIntersecting(e,i,s){return tE(!1,this,e,i,s)!==0}endPointModified(){this.m_bits|=8,n3(this)}clearEndPointModified(){Cf(this)}};function SFe(t,e,i,s){const n=[];return EFe(e,n),CFe(t,n,e,i)}function EFe(t,e){e.length=t;for(let i=0;i<e.length;++i)e[i]=i;t>3&&uOe(t,e)}function CFe(t,e,i,s,n){let r=0;const o=[0,0,0];let a=0;const l=3;let u=0;for(let c=0;c<l;++c){let h=!1;for(;u<i;){const d=t.at(e[u]);let m=1;if(r===3?m=N.inCircleRobust(t.at(s[0]),t.at(s[1]),t.at(s[2]),d):r===2?m=N.inCircleRobust3Point(t.at(s[0]),t.at(s[1]),d):r===1&&d.equals(t.at(s[0]))&&(m=0),m<=0){if(m<0&&c+1<l){e[a]=Ge(e[u],e[u]=e[a]);for(let _=0;_<r;_++)if(s[_]===e[u]){o[_]=u;break}a++}u++;continue}h=!0;let f=0;for(let _=0;_<r;_++)o[_]>u&&(s[f]=s[_],o[f]=o[_],f++);r=f,s[r]=e[u],o[r]=u,r++,r<3?u=a:(N.orientationRobust(t.at(s[0]),t.at(s[1]),t.at(s[2]))===1&&(s[2]=Ge(s[0],s[0]=s[2]),o[2]=Ge(o[0],o[0]=o[2])),u++)}if(!h)break;if(c+1<l){a=0;let d=!1;for(let m=0;m<r;m++)for(let f=m+1;f<r;f++)o[m]>o[f]&&(o[f]=Ge(o[m],o[m]=o[f]),s[f]=Ge(s[m],s[m]=s[f]),d=!0);for(let m=0;m<r;m++)e[o[m]]=Ge(e[m],e[m]=e[o[m]]),o[m]=m;d&&r===3&&N.orientationRobust(t.at(s[0]),t.at(s[1]),t.at(s[2]))===1&&(s[2]=Ge(s[0],s[0]=s[2]),o[2]=Ge(o[0],o[0]=o[2]))}u=r}return r}Ed.type=q.enumEllipticArc;let Ci=class aB extends Z7{constructor(e){e?e.vd?(super({vd:e.vd,bPolygon:!0}),this.m_segmentBufferCTor=ii):e.copy?(super({vd:e.copy.getDescription(),bPolygon:!0}),this.m_segmentBufferCTor=ii,e.copy.copyTo(this)):e.move?(super({move:e.move}),this.m_segmentBufferCTor=ii):e.envelope?_i("envelope constructor not impl"):We("bad arg to polygon constructor"):(super({bPolygon:!0}),this.m_segmentBufferCTor=ii)}assignMove(e){return e.copyTo(this),this}assignCopy(e){return e.copyTo(this),this}getBoundary(){return pd(this)}getExteriorRingCount(){return this.getOGCPolygonCount()}getGeometryType(){return aB.type}getDimension(){return 2}createInstance(){return new aB({vd:this.getDescription()})}equals(e,i){return this.equalsBase(e,i)}};function TFe(t,e,i,s,n,r){return new lfe(0,0,0,null,!1,fo()).densifyEx(t,e,i,s,!1,r)}function K7(t,e,i,s,n,r,o,a){r&&(r.length=0),o&&(o.length=0);const l=t.getGeometryType();if(l===q.enumLine)return r&&(r.push(t.getStartXY()),r.push(N.getNAN()),r.push(N.getNAN()),r.push(t.getEndXY())),o&&(o.push(0),o.push(1)),1;if(l===q.enumBezier){if(!s)return r&&(r.push(t.getStartXY()),r.push(t.getControlPoint1()),r.push(t.getControlPoint2()),r.push(t.getEndXY())),o&&(o.push(0),o.push(1)),1;const u=st(9,Number.NaN);let c=t.getMonotonicPartParams(u.length,u);if(u.length=c,c=WT(t,i,u),c===2&&n&&(u[1]=.5,u.push(1),c=3),o&&o.splice(0,0,...u.slice(0,c)),r){const h=new ii;for(let d=1;d<c;d++){const m=u[d-1],f=u[d];t.queryCut(m,f,h,!0);const _=h.get();cL(_),d===1&&r.push(_.getStartXY()),r.push(_.getControlPoint1()),r.push(_.getControlPoint2()),r.push(_.getEndXY())}}return c-1}if(l===q.enumEllipticArc){const u=t;if(u.isDegenerateToLine()||u.isDegenerate(0))return r&&(r.push(t.getStartXY()),r.push(N.getNAN()),r.push(N.getNAN()),r.push(t.getEndXY())),o&&(o.push(0),o.push(1)),1;if(s&&(n||!u.isMonotoneQuickAndDirty())){const c=st(6,Number.NaN);let h=u.getMonotonicPartParams(c.length,c);c.length=h,h=WT(t,i,c),h===2&&n&&(c[1]=.5,c.push(1),h=3);let d=0;if(h>2){const m=new ii,f=o||[];let _=0;for(let v=1;v<h;v++){const x=c[_],w=c[v];if(u.queryCut(x,w,m,!0),m.get().isDegenerate(0))continue;const T=f.length,C=tee(v===1,m.get(),e,i,s,r,o);z(C>0),d+=C;const M=v===h-1,A=c[_],I=m.get().getSweepAngle()/u.getSweepAngle();for(let L=T,D=f.length;L<D;L++)if(f[L]=!M||L+1<D?A+f[L]*I:1,r){const O=3*L,U=u.getCoord2D(f[L]);r[O].setCoordsPoint2D(U),O>0&&a4(r.slice(O-3))}_=v}return d}}return tee(!0,u,e,i,s,r,o)}if(l===q.enumRationalBezier2){const u=t;if(s&&(n||!u.isMonotoneQuickAndDirty())){const c=st(6,Number.NaN);let h=u.getMonotonicPartParams(c.length,c);c.length=h,h=WT(t,i,c),h===2&&n&&(c[1]=.5,c.push(1),h=3);let d=0;if(h>2){const m=new ii,f=o||[];for(let _=1;_<h;_++){const v=c[_-1],x=c[_];u.queryCut(v,x,m,!0);const w=f.length;d+=iee(_===1,m.get(),e,i,!1,r,o);const T=_===h-1,C=c[_-1];for(let M=w,A=f.length;M<A;M++)if(f[M]=!T||M+1<A?C+f[M]:1,r){const I=3*M,L=u.getCoord2D(f[M]);r[I].setCoordsPoint2D(L),I>0&&jpe(r.slice(I-3))}}return d}}return iee(!0,u,e,i,s,r,o)}if(l===q.enumBezier2){const u=t,c=he(N,3);u.queryControlPoints(c);const h=new hc;return h.constructFromQuadratic(c),K7(h,e,i,s,n,r,o)}_i("")}function dL(t,e,i,s,n,r,o,a,l){const u=t.getGeometryType();if(r&&(r.length=0,o.length=0),a&&(a.length=0),u===q.enumEllipticArc){const d=t;if(d.isDegenerateToLine()||d.isDegenerate(0))return r&&(r.push(t.getStartXY()),r.push(N.getNAN()),r.push(t.getEndXY()),o.push(Number.NaN),o.push(Number.NaN),o.push(Number.NaN)),a&&(a.push(0),a.push(1)),1}const c=st(9,Number.NaN);let h;if(n)h=t.getMonotonicPartParams(c.length,c),c.length=h,h=WT(t,i,c);else{if(h=2,c[0]=0,c[1]=1,u===Ed.type){const d=t.getSweepAngle();if(d>.9*Math.PI){const m=2*Math.PI/3;Math.min(3,Math.trunc(d/m+.5))>2?(c[0]=0,c[1]=1/3,c[2]=2/3,c[3]=1,h=4):(c[0]=0,c[1]=.5,c[2]=1,h=3)}}else z(u===il.type);c.length=h}if(h===2&&s&&(c[1]=.5,c.push(1),h=3),r){const d=new ii;let m=1;for(;m<h;){const f=c[m-1],_=c[m];t.queryCut(f,_,d,!0);const v=he(N,3),x=[1,1,1];if(u===q.enumEllipticArc){const w=d.get();if(Math.abs(w.getSweepAngle())>.9*Math.PI){const T=(_-f)/3;c.splice(m,0,f+T),c.splice(m+1,0,f+2*T),h+=2;continue}x[1]=sj(w,v)}else{const w=d.get();w.queryControlPoints(v),w.queryWeights(x)}n&&x1(v),m===1&&(r.push(v[0].clone()),o.push(x[0])),r.push(v[1].clone()),r.push(v[2].clone()),o.push(x[1]),o.push(x[2]),m++}}return a&&(a.length=h,Qs(a,c,0,0,h)),h-1}Ci.type=q.enumPolygon;let lfe=class im{static constructDefault(e){return new im(0,0,0,e,!1,fo())}constructor(e,i,s,n,r,o){this.m_segmentBuffer=null,this.m_dummyPoint=new Jt,this.m_progressCounter=0,this.m_progressTracker=n,this.m_bSetDensifyFlag=r,this.m_maxLength=e,this.m_maxDeviation=i,this.m_maxAngle=s>aa()?aa():s,this.m_cosMaxAngle=Math.cos(this.m_maxAngle),this.m_bOnlyCurveDensify=this.m_maxAngle>0||this.m_maxDeviation>0,this.m_maxSegmentsPerCurve=o,RP(this.m_maxSegmentsPerCurve>0,"this.m_maxSegmentsPerCurve > 0"),this.m_minStep=1/this.m_maxSegmentsPerCurve}densify(e){return this.densifyGeom(e)}densifySegment(e,i){this.densifySegmentEx(e,null,!0,!1,i)}densifyEx(e,i,s,n,r,o){return this.m_maxLength=i,this.m_maxDeviation=s,this.m_maxAngle=n>aa()?aa():n,this.m_cosMaxAngle=Math.cos(this.m_maxAngle),this.m_bOnlyCurveDensify=this.m_maxAngle>0||this.m_maxDeviation>0,this.m_bSetDensifyFlag=r,this.m_maxSegmentsPerCurve=o,RP(this.m_maxSegmentsPerCurve>0,"this.m_maxSegmentsPerCurve > 0"),this.m_minStep=1/this.m_maxSegmentsPerCurve,this.densifyGeom(e)}densifyGeom(e){if(e.isEmpty()||e.getDimension()<1)return e;const i=e.getGeometryType();return C7(i)?e:Ei(i)?this.densifyMultiPath(e):nr(i)?this.densifySegmentImpl(e):i===q.enumEnvelope?this.densifyEnvelope(e):void We("")}densifySegmentEx(e,i,s,n,r){const o=e.getGeometryType();if(!(this.m_maxLength>0||this.m_bOnlyCurveDensify&&o!==q.enumLine)&&(!n||s))return void(i?o===q.enumLine?i.addSegment(e,s):(s&&(e.queryStart(this.m_dummyPoint),i.startPathPoint(this.m_dummyPoint)),e.queryEnd(this.m_dummyPoint),i.lineToPoint(this.m_dummyPoint)):(s&&r.push(0),r.push(1)));if(o===q.enumBezier)return void this.densifyCubicBezier(e,i,s,n,r);if(o===q.enumRationalBezier2)return void this.densifyRationalBezier2(e,i,s,n,r);if(o===q.enumBezier2)return void this.densifyBezier2(e,i,s,n,r);if(o===q.enumEllipticArc&&!e.isLine()&&e.getMinorMajorRatio()<.25)return void this.densifyEllipticArc(e,i,s,n,r);let a=1;this.m_maxLength>0&&(a=this.calculateLengthSubdivisionStep(e,this.m_maxLength)),this.m_maxDeviation>0&&(a=Math.min(a,this.calculateDeviationSubdivisionStep(e,this.m_maxDeviation))),this.m_maxAngle>0&&(a=Math.min(a,this.calculateAngularSubdivisionStep(e,this.m_maxAngle))),this.densifySegmentByLength(e,a,i,s,n,r)}densifyMultiPath(e){if(!e.hasNonLinearSegments()){if(e.getDescription().getAttributeCount()===1)return this.densifyMultiPathLinear(e);if(!(this.m_maxLength>0))return e}const i=e.createInstance();i.getGeometryType()===q.enumPolygon&&i.setFillRule(e.getFillRule()),i.reserve(e.getPointCount());const s=e.getImpl().querySegmentIterator();for(;s.nextPath();){let n=!0;for(;s.hasNextSegment();){const r=s.nextSegment(),o=s.isClosingSegment();this.densifySegmentEx(r,i,n,o,null),o&&i.closePathWithLine(),n=!1}}return i}densifySegmentImpl(e){const i=new Qi({vd:e.getDescription()}),s=[0];return this.densifySegmentEx(e,i,!0,!1,s),i}densifyEnvelope(e){const i=new Ci({vd:e.getDescription()});i.addEnvelope(e,!1);const s=J.constructEmpty();e.queryEnvelope(s);const n=s.width(),r=s.height();return!(this.m_maxLength>0)||n<=this.m_maxLength&&r<=this.m_maxLength?i:this.densifyMultiPath(i)}densifyMultiPathLinear(e){if(!(this.m_maxLength>0))return e;const i=e.createInstance();i.getGeometryType()===q.enumPolygon&&i.setFillRule(e.getFillRule()),i.reserve(e.getPointCount());const s=i.getImpl(),n=e.getImpl(),r=n.getAttributeStreamRef(0),o=new mi;for(let a=0,l=n.getPathCount();a<l;a++){const u=n.isClosedPath(a);if(n.getPathSize(a)===0)continue;const c=n.getPathStart(a),h=r.readPoint2D(2*c),d=h.clone();s.startPath(h);for(let m=c+1,f=n.getPathEnd(a);m<f;m++){const _=r.readPoint2D(2*m),v=N.distance(d,_);if(v>this.m_maxLength){let x=Math.ceil(v/this.m_maxLength);x>fo()&&(x=fo());const w=1/x;let T,C,M;d.compare(_)<0?(o.setStartXY(d),o.setEndXY(_),T=0,C=1):(o.setStartXY(_),o.setEndXY(d),T=x-2,C=-1);for(let A=0,I=x-1;A<I;A++,T+=C){this.progress_(),M=w*(T+1);const L=new N;o.queryCoord2D(M,L),s.lineTo(L),this.m_bSetDensifyFlag&&s.setAttribute(10,s.getPointCount()-1,0,1)}}else this.progress_();i.lineTo(_),d.assign(_)}if(u){const m=N.distance(d,h);if(m>this.m_maxLength){const f=h;let _=Math.ceil(m/this.m_maxLength);_>fo()&&(_=fo());const v=1/_;let x,w;d.compare(f)<0?(o.setStartXY(d),o.setEndXY(f),x=0,w=1):(o.setStartXY(f),o.setEndXY(d),x=_-2,w=-1);const T=new N(0,0);let C;for(let M=0,A=_-1;M<A;M++,x+=w)this.progress_(),C=v*(x+1),o.queryCoord2D(C,T),s.lineTo(T),this.m_bSetDensifyFlag&&s.setAttribute(10,s.getPointCount()-1,0,1)}s.closePathWithLine()}}return i}densifySegmentByLength(e,i,s,n,r,o){z(e.getGeometryType()!==q.enumBezier);let a=e.getStartXY().compare(e.getEndXY());a===0&&i<1&&(e.getGeometryType()===q.enumEllipticArc?a=e.getSweepAngle()<0?1:-1:_i("densify segment by length"));let l=0;if(n&&(s?(e.queryStart(this.m_dummyPoint),s.startPathPoint(this.m_dummyPoint)):o.push(0),++l),i*this.m_maxSegmentsPerCurve<1&&(i=1/this.m_maxSegmentsPerCurve),i<1){this.m_segmentBuffer||(this.m_segmentBuffer=new ii);let u=Math.ceil(1/i);u>fo()&&(u=fo()),i=1/u,this.m_segmentBuffer.create(e.getGeometryType());let c,h,d,m=e;a<0?(c=0,h=1):(e.copyTo(this.m_segmentBuffer.get()),this.m_segmentBuffer.get().reverse(),c=u-2,h=-1,m=this.m_segmentBuffer.get());const f=u-1;for(let _=0;_<f;_++,c+=h)d=i*(c+1),s?(m.queryCoord(d,this.m_dummyPoint),s.lineToPoint(this.m_dummyPoint),this.m_bSetDensifyFlag&&d!==1&&d!==0&&s.setAttribute(10,s.getPointCount()-1,0,1)):o.push(a>0?1-d:d),this.progress_();d=1,l+=f}(!r||r&&n&&l<2)&&(s?(e.queryEnd(this.m_dummyPoint),s.lineToPoint(this.m_dummyPoint)):o.push(1))}densifyCubicBezier(e,i,s,n,r){const o=new hc;let a=e;const l=e.calculateUpperLength2D();let u=e.getStartXY().compare(e.getEndXY());if(u===0&&l>0){const v=he(N,4);e.queryControlPoints(v),u=v[1].compare(v[2]),u===0&&(u=v[1].compare(v[0]))}u>0&&(e.copyTo(o),o.reverse(),a=o);let c=0;s&&(i?(e.queryStart(this.m_dummyPoint),i.startPathPoint(this.m_dummyPoint)):r.push(0),++c);const h=[],d=[],m=Math.trunc(Math.log2(this.m_maxSegmentsPerCurve));let f=!0,_=0;if(u>0)for(h.push([a.getStartXY(),a.getControlPoint1(),a.getControlPoint2(),a.getEndXY(),new N(0,1)]),d.push(0);h.length;){this.progress_();const v=h.at(-1),x=d.at(-1),w=v[4].x,T=v[4].y;if(x<m&&this.bezierNeedsSplit(v)){f&&(_=a.findMinDeriv(),f=!1);let C=.5*(w+T);Math.abs(_-C)<.4*(T-w)&&(C=_);const M=(C-w)/(T-w),A=v[0].mul(1-M).add(v[1].mul(M)),I=v[1].mul(1-M).add(v[2].mul(M)),L=v[2].mul(1-M).add(v[3].mul(M)),D=A.mul(1-M).add(I.mul(M)),O=I.mul(1-M).add(L.mul(M)),U=D.mul(1-M).add(O.mul(M)),$=v[3];v[1]=A,v[2]=D,v[3]=U,v[4].setCoords(w,C);const B=[U,O,L,$,new N(C,T)];h.push(B),d[d.length-1]=x+1,d.push(x+1)}else h.pop(),d.pop(),(h.length>0||!n||n&&s&&c<2)&&(i?(a.queryCoord(w,this.m_dummyPoint),i.lineToPoint(this.m_dummyPoint),this.m_bSetDensifyFlag&&w!==1&&w!==0&&i.setAttribute(10,i.getPointCount()-1,0,1)):r.push(1-w),++c)}else for(h.push([a.getStartXY(),a.getControlPoint1(),a.getControlPoint2(),a.getEndXY(),new N(0,1)]),d.push(0);h.length;){this.progress_();const v=h.at(-1),x=d.at(-1),w=v[4].x,T=v[4].y;if(x<m&&this.bezierNeedsSplit(v)){f&&(_=a.findMinDeriv(),f=!1);let C=.5*(w+T);Math.abs(_-C)<.4*(T-w)&&(C=_);const M=(C-w)/(T-w),A=v[0].mul(1-M).add(v[1].mul(M)),I=v[1].mul(1-M).add(v[2].mul(M)),L=v[2].mul(1-M).add(v[3].mul(M)),D=A.mul(1-M).add(I.mul(M)),O=I.mul(1-M).add(L.mul(M)),U=D.mul(1-M).add(O.mul(M)),$=v[0];v[0]=U,v[1]=O,v[2]=L,v[4].setCoords(C,T);const B=[$,A,D,U,new N(w,C)];h.push(B),d[d.length-1]=x+1,d.push(x+1)}else h.pop(),d.pop(),(h.length>0||!n||n&&s&&c<2)&&(i?(a.queryCoord(T,this.m_dummyPoint),i.lineToPoint(this.m_dummyPoint),this.m_bSetDensifyFlag&&T!==1&&T!==0&&i.setAttribute(10,i.getPointCount()-1,0,1)):r.push(T),++c)}}densifyRationalBezier2(e,i,s,n,r){const o=new il;let a=e;const l=e.calculateUpperLength2D();let u=e.getStartXY().compare(e.getEndXY());u===0&&l>0&&(u=0),u>0&&(e.copyTo(o),o.reverse(),a=o);let c=0;s&&(i?(e.queryStart(this.m_dummyPoint),i.startPathPoint(this.m_dummyPoint)):r.push(0),++c);const h=Math.trunc(Math.log2(this.m_maxSegmentsPerCurve)),d=new il,m=[],f=[];for(m.push(new Me(0,1)),f.push(0);m.length;){this.progress_();const _=m.at(-1).clone(),v=f.at(-1);if(v<h&&this.rationalBezier2NeedsSplit(a,d,_.vmin,_.vmax)){const x=_.getCenter();u>0?(m.at(-1).vmax=x,m.push(new Me(x,_.vmax))):(m.at(-1).vmin=x,m.push(new Me(_.vmin,x))),f[f.length-1]=v+1,f.push(v+1)}else if(m.pop(),f.pop(),m.length>0||!n||n&&s&&c<2){const x=u>0?_.vmin:_.vmax;i?(a.queryCoord(x,this.m_dummyPoint),i.lineToPoint(this.m_dummyPoint),this.m_bSetDensifyFlag&&x!==1&&x!==0&&i.setAttribute(10,i.getPointCount()-1,0,1)):r.push(u>0?1-x:x),++c}}}densifyBezier2(e,i,s,n,r){const o=new v1;let a=e;const l=e.calculateUpperLength2D();let u=e.getStartXY().compare(e.getEndXY());u===0&&l>0&&(u=0),u>0&&(e.copyTo(o),o.reverse(),a=o);let c=0;s&&(i?(e.queryStart(this.m_dummyPoint),i.startPathPoint(this.m_dummyPoint)):r.push(0),++c);const h=Math.ceil(Math.log2(this.m_maxSegmentsPerCurve)),d=new v1,m=[],f=[];for(m.push(new Me(0,1)),f.push(0);m.length;){this.progress_();const _=m.at(-1).clone(),v=f.at(-1);if(v<h&&this.bezier2NeedsSplit(a,d,_.vmin,_.vmax)){const x=_.getCenter();u>0?(m.at(-1).vmax=x,m.push(new Me(x,_.vmax))):(m.at(-1).vmin=x,m.push(new Me(_.vmin,x))),f[f.length-1]=v+1,f.push(v+1)}else if(m.pop(),f.pop(),m.length>0||!n||n&&s&&c<2){const x=u>0?_.vmin:_.vmax;i?(a.queryCoord(x,this.m_dummyPoint),i.lineToPoint(this.m_dummyPoint),this.m_bSetDensifyFlag&&x!==1&&x!==0&&i.setAttribute(10,i.getPointCount()-1,0,1)):r.push(u>0?1-x:x),++c}}}densifyEllipticArc(e,i,s,n,r){const o=new Ed;let a=e;const l=e.calculateUpperLength2D();let u=e.getStartXY().compare(e.getEndXY());u===0&&l>0&&(u=e.isClockwise()?0:1),u>0&&(e.copyTo(o),o.reverse(),a=o);let c=0;s&&(i?(e.queryStart(this.m_dummyPoint),i.startPathPoint(this.m_dummyPoint)):r.push(0),++c);const h=Math.trunc(Math.log2(this.m_maxSegmentsPerCurve)),d=new Ed,m=[],f=[];for(m.push(new Me(0,1)),f.push(0);m.length;){this.progress_();const _=m.at(-1).clone(),v=f.at(-1);if(v<h&&this.ellipticArcNeedsSplit(a,d,_.vmin,_.vmax)){const x=_.getCenter();u>0?(m.at(-1).vmax=x,m.push(new Me(x,_.vmax))):(m.at(-1).vmin=x,m.push(new Me(_.vmin,x))),f[f.length-1]=v+1,f.push(v+1)}else if(m.pop(),f.pop(),m.length>0||!n||n&&s&&c<2){const x=u>0?_.vmin:_.vmax;i?(a.queryCoord(x,this.m_dummyPoint),i.lineToPoint(this.m_dummyPoint),this.m_bSetDensifyFlag&&x!==1&&x!==0&&i.setAttribute(10,i.getPointCount()-1,0,1)):r.push(u>0?1-x:x),++c}}}calculateLengthSubdivisionStep(e,i){const s=e.calculateUpperLength2D();if(!e.isCurve())return s?i/s:1;if(e.getGeometryType()===q.enumEllipticArc){const n=e;if(n.isCircular()||n.isDegenerate(0)||n.isDegenerateToLine()){let r=i/s;return r<this.m_minStep&&(r=this.m_minStep),r}return i/s*n.getSemiAxes().y/n.getSemiAxes().x}e.getGeometryType()===q.enumBezier&&_i(""),_i("")}calculateDeviationSubdivisionStep(e,i){if(!e.isCurve())return 1;if(e.getGeometryType()===q.enumEllipticArc){const s=e;if(s.isDegenerate(0)||s.isDegenerateToLine())return 1;{const n=s.getSemiMajorAxis(),r=1-i/n;let o=Math.PI/2;if(r>0){const l=4*Math.sqrt(i/n*.5);o=Math.min(Math.PI/2,Math.abs(l))}o=Math.max(o,2*Math.PI/this.m_maxSegmentsPerCurve);const a=o*n;return this.calculateLengthSubdivisionStep(e,a)}}_i("")}calculateAngularSubdivisionStep(e,i){if(!e.isCurve())return 1;if(e.getGeometryType()===q.enumEllipticArc){const s=e;return s.isDegenerate(0)||s.isDegenerateToLine()?1:this.calculateLengthSubdivisionStep(e,i*s.getSemiMinorAxis())}_i("")}rationalBezier2NeedsSplit(e,i,s,n){e.cutBezierIgnoreAttributes(s,n,i);let r=!1;if(this.m_maxLength>0&&i.calculateUpperLength2D()>this.m_maxLength)return r=!0,!0;const o=he(N,3);i.queryControlPoints(o);const a=[0,0,0];return i.queryWeights(a),!r&&this.m_maxDeviation>0&&(r=!im.checkRationalBezier2MaxDeviation(o,a,this.m_maxDeviation)),!r&&this.m_maxAngle>0&&(r=!im.checkRationalBezier2MaxAngle(o,a,this.m_cosMaxAngle)),r}bezier2NeedsSplit(e,i,s,n){e.cutBezierIgnoreAttributes(s,n,i);let r=!1;if(this.m_maxLength>0&&i.calculateUpperLength2D()>this.m_maxLength)return r=!0,!0;const o=he(N,3);return i.queryControlPoints(o),!r&&this.m_maxDeviation>0&&(r=!im.checkBezier2MaxDeviation(o,this.m_maxDeviation)),!r&&this.m_maxAngle>0&&(r=!im.checkBezier2MaxAngle(o,this.m_cosMaxAngle)),r}ellipticArcNeedsSplit(e,i,s,n){e.cutArcIgnoreAttributes(s,n,i);let r=!1;return this.m_maxLength>0&&i.calculateUpperLength2D()>this.m_maxLength?(r=!0,!0):(!r&&this.m_maxDeviation>0&&(r=!im.checkEllipticArcMaxDeviation(i,this.m_maxDeviation)),!r&&this.m_maxAngle>0&&(r=!im.checkEllipticArcMaxAngle(i,this.m_cosMaxAngle)),r)}bezierNeedsSplit(e){let i=!1;return this.m_maxLength>0&&N.distance(e[0],e[1])+N.distance(e[1],e[2])+N.distance(e[2],e[3])>this.m_maxLength?(i=!0,!0):(!i&&this.m_maxDeviation>0&&(i=!im.checkBezierMaxDeviation(e,this.m_maxDeviation)),!i&&this.m_maxAngle>0&&(i=!im.checkBezierMaxAngle(e,this.m_cosMaxAngle)),i)}progress_(){}static checkBezierMaxDeviation(e,i){const s=e[3].sub(e[0]);if(s.sqrLength()>0){const n=s.clone();n.leftPerpendicularThis(),n.normalize();const r=n.dotProduct(e[0].sub(e[1])),o=n.dotProduct(e[0].sub(e[2]));if(Math.max(Math.abs(r),Math.abs(o))<=i){const a=new N;xn(e,.5,a,!1);const l=a.sub(e[0]).dotProduct(s);return l>=0&&l<=s.sqrLength()}return!1}return Math.max(e[0].sub(e[1]).sqrLength(),e[0].sub(e[2]).sqrLength())<=i*i}static checkBezierMaxAngle(e,i){if(e[0].equals(e[3]))return!(!e[0].equals(e[1])||!e[1].equals(e[2]));const s=e[3].sub(e[0]);s.normalize();{const n=e[1].sub(e[0]),r=n.dotProduct(s);if(r<0||n.length()*i>r)return!1}{const n=e[2].sub(e[0]),r=n.dotProduct(s);if(r<0||n.length()*i>r)return!1}{const n=e[2].sub(e[1]),r=n.dotProduct(s);if(r<0||n.length()*i>r)return!1}return!0}static checkRationalBezier2MaxDeviation(e,i,s){if(i[1]===0)return!1;const n=e[2].sub(e[0]);if(n.sqrLength()>0){const r=n.clone();r.leftPerpendicularThis(),r.normalize();const o=r.dotProduct(e[0].sub(e[1]));if(Math.abs(o)<=s){const a=e[1].sub(e[0]).dotProduct(n);return a>=0&&a<=n.sqrLength()}return!1}return e[0].sub(e[1]).sqrLength()<=s*s}static checkRationalBezier2MaxAngle(e,i,s){if(i[1]===0)return!1;if(e[0].equals(e[2]))return!!e[0].equals(e[1]);const n=e[2].sub(e[0]);n.normalize();{const r=e[1].sub(e[0]),o=r.dotProduct(n);if(o<0||r.length()*s>o)return!1}return!0}static checkBezier2MaxDeviation(e,i){const s=e[2].sub(e[0]);if(s.sqrLength()>0){const n=s.clone();n.leftPerpendicularThis(),n.normalize();const r=n.dotProduct(e[0].sub(e[1]));if(Math.abs(r)<=i){const o=e[1].sub(e[0]).dotProduct(s);return o>=0&&o<=s.sqrLength()}return!1}return e[0].sub(e[1]).sqrLength()<=i*i}static checkBezier2MaxAngle(e,i){if(e[0].equals(e[2]))return!!e[0].equals(e[1]);const s=e[2].sub(e[0]);s.normalize();{const n=e[1].sub(e[0]),r=n.dotProduct(s);if(r<0||n.length()*i>r)return!1}return!0}static checkEllipticArcMaxDeviation(e,i){if(Math.abs(e.getSweepAngle())<Math.PI){const r=e.getEndXY().sub(e.getStartXY()),o=[0,0];if(GFe(e,r,o)===1){const a=e.getCoord2D(o[0]),l=N.getClosestCoordinate(e.getStartXY(),e.getEndXY(),a),u=new N;return zn(e.getStartXY(),e.getEndXY(),l,u),N.distance(a,u)<=i}}const s=e.getCoord2D(.5),n=new N;return zn(e.getEndXY(),e.getStartXY(),.5,n),N.distance(s,n)<=i}static checkEllipticArcMaxAngle(e,i){const s=e.getTangent(0),n=e.getTangent(1),r=s.dotProduct(n);return!(r<0)&&!(s.length()*n.length()*i>r)}static checkTypeForReplace(e,i){return e.getGeometryType()===i&&(i!==q.enumEllipticArc||e.isCircular())}};function WT(t,e,i){const s=i.length;if(e<=0||s<=2)return s;let n=0;const r=st(s-1,Number.NaN);for(let o=1,a=s;o<a;o++){const l=t.tToLength(i[o]);r[o-1]=l-n,n=l}for(;r.length>1;){const o=r.findIndex(u=>u<=2*e);if(o===-1)break;let a=o+1,l=o+1;if(o>0){const u=o-1;(l===r.length||r[u]>r[l])&&(l=u,a--)}r[l]+=r[o],r.splice(o,1),i.splice(a,1)}return i.length}function tee(t,e,i,s,n,r,o,a){const l=e.clone();l.dropAllAttributes();const u=(W,ee,ne,j)=>(ee&&(W&&ee.push(j.getStartXY()),ee.push(N.getNAN()),ee.push(N.getNAN()),ee.push(j.getEndXY())),ne&&(W&&ne.push(0),ne.push(1)),1);if(l.isDegenerateToLine()||l.isDegenerate(0))return u(t,r,o,e);const c=l.getStartXY(),h=l.getEndXY(),d=l.getSemiAxes(),m=new Gi;if(l.isCircular())m.setIdentity();else{const W=l.getAxisXRotation();m.setScaleCoords(1,l.getMinorMajorRatio()),m.rotateAngle(W)}const f=l.getCenter();m.shift(f);const _=m.clone();_.invertThis(),l.applyTransformation(_);const v=l.getSweepAngle();if(v===0)return u(t,r,o,e);const x=J.constructEmpty();x.setCoords({center:f,width:2*d.x,height:2*d.x});const w=.05*x.calculateToleranceFromEnvelope(),T=Math.max(i/d.x,w/d.x);let C=4*Math.pow(T/.0741,1/6);C=Math.min(C,Math.PI/2);const M=afe(l.getStartAngle());let A=v>0?Math.floor(M/C):Math.ceil(M/C);A*=C;const I=v>0?C:-C;A+I===M&&(A+=I);let L=4/3*Math.tan(Math.abs(C)/4);v>0&&(L=-L),o&&t&&o.push(0);const D=C/Math.abs(v);let O=(A-M)/v;const U=c.clone(),$=new N;l.queryCoord2D(0,$);const B=$.clone(),V=1-.01*D;let H=0,Y=0;for(;O<1;){let W;if(O+=D,Y>0&&O<V)W=L;else{O>=V&&(O=1);const ve=(O-Y)*v;W=4/3*Math.tan(Math.abs(ve)/4),v>0&&(W=-W)}l.queryCoord2D(O,$);const ee=new N;m.queryTransform($,ee);const ne=e.getClosestCoordinate(ee,!1);if(e.queryCoord2D(ne,ee),O!==1&&(N.distance(U,ee)<=2*s||N.distance(ee,h)<=2*s))continue;U.setCoordsPoint2D(ee);const j=he(N,4);j[0].assign(B),j[3].assign($),j[1].rightPerpendicularOther(B),j[1].scaleAddThis(W,B),j[2].leftPerpendicularOther($),j[2].scaleAddThis(W,$),m.transformPoints2D(j,3,j),j[3].assign(ee),Y===0&&j[0].setCoordsPoint2D(c),O===1&&j[3].setCoordsPoint2D(h),n&&a4(j);let oe=!0;for(let ve=1;ve<4;ve++)if(!j[ve].isEqualPoint2D(j[0])){oe=!1;break}oe||(o&&o.push(ne),r&&(Y===0&&t&&r.push(j[0].clone()),r.push(j[1].clone()),r.push(j[2].clone()),r.push(j[3].clone())),H++),Y=O,B.setCoordsPoint2D($)}return H}function iee(t,e,i,s,n,r,o,a){e.clone().dropAllAttributes();const l=new J;e.queryLooseEnvelope(l);const u=.05*l.calculateToleranceFromEnvelope(),c=Math.max(i,u);o&&t&&o.push(0);let h=0;const d=he(N,3);e.queryControlPoints(d);const m=[0,0,0];e.queryWeights(m);const f=[],_=st(9,Number.NaN);let v=0;n?(v=e.getMonotonicPartParams(_.length,_),_.length=v,v=WT(e,s,_)):(_.length=2,v=2,_[0]=0,_[1]=1);let x=0,w=t;for(let T=1;T<v;T++){const C=_[T];for(f.length=0,f.push(C),f.push(x);f.length>1;){const M=f.at(-1);f.pop();const A=f.at(-1),I=he(N,3),L=[0,0,0];wy(d,m,M,A,I,L);const D=he(N,4),O=dLe(I,L,D),U=16,$=f.length>U;c>=O||$?(o.push(A),r&&(w&&(r.push(D[0]),w=!1),r.push(D[1]),r.push(D[2]),r.push(D[3])),h++):(f.push(.5*(M+A)),f.push(M))}x=C}return h}function PFe(){return{e2:0,completeE:0}}let MFe=class{constructor(e,i){this.m_arc=e,this.m_sqrChordLength=i}getMaxDerivative(){return 1}getValue(e,i){return e===0?N.sqrDistance(this.m_arc.getCoord2D(i),this.m_arc.getCoord2D(1-i))-this.m_sqrChordLength:0}getError(e){return 0}};function AFe(t,e,i){if(Us(t))vpe(new mi({start:t.getStartXY(),end:t.getEndXY()}),e,i);else if(e.value()===0)i.set(t.getStartXY());else if(e.value()===1)i.set(t.getEndXY());else{const s=new ge;ufe(t,e,s);const n=new ge,r=new ge;ge.st_cosAndSin(s,n,r);const o=Et.constructCoordsE(new ge(t.m_semiMajorAxis).mulThisE(n),new ge(t.m_semiMajorAxis).mulThis(t.m_minorMajorRatio).mulThisE(r)),a=new ge(t.m_rotation);ge.st_cosAndSin(a,n,r),o.rotateDirect(n,r),o.addThisE(Et.constructPoint2D(t.m_center)),i.setE(o)}}function $U(t,e){return t.convertToCanonic(e)}function IFe(t,e){const i=new Me(t.getStartAngle(),t.getEndAngle());i.normalize();const s=ia(),n=xy(e,s);if(n<i.vmin){let r=n+s;for(;r<i.vmin;)r+=s;return i.containsCoordinate(r)?r:i.vmin-n<r-i.vmax?n:r}if(n>i.vmax){let r=n-s;for(;r>i.vmax;)r-=s;return i.containsCoordinate(r)||i.vmin-r<n-i.vmax?r:n}return n}function Q7(t,e,i,s){let n=t.m_startAngle,r=t.m_sweepAngle;const o=1e-12;for(;n>Zi();)n-=2*Zi();for(;n<=-Zi();)n+=2*Zi();if(!Number.isNaN(e)){for(;e>Zi();)e-=2*Zi();for(;e<=-Zi();)e+=2*Zi();!i&&e>n&&(e-=2*Zi()),i&&e<n&&(e+=2*Zi()),r=e-n,Math.abs(r)<o&&!s&&(r=i?2*Zi():-2*Zi()),Math.abs(r)>2*Zi()-o&&s&&(r=0)}Math.abs(r)>2*Zi()-o&&(r=r>=0?2*Zi():-2*Zi(),t.setEndXY(t.getStartXY())),Math.abs(r)<o&&(r=0,t.setEndXY(t.getStartXY())),s=Math.abs(r)<=Zi(),r&&(i=r>0),t.m_startAngle=Zv(n),t.m_sweepAngle=r,gS(t,!s),l4(t,i)}function Zv(t){let e=t,i=!1;return e<=-Zi()?(e+=ia(),i=!0):e>Zi()&&(e-=ia(),i=!0),e<=-Zi()?(e=xy(e,ia()),e<=-Zi()&&(e+=ia()),i=!0):e>Zi()&&(e=xy(e,ia()),e>Zi()&&(e-=ia()),i=!0),i&&(e>Zi()||e<=-Zi())&&(e=Zi()),e}function see(t,e,i){const s=i,n=s.getSemiAxes();let r=new N(n.x*Math.cos(t[0]),n.y*Math.sin(t[0]));return r=s.convertFromCanonic(r),N.sqrDistance(r,s.getStartXY())}function nee(t,e,i){const s=i,n=s.getSemiAxes(),r=t[0]+s.getStartAngle();let o=new N(n.x*Math.cos(r),n.y*Math.sin(r));return o=s.convertFromCanonic(o),N.sqrDistance(o,s.getEndXY())}function lB(t){if(t.m_center.isNAN())return t.m_startAngle=0,void(t.m_sweepAngle=0);const e=t.getStartXY(),i=t.getEndXY(),s=e.equals(i),n=tj(t),r=fS(t),o=t.projectionBehavior();if(s){const a=t.convertToCanonic(e),l=new N(t.m_semiMajorAxis,t.m_semiMajorAxis*t.m_minorMajorRatio);a.x/=l.x,a.y/=l.y,t.m_startAngle=Zv(Math.atan2(a.y,a.x)),t.m_sweepAngle=n?r?ia():-ia():0}else{const a=t.convertToCanonic(e),l=new N(t.m_semiMajorAxis,t.m_semiMajorAxis*t.m_minorMajorRatio);a.x/=l.x,a.y/=l.y;const u=t.convertToCanonic(i);u.x/=l.x,u.y/=l.y,t.m_startAngle=Math.atan2(a.y,a.x),t.m_sweepAngle=N.calculateAngle(a,u),r?t.m_sweepAngle<0&&(t.m_sweepAngle+=ia()):t.m_sweepAngle>0&&(t.m_sweepAngle-=ia()),t.m_startAngle=Zv(t.m_startAngle);let c=see([t.m_startAngle],1,t);if(c=Math.sqrt(c),c>.25*Em(t)){const d=t.m_startAngle-1e-4,m=t.m_startAngle+1e-4,f=[0];wJ(see,t,1,[t.m_startAngle],[d],[m],1e-14,f),t.m_startAngle=Zv(f[0])}if(c=nee([t.m_sweepAngle],1,t),c=Math.sqrt(c),c>.25*Em(t)){const d=t.m_sweepAngle-1e-4,m=t.m_sweepAngle+1e-4,f=[0];wJ(nee,t,1,[t.m_sweepAngle],[d],[m],1e-14,f),t.m_sweepAngle=f[0]}const h=Math.abs(t.m_sweepAngle)>Zi();if(gS(t,h),n!==h&&!n&&Math.abs(t.m_sweepAngle)>1.5*Zi()||t.m_sweepAngle===0||r!==t.m_sweepAngle>0)return void ac(t,e,i,o)}}function Fn(t,e){return(IFe(t,e)-t.getStartAngle())/t.getSweepAngle()}function Vc(t,e){return t.m_startAngle+e*t.m_sweepAngle}function ufe(t,e,i){i.assign(new ge(t.m_startAngle).addE(e.mulE(new ge(t.m_sweepAngle))))}function DFe(t,e){const i=new ge(t.m_cosr).sqrThis(),s=new ge(t.m_sinr).sqrThis(),n=new ge(t.m_minorMajorRatio),r=new ge(1/t.m_minorMajorRatio),o=n.mulE(i).addThisE(r.mulE(s)),a=n.subE(r).mulThis(2*t.m_cosr*t.m_sinr),l=n.mulE(s).addThisE(r.mulE(i));e[0]=o,e[1]=a,e[2]=l,e[3]=new ge(-t.m_semiMajorAxis).mulThis(t.m_semiMajorAxis).mulThis(t.m_minorMajorRatio)}function NFe(t,e){const i=new DG;i.a11.setE(t[0]),i.a12=ge.st_mulByPower2(t[1],.5),i.a21.setE(i.a12),i.a22.setE(t[2]);const s=[N.getNAN(),N.getNAN()],n=[new ge,new ge];i.eigenSymmetric(n,s);const r=t[3].clone();return r.negateThis(),r.invThis(),n[0].mulThisE(r),n[1].mulThisE(r),n[0].sqrtThis().invThis(),n[1].sqrtThis().invThis(),e.x=n[0].toDouble(),e.y=n[1].toDouble(),Math.atan2(s[0].y,s[0].x)}function RFe(t,e,i){if(Us(t))return(i-e)*N.distance(t.getStartXY(),t.getEndXY());if(t.m_minorMajorRatio===1)return Math.abs(t.getSweepAngle()*(e-i))*t.m_semiMajorAxis;const s=uB(t,e);return uB(t,i)-s}function UU(t){return t.m_cachedValues}function J7(t){if(t.m_cachedValues)return t.m_cachedValues;const e=PFe();return e.e2=LFe(t),e.completeE=P7(e.e2),t.m_cachedValues=e,e}function ree(t,e,i,s){if(!e.isEqual(t.m_XStart,t.m_YStart)||!i.isEqual(t.m_XEnd,t.m_YEnd)){if(Us(t))return t.m_XStart=e.x,t.m_YStart=e.y,t.m_XEnd=i.x,t.m_YEnd=i.y,hw(t),void t.afterCompletedModification();if(s&&Math.abs(t.getSweepAngle())<=1.01*aa()){const n=he(N,3),r=sj(t,n);if(r4(n)){if(n[0].assign(e),n[2].assign(i),x1(n),t.projectionBehavior()===0){let o=0,a=2;N.sqrDistance(n[1],n[0])<N.sqrDistance(n[1],n[2])&&(a=Ge(o,o=a));const l=n[a].sub(n[o]),u=l.length();l.divThis(u);const c=n[1].sub(n[o]),h=c.length(),d=c.dotProduct(l)/h,m=c.crossProduct(l)/h,f=new N;zn(n[o],n[a],.5,f);const _=.5*u/m*Os(1-d,0,1),v=n[1].side(n[o],n[a]),x=l.clone();v?x.leftPerpendicularThis():x.rightPerpendicularThis();const w=f.sub(x.mul(_));t.constructCircularArcThreePoint(n[0],n[2],w)}else tM(n,r*r,null,!1,t);return}}t.projectionBehavior()===0?qFe(t,e,i):pfe(t,e,i)}}function OFe(t,e,i){const s=t.projectionBehavior()===0;if(i<=2)return void ac(t,e[0],e[i-1],s?0:1);if(s){t.constructCircularArcThreePoint(e[0],e[i-1],e[Math.trunc(i/2)]);const f=new N;return t.queryCoord2D(.5,f),void t.m_interior.setCoordsPoint2D(f)}const n=t.getSemiMajorAxis(),r=t.getMinorMajorRatio(),o=t.getAxisXRotation(),a=t.getCenter(),l=new Array(4);l[0]=t.isMajor(),l[1]=!l[0],l[2]=l[0],l[3]=!l[0];const u=new Array(4);u[0]=t.isClockwise(),u[1]=u[0],u[2]=!u[0],u[3]=!u[0];const c=Math.trunc(i<5?1:(i+4)/5),h=he(Ed,4),d=st(4,Number.NaN);let m=0;for(let f=0;f<4;f++){h[f].constructEllipticArcEndPointsCenter(e[0],e[i-1],n,r,o,l[f],u[f],a),d[f]=0;let _=0;for(let v=c;v<i-1;v+=c){const x=h[f].getClosestCoordinate(e[v],!1);d[f]+=N.sqrDistance(h[f].getCoord2D(x),e[v]),_++}d[f]/=_,d[f]<d[m]&&(m=f)}t.assignCopy(h[m])}function LFe(t){return 1-Di(t.m_minorMajorRatio)}function oee(t,e,i,s,n,r,o,a,l){return t.m_bits=0,t.m_rotation=r,$7(t,e),U7(t,i),t.m_cosr=Math.cos(r),t.m_sinr=Math.sin(r),gS(t,o),l4(t,a),l!==void 0?t.m_center.assign(l):t.m_center.setNAN(),t.setProjectionBehavior(1),t.m_semiMajorAxis=s,t.m_minorMajorRatio=n,dfe(t,l===void 0)}function ac(t,e,i,s){t.m_bits=0,t.m_rotation=0,$7(t,e),U7(t,i),t.m_interior.assign(e.add(i).mul(.5)),t.m_startAngle=0,t.m_sweepAngle=0,t.m_cosr=1,t.m_sinr=0,gS(t,!1),l4(t,!1),t.m_center.setNAN(),t.m_semiMajorAxis=1,t.m_minorMajorRatio=0,t.setProjectionBehavior(s),t.afterCompletedModification()}function Us(t){return t.m_center.isNAN()}function uB(t,e){if(e===0)return 0;const i=J7(t),s=Vc(t,e),n=aa(),r=cfe(t),o=M7(s+n,i.e2,i.completeE),a=t.m_semiMajorAxis*(o-r);return Math.abs(a)}function FFe(t,e){if(Us(t)){const l=N.distance(t.getStartXY(),t.getEndXY());return l===0?0:e/l}if(t.m_minorMajorRatio===1){const l=Math.abs(t.getSweepAngle()*t.m_semiMajorAxis);return l===0?0:e/l}if(e===0)return 0;const i=t.getSweepAngle();if(i===0)return .5;const s=J7(t),n=aa(),r=cfe(t);i<0&&(e=-e);const o=e/t.m_semiMajorAxis+r;let a=e3e(o,s.e2,s.completeE);return a-=n,a-=t.getStartAngle(),a/i}function cfe(t){const e=J7(t);return M7(t.getStartAngle()+aa(),e.e2,e.completeE)}function ej(t,e,i){if(e.m_TransformationType===2)return void z(0);if(z(!ij(t)),e.isIdentity())return;n3(t);const s=N.getNAN();s.x=t.m_XStart,s.y=t.m_YStart,e.transformInPlace(s);const n=N.getNAN();if(n.x=t.m_XEnd,n.y=t.m_YEnd,e.transformInPlace(n),Us(t))return t.m_XStart=s.x,t.m_YStart=s.y,t.m_XEnd=n.x,void(t.m_YEnd=n.y);const r=t.m_center.clone();if(e.transformInPlace(r),i||e.isUniformNoRotation()){let o=fS(t);if(e.isReflective()&&(o=!o),t.projectionBehavior()===0){if(!s.equals(n)){const h=t.m_interior.clone();return e.transformInPlace(h),void t.constructCircularArcThreePoint(s,n,h)}return void hfe(t,s,n,r,o,!1)}const a=new N(t.m_cosr,t.m_sinr);e.transformWithoutTranslateInPlace(a);const l=Math.atan2(a.y,a.x),u=t.getSemiAxes();e.transformWithoutTranslateInPlace(u);const c=t.m_center.clone();return e.transformInPlace(c),void t.constructEllipticArcEndPointsCenter(s,n,u.x,u.y/u.x,l,t.isMajor(),o,c)}{{const h=new Array(4);DFe(t,h);const d=new DG;if(d.a11.setE(h[0]),d.a12.setE(h[1]),d.a12.mulThisByPower2(.5),d.a21.setE(d.a12),d.a22.setE(h[2]),!d.det().isZero()){const m=new DG;if(m.a11.set(e.xx),m.a12.set(e.xy),m.a21.set(e.yx),m.a22.set(e.yy),m.invertThis()){const f=m.clone();f.transposeThis();const _=d.clone();if(_.mulThis(m),_.mulLeftThis(f),!_.det().isZero()){const v=he(ge,4);v[0].setE(_.a11),v[1].setE(_.a12),v[1].mulThisByPower2(2),v[2].setE(_.a22),v[3].setE(h[3]);const x=N.getNAN(),w=NFe(v,x);let T=fS(t);return e.isReflective()&&(T=!T),void t.constructEllipticArcEndPointsCenter(s,n,x.x,x.y/x.x,w,t.isMajor(),T,r)}}}}const o=[N.getNAN(),N.getNAN(),N.getNAN()];o[0].setCoords(t.getSemiMajorAxis(),0),o[0].rotateDirect(t.m_cosr,t.m_sinr),o[1].setCoords(t.getSemiMajorAxis(),t.getSemiMinorAxis()),o[1].rotateDirect(t.m_cosr,t.m_sinr),o[2].setCoords(0,t.getSemiMinorAxis()),o[2].rotateDirect(t.m_cosr,t.m_sinr);let a=t.isClockwise();a&&(o[2]=Ge(o[0],o[0]=o[2]));const l=.5;e.transformWithoutTranslateArray(o,3,o),e.isReflective()&&(a=!a);const u=new N(0,0),c=t.createInstance();tM(o,l,u,!1,c),t.constructEllipticArcEndPointsCenter(s,n,c.getSemiMajorAxis(),c.getMinorMajorRatio(),c.getAxisXRotation(),t.isMajor(),!a,r)}}function hfe(t,e,i,s,n,r){const o=.5*(s.sub(e).length()+s.sub(i).length());t.m_center.assign(s),t.m_startAngle=Math.atan2(e.y-t.m_center.y,e.x-t.m_center.x),Q7(t,Math.atan2(i.y-t.m_center.y,i.x-t.m_center.x),n,r);const a=t.constructEllipticArcEndPointsCenter(e,i,o,1,0,Math.abs(t.m_sweepAngle)>Math.PI,t.m_sweepAngle>0,s);return t.setProjectionBehavior(0),a}function VU(t,e){t.m_cachedValues=e}function n3(t){t.m_cachedValues=null}function kFe(t,e){e.m_cachedValues=Ge(t.m_cachedValues,t.m_cachedValues=e.m_cachedValues)}function l4(t,e){const i=e?1:0;t.m_bits=-2&t.m_bits|i}function fS(t){return!!(1&t.m_bits)}function gS(t,e){const i=e?1:0;t.m_bits=-3&t.m_bits|i<<1}function tj(t){return!!(2&t.m_bits)}function $Fe(t){if(t.m_center.isNAN())return!1;const e=8,i=new Et;i.setWithEps(t.getStartXY(),e),i.subThisE(new Et().setWithEps(t.m_center,e));const s=new ge;s.setWithEps(t.m_rotation,e);const n=new ge,r=new ge;ge.st_cosAndSin(s,n,r),i.rotateReverse(n,r);const o=new Et;o.setWithEps(t.getEndXY()),o.subThisE(Et.constructPoint2D(t.m_center)),o.rotateReverse(n,r);const a=new ge;a.setWithEps(t.m_semiMajorAxis,e);const l=a.clone(),u=new ge;u.setWithEps(t.m_minorMajorRatio),l.mulThisE(u),i.x.divThisE(a),i.y.divThisE(l),o.x.divThisE(a),o.y.divThisE(l);const c=i.x.sqr().addThisE(i.y.sqr()).subThisE(Ff),h=o.x.sqr().addThisE(o.y.sqr()).subThisE(Ff);return!c.isZero()||!h.isZero()}function ij(t){return!!(8&t.m_bits)}function Cf(t){t.m_bits&=-9}function dfe(t,e){Cf(t);const i=t.getStartXY(),s=t.getEndXY();let n=!1;const r=tj(t),o=fS(t),a=t.projectionBehavior(),l=i.equals(s);let u=t.m_minorMajorRatio===0||t.m_semiMajorAxis===0;if(Number.isNaN(t.m_minorMajorRatio)&&(t.m_semiMajorAxis===0?t.m_minorMajorRatio=1:jme("NAN minor major ratio and non-zero major axis")),u||(u=e?l:t.m_center.isNAN()),u)return ac(t,i,s,a),!0;t.m_semiMajorAxis=Math.abs(t.m_semiMajorAxis),t.m_minorMajorRatio=Math.abs(t.m_minorMajorRatio),t.m_minorMajorRatio>1&&(t.m_semiMajorAxis*=t.m_minorMajorRatio,t.m_minorMajorRatio=1/t.m_minorMajorRatio);const c=new N(t.m_semiMajorAxis,t.m_semiMajorAxis*t.m_minorMajorRatio);if(l){const h=t.convertToCanonic(i);h.x/=c.x,h.y/=c.y;const d=Math.sqrt(Di(h.x)+Di(h.y));if(n=d!==1,t.m_semiMajorAxis*=d,c.mulThis(d),t.m_startAngle=Zv(Math.atan2(h.y,h.x)),!r)return t.m_interior.assign(i),t.m_sweepAngle=0,t.afterCompletedModification(),n;t.m_sweepAngle=o?ia():-ia()}else{let h=t.m_center.isNAN()||$Fe(t);if(!h){const d=t.convertToCanonic(i);d.x/=c.x,d.y/=c.y;const m=new N(1,0);t.m_startAngle=N.calculateAngle(m,d);const f=t.convertToCanonic(s);f.x/=c.x,f.y/=c.y,t.m_sweepAngle=N.calculateAngle(d,f),h=!aee(t)}if(h){n=!0;const d=i.sub(s).mulThis(.5);d.rotateReverse(t.m_cosr,t.m_sinr);let m=Di(d.x/c.x)+Di(d.y/c.y);m>1&&(m=Math.sqrt(m),t.m_semiMajorAxis*=m,c.mulThis(m));const f=new N(0,0);{const _=c.x*c.x,v=c.y*c.y,x=_*d.y*d.y+v*d.x*d.x,w=_*v-x;if(w>0){const T=Math.sqrt(w/x);f.setCoords(c.x*d.y/c.y,-c.y*d.x/c.x),f.mulThis(T),r===o&&f.negateThis()}}{const _=new N(f.x,f.y);_.rotateDirect(t.m_cosr,t.m_sinr),_.addThis(i.add(s).mulThis(.5)),t.m_center.assign(_)}}if(lB(t),!aee(t))return ac(t,i,s,a),!0}return hw(t),t.afterCompletedModification(),n}function sj(t,e){z(Math.abs(t.getSweepAngle())<15*Math.PI/16);const i=t.getSemiMajorAxis(),s=t.getSemiMinorAxis();let n;if(i===0)return e[0].setCoordsPoint2D(t.getStartXY()),e[1].setCoordsPoint2D(t.getStartXY()),e[2].setCoordsPoint2D(t.getStartXY()),n=1,n;if(s===0)return e[0].setCoordsPoint2D(t.getStartXY()),e[2].setCoordsPoint2D(t.getEndXY()),e[1]=N.lerp(e[0],e[2],.5),n=1,n;const r=t.getSweepAngle(),o=t.getStartAngle(),a=o+r,l=new N(-i*Math.sin(o),s*Math.cos(o)),u=new N(-i*Math.sin(a),s*Math.cos(a));l.normalize(),u.normalize(),l.rotateDirect(t.m_cosr,t.m_sinr),u.rotateDirect(t.m_cosr,t.m_sinr),e[0].setCoordsPoint2D(t.getStartXY()),e[2].setCoordsPoint2D(t.getEndXY()),e[1].setSub(e[2],e[0]);const c=l.crossProduct(u);return e[1].assign(l.mul(e[1].crossProduct(u)/c)),e[1].addThis(e[0]),n=Math.cos(.5*r),n}function tM(t,e,i,s,n){if(s){const W=Math.sqrt(e),ee=Di(1-.5)+2*W*.5*(1-.5)+Di(.5),ne=t[0].mul(Di(1-.5)).add(t[1].mul(2*W*.5*(1-.5))).add(t[2].mul(Di(.5))).divThis(ee);return n.constructCircularArcThreePoint(t[0],t[2],ne),!0}const r=t[0].sub(t[1]),o=t[2].sub(t[1]),a=r.crossProduct(o),l=r.dotProduct(o),u=e;z(u<=1),z(u>0);const c=.5/(1-u),h=r.sqrLength(),d=l,m=o.sqrLength(),f=Di(a),_=r.sub(o).sqrLength();if(f===0||l<=-Math.sqrt(h)*Math.sqrt(m))return ac(n,t[0],t[2],1),!1;const v=[0,0],x=new Me;x.setInfinite();const w=y1(2*f,-(_/u+4*d),2*(1-u)/u,x,!1,v);if(w===0)return ac(n,t[0],t[2],1),!1;w===1&&(v[1]=v[0]);const T=Math.sqrt(c/v[0]),C=Math.sqrt(c/v[1]),M=.5/u;let A=M-m*v[0],I=M-h*v[0];Math.abs(A)>Math.abs(I)?I=d*v[0]-M+1:A=d*v[0]-M+1;const L=r.mul(A).add(o.mul(I)),D=L.norm(1)<1e-15*T?0:Math.atan2(L.y,L.x)+Math.PI,O=r.add(o),U=i?i.clone():t[1].add(O.mul(c)),$=t[0].sub(U),B=t[2].sub(U),V=$.crossProduct(B)<0,H=!1;return new Ed,n.constructEllipticArcEndPointsCenter(t[0],t[2],T,C/T,D,H,!V,U)}function UFe(t,e,i,s,n){return tM(t,e,i,s,n)}function aee(t){let e=!1;{const s=new N(t.m_semiMajorAxis*Math.cos(t.m_startAngle),t.getSemiMinorAxis()*Math.sin(t.m_startAngle));s.rotateDirect(t.m_cosr,t.m_sinr),s.addThis(t.m_center),e=N.distance(t.getStartXY(),s)>Em(t)}let i=!1;if(!e){const s=new N(t.m_semiMajorAxis*Math.cos(t.m_startAngle+t.m_sweepAngle),t.getSemiMinorAxis()*Math.sin(t.m_startAngle+t.m_sweepAngle));s.rotateDirect(t.m_cosr,t.m_sinr),s.addThis(t.m_center),i=N.distance(t.getEndXY(),s)>Em(t)}return!e&&!i}function VFe(t,e,i,s){i===0&&ce("construct_enclosing_circle");const n=[0,0,0],r=SFe(e,i,n);if(r===1)t.constructCircleRadius(0,e[n[0]],s);else if(r===2){const o=N.lerp(e[n[0]],e[n[1]],.5),a=N.distance(e[n[0]],o),l=N.distance(e[n[1]],o);t.constructCircleRadius(Math.max(a,l),o,s)}else if(r===3){const o=N.calculateCircleCenterFromThreePoints(e[n[0]],e[n[1]],e[n[2]]),a=N.distance(e[n[0]],o),l=N.distance(e[n[1]],o),u=N.distance(e[n[2]],o);t.constructCircleRadius(Math.max(a,l,u),o,s)}else We("unexpected")}function lee(t){if(Us(t)||t.isDegenerate(0))return 0;const e=t.m_semiMajorAxis,i=t.getSemiMinorAxis(),s=e*e+i*i,n=t.getStartAngle(),r=t.getEndAngle(),o=t.m_center.y-t.m_YStart,a=t.m_cosr,l=t.m_sinr;let u=1,c=0;t.m_rotation&&(u=(a-l)*(a+l),c=2*a*l);const h=((-.5*(r-n)+.25*u*(2*Math.cos(r+n)*Math.sin(r-n)))*i+-2*Math.sin(.5*(r+n))*Math.sin(.5*(r-n))*a*o)*e/s;let d=0;return t.m_rotation&&(d=.125*(-2*Math.sin(r+n)*Math.sin(r-n))*c-i*o/s*(2*Math.cos(.5*(r+n))*Math.sin(.5*(r-n)))*l),s*(h+d)+-.5*(t.m_XEnd-t.m_XStart)*(t.m_YEnd-t.m_YStart)}function hw(t){t.queryCoord2D(.5,t.m_interior)}function uee(t,e,i,s,n){if(n){if(Gl(e,i)!==0)return 2}else if(Mu(e,i))return 1;return iM(t,e,i,null,null,null,s,n!==void 0&&n,!0,!1)!==0?4:0}function zFe(t,e,i,s,n){if(n){if(Gl(e,i)!==0)return 2}else if(Mu(e,i))return 1;return mfe(t,e,i,null,null,null,s,n!==void 0&&n,!0,!1)!==0?4:0}function iM(t,e,i,s,n,r,o,a,l,u){if(Us(e))return n4(new mi({start:e.getStartXY(),end:e.getEndXY()}),i,s,n,r,o,a,u);n!==null&&(n.length=0),r!==null&&(r.length=0),s!==null&&(s.length=0);const c=hl(e,i);if(Au(e,i,o=Math.max(c,o)))return 0;const h=i.getStartXY();h.subThis(e.m_center);const d=i.getEndXY();d.subThis(e.m_center),h.rotateReverse(e.m_cosr,e.m_sinr),d.rotateReverse(e.m_cosr,e.m_sinr);const m=d.clone();m.subThis(h);const f=e.m_semiMajorAxis,_=1/f,v=e.getSemiMinorAxis(),x=1/v,w=m.clone();w.leftPerpendicularThis();const T=Math.atan2(v*w.y,f*w.x),C=st(16,Number.NaN),M=st(16,Number.NaN);let A=0;const I=[T,T+Math.PI];for(let V=0;V<2;++V){const H=Fn(e,I[V]);if(H>=0&&H<=1){C[A]=H;const Y=e.getCoord2D(C[A]);M[A]=i.getClosestCoordinate(Y,!1),N.distance(Y,i.getCoord2D(M[A]))<=o&&A++}}const L=h.x*_,D=h.y*x,O=m.x*_,U=m.y*x;let $=y1(O*O+U*U,2*(L*O+D*U),L*L+D*D-1,Me.unit(),!1,M);z($>=0);for(let V=0;V<$;V++){const H=m.mul(M[V]).add(h);H.x*=_,H.y*=x;const Y=Fn(e,Math.atan2(H.y,H.x));if(Y>=0&&Y<=1){C[A]=Y;const W=e.getCoord2D(Y);M[A]=i.getClosestCoordinate(W,!1),N.distance(W,i.getCoord2D(M[A]))<=o&&A++}}z(A<C.length+4);const B=st(16,Number.NaN);$=e.intersectPoint(i.getStartXY(),B,o);for(let V=0;V<$;V++,A++)C[A]=B[V],M[A]=0;$=e.intersectPoint(i.getEndXY(),B,o);for(let V=0;V<$;V++,A++)C[A]=B[V],M[A]=1;$=i.intersectPoint(e.getStartXY(),B,o);for(let V=0;V<$;V++,A++)C[A]=0,M[A]=B[V];$=i.intersectPoint(e.getEndXY(),B,o);for(let V=0;V<$;V++,A++)C[A]=1,M[A]=B[V];return A===0?0:Iu(t,e,i,C,M,A,s,n,r,o,a,l,u)}function mfe(t,e,i,s,n,r,o,a,l,u){if(Us(e)){const O=new mi({start:e.getStartXY(),end:e.getEndXY()});return iM(t,i,O,s,r,n,o,a,l,!0)}if(Us(i)){const O=new mi({start:i.getStartXY(),end:i.getEndXY()});return iM(t,e,O,s,n,r,o,a,l,u)}const c=hl(e,i);o=Math.max(o,c);let h=!1;{const O=e.getSemiAxes(),U=e.getCenter(),$=i.getSemiAxes(),B=i.getCenter(),V=N.distance(B,U),H=O.x+$.x;if(V>H+o)return 0;if(O.y>$.x){if(V+$.x+o<O.y)return 0}else if($.y>O.x&&V+O.x+o<$.y)return 0;if(l&&!a){const Y=e.m_minorMajorRatio===1&&e.isClosed()&&e.isMajor(),W=i.m_minorMajorRatio===1&&i.isClosed()&&i.isMajor();if(Y&&W&&(h=!0,V<=H)&&Math.max(O.x,$.x)<=Math.min(O.x,$.x)+V)return z(!n&&!r),1}}if(!h&&Au(e,i,o))return 0;const d=[],m=[],f=!1,_=!1,v=dL(e,0,0,f,_,d,m,null),x=[],w=[],T=dL(i,0,0,f,_,x,w,null);if(v===1&&T===1){const O=new il({points:d,weights:m}),U=new il({points:x,weights:w}),$=[],B=[],V=BP(!1,O,U,s,n===null?null:$,r===null?null:B,o,a,l,u);if(V>0&&n!==null||r!==null){n&&(n.length=0),r&&(r.length=0);for(let H=0;H<V;++H){if(n)if(Vs($[H],0,1))n.push($[H]);else{const Y=O.tToLength($[H]),W=e.lengthToT(Y);n.push(W)}if(r)if(Vs(B[H],0,1))r.push(B[H]);else{const Y=U.tToLength(B[H]),W=i.lengthToT(Y);r.push(W)}}}return V}let C=[];const M=[];let A=0;const I=l&&!a;for(let O=0;O<v;O++){const U=new il({points:d.slice(2*O,2*O+3),weights:m.slice(2*O,2*O+3)});let $=0;for(let B=0;B<T;B++){M.length<=B&&M.push(new il({points:x.slice(2*B,2*B+3),weights:w.slice(2*B,2*B+3)}));const V=[],H=[],Y=I?null:V,W=I?null:H,ee=BP(!1,U,M[B],null,Y,W,o,!1,I,!1);if(ee>0&&I)return 1;for(let ne=0;ne<ee;++ne){if(V[ne]===0&&O===0)V[ne]=0;else if(V[ne]===1&&O===v-1)V[ne]=1;else{const j=U.tToLength(V[ne])+A,oe=e.lengthToT(j);V[ne]=oe}if(H[ne]===0&&B===0)H[ne]=0;else if(H[ne]===1&&B===T-1)H[ne]=1;else{const j=M[B].tToLength(H[ne])+$,oe=i.lengthToT(j);H[ne]=oe}C.push(gr(V[ne],H[ne]))}$+=M[B].calculateLength2D()}A+=U.calculateLength2D()}if(C.length===0)return 0;if(a&&(C=C.filter(O=>!Vs(O.first,0,1)||!Vs(O.second,0,1)||!e.getCoord2D(O.first).equals(i.getCoord2D(O.second)))),l)return C.length;const L=[],D=[];for(const O of C)L.push(O.first),D.push(O.second);return Iu(t,e,i,L,D,L.length,s,n,r,o,a,l,u)}function cee(t,e,i){if(i.setCoords(t.getCoord2D(e.vmin)),i.mergeNe(t.getCoord2D(e.vmax)),Us(t))return;const s=t.getSemiAxes(),n=[0,0,0,0];{const o=Math.atan2(-s.y*t.m_sinr,s.x*t.m_cosr),a=o+Math.PI,l=Math.atan2(s.y*t.m_cosr,s.x*t.m_sinr),u=l+Math.PI;n[0]=Fn(t,o),n[1]=Fn(t,a),n[2]=Fn(t,l),n[3]=Fn(t,u)}const r=new N;for(let o=0;o<4;o++){const a=n[o];e.containsExclusiveCoordinate(a)&&(t.queryCoord2D(a,r),i.mergeNe(r))}}function hee(t,e,i,s,n){if(t.m_semiMajorAxis===0)return i.vmin;let r=N.getNAN();t.queryCoord2D(i.vmin,r);let o=N.getNAN();if(t.queryCoord2D(i.vmax,o),Us(t))return new mi({start:r,end:o}).getClosestCoordinate(e,s);const a=$U(t,e);if(r=$U(t,r),o=$U(t,o),t.m_minorMajorRatio===1){if(a.isEqual(0,0))return i.vmin;const A=Fn(t,Math.atan2(a.y,a.x));return s||i.containsCoordinate(A)?A:N.distance(a,r)<=N.distance(a,o)?i.vmin:i.vmax}const l=t.getSemiMajorAxis(),u=t.getSemiMinorAxis(),c=(l-u)*(l+u),h=Di(c),d=a.x,m=a.y,f=Di(u*m),_=u*c*m*2,v=[new ge(f),new ge(_),new ge(h-Di(l*d)-f),new ge(-_),new ge(-h)],x=he(ge,4),w=Epe(v,4,new Me(-1,1),!1,x,4);let T=i.vmin,C=N.sqrDistance(a,r);{const A=N.sqrDistance(a,o);A<C&&(T=i.vmax,C=A)}z(!s);let M=st(8,Number.NaN);for(let A=0;A<w;++A){const I=x[A].value(),L=Math.sqrt(1-I*I),D=Math.atan2(I,L),O=Math.atan2(I,-L);M[2*A]=Fn(t,D),M[2*A+1]=Fn(t,O)}M=M.slice(0,2*w),KS(M);for(let A=0,I=2*w;A<I;++A)if(M[A]>i.vmin&&M[A]<i.vmax){const L=N.sqrDistance(e,t.getCoord2D(M[A]));C>L&&(C=L,T=M[A])}return T}function GFe(t,e,i){z(!Us(t));const s=new Gi;s.setRotateAngle(-t.getAxisXRotation());const n=new N;s.queryTransform(e,n);const r=Math.atan2(-n.x*t.getMinorMajorRatio(),n.y),o=r+Zi();let a=Fn(t,r),l=Fn(t,o);l<a&&(l=Ge(a,a=l));let u=0;return a>=0&&a<=1&&(i[u++]=a),l>=0&&l<=1&&(i[u++]=l),u}function dee(t,e,i){return t.m_semiMajorAxis===e.m_semiMajorAxis&&t.isMajor()!==e.isMajor()&&!!t.m_center.equals(e.m_center)&&t.m_sinr===e.m_sinr&&t.m_cosr===e.m_cosr&&t.m_minorMajorRatio===e.m_minorMajorRatio&&(i?t.isClockwise()!==e.isClockwise():t.isClockwise()===e.isClockwise())}function BFe(t,e,i){if(Us(t))i.setE(Et.constructPoint2D(t.getEndXY()).subE(Et.constructPoint2D(t.getStartXY())));else{const s=new ge;ufe(t,e,s);const n=new Et;if(n.setCoordsE(new ge(t.m_semiMajorAxis).negate().mulE(new ge().setSin(s)),new ge(t.getSemiMinorAxis()).mulE(new ge().setCos(s))),t.m_rotation){const r=new ge(t.m_rotation);n.rotateDirect(new ge().setCos(r),new ge().setSin(r))}n.scaleThis(new ge(t.getSweepAngle())),i.setE(n)}}function qFe(t,e,i,s){const n=t.getStartXY(),r=t.getEndXY(),o=n.equals(r),a=e.equals(i);if(!o&&!a){const _=new Gi;_.setShiftCoords(-t.m_XStart,-t.m_YStart);const v=N.distance(e,i),x=N.distance(n,r),w=v/x;_.scale(w,w);const T=r.sub(n);T.divThis(x);const C=i.sub(e);C.divThis(v);const M=T.crossProduct(C),A=C.dotProduct(T);return _.rotate(A,M),_.shiftCoords(e.x,e.y),ej(t,_,!0),t.m_XStart=e.x,t.m_YStart=e.y,t.m_XEnd=i.x,void(t.m_YEnd=i.y)}const l=new N;if(t.queryCoord2D(.5,l),a){if(o){const _=t.m_center.add(e.sub(n));t.constructEllipticArcEndPointsCenter(e,i,t.getSemiMajorAxis(),1,0,!0,!t.isClockwise(),_),t.setProjectionBehavior(0)}else if(t.isMajor()){const _=l.sub(e).getUnitVector().mul(2*t.getSemiMajorAxis()).add(e);t.constructCircularArcThreePoint(e,i,_)}else t.constructCircularArcThreePoint(e,i,e);return}const u=e.add(i).mul(.5),c=i.sub(e);c.rightPerpendicularThis();const h=u.add(c),d=N.getClosestCoordinate(u,h,t.getCenter(),!0),m=new N;zn(u,h,d,m);const f=N.distance(e,m);t.constructEllipticArcEndPointsCenter(e,i,f,1,0,!0,!t.isClockwise(),m),t.setProjectionBehavior(0)}function pfe(t,e,i,s){const n=t.getStartXY(),r=t.getEndXY(),o=n.equals(r),a=e.equals(i);if(!o&&!a){const m=new Gi;return m.initializeFromTwoPoints(n,r,e,i),ej(t,m,!0),t.m_XStart=e.x,t.m_YStart=e.y,t.m_XEnd=i.x,t.m_YEnd=i.y,t.endPointModified(),void t.normalizeAfterEndpointChange()}if(!t.isMajor())return void ac(t,e,i,1);if(o&&a){const m=t.m_center.add(e.sub(n));return void t.constructEllipticArcEndPointsCenter(e,i,t.getSemiMajorAxis(),t.getMinorMajorRatio(),t.getAxisXRotation(),!0,!t.isClockwise(),m)}if(!o){const m=.5*(ia()-Math.abs(t.getSweepAngle())),f=(t.getSweepAngle()+m*In(t.getSweepAngle()))/t.getSweepAngle(),_=new N;t.queryCoord2D(f,_),t.constructEllipticArcEndPointsCenter(_,_,t.getSemiMajorAxis(),t.getMinorMajorRatio(),t.getAxisXRotation(),!0,!t.isClockwise(),t.getCenter());const v=t.getCenter().add(e.sub(_));return void t.constructEllipticArcEndPointsCenter(e,i,t.getSemiMajorAxis(),t.getMinorMajorRatio(),t.getAxisXRotation(),!0,!t.isClockwise(),v)}const l=N.sqrDistance(e,i);let u=.25,c=.75;if(l<N.sqrDistance(t.getCoord2D(.25),t.getCoord2D(.75))){const m=[0],f=zy(new MFe(t,l),Me.construct(0,.25),1,m);f>0&&(z(f===1),u=m[0],c=1-m[0])}const h=t.getCoord2D(u),d=t.getCoord2D(c);z(!h.equals(d)),t.constructEllipticArcEndPointsCenter(h,d,t.getSemiMajorAxis(),t.getMinorMajorRatio(),t.getAxisXRotation(),!0,!t.isClockwise(),t.m_center),pfe(t,e,i)}function HFe(t,e){let i,s=e,n=null;switch(s||(n=C7(t)?LP():go(),s=n),t){case q.enumPoint:i=new Jt({vd:s});break;case q.enumLine:i=new mi({vd:s});break;case q.enumBezier:i=new hc({vd:s});break;case q.enumEllipticArc:i=new Ed({vd:s});break;case q.enumRationalBezier2:i=new il({vd:s});break;case q.enumBezier2:i=new v1({vd:s});break;case q.enumEnvelope:i=new Fo({vd:s});break;case q.enumMultiPoint:i=new Dn({vd:s});break;case q.enumPolyline:i=new Qi({vd:s});break;case q.enumPolygon:i=new Ci({vd:s});break;case q.enumMultipatch:_i("multipatch not impl");break;case q.enumGeometryCollection:i=new ype({vd:s});break;default:ce("Geometry.create")}return i}var mee=Hs;const G=-1,Tn=1;let jFe=class{constructor(e){this.m_shape=e}userSort(e,i,s){this.m_shape.sortVerticesSimpleByYHelper(s,e,i)}getValue(e){return this.m_shape.getY(e)}};function YFe(t){return t.parent!==void 0}let cB=class ffe{constructor(e){YFe(e)?(this.m_parent=e.parent,this.m_geometry=e.geometry,this.m_path=e.path,this.m_vertex=e.vertex,this.m_firstVertex=e.firstVertex,this.m_index=e.selection?0:e.index,this.m_bSkipMultiPoints=e.bSkipMultiPoints,this.m_selection=e.selection,this.m_bOneGeom=e.bOneGeom,this.m_bFirst=!0):(this.m_parent=e.copy.m_parent,this.m_geometry=e.copy.m_geometry,this.m_path=e.copy.m_path,this.m_vertex=e.copy.m_vertex,this.m_index=e.copy.m_index,this.m_bSkipMultiPoints=e.copy.m_bSkipMultiPoints,this.m_firstVertex=e.copy.m_firstVertex,this.m_bFirst=!0,this.m_selection=e.copy.m_selection,this.m_bOneGeom=e.copy.m_bOneGeom)}moveToNextHelper(){for(this.m_path=this.m_parent.getNextPath(this.m_path),this.m_index=0;this.m_geometry!==G;){for(;this.m_path!==G;this.m_path=this.m_parent.getNextPath(this.m_path))if(this.m_vertex=this.m_parent.getFirstVertex(this.m_path),this.m_firstVertex=this.m_vertex,this.m_vertex!==G)return this.m_vertex;if(this.m_bOneGeom)return G;if(this.m_geometry=this.m_parent.getNextGeometry(this.m_geometry),this.m_geometry===G)break;this.m_bSkipMultiPoints&&!Ei(this.m_parent.getGeometryType(this.m_geometry))||(this.m_path=this.m_parent.getFirstPath(this.m_geometry))}return G}nextSelection(){for(;this.m_index<this.m_parent.m_selectedVertices.length;){const e=this.m_parent.m_selectedVertices[this.m_index++];if(e!==G&&(this.m_path=this.m_parent.getPathFromVertex(e),!this.m_bOneGeom||this.m_geometry===this.m_parent.getGeometryFromPath(this.m_path)))return this.m_geometry=this.m_parent.getGeometryFromPath(this.m_path),e}return G}next(){return this.m_selection?this.nextSelection():this.m_bFirst?(this.m_bFirst=!1,this.m_vertex):this.m_vertex!==G?(this.m_vertex=this.m_parent.getNextVertex(this.m_vertex),this.m_index++,this.m_vertex!==G&&this.m_vertex!==this.m_firstVertex?this.m_vertex:this.moveToNextHelper()):G}currentGeometry(){return this.m_geometry}currentPath(){return this.m_path}static create_(e,i,s,n,r,o,a,l,u){return new ffe({parent:e,geometry:i,path:s,vertex:n,firstVertex:r,index:o,bSkipMultiPoints:a,selection:l,bOneGeom:u})}},hB=class{constructor(e){this.parentage=e}equals(e){return this.parentage===e.parentage}},wn=class dB{setPrevPath(e,i){this.m_pathIndexList.setField(e,1,i)}setNextPath(e,i){this.m_pathIndexList.setField(e,2,i)}setPathFlags(e,i){this.m_pathIndexList.setField(e,6,i)}getPathFlags(e){return this.m_pathIndexList.getField(e,6)}setPathGeometry(e,i){this.m_pathIndexList.setField(e,7,i)}getPathIndex(e){return this.m_pathIndexList.getField(e,0)}setNextGeometry(e,i){this.m_geometryIndexList.setField(e,1,i)}setPrevGeometry(e,i){this.m_geometryIndexList.setField(e,0,i)}getGeometryIndex(e){return this.m_geometryIndexList.getField(e,7)}setFirstPath(e,i){this.m_geometryIndexList.setField(e,3,i)}setLastPath(e,i){this.m_geometryIndexList.setField(e,4,i)}newGeometry(e){const i=this.m_geometryIndexList.newElement();return this.m_geometryIndexList.setField(i,2,e),this.m_geometryIndexList.setField(i,5,0),this.m_geometryIndexList.setField(i,6,0),this.m_geometryIndexList.setField(i,7,this.m_geometryIndexList.elementToIndex(i)),i}freeGeometry(e){this.m_geometryIndexList.deleteElement(e)}newPath(e){const i=this.m_pathIndexList.newElement(),s=this.m_pathIndexList.elementToIndex(i);if(this.m_pathIndexList.setField(i,0,s),this.m_pathIndexList.setField(i,3,0),this.m_pathIndexList.setField(i,6,0),this.setPathGeometry(i,e),s>=this.m_pathAreas.length){const n=Math.trunc(s<16?16:3*s/2);this.m_pathAreas.length=n,this.m_pathLengths.length=n}return this.m_pathAreas[s]=0,this.m_pathLengths[s]=0,this.m_pathCount++,i}freePath(e){this.m_pathIndexList.deleteElement(e),this.m_pathCount--}newVertex(e){const i=this.m_vertexIndexList.newElement(),s=e>=0?e:this.m_vertexIndexList.elementToIndex(i);if(this.m_vertexIndexList.setField(i,0,s),e<0){if(s>=this.m_vertices.getPointCount()){const n=Math.trunc(s<16?16:3*s/2);this.m_vertices.reserveRounded(n),this.m_vertices.resizeNoInit(n),this.m_segments!==null&&(this.m_segments.length=n),this.m_xyStream=this.m_vertices.getAttributeStreamRef(0)}this.m_segments&&(this.m_segments[s]=null)}return this.m_pointCount++,i}freeVertex(e){this.unselect(e);const i=this.getVertexIndex(e);this.m_vertexIndexList.deleteElement(e),this.m_pointCount--;for(let s=0,n=this.m_indices.length;s<n;s++){if(s===this.m_selectionIndex)continue;const r=this.m_indices[s];r!==null&&r.size()>i&&r.write(i,-1)}this.m_weights&&this.m_weights.size()>i&&this.m_weights.write(i,1),this.m_ranks&&this.m_ranks.size()>i&&this.m_ranks.write(i,Tn),this.m_segmentWeights&&this.m_segmentWeights.size()>i&&this.m_segmentWeights.write(i,1),this.m_segmentRanks&&this.m_segmentRanks.size()>i&&this.m_segmentRanks.write(i,Tn),this.m_segments&&this.setSegmentToIndex(i,null)}insertVertex_(e,i,s,n){this.m_hasForceSetEnvelope=0;const r=i!==G?this.getPrevVertex(i):this.getLastVertex(e),o=r!==G?this.getNextVertex(r):G,a=this.newVertex(s===null?this.m_pointCount:-1),l=this.getVertexIndex(a);s!==null&&this.m_vertices.setPointByVal(l,s),this.setPathToVertex(a,e),this.setNextVertex(a,o),this.setPrevVertex(a,r),o!==G&&this.setPrevVertex(o,a),r!==G&&this.setNextVertex(r,a);const u=this.isClosedPath(e),c=this.getFirstVertex(e);i===G&&this.setLastVertex(e,a),i===c&&(u&&n&&c!==G||this.setFirstVertex(e,a)),u&&o===G&&(this.setNextVertex(a,a),this.setPrevVertex(a,a)),this.setPathSize(e,this.getPathSize(e)+1);const h=this.getGeometryFromPath(e);return this.setGeometryVertexCount(h,this.getPointCount(h)+1),a}getHelperPoint(){return this.m_helperPoint||(this.m_helperPoint=new Jt({vd:this.m_vertices.getDescription()}),this.m_helperPoint.setXYCoords(0,0)),this.m_helperPoint}addMultiPoint(e,i){const s=this.createGeometry(e.getGeometryType(),e.getDescription());return this.appendMultiPoint(s,e,i),s}addPoint_(e,i){const s=this.createGeometry(q.enumMultiPoint,e.getDescription());return this.appendPoint(s,e,i),s}appendMultiPath_(e,i){if(i.isEmpty())return;const s=i.getImpl();this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+s.getPointCount()),this.m_verticesMp.addPoints(i,0,s.getPointCount()),this.m_xyStream=this.m_vertices.getAttributeStreamRef(0);const n=this.m_segments!==null||s.getSegmentFlagsStreamRef()!==null;this.m_vertexIndexList.setCapacity(this.m_vertexIndexList.size()+s.getPointCount()),this.m_pathIndexList.setCapacity(this.m_pathIndexList.size()+s.getPathCount());for(let r=0,o=s.getPathCount();r<o;r++){if(s.getPathSize(r)===0)continue;const a=this.insertPath(e,G);this.setClosedPath(a,s.isClosedPath(r));for(let l=s.getPathStart(r),u=s.getPathEnd(r);l<u;l++){const c=this.insertVertex_(a,G,null,!1);if(n){const h=this.getVertexIndex(c);if(1&s.getSegmentFlags(l))this.setSegmentToIndex(h,null);else{const d=new ii;s.querySegment(l,d,!0),this.setSegmentToIndex(h,d.releaseSegment())}}}s.isStrongPathStart(r)&&this.setStrongPathStart(a,!0),s.isStrongPathEnd(r)&&this.setStrongPathEnd(a,!0)}}addMultiPath(e,i){const s=this.createGeometry(e.getGeometryType(),e.getDescription());return e.getGeometryType()===q.enumPolygon&&this.setFillRule(s,e.getFillRule()),this.appendMultiPath(s,e,i),s}appendMultiPathPolyline(e,i,s){var a;const n=i.getImpl(),r=this.m_segments!==null||n.getSegmentFlagsStreamRef()!==null,o=new J;i.queryEnvelope(o);{const l=s.clone();let u=n.getPointCount();const c=n.getAccelerators();if(c&&c.getQuadTree()&&(u=c.getQuadTree().getIntersectionCount(l,0,n.getPointCount()+1)),u<i.getPointCount()){if(u===0)return;const h=n.queryLimitedSegmentIterator(l);let d=-1,m=-100,f=-1,_=0,v=-1,x=G,w=!1,T=h.nextSegment();if(T!==null)for(;;T=h.nextSegment()){let C=T===null;const M=T!==null?h.getPathIndex():d,A=T!==null?h.getStartPointIndex():m;if(C||(d===M&&m+1===A?_++:C=!0),C){if(v!==-1){let I=-1,L=-1;if(_===f){this.setClosedPath(x,w);const D=n.getPathEnd(d);this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+D-v),this.m_verticesMp.addPoints(i,v,D),L=n.getPathSize(d),I=D-1}else if(!w||m+1<n.getPathEnd(d))this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+m+2-v),this.m_verticesMp.addPoints(i,v,m+2),L=m-v+2,I=m;else{this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+m+2-v),(a=this.m_verticesMp)==null||a.addPoints(i,v,m+1),I=m,L=m-v+1;const D=n.getPathStart(d);this.m_verticesMp.addPoints(i,D,D+1),L+=1}this.m_xyStream=this.m_vertices.getAttributeStreamRef(0);for(let D=0,O=v;D<L;D++,O++){const U=this.insertVertex_(x,G,null,!1);if(r){const $=this.getVertexIndex(U);if(1&n.getSegmentFlags(O)||O>I)this.setSegmentToIndex($,null);else{const B=new ii;n.getSegmentBuffer(O,B,!0),this.setSegmentToIndex($,B.releaseSegment())}}}}if(T===null)break;_=1,v=A,d!==M?(x=this.insertPath(e,G),this.setClosedPath(x,!1),f=n.getSegmentCountPath(M),w=n.isClosedPath(M),d=M):x=this.insertPath(e,G)}m=A}return}}this.appendMultiPath_(e,i)}appendMultiPathPolygon(e,i,s){var M;const n=i.getImpl(),r=this.m_segments!==null||n.getSegmentFlagsStreamRef()!==null,o=J.constructEmpty();i.queryEnvelope(o),z(s.isIntersecting(o)&&!s.containsEnvelope(o));let a=J.construct(Number.NEGATIVE_INFINITY,s.ymin,Number.POSITIVE_INFINITY,s.ymax),l=J.construct(s.xmin,Number.NEGATIVE_INFINITY,s.xmax,Number.POSITIVE_INFINITY);const u=n.getAccelerators();if(u&&u.getQuadTree()){const A=u.getQuadTree(),I=A.getIntersectionCount(a,0,0);I>A.getIntersectionCount(l,0,I+1)&&(l=Ge(a,a=l))}else a.height()>l.width()&&(l=Ge(a,a=l));const c=[],h=n.queryLimitedSegmentIterator(a);let d=-1,m=-100,f=-1,_=0,v=-1,x=-1,w=G,T=!0,C=h.nextSegment();if(C!==null)for(;;C=h.nextSegment()){let A=C===null;const I=C!==null?h.getPathIndex():d,L=C!==null?h.getStartPointIndex():m;if(A||(I===d?m+1===L?_++:A=!0:(A=d>=0,d<0&&(d=I,f=n.getSegmentCountPath(d),v=L,w=G,_=1))),A){if(!(c.length===0&&f===_)){c.length!==0&&c[0].first===v||(this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+1),this.m_verticesMp.addPoints(i,v,v+1),x===-1&&(x=v),w===G&&(w=this.insertPath(e,G),this.setClosedPath(w,!0)),this.m_xyStream=this.m_vertices.getAttributeStreamRef(0),this.insertVertex_(w,G,null,!1));for(const{first:D,second:O}of c){x===-1&&(x=D);let U=-1,$=-1;const B=D+O-1;if(O===f){const V=B+1;$=V-D,this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+$),this.m_verticesMp.addPoints(i,D,V),U=B,z(c.length===1)}else if(B+1<n.getPathEnd(d)){const V=B+2;$=V-D,this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+$),this.m_verticesMp.addPoints(i,D,V),U=B}else{const V=n.getPathStart(d),H=V!==x?1:0,Y=B+1;$=Y-D+H,this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+(Y-D)+H),this.m_verticesMp.addPoints(i,D,Y),U=B,H>0&&((M=this.m_verticesMp)==null||M.addPoints(i,V,V+1))}this.m_xyStream=this.m_vertices.getAttributeStreamRef(0),w===G&&(w=this.insertPath(e,G),this.setClosedPath(w,!0));for(let V=0,H=D;V<$;V++,H++){const Y=this.insertVertex_(w,G,null,!1);if(r){const W=this.getVertexIndex(Y);if(1&n.getSegmentFlags(H)||H>U)this.setSegmentToIndex(W,null);else{const ee=new ii;n.getSegmentBuffer(H,ee,!0),this.setSegmentToIndex(W,ee.releaseSegment())}}}}if(c.length===0||c.at(-1).first+c.at(-1).second!==v+_){let D=v+_;D===i.getPathEnd(d)&&(D=i.getPathStart(d)),x!==D&&(this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+1),this.m_verticesMp.addPoints(i,D,D+1),this.insertVertex_(w,G,null,!1))}}c.length=0,T=!0,I!==d&&(d=I,f=n.getSegmentCountPath(d),w=G,x=-1),v=L,_=1}if(!C)break;{const D=J.constructEmpty();C.queryLooseEnvelope(D),l.isIntersecting(D)?(T?c.push(gr(L,1)):c.at(-1).second++,T=!1):T=!0}m=L}}appendMultiPath(e,i,s){if(s===void 0)return void this.appendMultiPath_(e,i);if(i.isEmpty())return;const n=i.getGeometryType()===q.enumPolygon,r=J.constructEmpty();i.queryEnvelope(r),s.isIntersecting(r)&&(!s.containsEnvelope(r)&&i.getPointCount()>10?n?this.appendMultiPathPolygon(e,i,s):this.appendMultiPathPolyline(e,i,s):this.appendMultiPath_(e,i))}appendPoint(e,i,s){if(i.isEmpty()||s!==void 0&&!s.contains(i.getXY()))return;this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+1),this.m_verticesMp.add(i),this.m_xyStream=this.m_vertices.getAttributeStreamRef(0),this.m_vertexIndexList.setCapacity(this.m_vertexIndexList.size()+1);const n=this.insertPath(e,G);this.insertVertex_(n,G,null,!1)}appendMultiPoint_(e,i){this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+i.getPointCount()),this.m_verticesMp.addPoints(i,0,i.getPointCount()),this.m_xyStream=this.m_vertices.getAttributeStreamRef(0),this.m_vertexIndexList.setCapacity(this.m_vertexIndexList.size()+i.getPointCount());const s=this.insertPath(e,G);for(let n=0,r=i.getPointCount();n<r;n++)this.insertVertex_(s,G,null,!1)}appendMultiPoint(e,i,s){if(s===void 0)return void this.appendMultiPoint_(e,i);const n=i.getAttributeStreamRef(0);let r=0;for(let c=0,h=i.getPointCount();c<h;c++){const d=n.readPoint2D(2*c);s.contains(d)&&r++}this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+r);let o=-1,a=-1,l=0;for(let c=0,h=i.getPointCount();c<h;c++){const d=n.readPoint2D(2*c);s.contains(d)?(o===-1&&(o=c,a=c),a++):o>=0&&(this.m_verticesMp.addPoints(i,o,a-o),o=-1,l++)}if(o>0&&(this.m_verticesMp.addPoints(i,o,a-o),l++),!l)return;this.m_xyStream=this.m_vertices.getAttributeStreamRef(0),this.m_vertexIndexList.setCapacity(this.m_vertexIndexList.size()+r);const u=this.insertPath(e,G);for(let c=0,h=i.getPointCount();c<h;c++){const d=n.readPoint2D(2*c);s.contains(d)&&this.insertVertex_(u,G,null,!1)}}splitSegmentForward(e,i,s,n,r){const o=this.getNextVertex(e);o===G&&ce("Edit_shape.split_segment_forward_");const a=this.getHelperPoint(),l=this.getPathFromVertex(e);let u=e;const c=this.hasSegmentParentage();for(let h=0,d=i.getResultSegmentCount(s);h<d;h++){const m=this.getVertexIndex(u),f=this.getNextVertex(u),_=i.getResultSegment(s,h);let v=null;if(_.getGeometryType()!==q.enumLine&&(v=_.clone(),v.dropAllAttributes()),h===0&&(_.queryStart(a),this.setSegmentToIndex(m,null),this.setPointEx(u,a,i.getResultSegmentStartPointRank(s,h),i.getResultSegmentStartPointWeight(s,h),r)),this.setSegmentRank(u,i.getResultSegmentInteriorRank(s,h)),this.setSegmentWeight(u,i.getResultSegmentInteriorWeight(s,h)),c){const x=i.getResultSegmentSegmentParentage(s,h),w=i.getResultSegmentStartPointIsBreak(s,h);this.setSegmentParentageAndBreak(u,x,w)}if(_.queryEnd(a),h<d-1){this.setSegmentToIndex(m,v);const x=this.insertVertex(l,f,a);this.setWeight(x,i.getResultSegmentEndPointWeight(s,h)),this.setRank(x,i.getResultSegmentEndPointRank(s,h)),this.select(x),u=x}else{this.setPointEx(o,a,i.getResultSegmentEndPointRank(s,h),i.getResultSegmentEndPointWeight(s,h),r);const x=i.getResultSegmentEndPointIsBreak(s,h);this.setSegmentParentageBreakVertex(o,x),this.setSegmentToIndex(m,v)}}}splitSegmentBackward(e,i,s,n,r){const o=this.getNextVertex(e);o===G&&ce("Edit_shape.split_segment_backward_");const a=this.getHelperPoint(),l=this.getPathFromVertex(e);let u=e;const c=this.hasSegmentParentage();for(let h=0,d=i.getResultSegmentCount(s);h<d;h++){const m=d-h-1,f=this.getVertexIndex(u),_=this.getNextVertex(u),v=i.getResultSegment(s,m);let x=null;if(v.getGeometryType()!==q.enumLine&&(x=v.clone(),x.reverse(),x.dropAllAttributes()),h===0&&(v.queryEnd(a),this.setSegmentToIndex(f,null),this.setPointEx(u,a,i.getResultSegmentEndPointRank(s,m),i.getResultSegmentEndPointWeight(s,m),r),this.setSegmentParentageAndBreak(u,i.getResultSegmentSegmentParentage(s,m),i.getResultSegmentEndPointIsBreak(s,m))),v.getGeometryType()===q.enumLine?this.setSegmentToIndex(f,null):this.setSegmentToIndex(f,x),this.setSegmentRank(u,i.getResultSegmentInteriorRank(s,m)),this.setSegmentWeight(u,i.getResultSegmentInteriorWeight(s,m)),v.queryStart(a),h<d-1){const w=this.insertVertex(l,_,a);this.setWeight(w,i.getResultSegmentStartPointWeight(s,m)),this.setRank(w,i.getResultSegmentStartPointRank(s,m)),this.select(w),u=w,c&&this.setSegmentParentageAndBreak(w,i.getResultSegmentSegmentParentage(s,m),i.getResultSegmentEndPointIsBreak(s,m))}else this.setPointEx(o,a,i.getResultSegmentStartPointRank(s,m),i.getResultSegmentStartPointWeight(s,m),r)}}selected_(e){return this.getUserIndex(e,this.m_selectionIndex)>=0}allocateIndex(e=!0){if(this.m_deletedIndices.length){const i=this.m_deletedIndices.pop();return e&&i.setRange(-1,0,i.size()),i}return e?Do(0,-1):Do(0)}recycleUserIndex(e){this.m_deletedIndices.push(e)}allocatePathIndex(){if(this.m_deletedPathIndices.length){const e=this.m_deletedPathIndices.at(-1);return this.m_deletedPathIndices.pop(),e}return Do(0)}recyclePathUserIndex(e){this.m_deletedPathIndices.push(e)}peelALoop_(e,i,s){const n=this.getNextVertex(e),r=this.getNextVertex(i),o=this.getVertexIndex(e),a=this.getVertexIndex(i);if(this.setNextVertex(e,r),this.setPrevVertex(r,e),this.setNextVertex(i,n),this.setPrevVertex(n,i),this.m_segments){const l=this.getSegmentFromIndex(o),u=this.getSegmentFromIndex(a);this.setSegmentToIndex(a,null),this.setSegmentToIndex(o,u),this.setSegmentToIndex(a,l)}if(this.hasSegmentParentage()){let l=this.getSegmentParentage(i),u=this.getSegmentParentage(e);l===-1&&u===-1||(u=Ge(l,l=u),this.setSegmentParentageAndBreak(e,u),this.setSegmentParentageAndBreak(i,l))}if(s){const l=this.getPathFromVertex(e),u=this.getGeometryFromPath(l),c=[!1],h=this.insertClosedPath(u,G,n,this.getFirstVertex(l),c);c[0]&&this.setFirstVertex(l,r);let d=this.getPathSize(l);return d-=this.getPathSize(h),this.setPathSize(l,d),h}return G}sortVerticesSimpleByYHelper(e,i,s){e.sort(i,s,(n,r)=>{let o=this.compareVerticesSimpleY(n,r);if(o===0){const a=this.getPathInternalIndexFromVertex(n),l=this.getPathInternalIndexFromVertex(r);o=a<l?-1:a>l?1:0}return o})}sortVerticesSimpleByYHelper3D(e,i,s){z(0)}constructor(){this.m_verticesMp=null,this.m_vertices=null,this.m_xyStream=null,this.m_vertexDescription=null,this.m_segments=null,this.m_weights=null,this.m_ranks=null,this.m_segmentWeights=null,this.m_segmentRanks=null,this.m_indices=[],this.m_deletedIndices=[],this.m_pathAreas=[],this.m_pathLengths=[],this.m_pathindices=[],this.m_deletedPathIndices=[],this.m_geometryIndices=[],this.m_selectedVertices=[],this.m_helperPoint=null,this.m_forceSetEnvelope=Sd.constructEmpty(),this.m_hasForceSetEnvelope=0,this.m_workPoint2D=N.getNAN(),this.m_workPoint2_2D=N.getNAN(),this.m_curveStitcher=null,this.m_pathCount=0,this.m_pointCount=0,this.m_firstGeometry=G,this.m_lastGeometry=G,this.m_vertexIndexList=new xs(5),this.m_pathIndexList=new xs(8),this.m_geometryIndexList=new xs(8),this.m_bHasAttributes=!1,this.m_selectedCount=0,this.m_selectionIndex=-1,this.m_selection=!1,this.m_bucketSort=new Uy,this.m_segmentParentageIndex=-1}getTotalPointCount(){return this.m_pointCount}getEnvelope2D(e){if(this.m_hasForceSetEnvelope!==0)return new J(this.m_forceSetEnvelope.xmin,this.m_forceSetEnvelope.ymin,this.m_forceSetEnvelope.xmax,this.m_forceSetEnvelope.ymax);const i=this.hasCurves(),s=J.constructEmpty(),n=this.queryVertexIterator();let r=!0;for(let o=n.next();o!==G;o=n.next()){if(r?s.merge(this.getXY(o)):s.mergeNe(this.getXY(o)),i){const a=this.getSegment(o);if(a!==null){const l=J.constructEmpty();a.queryLooseEnvelope(l),s.mergeEnvelope2D(l)}}r=!1}return s}getEnvelope3D(e){return z(0),Sd.constructEmpty()}forceSetEnvelope2D(e){this.m_hasForceSetEnvelope=1,this.m_forceSetEnvelope.setCoords(e.xmin,e.ymin,0,e.xmax,e.ymax,0)}forceSetEnvelope3D(e){z(0)}forgetForceSetEnvelope(){this.m_hasForceSetEnvelope=0}getGeometryCount(){return this.m_geometryIndexList.size()}addGeometry(e,i){const s=e.getGeometryType();if(Ei(s))return this.addMultiPath(e,i);if(s===q.enumMultiPoint)return this.addMultiPoint(e,i);if(s===q.enumPoint)return this.addPoint_(e,i);if(s===q.enumEnvelope){const n=new Ci;return n.addEnvelope(e,!1),this.addMultiPath(n,i)}ce("")}appendGeometry(e,i){this.mergeVertexDescription(i.getDescription());const s=i.getGeometryType();Ei(s)?this.appendMultiPath(e,i):s!==q.enumMultiPoint?ce(""):this.appendMultiPoint(e,i)}assignRankToGeometryVertices(e,i){i<Tn&&(i=Tn);const s=this.queryVertexIterator();for(let n=s.next();n!==G;n=s.next())this.setRank(n,i),this.setSegmentRank(n,i)}collapseAllGeometriesToFirst(){this.collapseGeometriesToFirst(q.enumUnknown)}collapseGeometriesToFirst(e){this.dbgVerifyVertexCounts();let i=G,s=-1,n=-1;for(let r=this.getFirstGeometry();r!==G;)if(e!==q.enumUnknown&&this.getGeometryType(r)!==e)r=this.getNextGeometry(r);else{if(i===G){i=r,s=this.getPathCount(i),n=this.getPointCount(i),r=this.getNextGeometry(r);continue}for(let u=this.getFirstPath(r);u!==G;u=this.getNextPath(u))this.setPathGeometry(u,i);s+=this.getPathCount(r),n+=this.getPointCount(r);const o=this.getLastPath(i),a=this.getFirstPath(r);o!==G?this.setNextPath(o,a):this.setFirstPath(i,a),a!==G&&(this.setPrevPath(a,o),this.setLastPath(i,this.getLastPath(r))),this.setFirstPath(r,G),this.setLastPath(r,G);const l=r;r=this.getNextGeometry(r),this.setGeometryVertexCount(l,0),this.removeGeometry(l)}return i!==G&&(this.setGeometryVertexCount(i,n),this.setGeometryPathCount(i,s),this.dbgVerifyVertexCounts()),i}setFillRule(e,i){let s=this.m_geometryIndexList.getField(e,2);s&=-134217729,s|=i===1?134217728:0,this.m_geometryIndexList.setField(e,2,s)}getFillRule(e){return 134217728&this.m_geometryIndexList.getField(e,2)?1:0}setGeometryModified(e,i){let s=this.m_geometryIndexList.getField(e,2);!!(67108864&s)!==i&&(s&=-67108865,s|=i?67108864:0,this.m_geometryIndexList.setField(e,2,s))}getGeometryModified(e){return!!(67108864&this.m_geometryIndexList.getField(e,2))}setGeometryModifiedWithVertex(e,i){const s=this.getPathFromVertex(e),n=this.getGeometryFromPath(s);this.setGeometryModified(n,i)}getGeometryModifiedWithVertex(e){const i=this.getPathFromVertex(e),s=this.getGeometryFromPath(i);return this.getGeometryModified(s)}swapGeometry(e,i){const s=this.getFirstPath(e),n=this.getFirstPath(i),r=this.getLastPath(e),o=this.getLastPath(i);for(let m=this.getFirstPath(e);m!==G;m=this.getNextPath(m))this.setPathGeometry(m,i);for(let m=this.getFirstPath(i);m!==G;m=this.getNextPath(m))this.setPathGeometry(m,e);this.setFirstPath(e,n),this.setFirstPath(i,s),this.setLastPath(e,o),this.setLastPath(i,r);const a=this.getPointCount(e),l=this.getPathCount(e),u=this.getPointCount(i),c=this.getPathCount(i);this.setGeometryVertexCount(e,u),this.setGeometryVertexCount(i,a),this.setGeometryPathCount(e,c),this.setGeometryPathCount(i,l);const h=this.m_geometryIndexList.getField(e,2),d=this.m_geometryIndexList.getField(i,2);this.m_geometryIndexList.setField(e,2,d),this.m_geometryIndexList.setField(i,2,h)}addPathFromMultiPath(e,i,s){const n=this.createGeometry(s?q.enumPolygon:q.enumPolyline,e.getDescription()),r=e.getImpl();if(e.getPathSize(i)<2)return n;this.m_vertices.reserveRounded(this.m_vertices.getPointCount()+e.getPathSize(i)),this.m_verticesMp.addPoints(e,e.getPathStart(i),r.getPathEnd(i)),this.m_xyStream=this.m_vertices.getAttributeStreamRef(0);const o=this.insertPath(n,G);this.setClosedPath(o,r.isClosedPath(i)||s);const a=this.m_segments!==null||r.getSegmentFlagsStreamRef()!==null;for(let l=r.getPathStart(i),u=r.getPathEnd(i);l<u;l++){const c=this.insertVertex_(o,G,null,!1);if(a){const h=this.getVertexIndex(c);if(1&r.getSegmentFlags(l))this.setSegmentToIndex(h,null);else{const d=new ii;r.querySegment(l,d,!0),this.setSegmentToIndex(h,d.releaseSegment())}}}return r.isStrongPathStart(i)&&this.setStrongPathStart(o,!0),r.isStrongPathEnd(i)&&this.setStrongPathEnd(o,!0),n}getGeometry(e){const i=this.getGeometryType(e),s=HFe(i,this.m_verticesMp.getDescription()),n=this.getPointCount(e);if(n===0)return s;if(Ei(i)){const r=s.getImpl(),o=this.getPathCount(e),a=Do(o+1),l=_m(o+1,0),u=s.getDescription(),c=this.hasCurves();for(let h=0,d=u.getAttributeCount();h<d;h++){const m=u.getSemantics(h),f=mee.getComponentCount(m),_=R7(m,n),v=this.m_vertices.getAttributeStreamRef(m);let x=0,w=0,T=0;for(let C=this.getFirstPath(e);C!==G;C=this.getNextPath(C)){let M=0;this.isClosedPath(C)&&(M|=1),this.isExterior(C)&&(M|=8),this.isStrongPathStart(C)&&(M|=2),this.isStrongPathEnd(C)&&(M|=4),M&&l.setBits(w,M);const A=this.getPathSize(C);if(a.write(w++,T),T+=A,m===0){const I=v,L=_;let D;for(let O=this.getFirstVertex(C);x<T;O=this.getNextVertex(O),x++){const U=this.getVertexIndex(O);D=I.readPoint2D(2*U),L.writePoint2D(2*x,D)}}else for(let I=this.getFirstVertex(C);x<T;I=this.getNextVertex(I),x++){const L=this.getVertexIndex(I);for(let D=0;D<f;D++){const O=v.readAsDbl(L*f+D);_.writeAsDbl(x*f+D,O)}}}r.setAttributeStreamRef(m,_),a.write(o,n)}if(r.setPathFlagsStreamRef(l),r.setPathStreamRef(a),r.notifyModifiedFlags(65535),c){let h=0,d=0;for(let m=this.getFirstPath(e);m!==G;m=this.getNextPath(m)){h+=this.getPathSize(m);for(let f=this.getFirstVertex(m);d<h;f=this.getNextVertex(f)){const _=this.getSegment(f);_!==null&&_.isCurve()&&r.replaceSegment(d,_,!0),d++}}}}else if(i===q.enumMultiPoint){const r=s.getImpl(),o=s.getDescription();r.reserve(n),r.resizeNoInit(n);for(let a=0,l=o.getAttributeCount();a<l;a++){const u=o.getSemantics(a),c=mee.getComponentCount(u),h=r.getAttributeStreamRef(u),d=this.m_vertices.getAttributeStreamRef(u);let m=0;const f=this.getFirstPath(e),_=this.getPathSize(f);for(let v=this.getFirstVertex(f);m<_;v=this.getNextVertex(v),m++){const x=this.getVertexIndex(v);for(let w=0;w<c;w++){const T=d.readAsDbl(x*c+w);h.writeAsDbl(m*c+w,T)}}r.setAttributeStreamRef(u,h)}r.notifyModifiedFlags(65535)}else We("getGeometry");return s}queryPointGeometryOnly(e,i){this.getGeometryType(e)!==q.enumMultiPoint&&ce("get_point_geometry_only");const s=this.getPointCount(e);if(s>1&&ce("get_point_geometry_only"),s===0)return i.assignVertexDescription(this.m_vertexDescription),void i.setEmpty();const n=this.getFirstPath(e),r=this.getFirstVertex(n);this.queryPoint(r,i)}removeGeometry(e){for(let n=this.getFirstPath(e);n!==G;n=this.removePath(n));const i=this.getPrevGeometry(e),s=this.getNextGeometry(e);return i!==G?this.setNextGeometry(i,s):this.m_firstGeometry=s,s!==G?this.setPrevGeometry(s,i):this.m_lastGeometry=i,this.freeGeometry(e),s}createGeometry(e,i){i===void 0&&(i=go());const s=this.newGeometry(e);return this.m_vertices||(this.m_verticesMp=new Dn({vd:i}),this.m_vertices=this.m_verticesMp.getImpl()),this.mergeVertexDescription(i),this.m_firstGeometry===G?(this.m_firstGeometry=s,this.m_lastGeometry=s):(this.setPrevGeometry(s,this.m_lastGeometry),this.setNextGeometry(this.m_lastGeometry,s),this.m_lastGeometry=s),s}getFirstGeometry(){return this.m_firstGeometry}getLastGeometry(){return this.m_lastGeometry}getNextGeometry(e){return this.m_geometryIndexList.getField(e,1)}getPrevGeometry(e){return this.m_geometryIndexList.getField(e,0)}getGeometryType(e){return 16777215&this.m_geometryIndexList.getField(e,2)}setGeometryUserIndex(e,i,s){const n=this.m_geometryIndices[i],r=this.getGeometryIndex(e);r>=n.size()&&n.resize(Math.max(1.25*r,16),-1),n.write(r,s)}getGeometryUserIndex(e,i){const s=this.getGeometryIndex(e),n=this.m_geometryIndices[i];return s<n.size()?n.read(s):-1}createGeometryUserIndex(){for(let i=0;i<this.m_geometryIndices.length;i++)if(this.m_geometryIndices[i]===null)return this.m_geometryIndices[i]=Do(0),i;this.m_geometryIndices.push(Do(0));const e=this.m_geometryIndices.length-1;return z(e>=0&&e<=Number.MAX_SAFE_INTEGER),e}removeGeometryUserIndex(e){for(this.m_geometryIndices[e]=null;this.m_geometryIndices.length>0&&this.m_geometryIndices.at(-1)===null;)this.m_geometryIndices.pop()}getFirstPath(e){return this.m_geometryIndexList.getField(e,3)}getLastPath(e){return this.m_geometryIndexList.getField(e,4)}hasPointFeatures(){for(let e=this.getFirstGeometry();e!==G;e=this.getNextGeometry(e))if(!Ei(this.getGeometryType(e)))return!0;return!1}getPointCount(e){return this.m_geometryIndexList.getField(e,5)}getPathCount(e){return this.m_geometryIndexList.getField(e,6)}filterClosePoints(e,i,s,n,r){const o=e*e;let a=0;const l=this.hasCurves(),u=this.hasSegmentParentage();for(let c=r===G?this.getFirstGeometry():r;c!==G;c=r===G?this.getNextGeometry(c):G){const h=this.getGeometryType(c);if(!Ei(h)||s&&h!==q.enumPolygon)continue;const d=this.getGeometryType(c)===q.enumPolygon;let m=this.getGeometryModified(c);for(let f=this.getFirstPath(c);f!==G;){let _=0;for(let T=this.getFirstVertex(f);_<Math.trunc(this.getPathSize(f)/2);){const C=this.getNextVertex(T);if(C===G)break;const M=this.getXY(T),A=this.getXY(C);let I=N.sqrDistance(M,A),L=!0;do if(I<=o){if(l){const D=this.getSegment(T);if(D!==null){const O=D.calculateLength2D();if(I=O*O,I>o)break}}if(I===0?a===0&&(a=-1):a=1,C!==this.getLastVertex(f)){const D=u&&(this.getSegmentParentageBreakVertex(T)||this.getSegmentParentageBreakVertex(C));if(this.transferAllDataToTheVertex(C,T),this.removeVertex(C,!1),n&&!m&&(this.setGeometryModified(c,!0),m=!0),u&&T!==C){this.setSegmentParentageBreakVertex(T,D);const O=this.getNextVertex(T);z(O!==G),this.isDiscontinuousSegmentParentage(O)&&this.setSegmentParentageBreakVertex(O,!0)}}L=!1}while(!1);L&&(T=this.getNextVertex(T)),_++}let v=this.getFirstVertex(f);for(let T=this.isClosedPath(f)?v:this.getLastVertex(f);this.getPathSize(f)>0;){const C=this.getPrevVertex(T);if(C===G)break;{const M=this.getXY(C),A=this.getXY(T);let I=N.sqrDistance(M,A),L=!0;do if(I<=o){if(l){const O=this.getSegment(C);if(O!==null){const U=O.calculateLength2D();if(I=U*U,I>o)break}}I===0?a===0&&(a=-1):a=1;const D=u&&(this.getSegmentParentageBreakVertex(T)||this.getSegmentParentageBreakVertex(C));this.removeVertex(C,!0),n&&!m&&(this.setGeometryModified(c,!0),m=!0),u&&C!==T&&(D||this.isDiscontinuousSegmentParentage(T))&&this.setSegmentParentageBreakVertex(T,!0),v===C&&(v=this.getFirstVertex(f)),L=!1}while(!1);if(L&&(T=this.getPrevVertex(T),T===v))break}}const x=this.getPathSize(f);let w=i&&x<(d?3:2);w&&d&&x===2&&l&&(w=!this.pathHasCurves(f)),w?(f=this.removePath(f),a===0&&(a=-1),n&&!m&&(this.setGeometryModified(c,!0),m=!0)):f=this.getNextPath(f)}}return a}filterClosePoints3D(e,i,s,n,r,o){return z(0),0}hasDegenerateSegments(e){for(let i=this.getFirstGeometry();i!==G;i=this.getNextGeometry(i))if(Ei(this.getGeometryType(i)))for(let s=this.getFirstPath(i);s!==G;){const n=this.getPathSize(s);if(n===0)return!0;let r=this.getFirstVertex(s);for(let o=0;o<n;o++){const a=this.getNextVertex(r);if(a===G)break;const l=this.getVertexIndex(r),u=this.getSegmentFromIndex(l);let c=0;if(u!==null){if(c=u.calculateLowerLength2D(),c<=e&&(c=u.calculateUpperLength2D(),c<=e||(c=u.calculateLength2D(),c<=e)))return!0}else{const h=this.getVertexIndex(a);if(c=this.m_vertices.getShortestDistance(l,h),c<=e)return!0}r=a}s=this.getNextPath(s)}return!1}hasDegenerateSegments3D(e,i){return z(0),!1}transferAllDataToTheVertex(e,i){const s=this.getVertexIndex(e),n=this.getVertexIndex(i);if(this.m_weights){const o=this.getWeightWithIndex(s);this.setWeightWithIndex(n,o)}if(this.m_ranks){const o=this.getRankWithIndex(s);this.setRankWithIndex(n,o)}if(this.m_segmentWeights){const o=this.getSegmentWeightWithIndex(s);this.setSegmentWeightWithIndex(n,o)}if(this.m_segmentRanks){const o=this.getSegmentRankWithIndex(s);this.setSegmentRankWithIndex(n,o)}for(let o=0,a=this.m_indices.length;o<a;o++)if(o!==this.m_selectionIndex&&this.m_indices[o]!==null){const l=this.getUserIndex(e,o);l!==-1&&this.setUserIndex(i,o,l)}const r=this.selected(e);r!==this.selected(i)&&(r?this.select(i):this.unselect(i))}splitSegmentAxisAware(e,i,s,n,r){let o=0;const a=this.getNextVertex(e);a===G&&ce("");const l=this.getVertexIndex(e),u=this.getVertexIndex(a),c=this.getSegmentFromIndex(l);let h=this.m_vertices.getShortestDistance(l,u);const d=this.getPathFromVertex(e),m=this.m_bHasAttributes;m&&c&&(h=c.calculateLength2D());const f=this.getSegmentParentage(e),_=this.getHelperPoint();if(c){let v=0,x=0,w=G;for(let T=0;T<s;T++){const C=i[T];if(v<C&&C<1){const M=c.cut(v,C);if(n!==null&&(T>0&&M.setStartXY(n[T-1]),M.setEndXY(n[T]),M.normalizeAfterEndpointChange(),x=T),m){const L=h>0?c.calculateSubLengthFromStart(C)/h:0;this.m_vertices.interpolateTwoVertices(l,u,L,_)}_.setXY(M.getEndXY()),w=this.insertVertex(d,a,_),o++;const A=this.getPrevVertex(w),I=this.getVertexIndex(A);this.setSegmentToIndex(I,M),f!==-1&&this.setSegmentParentageAndBreak(w,f,!1),v=C}}if(w!==G){const T=c.cut(v,1);n!==null&&(T.setStartXY(n[x]),T.normalizeAfterEndpointChange());const C=this.getVertexIndex(w);this.setSegmentToIndex(C,T)}}else{let v=0;for(let x=0;x<s;x++){const w=i[x];if(v<w&&w<1){this.m_vertices.interpolateTwoVertices(l,u,w,_);const T=this.insertVertex(d,a,_);o++,f!==-1&&this.setSegmentParentageAndBreak(T,f,!1)}v=w}}return o}splitSegment(e,i,s,n=null){return this.splitSegmentAxisAware(e,i,s,n,-1)}snapControlPoints(e,i,s){this.getNextVertex(e)===G&&ce("");let n=e,r=!1;for(let o=0;o<i;++o){const a=this.getVertexIndex(n),l=this.getSegmentFromIndex(a);if(l){const u=l.snapControlPoints(s);r||(r=u)}n=this.getNextVertex(n)}return r}snapControlPointsOnSelection(e){if(!this.hasCurves())return!1;let i=0;const s=this.queryVertexIteratorOnSelection();for(let n=s.next();n!==G;n=s.next()){const r=this.getVertexIndex(n),o=this.getSegmentFromIndex(r);o&&(i|=o.snapControlPoints(e)?1:0)}return i!==0}calculateSubLength2D(e,i,s){return z(0),0}setPoint(e,i,s){if(this.setPointOnly(e,i),this.m_segments!==null){const n=this.getVertexIndex(e),r=this.getSegmentFromIndex(n);r!==null&&(r.setStartXY(i.getXY()),r.normalizeAfterEndpointChange(),s&&r.ensureXYMonotone());const o=this.getPrevVertex(e);if(o!==G){const a=this.getVertexIndex(o),l=this.getSegmentFromIndex(a);l!==null&&(l.setEndXY(i.getXY()),l.normalizeAfterEndpointChange(),s&&l.ensureXYMonotone())}}}setPointEx(e,i,s,n,r){this.setPoint(e,i,r);const o=this.getVertexIndex(e);this.setWeightWithIndex(o,n),this.setRankWithIndex(o,s)}setPointOnly(e,i){const s=this.getVertexIndex(e);this.m_vertices.setPointByVal(s,i)}setPointOnlyEx(e,i,s,n){z(0)}queryPoint(e,i){const s=this.getVertexIndex(e);this.m_vertices.getPointByVal(s,i)}setXY(e,i){this.setXYCoords(e,i.x,i.y)}setXYCoords(e,i,s){var r;const n=this.getVertexIndex(e);if((r=this.m_vertices)==null||r.setXYCoords(n,i,s),this.m_segments!==null){const o=this.getSegmentFromIndex(n);o!==null&&(o.setStartXYCoords(i,s),o.normalizeAfterEndpointChange());const a=this.getPrevVertex(e);if(a!==G){const l=this.getVertexIndex(a),u=this.getSegmentFromIndex(l);u!=null&&(u.setEndXYCoords(i,s),u.normalizeAfterEndpointChange())}}}setXYMonotonic(e,i,s){const n=this.getVertexIndex(e);if(this.m_vertices.setXYCoords(n,i,s),this.m_segments!==null){const r=this.getSegmentFromIndex(n);if(r!==null){const a=r.getEndXY();r.setCoordsForIntersector(new N(i,s),a,!1),r.ensureXYMonotone()}const o=this.getPrevVertex(e);if(o!==G){const a=this.getVertexIndex(o),l=this.getSegmentFromIndex(a);if(l!==null){const u=l.getStartXY();l.setCoordsForIntersector(u,new N(i,s),!1),l.ensureXYMonotone()}}}}setXYMonotonicPoint2D(e,i){this.setXYMonotonic(e,i.x,i.y)}queryXY(e,i){const s=this.getVertexIndex(e);return this.m_vertices.queryXY(s,i)}getXY(e){const i=this.getVertexIndex(e);return this.m_vertices.getXY(i)}getXYWithIndex(e){return this.m_xyStream.readPoint2D(2*e)}static setSegDefault(e,i,s){z(0)}setXYZ(e,i,s){z(0)}setXYZCoords(e,i,s,n){z(0)}queryXYZ(e,i){z(0)}getXYZ(e){return z(0),gi.getNAN()}getXYZWithIndex(e){return z(0),gi.getNAN()}mergeVertexDescription(e){this.m_verticesMp.mergeVertexDescription(e),this.m_vertexDescription=this.m_verticesMp.getDescription(),this.m_bHasAttributes=this.m_vertexDescription.getAttributeCount()>1}addAttribute(e){z(0)}getAttributeAsDbl(e,i,s){return this.m_vertices.getAttributeAsDbl(e,this.getVertexIndex(i),s)}queryAttributeAsDbl(e,i,s,n){z(0)}setAttribute(e,i,s,n){z(0)}setAttributeInt(e,i,s,n){z(0)}getVertexDescription(){return this.m_vertexDescription}getMinPathVertexY(e){return z(0),0}getVertexIndex(e){return this.m_vertexIndexList.getField(e,0)}getY(e){const i=this.getVertexIndex(e);return this.m_vertices.queryXY(i,this.m_workPoint2D),this.m_workPoint2D.y}getX(e){return this.getXY(e).x}isEqualXY(e,i){return this.queryXY(e,this.m_workPoint2D),this.queryXY(i,this.m_workPoint2_2D),this.m_workPoint2D.isEqualPoint2D(this.m_workPoint2_2D)}isEqualXYPoint2D(e,i){return this.queryXY(e,this.m_workPoint2D),this.m_workPoint2D.isEqualPoint2D(i)}isEqualXYZPoint3D(e,i){return z(0),!1}setWeight(e,i){i<1&&(i=1);const s=i===1;if(this.m_weights==null){if(s)return;this.m_weights=Nl(this.m_vertices.getPointCount(),1)}const n=this.getVertexIndex(e);if(n>=this.m_weights.size()){if(s)return;this.m_weights.resize(n+1,1)}this.m_weights.write(n,i)}setWeightWithIndex(e,i){i<1&&(i=1);const s=i===1;if(this.m_weights===null){if(s)return;this.m_weights=Nl(this.m_vertices.getPointCount(),1)}if(e>=this.m_weights.size()){if(s)return;this.m_weights.resize(e+1,1)}this.m_weights.write(e,i)}getWeight(e){if(this.m_weights===null)return 1;const i=this.getVertexIndex(e);return i>=this.m_weights.size()?1:this.m_weights.read(i)}getWeightWithIndex(e){return this.m_weights===null||e>=this.m_weights.size()?1:this.m_weights.read(e)}getRank(e){if(this.m_ranks===null)return Tn;const i=this.getVertexIndex(e);return i>=this.m_ranks.size()?Tn:this.m_ranks.read(i)}getRankWithIndex(e){return this.m_ranks===null||e>=this.m_ranks.size()?Tn:this.m_ranks.read(e)}setRank(e,i){i<Tn&&(i=Tn);const s=i===Tn;if(this.m_ranks===null){if(s)return;this.m_ranks=Do(this.m_vertices.getPointCount(),Tn)}const n=this.getVertexIndex(e);if(n>=this.m_ranks.size()){if(s)return;this.m_ranks.resize(n+1,Tn)}this.m_ranks.write(n,i)}setRankWithIndex(e,i){i<Tn&&(i=Tn);const s=i===Tn;if(this.m_ranks===null){if(s)return;this.m_ranks=Do(this.m_vertices.getPointCount(),Tn)}if(e>=this.m_ranks.size()){if(s)return;this.m_ranks.resize(e+1,Tn)}this.m_ranks.write(e,i)}setSegmentWeight(e,i){i<1&&(i=1);const s=i===1;if(this.m_segmentWeights===null){if(s)return;this.m_segmentWeights=Nl(this.m_vertices.getPointCount(),1)}const n=this.getVertexIndex(e);if(n>=this.m_segmentWeights.size()){if(s)return;this.m_segmentWeights.resize(n+1,1)}this.m_segmentWeights.write(n,i)}setSegmentWeightWithIndex(e,i){i<1&&(i=1);const s=i===1;if(this.m_segmentWeights==null){if(s)return;this.m_segmentWeights=Nl(this.m_vertices.getPointCount(),1)}if(e>=this.m_segmentWeights.size()){if(s)return;this.m_segmentWeights.resize(e+1,1)}this.m_segmentWeights.write(e,i)}getSegmentWeight(e){if(this.m_segmentWeights===null)return 1;const i=this.getVertexIndex(e);return i>=this.m_segmentWeights.size()?1:this.m_segmentWeights.read(i)}getSegmentWeightWithIndex(e){return this.m_segmentWeights==null||e>=this.m_segmentWeights.size()?1:this.m_segmentWeights.read(e)}getSegmentRank(e){if(this.m_segmentRanks===null)return dB.st_defaultRank;const i=this.getVertexIndex(e);return i>=this.m_segmentRanks.size()?dB.st_defaultRank:this.m_segmentRanks.read(i)}getSegmentRankWithIndex(e){return this.m_segmentRanks===null||e>=this.m_segmentRanks.size()?Tn:this.m_segmentRanks.read(e)}setSegmentRank(e,i){i<Tn&&(i=Tn);const s=i===Tn;if(this.m_segmentRanks===null){if(s)return;this.m_segmentRanks=Do(this.m_vertices.getPointCount(),Tn)}const n=this.getVertexIndex(e);if(n>=this.m_segmentRanks.size()){if(s)return;this.m_segmentRanks.resize(n+1,Tn)}this.m_segmentRanks.write(n,i)}setSegmentRankWithIndex(e,i){i<Tn&&(i=Tn);const s=i===Tn;if(this.m_segmentRanks===null){if(s)return;this.m_segmentRanks=Do(this.m_vertices.getPointCount(),Tn)}if(e>=this.m_segmentRanks.size()){if(s)return;this.m_segmentRanks.resize(e+1,Tn)}this.m_segmentRanks.write(e,i)}removeWeights(){this.m_weights=null,this.m_segmentWeights=null}removeRanks(){this.m_ranks=null,this.m_segmentRanks=null}setUserIndex(e,i,s){const n=this.m_indices[i],r=this.getVertexIndex(e);if(n.size()<=r){if(s===-1)return;n.resize(this.m_vertices.getPointCount(),-1)}n.write(r,s)}getUserIndex(e,i){const s=this.getVertexIndex(e),n=this.m_indices[i];return s<n.size()?n.read(s):-1}addToUserIndex(e,i,s){const n=this.m_indices[i],r=this.getVertexIndex(e);n.size()<=r&&n.resize(this.m_vertices.getPointCount(),-1);const o=n.read(r);n.write(r,o+s)}createUserIndex(){for(let i=0;i<this.m_indices.length;i++)if(this.m_indices[i]===null)return this.m_indices[i]=this.allocateIndex(),i;this.m_indices.push(this.allocateIndex());const e=this.m_indices.length-1;return z(e>=0&&e<=fo()),e}createUserIndexUninitialized(){for(let i=0;i<this.m_indices.length;i++)if(this.m_indices[i]===null)return this.m_indices[i]=this.allocateIndex(!1),i;this.m_indices.push(this.allocateIndex(!1));const e=this.m_indices.length-1;return z(e>=0&&e<=Number.MAX_SAFE_INTEGER),e}fillUserIndexForGeometry(e,i,s){const n=this.m_indices[i],r=n.size();for(let o=this.getFirstPath(e);o!==G;o=this.getNextPath(o)){let a=this.getFirstVertex(o);for(let l=0,u=this.getPathSize(o);l<u;l++,a=this.getNextVertex(a)){const c=this.getVertexIndex(a);c<r&&n.write(c,s)}}}fillUserIndexForSelection(e,i){z(0)}removeUserIndex(e){for(this.recycleUserIndex(this.m_indices[e]),this.m_indices[e]=null;this.m_indices.length>0&&this.m_indices[this.m_indices.length-1]===null;)this.m_indices.pop()}replaceCurveWithLine(e){if(this.m_segments!==null){const i=this.getVertexIndex(e);this.setSegmentToIndex(i,null)}}queryLineConnector(e,i,s=!1){const n=this.getNextVertex(e);if(n===G)return!1;if(!this.m_bHasAttributes||s){const r=this.getXY(e);i.setStartXY(r);const o=this.getXY(n);i.setEndXY(o)}else{const r=new Jt({vd:this.getVertexDescription()});this.queryPoint(e,r),i.setStart(r),this.queryPoint(n,r),i.setEnd(r)}return!0}queryLineConnector3D(e,i,s=!1){return z(0),!1}hasCurves(){return this.m_segments!==null}geometryHasCurves(e){return z(0),!1}pathHasCurves(e){if(!this.hasCurves())return!1;const i=this.getFirstVertex(e);if(i===G)return!1;const s=this.getPathSize(e);let n=i;for(let r=0;r<s;r++,n=this.getNextVertex(n)){const o=this.getSegment(n);if(o!==null&&o.getGeometryType()!==q.enumLine)return!0}return!1}insertPath(e,i){let s=G;i!==G?(e!==this.getGeometryFromPath(i)&&ce(""),s=this.getPrevPath(i)):s=this.getLastPath(e);const n=this.newPath(e);return i!==G&&this.setPrevPath(i,n),this.setNextPath(n,i),this.setPrevPath(n,s),s!==G?this.setNextPath(s,n):this.setFirstPath(e,n),i===G&&this.setLastPath(e,n),this.setGeometryPathCount(e,this.getPathCount(e)+1),n}removePath(e){const i=this.getPrevPath(e),s=this.getNextPath(e),n=this.getGeometryFromPath(e);return i!==G?this.setNextPath(i,s):this.setFirstPath(n,s),s!==G?this.setPrevPath(s,i):this.setLastPath(n,i),this.clearPath(e),this.setGeometryPathCount(n,this.getPathCount(n)-1),this.freePath(e),s}clearPath(e){const i=this.getFirstVertex(e);if(i!==G){let s=i;for(let r=0,o=this.getPathSize(e);r<o;r++){const a=s;s=this.getNextVertex(s),this.freeVertex(a)}const n=this.getGeometryFromPath(e);this.setGeometryVertexCount(n,this.getPointCount(n)-this.getPathSize(e))}this.setPathSize(e,0)}getNextPath(e){return this.m_pathIndexList.getField(e,2)}getPrevPath(e){return this.m_pathIndexList.getField(e,1)}getPathSize(e){return this.m_pathIndexList.getField(e,3)}isClosedPath(e){return!!(1&this.getPathFlags(e))}setClosedPath(e,i){if(this.isClosedPath(e)===i)return;if(this.getPathSize(e)>0){const n=this.getFirstVertex(e),r=this.getLastVertex(e);if(i){this.setNextVertex(r,n),this.setPrevVertex(n,r);const o=this.getVertexIndex(r);this.setSegmentToIndex(o,null)}else{this.setNextVertex(r,G),this.setPrevVertex(n,G);const o=this.getVertexIndex(r);this.setSegmentToIndex(o,null)}}const s=(1|this.getPathFlags(e))-1;this.setPathFlags(e,s|(i?1:0))}closeAllPaths(e){z(0)}isStrongPathStart(e){return!!(8&this.getPathFlags(e))}isStrongPathEnd(e){return!!(16&this.getPathFlags(e))}setStrongPathStart(e,i){const s=(8|this.getPathFlags(e))-8;this.setPathFlags(e,s|(i?8:0))}setStrongPathEnd(e,i){const s=(16|this.getPathFlags(e))-16;this.setPathFlags(e,s|(i?16:0))}getGeometryFromPath(e){return this.m_pathIndexList.getField(e,7)}isExterior(e){return!!(2&this.getPathFlags(e))}setExterior(e,i){const s=(2|this.getPathFlags(e))-2;this.setPathFlags(e,s|(i?2:0))}getRingArea(e){if(this.isRingAreaValid(e))return this.m_pathAreas[this.getPathIndex(e)];const i=this.getFirstVertex(e);if(i===G)return 0;const s=this.getXY(i),n=new Wr(0),r=this.getPathSize(e);if(r>2){const a=s.clone(),l=a.x,u=a.y;let c=this.getNextVertex(i);const h=this.getXY(c);c=this.getNextVertex(c);const d=N.getNAN();for(let m=2;m<r;m++,c=this.getNextVertex(c))this.queryXY(c,d),n.pe((d.x-a.x)*(h.y-u)),a.setCoordsPoint2D(h),h.setCoordsPoint2D(d);n.pe((l-a.x)*(h.y-u))}if(this.hasCurves()){let a=i;for(let l=0;l<r;l++,a=this.getNextVertex(a)){const u=this.getSegment(a);if(u===null||u.getGeometryType()===q.enumLine)continue;const c=2*u.calculateArea2DHelper();n.pe(c)}}this.setRingAreaValid(e,!0);const o=.5*n.getResult();return this.m_pathAreas[this.getPathIndex(e)]=o,o}getPathIndexInternal(e){return this.getPathIndex(e)}getPathInternalIndexFromVertex(e){return this.getPathIndex(this.getPathFromVertex(e))}setPathUserIndex(e,i,s){const n=this.m_pathindices[i],r=this.getPathIndex(e);n.size()<this.m_pathAreas.length&&n.resize(this.m_pathAreas.length,-1),n.write(r,s)}getPathUserIndex(e,i){const s=this.getPathIndex(e),n=this.m_pathindices[i];return s<n.size()?n.read(s):-1}createPathUserIndex(){for(let i=0;i<this.m_pathindices.length;i++)if(this.m_pathindices[i]===null)return this.m_pathindices[i]=this.allocatePathIndex(),i;this.m_pathindices.push(this.allocatePathIndex());const e=this.m_pathindices.length-1;return z(e>=0&&e<=Number.MAX_SAFE_INTEGER),e}fillPathUserIndexForGeometry(e,i,s){const n=this.m_pathindices[i],r=n.size();for(let o=this.getFirstPath(e);o!==G;o=this.getNextPath(o)){const a=this.getPathIndex(o);a<r&&n.write(a,s)}}removePathUserIndex(e){for(this.recyclePathUserIndex(this.m_pathindices[e]),this.m_pathindices[e]=null;this.m_pathindices.length>0&&this.m_pathindices.at(-1)===null;)this.m_pathindices.pop()}movePath(e,i,s){if(s===G&&ce(""),i===s)return;const n=this.getNextPath(s);let r=this.getPrevPath(s);const o=this.getGeometryFromPath(s);r===G?this.setFirstPath(o,n):this.setNextPath(r,n),n===G?this.setLastPath(o,r):this.setPrevPath(n,r),this.setGeometryVertexCount(o,this.getPointCount(o)-this.getPathSize(s)),this.setGeometryPathCount(o,this.getPathCount(o)-1),r=i===G?this.getLastPath(e):this.getPrevPath(i),this.setPrevPath(s,r),this.setNextPath(s,i),i===G?this.setLastPath(e,s):this.setPrevPath(i,s),r===G?this.setFirstPath(e,s):this.setNextPath(r,s),this.setGeometryVertexCount(e,this.getPointCount(e)+this.getPathSize(s)),this.setGeometryPathCount(e,this.getPathCount(e)+1),this.setPathGeometry(s,e)}addVertex(e,i){return this.m_vertices.getPointByVal(this.getVertexIndex(i),this.getHelperPoint()),this.insertVertex_(e,G,this.getHelperPoint(),!1)}insertVertex(e,i,s){return this.insertVertex_(e,i,s,!0)}removeVertex(e,i){const s=this.getPathFromVertex(e),n=this.getPrevVertex(e),r=this.getNextVertex(e);n!==G&&this.setNextVertex(n,r);const o=this.getPathSize(s);if(e===this.getFirstVertex(s)&&this.setFirstVertex(s,o>1?r:G),r!==G&&this.setPrevVertex(r,n),e===this.getLastVertex(s)&&this.setLastVertex(s,o>1?n:G),this.hasCurves()&&n!==G&&r!==G){const l=this.getVertexIndex(e),u=this.getVertexIndex(n),c=this.getVertexIndex(r);if(i){const h=this.getSegmentFromIndex(u);if(h!==null){const d=this.m_vertices.getXY(c);h.setEndXY(d),h.normalizeAfterEndpointChange()}this.setSegmentToIndex(l,null)}else{const h=this.getSegmentFromIndex(l);if(this.setSegmentToIndex(l,null),h!==null){const d=this.m_vertices.getXY(u);h.setStartXY(d),h.normalizeAfterEndpointChange()}this.setSegmentToIndex(u,h)}}this.setPathSize(s,o-1);const a=this.getGeometryFromPath(s);return this.setGeometryVertexCount(a,this.getPointCount(a)-1),this.freeVertex(e),r}removeVertices(e,i){z(e!==i);const s=this.getPathFromVertex(e),n=this.getPrevVertex(e),r=this.getPrevVertex(i);n!==G&&this.setNextVertex(n,i);let o=this.getPathSize(s);const a=this.getVertexIndex(e);this.setSegmentToIndex(a,null),this.setPrevVertex(i,n),this.setPrevVertex(e,G),this.setNextVertex(r,G);let l=0,u=e;const c=this.getFirstVertex(s);let h=!1;for(;;){const m=this.getNextVertex(u);if(h||(h=c===u),this.freeVertex(u),l++,u===r)break;u=m}o-=l,h&&this.setFirstVertex(s,o>0?i:G),this.setPathSize(s,o);const d=this.getGeometryFromPath(s);this.setGeometryVertexCount(d,this.getPointCount(d)-l)}getFirstVertex(e){return this.m_pathIndexList.getField(e,4)}getLastVertex(e){return this.m_pathIndexList.getField(e,5)}getNextVertex(e){return this.m_vertexIndexList.getField(e,2)}getPrevVertex(e){return this.m_vertexIndexList.getField(e,1)}getNextVertexEx(e,i){return i>0?this.m_vertexIndexList.getField(e,2):this.m_vertexIndexList.getField(e,1)}getPrevVertexEx(e,i){return i>0?this.m_vertexIndexList.getField(e,1):this.m_vertexIndexList.getField(e,2)}getPathFromVertex(e){return this.m_vertexIndexList.getField(e,3)}addPoint(e,i){return this.insertVertex_(e,G,i,!1)}getGeometryFromVertex(e){return this.getGeometryFromPath(this.getPathFromVertex(e))}replaceNaNs(e,i){this.m_vertexDescription.hasAttribute(e)||We(""),this.m_vertices.replaceNaNs(e,i)}removeNaNVertices(){for(let e=this.getFirstGeometry();e!==G;e=this.getNextGeometry(e))for(let i=this.getFirstPath(e);i!==G;i=this.getNextPath(i)){let s=this.getFirstVertex(i);for(let n=0,r=this.getPathSize(i);n<r;n++)s=this.getXY(s).isFinite()?this.getNextVertex(s):this.removeVertex(s,!0)}}queryVertexIterator(e=G){return this.queryVertexIteratorEx(!1,e)}queryVertexIteratorEx(e,i=G){let s=G,n=G,r=G,o=G,a=0,l=!1;for(s=i!==G?i:this.getFirstGeometry();s!==G;s=this.getNextGeometry(s))if(!e||Ei(this.getGeometryType(s))){for(n=this.getFirstPath(s);n!==G;n=this.getNextPath(n))if(r=this.getFirstVertex(n),o=r,a=0,r!==G){l=!0;break}if(l||i!==G)break}return l||(s=G),cB.create_(this,s,n,r,o,a,e,!1,i!==G)}queryVertexIteratorOnSelection(e=G){return this.m_selection?cB.create_(this,e,G,G,G,-1,!1,!0,e!==G):this.queryVertexIteratorEx(!1,e)}hasSelection(){return this.m_selection}createEmptySelection(){z(0)}removeSelection(){this.m_selection&&(this.m_selectedVertices.length=0,this.removeUserIndex(this.m_selectionIndex),this.m_selectionIndex=-1,this.m_selection=!1,this.m_selectedCount=0)}select(e){return!!this.selected(e)||(this.setUserIndex(e,this.m_selectionIndex,this.m_selectedVertices.length),this.m_selectedVertices.push(e),this.m_selectedCount++,!1)}unselect(e){if(!this.m_selection)return;const i=this.getUserIndex(e,this.m_selectionIndex);i>=0&&(this.m_selectedVertices[i]=G,this.setUserIndex(e,this.m_selectionIndex,-1),this.m_selectedCount--)}selected(e){return!this.m_selection||this.selected_(e)}getSelectedCount(){return this.m_selection?this.m_selectedCount:this.getTotalPointCount()}createSelectionForCrackingAndClustering(e,i){return z(0),!1}peelALoop(e,i){this.peelALoop_(e,i,!1)}peelALoopIntoAPath(e,i){return this.peelALoop_(e,i,!0)}applyTransformation(e){if(this.m_verticesMp.applyTransformation(e),this.m_segments!==null)for(let i=0,s=this.m_segments.length;i<s;i++)this.m_segments[i]&&this.m_segments[i].applyTransformation(e)}setGeometryType(e,i){this.m_geometryIndexList.setField(e,2,i)}splitSegmentWithIntersector(e,i,s,n,r){n?this.splitSegmentForward(e,i,s,!0,r):this.splitSegmentBackward(e,i,s,!0,r)}setPrevVertex(e,i){this.m_vertexIndexList.setField(e,1,i)}setNextVertex(e,i){this.m_vertexIndexList.setField(e,2,i)}setPathToVertex(e,i){this.m_vertexIndexList.setField(e,3,i)}setPathSize(e,i){this.m_pathIndexList.setField(e,3,i)}setFirstVertex(e,i){this.m_pathIndexList.setField(e,4,i)}setLastVertex(e,i){this.m_pathIndexList.setField(e,5,i)}getSegment(e){if(this.m_segments!=null){const i=this.getVertexIndex(e);return this.getSegmentFromIndex(i)}return null}isCurve(e){return z(0),!1}querySegment(e,i,s=!0,n=!1){const r=this.getNextVertex(e);if(r===G)return!1;const o=this.getSegment(e);if(!o)return!s&&(this.queryLineConnector(e,i.createLine(),n),!0);if(i.copyFrom(o,!0),n)return!0;if(this.m_vertexDescription.getAttributeCount()>1){const a=this.getHelperPoint();this.queryPoint(e,a),i.get().setStart(a),this.queryPoint(r,a),i.get().setEnd(a)}return!0}getSegmentFromIndex(e){return(this.m_segments!==null&&this.m_segments.length>e?this.m_segments[e]:null)||null}getAndClearSegmentFromIndex(e){return(this.m_segments!==null&&this.m_segments.length>e?this.m_segments[e]:null)||null}setSegmentToIndex(e,i){if(this.m_hasForceSetEnvelope=0,this.m_segments===null){if(!i)return;this.m_segments=[],this.m_segments.length=this.m_vertices.getPointCount()}e>=this.m_segments.length&&(this.m_segments.length=e+1),this.m_segments[e]=i}setGeometryPathCount(e,i){this.m_geometryIndexList.setField(e,6,i)}setGeometryVertexCount(e,i){this.m_geometryIndexList.setField(e,5,i)}ringParentageCheckInternal(e,i){return z(0),!1}reverseRingInternal(e){const i=this.hasCurves(),s=this.hasSegmentParentage();let n=null,r=-1,o=e;if(i){const a=this.getVertexIndex(o);n=this.getAndClearSegmentFromIndex(a)}s&&(r=this.getSegmentParentage(o));do{const a=this.getPrevVertex(o),l=this.getNextVertex(o);if(this.setNextVertex(o,a),this.setPrevVertex(o,l),i){const u=this.getVertexIndex(l),c=this.getSegmentFromIndex(u);n&&n.reverse(),this.setSegmentToIndex(u,n),n=c}if(s){const u=this.getSegmentParentage(l);this.setSegmentParentagePreserveBreak(l,r),r=u}o=l}while(o!==e);this.dbgVerifyIntegrity(e)}setTotalPointCount(e){this.m_pointCount=e}removePathOnly(e){const i=this.getPrevPath(e),s=this.getNextPath(e),n=this.getGeometryFromPath(e);i!==G?this.setNextPath(i,s):this.setFirstPath(n,s),s!==G?this.setPrevPath(s,i):this.setLastPath(n,i),this.setFirstVertex(e,G),this.setLastVertex(e,G),this.freePath(e)}insertClosedPath(e,i,s,n,r){const o=this.insertPath(e,G);let a=0,l=s;for(r[0]=!1;;){l===n&&(r[0]=!0),this.setPathToVertex(l,o),a++;const u=this.getNextVertex(l);if(u===s)break;l=u}return this.setClosedPath(o,!0),this.setPathSize(o,a),r[0]&&(s=n),this.setFirstVertex(o,s),this.setLastVertex(o,this.getPrevVertex(s)),this.setRingAreaValid(o,!1),o}findVertex2D(e,i){return z(0),0}findVertex3D(e,i,s){return z(0),0}dbgVerifyMonotone(){}dbgCheckSelection(){}dbgVerifySegment(e){}dbgVerifyIntegrity(e,i=!0){}dbgVerifyVertexCounts(){}dbgVerifyCurves(){}dbgDumpGeometry(e,i){}removeVertexInternal(e,i){const s=this.getPrevVertex(e),n=this.getNextVertex(e);if(s!==G&&this.setNextVertex(s,n),n!==G&&this.setPrevVertex(n,s),this.hasCurves()&&s!==G&&n!==G){const r=this.getVertexIndex(e),o=this.getVertexIndex(s),a=this.getVertexIndex(n);if(i){const l=this.getSegmentFromIndex(o);if(l!==null){const u=this.m_vertices.getXY(a);l.setEndXY(u),l.normalizeAfterEndpointChange()}this.setSegmentToIndex(r,null)}else{const l=this.getSegmentFromIndex(r);if(this.setSegmentToIndex(r,null),l!==null){const u=this.m_vertices.getXY(o);l.setStartXY(u),l.normalizeAfterEndpointChange()}this.setSegmentToIndex(o,l)}}return this.freeVertex(e),n}isRingAreaValid(e){return!!(4&this.getPathFlags(e))}setRingAreaValid(e,i){const s=(4|this.getPathFlags(e))-4;this.setPathFlags(e,s|(i?4:0))}compareVerticesSimpleY(e,i){return this.queryXY(e,this.m_workPoint2D),this.queryXY(i,this.m_workPoint2_2D),this.m_workPoint2D.compare(this.m_workPoint2_2D)}compareVerticesSimpleY3D(e,i){return this.getXYZ(e).compare(this.getXYZ(i))}compareVerticesSimpleX(e,i){return this.getXY(e).compareX(this.getXY(i))}sortVerticesSimpleByYHeapMerge(e,i){z(0)}sortVerticesSimpleByY(e,i,s){this.m_bucketSort.sort(e,i,s,new jFe(this))}sortVerticesSimpleByX(e,i,s){z(0)}sortVerticesSimpleByY3D(e,i,s){z(0)}snapVertexForPoleClipping(e,i){const s=this.getPrevVertex(e);s!==G&&this.replaceCurveWithLine(s),this.getNextVertex(e)!==G&&this.replaceCurveWithLine(e);const n=new N;this.queryXY(e,n),n.y=i,this.setXY(e,n)}setSegmentParentageAndBreak(e,i,s=!0){if(this.m_segmentParentageIndex===-1){if(i===-1)return;this.m_segmentParentageIndex=this.createUserIndex()}i>=0&&(z(i<=Aa()>>1),i<<=1,i|=s?1:0),this.setUserIndex(e,this.m_segmentParentageIndex,i)}setSegmentParentagePreserveBreak(e,i){if(z(i>=-1),this.m_segmentParentageIndex===-1){if(i===-1)return;this.m_segmentParentageIndex=this.createUserIndex()}i>=0&&(z(i<=Aa()>>1),i<<=1,i|=this.getSegmentParentageBreakVertex(e)?1:0),this.setUserIndex(e,this.m_segmentParentageIndex,i)}getSegmentParentage(e){if(this.m_segmentParentageIndex===-1)return-1;const i=this.getUserIndex(e,this.m_segmentParentageIndex);return i<0?i:i>>1}getOriginalSegmentInfo(e){if(this.m_segmentParentageIndex!==-1){const i=this.getSegmentParentage(e);return new hB(i)}return new hB(-1)}setSegmentParentageBreakVertex(e,i){if(this.m_segmentParentageIndex===-1)return;let s=this.getUserIndex(e,this.m_segmentParentageIndex);s<0||!!(1&s)!==i&&(i?s|=1:s&=Aa()>>1<<1,this.setUserIndex(e,this.m_segmentParentageIndex,s))}getSegmentParentageBreakVertex(e){if(this.m_segmentParentageIndex===-1)return!0;const i=this.getUserIndex(e,this.m_segmentParentageIndex);return i<0||!!(1&i)}isDiscontinuousSegmentParentage(e){const i=this.getPrevVertex(e);return i===G?!1:this.getSegmentParentage(i)!==this.getSegmentParentage(e)}setCurveStitcherPointer(e){this.m_curveStitcher=e}hasSegmentParentage(){return this.m_segmentParentageIndex!==-1}deleteSegmentParentage(){this.m_segmentParentageIndex!==-1&&(this.removeUserIndex(this.m_segmentParentageIndex),this.m_segmentParentageIndex=-1),this.m_curveStitcher=null}clearSegments(){this.m_segments=null}};function p0t(t){if(t.isEmpty())return new Ci({vd:t.getDescription()});const e=t.getImpl(),i=e.getPointCount();if(i<=2){if(i===1||e.getXY(0).equals(e.getXY(1))){const m=new Jt({vd:e.getDescription()});return e.getPointByVal(0,m),m}{const m=new Jt,f=new Qi({vd:e.getDescription()});return e.getPointByVal(0,m),f.startPathPoint(m),e.getPointByVal(1,m),f.lineToPoint(m),f}}const s=e.getAttributeStreamRef(0),n=new gfe({stream:s,n:i});let r=0,o=1;const a=s.readPoint2D(r<<1),l=new N;for(;o<i&&s.queryPoint2D(o<<1,l).equals(a);)o++;if(n.m_treeHull.addElement(r),o<i){n.m_treeHull.addBiggestElement(o);const m=new N;for(let f=o+1;f<e.getPointCount();f++){s.queryPoint2D(f<<1,m);const _=n.treeHull(m);_!==-1&&n.m_treeHull.setElement(_,f)}}const u=e.getDescription(),c=u.getAttributeCount()>1,h=n.m_treeHull.size();let d=null;if(h>=2){d=h>=3?new Ci({vd:u}):new Qi({vd:u});const m=d.getImpl();m.reserve(n.m_treeHull.size()),m.addPathPoint2D(null,0,!0);const f=new N;for(let _=n.m_treeHull.getFirst();_!==-1;_=n.m_treeHull.getNext(_))if(c){const v=new Jt;e.getPointByVal(n.m_treeHull.getElement(_),v),m.insertPoint(0,-1,v)}else s.queryPoint2D(n.m_treeHull.getElement(_)<<1,f),m.insertPoint2D(0,-1,f)}else if(c){const m=new Jt({vd:u});e.getPointByVal(n.m_treeHull.getElement(n.m_treeHull.getFirst()),m),d=m}else{const m=s.readPoint2D(n.m_treeHull.getElement(n.m_treeHull.getFirst())<<1);d=new Jt(m)}return d}function pee(t,e,i){if(e<=262144)return KFe(t,e,i);z(0);const s=new gfe({points:t,n:e}),n=0;let r=1;const o=t[n].clone();for(;r<e&&t[r].equals(o);)r++;if(s.m_treeHull.addElement(n),r<e){s.m_treeHull.addBiggestElement(r);for(let l=r+1;l<e;l++){const u=t[l],c=s.treeHull(u);c!==-1&&s.m_treeHull.setElement(c,l)}}let a=0;for(let l=s.m_treeHull.getFirst();l!==-1;l=s.m_treeHull.getNext(l))i[a++]=s.m_treeHull.getElement(l);return a}function f0t(t,e,i){const s=t.getImpl(),n=s.getPathStart(e),r=s.getPathEnd(e),o=!s.isClosedPath(e)&&s.isClosedPathInXYPlane(e),a=s.getAttributeStreamRef(0),l=2*n;let u=2*r;if(o&&(u-=2),u-l<6)return!0;const c=a.readPoint2D(l),h=a.readPoint2D(l+2),d=a.readPoint2D(l+4);if(!K_(N.orientationRobust(h,d,c)))return!1;const m=h.clone(),f=new N;for(let _=l+6;_<u;_+=2)if(f.assign(h),h.assign(d),a.queryPoint2D(_,d),!K_(N.orientationRobust(h,d,c))||!K_(N.orientationRobust(m,d,c))||!K_(N.orientationRobust(h,d,f)))return!1;return!0}function g0t(t,e,i,s,n){if(i.setNAN(),s.setCoords(1,0),n.setCoords(0,0),t.isEmpty())return;if(t.getGeometryType()===q.enumPoint)return void i.assign(t.getXY());const r=t,o=r.getPointCount();if(o===2){const a=r.getXY(0),l=r.getXY(1);i.assign(a.add(l).mul(.5));const u=l.sub(a);s=gee(u),n.setCoords(.5*u.length(),0)}else{let a=Number.MAX_VALUE;const l=[0,1,0,0],u=new o3e(4,2);for(u.set(0,0,0),u.set(0,1,1),u.set(1,0,1),u.set(1,1,2);l[0]<o;++l[0],zU(u,0,o)){l[1]===l[0]&&(++l[1],zU(u,1,o));for(let _=1;;++_){for(;;){const v=JFe(r.getXY(u.get(0,0)),r.getXY(u.get(0,1)),r.getXY(u.get(_,0)),r.getXY(u.get(_,1)),2^_);if(v>0||(++l[_],zU(u,_,o),v===0))break}if(_===3)break;l[_+1]<l[_]&&(l[_+1]=l[_],u.set(_+1,0,u.get(_,0)),u.set(_+1,1,u.get(_,1)))}const c=r.getXY(u.get(0,0)).add(r.getXY(u.get(2,0))).mul(.5),h=gee(r.getXY(u.get(0,1)).sub(r.getXY(u.get(0,0)))),d=new N;let m,f;if(d.x=Math.max(0,h.dotProduct(r.getXY(u.get(1,0)).sub(r.getXY(u.get(3,0))))),d.y=Math.max(0,h.crossProduct(r.getXY(u.get(0,0)).sub(r.getXY(u.get(2,0))))),e?(m=d.x*d.y,f=m<a):(m=d.y,f=m<a),f){a=m;const _=r.getXY(u.get(1,0)),v=r.getXY(u.get(3,0)),x=_.add(v).mul(.5).sub(c);i.assign(c.add(h.mul(h.dotProduct(x)))),s.assign(h),n.assign(d)}}n.mulThis(.5),n.x<n.y&&(n.y=Ge(n.x,n.x=n.y),s.leftPerpendicularThis())}s.y<0?s.negateThis():s.y===0&&(s.x=1)}wn.st_defaultRank=1;let XFe=class{constructor(e){this.m_handleP=-1,this.m_handleQ=-1,this.m_currentSupport=-1,this.m_area=0,this.m_bDone=!0,z(0),this.m_convexHull=e,this.m_function=this.done_}next(){return z(0),!1}get_vertex_handle_p(){return z(0),0}get_vertex_handle_q(){return z(0),0}get_current_support(){return z(0),0}getNext(e){return z(0),0}getPrev(e){return z(0),0}intialize_(){return z(0),!1}increment_(){return z(0),!1}increment_q_(){return z(0),!1}increment_p_(){return z(0),!1}parallel_edge_with_q_support_(){return z(0),!1}parallel_edge_with_p_support_(){return z(0),!1}done_(){return z(0),!1}},gfe=class{nullGetXY(e){return We("m_getXY is null"),{}}nullDeleteNode(e){We("m_deleteNode is null")}constructor(e){return this.m_treeHull=new mr,this.m_shape=null,this.m_stream=null,this.m_points=null,this.m_geometryHandle=-1,this.m_pathHandle=-1,this.m_getXY=this.nullGetXY,this.m_deleteNode=this.nullDeleteNode,e?e.stream?(this.m_treeHull.setCapacity(Math.min(20,e.n)),this.m_stream=e.stream,this.m_getXY=this.getXYStream,this.m_deleteNode=this.deleteNodeStream,this.m_points=null,this.m_geometryHandle=G,void(this.m_pathHandle=G)):e.points?(this.m_treeHull.setCapacity(Math.min(20,e.n)),this.m_points=e.points,this.m_getXY=this.getXYPoints,this.m_deleteNode=this.deleteNodePoints,this.m_stream=null,this.m_geometryHandle=G,void(this.m_pathHandle=G)):void un("unrecognized constructor parameter"):(this.m_treeHull.setCapacity(20),this.m_shape=new wn,this.m_geometryHandle=this.m_shape.createGeometry(q.enumMultiPoint),this.m_pathHandle=this.m_shape.insertPath(this.m_geometryHandle,G),this.m_getXY=this.getXYShape,this.m_deleteNode=this.deleteNodeShape,this.m_stream=null,void(this.m_points=null))}getXYShape(e){return this.m_shape.getXY(e)}getXYStream(e){return this.m_stream.readPoint2D(e<<1)}getXYPoints(e){return z(0),new N}deleteNodeShape(e){const i=this.m_treeHull.getElement(e);this.m_treeHull.deleteNode(e),this.m_shape.removeVertex(i,!1)}deleteNodeStream(e){this.m_treeHull.deleteNode(e)}deleteNodePoints(e){z(0)}addGeometry(e){if(e.isEmpty())return;const i=e.getGeometryType();if(i===q.enumGeometryCollection){const s=e;for(let n=0,r=s.getGeometryCount();n<r;n++)this.addGeometry(s.getGeometry(n))}else ll(i)?this.addMultiVertexGeometry(e):nr(i)?this.addSegment(e):i===q.enumEnvelope?this.addEnvelope(e):i===q.enumPoint?this.addPoint(e):ce("Convex_hull: geometry not supported")}getBoundingGeometry(){const e=new Jt,i=this.m_treeHull.getFirst(),s=new Ci({vd:this.m_shape.getVertexDescription()});if(this.m_treeHull.size()===0)return s;s.reserve(this.m_treeHull.size()),this.m_shape.queryPoint(this.m_treeHull.getElement(i),e),s.startPathPoint(e);for(let n=this.m_treeHull.getNext(i);n!==-1;n=this.m_treeHull.getNext(n))this.m_shape.queryPoint(this.m_treeHull.getElement(n),e),s.lineToPoint(e);return s}getAntipodalPairsIterator(){return z(0),new XFe(this)}getXY(e){return z(0),new N}getXYWithIndex(e){return z(0),new N}getFirst(){return z(0),0}getLast(){return z(0),0}getNext(e){return z(0),0}getPrev(e){return z(0),0}getVertexIndex(e){return z(0),0}getPointCount(){return z(0),0}addMultiVertexGeometry(e){const i=new Jt,s=e.getImpl(),n=new N;for(let r=0;r<e.getPointCount();r++){s.queryXY(r,n);const o=this.addPoint2D(n);if(o!==-1){e.getPointByVal(r,i);const a=this.m_shape.addPoint(this.m_pathHandle,i);this.m_treeHull.setElement(o,a)}}}addEnvelope(e){const i=new Jt;for(let s=0;s<4;s++){const n=new N;e.queryCorner(s,n);const r=this.addPoint2D(n);if(r!==-1){e.queryCornerByVal(s,i);const o=this.m_shape.addPoint(this.m_pathHandle,i);this.m_treeHull.setElement(r,o)}}}addSegment(e){const i=new Jt,s=e.getStartXY(),n=this.addPoint2D(s);if(n!==-1){e.queryStart(i);const a=this.m_shape.addPoint(this.m_pathHandle,i);this.m_treeHull.setElement(n,a)}const r=e.getEndXY(),o=this.addPoint2D(r);if(o!==-1){e.queryEnd(i);const a=this.m_shape.addPoint(this.m_pathHandle,i);this.m_treeHull.setElement(o,a)}}addPoint(e){const i=e.getXY(),s=this.addPoint2D(i);if(s!==-1){const n=this.m_shape.addPoint(this.m_pathHandle,e);this.m_treeHull.setElement(s,n)}}addPoint2D(e){let i=-1;if(this.m_treeHull.size()===0)return i=this.m_treeHull.addElement(-4),i;if(this.m_treeHull.size()===1){const s=this.m_treeHull.getElement(this.m_treeHull.getFirst()),n=this.m_shape.getXY(s);return e.equals(n)||(i=this.m_treeHull.addBiggestElement(-5)),i}return i=this.treeHull(e),i}treeHull(e){let i=-1;do{const s=this.m_treeHull.getFirst(),n=this.m_treeHull.getLast(),r=this.m_treeHull.getElement(s),o=this.m_treeHull.getElement(n),a=this.m_getXY(r),l=this.m_getXY(o),u=N.orientationRobust(l,e,a);if(K_(u)){i=this.m_treeHull.addBiggestElement(-1);const c=this.treeHullWalkBackward(e,n,s);c!==s&&this.treeHullWalkForward(e,s,this.m_treeHull.getPrev(c));break}if(fee(u)){let c=this.m_treeHull.getRoot(),h=this.m_treeHull.getFirst(),d=this.m_treeHull.getLast(),m=-1,f=-1,_=-1;for(;h!==this.m_treeHull.getPrev(d);){f=this.m_treeHull.getElement(c);const w=this.m_getXY(f);fee(N.orientationRobust(w,e,a))?(d=c,c=this.m_treeHull.getLeft(c)):(h=c,c=this.m_treeHull.getRight(c))}c=d,m=h,f=this.m_treeHull.getElement(c),_=this.m_treeHull.getElement(m);const v=this.m_getXY(f),x=this.m_getXY(_);if(m!==s&&!K_(N.orientationRobust(x,e,v)))break;i=this.m_treeHull.addElementAtPosition(m,c,-2,!0,!1),this.treeHullWalkForward(e,c,n),this.treeHullWalkBackward(e,m,s);break}{const c=QFe(e,l,a);if(c===-1){const h=this.m_treeHull.getPrev(n);this.m_treeHull.deleteNode(n),i=this.m_treeHull.addBiggestElement(-3),this.treeHullWalkBackward(e,h,s)}else if(c===1){const h=this.m_treeHull.getNext(s);this.m_treeHull.deleteNode(s),i=this.m_treeHull.addElementAtPosition(-1,h,-3,!0,!1),this.treeHullWalkForward(e,h,n)}break}}while(!1);return i}treeHullWalkForward(e,i,s){if(i===s)return s;let n=i,r=this.m_treeHull.getElement(n),o=this.m_treeHull.getNext(n);const a=this.m_getXY(r);for(;n!==s&&this.m_treeHull.size()>2;){const l=this.m_treeHull.getElement(o),u=this.m_getXY(l);if(K_(N.orientationRobust(u,e,a)))break;const c=n;n=o,r=l,a.assign(u),o=this.m_treeHull.getNext(n),this.m_deleteNode(c)}return n}treeHullWalkBackward(e,i,s){if(i===s)return s;let n=i,r=this.m_treeHull.getElement(n),o=this.m_treeHull.getPrev(n);const a=this.m_getXY(r);for(;n!==s&&this.m_treeHull.size()>2;){const l=this.m_treeHull.getElement(o),u=this.m_getXY(l);if(K_(N.orientationRobust(a,e,u)))break;const c=n;n=o,r=l,a.assign(u),o=this.m_treeHull.getPrev(n),this.m_deleteNode(c)}return n}};function WFe(t,e,i){const s=e.sub(t),n=i.sub(e);if(s.x===0)return n.x>0?-1:0;if(s.y===0)return n.y>0?1:n.y<0?-1:0;const r=s.crossProduct(n),o=4*Number.EPSILON*(Math.abs(n.x*s.y)+Math.abs(n.y*s.x));return r>o?1:r<-o?-1:N.orientationRobust(t,e,i)}function ZFe(t,e,i){const s=e.sub(t),n=i.sub(e);if(s.x===0)return n.x<0?-1:0;if(s.y===0)return n.y>0?-1:n.y<0?1:0;const r=s.crossProduct(n),o=4*Number.EPSILON*(Math.abs(n.x*s.y)+Math.abs(n.y*s.x));return r>o?1:r<-o?-1:N.orientationRobust(t,e,i)}function KFe(t,e,i){const s=new Un(0);for(let a=0;a<e;a++)s.add(a);const n={userSort(a,l,u){u.sort(a,l,(c,h)=>t[c].compareX(t[h]))},getValue:a=>t[a].x};Uy.sortEx(s,0,e,n);let r=0;e:for(let a=0;a<e;++a){const l=s.read(a);for(;r>=2;){const u=i[r-2],c=i[r-1];if(t[c].equals(t[l])){s.write(a,-1);continue e}if(!(WFe(t[u],t[c],t[l])>=0)){c===s.read(a-1)&&s.write(a-1,-1);break}r--}i[r++]=l,r===2&&t[l].equals(t[i[0]])&&(s.write(1,-1),r--)}const o=r+1;e:for(let a=e-2;a>=0;--a){const l=s.read(a);if(!(l<0)){for(;r>=o;){const u=i[r-2],c=i[r-1];if(t[c].equals(t[l]))continue e;if(!(ZFe(t[u],t[c],t[l])>=0))break;r--}if(a!==0){const u=i[r-1];i[r++]=l,t[l].equals(t[u])&&r--}}}return r>1&&t[i[0]].equals(t[i[r-1]])&&r--,r}function K_(t){return t<0}function fee(t){return t>0}function QFe(t,e,i){let s=-1;e.y===i.y?s=0:e.x===i.x?s=1:s=Math.abs(e.x-i.x)>=Math.abs(e.y-i.y)?0:1;let n=-1;return n=e[s]<i[s]?t[s]<e[s]?-1:i[s]<t[s]?1:0:e[s]<t[s]?-1:t[s]<i[s]?1:0,n}function gee(t){return(t=t.clone()).divThis(Math.max(Math.abs(t.x),Math.abs(t.y))),t.normalize(),t}function zU(t,e,i){t.inc(e,0)===i&&t.set(e,0,0),t.inc(e,1)===i&&t.set(e,1,0)}function JFe(t,e,i,s,n){switch(n){case 0:break;case 1:e.rightPerpendicularThis(),t.rightPerpendicularThis();break;case 2:e.negateThis(),t.negateThis();break;case 3:e.leftPerpendicularThis(),t.leftPerpendicularThis();break;default:ce("")}return N.orientationRobustEx(t,e,i,s)}function tE(t,e,i,s,n){return u4(t,!1,e,i,s,n)}function u4(t,e,i,s,n,r){const o=i.getGeometryType(),a=s.getGeometryType(),l=Math.max(n,hl(i,s));if(o===q.enumLine&&a===q.enumLine)return RG(i,s,l,r);let u=i,c=s,h=i.getStartXY(),d=i.getEndXY();if(h.compare(d)>0&&(u=i.clone().reverse()),h=s.getStartXY(),d=s.getEndXY(),h.compare(d)>0&&(c=s.clone().reverse()),e){if(i.equals(s))return 2;if(hOe(i,s,l))return 4}switch(o){case q.enumLine:switch(a){case q.enumEllipticArc:return uee(t,c,u,l,r);case q.enumBezier:return XJ(t,c,u,l,r);case q.enumRationalBezier2:return FJ(t,c,u,l,r);case q.enumBezier2:return qJ(t,c,u,l,r);default:We("")}break;case q.enumEllipticArc:switch(a){case q.enumLine:return uee(t,u,c,l,r);case q.enumEllipticArc:return zFe(t,u,c,l,r);case q.enumBezier:return WJ(t,c,u,l,r);case q.enumRationalBezier2:return kJ(t,c,u,l,r);case q.enumBezier2:return HJ(t,c,u,l,r);default:We("")}break;case q.enumBezier:switch(a){case q.enumLine:return XJ(t,u,c,l,r);case q.enumEllipticArc:return WJ(t,u,c,l,r);case q.enumBezier:return rFe(t,u,c,l,r);case q.enumRationalBezier2:return ZJ(t,u,c,l,r);case q.enumBezier2:return KJ(t,u,c,l,r);default:We("")}break;case q.enumRationalBezier2:switch(a){case q.enumLine:return FJ(t,u,c,l,r);case q.enumEllipticArc:return kJ(t,u,c,l,r);case q.enumBezier:return ZJ(t,c,u,l,r);case q.enumRationalBezier2:return fLe(t,u,c,l,r);case q.enumBezier2:return $J(t,u,c,l,r);default:We("")}break;case q.enumBezier2:switch(a){case q.enumLine:return qJ(t,u,c,l,r);case q.enumEllipticArc:return HJ(t,u,c,l,r);case q.enumBezier:return KJ(t,c,u,l,r);case q.enumRationalBezier2:return $J(t,c,u,l,r);case q.enumBezier2:return DLe(t,u,c,l,r);default:We("")}break;default:We("")}}function Gl(t,e,i=!0){if(!i&&!_fe(t,e))return 0;const s=t.isLine()&&e.isLine();if(t.getStartXY().equals(e.getStartXY())&&t.getEndXY().equals(e.getEndXY())){if(s)return 1;const r=t.getGeometryType();if(r!==e.getGeometryType())return 0;if(r===q.enumBezier){const o=t,a=e;return o.getControlPoint1().equals(a.getControlPoint1())&&o.getControlPoint2().equals(a.getControlPoint2())?1:0}if(r===q.enumEllipticArc)return dee(t,e,!1)?1:0;if(r===q.enumRationalBezier2){const o=t,a=e;if(o.getControlPoint1().equals(a.getControlPoint1())&&o.getStandardFormWeight()===a.getStandardFormWeight())return 1}else if(r===q.enumBezier2){const o=e;if(t.getControlPoint1().equals(o.getControlPoint1()))return 1}return 0}if(t.getStartXY().equals(e.getEndXY())&&t.getEndXY().equals(e.getStartXY())){if(s)return-1;const r=t.getGeometryType();if(r!==e.getGeometryType())return 0;if(r===q.enumBezier){const o=t,a=e;return o.getControlPoint1().equals(a.getControlPoint2())&&o.getControlPoint2().equals(a.getControlPoint1())?-1:0}if(r===q.enumEllipticArc)return dee(t,e,!0),-1;if(r===q.enumRationalBezier2){const o=t,a=e;if(o.getControlPoint1().equals(a.getControlPoint1())&&o.getStandardFormWeight()===a.getStandardFormWeight())return-1}else if(r===q.enumBezier2){const o=e;if(t.getControlPoint1().equals(o.getControlPoint1()))return-1}return 0}return 0}function _fe(t,e){const i=t.getGeometryType();return i===e.getGeometryType()&&(i!==q.enumEllipticArc||t.projectionBehavior()===e.projectionBehavior())}function q1(t,e,i,s,n,r,o){!n&&r&&ce("");const a=e.getGeometryType(),l=i.getGeometryType(),u=Math.max(o,hl(e,i));if(s&&(s.length=0),n&&(n.length=0),r&&(r.length=0),a===q.enumLine&&l===q.enumLine)return n4(e,i,s,n,r,u,!1,!1);let c=e,h=i,d=e.getStartXY(),m=e.getEndXY(),f=!1,_=!1;d.compare(m)>0&&(c=e.clone(!0).reverse(),f=!0),d=i.getStartXY(),m=i.getEndXY(),d.compare(m)>0&&(h=i.clone(!0).reverse(),_=!0);let v=0;switch(a){case q.enumLine:switch(l){case q.enumEllipticArc:v=iM(t,h,c,s,r,n,u,!1,!1,!0);break;case q.enumBezier:v=JP(t,h,c,s,r,n,u,!1,!1,!0);break;case q.enumRationalBezier2:v=b1(t,h,c,s,r,n,u,!1,!1,!0);break;case q.enumBezier2:v=WP(t,h,c,s,r,n,u,!1,!1,!0);break;default:We("")}break;case q.enumEllipticArc:switch(l){case q.enumLine:v=iM(t,c,h,s,n,r,u,!1,!1,!1);break;case q.enumEllipticArc:v=mfe(t,c,h,s,n,r,u,!1,!1,!1);break;case q.enumBezier:v=eB(t,h,c,s,r,n,u,!1,!1,!0);break;case q.enumRationalBezier2:v=GG(t,h,c,s,r,n,u,!1,!1,!0);break;case q.enumBezier2:v=QG(t,h,c,s,r,n,u,!1,!1,!0);break;default:We("")}break;case q.enumRationalBezier2:switch(l){case q.enumLine:v=b1(t,c,h,s,n,r,u,!1,!1,!1);break;case q.enumEllipticArc:v=GG(t,c,h,s,n,r,u,!1,!1,!1);break;case q.enumBezier:v=tB(t,h,c,s,r,n,u,!1,!1,!0);break;case q.enumRationalBezier2:v=BP(t,c,h,s,n,r,u,!1,!1,!1);break;case q.enumBezier2:v=BG(t,c,h,s,n,r,u,!1,!1,!1);break;default:We("")}break;case q.enumBezier2:switch(l){case q.enumLine:v=WP(t,c,h,s,n,r,u,!1,!1,!1);break;case q.enumEllipticArc:v=QG(t,c,h,s,n,r,u,!1,!1,!1);break;case q.enumBezier:v=iB(t,h,c,s,r,n,u,!1,!1,!0);break;case q.enumRationalBezier2:v=BG(t,h,c,s,r,n,u,!1,!1,!0);break;case q.enumBezier2:v=H7(t,c,h,s,n,r,u,!1,!1,!1);break;default:We("")}break;case q.enumBezier:switch(l){case q.enumLine:v=JP(t,c,h,s,n,r,u,!1,!1,!1);break;case q.enumEllipticArc:v=eB(t,c,h,s,n,r,u,!1,!1,!1);break;case q.enumBezier:v=W7(t,c,h,s,n,r,u,!1,!1,!1);break;case q.enumRationalBezier2:v=tB(t,c,h,s,n,r,u,!1,!1,!1);break;case q.enumBezier2:v=iB(t,c,h,s,n,r,u,!1,!1,!1);break;default:We("")}break;default:We("")}if(f){if(n){for(let x=0;x<v;x++)n[x]=1-n[x];n.reverse()}s&&s.reverse(),r&&r.reverse()}if(_&&r)for(let x=0;x<v;x++)r[x]=1-r[x];return v}function zD(t,e,i){return e===i?0:(e>i&&(i=Ge(e,e=i)),t.cut(e,i,!0).calculateUpperLength2D())}function e4e(t,e,i,s,n){const r=[],o=[],a=[];for(let u=0,c=n;u<c;u++)r.push(t.calculateSubLengthFromStart(i[u])),o.push(e.calculateSubLengthFromStart(s[u])),Vs(i[u],0,1)&&Vs(s[u],0,1)&&t.getCoord2D(i[u]).equals(e.getCoord2D(s[u]))&&a.push(u);if(a.length===0||a.length===n)return;a.sort((u,c)=>i[u]<i[c]?-1:i[u]>i[c]?1:s[u]<s[c]?-1:s[u]>s[c]?1:0);let l=-1;for(const u of a){if(l>=0&&i[u]===i[l]&&i[u]===i[l]){l=u;continue}l=u;const c=[];c.length=n;for(let h=0;h<c.length;++h)c[h]=h;c.sort((h,d)=>{const m=r[u],f=o[u],_=r[h]-m,v=o[h]-f,x=_*_+v*v,w=r[d]-m,T=o[d]-f,C=w*w+T*T;return x<C?-1:x>C?1:0});for(let h=0;h<n;h++){const d=c[h];if(d===u||i[d]===i[u]&&s[d]===s[u]||Vs(i[d],0,1)&&Vs(s[d],0,1))continue;const m=(A,I,L,D)=>{const O=new Et,U=new ge;U.setWithEps(1);const $=new ge;$.set(I,U.eps()),t.queryCoord2DE($,O);const B=new Et;t.queryCoord2DE(new ge(A),B);let V=!1;return O.eq(B)&&($.set(D,U.eps()),e.queryCoord2DE($,O),e.queryCoord2DE(new ge(L),B),V=O.eq(B)),!V},f=N.getNAN();t.queryCoord2D(i[d],f);const _=N.getNAN();if(e.queryCoord2D(s[d],_),N.distance(f,_)===0&&m(i[u],i[d],s[u],s[d]))break;const v=new Me(s[d],s[u]);v.normalizeNoNAN();const x=new Me(i[d],i[u]);x.normalizeNoNAN();let w=-1,T=Number.POSITIVE_INFINITY,C=Number.POSITIVE_INFINITY,M=i[d];f.assign(t.getCoord2D(M));for(let A=0;A<5;A++){const I=e.getClosestCoordinateOnInterval(f,v,-1);_.assign(e.getCoord2D(I));const L=N.distance(f,_);if(M=t.getClosestCoordinateOnInterval(_,x,-1),M===i[u]&&I===s[u]){w=1;break}f.assign(t.getCoord2D(M));const D=N.distance(_,f);if(!(D<C&&L<T)){w=0;break}if(D===0&&L===0){m(i[u],i[d],s[u],s[d])?(i[d]=M,s[d]=I,w=0):w=1;break}C=D,T=L}if(w===-1&&(w=Vs(i[d],0,1)||Vs(s[d],0,1)?0:1),w!==1)break;i[d]=i[u],s[d]=s[u]}}}function Iu(t,e,i,s,n,r,o,a,l,u,c,h,d){if(!r)return 0;const m=(x,w)=>{for(let T=0;T<r;++T){let C=w[T];if(Vs(C,0,1)){C=ape(C);continue}const M=x.getCoord2D(C);C<.5?M.equals(x.getStartXY())&&zD(x,0,C)<=Em(x)&&(w[T]=0):M.equals(x.getEndXY())&&zD(x,C,1)<=Em(x)&&(w[T]=1)}};m(e,s),m(i,n),e4e(e,i,s,n,r);const f=[];for(let x=0,w=r;x<w;x++)f.push(x);const _=(x,w)=>d?JQ(n[x],s[x],n[w],s[w]):JQ(s[x],n[x],s[w],n[w]);if(f.length>1){f.sort(_);const x=Math.max(Em(e),Em(i));let w=0;for(let T=1,C=f.length;T<C;T++){const M=s[f[w]],A=s[f[T]],I=n[f[w]],L=n[f[T]];if(M!==A||I!==L)if(!(zD(e,M,A)<=x&&zD(i,I,L)<=x)||Vs(M,0,1)&&Vs(I,0,1)||Vs(A,0,1)&&Vs(L,0,1))w++,f[w]=f[T];else{const D=N.distance(e.getCoord2D(M),i.getCoord2D(I)),O=N.distance(e.getCoord2D(A),i.getCoord2D(L));if(D<=O)continue;if(O<D){f[w]=f[T];continue}}}if(f.length=w+1,f.length===1&&f[0]!==0&&(s[0]=s[f[0]],n[0]=n[f[0]],f[0]=0),f.length>2){const T=Me.constructEmpty(),C=Me.constructEmpty();T.setCoords(s[f[0]],s[f.at(-1)]),C.setCoords(n[f[0]],n[f.at(-1)]);let M=!0;for(let A=1,I=f.length-1;A<I;A++)if(!T.containsCoordinate(s[f[A]])||!C.containsCoordinate(n[f[A]])){M=!1;break}if(M){const A=[.5,.2,.7,.1,.3,.4,.6,.8,.9];for(let I=0;I<A.length;I++){let L=es(T.vmin,T.vmax,A[I]);const D=e.getCoord2D(L);if(!i.isCloserThanDistance(D,C,u)){M=!1;break}L=es(C.vmin,C.vmax,A[I]);const O=i.getCoord2D(L);if(!e.isCloserThanDistance(O,T,u)){M=!1;break}}}M&&(f[1]=f.at(-1),f.length=2)}}if(f.length===1&&t&&HC(e,i,s[0],n[0],u,1,[0],[0])&&(f.push(1),s[1]=0,n[1]=0,f.sort(_)),c&&f.length===1){let x=!0;for(let w=0,T=f.length;w<T;w++)if(!(Vs(s[f[w]],0,1)&&Vs(n[f[w]],0,1)&&N.distance(e.getCoord2D(s[f[w]]),i.getCoord2D(n[f[w]]))===0)){x=!1;break}if(x)return 0}let v=0;for(let x=0,w=f.length;x<w;x++){if(a&&a.push(s[f[x]]),l&&l.push(n[f[x]]),o){const T=N.getNAN();e.queryCoord2D(s[f[x]],T),o.push(T)}v++}return v}function GD(t,e,i,s,n,r,o,a,l){if(Vs(i,0,1)&&Vs(s,0,1)&&N.distance(t.getCoord2D(i),e.getCoord2D(s))===0){const c=new Et,h=Number.EPSILON;if(t.queryDerivative(new ge(i,h),c),c.isTrueZero()){const v=i===1?-1e-12:1e-12;t.queryDerivative(new ge(i,h).add(v),c)}i===1&&c.negateThis();const d=new Et;if(e.queryDerivative(new ge(s,h),d),d.isTrueZero()){const v=i===1?-1e-12:1e-12;e.queryDerivative(new ge(s,h).add(v),d)}s===1&&d.negateThis(),c.isZero()||c.normalize(),d.isZero()||d.normalize();const m=c.dotProduct(d),f=c.crossProduct(d);f.scaleError(3);const _=()=>{if(l)return .001;{const v=t.calculateUpperLength2D(),x=e.calculateUpperLength2D();return Math.min(.01*n/Math.min(v,x),1e-10)}};if(m.ge(ZS)&&(f.isZero()||Math.abs(f.value())<_()))return gpe(t,e,i,s,n,r,o,a)}return 0}function iE(t,e,i,s,n){let r=-1,o=-1,a=-1,l=-1;{const u=[0,e],c=[e,0],h=[0,s],d=[s,0];for(let m=0;m<2&&r===-1;++m)for(let f=0;f<2;++f)if(t[u[m]].equals(i[h[f]])){r=u[m],o=c[m],a=h[f],l=d[f];break}}if(r===-1){const u=new ua;u.setFromPoints(t,e+1);const c=new ua;return c.setFromPoints(i,s+1),c.inflate(n),u.isIntersectingW(c)?-1:0}{const u=st(e+1,Number.NaN),c=pee(t,e+1,u);z(c>1);let h=0,d=0;for(let L=0;L<c;++L)r===u[L]&&(d=L,h++),o===u[L]&&h++;if(h!==2)return-1;const m=st(s+1,Number.NaN),f=pee(i,s+1,m);z(f>1),h=0;let _=0;for(let L=0;L<f;++L)a===m[L]&&(_=L,h++),l===m[L]&&h++;if(h!==2)return-1;const v=t[u[(d+c-1)%c]],x=t[u[(d+1)%c]],w=i[m[(_+f-1)%f]],T=i[m[(_+1)%f]],C=t[r],M=[v,x,w,T],A=[0,1,2,3];A.sort((L,D)=>N.compareVectorsOrigin(C,M[L],M[D]));let I=A[0];for(let L=1;L<4;L++){if(A[L]!==(I+1)%4)return-1;I=A[L]}{const L=v.sub(C),D=T.sub(C),O=D.dotProduct(L);if(O>0){const U=D.crossProduct(L),$=Math.abs(Math.atan2(U,O)),B=$*L.length(),V=$*D.length();if(B<=n||V<=n)return-1}}{const L=x.sub(C),D=w.sub(C),O=D.dotProduct(L);if(O>0){const U=D.crossProduct(L),$=Math.abs(Math.atan2(U,O)),B=$*L.length(),V=$*D.length();if(B<=n||V<=n)return-1}}return 1}}var BD=Hs;let mi=class r3 extends _Oe{constructor(e){super(e||{XStart:0,YStart:0,XEnd:0,YEnd:0})}assignMove(e){return this!==e&&(this.m_description=e.m_description,e.m_description=null,this.m_attributes=e.m_attributes,e.m_attributes=null,this.m_XStart=e.m_XStart,e.m_XStart=Number.NaN,this.m_YStart=e.m_YStart,this.m_XEnd=e.m_XEnd,e.m_XEnd=Number.NaN,this.m_YEnd=e.m_YEnd),this}assignCopy(e){return this!==e&&e.copyTo(this),this}calculateLowerLength3D(){return z(0),0}calculateUpperLength3D(){return z(0),0}changeEndPoints3D(e,i){z(0)}getClosestCoordinate3D(e,i,s){return z(0),0}getBoundary(){return pd(this)}getAttributeAsDbl(e,i,s){if(i===0)return s===0?RD(this,e):NU(this,e);const n=BD.getInterpolation(i),r=this.getStartAttributeAsDbl(i,s),o=this.getEndAttributeAsDbl(i,s);return aA(n,r,o,e,BD.getDefaultValue(i))}constructFromCoords(e,i,s,n){this.dropAllAttributes(),this.setStartXYCoords(e,i),this.setEndXYCoords(s,n)}construct(e,i){this.dropAllAttributes(),this.setStartXY(e),this.setEndXY(i)}construct3D(e,i){z(0)}constructPoint(e,i){this.assignVertexDescription(e.getDescription()),this.mergeVertexDescription(i.getDescription()),this.setStart(e),this.setEnd(i)}getGeometryType(){return r3.type}queryEnvelope(e){if(e.m_EnvelopeType===4){e.setEmpty(),e.assignVertexDescription(this.m_description);const i=J.constructEmpty();this.queryEnvelope(i),e.setEnvelope(i);for(let s=1,n=this.m_description.getAttributeCount();s<n;s++){const r=this.m_description.getSemantics(s);for(let o=0,a=BD.getComponentCount(r);s<a;s++){const l=this.queryInterval(r,o);e.setIntervalEnvelope(r,o,l)}}}else e.m_EnvelopeType===2?e.setCoords({xmin:this.m_XStart,ymin:this.m_YStart,xmax:this.m_XEnd,ymax:this.m_YEnd}):e.m_EnvelopeType===3?(e.setEmpty(),e.mergeCoords(this.m_XStart,this.m_YStart,id(this,0,1,0)),e.mergeCoords(this.m_XEnd,this.m_YEnd,id(this,1,1,0))):_i("env type not impl")}applyTransformation(e){z(e instanceof Gi);const i=new N;i.x=this.m_XStart,i.y=this.m_YStart,e.transformInPlace(i),this.m_XStart=i.x,this.m_YStart=i.y,i.x=this.m_XEnd,i.y=this.m_YEnd,e.transformInPlace(i),this.m_XEnd=i.x,this.m_YEnd=i.y}createInstance(){return new r3({vd:this.m_description})}calculateLength2D(){return Math.sqrt(OG(this))}calculateLength3D(e){return z(0),0}changeEndPoints2D(e,i){this.setStartXY(e),this.setEndXY(i),this.normalizeAfterEndpointChange()}queryCoord2D(e,i){return Rl(this,e,i)}queryCoord3D(e,i){z(0)}getCoordZ(e){return yOe(this,e)}queryCoord2DE(e,i){vpe(this,e,i)}getCoordX(e){return RD(this,e)}getCoordY(e){return NU(this,e)}cut(e,i,s){const n=new ii;return this.queryCut(e,i,n,s),n.releaseSegment()}queryCut(e,i,s,n){const r=s.createLine();n&&r.assignVertexDescription(this.m_description);const o=N.getNAN();if(Rl(this,e,o),r.setStartXYCoords(o.x,o.y),Rl(this,i,o),r.setEndXYCoords(o.x,o.y),!n)for(let a=1,l=this.m_description.getAttributeCount();a<l;a++){const u=this.m_description.getSemantics(a),c=BD.getComponentCount(u);for(let h=0;h<c;h++){const d=this.getAttributeAsDbl(e,u,h);r.setStartAttribute(u,h,d);const m=this.getAttributeAsDbl(i,u,h);r.setEndAttribute(u,h,m)}}}queryDerivative(e,i){vOe(this,e,i)}getClosestCoordinate(e,i){return N.getClosestCoordinate(this.getStartXY(),this.getEndXY(),e,i)}getClosestCoordinateOnInterval(e,i,s=-1){const n=new N;this.queryCoord2D(i.vmin,n);const r=new N;this.queryCoord2D(i.vmax,r);const o=N.getClosestCoordinate(n,r,e,!1);return dA.recalculateParentT(i.vmin,i.vmax,o)}intersectionOfYMonotonicWithAxisX(e,i){const s=this.m_YEnd-this.m_YStart;if(!s)return e===this.m_YEnd?i:Number.NaN;const n=(e-this.m_YStart)/s;let r=RD(this,n);return n===1&&(r=this.m_XEnd),r}isCurve(){return!1}isMonotoneQuickAndDirty(){return!0}isDegenerate(e){const i=this.m_XStart-this.m_XEnd,s=this.m_YStart-this.m_YEnd;return Math.sqrt(i*i+s*s)<=e}isDegenerate3D(e,i){return z(0),!1}queryLooseEnvelope(e){this.queryEnvelope(e)}clone(e){const i=new r3;return this.copyTo(i),i}tToLength(e){return e*this.calculateLength2D()}lengthToT(e){const i=this.calculateLength2D();return i!==0?e/i:0}calculateWeightedAreaCentroid2D(e){const i=new N;return i.setCoords(0,0),i}calculateWeightedCentroid2D(){return this.getCoord2D(.5).mul(this.calculateLength2D())}getTangent(e){const i=N.getNAN();return i.setSub(this.getEndXY(),this.getStartXY()),i}getDerivative(e){const i=new N;return i.setSub(this.getEndXY(),this.getStartXY()),i}getCurvature(e){return 0}isIntersectingPoint(e,i,s){return cw(this,e,i,s)>=0}isIntersectingPoint3D(e,i,s,n,r=1){return z(0),!1}getYMonotonicParts(e,i){return 0}getMonotonicParts(e,i){return 0}getMonotonicPartParams(e,i){return i&&(e<2&&ce(""),i[0]=0,i[1]=1),2}intersectionWithAxis2D(e,i,s,n){if(e){const r=this.m_YEnd-this.m_YStart;if(!r)return i===this.m_YEnd?-1:0;const o=(i-this.m_YStart)/r;return o<0||o>1?0:(s&&(s[0]=RD(this,o)),n&&(n[0]=o),1)}{const r=this.m_XEnd-this.m_XStart;if(!r)return i===this.m_XEnd?-1:0;const o=(i-this.m_XStart)/r;return o<0||o>1?0:(s&&(s[0]=NU(this,o)),n&&(n[0]=o),1)}}calculateUpperLength2D(){return this.calculateLength2D()}calculateLowerLength2D(){return this.calculateLength2D()}normalizeAfterEndpointChange(){return!1}queryLooseEnvelopeOnInterval(e,i){if(i.m_EnvelopeType===2){let s=Os(e.vmin,0,1);const n=new N;return this.queryCoord2D(s,n),i.setCoords({pt:n}),s=Os(e.vmax,0,1),this.queryCoord2D(s,n),void i.mergeNe(n)}_i("3d dst not impl")}orientBottomUp(){xpe(this)}isLine(){return!0}isDegenerateToLineHelper(e){return!0}copyIgnoreAttributes(e){e.setStartXY(this.getStartXY()),e.setEndXY(this.getEndXY()),e.normalizeAfterEndpointChange()}calculateArea2DHelper(){return 0}absNormXYZ(e){return xOe(this,e)}absNorm(){return this.getStartXY().norm(1)+this.getEndXY().norm(1)}queryEnvelopeW(e,i){i.setCoords(this.getCoord2D(e.vmin)),i.mergeNe(this.getCoord2D(e.vmax))}setSegmentFromCoords(e,i){yJ(this,e[0],e[i-1])}writeInBufferStream(e,i){return z(0),0}readFromBufferStream(e,i){z(0)}snapControlPoints(e){return!1}needsSnapControlPoints(e){return!1}calculateSpecialPointsForCracking(e,i){return 0}ensureXYMonotone(){return!1}setCoordsForIntersector(e,i,s){yJ(this,e,i)}static isIntersectingLineLine(e,i,s,n){return RG(e,i,s,n)}static isIntersectingLineLine_(e,i,s,n){return RG(e,i,s,n)}copyToImpl(e){}reverseImpl(){}equalsImpl(e){return!0}equalsImplTol(e,i){return!0}swapImpl(e){}afterCompletedModification(){}endPointModified(){}clearEndPointModified(){}intersect(e,i,s,n,r){return q1(!1,this,e,i,s,n,r)}intersectPoint(e,i,s){i.length<1&&bi("");const n=cw(this,e,s,!1);return n>=0?(i&&(i[0]=n),1):0}isIntersecting(e,i,s){return tE(!1,this,e,i,s)!==0}};mi.type=q.enumLine;let ii=class o3{constructor(e){this.m_seg=null,this.m_curves=null,this.m_lineBuffer=new mi,this.m_mask=0,this.m_active=0,e!==void 0&&(e.copy?e.copy.copyTo(this,!1):e.move?this.assignMove(e.move):e.segment?this.copyFrom(e.segment,!!e.bIgnoreAttributes):We("bad constructor params"))}assignCopy(e){return e instanceof o3?this!==e&&e.copyTo(this,!1):this.copyFrom(e,!1),this}assignMove(e){if(e instanceof o3){if(this===e)return this;this.reset(),1&e.m_mask&&(this.m_lineBuffer=e.m_lineBuffer,e.m_lineBuffer=null,this.m_mask=1),this.m_curves=e.m_curves,this.m_mask=e.m_mask,this.m_active=e.m_active,e.reset(),this.m_seg=this.activeSegment(),e.m_seg=null}else{if(this.m_seg===e)return this;this.create(e.getGeometryType()),this.m_seg.swap(e)}return this}activeSegment(){switch(this.m_active){case 0:return null;case 1:return this.line();case 2:return this.arc();case 4:return this.bezier3();case 8:return this.bezier2();case 16:return this.rbezier2();default:We("")}}get(){return this.m_seg}reset(){1&this.m_mask&&(this.m_lineBuffer=null),this.m_mask>1&&(this.m_curves=null),this.m_mask=0,this.m_active=0}empty(){return this.m_seg===null}copyTo(e,i){this!==e&&(this.empty()?e.m_seg=null:e.copyFrom(this.m_seg,i))}copyToWithZ(e,i){z(0)}createImpl(e){switch(e){case q.enumLine:1&this.m_mask||(this.m_lineBuffer=new mi,this.m_mask|=1,this.m_active=1);break;case q.enumEllipticArc:2&this.m_mask||(this.m_curves=new Ed,this.m_mask=1&this.m_mask|2,this.m_active=2);break;case q.enumBezier:4&this.m_mask||(this.m_curves=new hc,this.m_mask=1&this.m_mask|4,this.m_active=4);break;case q.enumBezier2:8&this.m_mask||(this.m_curves=new v1,this.m_mask=1&this.m_mask|8,this.m_active=8);break;case q.enumRationalBezier2:16&this.m_mask||(this.m_curves=new il,this.m_mask=1&this.m_mask|16,this.m_active=16);break;default:ce("")}}create(e){e===q.enumLine?this.createLine():e===q.enumEllipticArc?this.createEllipticArc():e===q.enumBezier?this.createCubicBezier():e===q.enumRationalBezier2?this.createQuadraticRationalBezier():e===q.enumBezier2?this.createQuadraticBezier():ce("Segment_buffer.create")}copyFrom(e,i){this.m_seg!==e&&(this.create(e.getGeometryType()),i?e.copyIgnoreAttributes(this.m_seg):e.copyTo(this.m_seg))}copyFromWithZ(e,i){z(0)}line(){return this.m_lineBuffer}arc(){return this.m_curves}bezier3(){return this.m_curves}bezier2(){return this.m_curves}rbezier2(){return this.m_curves}createLine(){return this.createImpl(q.enumLine),this.m_seg=this.line(),this.line()}createEllipticArc(){return this.createImpl(q.enumEllipticArc),this.m_seg=this.arc(),this.arc()}createCubicBezier(){return this.createImpl(q.enumBezier),this.m_seg=this.bezier3(),this.bezier3()}createQuadraticRationalBezier(){return this.createImpl(q.enumRationalBezier2),this.m_seg=this.rbezier2(),this.rbezier2()}createQuadraticBezier(){return this.createImpl(q.enumBezier2),this.m_seg=this.bezier2(),this.bezier2()}releaseSegment(){if(this.m_seg=null,this.m_active===0&&We("releaseSegment"),1&this.m_active){const i=this.line();return this.m_mask-=1,this.m_active=0,this.m_lineBuffer=null,i}let e;return 2&this.m_active?e=this.arc():4&this.m_active?e=this.bezier3():8&this.m_active?e=this.bezier2():16&this.m_active?e=this.rbezier2():We("releaseSegment"),this.m_mask-=this.m_active,this.m_active=0,this.m_curves=null,e}equals(e){return e instanceof o3?this===e||(this.empty()?e.empty():!e.empty()&&this.get().equals(e.get())):(_i("seg comparison not yet impl"),!1)}};function Is(t,e,i,s,n){return yfe(t,e,null,i,s,n)}function yfe(t,e,i,s,n,r){const o=t.getGeometryType();if(o===q.enumPoint){const c=t.getXY();return e.contains(c)?t:t.createInstance()}if(o===q.enumEnvelope){const c=J.constructEmpty();if(t.queryEnvelope(c),c.intersect(e)){const h=t.clone();return h.setEnvelope(c),h}return t.createInstance()}if(t.isEmpty())return t;if(e.isEmpty())return t.createInstance();const a=e.clone();{const c=new J;if(t.queryLooseEnvelope(c),a.containsEnvelope(c))return t;if(!a.isIntersecting(c))return t.createInstance();n===0&&(c.intersect(a),c.inflate(Math.max(.1*c.maxDimension(),1)),c.intersect(a),a.assign(c))}let l=s;if((i!==null||Number.isNaN(l))&&(l=yr(i,a,!1).total()),o===q.enumGeometryCollection){const c=t,h=t.createInstance();for(let d=0,m=c.getGeometryCount();d<m;d++){const f=c.getGeometry(d);if(f.isEmpty())continue;const _=Is(f,a,l,n,r);_.isEmpty()||(_===f?h.addGeometry(_.clone()):h.addGeometry(_))}return h}ll(o)||ce("Clip: geometry not supported");const u=t.getImpl().getAccelerators();if(u!==null){const c=u.getRasterizedGeometry();z(c===null)}switch(o){case q.enumMultiPoint:{const c=t;let h;const d=c.getPointCount(),m=c.getImpl().getAttributeStreamRef(0);let f=0;for(let _=0;_<d;_++){const v=m.readPoint2D(2*_);a.contains(v)||(f===0&&(h=c.createInstance()),f<_&&h.addPoints(c,f,_),f=_+1)}return f>0&&h.addPoints(c,f,d),f===0?c:(z(h!==null),h)}case q.enumPolygon:case q.enumPolyline:return i4e(t,a,l,n,r);default:We("")}}function t4e(t,e,i,s,n,r){const o=new vfe(e,r),a=new J;return t.queryLooseEnvelope(a),e.containsEnvelope(a)?t:e.isIntersecting(a)?o.clipPolesOut(t,n):t.createInstance()}function i4e(t,e,i,s,n){return new vfe(e,n).clipMultiPath2(t,i,s)}let vfe=class Gh{constructor(e,i){this.m_shape=new wn,this.m_geometry=G,this.m_verticesOnExtentIndex=-1,this.m_verticesOnExtent=[],this.m_progressCounter=0,this.m_extent=new J(e),this.m_progressTracker=i}progress_(){}clipMultiPath2(e,i,s){return e.getGeometryType()===q.enumPolygon?this.clipPolygonOrProjectedPolyline2(e,s):this.clipPolyline(e,i)}clipPolygonOrProjectedPolyline2(e,i){const s=e.getGeometryType()===q.enumPolyline;if(this.m_extent.width()===0||this.m_extent.height()===0)return e.createInstance();const n=J.constructEmpty();e.queryLooseEnvelope(n),this.m_geometry=s?this.m_shape.addGeometry(e):this.m_shape.addGeometry(e,this.m_extent);const r=J.constructEmpty(),o=J.constructEmpty(),a=new N,l=new N,u=st(9,Number.NaN),c=st(9,Number.NaN),h=he(N,9);let d=null;const m=new mi,f=[];let _=!1;for(let x=0;!_&&x<4;x++){let w=!1;const T=!!(1&x);let C=0;switch(x){case 0:C=this.m_extent.xmin,w=n.xmin<=C&&n.xmax>=C;break;case 1:C=this.m_extent.ymin,w=n.ymin<=C&&n.ymax>=C;break;case 2:C=this.m_extent.xmax,w=n.xmin<=C&&n.xmax>=C;break;case 3:C=this.m_extent.ymax,w=n.ymin<=C&&n.ymax>=C}if(w){_=!0;for(let M=this.m_shape.getFirstPath(this.m_geometry);M!==G;){let A=!0,I=-1,L=-1;const D=this.m_shape.getFirstVertex(M);let O=D;do{this.progress_(),d=this.m_shape.getSegment(O);let U=d;if(U===null){const H=this.m_shape.getNextVertex(O);if(H===G){z(s),I===0&&f.push(O);break}this.m_shape.queryXY(O,a),m.setStartXY(a),this.m_shape.queryXY(H,l),m.setEndXY(l),U=m}U.queryLooseEnvelope(r);let $=Gh.checkSegmentIntersection(r,x,C);U.isCurve()&&$===0&&U.isCurve()&&(m.setStartXY(U.getStartXY()),m.setEndXY(U.getEndXY()),this.m_shape.replaceCurveWithLine(O),U=m,m.queryEnvelope(r),$=Gh.checkSegmentIntersection(r,x,C));let B=0,V=G;if($===-1){const H=U.intersectionWithAxis2D(T,C,u,c);if(H>0){let ee=null;if(U.isCurve()){ee=h,z(H<=9);for(let ne=0;ne<H;ne++)T?h[ne].setCoords(u[ne],C):h[ne].setCoords(C,u[ne]);B=this.m_shape.splitSegmentAxisAware(O,c,H,ee,T?1:0)}else B=this.m_shape.splitSegmentAxisAware(O,c,H,null,-1)}else B=0;B+=1;let Y=O,W=this.m_shape.getNextVertex(Y);U=null;for(let ee=0;ee<B;ee++){this.m_shape.queryXY(Y,a),this.m_shape.queryXY(W,l),d=this.m_shape.getSegment(Y);let ne=d;ne===null&&(m.setStartXY(a),m.setEndXY(l),ne=m),ne.queryEnvelope(o);let j=Gh.checkSegmentIntersection(o,x,C);ne.isCurve()&&j===0&&(this.m_shape.replaceCurveWithLine(Y),m.setStartXY(a),m.setEndXY(l),ne=m,ne.queryEnvelope(o),j=Gh.checkSegmentIntersection(o,x,C)),j===-1&&(T?Math.abs(a.y-C)<Math.abs(l.y-C)?(a.y=C,this.m_shape.setXY(Y,a)):(l.y=C,this.m_shape.setXY(W,l)):Math.abs(a.x-C)<Math.abs(l.x-C)?(a.x=C,this.m_shape.setXY(Y,a)):(l.x=C,this.m_shape.setXY(W,l)),d=this.m_shape.getSegment(Y),ne=d,ne===null&&(m.setStartXY(a),m.setEndXY(l),ne=m),ne.queryEnvelope(o),j=Gh.checkSegmentIntersection(o,x,C),j===-1&&(j=Gh.checkSegmentIntersectionLoose(o,x,C)));const oe=I;I=j,L===-1&&(L=I),oe===0&&I===1||oe===1&&I===0||oe===0&&I===0&&f.push(Y),I===1&&(_=!1,A=!1),Y=W,V=Y,W=this.m_shape.getNextVertex(W)}}if(B===0){const H=I;I=$,L===-1&&(L=I),H===0&&I>=1||H>=1&&I===0||H===0&&I===0&&f.push(O),I===1&&(_=!1,A=!1),V=this.m_shape.getNextVertex(O)}if(O=V,f.length>=256){for(let H=1,Y=f.length-1;H<Y;H++){const W=f[H];s?this.m_shape.snapVertexForPoleClipping(W,C):this.m_shape.removeVertex(W,!1)}f[1]=f.at(-1),f.length=2}}while(O!==D);if(!A){L!==0||!s&&I!==0&&I!==2||f.push(D);for(let U=0,$=f.length;U<$;U++){const B=f[U];s?this.m_shape.snapVertexForPoleClipping(B,C):this.m_shape.removeVertex(B,!1)}}f.length=0,M=A||this.m_shape.getPathSize(M)===0?this.m_shape.removePath(M):this.m_shape.getNextPath(M)}}}if(_)return e.createInstance();d=null,s?this.removeSpikesAlongPoles():this.resolveBoundaryOverlaps(),i>0&&this.densifyAlongClipExtent(i);const v=this.m_shape.getGeometry(this.m_geometry);return v.getGeometryType()===q.enumPolygon&&v.setFillRule(e.getFillRule()),v}clipPolyline(e,i){const s=J.constructEmpty(),n=J.constructEmpty(),r=st(9,Number.NaN),o=st(9,Number.NaN),a=new ii;let l=e;const u=J.constructEmpty();e.queryLooseEnvelope(u);for(let c=0;c<4;c++){let h=!1;const d=!!(1&c);let m=0;switch(c){case 0:m=this.m_extent.xmin,h=u.xmin<=m&&u.xmax>=m;break;case 1:m=this.m_extent.ymin,h=u.ymin<=m&&u.ymax>=m;break;case 2:m=this.m_extent.xmax,h=u.xmin<=m&&u.xmax>=m;break;case 3:m=this.m_extent.ymax,h=u.ymin<=m&&u.ymax>=m}if(!h)continue;const f=l;l=e.createInstance();const _=f.getImpl().querySegmentIterator();_.resetToFirstPath();const v=new N,x=new N;for(;_.nextPath();){let w=-1,T=!0;for(;_.hasNextSegment();){this.progress_();const C=_.nextSegment(),M=C.isDegenerate(0);C.queryLooseEnvelope(s);const A=Gh.checkSegmentIntersection(s,c,m);if(A===-1){const I=C.intersectionWithAxis2D(d,m,r,o);let L=0;v.assign(C.getStartXY());for(let D=0;D<=I;D++){const O=D<I?o[D]:1;if(L===O)continue;C.queryCut(L,O,a,!1);const U=a.get();let $=!1;if(U.getStartXY().equals(v)||(U.setStartXY(v),$=!0),D<I&&(d?(x.x=r[D],x.y=m):(x.x=m,x.y=r[D]),U.getEndXY().equals(x)||(U.setEndXY(x),$=!0)),$&&U.normalizeAfterEndpointChange(),!M&&U.isDegenerate(0))continue;U.queryEnvelope(n);let B=Gh.checkSegmentIntersection(n,c,m);if(B===-1){const V=U.getStartXY(),H=U.getEndXY();$=!1,d?Math.abs(V.y-m)<Math.abs(H.y-m)?(V.y=m,U.setStartXY(V),V.equals(U.getStartXY())||(U.setStartXY(V),$=!0)):(H.y=m,H.equals(U.getEndXY())||(U.setEndXY(H),$=!0)):Math.abs(V.x-m)<Math.abs(H.x-m)?(V.x=m,V.equals(U.getStartXY())||(U.setStartXY(V),$=!0)):(H.x=m,H.equals(U.getEndXY())||(U.setEndXY(H),$=!0)),$&&U.normalizeAfterEndpointChange(),U.queryEnvelope(n),B=Gh.checkSegmentIntersection(n,c,m),B===-1&&(B=Gh.checkSegmentIntersectionLoose(n,c,m))}v.assign(U.getEndXY()),L=O,w=B,w>=1?(l.addSegment(U,T),T=!1):T=!0}}else w=A,w>=1?(l.addSegment(C,T),T=!1):T=!0}}}return l}static checkSegmentIntersection(e,i,s){switch(i){case 0:return e.xmin<s&&e.xmax<=s?0:e.xmin>=s?e.xmax===s?2:1:-1;case 1:return e.ymin<s&&e.ymax<=s?0:e.ymin>=s?e.ymax===s?2:1:-1;case 2:return e.xmin>=s&&e.xmax>s?0:e.xmax<=s?e.xmin===s?2:1:-1;case 3:return e.ymin>=s&&e.ymax>s?0:e.ymax<=s?e.ymin===s?2:1:-1}return We(""),0}static checkSegmentIntersectionLoose(e,i,s){switch(i){case 0:{const n=Math.abs(e.xmin-s),r=Math.abs(e.xmax-s);return e.xmin<s?n>r?0:1:(We(""),1)}case 1:{const n=Math.abs(e.ymin-s),r=Math.abs(e.ymax-s);return e.ymin<s?n>r?0:1:(We(""),1)}case 2:{const n=Math.abs(e.xmin-s),r=Math.abs(e.xmax-s);return e.xmax>s?n<r?0:1:(We(""),1)}case 3:{const n=Math.abs(e.ymin-s),r=Math.abs(e.ymax-s);return e.ymax>s?n<r?0:1:(We(""),1)}}return We(""),0}resolveBoundaryOverlaps(){this.m_verticesOnExtentIndex=-1,this.splitSegments(!1,this.m_extent.xmin),this.splitSegments(!1,this.m_extent.xmax),this.splitSegments(!0,this.m_extent.ymin),this.splitSegments(!0,this.m_extent.ymax),this.m_verticesOnExtent.length=0,this.m_verticesOnExtentIndex=this.m_shape.createUserIndex();const e=new N;for(let i=this.m_shape.getFirstPath(this.m_geometry);i!==G;i=this.m_shape.getNextPath(i)){let s=this.m_shape.getFirstVertex(i);for(let n=0,r=this.m_shape.getPathSize(i);n<r;n++,s=this.m_shape.getNextVertex(s))this.progress_(),this.m_shape.queryXY(s,e),this.m_extent.xmin!==e.x&&this.m_extent.xmax!==e.x&&this.m_extent.ymin!==e.y&&this.m_extent.ymax!==e.y||(this.m_shape.setUserIndex(s,this.m_verticesOnExtentIndex,this.m_verticesOnExtent.length),this.m_verticesOnExtent.push(s))}this.dbgCheckPathFirst(),this.resolveOverlaps(!1,this.m_extent.xmin),this.dbgCheckPathFirst(),this.resolveOverlaps(!1,this.m_extent.xmax),this.dbgCheckPathFirst(),this.resolveOverlaps(!0,this.m_extent.ymin),this.dbgCheckPathFirst(),this.resolveOverlaps(!0,this.m_extent.ymax),this.fixPaths()}densifyAlongClipExtent(e){const i=new N(0,0),s=new N(0,0),n=st(2048,Number.NaN);for(let r=this.m_shape.getFirstPath(this.m_geometry);r!==G;r=this.m_shape.getNextPath(r)){const o=this.m_shape.getFirstVertex(r);let a=o;do{const l=this.m_shape.getNextVertex(a);this.m_shape.queryXY(a,i);let u=-1;if(i.x===this.m_extent.xmin?(this.m_shape.queryXY(l,s),s.x===this.m_extent.xmin&&(u=1)):i.x===this.m_extent.xmax&&(this.m_shape.queryXY(l,s),s.x===this.m_extent.xmax&&(u=1)),i.y===this.m_extent.ymin?(this.m_shape.queryXY(l,s),s.y===this.m_extent.ymin&&(u=0)):i.y===this.m_extent.ymax&&(this.m_shape.queryXY(l,s),s.y===this.m_extent.ymax&&(u=0)),u===-1){a=l;continue}if(this.isCurve(a)){a=l;continue}const c=i.clone(),h=new N(0,0);if(u){const f=i.y-this.m_extent.ymin;h.y=In(s.y-i.y),c.y=e*kf(Math.floor(Math.abs(f)/e),f)+this.m_extent.ymin,h.y<0&&(c.y+=e)}else{const f=i.x-this.m_extent.xmin;h.x=In(s.x-i.x),c.x=e*kf(Math.floor(Math.abs(f)/e),f)+this.m_extent.xmin,h.x<0&&(c.x+=e)}const d=u?s.y-i.y:s.x-i.x,m=Math.abs(d);if(m/e>65536&&We(""),m>0){const f=Math.trunc(m/e)+2;n.length<f&&(n.length=f);let _=0;for(let v=0;;v++){const x=c.add(h.mul(v*e)),w=(u?x.y-i.y:x.x-i.x)/d;if(w>=1)break;w<=0||(z(_<=n.length),n[_]=w,_++)}_!==0&&this.m_shape.splitSegment(a,n,_)}a=l}while(a!==o)}}splitSegments(e,i){let s=-1;const n=new N,r=[];for(let f=this.m_shape.getFirstPath(this.m_geometry);f!==G;f=this.m_shape.getNextPath(f)){let _=this.m_shape.getFirstVertex(f),v=G;for(let x=0,w=this.m_shape.getPathSize(f);x<w;x++,_=v)if(this.progress_(),v=this.m_shape.getNextVertex(_),this.m_shape.queryXY(_,n),(e?n.y===i:n.x===i)&&(this.m_shape.queryXY(v,n),e?n.y===i:n.x===i)){if(this.isCurve(_))continue;s===-1&&(s=this.m_shape.createUserIndex()),this.m_shape.getUserIndex(_,s)!==1&&(r.push(_),this.m_shape.setUserIndex(_,s,1)),this.m_shape.getUserIndex(v,s)!==1&&(r.push(v),this.m_shape.setUserIndex(v,s,1))}}if(s!==-1&&this.m_shape.removeUserIndex(s),r.length<3)return;r.sort((f,_)=>this.compareVertices(f,_));const o=new N,a=new N,l=new N;a.setNAN();let u=-1,c=[],h=[];const d=this.m_shape.createUserIndex(),m=this.m_shape.createUserIndex();for(let f=0,_=r.length;f<_;f++){const v=r[f];if(this.m_shape.queryXY(v,n),!n.isEqualPoint2D(a)){if(u===-1){u=f,a.setCoordsPoint2D(n);continue}for(let w=u;w<f;w++){const T=r[w],C=this.m_shape.getNextVertex(T),M=this.m_shape.getPrevVertex(T);let A=!1;this.m_shape.queryXY(C,o),a.compare(o)<0&&(e?o.y===i:o.x===i)&&(this.isCurve(T)||(c.push(T),A=!0,this.m_shape.setUserIndex(T,m,1))),this.m_shape.queryXY(M,o),a.compare(o)<0&&(e?o.y===i:o.x===i)&&(this.isCurve(M)||(A||c.push(T),this.m_shape.setUserIndex(T,d,1)))}for(let w=0,T=c.length;w<T;w++){const C=c[w],M=this.m_shape.getUserIndex(C,d),A=this.m_shape.getUserIndex(C,m);if(M===1){const I=this.m_shape.getPrevVertex(C);this.m_shape.queryXY(I,l);let L=0;if(!l.isEqualPoint2D(n)){const D=N.distance(a,l);L=N.distance(l,n)/D,L===0?L=Number.EPSILON:L===1&&(L=1-Number.EPSILON),this.m_shape.splitSegment(I,[L],1);const O=this.m_shape.getPrevVertex(C);this.m_shape.setXY(O,n),h.push(O),this.m_shape.setUserIndex(O,d,1),this.m_shape.setUserIndex(O,m,-1)}}if(A===1){const I=this.m_shape.getNextVertex(C);this.m_shape.queryXY(I,l);let L=0;if(!l.isEqualPoint2D(n)){const D=N.distance(a,l);L=N.distance(a,n)/D,L===0?L=Number.EPSILON:L===1&&(L=1-Number.EPSILON),this.m_shape.splitSegment(C,[L],1);const O=this.m_shape.getNextVertex(C);this.m_shape.setXY(O,n),h.push(O),this.m_shape.setUserIndex(O,d,-1),this.m_shape.setUserIndex(O,m,1)}}}const x=c;c=h,h=x,h.length=0,u=f,a.setCoordsPoint2D(n)}}this.m_shape.removeUserIndex(d),this.m_shape.removeUserIndex(m)}resolveOverlaps(e,i){const s=new N,n=[];let r=-1;for(let u=0,c=this.m_verticesOnExtent.length;u<c;u++){this.progress_();const h=this.m_verticesOnExtent[u];if(h===G)continue;const d=this.m_shape.getNextVertex(h);if(this.m_shape.queryXY(h,s),(e?s.y===i:s.x===i)&&(this.m_shape.queryXY(d,s),e?s.y===i:s.x===i)){if(this.isCurve(h))continue;r===-1&&(r=this.m_shape.createUserIndex()),this.m_shape.getUserIndex(h,r)!==-2&&(n.push(h),this.m_shape.setUserIndex(h,r,-2)),this.m_shape.getUserIndex(d,r)!==-2&&(n.push(d),this.m_shape.setUserIndex(d,r,-2))}}if(n.length===0)return void(r!==-1&&this.m_shape.removeUserIndex(r));z(r!==-1),n.sort((u,c)=>this.compareVertices(u,c));for(let u=0,c=n.length;u<c;u++){const h=n[u];this.m_shape.setUserIndex(h,r,u)}const o=new N,a=new N;a.setNAN();let l=-1;for(let u=0,c=n.length;u<c;u++){this.progress_();const h=n[u];if(h!==G&&(this.m_shape.queryXY(h,s),!s.isEqualPoint2D(a))){if(l!==-1)for(;;){let d=!1;const m=u;for(let f=l;f<m;f++){const _=n[f];if(_===G)continue;let v=G;const x=this.m_shape.getNextVertex(_);this.m_shape.queryXY(x,o),a.compare(o)<0&&(e?o.y===i:o.x===i)&&(this.isCurve(_)||(v=x));let w=G;const T=this.m_shape.getPrevVertex(_);if(this.m_shape.queryXY(T,o),a.compare(o)<0&&(e?o.y===i:o.x===i)&&(this.isCurve(T)||(w=T)),v===G||w===G){if(v!==G||w!==G){for(let C=f+1;C<u;C++){const M=n[C];if(M===G)continue;const A=this.m_shape.getNextVertex(M);let I=G;this.m_shape.queryXY(A,o),a.compare(o)<0&&(e?o.y===i:o.x===i)&&(this.isCurve(M)||(I=A));const L=this.m_shape.getPrevVertex(M);let D=G;if(this.m_shape.queryXY(L,o),a.compare(o)<0&&(e?o.y===i:o.x===i)&&(this.isCurve(L)||(D=L)),I!==G&&D!==G){this.beforeRemoveVertex(M,n,r),this.m_shape.removeVertex(M,!1),this.beforeRemoveVertex(I,n,r),this.m_shape.removeVertex(I,!1),d=!0;break}if(v!==G&&D!==G){this.removeOverlap(n,_,v,M,D,r),d=!0;break}if(w!==G&&I!==G){this.removeOverlap(n,M,I,_,w,r),d=!0;break}}if(d)break}}else this.beforeRemoveVertex(_,n,r),this.m_shape.removeVertex(_,!1),this.beforeRemoveVertex(v,n,r),this.m_shape.removeVertex(v,!1),d=!0}if(!d)break}l=u,a.setCoordsPoint2D(s)}}this.m_shape.removeUserIndex(r)}beforeRemoveVertex(e,i,s){let n=this.m_shape.getUserIndex(e,s);z(n>=0),i[n]=G,n=this.m_shape.getUserIndex(e,this.m_verticesOnExtentIndex),z(n>=0),this.m_verticesOnExtent[n]=G;const r=this.m_shape.getPathFromVertex(e);r!==G&&this.m_shape.getFirstVertex(r)===e&&(this.m_shape.setFirstVertex(r,G),this.m_shape.setLastVertex(r,G))}removeOverlap(e,i,s,n,r,o){this.m_shape.setNextVertex(i,n),this.m_shape.setPrevVertex(n,i),this.m_shape.setPrevVertex(s,r),this.m_shape.setNextVertex(r,s),this.beforeRemoveVertex(n,e,o),this.m_shape.removeVertexInternal(n,!1),this.beforeRemoveVertex(r,e,o),this.m_shape.removeVertexInternal(r,!0)}removeSpikesAlongPoles(){this.removeSpikesOnPole(this.m_extent.ymin),this.removeSpikesOnPole(this.m_extent.ymax)}removeSpikesOnPole(e){for(let i=this.m_shape.getFirstPath(this.m_geometry);i!==G;i=this.m_shape.getNextPath(i)){const s=this.m_shape.getPathSize(i);if(s<3)continue;let n=this.m_shape.getFirstVertex(i);const r=new N;this.m_shape.queryXY(n,r);let o=r.y===e&&!this.isCurve(n);n=this.m_shape.getNextVertex(n);const a=new N;this.m_shape.queryXY(n,a);let l=a.y===e&&!this.isCurve(n);n=this.m_shape.getNextVertex(n);const u=new N;for(let c=0,h=s-2;c<h;c++,n=this.m_shape.getNextVertex(n)){this.progress_(),this.m_shape.queryXY(n,u);const d=u.y===e;if(l&&o&&d&&(a.x-r.x)*(u.x-a.x)<=0){this.m_shape.removeVertex(this.m_shape.getPrevVertex(n),!1),a.setCoordsPoint2D(u),l=d&&!this.isCurve(n);continue}r.setCoordsPoint2D(a),o=l,a.setCoordsPoint2D(u),l=d&&!this.isCurve(n)}}}fixPaths(){for(let r=0,o=this.m_verticesOnExtent.length;r<o;r++){const a=this.m_verticesOnExtent[r];a!==G&&this.m_shape.setPathToVertex(a,G)}const e=this.m_shape.hasCurves();let i=0,s=0;for(let r=this.m_shape.getFirstPath(this.m_geometry);r!==G;){const o=this.m_shape.getFirstVertex(r);if(o===G||r!==this.m_shape.getPathFromVertex(o)){const u=r;r=this.m_shape.getNextPath(r),this.m_shape.setFirstVertex(u,G),this.m_shape.removePathOnly(u);continue}let a=o,l=0;do this.m_shape.setPathToVertex(a,r),l++,a=this.m_shape.getNextVertex(a);while(a!==o);this.m_shape.setRingAreaValid(r,!1),this.m_shape.setLastVertex(r,this.m_shape.getPrevVertex(o)),this.m_shape.setPathSize(r,l),s+=l,i++,r=this.m_shape.getNextPath(r)}for(let r=0,o=this.m_verticesOnExtent.length;r<o;r++){let a=this.m_verticesOnExtent[r];if(a===G)continue;let l=this.m_shape.getPathFromVertex(a);if(l!==G)continue;l=this.m_shape.insertPath(this.m_geometry,G);let u=!1,c=0;const h=a;do this.m_shape.setPathToVertex(a,l),c++,e&&c<=2&&(u||(u=this.isCurve(a))),a=this.m_shape.getNextVertex(a);while(a!==h);if(u?c===0:c<=2){let d=this.m_shape.getUserIndex(h,this.m_verticesOnExtentIndex);z(d>=0),this.m_verticesOnExtent[d]=G;const m=this.m_shape.removeVertex(h,!1);c===2&&(d=this.m_shape.getUserIndex(m,this.m_verticesOnExtentIndex),d>=0&&(this.m_verticesOnExtent[d]=G),this.m_shape.removeVertex(m,!1));const f=l;l=this.m_shape.getNextPath(l),this.m_shape.setFirstVertex(f,G),this.m_shape.removePathOnly(f)}else this.m_shape.setClosedPath(l,!0),this.m_shape.setPathSize(l,c),this.m_shape.setFirstVertex(l,h),this.m_shape.setLastVertex(l,this.m_shape.getPrevVertex(h)),this.m_shape.setRingAreaValid(l,!1),s+=c,i++}this.m_shape.setGeometryPathCount(this.m_geometry,i),this.m_shape.setGeometryVertexCount(this.m_geometry,s);let n=0;for(let r=this.m_shape.getFirstGeometry();r!==G;r=this.m_shape.getNextGeometry(r))n+=this.m_shape.getPointCount(r);this.m_shape.setTotalPointCount(n)}dbgCheckPathFirst(){}isCurve(e){return this.m_shape.getSegment(e)!==null}compareVertices(e,i){const s=new N;this.m_shape.queryXY(e,s);const n=new N;return this.m_shape.queryXY(i,n),s.compare(n)}clipPolesOut(e,i){return this.clipPolygonOrProjectedPolyline2(e,i)}},_S=class{getOperatorType(){return 10004}supportsCurves(){return!0}accelerateGeometry(e,i,s){return!1}canAccelerateGeometry(e){return!1}executeMany(e,i,s,n){return new s4e(e,i,s,n)}execute(e,i,s,n){return n4e(e,i,s,n)}},s4e=class extends Pd{constructor(e,i,s,n){super(),this.m_progressTracker=n,this.m_index=-1,e||ce(""),this.m_envelope=i,this.m_inputGeometryCursor=e,this.m_spatialRefImpl=s,this.m_tolerance=yr(s,i,!1).total()}next(){let e;return(e=this.m_inputGeometryCursor.next())?(Um(e),this.m_index=this.m_inputGeometryCursor.getGeometryID(),Is(e,this.m_envelope,this.m_tolerance,0,this.m_progressTracker)):null}getGeometryID(){return this.m_index}tock(){return!0}getRank(){return 1}};function n4e(t,e,i,s){return yfe(t,e,i,Number.NaN,0,s)}var r4e=lfe;let o4e=class extends Pd{constructor(e,i,s,n,r,o){super(),this.m_densificator=new r4e(i,s,n,o,!1,r),this.m_index=-1,this.m_inputGeoms=e}tock(){return!0}getRank(){return 1}next(){let e=null;for(;e=this.m_inputGeoms.next();)return Um(e),this.m_index=this.m_inputGeoms.getGeometryID(),this.densify(e);return null}getGeometryID(){return this.m_index}densify(e){return this.m_densificator.densify(e)}},Tv=class{getOperatorType(){return 10202}accelerateGeometry(e,i,s){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}executeMany(e,i,s,n,r,o=12e3){return new o4e(e,i,s,n,o,r)}execute(e,i,s,n,r,o=12e3){return TFe(e,i,s,n,r,o)}};class E1{constructor(e){if(this.m_geom=this.m_sr=null,e){if(e.move)return this.m_geom=e.move.m_geom,e.move.m_geom=null,this.m_sr=e.move.m_sr,void(e.move.m_sr=null);if(e.copy)return this.m_geom=e.copy.m_geom?e.copy.m_geom.clone():null,void(this.m_sr=e.copy.m_sr);e.geom&&(this.m_geom=e.geom),e.sr&&(this.m_sr=e.sr)}}getGeometry(){return this.m_geom}getSpatialReference(){return this.m_sr}setGeometry(e){this.m_geom=e}setSpatialReference(e){this.m_sr=e}equals(e,i){const s=e;return!(!this.m_sr&&s.m_sr)&&!(this.m_sr&&!s.m_sr)&&!(!this.m_geom&&s.m_geom)&&!(this.m_geom&&!s.m_geom)&&!(this.m_sr&&s.m_sr&&!this.m_sr.equals(s.m_sr))&&!(this.m_geom&&s.m_geom&&!this.m_geom.equals(s.m_geom,i))}clone(){let e=null;return this.m_geom&&(e=this.m_geom.clone()),new E1({geom:e,sr:this.m_sr})}hasGeom(){return!!this.m_geom}}class xfe{constructor(e){this.m_factor=1,this.m_wkid=0,this.m_peUnit=null,e&&(this.m_peUnit=e,this.m_factor=e.getUnitFactor(),this.m_wkid=e.getCode(),this.m_wkid<0&&(this.m_wkid=0))}getName(){return this.m_peUnit.getName()}getID(){return this.m_wkid}getConversionFactor(e){return this.getUnitType()!==e.getUnitType()&&ce("unit type mismatch"),this.getUnitToBaseFactor()/e.getUnitToBaseFactor()}getUnitToBaseFactor(){return this.m_factor}getHashCode(){return fr(nd(this.getUnitType()),nd(this.getUnitToBaseFactor()))}equals(e){return!!e&&this.getUnitType()===e.getUnitType()&&this.getUnitToBaseFactor()===e.getUnitToBaseFactor()&&this.getID()===e.getID()&&this.getName()===e.getName()}static isValidWkid(e){return!1}}class Rs{assign(e){this.m_reason=e.m_reason,this.m_vertexIndex1=e.m_vertexIndex1,this.m_vertexIndex2=e.m_vertexIndex2}constructor(e,i,s){e!==void 0?(this.m_reason=e,this.m_vertexIndex1=i,this.m_vertexIndex2=s):(this.m_reason=0,this.m_vertexIndex1=-1,this.m_vertexIndex2=-2)}clear(){this.m_reason=0,this.m_vertexIndex1=-1,this.m_vertexIndex2=-1}}const mL={330:104878,500:104879,1300:104899,1450:104986,2230:104988,3800:104978,5e3:104919,6200:104906,8200:104909,9500:104927,9600:104977,1e4:[104911,104936],11e3:104941,11080:104872,11100:104907,12e3:104920,12400:104995,13e3:104948,14e3:[104923,104989],15e3:[104913,104954],15100:104976,16e3:[104926,104931],18e3:[104922,104982],21e3:104947,21500:104877,27e3:[104950,104957],29e3:104964,3e4:104921,31e3:104949,33e3:104946,4e4:[104914,104967],40600:104897,41900:104937,42e3:104951,43100:104993,49300:104924,50100:104939,54e3:104955,58200:104981,59500:104930,74e3:104961,77e3:104956,79e3:104962,83500:104910,85e3:104917,88800:104934,89200:104985,96e3:104997,104e3:104963,106500:104898,11e4:104938,133e3:104932,135e3:104983,17e4:104965,198200:104987,198630:104935,208e3:104966,235800:104952,249400:104929,252100:104980,255e3:104973,47e4:104972,529800:104942,531e3:104996,56e4:104928,561400:104979,578900:104945,584700:104959,593e3:104970,606e3:104999,718e3:104933,745700:104984,761400:104953,763500:104994,764e3:104940,788900:104958,1188300:104998,1195e3:104969,1352600:104968,1560800:104874,1562090:104915,1737400:104903,1821460:104918,1821490:104876,2409300:104912,2410300:104873,2439400:104974,2439700:104900,2575e3:104943,2631200:104875,2632345:104916,3393400:104904,3396190:[104905,104971],6051e3:104901,6051800:104902,637e4:104128,6370997:[4052,37008],6371e3:4035,6371007:4047,6371228:[4053,10346],6376045:[8042,8043],6376523:[4027,4901,4902],6376896:37007,6378135:[4122,4322,4324,4720,4985,4987],6378136:[4740,4923,7678,7680,9474,9475,104017,104018],6378137:[3823,3824,3888,3889,4017,4019,4023,4031,4040,4046,4055,4074,4075,4080,4081,4121,4126,4130,4133,4140,4141,4148,4151,4152,4163,4166,4167,4170,4171,4172,4173,4176,4180,4189,4190,4258,4269,4283,4318,4319,4326,4463,4466,4469,4470,4480,4482,4483,4490,4557,4558,4612,4617,4619,4624,4627,4659,4661,4667,4669,4670,4674,4686,4687,4693,4694,4702,4737,4742,4747,4749,4750,4755,4756,4757,4758,4759,4761,4762,4763,4764,4765,4883,4885,4887,4889,4893,4895,4898,4907,4909,4921,4925,4927,4929,4931,4933,4935,4937,4939,4941,4943,4945,4947,4949,4951,4953,4955,4957,4959,4961,4963,4965,4967,4971,4975,4977,4979,4981,4983,4989,4997,4999,5012,5013,5245,5246,5251,5252,5263,5264,5323,5324,5340,5342,5353,5354,5359,5360,5364,5365,5370,5371,5372,5373,5380,5381,5392,5393,5488,5489,5545,5546,5592,5593,5885,5886,6134,6135,6310,6311,6318,6319,6321,6322,6324,6325,6364,6365,6667,6668,6705,6706,6782,6783,6980,6982,6983,6987,6989,6990,7034,7035,7036,7037,7038,7039,7040,7041,7042,7072,7073,7084,7085,7086,7087,7133,7135,7136,7138,7139,7372,7373,7657,7659,7661,7663,7665,7685,7686,7797,7798,7816,7843,7844,7880,7881,7885,7886,7900,7901,7902,7903,7904,7905,7906,7907,7908,7909,7910,7911,7912,7915,7917,7919,7921,7923,7925,7927,7929,7931,8085,8086,8231,8232,8235,8237,8239,8240,8244,8246,8248,8249,8251,8252,8254,8255,8399,8403,8426,8427,8449,8542,8544,8545,8684,8685,8698,8699,8817,8818,8860,8888,8899,8900,8901,8902,8906,8907,8916,8918,8920,8922,8924,8926,8928,8930,8932,8934,8936,8938,8940,8942,8944,8946,8948,8949,8972,8973,8974,8975,8976,8977,8978,8979,8980,8981,8982,8983,8984,8985,8986,8987,8988,8989,8990,8991,8992,8993,8994,8995,8996,8997,8998,8999,9e3,9002,9003,9005,9006,9008,9009,9011,9012,9013,9014,9016,9017,9018,9019,9053,9054,9055,9056,9057,9059,9060,9061,9062,9063,9064,9065,9066,9067,9068,9069,9071,9072,9074,9075,9139,9140,9147,9148,9152,9153,9183,9184,9293,9294,9299,9308,9309,9332,9333,9364,9372,9379,9380,9384,9453,9469,9470,9546,9547,9695,9696,9701,9702,9739,9754,9755,9758,9763,9776,9777,9778,9779,9781,9782,9783,9784,9866,9871,9939,9964,9969,9974,9989,9990,10175,10177,10178,10185,10191,10196,10204,10209,10214,10219,10224,10229,10237,10272,10277,10283,10284,10298,10299,10300,10304,10305,10307,10309,10310,10311,10312,10327,10328,10413,10414,10468,10474,10475,10570,10571,10605,10606,10623,10628,20033,20040,20041,20045,20046,104009,104010,104011,104012,104013,104014,104015,104016,104019,104020,104021,104022,104024,104027,104028,104050,104100,104107,104108,104110,104111,104114,104115,104116,104117,104118,104119,104120,104121,104122,104123,104124,104129,104133,104134,104137,104141,104142,104143,104144,104145,104179,104180,104181,104182,104183,104184,104185,104186,104199,104223,104257,104258,104259,104260,104286,104287,104602,104613,104644,104645,104646,104647,104653,104804,104896,104991],6378140:4610,6378145:[4025,4276,4760,4891,37001],6378150:37003,6378155:[37004,37207],6378160:[3821,4003,4021,4036,4202,4203,4237,4238,4291,4618,4708,5527,37231,104023,104136],6378166:37002,6378200:[4020,4229,4286,4303,4706],6378245:[4024,4147,4164,4178,4179,4191,4200,4205,4214,4284,4317,4555,4676,4677,4678,4991,4993,5560,5561,37257,104135],6378270:[4732,37005,37229],6378273:[4054,10345],6378300:[4029,4168,4174],6378388:[4022,4123,4153,4154,4158,4159,4160,4161,4165,4181,4182,4183,4184,4185,4192,4194,4195,4196,4199,4204,4207,4208,4215,4218,4221,4224,4225,4230,4231,4233,4235,4236,4247,4248,4249,4254,4255,4259,4264,4265,4271,4272,4274,4285,4287,4288,4292,4297,4309,4311,4313,4316,4472,4475,4611,4614,4615,4616,4621,4622,4623,4625,4626,4628,4629,4630,4631,4632,4633,4636,4637,4639,4641,4642,4643,4644,4645,4646,4658,4660,4662,4663,4664,4665,4668,4672,4673,4684,4688,4689,4690,4691,4692,4698,4704,4705,4707,4709,4710,4711,4712,4714,4715,4716,4718,4719,4721,4722,4724,4725,4727,4728,4729,4730,4733,4734,4735,4739,4741,4753,4754,4802,4803,4806,4809,4810,4823,4824,4900,5524,6883,8428,8430,8431,9248,9251,9253,9403,9893,10158,10249,10252,37201,37204,37205,37212,37213,37214,37215,37216,37217,37218,37219,37221,37222,37224,37226,37227,37230,37232,37233,37234,37235,37237,37238,37241,37242,37245,37246,37247,37249,37250,37251,37253,37259,104104,104106,104125,104126,104127,104130,104138,104248],6378523:104786,24764e3:104960,25559e3:104944,60268e3:104925,71492e3:104908,6957e5:104975,6377397155e-3:[3819,3906,4004,4120,4124,4125,4149,4150,4156,4162,4211,4219,4257,4262,4280,4289,4294,4295,4301,4306,4308,4312,4314,4613,4666,4745,4746,4801,4804,4805,4808,4813,4814,4815,4818,4820,4904,5132,5228,5229,5681,5830,8351,9267,10268,37255,104101,104102,104105,104131,104648,104696,104697,104990,104992],6377563396e-3:[4001,4188,4277,4278,4279],6377340189e-3:[4002,4299,4300],6377492018e-3:[4005,4273,4817],6377483865280418e-9:[4006,4293],6378293645208759e-9:[4007,4157,4302,4738,5464],63782064e-1:[4008,4127,4128,4129,4135,4136,4137,4138,4139,4169,4216,4242,4253,4267,4608,4609,4638,4675,4683,4695,4717,4723,4726,4995,5451,5467,37220,37239,37243,37252,37260,104e3,104109,104112,104113,104132],6378450047e-3:[4009,4268],6378300789e-3:[4010,4281],63782492e-1:[4011,4014,4155,4193,4206,4213,4223,4226,4227,4228,4252,4261,4266,4275,4282,4296,4304,4310,4315,4671,4807,4811,4816,4821,37223,37225,104139,104140,104261,104304],6378249145e-3:[4012,4013,4132,4134,4142,4143,4175,4197,4198,4201,4209,4210,4212,4220,4222,4232,4234,4246,4250,4251,4256,4260,4263,4270,4305,4307,4600,4601,4602,4603,4604,4605,4606,4607,4620,4679,4680,4696,4697,4699,4700,4701,4703,4713,4731,4736,4743,4744,4812,4819,6881,6882,6892,6894,8694,37206,37208,37211,37228,37240,37254,104025,104026,104103,104305],6377276345e-3:[4015,4131,4144,4239,4240,4244,4682,5233,6207,37202,104256,104664,104693],6377298556e-3:[4016,4298],6377304063e-3:[4018,4245],63782983e-1:[4028,4903],63781362e-1:4032,63781363e-1:4033,6378249144808011e-9:[4034,4241],209229318e-1:[4042,4243],6377301243e-3:[4044,4145,37203],6377299151e-3:[4045,4146],637701927e-2:[4657,10256,10260,10265],63783063696e-4:[4748,4752],6377295664e-3:[4751,37006],63781365e-1:[7682,7683],63710087714e-4:104047,6378418941e-3:[104700,104726,104760],6378586581e-3:[104701,104743],6378505809e-3:104702,6378544823e-3:104703,6378490569e-3:104704,6378470757e-3:[104705,104776],6378403701e-3:[104706,104750],6378434181e-3:[104707,104724,104739,104764],6378454907e-3:104708,6378400653e-3:104709,6378567378e-3:104710,6378546957e-3:[104711,104717,104780],6378476853e-3:[104712,104736],6378411321e-3:[104713,104728],6378647541e-3:[104714,104715],6378514953e-3:[104716,104782],6378421989e-3:[104718,104770],6378481425e-3:[104719,104753,104774,104781],6378518001e-3:[104720,104725],6378521049e-3:[104721,104723,104731,104745,104748],6378464661e-3:104722,6378436619e-3:104727,6378574389e-3:[104729,104730],6378472281e-3:[104732,104756],6378498189e-3:[104733,104746],6378449421e-3:[104734,104766],6378525621e-3:[104735,104754],6378466185e-3:104737,6378496665e-3:104738,6378643579e-3:104740,6378559758e-3:104741,6378414369e-3:[104742,104763,104772],6378441801e-3:104744,6378502761e-3:[104747,104759,104773,104775],6378617061e-3:104749,6378624681e-3:[104751,104765],6378468623e-3:104752,6378445763e-3:[104755,104758,104761],6378670401e-3:104757,6378438753e-3:104762,6378543909e-3:104767,6378605783e-3:104768,6378540861e-3:104769,6378443325e-3:[104771,104784],6378548481e-3:104777,6378463746e-3:104778,6378426561e-3:104779,6378453688e-3:104783,6378530193e-3:104785,6378376271e-3:[104800,104828],637847192e-2:104801,6378472931e-3:104802,6378411351e-3:104803,6378380991e-3:104805,637841496e-2:104806,637834509e-2:[104807,104819,104844,104870],6378412542e-3:104808,6378470401e-3:104809,6378376331e-3:104810,6378379031e-3:104811,6378407621e-3:104812,6378376811e-3:[104813,104827],637831392e-2:104814,637841493e-2:104815,6378413021e-3:104816,6378380381e-3:104817,6378530851e-3:104818,6378591521e-3:104820,6378378881e-3:104821,6378408481e-3:[104822,104832],6378375601e-3:[104823,104838],6378408041e-3:104824,6378655071e-3:104825,6378409151e-3:104826,63783157e-1:[104829,104840,104845,104851],637828586e-2:[104830,104835,104859],6378379301e-3:104831,6378560121e-3:104833,6378531821e-3:104834,63785006e-1:104836,6378376041e-3:104837,6378406601e-3:104839,6378438991e-3:104841,637834542e-2:104842,637859386e-2:104843,6378381271e-3:[104846,104847],6378413671e-3:104848,6378344377e-3:104849,6378563891e-3:104850,6378408091e-3:104852,6378377671e-3:104853,6378472751e-3:104854,6378412511e-3:104855,6378407281e-3:104856,6378534451e-3:104857,6378406051e-3:104858,6378532921e-3:104860,6378380091e-3:104861,6378408941e-3:104862,6378624171e-3:104863,6378377411e-3:104864,6378474591e-3:104865,6378407141e-3:104866,6378376871e-3:104867,6378375251e-3:104868,6378405971e-3:104869,6378437651e-3:104871};function a4e(){for(const t in mL)delete mL[t]}class sM extends xfe{constructor(e){if(typeof e=="number")return super(),this.m_factor=e,void(this.m_wkid=0);super(e)}getUnitType(){return 1}convertFromRadians(e){return e/this.getUnitToBaseFactor()}convertToRadians(e){return e*this.getUnitToBaseFactor()}}function l4e(t){return new $f}function u4e(t){return t.getType()===$t.PE_TYPE_LINUNIT?new $f(t):t.getType()===$t.PE_TYPE_ANGUNIT?new sM(t):void ce("peUnit")}function c4e(t){const e=rE(null);return t.getType()===$t.PE_TYPE_PROJCS||t.getType()===$t.PE_TYPE_GEOGCS?e.reset(t.getUnit()):ce("PE_coord_sys"),e.get()||We("cannot create units from coord sys"),u4e(e.get())}class af{constructor(e,i,s){e===void 0?(this.x=new ge,this.y=new ge,this.z=new ge):e instanceof gi?(this.x=new ge(e.x),this.y=new ge(e.y),this.z=new ge(e.z)):e instanceof ge?(this.x=e.clone(),this.y=i.clone(),this.z=s.clone()):ce("EPoint3D constructor")}dotProduct(e){return this.x.mulE(e.x).addE(this.y.mulE(e.y)).addE(this.z.mulE(e.z))}crossProduct(e){return new af(this.y.mulE(e.z).subE(this.z.mulE(e.y)),this.z.mulE(e.x).subE(this.x.mulE(e.z)),this.x.mulE(e.y).subE(this.y.mulE(e.x)))}crossProductVector(e){const i=this.y.mulE(e.z).subE(e.y.mulE(this.z)),s=e.x.mulE(this.z).subE(this.x.mulE(e.z)),n=this.x.mulE(e.y).subE(e.x.mulE(this.y));return new af(i,s,n)}sqrLength(){return this.x.mulE(this.x).addE(this.y.mulE(this.y)).addE(this.z.mulE(this.z))}length(){return this.sqrLength().sqrt()}static distance(e,i){return e.sub(i).length()}negate(){return new af(this.x.negate(),this.y.negate(),this.z.negate())}add(e){return new af(this.x.addE(e.x),this.y.addE(e.y),this.z.addE(e.z))}sub(e){return new af(this.x.subE(e.x),this.y.subE(e.y),this.z.subE(e.z))}subThis(e){return this.x.subThisE(e.x),this.y.subThisE(e.y),this.z.subThisE(e.z),this}addThis(e){return this.x.addThisE(e.x),this.y.addThisE(e.y),this.z.addThisE(e.z),this}mul(e){return new af(this.x.mulE(e),this.y.mulE(e),this.z.mulE(e))}div(e){return new af(this.x.divE(e),this.y.divE(e),this.z.divE(e))}eq(e){return this.x.eq(e.x)&&this.y.eq(e.y)&&this.z.eq(e.z)}isZero(){return this.x.isZero()&&this.y.isZero()&&this.z.isZero()}value(){return gi.construct(this.x.value(),this.y.value(),this.z.value())}}class h4e{constructor(e){if(this.m_origin=new gi,this.m_normal=new gi,this.m_axisX=new gi,this.m_axisY=new gi,!e)return this.m_origin=new gi,this.m_normal=new gi(0,0,1),this.m_axisX=new gi(1,0,0),void(this.m_axisY=new gi(0,1,0));e.pt0&&e.pt1&&e.pt2?this.setFromPoints(e.pt0,e.pt1,e.pt2):z(0,`unimplemented constructor options ${JSON.stringify(e)}`)}assign(e){return z(0),this}set(e,i,s,n){z(0)}setFromPoints(e,i,s){let n=i.sub(e);const r=s.sub(e);this.m_normal=n.crossProductVector(r);let o=!0;if(this.m_normal.isZero()){if(o=!1,n.isZero()&&(n=r),n.isZero())return this.m_normal.setCoords(0,0,1),this.m_axisX.setCoords(1,0,0),this.m_axisY.setCoords(0,1,0),this.m_origin=e,!1;this.m_axisX=n.getUnitVector(),this.m_normal=this.m_axisX.createAPerpendicular()}else this.m_normal.normalizeThis(),this.m_axisX=n.getUnitVector();return this.m_axisY=this.m_normal.crossProductVector(this.m_axisX),this.m_origin=e,o}getCoord(e,i){return z(0),{}}getCoord2D(e){return z(0),{}}getCoordX(e,i){return z(0),0}getCoordY(e,i){return z(0),0}getCoordZ(e,i){return z(0),0}setPreferredAxisX(e){z(0)}getOrigin(){return z(0),{}}getNormal(){return z(0),{}}getAxisX(){return this.m_axisX.clone()}getAxisY(){return this.m_axisY.clone()}setAxisX(e,i=!1){z(0)}setAxisY(e,i=!1){z(0)}recalculateAxisY(){z(0)}setOrigin(e){z(0)}setNormal(e,i){z(0)}intersect(e,i){return z(0),!1}intersectLine(e){return z(0),0}intersectLineEx(e,i){return z(0),0}closestCoordinate(e){const i=e.sub(this.m_origin),s=new N;return s.x=i.dotProduct(this.m_axisX),s.y=i.dotProduct(this.m_axisY),s}projectVector(e){return z(0),{}}signedDistance(e){return z(0),0}distance(e){return z(0),0}}function d4e(t,e){return!1}function nj(t,e,i,s,n=100,r=d4e){let o,a,l,u,c,h,d,m,f;z(s>0);let _,v,x,w=0,T=0;const C=_G();e>i&&(i=Ge(e,e=i));const M=t(e),A=t(i);M<A?(o=a=l=e,u=c=h=M):(o=a=l=i,u=c=h=A);let I=0;for(;I<n&&(x=.5*(i-e),f=e+x,_=s*(Math.abs(o)+.25),v=2*_,!(r(o,u)||Math.abs(o-f)<=v-x));++I){if(Math.abs(T)>_){const L=(o-a)*(u-h);let D=(o-l)*(u-c),O=(o-l)*D-(o-a)*L;D=2*(D-L),D>0&&(O=-O),D=Math.abs(D);const U=T;T=w,Math.abs(O)>=Math.abs(D*U*.5)||O<=D*(e-o)||O>=D*(i-o)?(T=o>=f?e-o:i-o,w=_G()*T):(w=O/D,m=o+w,(m-e<v||i-m<v)&&(w=f-o<0?-Math.abs(_):Math.abs(_)))}else T=o>=f?e-o:i-o,w=T*C;m=o+w,d=t(m),d<u?(m>=o?e=o:i=o,l=a,a=o,o=m,h=c,c=u,u=d):(m<o?e=m:i=m,d<=c||a===o?(l=a,a=m,h=c,c=d):(d<=h||l===o||l===a)&&(l=m,h=d))}return gr(o,u)}function mB(t,e,i){return t>i?t-=Math.ceil((t-i)/GC)*GC:t<e&&(t+=Math.ceil((e-t)/GC)*GC),t}function Cr(t,e,i){return m4e(t,e,i,0)}function m4e(t,e,i,s){const n=i.x,r=i.y;return bfe(t,e,Math.cos(n),Math.sin(n),Math.cos(r),Math.sin(r),s)}function p4e(t,e,i,s,n,r){return bfe(t,e,i,s,n,r,0)}function bfe(t,e,i,s,n,r,o){const a=t/Math.sqrt(1-e*r*r),l=a+o,u=l*n*i,c=l*n*s,h=(a*(1-e)+o)*r;return gi.construct(u,c,h)}function pL(t,e,i){const s=new ge,n=new ge,r=new ge,o=new ge;s.setCos(i.x),n.setSin(i.x),r.setCos(i.y),o.setSin(i.y);const a=o.negate().mulE(o.mul(e)).add(1).sqrt(),l=new ge(t).divE(a),u=l.mulE(r).mulE(s),c=l.mulE(r).mulE(n),h=l.mul(1-e).mulE(o);return new af(u,c,h)}function yS(t,e,i){const s=i.x,n=i.y,r=i.z,o=Math.atan2(n,s),a=Math.sqrt(s*s+n*n),l=Math.atan2(r,(1-e)*a);return N.construct(o,l)}function WC(t,e,i){const s=1-e,n=t/Math.sqrt(Di(i.x)+Di(i.y)+Di(i.z)/s);return i.mul(n)}function f4e(t,e,i,s,n){const r=Cr(t,e,i),o=Cr(t,e,s);return yS(t,e,gi.lerp(r,o,n))}function pB(t,e,i){const s=new gi;return s.setCrossProductVector(e,i),Math.abs(Math.atan2(s.length(),e.dotProduct(i)))*t}function g4e(t,e,i,s,n){const r=i.getUnitVector(),o=s.getUnitVector(),a=e.getUnitVector(),l=new gi;if(l.setCrossProductVector(r,o),!l.isZero()){l.normalizeThis();const h=a.sub(l.mul(l.dotProduct(a)));if(!h.isZero()){h.normalizeThis();const d=r.add(o).mul(.5);if(d.dotProduct(h)>d.dotProduct(r)){const m=Math.abs(l.dotProduct(a)),f=Math.asin(m);return n.assign(h.getUnitVector().mul(t)),f*t}}}const u=pB(1,r,a),c=pB(1,o,a);return u<=c?(n.assign(i),u*t):(n.assign(s),c*t)}function _4e(t,e,i,s){const n={stack:[],error:void 0,hasError:!1};try{const r=Da(n,new Lo,!1);return zl.geodeticDistance(t,e,i.x,i.y,s.x,s.y,r,null,null,$t.PE_LINETYPE_GEODESIC),r.val}catch(r){n.error=r,n.hasError=!0}finally{Hf(n)}}function y4e(t,e,i,s,n){switch(z(i.isFinite()&&s.isFinite()),n){case 0:return _4e(t,e,i,s);case 1:return x4e(t,e,i);case 2:case 3:{const r=Cr(t,e,i),o=Cr(t,e,s);return gi.distance(r,o)}default:_i("")}}function ZC(t,e,i,s,n,r=0,o){if(r===2||r===3)return v4e(t,e,i,s,n,r===3,o);const a=yS(t,e,i),l=c=>{const h=yS(t,e,gi.lerp(s,n,c));return y4e(t,e,a,h,r)},u=gi.distance(s,n);if(u>0){const c=Efe(t,u),{first:h,second:d}=nj(l,0,1,c);return o&&o.assign(WC(t,e,gi.lerp(s,n,h))),gr(h,d)}{const c=l(0);return o&&o.assign(s),gr(.5,c)}}function v4e(t,e,i,s,n,r=!1,o){const a=WC(t,e,i);if(r){const c=new h4e({pt0:new gi(0,0,0),pt1:s,pt2:n}),h=c.closestCoordinate(i),d=c.closestCoordinate(s),m=c.closestCoordinate(n),f=N.getClosestCoordinate(d,m,h),_=WC(t,e,gi.lerp(s,n,f)),v=gi.distance(_,a);return o&&o.assign(_),gr(f,v)}const l=c=>{const h=WC(t,e,gi.lerp(s,n,c));return gi.distance(h,a)},u=gi.distance(s,n);if(u>0){const c=Efe(t,u),{first:h,second:d}=nj(l,0,1,c);return o&&o.assign(WC(t,e,gi.lerp(s,n,h))),gr(h,d)}{const c=gi.distance(i,s);return o&&o.assign(i),gr(.5,c)}}function x4e(t,e,i,s){const n={stack:[],error:void 0,hasError:!1};try{const r=Da(n,new Lo,!1);return zl.greatEllipticDistance(t,e,i.x,i.y,i.x,i.y,r,null,null),r.val}catch(r){n.error=r,n.hasError=!0}finally{Hf(n)}}function b4e(t,e,i,s,n){if(Math.abs(i.x-s.x)>Math.PI||Math.abs(i.y)>zi||Math.abs(s.y)>zi||(Math.abs(i.y)===zi||Math.abs(s.y)===zi)&&i.x!==s.x)return Number.NaN;const{first:r,second:o}=WRe(i.x,s.x);let a=n;if(a=mB(a,r,o),!Me.construct(i.x,s.x).containsCoordinate(a))return Number.NaN;const l=Et.constructPoint2D(i),u=Et.constructPoint2D(s),c=pL(1,e,l),h=pL(1,e,u),d=c.crossProductVector(h);if(d.z.isZero())return i.y;const m=d.x.divE(d.z.negate()),f=d.y.divE(d.z.negate()),_=m.mulE(m).addE(f.mulE(f)).sqrt();if(_.isZero()||m.isZero()&&f.isZero())return i.y;const v=Math.atan2(f.value(),m.value());let x=Math.atan2(_.value()*Math.cos(v-a),1-e);const w=Cr(1,e,N.construct(a,x)),T=gi.construct(w.x,w.y,-w.z),C=d.value().dotProduct(w),M=d.value().dotProduct(T);return Math.abs(M)<Math.abs(C)&&(x=-x),x}function wfe(t,e,i,s,n,r){if(r[0]=Number.NaN,r[1]=Number.NaN,Math.abs(i.x-s.x)>Math.PI||Math.abs(i.y)>zi||Math.abs(s.y)>zi||(Math.abs(i.y)===zi||Math.abs(s.y)===zi)&&i.x!==s.x||Math.abs(n)>=zi||i.y>0&&s.y>0&&i.y>n&&s.y>n||i.y<0&&s.y<0&&i.y<n&&s.y<n)return 0;const o=Et.constructPoint2D(i),a=Et.constructPoint2D(s),l=pL(1,e,o),u=pL(1,e,a),c=l.crossProductVector(u);if(c.z.isZero())return Me.construct(i.y,s.y).containsCoordinate(n)?(r[0]=i.x,1):0;const h=c.x.divE(c.z.negate()),d=c.y.divE(c.z.negate()),m=h.mulE(h).addE(d.mulE(d)).sqrt();if(m.isZero()||h.isZero()&&d.isZero())return n===0?(r[0]=i.x,r[1]=s.x,2):0;const f=(1-e)*Math.tan(n)/m.value();if(Math.abs(f)>1)return 0;const _=Math.acos(f),v=Math.atan2(d.value(),h.value()),x=v-_;let w=v+_;const T=Math.min(i.x,s.x),C=Math.max(i.x,s.x);mB(x,T,C),n!==0?mB(w,T,C):w=x;let M=0;return T<=x&&x<=C&&(r[M]=x,M++),w!==x&&T<=w&&w<=C&&(r[M]=w,M++),M}function _ee(t,e){e[0]>.5*Math.PI?(t[0]+=Math.PI,e[0]=Math.PI-e[0]):e[0]<.5*-Math.PI&&(t[0]-=Math.PI,e[0]=-Math.PI-e[0]),z(e[0]>=.5*-Math.PI&&e[0]<=.5*Math.PI)}function w4e(t,e){return t*Math.sqrt(1-e)}function S4e(t){return 1-t}function E4e(t,e,i,s,n){s=Os(s,-zi,zi),n=Os(n,-zi,zi);const r=zi-.03;let o;return o=s>r&&n>r||s<-r&&n<-r?C4e(t,s,n):yee(t,n)-yee(t,s),.5*(i-e)*o*S4e(t)}function C4e(t,e,i){let s=1;if(e<0&&(s=-1,e=-e,i=-i),t!==0){const n=t*t,r=n*t,o=[1,(1+11*t)/12,(1+118*t+241*n)/360,(1+1089*t+10419*n+8651*r)/20160,(1+9836*t+318246*n+1027436*r+458881*(r*t))/1814400],a=u=>{let c=0;const h=Di(u)/(t-1);for(let d=o.length-1;d>=0;--d)c=o[d]+c*h;return c*=-Di(u/(1-t)),c},l=a(zi-e);return(a(zi-i)-l)*s}{const n=zi-e,r=zi-i,o=-4*Di(Math.sin(n/2));return(-4*Di(Math.sin(r/2))-o)*s}}function yee(t,e){if(e===0)return 0;const i=Math.sin(e);let s=i,n=i;if(t!==0){s/=1-t*i*i;const r=Math.sqrt(t);n=i*XRe(r*i)}return s+n}function T4e(t,e){return t/Math.sqrt(1-e)}function Sfe(t,e){return(1-e)*t}function P4e(t,e,i){const s=i/(2*Sfe(t,e)),n=s*s;return i*(1-n*(.16666666666666666-.008333333333333333*n))}function Efe(t,e){if(e!==0){const i=t*u3e()/e;return Math.min(i,1e-10)}return 0}class pA{constructor(e){this.m_currentShift=63n,this.m_currentElt=0n,this.m_iCurrentElt=-1,this.m_parent=e,this.m_aiSetElts=e.m_bits.flatMap((i,s)=>s)}next(){if(this.m_currentShift++,this.m_currentShift===64n){if(this.m_iCurrentElt++,this.m_iCurrentElt===this.m_aiSetElts.length)return pA.npos();this.m_currentShift=0n,this.m_currentElt=this.m_parent.m_bits[this.m_aiSetElts[this.m_iCurrentElt]]}for(;this.m_currentShift<63n&&!(this.m_currentElt&1n<<this.m_currentShift);)this.m_currentShift++;return this.m_currentElt&1n<<this.m_currentShift?64*this.m_aiSetElts[this.m_iCurrentElt]+Number(this.m_currentShift):this.next()}static npos(){return Number.MAX_SAFE_INTEGER}}function GU(t){return 1n<<(0x3fn&BigInt(t))}function BU(t){return t>>6}class Mh{constructor(e){this.m_bits=[],e!==void 0&&e.copy&&(this.m_bits=e.copy.m_bits.slice())}assignMove(){return this}assignCopy(){return this}hasBit(e){const i=GU(e),s=BU(e);return this.m_bits[s]!==void 0&&!!(this.m_bits[s]&i)}setBit(e){const i=GU(e),s=BU(e);this.m_bits[s]===void 0&&(this.m_bits[s]=0n),this.m_bits[s]|=i}clearBit(e){}flipBit(e){const i=GU(e),s=BU(e);return this.m_bits[s]===void 0&&(this.m_bits[s]=0n),this.m_bits[s]^=i,(this.m_bits[s]&i)!==0n}clear(){this.m_bits.length=0}isZero(){let e=0;return this.m_bits.forEach(i=>{e|=i?2:1}),!(2&e)}equals(e){if(this===e)return!0;if(this.m_bits.length!==e.m_bits.length)return!1;let i=0;return this.m_bits.forEach((s,n)=>{i|=s===e.m_bits[n]?2:1}),!(1&i)&&(e.m_bits.forEach((s,n)=>{i|=s===this.m_bits[n]?2:1}),!(1&i))}notEquals(e){return!this.equals(e)}assignOr(e){return e.m_bits.forEach((i,s)=>{this.m_bits[s]===void 0?this.m_bits[s]=i:this.m_bits[s]|=i}),this}assignSubtract(e){return e.m_bits.forEach((i,s)=>{this.m_bits[s]!==void 0&&(this.m_bits[s]&=~i)}),this}assignAnd(e){return e.m_bits.forEach((i,s)=>{this.m_bits[s]!==void 0&&(this.m_bits[s]&=i)}),this}assignXor(e){return e.m_bits.forEach((i,s)=>{this.m_bits[s]===void 0?this.m_bits[s]=i:this.m_bits[s]^=i}),this}getHashCode(){return this.m_bits.reduce((e,i)=>y3e(e,i),nd(0))}getUnorderedBitIterator(){return new pA(this)}}class M4e{constructor(e,i){this.m_map=new Map,this.m_hf=e,this.m_ef=i}add(e){const i=this.m_hf(e);if(!this.m_map.has(i))return this.m_map.set(i,e),this;const s=this.m_map.get(i);return s instanceof Array?s.find(n=>this.m_ef(n,e))||s.push(e):this.m_ef(s,e)||this.m_map.set(i,[s,e]),this}clear(){this.m_map.clear()}delete(e){return!1}has(e){const i=this.m_hf(e);if(!this.m_map.has(i))return!1;const s=this.m_map.get(i);return s instanceof Array?s.find(n=>this.m_ef(n,e))!==void 0:this.m_ef(s,e)}get(e){const i=this.m_hf(e),s=this.m_map.get(i);if(s!==void 0)return s instanceof Array?s.find(n=>this.m_ef(n,e)):s}get size(){let e=0;for(const i of this.m_map.values())e+=i instanceof Array?i.length:1;return e}forEach(e,i){}[Symbol.iterator](){return new Set()[Symbol.iterator]()}entries(){return new Set().entries()}keys(){return new Set().keys()}values(){return new Set().values()}get[Symbol.toStringTag](){return"ValueSet"}}class A4e extends B1{constructor(e){super(),this.m_bufferLeft=new ii,this.m_bufferRight=new ii,this.m_intervalLeft=Me.constructEmpty(),this.m_intervalRight=Me.constructEmpty(),this.m_yScanline=Number.NaN,this.m_helper=e}compare(e,i,s){const n=i,r=e.getElement(s);this.m_helper.querySegmentXY(n,this.m_bufferLeft),this.m_helper.querySegmentXY(r,this.m_bufferRight);const o=this.m_bufferLeft.get(),a=this.m_bufferRight.get();if(this.m_intervalLeft.setCoords(o.getStartX(),o.getEndX()),this.m_intervalRight.setCoords(a.getStartX(),a.getEndX()),this.m_intervalLeft.vmax<this.m_intervalRight.vmin)return-1;if(this.m_intervalLeft.vmin>this.m_intervalRight.vmax)return 1;const l=o.getStartY()===o.getEndY(),u=a.getStartY()===a.getEndY();if(l||u){if(l&&u)return 0;if(o.getStartY()===a.getStartY()&&o.getStartX()===a.getStartX())return l?1:-1;if(o.getEndY()===a.getEndY()&&o.getEndX()===a.getEndX())return l?-1:1}let c=o.intersectionOfYMonotonicWithAxisX(this.m_yScanline,this.m_intervalLeft.vmin),h=a.intersectionOfYMonotonicWithAxisX(this.m_yScanline,this.m_intervalRight.vmin);if(c===h){const d=o.getEndY(),m=a.getEndY(),f=Math.min(d,m);let _=.5*(f+this.m_yScanline);_===this.m_yScanline&&(_=f),c=o.intersectionOfYMonotonicWithAxisX(_,this.m_intervalLeft.vmin),h=a.intersectionOfYMonotonicWithAxisX(_,this.m_intervalRight.vmin)}return c<h?-1:c>h?1:0}setY(e){this.m_yScanline=e}}class I4e{constructor(e){this.m_segmentBuffer=new ii,this.m_point=N.getNAN(),this.m_parent=e}setPointXY(e){this.m_point.assign(e)}compare(e,i){const s=e.getElement(i);this.m_parent.querySegmentXY(s,this.m_segmentBuffer);const n=this.m_segmentBuffer.get(),r=new Me;if(r.setCoords(n.getStartX(),n.getEndX()),this.m_point.x<r.vmin)return-1;if(this.m_point.x>r.vmax)return 1;const o=n.intersectionOfYMonotonicWithAxisX(this.m_point.y,this.m_point.x);return this.m_point.x<o?-1:this.m_point.x>o?1:0}}var Ca,O_;function vee(t,e){return{parentage:t,rank:e}}function D4e(t,e){const i=t.length;if(i!==e.length)return!1;const s=t[0].parentage;if(s!==e[0].parentage)return!1;if(s===-1)return!0;for(let n=1;n<i;++n)if(t[n].parentage!==e[n].parentage)return!1;return!0}function xee(t,e,i){i.length=0;let s=!1;{let n=t.getHalfEdgeVertexIterator(e);for(;n!==G;){const r=t.getVertexFromVertexIterator(n),o=t.getShape().getSegmentRank(r),a=t.getShape().getSegmentParentage(r);s||(s=a>=0),i.push(vee(a,o)),n=t.incrementVertexIterator(n)}}{let n=t.getHalfEdgeVertexIterator(t.getHalfEdgeTwin(e));for(;n!==G;){const r=t.getVertexFromVertexIterator(n),o=t.getShape().getSegmentRank(r),a=t.getShape().getSegmentParentage(r);s||(s=a>=0),i.push(vee(a,o)),n=t.incrementVertexIterator(n)}}s&&i.sort((n,r)=>n.rank>r.rank?-1:n.rank<r.rank?1:n.parentage<r.parentage?-1:n.parentage>r.parentage?1:0),i[0].parentage===-1&&(i.length=1)}function N4e(){return new M4e(t=>t.getHashCode(),(t,e)=>t.equals(e))}(function(t){t[t.enumInputModeBuildGraph=0]="enumInputModeBuildGraph",t[t.enumInputModeSimplifyAlternate=1]="enumInputModeSimplifyAlternate",t[t.enumInputModeSimplifyWinding=2]="enumInputModeSimplifyWinding"})(Ca||(Ca={})),function(t){t[t.enumSegmentParentageBreakNode=1]="enumSegmentParentageBreakNode",t[t.enumPathBreakNode=2]="enumPathBreakNode"}(O_||(O_={}));class sc{constructor(){this.m_shape=null,this.m_clusterData=new xs(8),this.m_clusterVertices=new xs(2),this.m_firstCluster=G,this.m_lastCluster=G,this.m_halfEdgeData=new xs(8),this.m_chainData=new xs(8),this.m_chainAreas=null,this.m_chainPerimeters=null,this.m_universeChain=-1,this.m_simplifiedGeometry=-1,this.m_edgeIndices=[],this.m_clusterIndices=[],this.m_chainIndices=[],this.m_bBuildGeometryParentageSets=!1,this.m_chainBitSetIndex=-1,this.m_edgeBitSetIndex=-1,this.m_edgeBitSetIndexLeft=-1,this.m_emptyBitSet=null,this.m_geometryMapID=null,this.m_uniqueBitSets=null,this.m_chainBitSets=[],this.m_edgeBitSets=[],this.m_checkDirtyPlanesweepTolerance=Number.NaN,this.m_geometryIDIndex=-1,this.m_clusterIndex=-1,this.m_halfEdgeIndex=-1,this.m_tmpHalfEdgeParentageIndex=-1,this.m_tmpHalfEdgeParentageIndexLeft=-1,this.m_tmpHalfEdgeWindingNumberIndex=-1,this.m_tmpHalfEdgeOddEvenNumberIndex=-1,this.m_segmentParentageIndex=-1,this.m_segmentIndexHe=-1,this.m_clusterBreakNodeIndex=-1,this.m_universeGeomID=-1,this.m_pointCount=0,this.m_progressCounter=0,this.m_bBuildChains=!0,this.m_bDirtyCheckFailed=!1}setCheckDirtyPlanesweepTolerance(e){this.m_checkDirtyPlanesweepTolerance=e}dirtyCheckFailed(){return this.m_bDirtyCheckFailed}getShape(){return this.m_shape}setEditShape(e,i,s=!0,n=!1){n?this.setEditShapeImpl3D_(e,Ca.enumInputModeBuildGraph,null,i,!1):this.setEditShapeImpl_(e,Ca.enumInputModeBuildGraph,null,i,s)}setAndSimplifyEditShapeAlternate(e,i,s=null,n=!1){const r=[];r.push(i),this.m_simplifiedGeometry=i,n?this.setEditShapeImpl3D_(e,Ca.enumInputModeSimplifyAlternate,r,s,!1):this.setEditShapeImpl_(e,Ca.enumInputModeSimplifyAlternate,r,s,e.getGeometryType(i)===q.enumPolygon)}setAndSimplifyEditShapeWinding(e,i,s=null){const n=[];n.push(i),this.m_simplifiedGeometry=i,this.setEditShapeImpl_(e,Ca.enumInputModeSimplifyWinding,n,s,!0)}removeShape(){this.m_shape!==null&&(this.m_geometryIDIndex!==-1&&(this.m_shape.removeGeometryUserIndex(this.m_geometryIDIndex),this.m_geometryIDIndex=-1),this.m_clusterIndex!==-1&&(this.m_shape.removeUserIndex(this.m_clusterIndex),this.m_clusterIndex=-1),this.m_halfEdgeIndex!==-1&&(this.m_shape.removeUserIndex(this.m_halfEdgeIndex),this.m_halfEdgeIndex=-1),this.m_tmpHalfEdgeParentageIndex!==-1&&(this.deleteUserIndexForHalfEdges(this.m_tmpHalfEdgeParentageIndex),this.m_tmpHalfEdgeParentageIndex=-1),this.m_tmpHalfEdgeParentageIndexLeft!==-1&&(this.deleteUserIndexForHalfEdges(this.m_tmpHalfEdgeParentageIndexLeft),this.m_tmpHalfEdgeParentageIndexLeft=-1),this.m_tmpHalfEdgeWindingNumberIndex!==-1&&(this.deleteUserIndexForHalfEdges(this.m_tmpHalfEdgeWindingNumberIndex),this.m_tmpHalfEdgeWindingNumberIndex=-1),this.m_tmpHalfEdgeOddEvenNumberIndex!==-1&&(this.deleteUserIndexForHalfEdges(this.m_tmpHalfEdgeOddEvenNumberIndex),this.m_tmpHalfEdgeOddEvenNumberIndex=-1),this.m_segmentParentageIndex!==-1&&(this.deleteUserIndexForHalfEdges(this.m_segmentParentageIndex),this.m_segmentParentageIndex=-1),this.m_segmentIndexHe!==-1&&(this.deleteUserIndexForHalfEdges(this.m_segmentIndexHe),this.m_segmentIndexHe=-1),this.m_clusterBreakNodeIndex!==-1&&(this.deleteUserIndexForClusters(this.m_clusterBreakNodeIndex),this.m_clusterBreakNodeIndex=-1),this.deleteEdgeBitSets_(),this.deleteChainBitSets_(),this.m_emptyBitSet=null,this.m_geometryMapID=null,this.m_shape=null,this.m_clusterData.deleteAll(!0),this.m_clusterVertices.deleteAll(!0),this.m_firstCluster=G,this.m_lastCluster=G,this.m_halfEdgeData.deleteAll(!0),this.m_edgeIndices.length=0,this.m_clusterIndices.length=0,this.m_chainIndices.length=0,this.m_chainData.deleteAll(!0),this.m_universeChain=G,this.m_chainAreas=null)}getClusterHalfEdge(e){return this.m_clusterData.getField(e,2)}queryXY(e,i){const s=this.getClusterVertexIndex_(e);i.assign(this.m_shape.getXYWithIndex(s))}queryXYZ(e,i){z(0)}getClusterParentage(e){return this.m_clusterData.getField(e,1)}getFirstCluster(){return this.m_firstCluster}getPrevCluster(e){return this.m_clusterData.getField(e,3)}getNextCluster(e){return this.m_clusterData.getField(e,4)}getClusterChain(e){return this.m_clusterData.getField(e,6)}getClusterVertexIterator(e){return this.m_clusterData.getField(e,7)}incrementVertexIterator(e){return this.m_clusterVertices.getField(e,1)}getVertexFromVertexIterator(e){return this.m_clusterVertices.getField(e,0)}getClusterUserIndex(e,i){const s=this.getClusterIndex_(e),n=this.m_clusterIndices[i];return n.size()<=s?-1:n.read(s)}setClusterUserIndex(e,i,s){const n=this.getClusterIndex_(e),r=this.m_clusterIndices[i];r.size()<=n&&r.resize(this.m_clusterData.size(),-1),r.write(n,s)}hasClusterUserIndexFlags(e,i,s){if(i===-1)return!1;const n=this.getClusterUserIndex(e,i);return n!==-1&&!!(s&n)}setClusterUserIndexFlags(e,i,s){const n=this.getClusterIndex_(e),r=this.m_clusterIndices[i];r.size()<=n&&r.resize(this.m_clusterData.size(),-1);let o=r.read(n);o===-1&&(o=0),r.write(n,s|o)}clearClusterUserIndexFlags(e,i,s){const n=this.getClusterIndex_(e),r=this.m_clusterIndices[i];r.size()<=n&&r.resize(this.m_clusterData.size(),-1);let o=r.read(n);o===-1&&(o=0),r.write(n,~s&o)}createUserIndexForClusters(e=-1){const i=new Un(this.m_clusterData.capacity(),e);for(let s=0,n=this.m_clusterIndices.length;s<n;s++)if(this.m_clusterIndices[s]===null)return this.m_clusterIndices[s]=i,s;return this.m_clusterIndices.push(i),this.m_clusterIndices.length-1}deleteUserIndexForClusters(e){this.m_clusterIndices[e]=null}getHalfEdgeOrigin(e){return this.m_halfEdgeData.getField(e,1)}getHalfEdgeTo(e){return this.getHalfEdgeOrigin(this.getHalfEdgeTwin(e))}getHalfEdgeTwin(e){return this.m_halfEdgeData.getField(e,4)}getHalfEdgePrev(e){return this.m_halfEdgeData.getField(e,5)}getHalfEdgeNext(e){return this.m_halfEdgeData.getField(e,6)}getHalfEdgeChain(e){return this.m_halfEdgeData.getField(e,2)}getHalfEdgeFaceParentage(e){return this.getChainParentage(this.getHalfEdgeChain(e))}getHalfEdgeVertexIterator(e){return this.m_halfEdgeData.getField(e,7)}getHalfEdgeFromXY(e,i){this.queryXY(this.getHalfEdgeOrigin(e),i)}getHalfEdgeToXY(e,i){this.queryXY(this.getHalfEdgeTo(e),i)}isHalfEdgeCurve(e){return this.m_segmentIndexHe!==-1?this.getHalfEdgeUserIndex(e,this.m_segmentIndexHe)!==-1:!1}getHalfEdgeFromXYZ(e,i){z(0)}getHalfEdgeToXYZ(e,i){z(0)}getHalfEdgeParentage(e){return this.m_halfEdgeData.getField(e,3)&sc.c_EdgeParentageMask}getHalfEdgeUserIndex(e,i){const s=this.getHalfEdgeIndex_(e),n=this.m_edgeIndices[i];return n.size()<=s?-1:n.read(s)}setHalfEdgeUserIndex(e,i,s){const n=this.getHalfEdgeIndex_(e),r=this.m_edgeIndices[i];r.size()<=n&&r.resize(this.m_halfEdgeData.size(),-1),r.write(n,s)}createUserIndexForHalfEdges(e){e===void 0&&(e=-1);const i=new Un(this.m_halfEdgeData.capacity(),e);for(let n=0,r=this.m_edgeIndices.length;n<r;n++)if(this.m_edgeIndices[n]===null)return this.m_edgeIndices[n]=i,n;this.m_edgeIndices.push(i);const s=this.m_edgeIndices.length-1;return z(s>=0&&s<=Number.MAX_SAFE_INTEGER),s}deleteUserIndexForHalfEdges(e){this.m_edgeIndices[e]=null}deleteEdgesBreakFaces_(e){for(let i=0,s=e.length;i<s;i++){const n=e[i],r=this.getHalfEdgeChain(n),o=this.getHalfEdgeTwin(n),a=this.getHalfEdgeChain(o);this.setChainHalfEdge_(r,G),this.setChainHalfEdge_(a,G),this.updateVertexToHalfEdgeConnection_(n,!0),this.deleteEdgeImpl_(n)}}doesHalfEdgeBelongToAPolygonInterior(e,i){return z(0),!1}doesHalfEdgeBelongToAPolygonExterior(e,i){return z(0),!1}doesHalfEdgeBelongToAPolygonBoundary(e,i){return z(0),!1}doesHalfEdgeBelongToAPolylineInterior(e,i){return z(0),!1}doesHalfEdgeBelongToAPolylineExterior(e,i){return z(0),!1}doesClusterBelongToAPolygonInterior(e,i){return z(0),!1}doesClusterBelongToAPolygonExterior(e,i){return z(0),!1}doesClusterBelongToAPolygonBoundary(e,i){return z(0),!1}getFirstChain(){return this.m_universeChain}getChainHalfEdge(e){return this.m_chainData.getField(e,1)}getChainParentage(e){return this.m_chainData.getField(e,2)}getChainParent(e){return this.m_chainData.getField(e,3)}getChainFirstIsland(e){return this.m_chainData.getField(e,4)}getChainNextInParent(e){return this.m_chainData.getField(e,5)}getChainNext(e){return this.m_chainData.getField(e,7)}getChainArea(e){const i=this.getChainIndex_(e);let s=this.m_chainAreas.read(i);return Number.isNaN(s)&&(this.updateChainAreaAndPerimeter_(e),s=this.m_chainAreas.read(i)),s}getChainPerimeter(e){return z(0),0}getChainUserIndex(e,i){const s=this.getChainIndex_(e),n=this.m_chainIndices[i];return n.size()<=s?-1:n.read(s)}setChainUserIndex(e,i,s){const n=this.getChainIndex_(e),r=this.m_chainIndices[i];r.size()<=n&&r.resize(this.m_chainData.size(),-1),r.write(n,s)}createUserIndexForChains(){const e=new Un(this.m_chainData.capacity(),-1);for(let i=0,s=this.m_chainIndices.length;i<s;i++)if(this.m_chainIndices[i]===null)return this.m_chainIndices[i]=e,i;return this.m_chainIndices.push(e),this.m_chainIndices.length-1}deleteUserIndexForChains(e){this.m_chainIndices[e]=null}extractPolygonFromChainAndIslands(e,i,s,n){const r=i===G?e.createGeometry(q.enumPolygon):i,o=new ii;this.extractPolygonPathFromChain_(e,r,s,n,o);for(let a=this.getChainFirstIsland(s);a!==G;a=this.getChainNextInParent(a))this.extractPolygonPathFromChain_(e,r,a,n,o);return r}getGeometryID(e){const i=this.m_shape.getGeometryUserIndex(e,this.m_geometryIDIndex);return z(i>=0),1<<Math.min(i,31)}getClusterFromVertex(e){return this.m_shape.getUserIndex(e,this.m_clusterIndex)}getHalfEdgeFromVertex(e){return this.m_shape.getUserIndex(e,this.m_halfEdgeIndex)}buildGeometryParentageSets(){this.m_bBuildGeometryParentageSets=!0}getChainBitSet(e){if(z(this.m_bBuildGeometryParentageSets),this.m_chainBitSetIndex===-1)return this.getEmptySet();const i=this.getChainUserIndex(e,this.m_chainBitSetIndex);z(i>=0);let s=this.m_chainBitSets.at(i);return s||(s=this.getEmptySet()),s}getChainBoundaryBitSet(e){z(this.m_bBuildGeometryParentageSets);const i=new Mh,s=n=>{const r=this.getChainHalfEdge(n);let o=r;do{const a=this.getEdgeBitSet_(o);a!==null&&i.assignOr(a);const l=this.getEdgeBitSet_(this.getHalfEdgeTwin(o));l!==null&&i.assignOr(l),o=this.getHalfEdgeNext(o)}while(o!==r)};s(e);for(let n=this.getChainFirstIsland(e);n!==G;n=this.getChainNextInParent(n))s(e);return i}getChainPolygons(e){return z(0),[]}getGeometriesFromBits(e){if(!this.m_bBuildGeometryParentageSets||e===null)return[];if(this.m_geometryMapID===null){this.m_geometryMapID=new Map;for(let n=this.m_shape.getFirstGeometry();n!==G;n=this.m_shape.getNextGeometry(n))this.m_geometryMapID.set(this.m_shape.getGeometryUserIndex(n,this.m_geometryIDIndex),n)}const i=[],s=e.getUnorderedBitIterator();for(let n=s.next();n!==pA.npos();n=s.next())z(this.m_geometryMapID.has(n)),i.push(this.m_geometryMapID.get(n));return i}getVertexDominant(e,i){if(i===G)return e;const s=this.getClusterFromVertex(e);return this.getVertexDominantFromCluster(s,i)}getVertexDominantFromCluster(e,i){if(i!==G){let s=G;for(let n=this.getClusterVertexIterator(e);n!==G;n=this.incrementVertexIterator(n)){const r=this.getVertexFromVertexIterator(n);s===G&&(s=r);const o=this.m_shape.getPathFromVertex(r);if(this.m_shape.getGeometryFromPath(o)===i){s=r;break}}return s}{const s=this.getClusterVertexIterator(e);return s!==G?this.getVertexFromVertexIterator(s):G}}isBreakNode(e){return this.hasClusterUserIndexFlags(e,this.m_clusterBreakNodeIndex,O_.enumSegmentParentageBreakNode)}setBreakNode(e,i){z(this.m_clusterBreakNodeIndex!==-1),i?this.setClusterUserIndexFlags(e,this.m_clusterBreakNodeIndex,O_.enumSegmentParentageBreakNode):this.clearClusterUserIndexFlags(e,this.m_clusterBreakNodeIndex,O_.enumSegmentParentageBreakNode)}isStrongPathNode(e){return this.hasClusterUserIndexFlags(e,this.m_clusterBreakNodeIndex,O_.enumPathBreakNode)}setStrongPathNode(e,i){if(this.m_clusterBreakNodeIndex===-1){if(!i)return;this.m_clusterBreakNodeIndex=this.createUserIndexForClusters()}i?this.setClusterUserIndexFlags(e,this.m_clusterBreakNodeIndex,O_.enumPathBreakNode):this.clearClusterUserIndexFlags(e,this.m_clusterBreakNodeIndex,O_.enumPathBreakNode)}getSegmentParentage(e){if(this.m_segmentParentageIndex===-1)return-1;const i=this.getHalfEdgeUserIndex(e,this.m_segmentParentageIndex);return i>=0?i:-1}isCrossroadAhead(e){const i=this.getHalfEdgeNext(e);if(this.isStrongPathNode(this.getHalfEdgeOrigin(i)))return!0;const s=this.getHalfEdgeTwin(i),n=this.getHalfEdgeNext(s);return e!==this.getHalfEdgeTwin(n)}isCrossroadBehind(e){return z(0),!1}getHalfEdgeConnector(e,i){const s=this.getClusterHalfEdge(e);if(s===G)return G;let n=s,r=G,o=G;do{if(this.getHalfEdgeTo(n)===i)return n;if(r===G){if(r=this.getClusterHalfEdge(i),r===G)return G;o=r}if(this.getHalfEdgeTo(o)===e)return n=this.getHalfEdgeTwin(o),n;n=this.getHalfEdgeNext(this.getHalfEdgeTwin(n)),o=this.getHalfEdgeNext(this.getHalfEdgeTwin(o))}while(n!==s&&o!==r);return G}querySegmentXY(e,i){if(this.m_segmentIndexHe!==-1){let r=this.getHalfEdgeUserIndex(e,this.m_segmentIndexHe);if(r!==-1){if(r!==-2){const o=this.m_shape.getSegmentFromIndex(r);i.copyFrom(o,!0)}else{r=this.getHalfEdgeUserIndex(this.getHalfEdgeTwin(e),this.m_segmentIndexHe);const o=this.m_shape.getSegmentFromIndex(r);i.copyFrom(o,!0),i.get().reverse()}return}}i.createLine();const s=i.get(),n=N.getNAN();this.getHalfEdgeFromXY(e,n),s.setStartXY(n),this.getHalfEdgeToXY(e,n),s.setEndXY(n)}isCurveEdge(e){return this.m_segmentIndexHe!==-1?this.getHalfEdgeUserIndex(e,this.m_segmentIndexHe)!==-1:!1}compareEdgeAnglesCurveHelper_(e,i,s){const n=new ii,r=new ii;this.querySegmentXY(e,n),this.querySegmentXY(i,r);const o=n.get(),a=r.get();if(o.equals(a))return 0;const l=new N;this.getHalfEdgeFromXY(e,l);const u=new N;this.getHalfEdgeToXY(e,u);const c=new N;this.getHalfEdgeToXY(i,c),z(!u.isEqualPoint2D(c));const h=o.getTangent(0),d=a.getTangent(0);return N.compareVectors(h,d)}compareEdgeAnglesHelper_(e,i,s){if(e===i)return 0;if(this.isHalfEdgeCurve(e)||this.isHalfEdgeCurve(i))return this.compareEdgeAnglesCurveHelper_(e,i,s);const n=N.getNAN();this.getHalfEdgeToXY(e,n);const r=N.getNAN();if(this.getHalfEdgeToXY(i,r),n.isEqualPoint2D(r))return 0;const o=N.getNAN();this.getHalfEdgeFromXY(e,o);const a=N.getNAN();a.setSub(n,o);const l=N.getNAN();return l.setSub(r,o),!s||l.y>=0&&a.y>0?N.compareVectors(a,l):0}compareEdgeAngles_(e,i){return this.compareEdgeAnglesHelper_(e,i,!1)}compareEdgeAnglesForPair_(e,i){return this.compareEdgeAnglesHelper_(e,i,!0)}compareEdgeAngles3D_(e,i){return z(0),0}compareEdgeAnglesForPair3D_(e,i){return z(0),0}dbgDumpChains_(){}dbgDumpChainToPolygon_(e,i){}deleteEdgeInternal_(e){const i=this.getHalfEdgeChain(e),s=this.getHalfEdgeTwin(e),n=this.getHalfEdgeChain(s);z(n===i),z(e===this.getHalfEdgeNext(s)||s===this.getHalfEdgeNext(e));let r=this.getHalfEdgeNext(e);r===s&&(r=this.getHalfEdgeNext(r),r===e&&(r=G));const o=this.getChainIndex_(i),a=this.m_chainAreas.read(o);Number.isNaN(a)||(this.setChainArea_(i,Number.NaN),this.setChainPerimeter_(i,Number.NaN));const l=this.getChainHalfEdge(i);l!==e&&l!==s||this.setChainHalfEdge_(i,r),this.updateVertexToHalfEdgeConnection_(e,!0),this.deleteEdgeImpl_(e)}getFirstUnvisitedHalfEdgeOnCluster_(e,i,s){let n=i!==G?i:this.getClusterHalfEdge(e);if(n===G)return G;const r=n;for(;;){if(this.getHalfEdgeUserIndex(n,s)!==1)return n;const o=this.getHalfEdgeNext(this.getHalfEdgeTwin(n));if(o===r)return G;n=o}}removeSpikes_(){let e=!1;const i=this.createUserIndexForHalfEdges();for(let s=this.getFirstCluster();s!==G;s=this.getNextCluster(s)){let n=G;for(;;){let r=this.getFirstUnvisitedHalfEdgeOnCluster_(s,n,i);if(r===G)break;n=this.getHalfEdgeNext(this.getHalfEdgeTwin(r));let o=r;for(;;){const a=this.getHalfEdgeNext(o),l=this.getHalfEdgePrev(o),u=this.getHalfEdgeTwin(o);if(l===u){if(this.deleteEdgeInternal_(o),e=!0,n!==o&&n!==u||(n=G),o===r||l===r){if(r=a,o===r||l===r)break;o=a;continue}}else this.setHalfEdgeUserIndex(o,i,1);if(o=a,o===r)break}}}return this.deleteUserIndexForHalfEdges(i),e}progress_(e,i=!1){}newCluster_(){const e=this.m_clusterData.newElement();return this.m_clusterData.setField(e,1,0),e}newHalfEdgePair_(){const e=this.m_halfEdgeData.newElement();this.m_halfEdgeData.setField(e,2,0),this.m_halfEdgeData.setField(e,3,0);const i=this.m_halfEdgeData.newElement();return this.m_halfEdgeData.setField(i,2,0),this.m_halfEdgeData.setField(i,3,0),this.setHalfEdgeTwin_(e,i),this.setHalfEdgeTwin_(i,e),e}newChain_(){const e=this.m_chainData.newElement();return this.m_chainData.setField(e,2,0),e}deleteChain_(e){return z(0),0}getClusterIndex_(e){return this.m_clusterData.elementToIndex(e)}setClusterVertexIterator_(e,i){this.m_clusterData.setField(e,7,i)}setClusterHalfEdge_(e,i){this.m_clusterData.setField(e,2,i)}setClusterParentage_(e,i){this.m_clusterData.setField(e,1,i)}setPrevCluster_(e,i){this.m_clusterData.setField(e,3,i)}setNextCluster_(e,i){this.m_clusterData.setField(e,4,i)}setClusterVertexIndex_(e,i){this.m_clusterData.setField(e,5,i)}getClusterVertexIndex_(e){return this.m_clusterData.getField(e,5)}setClusterChain_(e,i){this.m_clusterData.setField(e,6,i)}addClusterToExteriorChain_(e,i){this.setClusterChain_(i,e)}getHalfEdgeIndex_(e){return this.m_halfEdgeData.elementToIndex(e)}setHalfEdgeOrigin_(e,i){this.m_halfEdgeData.setField(e,1,i)}setHalfEdgeTwin_(e,i){this.m_halfEdgeData.setField(e,4,i)}setHalfEdgePrev_(e,i){this.m_halfEdgeData.setField(e,5,i)}setHalfEdgeNext_(e,i){this.m_halfEdgeData.setField(e,6,i)}setHalfEdgeChain_(e,i){this.m_halfEdgeData.setField(e,2,i)}setHalfEdgeParentage_(e,i){this.m_halfEdgeData.setField(e,3,i)}getHalfEdgeParentageMask_(e){return this.m_halfEdgeData.getField(e,3)}setHalfEdgeVertexIterator_(e,i){this.m_halfEdgeData.setField(e,7,i)}updateVertexToHalfEdgeConnectionHelper_(e,i){const s=i?G:e;for(let n=this.getHalfEdgeVertexIterator(e);n!==G;n=this.incrementVertexIterator(n)){const r=this.getVertexFromVertexIterator(n);this.m_shape.setUserIndex(r,this.m_halfEdgeIndex,s)}}updateVertexToHalfEdgeConnection_(e,i){e!==G&&(this.updateVertexToHalfEdgeConnectionHelper_(e,i),this.updateVertexToHalfEdgeConnectionHelper_(this.getHalfEdgeTwin(e),i))}getChainIndex_(e){return this.m_chainData.elementToIndex(e)}setChainHalfEdge_(e,i){this.m_chainData.setField(e,1,i)}setChainParentage_(e,i){this.m_chainData.setField(e,2,i)}setChainParent_(e,i){this.m_chainData.setField(e,3,i);const s=this.getChainFirstIsland(i);this.setChainNextInParent_(e,s),this.setChainFirstIsland_(i,e)}setChainFirstIsland_(e,i){this.m_chainData.setField(e,4,i)}setChainNextInParent_(e,i){this.m_chainData.setField(e,5,i)}setChainPrev_(e,i){this.m_chainData.setField(e,6,i)}setChainNext_(e,i){this.m_chainData.setField(e,7,i)}setChainArea_(e,i){const s=this.getChainIndex_(e);this.m_chainAreas.write(s,i)}setChainPerimeter_(e,i){const s=this.getChainIndex_(e);this.m_chainPerimeters.write(s,i)}updateChainAreaAndPerimeter_(e){const i=this.m_shape.hasCurves(),s=new Wr(0),n=new Wr(0),r=this.getChainHalfEdge(e),o=N.getNAN(),a=N.getNAN(),l=N.getNAN();this.getHalfEdgeFromXY(r,o),a.setCoordsPoint2D(o);let u=r;do this.getHalfEdgeToXY(u,l),i&&this.isCurveEdge(u)||n.pe(N.distance(a,l)),this.getHalfEdgeChain(this.getHalfEdgeTwin(u))!==e&&s.pe((l.x-o.x-(a.x-o.x))*(l.y-o.y+(a.y-o.y))*.5),a.setCoordsPoint2D(l),u=this.getHalfEdgeNext(u);while(u!==r);if(i){const h=new ii;u=r;do{this.getHalfEdgeToXY(u,l);const d=this.isCurveEdge(u);if(d&&(this.querySegmentXY(u,h),n.pe(h.get().calculateLength2D())),this.getHalfEdgeChain(this.getHalfEdgeTwin(u))!==e&&d){const m=h.get().calculateArea2DHelper();s.pe(m)}u=this.getHalfEdgeNext(u)}while(u!==r)}const c=this.getChainIndex_(e);this.m_chainAreas.write(c,s.getResult()),this.m_chainPerimeters.write(c,n.getResult())}getChainTopmostEdge_(e){return z(0),0}planeSweepParentage_(e,i){const s=new A4e(this),n=new mr;n.setCapacity(Math.trunc(this.m_pointCount/2)),n.setComparator(s);const r=[],o=this.createUserIndexForHalfEdges();let a=null;const l=N.getNAN();for(let u=this.getFirstCluster();u!==G;u=this.getNextCluster(u)){this.progress_(i);const c=this.getClusterHalfEdge(u);if(c!==G){if(r.length=0,!this.tryOptimizedInsertion_(n,o,r,u,c)){this.queryXY(u,l),s.setY(l.y);let h=c;do{const d=this.getHalfEdgeUserIndex(h,o);d!==-1&&(n.deleteNode(d),this.setHalfEdgeUserIndex(h,o,xs.impossibleIndex2())),h=this.getHalfEdgeNext(this.getHalfEdgeTwin(h))}while(c!==h);h=c;do{if(this.getHalfEdgeUserIndex(h,o)===-1){const d=n.addElement(h);r.push(d)}h=this.getHalfEdgeNext(this.getHalfEdgeTwin(h))}while(c!==h)}for(let h=r.length-1;h>=0;h--){const d=r[h],m=n.getElement(d),f=this.getHalfEdgeTwin(m);this.setHalfEdgeUserIndex(f,o,d),this.planeSweepParentagePropagateParentage_(n,d,e)}}else if(this.getClusterChain(u)===G){a===null&&(a=new I4e(this)),this.queryXY(u,l),a.setPointXY(l);const h=n.searchLowerBound(a);let d=this.m_universeChain;if(h!==-1){let m=n.getElement(h);this.getHalfEdgeChain(m)===this.getHalfEdgeChain(this.getHalfEdgeTwin(m))&&(m=this.getLeftSkipPolylines_(n,h)),m!==G&&(d=this.getHalfEdgeChain(m))}this.addClusterToExteriorChain_(d,u)}}this.deleteUserIndexForHalfEdges(o)}planeSweepParentagePropagateParentage_(e,i,s){const n=e.getElement(i),r=this.getHalfEdgeChain(n);if(this.getChainParent(r)!==G)return;const o=this.getLeftSkipPolylines_(e,i),a=this.getHalfEdgeTwin(n),l=this.getHalfEdgeChain(a);let u=this.getChainParent(r),c=this.getChainParent(l);if(o===G)u===G&&(l===r?(this.setChainParent_(l,this.m_universeChain),c=this.m_universeChain,u=c):(c===G&&(this.setChainParent_(l,this.m_universeChain),c=this.m_universeChain),this.setChainParent_(r,l),u=l));else{const h=this.getHalfEdgeChain(o);if(c===G){if(this.getChainArea(h)<=0){const d=this.getChainParent(h);this.setChainParent_(l,d),c=d}else this.setChainParent_(l,h),c=h;l===r&&(u=c)}}u===G&&(this.trySetChainParentFromTwin_(r,l),u=this.getChainParent(r)),z(u!==G),s===Ca.enumInputModeBuildGraph?this.propagateParentageBuildGraph_(e,i,n,o):s===Ca.enumInputModeSimplifyWinding?this.propagateParentageWinding_(e,i,n,o,a,r,l):s===Ca.enumInputModeSimplifyAlternate&&this.propagateParentageAlternate_(e,i,n,o,a,r,l)}propagateParentageBuildGraph_(e,i,s,n){let r,o=i;n===G?(o=e.getNext(o),r=this.getHalfEdgeChain(s)):r=this.getHalfEdgeChain(n);let a=null,l=this.getChainParentage(r);for(this.m_bBuildGeometryParentageSets&&(a=this.getChainBitSet(r));o!==-1;o=e.getNext(o)){const u=e.getElement(o),c=this.getHalfEdgeTwin(u);r=this.getHalfEdgeChain(u);const h=this.getHalfEdgeChain(c);if(this.m_bBuildGeometryParentageSets){let v=this.getChainBitSet(h);v=new Mh({copy:v}),v.assignOr(a),this.setChainBitSet_(h,v);let x=this.getChainBitSet(r);const w=this.getLeftEdgeBitSet_(u),T=new Mh({copy:a});if(T.assignSubtract(w),T.isZero())break;x=new Mh({copy:x}),x.assignOr(T),this.setChainBitSet_(r,x),a=x}const d=this.getChainParentage(h),m=d|l;m!==d&&this.setChainParentage_(h,m);let f=this.getChainParentage(r);const _=l&~this.getHalfEdgeUserIndex(u,this.m_tmpHalfEdgeParentageIndexLeft);if(_&&(f|=_,this.setChainParentage_(r,f)),_===0)break;l=f}}propagateParentageWinding_(e,i,s,n,r,o,a){if(o===a)return;let l=this.getHalfEdgeUserIndex(s,this.m_tmpHalfEdgeWindingNumberIndex);l+=this.getHalfEdgeUserIndex(r,this.m_tmpHalfEdgeWindingNumberIndex);let u=0;const c=[],h=[];h.push(0);for(let d=e.getFirst();d!==i;d=e.getNext(d)){const m=e.getElement(d),f=this.getHalfEdgeTwin(m),_=this.getHalfEdgeChain(m),v=this.getHalfEdgeChain(f);if(_!==v){let x=this.getHalfEdgeUserIndex(m,this.m_tmpHalfEdgeWindingNumberIndex);x+=this.getHalfEdgeUserIndex(f,this.m_tmpHalfEdgeWindingNumberIndex),u+=x;let w=!1;c.length!==0&&c.at(-1)===v&&(h.pop(),c.pop(),w=!0),z(this.getChainParent(v)!==G),w&&this.getChainParent(v)===_||(h.push(u),c.push(_))}}if(u+=l,c.length!==0&&c.at(-1)===a&&(h.pop(),c.pop()),u!==0){if(h.at(-1)===0){const d=this.m_simplifiedGeometry,m=this.getGeometryID(d);this.setChainParentage_(o,m)}}else if(h.at(-1)!==0){const d=this.m_simplifiedGeometry,m=this.getGeometryID(d);this.setChainParentage_(o,m)}}propagateParentageAlternate_(e,i,s,n,r,o,a){const l=this.m_simplifiedGeometry,u=this.getGeometryID(l);if(n===G)this.setChainParentage_(a,this.m_universeGeomID),1&this.getHalfEdgeUserIndex(s,this.m_tmpHalfEdgeOddEvenNumberIndex)?this.setChainParentage_(o,u):this.setChainParentage_(o,this.m_universeGeomID);else{const c=this.getChainParentage(a);if(c===0){const h=this.getHalfEdgeChain(n),d=this.getChainParentage(h);this.setChainParentage_(a,d),1&this.getHalfEdgeUserIndex(s,this.m_tmpHalfEdgeOddEvenNumberIndex)?this.setChainParentage_(o,d===u?this.m_universeGeomID:u):this.setChainParentage_(o,d)}else 1&this.getHalfEdgeUserIndex(s,this.m_tmpHalfEdgeOddEvenNumberIndex)?this.setChainParentage_(o,c===u?this.m_universeGeomID:u):this.setChainParentage_(o,c)}}tryOptimizedInsertion_(e,i,s,n,r){let o=r,a=-1,l=G,u=0;do{if(u===2)return!1;const c=this.getHalfEdgeUserIndex(o,i);if(c!==-1){if(a!==-1)return!1;a=c}else{if(l!==G)return!1;l=o}u++,o=this.getHalfEdgeNext(this.getHalfEdgeTwin(o))}while(r!==o);return l!==G&&a!==-1&&(this.setHalfEdgeUserIndex(e.getElement(a),i,xs.impossibleIndex2()),e.setElement(a,l),s.push(a),!0)}trySetChainParentFromTwin_(e,i){const s=this.getChainArea(e);if(s===0)return!1;const n=this.getChainArea(i);if(s>0&&n<0||s<0&&n>0)return this.setChainParent_(e,i),!0;{const r=this.getChainParent(i);if(r!==G)return this.setChainParent_(e,r),!0}return!1}createHalfEdges_(e,i){this.m_halfEdgeIndex=this.m_shape.createUserIndex();for(let s=0,n=i.size();s<n;s++){const r=i.read(s),o=this.m_shape.getUserIndex(r,this.m_clusterIndex),a=this.m_shape.getPathFromVertex(r),l=this.m_shape.getGeometryFromPath(a),u=this.m_shape.getGeometryType(l);if(Ei(u)){const c=this.m_shape.getNextVertex(r);if(c===G)continue;const h=this.m_shape.getUserIndex(c,this.m_clusterIndex);if(o===h)continue;const d=this.newHalfEdgePair_(),m=this.getHalfEdgeTwin(d),f=this.m_clusterVertices.newElement();this.m_clusterVertices.setField(f,0,r),this.m_clusterVertices.setField(f,1,-1),this.setHalfEdgeVertexIterator_(d,f),this.m_shape.setUserIndex(r,this.m_halfEdgeIndex,d),this.setHalfEdgeOrigin_(d,o);const _=this.getClusterHalfEdge(o);if(_===G)this.setClusterHalfEdge_(o,d),this.setHalfEdgePrev_(d,m),this.setHalfEdgeNext_(m,d);else{const T=this.getHalfEdgePrev(_);this.setHalfEdgePrev_(_,m),this.setHalfEdgeNext_(m,_),this.setHalfEdgeNext_(T,d),this.setHalfEdgePrev_(d,T)}this.setHalfEdgeOrigin_(m,h);const v=this.getClusterHalfEdge(h);if(v===G)this.setClusterHalfEdge_(h,m),this.setHalfEdgeNext_(d,m),this.setHalfEdgePrev_(m,d);else{const T=this.getHalfEdgePrev(v);this.setHalfEdgePrev_(v,d),this.setHalfEdgeNext_(d,v),this.setHalfEdgeNext_(T,m),this.setHalfEdgePrev_(m,T)}const x=this.getGeometryID(l);if(e===Ca.enumInputModeBuildGraph){const T=u===q.enumPolygon?x:0;if(this.setHalfEdgeUserIndex(m,this.m_tmpHalfEdgeParentageIndex,0),this.setHalfEdgeUserIndex(d,this.m_tmpHalfEdgeParentageIndex,T),this.setHalfEdgeUserIndex(m,this.m_tmpHalfEdgeParentageIndexLeft,T),this.setHalfEdgeUserIndex(d,this.m_tmpHalfEdgeParentageIndexLeft,0),this.m_bBuildGeometryParentageSets){const C=new Mh,M=this.m_shape.getGeometryUserIndex(l,this.m_geometryIDIndex);C.setBit(M),this.setEdgeBitSet_(d,C),this.setEdgeBitSet_(m,null),this.setLeftEdgeBitSet_(m,C),this.setLeftEdgeBitSet_(d,null)}}else if(e===Ca.enumInputModeSimplifyWinding){const T=this.m_shape.getXY(r),C=this.m_shape.getXY(c);let M=0,A=0;T.compare(C)<0?M=1:A=-1,this.setHalfEdgeUserIndex(d,this.m_tmpHalfEdgeWindingNumberIndex,M),this.setHalfEdgeUserIndex(m,this.m_tmpHalfEdgeWindingNumberIndex,A)}else e===Ca.enumInputModeSimplifyAlternate&&(this.setHalfEdgeUserIndex(d,this.m_tmpHalfEdgeOddEvenNumberIndex,1),this.setHalfEdgeUserIndex(m,this.m_tmpHalfEdgeOddEvenNumberIndex,1));const w=u===q.enumPolygon?sc.c_EdgeBitMask:0;this.setHalfEdgeParentage_(d,x|w),this.setHalfEdgeParentage_(m,x|w)}}if(this.m_shape.hasCurves()){this.m_segmentIndexHe=this.createUserIndexForHalfEdges();for(let s=0,n=i.size();s<n;s++){const r=i.read(s);if(this.m_shape.getSegment(r)){const o=this.m_shape.getUserIndex(r,this.m_halfEdgeIndex);o!==G&&(this.setHalfEdgeUserIndex(o,this.m_segmentIndexHe,this.m_shape.getVertexIndex(r)),this.setHalfEdgeUserIndex(this.getHalfEdgeTwin(o),this.m_segmentIndexHe,-2))}}}}mergeVertexListsOfEdges_(e,i){{const r=this.getHalfEdgeVertexIterator(i);if(r!==G){const o=this.getHalfEdgeVertexIterator(e);this.m_clusterVertices.setField(r,1,o),this.setHalfEdgeVertexIterator_(e,r),this.setHalfEdgeVertexIterator_(i,G)}}const s=this.getHalfEdgeTwin(e),n=this.getHalfEdgeTwin(i);{const r=this.getHalfEdgeVertexIterator(n);if(r!==G){const o=this.getHalfEdgeVertexIterator(s);this.m_clusterVertices.setField(r,1,o),this.setHalfEdgeVertexIterator_(s,r),this.setHalfEdgeVertexIterator_(n,G)}}if(this.m_segmentIndexHe!==-1){let r=this.getHalfEdgeUserIndex(e,this.m_segmentIndexHe);if(r!==-1){if(r===-2){const o=this.getHalfEdgeUserIndex(i,this.m_segmentIndexHe);this.setHalfEdgeUserIndex(e,this.m_segmentIndexHe,o)}if(r=this.getHalfEdgeUserIndex(s,this.m_segmentIndexHe),r===-2){const o=this.getHalfEdgeUserIndex(n,this.m_segmentIndexHe);this.setHalfEdgeUserIndex(s,this.m_segmentIndexHe,o)}}}}sortHalfEdgesByAngle_(e){const i=[];for(let s=this.getFirstCluster();s!==G;s=this.getNextCluster(s)){i.length=0;const n=this.getClusterHalfEdge(s);if(n!==G){let r=n;do i.push(r),r=this.getHalfEdgeNext(this.getHalfEdgeTwin(r));while(r!==n);if(i.length>1){let o=!0;i.length>2?(i.sort((d,m)=>this.compareEdgeAngles_(d,m)),i.push(i[0])):this.compareEdgeAnglesForPair_(i[0],i[1])>0?i[1]=Ge(i[0],i[0]=i[1]):o=!1;let a=i[0],l=a,u=this.getHalfEdgeTo(l),c=this.getHalfEdgeTwin(l),h=G;for(let d=1,m=i.length;d<m;d++){const f=i[d],_=this.getHalfEdgeTwin(f),v=this.getHalfEdgeOrigin(_);if(v!==u||f===l)this.updateVertexToHalfEdgeConnection_(h,!1),h=G,l=f,u=v,c=_;else{if(e===Ca.enumInputModeBuildGraph){const x=this.getHalfEdgeParentageMask_(l)|this.getHalfEdgeParentageMask_(f);if(this.setHalfEdgeParentage_(l,x),this.setHalfEdgeParentage_(c,x),this.setHalfEdgeUserIndex(l,this.m_tmpHalfEdgeParentageIndex,this.getHalfEdgeUserIndex(l,this.m_tmpHalfEdgeParentageIndex)|this.getHalfEdgeUserIndex(f,this.m_tmpHalfEdgeParentageIndex)),this.setHalfEdgeUserIndex(c,this.m_tmpHalfEdgeParentageIndex,this.getHalfEdgeUserIndex(c,this.m_tmpHalfEdgeParentageIndex)|this.getHalfEdgeUserIndex(_,this.m_tmpHalfEdgeParentageIndex)),this.setHalfEdgeUserIndex(l,this.m_tmpHalfEdgeParentageIndexLeft,this.getHalfEdgeUserIndex(l,this.m_tmpHalfEdgeParentageIndexLeft)|this.getHalfEdgeUserIndex(f,this.m_tmpHalfEdgeParentageIndexLeft)),this.setHalfEdgeUserIndex(c,this.m_tmpHalfEdgeParentageIndexLeft,this.getHalfEdgeUserIndex(c,this.m_tmpHalfEdgeParentageIndexLeft)|this.getHalfEdgeUserIndex(_,this.m_tmpHalfEdgeParentageIndexLeft)),this.m_bBuildGeometryParentageSets){let w,T,C;w=this.getEdgeBitSet_(l),T=this.getEdgeBitSet_(f),C=new Mh({copy:w}),C.assignOr(T),this.setEdgeBitSet_(l,C),w=this.getEdgeBitSet_(c),T=this.getEdgeBitSet_(_),C=new Mh({copy:w}),C.assignOr(T),this.setEdgeBitSet_(c,C),w=this.getLeftEdgeBitSet_(l),T=this.getLeftEdgeBitSet_(f),C=new Mh({copy:w}),C.assignOr(T),this.setLeftEdgeBitSet_(l,C),w=this.getLeftEdgeBitSet_(c),T=this.getLeftEdgeBitSet_(_),C=new Mh({copy:w}),C.assignOr(T),this.setLeftEdgeBitSet_(c,C)}}else if(this.m_tmpHalfEdgeWindingNumberIndex!==-1){const x=this.getHalfEdgeUserIndex(l,this.m_tmpHalfEdgeWindingNumberIndex)+this.getHalfEdgeUserIndex(f,this.m_tmpHalfEdgeWindingNumberIndex),w=this.getHalfEdgeUserIndex(c,this.m_tmpHalfEdgeWindingNumberIndex)+this.getHalfEdgeUserIndex(_,this.m_tmpHalfEdgeWindingNumberIndex);this.setHalfEdgeUserIndex(l,this.m_tmpHalfEdgeWindingNumberIndex,x),this.setHalfEdgeUserIndex(c,this.m_tmpHalfEdgeWindingNumberIndex,w)}else if(this.m_tmpHalfEdgeOddEvenNumberIndex!==-1){const x=this.getHalfEdgeUserIndex(l,this.m_tmpHalfEdgeOddEvenNumberIndex)+this.getHalfEdgeUserIndex(f,this.m_tmpHalfEdgeOddEvenNumberIndex),w=this.getHalfEdgeUserIndex(c,this.m_tmpHalfEdgeOddEvenNumberIndex)+this.getHalfEdgeUserIndex(_,this.m_tmpHalfEdgeOddEvenNumberIndex);this.setHalfEdgeUserIndex(l,this.m_tmpHalfEdgeOddEvenNumberIndex,x),this.setHalfEdgeUserIndex(c,this.m_tmpHalfEdgeOddEvenNumberIndex,w)}this.mergeVertexListsOfEdges_(l,f),this.deleteEdgeImpl_(f),h=l,i[d]=G,f===a&&(i[0]=G,a=G)}}if(this.updateVertexToHalfEdgeConnection_(h,!1),h=G,!o){a=G;for(let d=0,m=i.length;d<m;d++){const f=i[d];if(f!==G){a=f;break}}n!==a&&this.setClusterHalfEdge_(s,a);continue}a=G;for(let d=0,m=i.length;d<m;d++){const f=i[d];if(f===G)continue;if(a===G){a=f,l=a,u=this.getHalfEdgeTo(l),c=this.getHalfEdgeTwin(l);continue}if(f===l)continue;const _=this.getHalfEdgeTwin(f),v=this.getHalfEdgeOrigin(_);this.setHalfEdgeNext_(c,f),this.setHalfEdgePrev_(f,c),l=f,u=v,c=_}this.setClusterHalfEdge_(s,a)}}}}sortHalfEdgesByAngle3D_(e){z(0)}buildChains_(e){this.m_universeChain=this.newChain_(),this.setChainHalfEdge_(this.m_universeChain,G);let i=this.m_universeChain;const s=this.createUserIndexForHalfEdges();for(let n=this.getFirstCluster();n!==G;n=this.getNextCluster(n)){const r=this.getClusterHalfEdge(n);if(r!==G){let o=r;do{if(this.getHalfEdgeUserIndex(o,s)!==1){const a=this.newChain_();this.setChainHalfEdge_(a,o),this.setChainPrev_(a,i),this.setChainNext_(i,a);let l=null;this.m_bBuildGeometryParentageSets&&(l=new Mh),i=a;let u=0,c=o;do this.m_tmpHalfEdgeParentageIndex!==-1&&(u|=this.getHalfEdgeUserIndex(c,this.m_tmpHalfEdgeParentageIndex)),this.m_bBuildGeometryParentageSets&&l.assignOr(this.getEdgeBitSet_(c)),this.setHalfEdgeChain_(c,a),this.setHalfEdgeUserIndex(c,s,1),c=this.getHalfEdgeNext(c);while(c!==o);this.m_bBuildGeometryParentageSets&&this.setChainBitSet_(a,l),this.setChainParentage_(a,u)}o=this.getHalfEdgeNext(this.getHalfEdgeTwin(o))}while(o!==r)}}this.m_chainAreas=new FP(this.m_chainData.size(),Number.NaN),this.m_chainPerimeters=new FP(this.m_chainData.size(),Number.NaN),this.setChainArea_(this.m_universeChain,Number.POSITIVE_INFINITY),this.setChainPerimeter_(this.m_universeChain,Number.POSITIVE_INFINITY),this.deleteUserIndexForHalfEdges(s)}simplify_(e){z(0)}simplifyAlternate_(){z(0)}simplifyWinding_(){z(0)}setEditShapeImpl_(e,i,s,n,r){this.removeShape(),this.m_bBuildChains=r,this.m_shape=e,this.m_geometryIDIndex=this.m_shape.createGeometryUserIndex();let o=this.m_shape.getTotalPointCount();if(s){o=0;for(let m=0,f=s.length;m<f;m++)o+=this.m_shape.getPointCount(s[m])}const a=new Un(0);let l=0,u=0;{let m=s!=null?s[0]:this.m_shape.getFirstGeometry(),f=1;for(;m!==G;){this.m_shape.setGeometryUserIndex(m,this.m_geometryIDIndex,u++);for(let _=this.m_shape.getFirstPath(m);_!==G;_=this.m_shape.getNextPath(_)){let v=this.m_shape.getFirstVertex(_);for(let x=0,w=this.m_shape.getPathSize(_);x<w;x++)a.add(v),v=this.m_shape.getNextVertex(v)}lS(this.m_shape.getGeometryType(m))||(l+=this.m_shape.getPathCount(m)),s!=null?(m=f<s.length?s[f]:G,f++):m=this.m_shape.getNextGeometry(m)}}this.m_universeGeomID=1<<Math.min(u,31),this.m_pointCount=a.size(),this.m_shape.sortVerticesSimpleByY(a,0,this.m_pointCount),this.m_clusterVertices.setCapacity(this.m_pointCount),this.progress_(n,!0),this.m_clusterData.setCapacity(this.m_pointCount+10),this.m_halfEdgeData.setCapacity(2*this.m_pointCount+32),this.m_chainData.setCapacity(Math.max(32,l)),this.m_clusterIndex=this.m_shape.createUserIndex();const c=N.getNAN();let h=0;const d=N.getNAN();for(let m=0;m<=this.m_pointCount;m++){if(m<this.m_pointCount){const f=a.read(m);this.m_shape.queryXY(f,d)}else d.setNAN();if(!c.isEqualPoint2D(d)){if(h<m){const f=this.newCluster_();let _=G,v=-1;for(let x=h;x<m;x++){v=a.read(x),this.m_shape.setUserIndex(v,this.m_clusterIndex,f);const w=this.m_clusterVertices.newElement();this.m_clusterVertices.setField(w,0,v),this.m_clusterVertices.setField(w,1,_),_=w;const T=this.m_shape.getPathFromVertex(v),C=this.m_shape.getGeometryFromPath(T),M=this.getGeometryID(C);this.setClusterParentage_(f,this.getClusterParentage(f)|M)}this.setClusterVertexIterator_(f,_),this.setClusterVertexIndex_(f,this.m_shape.getVertexIndex(v)),this.m_lastCluster!==G&&this.setNextCluster_(this.m_lastCluster,f),this.setPrevCluster_(f,this.m_lastCluster),this.m_lastCluster=f,this.m_firstCluster===G&&(this.m_firstCluster=f)}h=m,c.setCoordsPoint2D(d)}}if(this.m_shape.hasSegmentParentage()){this.m_clusterBreakNodeIndex===-1&&(this.m_clusterBreakNodeIndex=this.createUserIndexForClusters());for(let m=0;m<this.m_pointCount;m++){const f=a.read(m);if(this.m_shape.getSegmentParentageBreakVertex(f)){const _=this.getClusterFromVertex(f);this.setBreakNode(_,!0)}}}this.progress_(n,!0);{let m=s!=null?s[0]:this.m_shape.getFirstGeometry(),f=1;for(;m!==G;){for(let _=this.m_shape.getFirstPath(m);_!==G;_=this.m_shape.getNextPath(_)){if(this.m_shape.isStrongPathStart(_)){const v=this.m_shape.getFirstVertex(_),x=this.getClusterFromVertex(v);this.setStrongPathNode(x,!0)}if(this.m_shape.isStrongPathEnd(_)){const v=this.m_shape.isClosedPath(_)?this.m_shape.getFirstVertex(_):this.m_shape.getLastVertex(_),x=this.getClusterFromVertex(v);this.setStrongPathNode(x,!0)}}s!=null?(m=f<s.length?s[f]:G,f++):m=this.m_shape.getNextGeometry(m)}}if(i===Ca.enumInputModeBuildGraph&&(this.m_tmpHalfEdgeParentageIndex=this.createUserIndexForHalfEdges(),this.m_tmpHalfEdgeParentageIndexLeft=this.createUserIndexForHalfEdges()),i===Ca.enumInputModeSimplifyWinding&&(this.m_tmpHalfEdgeWindingNumberIndex=this.createUserIndexForHalfEdges()),i===Ca.enumInputModeSimplifyAlternate&&(this.m_tmpHalfEdgeOddEvenNumberIndex=this.createUserIndexForHalfEdges()),this.createHalfEdges_(i,a),this.dbgNavigate_(),this.sortHalfEdgesByAngle_(i),!Number.isNaN(this.m_checkDirtyPlanesweepTolerance)&&!this.checkStructureAfterDirtySweep_())return this.m_bDirtyCheckFailed=!0,void this.cleanSetEditShapeImpl_();this.buildChains_(i),this.m_tmpHalfEdgeParentageIndex!==-1&&(this.deleteUserIndexForHalfEdges(this.m_tmpHalfEdgeParentageIndex),this.m_tmpHalfEdgeParentageIndex=-1),this.m_bBuildChains&&this.planeSweepParentage_(i,n),this.m_tmpHalfEdgeParentageIndexLeft!==-1&&(this.deleteUserIndexForHalfEdges(this.m_tmpHalfEdgeParentageIndexLeft),this.m_tmpHalfEdgeParentageIndexLeft=-1),this.dbgChkChainParents_(),this.dbgDumpChains_(),this.mergeSegmentParentage_(),this.dbgNavigate_(),this.dbgDumpChains_(),this.cleanSetEditShapeImpl_()}setEditShapeImpl3D_(e,i,s,n,r){z(0)}cleanSetEditShapeImpl_(){this.m_tmpHalfEdgeParentageIndex!==-1&&(this.deleteUserIndexForHalfEdges(this.m_tmpHalfEdgeParentageIndex),this.m_tmpHalfEdgeParentageIndex=-1),this.m_tmpHalfEdgeParentageIndexLeft!==-1&&(this.deleteUserIndexForHalfEdges(this.m_tmpHalfEdgeParentageIndexLeft),this.m_tmpHalfEdgeParentageIndexLeft=-1),this.m_tmpHalfEdgeWindingNumberIndex!==-1&&(this.deleteUserIndexForHalfEdges(this.m_tmpHalfEdgeWindingNumberIndex),this.m_tmpHalfEdgeWindingNumberIndex=-1),this.m_tmpHalfEdgeOddEvenNumberIndex!==-1&&(this.deleteUserIndexForHalfEdges(this.m_tmpHalfEdgeOddEvenNumberIndex),this.m_tmpHalfEdgeOddEvenNumberIndex=-1)}cleanSetEditShapeImpl3D_(){z(0)}dbgNavigate_(){}dbgChkChainParents_(){}deleteEdgeImpl_(e){const i=this.getHalfEdgeNext(e),s=this.getHalfEdgePrev(e),n=this.getHalfEdgeTwin(e),r=this.getHalfEdgeNext(n),o=this.getHalfEdgePrev(n);i!==n&&(this.setHalfEdgeNext_(o,i),this.setHalfEdgePrev_(i,o)),s!==n&&(this.setHalfEdgeNext_(s,r),this.setHalfEdgePrev_(r,s));const a=this.getHalfEdgeOrigin(e);this.getClusterHalfEdge(a)===e&&(r!==e?this.setClusterHalfEdge_(a,r):this.setClusterHalfEdge_(a,G));const l=this.getHalfEdgeOrigin(n);this.getClusterHalfEdge(l)===n&&(i!==n?this.setClusterHalfEdge_(l,i):this.setClusterHalfEdge_(l,G)),this.m_halfEdgeData.deleteElement(e),this.m_halfEdgeData.deleteElement(n)}getLeftSkipPolylines_(e,i){let s=i;for(;;){if(s=e.getPrev(s),s===-1)return G;{const n=e.getElement(s);if(this.getHalfEdgeChain(n)!==this.getHalfEdgeChain(this.getHalfEdgeTwin(n)))return n}}}checkStructureAfterDirtySweep_(){const e=Di(this.m_checkDirtyPlanesweepTolerance),i=new N,s=new N,n=new N,r=new N,o=new N;for(let a=this.getFirstCluster();a!==G;a=this.getNextCluster(a)){const l=this.getClusterHalfEdge(a);if(l!==G){let u=l;this.getHalfEdgeFromXY(u,i),this.getHalfEdgeToXY(u,s),n.setSub(s,i);let c=n.sqrLength();do{const h=u;if(u=this.getHalfEdgeNext(this.getHalfEdgeTwin(u)),u!==h){this.getHalfEdgeToXY(u,r),o.setSub(r,i);const d=o.sqrLength(),m=o.crossProduct(n),f=m*m/(d*c);if(Math.min(d,c)*f<=e&&o.dotProduct(n)>=0)return!1;n.assign(o),c=d,s.assign(r)}}while(u!==l)}}return!0}extractPolygonPathFromChain_(e,i,s,n,r){const o=this.m_shape.hasSegmentParentage(),a=this.getChainHalfEdge(s);let l=a,u=G;const c=new Jt;do{const h=this.getHalfEdgeTwin(l);if(this.getHalfEdgeChain(h)!==s){let d=G;const m=this.getHalfEdgeOrigin(l);if(n===G){const _=this.getClusterVertexIterator(m);d=this.getVertexFromVertexIterator(_)}else for(let _=this.getClusterVertexIterator(m);_!==G;_=this.incrementVertexIterator(_)){const v=this.getVertexFromVertexIterator(_);d===G&&(d=v);const x=this.m_shape.getPathFromVertex(v);if(this.m_shape.getGeometryFromPath(x)===n){d=v;break}}let f;if(u===G&&(u=e.insertPath(i,G),e.setClosedPath(u,!0)),this.m_shape===e?f=e.addVertex(u,d):(this.m_shape.queryPoint(d,c),f=e.addPoint(u,c)),this.isHalfEdgeCurve(l)&&(this.querySegmentXY(l,r),e.setSegmentToIndex(e.getVertexIndex(f),r.get().clone())),o){const _=this.getSegmentParentage(l);e.setSegmentParentageAndBreak(f,_,this.isBreakNode(m))}}l=this.getHalfEdgeNext(l)}while(l!==a)}mergeSegmentParentage_(){if(!this.m_shape.hasSegmentParentage())return;z(this.m_clusterBreakNodeIndex!==-1),z(this.m_segmentParentageIndex===-1);for(let n=this.getFirstCluster();n!==G;n=this.getNextCluster(n)){let r=0;const o=this.getClusterHalfEdge(n);if(o!==G){let a=o;do r++,a=this.getHalfEdgeNext(this.getHalfEdgeTwin(a));while(a!==o&&r<3)}r!==2&&this.setBreakNode(n,!0)}let e=[],i=[];this.m_segmentParentageIndex=this.createUserIndexForHalfEdges();const s=this.createUserIndexForHalfEdges();for(let n=this.getFirstCluster();n!==G;n=this.getNextCluster(n)){const r=this.getClusterHalfEdge(n);if(r!==G){let o=!1,a=r;do{let l=a;for(;this.getHalfEdgeUserIndex(l,s)===-1;){const u=this.getHalfEdgeNext(l),c=this.getHalfEdgeTwin(l);xee(this,l,i);const h=i.at(-1).parentage;if(!o){const m=this.getHalfEdgeOrigin(l);if(!this.isBreakNode(m)){const f=this.getHalfEdgePrev(l);l!==f&&(xee(this,f,e),o=!0)}}if(o&&!D4e(i,e)){const m=this.getHalfEdgeOrigin(l);this.setBreakNode(m,!0)}e=Ge(i,i=e),o=!0;const d=this.getHalfEdgeOrigin(u);this.isBreakNode(d)&&(o=!1),this.setHalfEdgeUserIndex(l,this.m_segmentParentageIndex,h),this.setHalfEdgeUserIndex(c,this.m_segmentParentageIndex,h),this.setHalfEdgeUserIndex(l,s,1),this.setHalfEdgeUserIndex(c,s,1),l=u}a=this.getHalfEdgeNext(this.getHalfEdgeTwin(a))}while(a!==r)}}this.deleteUserIndexForHalfEdges(s)}registerNewBitSet(e){return this.m_uniqueBitSets===null&&(this.m_uniqueBitSets=N4e(),this.m_uniqueBitSets.add(this.getEmptySet())),e===null?this.getEmptySet():this.m_uniqueBitSets.has(e)?this.m_uniqueBitSets.get(e):(this.m_uniqueBitSets.add(e),e)}getLeftEdgeBitSet_(e){const i=this.getHalfEdgeUserIndex(e,this.m_edgeBitSetIndexLeft);return z(i>=0),z(this.m_edgeBitSets.at(i)),this.m_edgeBitSets.at(i)}getEdgeBitSet_(e){const i=this.getHalfEdgeUserIndex(e,this.m_edgeBitSetIndex);return z(i>=0),this.m_edgeBitSets.at(i)}setEdgeBitSet_(e,i){z(this.m_bBuildGeometryParentageSets),i=this.registerNewBitSet(i),this.m_edgeBitSetIndex===-1&&(this.m_edgeBitSetIndex=this.createUserIndexForHalfEdges());const s=this.getHalfEdgeUserIndex(e,this.m_edgeBitSetIndex);s!==-1?this.m_edgeBitSets[s]=i:(this.setHalfEdgeUserIndex(e,this.m_edgeBitSetIndex,this.m_edgeBitSets.length),this.m_edgeBitSets.push(i))}setLeftEdgeBitSet_(e,i){z(this.m_bBuildGeometryParentageSets),i=this.registerNewBitSet(i),this.m_edgeBitSetIndexLeft===-1&&(this.m_edgeBitSetIndexLeft=this.createUserIndexForHalfEdges());const s=this.getHalfEdgeUserIndex(e,this.m_edgeBitSetIndexLeft);s!==-1?this.m_edgeBitSets[s]=i:(this.setHalfEdgeUserIndex(e,this.m_edgeBitSetIndexLeft,this.m_edgeBitSets.length),this.m_edgeBitSets.push(i))}setChainBitSet_(e,i){z(this.m_bBuildGeometryParentageSets),i=this.registerNewBitSet(i),this.m_chainBitSetIndex===-1&&(this.m_chainBitSetIndex=this.createUserIndexForChains());const s=this.getChainUserIndex(e,this.m_chainBitSetIndex);s!==-1?this.m_chainBitSets[s]=i:(this.setChainUserIndex(e,this.m_chainBitSetIndex,this.m_chainBitSets.length),this.m_chainBitSets.push(i))}getEmptySet(){return this.m_emptyBitSet||(this.m_emptyBitSet=new Mh),this.m_emptyBitSet}deleteEdgeBitSets_(){this.m_edgeBitSetIndex!==-1&&(this.deleteUserIndexForHalfEdges(this.m_edgeBitSetIndex),this.m_edgeBitSetIndex=-1),this.m_edgeBitSetIndexLeft!==-1&&(this.deleteUserIndexForHalfEdges(this.m_edgeBitSetIndexLeft),this.m_edgeBitSetIndexLeft=-1),this.m_edgeBitSets.length=0,this.m_uniqueBitSets=null}deleteChainBitSets_(){this.m_chainBitSetIndex!==-1&&(this.deleteUserIndexForChains(this.m_chainBitSetIndex),this.m_chainBitSetIndex=-1,this.m_chainBitSets.length=0)}dbgPrintEdge_(e){}dbgVerifyEdgeSegment(e){}}sc.c_EdgeParentageMask=2147483647,sc.c_EdgeBitMask=1<<31;class As{freeNode_(e){this.m_listNodes.deleteElement(e)}newNode_(){return this.m_listNodes.newElement()}freeList_(e){this.m_lists.deleteElement(e)}newList_(){return this.m_lists.newElement()}Init_(e){z(0)}constructor(e){this.m_listNodes=new xs(2),this.m_listOfLists=As.st_nullNode(),this.m_bAllowNavigationBetweenLists=!0,e===void 0&&(e=!0),this.m_bAllowNavigationBetweenLists=e,this.m_lists=new xs(this.m_bAllowNavigationBetweenLists?4:2)}createList(){const e=this.newList_();return this.m_bAllowNavigationBetweenLists&&(this.m_lists.setField(e,3,this.m_listOfLists),this.m_listOfLists!==As.st_nullNode()&&this.m_lists.setField(this.m_listOfLists,2,e),this.m_listOfLists=e),e}deleteList(e){let i=this.getFirst(e);for(;i!==As.st_nullNode();){const s=i;i=this.getNext(i),this.freeNode_(s)}if(this.m_bAllowNavigationBetweenLists){const s=this.m_lists.getField(e,2),n=this.m_lists.getField(e,3);s!==As.st_nullNode()?this.m_lists.setField(s,3,n):this.m_listOfLists=n,n!==As.st_nullNode()&&this.m_lists.setField(n,2,s)}this.freeList_(e)}reserveLists(e){this.m_lists.setCapacity(e)}addElement(e,i){this.m_lists.getField(e,0);const s=this.m_lists.getField(e,1),n=this.newNode_();return s!==As.st_nullNode()?(this.m_listNodes.setField(s,1,n),this.m_lists.setField(e,1,n)):(this.m_lists.setField(e,0,n),this.m_lists.setField(e,1,n)),this.m_listNodes.setField(n,0,i),n}reserveNodes(e){this.m_listNodes.setCapacity(e)}deleteElementDirect(e,i,s){i!==As.st_nullNode()?(this.m_listNodes.setField(i,1,this.m_listNodes.getField(s,1)),this.m_lists.getField(e,1)===s&&this.m_lists.setField(e,1,i)):(this.m_lists.setField(e,0,this.m_listNodes.getField(s,1)),this.m_lists.getField(e,1)===s&&this.m_lists.setField(e,1,As.st_nullNode())),this.freeNode_(s)}deleteElementSearch(e,i){let s=-1,n=this.getFirst(e);for(;n!==i;)s=n,n=this.getNext(n);this.deleteElementDirect(e,s,i)}concatenateLists(e,i){const s=this.m_lists.getField(e,1),n=this.m_lists.getField(i,0);if(n!==As.st_nullNode()&&(s!==As.st_nullNode()?(this.m_listNodes.setField(s,1,n),this.m_lists.setField(e,1,this.m_lists.getField(i,1))):(this.m_lists.setField(e,0,n),this.m_lists.setField(e,1,this.m_lists.getField(i,1)))),this.m_bAllowNavigationBetweenLists){const r=this.m_lists.getField(i,2),o=this.m_lists.getField(i,3);r!==As.st_nullNode()?this.m_lists.setField(r,3,o):this.m_listOfLists=o,o!==As.st_nullNode()&&this.m_lists.setField(o,2,r)}return this.freeList_(i),e}getElement(e){return this.m_listNodes.getField(e,0)}getData(e){return this.getElement(e)}setElement(e,i){z(0)}getNext(e){return this.m_listNodes.getField(e,1)}getFirst(e){return this.m_lists.getField(e,0)}getFirstElement(e){const i=this.getFirst(e);return this.getElement(i)}static st_nullNode(){return-1}clear(){this.m_listNodes.deleteAll(!0),this.m_lists.deleteAll(!0),this.m_listOfLists=As.st_nullNode()}isEmpty(e){return z(0),!1}getNodeCount(){return this.m_listNodes.size()}getListCount(){return this.m_lists.size()}getFirstList(){return this.m_listOfLists}getNextList(e){return this.m_lists.getField(e,3)}}function qU(t=-1){return{m_value:t,m_line:new mi,m_segment:null,m_segmentInfo:new hB(-1),m_env:new Me(0,0),m_dxdy:55555555,m_bHorizontal:!1,m_bCurve:!1}}const R4e=67;let Cfe=class extends B1{constructor(e,i,s){super(!0),this.m_bIntersectionDetected=!1,this.m_nonSimpleResult=new Rs,this.m_tempSimpleEdge1=qU(),this.m_tempSimpleEdge2=qU(),this.m_prev1=G,this.m_prev2=G,this.m_vertex1=G,this.m_vertex2=G,this.m_currentNode=-1,this.m_prevX1=Number.NaN,this.m_prevX2=Number.NaN,this.m_prevY=Number.NaN,this.m_prevX=0,this.m_sweepY=Number.NaN,this.m_sweepX=0,this.m_ptSweep=new N,this.m_simpleEdgesCache=[],this.m_simpleEdgesRecycle=[],this.m_cOutstandingConstructedEdges=0,this.m_shape=e,this.m_bShapeHasSegments=this.m_shape.hasCurves(),this.m_tolerance=i,this.m_tolerance10=10*i,this.m_bIsSimple=s;const n=Math.trunc(Math.min(3*e.getTotalPointCount()/2,R4e)),r=Math.min(7,n);this.m_simpleEdgesCache.length=r}tryGetCachedEdge_(e){const i=this.m_simpleEdgesCache[(e&Aa())%this.m_simpleEdgesCache.length];return i&&i.m_value===e?i:null}tryDeleteCachedEdge_(e){const i=(e&Aa())%this.m_simpleEdgesCache.length,s=this.m_simpleEdgesCache[i];s&&s.m_value===e&&(this.m_simpleEdgesRecycle.push(s),this.m_simpleEdgesCache[i]=null)}tryCreateCachedEdge_(e){const i=(e&Aa())%this.m_simpleEdgesCache.length;let s=this.m_simpleEdgesCache[i];return s?null:(this.m_simpleEdgesRecycle.length===0?(s=qU(),this.m_cOutstandingConstructedEdges++):s=this.m_simpleEdgesRecycle.pop(),s.m_value=e,this.m_simpleEdgesCache[i]=s,s)}initSimpleEdge_(e,i){this.m_bShapeHasSegments&&this.initSimpleEdgeHelper_(e,i)||e.m_bCurve||(this.m_shape.queryLineConnector(i,e.m_line,!0),e.m_segment=e.m_line,e.m_env.setCoordsNoNAN(e.m_line.getStartX(),e.m_line.getEndX()),e.m_env.vmax+=this.m_tolerance,e.m_line.orientBottomUp(),e.m_bHorizontal=e.m_line.getEndY()===e.m_line.getStartY(),e.m_bHorizontal||(e.m_dxdy=(e.m_line.getEndX()-e.m_line.getStartX())/(e.m_line.getEndY()-e.m_line.getStartY())))}initSimpleEdgeHelper_(e,i){if(e.m_segment=this.m_shape.getSegment(i),e.m_segmentInfo=this.m_shape.getOriginalSegmentInfo(i),e.m_bCurve=e.m_segment!==null,e.m_bCurve){const s=e.m_segment.clone();return s.orientBottomUp(),e.m_segment=s,e.m_env=e.m_segment.queryInterval(0,0),e.m_env.vmax+=this.m_tolerance,!0}return!1}compareTwoSegments_(e,i){const s=e.getStartXY(),n=e.getEndXY(),r=i.getStartXY(),o=i.getEndXY();if(this.m_ptSweep.setCoords(this.m_sweepX,this.m_sweepY),s.isEqualPoint2D(r)&&this.m_sweepY===s.y){this.m_ptSweep.assign(n.compare(o)<0?n:o);const h=e.intersectionOfYMonotonicWithAxisX(this.m_ptSweep.y,this.m_ptSweep.x),d=i.intersectionOfYMonotonicWithAxisX(this.m_ptSweep.y,this.m_ptSweep.x);if(Math.abs(h-d)>this.m_tolerance)return h<d?-1:1}const a=s.compare(r)<0?r:s,l=n.compare(o)<0?n:o;let u=0,c=0;for(let h=1;h<5;h++){zn(a,l,h/5,this.m_ptSweep);const d=e.intersectionOfYMonotonicWithAxisX(this.m_ptSweep.y,this.m_ptSweep.x),m=i.intersectionOfYMonotonicWithAxisX(this.m_ptSweep.y,this.m_ptSweep.x),f=Math.abs(d-m);f>u&&(u=f,c=d<m?-1:1)}return c===0?this.errorCracking():c}compareNonHorizontal_(e,i){if(e.m_line.getStartY()===i.m_line.getStartY()&&e.m_line.getStartX()===i.m_line.getStartX())return e.m_line.getEndY()===i.m_line.getEndY()&&e.m_line.getEndX()===i.m_line.getEndX()?this.m_bIsSimple?this.errorCoincident():0:this.compareNonHorizontalUpperEnd_(e,i);if(e.m_line.getEndY()===i.m_line.getEndY()&&e.m_line.getEndX()===i.m_line.getEndX())return this.compareNonHorizontalLowerEnd_(e,i);const s=this.compareNonHorizontalLowerEnd_(e,i),n=this.compareNonHorizontalUpperEnd_(e,i);return s<0&&n<0?-1:s>0&&n>0?1:this.errorCracking()}compareHorizontal1Case1_(e,i){if(e.getEndX()>i.getEndX()){if(i.getEndX()>i.getStartX()&&i.getEndY()-i.getStartY()<2*this.m_tolerance&&e.isIntersectingPoint(i.getEndXY(),this.m_tolerance,!0))return this.errorCracking()}else if((i.getEndY()-i.getStartY())/(i.getEndX()-i.getStartX())*(e.getEndX()-e.getStartX())<this.m_tolerance10&&i.isIntersectingPoint(e.getEndXY(),this.m_tolerance,!0))return this.errorCracking();return 1}compareHorizontal1Case2_(e,i){if(e.getStartX()<i.getStartX()){if(i.getEndX()>i.getStartX()&&i.getEndY()-i.getStartY()<2*this.m_tolerance&&e.isIntersectingPoint(i.getEndXY(),this.m_tolerance,!0))return this.errorCracking()}else if((i.getEndY()-i.getStartY())/(i.getEndX()-i.getStartX())*(e.getStartX()-e.getEndX())<this.m_tolerance10&&i.isIntersectingPoint(e.getStartXY(),this.m_tolerance,!0))return this.errorCracking();return-1}compareHorizontal1Case3_(e,i){const s=N.getNAN();s.setSub(i.getEndXY(),i.getStartXY()),s.rightPerpendicularThis(),s.normalize();const n=N.getNAN();n.setSub(e.getStartXY(),i.getStartXY());const r=N.getNAN();r.setSub(e.getEndXY(),i.getStartXY());const o=n.dotProduct(s),a=r.dotProduct(s),l=Math.abs(o),u=Math.abs(a);if(l<u){if(l<this.m_tolerance10&&i.isIntersectingPoint(e.getStartXY(),this.m_tolerance,!0))return this.errorCracking()}else if(u<this.m_tolerance10&&i.isIntersectingPoint(e.getEndXY(),this.m_tolerance,!0))return this.errorCracking();return o<0&&a<0?-1:o>0&&a>0?1:this.errorCracking()}compareHorizontal1_(e,i){return e.getStartY()===i.getStartY()&&e.getStartX()===i.getStartX()?this.compareHorizontal1Case1_(e,i):e.getEndY()===i.getEndY()&&e.getEndX()===i.getEndX()?this.compareHorizontal1Case2_(e,i):this.compareHorizontal1Case3_(e,i)}compareHorizontal2_(e,i){return e.getEndY()===i.getEndY()&&e.getEndX()===i.getEndX()&&e.getStartY()===i.getStartY()&&e.getStartX()===i.getStartX()?this.m_bIsSimple?this.errorCoincident():0:this.errorCracking()}compareNonHorizontalLowerEnd_(e,i){let s=1;if(e.m_line.getStartY()<i.m_line.getStartY()){s=-1;const u=e;e=i,i=u}const n=e.m_line,r=i.m_line,o=n.getStartX()-r.getStartX(),a=i.m_dxdy*(n.getStartY()-r.getStartY()),l=this.m_tolerance10;return o<a-l?-s:o>a+l?s:r.isIntersectingPoint(n.getStartXY(),this.m_tolerance,!0)?this.errorCracking():o<a?-s:s}compareNonHorizontalUpperEnd_(e,i){let s=1;if(i.m_line.getEndY()<e.m_line.getEndY()){s=-1;const u=e;e=i,i=u}const n=e.m_line,r=i.m_line,o=n.getEndX()-r.getStartX(),a=i.m_dxdy*(n.getEndY()-r.getStartY()),l=this.m_tolerance10;return o<a-l?-s:o>a+l?s:r.isIntersectingPoint(n.getEndXY(),this.m_tolerance,!0)?this.errorCracking():o<a?-s:s}errorCoincident(){this.m_bIntersectionDetected=!0;const e=7;return this.m_nonSimpleResult=new Rs(e,this.m_vertex1,this.m_vertex2),-1}errorCracking(){return this.m_bIntersectionDetected=!0,this.m_bIsSimple?this.m_nonSimpleResult=new Rs(6,this.m_vertex1,this.m_vertex2):(this.m_prev1=G,this.m_prev2=G,this.m_vertex1=G,this.m_vertex2=G),-1}compareSegments_(e,i,s,n){if(s.m_env.vmax<n.m_env.vmin)return-1;if(n.m_env.vmax<s.m_env.vmin)return 1;if(!s.m_bCurve&&!n.m_bCurve){let u=s.m_bHorizontal?1:0;return u|=n.m_bHorizontal?2:0,u===0?this.compareNonHorizontal_(s,n):u===1?this.compareHorizontal1_(s.m_line,n.m_line):u===2?-1*this.compareHorizontal1_(n.m_line,s.m_line):this.compareHorizontal2_(s.m_line,n.m_line)}if(this.m_bIntersectionDetected)return-1;const r=this.m_prevY===this.m_sweepY&&this.m_prevX===this.m_sweepX;let o,a;if(r&&e===this.m_prev1?o=this.m_prevX1:(o=Number.NaN,this.m_prev1=G),r&&i===this.m_prev2?a=this.m_prevX2:(a=Number.NaN,this.m_prev2=G),this.m_prevY=this.m_sweepY,this.m_prevX=this.m_sweepX,Number.isNaN(o)){this.m_prev1=e;const u=s.m_segment.intersectionOfYMonotonicWithAxisX(this.m_sweepY,this.m_sweepX);o=u,this.m_prevX1=u}if(Number.isNaN(a)){this.m_prev2=i;const u=n.m_segment.intersectionOfYMonotonicWithAxisX(this.m_sweepY,this.m_sweepX);a=u,this.m_prevX2=u}const l=u4(!0,!0,s.m_segment,n.m_segment,this.m_tolerance,!0);return l!==0?l===2?this.m_bIsSimple?this.errorCoincident():s.m_segmentInfo.equals(n.m_segmentInfo)?0:this.errorCracking():this.errorCracking():Math.abs(o-a)<=this.m_tolerance?this.compareTwoSegments_(s.m_segment,n.m_segment):o<a?-1:o>a?1:0}clearIntersectionDetectedFlag(){this.m_bIntersectionDetected=!1}intersectionDetected(){return this.m_bIntersectionDetected}getLastComparedNode(){return this.m_currentNode}getResult(){return this.m_nonSimpleResult}setSweepY(e,i){this.m_sweepY=e,this.m_sweepX=i,this.m_prev1=G,this.m_prev2=G,this.m_vertex1=G,this.m_vertex2=G}compare(e,i,s){if(this.m_bIntersectionDetected)return-1;const n=e.getElement(s),r=i;return this.m_currentNode=s,this.compareSegments(r,r,n,n)}compareSegments(e,i,s,n){let r=this.tryGetCachedEdge_(e);r===null?this.m_vertex1===i?r=this.m_tempSimpleEdge1:(this.m_vertex1=i,r=this.tryCreateCachedEdge_(e),r===null&&(r=this.m_tempSimpleEdge1,this.m_tempSimpleEdge1.m_value=e),this.initSimpleEdge_(r,i)):this.m_vertex1=i;let o=this.tryGetCachedEdge_(s);return o===null?this.m_vertex2===n?o=this.m_tempSimpleEdge2:(this.m_vertex2=n,o=this.tryCreateCachedEdge_(s),o===null&&(o=this.m_tempSimpleEdge2,this.m_tempSimpleEdge2.m_value=s),this.initSimpleEdge_(o,n)):this.m_vertex2=n,this.compareSegments_(i,n,r,o)}onDelete(e){this.tryDeleteCachedEdge_(e)}onSet(e){this.tryDeleteCachedEdge_(e)}onEndSearch(e){this.tryDeleteCachedEdge_(e)}onAddUniqueElementFailed(e){this.tryDeleteCachedEdge_(e)}},Tfe=class{constructor(e,i){this.m_bIntersectionDetected=!1,this.m_pointOfInterest=N.getNAN(),this.m_line1=new mi,this.m_seg1=null,this.m_env=Me.constructEmpty(),this.m_vertex1=-1,this.m_currentNode=-1,this.m_minDist=Number.MAX_VALUE,this.m_shape=e,this.m_tolerance=i}getCurrentNode(){return this.m_currentNode}clearIntersectionDetectedFlag(){this.m_bIntersectionDetected=!1,this.m_minDist=Number.MAX_VALUE}intersectionDetected(){return this.m_bIntersectionDetected}setPoint(e){this.m_pointOfInterest.assign(e)}compare(e,i){const s=e.getElement(i);return this.compareVertex(e,i,s)}compareVertex(e,i,s){let n,r=this.m_shape.getSegment(s),o=!0;if(r==null)this.m_shape.queryLineConnector(s,this.m_line1,!0),this.m_env.setCoordsNoNAN(this.m_line1.getStartX(),this.m_line1.getEndX()),r=this.m_line1,n=this.m_line1.getStartY()===this.m_line1.getEndY();else{const l=J.constructEmpty();r.queryLooseEnvelope(l),l.queryIntervalX(this.m_env),n=l.height()===0,o=!1}if(this.m_pointOfInterest.x+this.m_tolerance<this.m_env.vmin)return-1;if(this.m_pointOfInterest.x-this.m_tolerance>this.m_env.vmax)return 1;if(n)return this.m_currentNode=i,this.m_bIntersectionDetected=!0,0;let a=0;if(o){xpe(this.m_line1);const l=this.m_line1.getStartXY(),u=new N;u.setSub(this.m_line1.getEndXY(),l),u.rightPerpendicularThis();const c=new N;c.setSub(this.m_pointOfInterest,l),a=u.dotProduct(c),a/=u.length()}else a=r.intersectionOfYMonotonicWithAxisX(this.m_pointOfInterest.y,this.m_pointOfInterest.x)-this.m_pointOfInterest.x;return a<10*-this.m_tolerance?-1:a>10*this.m_tolerance?1:(r.isIntersectingPoint(this.m_pointOfInterest,this.m_tolerance)&&(Math.abs(a)<this.m_minDist&&(this.m_currentNode=i,this.m_minDist=a),this.m_bIntersectionDetected=!0),a<0?-1:a>0?1:0)}},qD=class Pfe{constructor(e,i){this.m_lists=new As(!1),this.m_hash=i,this.m_hashBuckets=new Int32Array(e),this.m_hashBuckets.fill(Pfe.st_nullNode()),this.m_bitFilter=new Int32Array(10*e+31>>5)}reserveElements(e){this.m_lists.reserveLists(Math.min(this.m_hashBuckets.length,e)),this.m_lists.reserveNodes(e)}addElement(e,i){i===void 0&&(i=this.m_hash.getHash(e));const s=i%(this.m_bitFilter.length<<5);this.m_bitFilter[s>>5]|=1<<(31&s);const n=i%this.m_hashBuckets.length;let r=this.m_hashBuckets[n];return r===As.st_nullNode()&&(r=this.m_lists.createList(),this.m_hashBuckets[n]=r),this.m_lists.addElement(r,e)}deleteElement(e,i){i===void 0&&(i=this.m_hash.getHash(e));const s=i%this.m_hashBuckets.length,n=this.m_hashBuckets[s];n===As.st_nullNode()&&ce("");let r=this.m_lists.getFirst(n),o=As.st_nullNode();for(;r!==As.st_nullNode();){const a=this.m_lists.getData(r),l=this.m_lists.getNext(r);a===e?(this.m_lists.deleteElementDirect(n,o,r),this.m_lists.getFirst(n)===As.st_nullNode()&&(this.m_lists.deleteList(n),this.m_hashBuckets[s]=As.st_nullNode())):o=r,r=l}}getFirstInBucket(e){const i=e%(this.m_bitFilter.length<<5);if(!(this.m_bitFilter[i>>5]&1<<(31&i)))return As.st_nullNode();const s=e%this.m_hashBuckets.length,n=this.m_hashBuckets[s];return n===As.st_nullNode()?As.st_nullNode():this.m_lists.getFirst(n)}getNextInBucket(e){return this.m_lists.getNext(e)}findNode(e){const i=this.m_hash.getHash(e);let s=this.getFirstInBucket(i);for(;s!==As.st_nullNode();){const n=this.m_lists.getData(s);if(this.m_hash.equal(n,e))return s;s=this.m_lists.getNext(s)}return As.st_nullNode()}deleteNode(e){const i=this.getElement(e),s=this.m_hash.getHash(i)%this.m_hashBuckets.length,n=this.m_hashBuckets[s];n===As.st_nullNode()&&ce(""),this.m_lists.deleteElementSearch(n,e),this.m_lists.getFirst(n)===As.st_nullNode()&&(this.m_lists.deleteList(n),this.m_hashBuckets[s]=As.st_nullNode())}getElement(e){return this.m_lists.getData(e)}static st_nullNode(){return As.st_nullNode()}clear(){z(0)}size(){return this.m_lists.getNodeCount()}dbgPrintBucketHistogram(){}};function Mfe(t,e,i,s,n){const r=new Dfe(n);return r.m_shape=t,r.m_sqrTolerance=e*e,r.m_cellSize=2*e,r.m_invCellSize=1/r.m_cellSize,r.m_geometry=i,r.m_bTrackChanges=s,r.m_bHasSegmentParentage=t.hasSegmentParentage(),r.clusterNonReciprocal()}function rj(t,e,i,s,n){const r=t-i,o=e-s;return r*r+o*o<=n}function O4e(){return{pt:new N,weight:0,rank:0,bMerged:!1}}function Afe(t,e,i,s,n,r){const o=O4e(),a=i+n;let l=!1,u=t.x;t.x!==e.x&&(s===r&&(u=(t.x*i+e.x*n)/a),l=!0);let c=t.y;return t.y!==e.y&&(s===r&&(c=(t.y*i+e.y*n)/a),l=!0),s!==r?s>r?(o.rank=s,o.weight=i,o.pt=t):(o.rank=r,o.weight=n,o.pt=e):(o.pt.setCoords(u,c),o.weight=a,o.rank=s),o.bMerged=l,o}function L4e(t,e,i,s,n,r,o,a,l){const u=t.equals(e);if(s>r)return o.assignCopy(t),l[0]=s,a[0]=i,u;if(r>s)return o=e,l[0]=r,a[0]=n,u;o.assignCopy(t);const c=Afe(t.getXY(),e.getXY(),i,s,n,r);return o.setXY(c.pt),a[0]=c.weight,l[0]=c.rank,u}function F4e(t,e,i,s,n){const r=new Dfe(n);return r.m_shape=t,r.m_sqrTolerance=e*e,r.m_cellSize=2*e,r.m_invCellSize=1/r.m_cellSize,r.m_geometry=i,r.m_bTrackChanges=!1,r.needsClustering()}function Ife(t,e){const i=rpe(t);return v3e(i,e)}let bee=class{constructor(e,i,s,n,r){this.m_workPt=new N,this.m_shape=e,this.m_sqrTolerance=s,this.m_invCellSize=n,this.m_origin=i.clone(),this.m_hashValues=r}getHash(e){return this.m_shape.getUserIndex(e,this.m_hashValues)}calculateHashFromVertex(e){this.m_shape.queryXY(e,this.m_workPt);const i=this.m_workPt.x-this.m_origin.x,s=Math.trunc(i*this.m_invCellSize+.5),n=this.m_workPt.y-this.m_origin.y;return Ife(s,Math.trunc(n*this.m_invCellSize+.5))}equal(e,i){return z(0),!1}};class Dfe{constructor(e){this.m_origin=N.getNAN(),this.m_sqrTolerance=0,this.m_cellSize=0,this.m_invCellSize=0,this.m_geometry=G,this.m_bucketArray=st(4,Number.NaN),this.m_bucketHash=st(4,Number.NaN),this.m_dbgCandidateCheckCount=0,this.m_nsr=new Rs,this.m_hashValues=-1,this.m_newClusters=-1,this.m_bTrackChanges=!1,this.m_bHasSegmentParentage=!1,this.m_shape=null,this.m_clusters=new As,this.m_hashFunction=null,this.m_hashTable=null,this.m_progressCounter=0,this.m_progressTracker=e}progress_(){}collectClusterCandidates(e,i){const s=N.getNAN();this.m_shape.queryXY(e,s);const n=(s.x-this.m_origin.x)*this.m_invCellSize,r=(s.y-this.m_origin.y)*this.m_invCellSize,o=Math.trunc(n),a=Math.trunc(r);let l=0;for(let u=0;u<=1;u+=1)for(let c=0;c<=1;c+=1){const h=Ife(o+u,a+c),d=this.m_hashTable.getFirstInBucket(h);d!==qD.st_nullNode()&&(this.m_bucketArray[l]=d,this.m_bucketHash[l]=h,l++)}for(let u=l-1;u>=1;u--){const c=this.m_bucketArray[u];for(let h=u-1;h>=0;h--)if(c===this.m_bucketArray[h]){this.m_bucketHash[h]=-1,l--,u!==l&&(this.m_bucketHash[u]=this.m_bucketHash[l],this.m_bucketArray[u]=this.m_bucketArray[l]);break}}for(let u=0;u<l;u++)this.collectNearestNeighbourCandidates(e,this.m_bucketHash[u],s,this.m_bucketArray[u],i)}collectNearestNeighbourCandidates(e,i,s,n,r){const o=N.getNAN();for(let a=n;a!==qD.st_nullNode();a=this.m_hashTable.getNextInBucket(a)){const l=this.m_hashTable.getElement(a);e===l||i!==-1&&this.m_shape.getUserIndex(l,this.m_hashValues)!==i||(this.m_shape.queryXY(l,o),rj(s.x,s.y,o.x,o.y,this.m_sqrTolerance)&&r.push(a))}}mergeClusters(e,i,s){let n=this.m_shape.getUserIndex(e,this.m_newClusters);const r=this.m_shape.getUserIndex(i,this.m_newClusters);n===-1&&(n=this.m_clusters.createList(),this.m_clusters.addElement(n,e),this.m_shape.setUserIndex(e,this.m_newClusters,n)),r===-1?this.m_clusters.addElement(n,i):this.m_clusters.concatenateLists(n,r),this.m_shape.setUserIndex(i,this.m_newClusters,xs.impossibleIndex2());const o=this.mergeVertices(e,i);if(s){const a=this.m_hashFunction.calculateHashFromVertex(e);this.m_shape.setUserIndex(e,this.m_hashValues,a)}return o}mergeVertices(e,i){const s=N.getNAN();this.m_shape.queryXY(e,s);const n=N.getNAN();this.m_shape.queryXY(i,n);const r=this.m_shape.getRank(e),o=this.m_shape.getRank(i),a=this.m_shape.getWeight(e),l=this.m_shape.getWeight(i);let u,c,h,d,m=!1;if(r===o?(u=r,c=a+l,h=s.x,s.x!==n.x&&(h=(s.x*a+n.x*l)/c,m=!0),d=s.y,s.y!==n.y&&(d=(s.y*a+n.y*l)/c,m=!0)):(r>o?(h=s.x,d=s.y,c=a,u=r):(h=n.x,d=n.y,c=l,u=o),m=!s.equals(n)),m&&(this.m_shape.setXYMonotonic(e,h,d),this.m_bTrackChanges&&this.m_shape.setGeometryModifiedWithVertex(e,!0),this.m_bHasSegmentParentage)){const f=this.m_shape.getSegmentParentageBreakVertex(e)||this.m_shape.getSegmentParentageBreakVertex(i);this.m_shape.setSegmentParentageBreakVertex(e,f),this.m_shape.setSegmentParentageBreakVertex(i,f)}return this.m_shape.setWeight(e,c),this.m_shape.setRank(e,u),m}needsClustering(){const e={stack:[],error:void 0,hasError:!1};try{Da(e,Jme(()=>{this.m_hashTable=null,this.m_hashFunction=null,this.m_shape.removeUserIndex(this.m_hashValues),this.m_shape.removeUserIndex(this.m_newClusters)}),!1);const i=this.m_shape.getSelectedCount(),s=this.m_shape.getEnvelope2D(this.m_progressTracker);this.m_origin.assign(s.getLowerLeft());const n=Math.max(s.height(),s.width())/(fo()-1);this.m_cellSize<n&&(this.m_cellSize=n,this.m_invCellSize=1/this.m_cellSize),this.m_clusters.clear(),this.m_clusters.reserveLists(this.m_shape.getSelectedCount()/3+1),this.m_clusters.reserveNodes(this.m_shape.getSelectedCount()/3+1),this.m_hashValues=this.m_shape.createUserIndex(),this.m_newClusters=this.m_shape.createUserIndex(),this.m_hashFunction=new bee(this.m_shape,this.m_origin,this.m_sqrTolerance,this.m_invCellSize,this.m_hashValues),this.m_hashTable=new qD(4*i/3,this.m_hashFunction),this.m_hashTable.reserveElements(this.m_shape.getSelectedCount());let r=!1;for(let o=0;o<2;o++){const a=[],l=this.m_shape.queryVertexIteratorOnSelection(this.m_geometry);for(let u=l.next();u!==G;u=l.next()){if(this.progress_(),o>0&&this.m_shape.getUserIndex(u,this.m_newClusters)===xs.impossibleIndex2())continue;let c;if(o===0?(c=this.m_hashFunction.calculateHashFromVertex(u),this.m_shape.setUserIndex(u,this.m_hashValues,c)):c=this.m_shape.getUserIndex(u,this.m_hashValues),this.collectClusterCandidates(u,a),a.length!==0){for(let h=0,d=a.length;h<d;h++){this.progress_();const m=a[h],f=this.m_hashTable.getElement(m);if(this.m_hashTable.deleteNode(m),!this.m_shape.isEqualXY(u,f))return this.m_nsr=new Rs(5,this.m_shape.getVertexIndex(u),this.m_shape.getVertexIndex(f)),r=!0,r;this.mergeClusters(u,f,!1)}a.length=0}o===0&&this.m_hashTable.addElement(u,c)}}return r}catch(i){e.error=i,e.hasError=!0}finally{Hf(e)}}clusterNonReciprocal(){const e=this.m_shape.getSelectedCount(),i=this.m_shape.getEnvelope2D(this.m_progressTracker);this.m_origin=i.getLowerLeft();const s=Math.max(i.height(),i.width())/(fo()-1);this.m_cellSize<s&&(this.m_cellSize=s,this.m_invCellSize=1/this.m_cellSize),this.m_clusters.clear(),this.m_clusters.reserveLists(Math.trunc(this.m_shape.getSelectedCount()/3+1)),this.m_clusters.reserveNodes(Math.trunc(this.m_shape.getSelectedCount()/3+1)),this.m_hashValues=this.m_shape.createUserIndex(),this.m_newClusters=this.m_shape.createUserIndex(),this.m_hashFunction=new bee(this.m_shape,this.m_origin,this.m_sqrTolerance,this.m_invCellSize,this.m_hashValues),this.m_hashTable=new qD(Math.trunc(4*e/3),this.m_hashFunction),this.m_hashTable.reserveElements(this.m_shape.getSelectedCount());let n=!1;{const r=this.m_shape.queryVertexIteratorOnSelection(this.m_geometry);for(let o=r.next();o!==G;o=r.next()){this.progress_();const a=this.m_hashFunction.calculateHashFromVertex(o);this.m_shape.setUserIndex(o,this.m_hashValues,a),this.m_hashTable.addElement(o,a)}}{const r=[],o=this.m_shape.queryVertexIteratorOnSelection(this.m_geometry);for(let a=o.next();a!==G;a=o.next()){if(this.m_shape.getUserIndex(a,this.m_newClusters)===xs.impossibleIndex2())continue;let l=this.m_shape.getUserIndex(a,this.m_hashValues);this.m_hashTable.deleteElement(a,l);let u=!1;for(;this.collectClusterCandidates(a,r),r.length!==0;){let c=0;for(let h=0,d=r.length;h<d;h++){this.progress_();const m=r[h],f=this.m_hashTable.getElement(m);this.m_hashTable.deleteNode(m);const _=h+1===d;c|=this.mergeClusters(a,f,_)?1:0}if(u||(u=c!==0),n||(n=c!==0),r.length=0,!c)break}u&&(l=this.m_shape.getUserIndex(a,this.m_hashValues)),this.m_hashTable.addElement(a,l)}r.length=0}return n&&this.applyClusterPositions_(),this.m_hashTable=null,this.m_hashFunction=null,this.m_shape.removeUserIndex(this.m_hashValues),this.m_shape.removeUserIndex(this.m_newClusters),n}applyClusterPositions_(){const e=N.getNAN();for(let i=this.m_clusters.getFirstList();i!==As.st_nullNode();i=this.m_clusters.getNextList(i)){let s=this.m_clusters.getFirst(i);const n=this.m_clusters.getElement(s);this.m_shape.queryXY(n,e);const r=this.m_shape.getRank(n),o=this.m_shape.getWeight(n);for(s=this.m_clusters.getNext(s);s!==As.st_nullNode();s=this.m_clusters.getNext(s)){const a=this.m_clusters.getElement(s);if(this.m_bTrackChanges?this.m_shape.isEqualXYPoint2D(a,e)||(this.m_shape.setXYMonotonicPoint2D(a,e),this.m_shape.setGeometryModifiedWithVertex(a,!0)):this.m_shape.setXYMonotonicPoint2D(a,e),this.m_bHasSegmentParentage){const l=this.m_shape.getSegmentParentageBreakVertex(n)||this.m_shape.getSegmentParentageBreakVertex(a);this.m_shape.setSegmentParentageBreakVertex(n,l),this.m_shape.setSegmentParentageBreakVertex(a,l)}this.m_shape.setWeight(a,o),this.m_shape.setRank(a,r)}}}}class Ml{constructor(){this.m_inputParts=[],this.m_resultParts1=[],this.m_resultParts2=[],this.m_resultSegments=[],this.m_freeSegments=[],this.m_inputSegments=[],this.m_param1=[],this.m_param2=[],this.m_tolerance=0,this.m_toleranceZ=0,this.m_point=new Jt,this.m_pointWeight=1,this.m_maxDensifyLimit=0,this.m_pointRank=0,this.m_changed1=!1,this.m_changed2=!1,this.m_adaptiveDensify=!1}clear(){this.freeAllResultSegments(),this.m_inputSegments.length=0,this.m_inputParts.length=0,this.m_resultParts1.length=0,this.m_resultParts2.length=0,this.m_param1.length=0,this.m_param2.length=0,this.m_adaptiveDensify=!1,this.m_changed1=!1,this.m_changed2=!1}newIntersectionPart_(e,i,s,n,r,o,a,l,u,c){return $4e(e,i,s,n,r,o,a,l,u,c)}pushSegment(e,i,s,n,r,o,a,l,u,c){return this.m_inputParts.push(this.newIntersectionPart_(this.m_inputSegments.length,i,s,n,r,o,a,l,u,c)),this.m_inputSegments.push(e),this.m_inputParts.length-1}getResultSegmentCount(e){return this.m_adaptiveDensify?e===0?this.m_param1.length-1:this.m_param2.length-1:e===0?this.m_resultParts1.length:this.m_resultParts2.length}getResultPart_(e,i){return e===0?this.m_resultParts1[i]:this.m_resultParts2[i]}getResultSegment(e,i){return this.m_resultSegments[this.getResultPart_(e,i).segmentIndex].get()}getSegmentChanged(e){return e===0?this.m_changed1:this.m_changed2}getResultSegmentStartPointWeight(e,i){return this.getResultPart_(e,i).weightStart}getResultSegmentStartPointRank(e,i){return this.getResultPart_(e,i).rankStart}getResultSegmentSegmentParentage(e,i){return this.getResultPart_(e,i).segmentParentage}getResultSegmentStartPointIsBreak(e,i){return this.getResultPart_(e,i).u.bBreakStart}getResultSegmentEndPointWeight(e,i){return this.getResultPart_(e,i).weightEnd}getResultSegmentEndPointRank(e,i){return this.getResultPart_(e,i).rankEnd}getResultSegmentEndPointIsBreak(e,i){return this.getResultPart_(e,i).u.bBreakEnd}getResultSegmentInteriorRank(e,i){return this.getResultPart_(e,i).rankInterior}getResultSegmentInteriorWeight(e,i){return this.getResultPart_(e,i).weightInterior}getResultPoint(){return this.m_point}getResultPointWeight(){return this.m_pointWeight}getResultPointRank(){return this.m_pointRank}getResultPointChanged(){return this.m_changed2}intersectLines(e,i){this.m_inputSegments.length!==2&&We(""),this.m_changed1=!1,this.m_changed2=!1,this.m_tolerance=e;const s=Di(e*Ml.c_smallToleranceFactor);let n=!1;const r=this.m_inputParts[0],o=this.m_inputParts[1],a=this.m_inputSegments[r.segmentIndex],l=this.m_inputSegments[o.segmentIndex];if(i||5&tE(!0,a,l,e,!0)){const u=q1(!0,a,l,null,this.m_param1,this.m_param2,e);u===0&&We("");const c=new Array(u);for(let A=0;A<u;++A)c[A]=N.getNAN();const h=new Float64Array(u),d=new Int32Array(u),m=new Array(u),f=new Array(u);for(let A=0;A<u;++A)m[A]=fL(),f[A]=fL();for(let A=0;A<u;A++){const I=this.m_param1[A],L=this.m_param2[A];let D,O=r.rankInterior,U=r.weightInterior;I===0?(O=r.rankStart,U=r.weightStart,D=r.u.bBreakStart):I===1?(O=r.rankEnd,U=r.weightEnd,D=r.u.bBreakEnd):(this.m_changed1=!0,D=!1);let $,B=o.rankInterior,V=o.weightInterior;L===0?(B=o.rankStart,V=o.weightStart,$=o.u.bBreakStart):L===1?(B=o.rankEnd,V=o.weightEnd,$=o.u.bBreakEnd):(this.m_changed2=!0,$=!1);const H=O,Y=B;let W=1,ee=0,ne=N.getNAN();if(H===Y){const j=a.getCoord2D(I),oe=l.getCoord2D(L);W=U+V,ee=O,zn(j,oe,V/W,ne);const ve=N.sqrDistance(ne,j),Ye=N.sqrDistance(ne,oe);m[A].bBigMove=ve>s,f[A].bBigMove=Ye>s,this.m_changed1||j.equals(ne)||(this.m_changed1=!0),this.m_changed2||oe.equals(ne)||(this.m_changed2=!0)}else if(H>Y){ne=a.getCoord2D(I);const j=l.getCoord2D(L);W=U,ee=O;const oe=N.sqrDistance(ne,j);m[A].bBigMove=!1,f[A].bBigMove=oe>s,this.m_changed2||j.equals(ne)||(this.m_changed2=!0)}else{ne=l.getCoord2D(L),W=V,ee=B;const j=a.getCoord2D(I),oe=N.sqrDistance(ne,j);m[A].bBigMove=oe>s,f[A].bBigMove=!1,this.m_changed1||j.equals(ne)||(this.m_changed1=!0)}c[A].assign(ne),h[A]=W,d[A]=ee,m[A].bIsBreak=D||$,f[A].bIsBreak=D||$,n||(n=m[A].bBigMove||f[A].bBigMove)}const _=r.rankInterior,v=r.weightInterior;let x=0,w=-1;for(let A=0;A<=u;A++){const I=A<u?this.m_param1[A]:1;if(I!==x){const L=this.allocResultSegment(),D=this.m_resultSegments[L];let O,U,$,B;a.queryCut(x,I,D,!1),D.get().snapControlPoints(e*e);let V=!1,H=!1,Y=!1,W=!1,ee=!1,ne=N.getNAN(),j=N.getNAN();w!==-1?(U=d[w],O=h[w],V=m[w].bBigMove,ne.assign(c[w]),Y=m[w].bIsBreak,ee=!0):(O=r.weightStart,U=r.rankStart,ne=D.get().getStartXY(),Y=r.u.bBreakStart),A<u?(B=d[A],$=h[A],H=m[A].bBigMove,j.assign(c[A]),W=m[A].bIsBreak,ee=!0):($=r.weightEnd,B=r.rankEnd,j=D.get().getEndXY(),W=r.u.bBreakEnd),ee&&D.get().setCoordsForIntersector(ne,j,!0),this.m_resultParts1.push(this.newIntersectionPart_(L,O,U,$,B,v,_,Y,W,r.segmentParentage));const oe=this.m_resultParts1.at(-1);oe.u.bBigMoveStart=V,oe.u.bBigMoveEnd=H,x=I,w=A}else w===-1&&(w=A)}const T=st(u,0);for(let A=0;A<u;A++)T[A]=A;u>2?(T.sort((A,I)=>this.m_param2[A]<this.m_param2[I]?-1:this.m_param2[A]>this.m_param2[I]?1:0),KS(this.m_param2)):u===2&&this.m_param2[0]>this.m_param2[1]&&(this.m_param2[1]=Ge(this.m_param2[0],this.m_param2[0]=this.m_param2[1]),T[1]=Ge(T[0],T[0]=T[1]));const C=o.rankInterior,M=o.weightInterior;x=0,w=-1;for(let A=0;A<=u;A++){const I=A<u?this.m_param2[A]:1;if(I!==x){const L=this.allocResultSegment(),D=this.m_resultSegments[L];let O,U,$,B;l.queryCut(x,I,D,!1),D.get().snapControlPoints(e*e);let V=N.getNAN(),H=N.getNAN(),Y=!1,W=!1,ee=!1,ne=!1,j=!1;if(w!==-1){const ve=T[w];O=h[ve],U=d[ve],V.assign(c[ve]),ee=f[ve].bBigMove,Y=f[ve].bIsBreak,j=!0}else O=o.weightStart,U=o.rankStart,V=D.get().getStartXY(),Y=o.u.bBreakStart;if(A!==u){const ve=T[A];$=h[ve],B=d[ve],H.assign(c[ve]),ne=f[ve].bBigMove,W=f[ve].bIsBreak,j=!0}else $=o.weightEnd,B=o.rankEnd,H=D.get().getEndXY(),W=o.u.bBreakEnd;j&&D.get().setCoordsForIntersector(V,H,!0),this.m_resultParts2.push(this.newIntersectionPart_(L,O,U,$,B,M,C,Y,W,o.segmentParentage));const oe=this.m_resultParts2.at(-1);oe.u.bBigMoveStart=ee,oe.u.bBigMoveEnd=ne,x=I,w=A}else w===-1&&(w=A)}return n?3:2}return 0}intersectLines3D(e,i,s,n){return z(0),1}intersect2D(e,i){const s=this.m_inputParts[0],n=this.m_inputParts[1],r=this.m_inputSegments[s.segmentIndex].getGeometryType(),o=this.m_inputSegments[n.segmentIndex].getGeometryType();return r!==q.enumLine||o!==q.enumLine?new U4e(this).intersectCurves(e,i):this.intersectLines(e,i)}intersect2DEx(e,i,s,n,r){this.m_point.assignCopy(i),this.m_inputSegments.length!==1&&We(""),this.m_tolerance=e,this.m_changed1=!1,this.m_changed2=!1;const o=Di(e*Ml.c_smallToleranceFactor);let a=!1;const l=this.m_inputParts[0],u=this.m_inputSegments[l.segmentIndex];if(r||u.isIntersectingPoint(i.getXY(),e,!0)){this.m_param1=st(16,Number.NaN);const c=u.getClosestCoordinate(i.getXY(),!1);this.m_param1[0]=c;let h=l.rankInterior,d=l.weightInterior;c===0?(h=l.rankStart,d=l.weightStart):c===1?(h=l.rankEnd,d=l.weightEnd):this.m_changed1=!0;let m=h;const f=s,_=n;m===f&&u.isCurve()&&(m=f+1);let v=1,x=0;const w=new N;if(m===f){const A=u.getCoord2D(c),I=i.getXY();v=d+_,x=h,zn(A,I,_/v,w),this.m_changed1||A.equals(w)||(this.m_changed1=!0),this.m_changed2||I.equals(w)||(this.m_changed2=!0),a=N.sqrDistance(w,A)>o}else m>f?(w.assign(u.getCoord2D(c)),v=d,x=h,this.m_changed2||w.equals(i.getXY())||(this.m_changed2=!0)):(w.assign(u.getCoord2D(c)),v=_,x=f,this.m_changed1||w.equals(i.getXY())||(this.m_changed1=!0),a=N.sqrDistance(w,i.getXY())>o);let T=0,C=-1;const M=1;for(let A=0;A<=M;A++){const I=A<M?this.m_param1[0]:1;if(I!==T){const L=this.allocResultSegment(),D=this.m_resultSegments[L];u.queryCut(T,I,D),D.get().snapControlPoints(e*e);let O=l.weightStart,U=l.weightEnd,$=l.rankStart,B=l.rankEnd;const V=l.rankInterior,H=l.weightInterior;let Y=l.u.bBreakStart,W=l.u.bBreakEnd;C!==-1&&(O=v,$=x,Y=!0,D.get().setCoordsForIntersector(w,D.get().getEndXY(),!0)),A!==M&&(U=v,B=x,W=!0,D.get().setCoordsForIntersector(D.get().getStartXY(),w,!0)),T=I,this.m_resultParts1.push(this.newIntersectionPart_(L,O,$,U,B,H,V,Y,W,l.segmentParentage))}C=A}return this.m_point.setXY(w),this.m_pointWeight=v,this.m_pointRank=x,a?3:2}return 0}intersect3D(e,i,s,n){return z(0),1}intersect3DEx(e,i,s,n,r,o,a){return z(0),1}getTolerance(){return this.m_tolerance}freeAllResultSegments(){this.m_resultSegments.length=0,this.m_freeSegments.length=0}freeResultSegment(e){this.m_freeSegments.push(e)}allocResultSegment(){if(this.m_freeSegments.length)return this.m_freeSegments.pop();const e=new ii,i=this.m_resultSegments.length;return this.m_resultSegments.push(e),i}allocResultSegmentFromBuffer(e){if(this.m_freeSegments.length)return this.m_freeSegments.pop();const i=new ii({copy:e}),s=this.m_resultSegments.length;return this.m_resultSegments.push(i),s}allocResultSegmentFromSegment(e){if(this.m_freeSegments.length)return this.m_freeSegments.pop();const i=new ii({segment:e}),s=this.m_resultSegments.length;return this.m_resultSegments.push(i),s}}function k4e(t,e){return{bBigMoveStart:!1,bBigMoveEnd:!1,bBreakStart:t,bBreakEnd:e}}function $4e(t,e,i,s,n,r,o,a,l,u){return{segmentIndex:t,weightStart:e,rankStart:i,weightEnd:s,rankEnd:n,weightInterior:r,rankInterior:o,segmentParentage:u,u:k4e(a,l)}}function fL(){return{bBigMove:!1,bIsBreak:!1}}Ml.maxWeight=.1*Number.MAX_VALUE,Ml.c_smallToleranceFactor=.01,Ml.c_maxGeometryTypeToRankDelta=8;let wee=class{constructor(){this.start=null,this.end=null,this.equalEdge=null,this.segmentIndex=-1,this.segmentParentage=-1,this.weight=0,this.rank=0}hasSegment(){return this.segmentIndex>=0}transferAttributes(t,e,i){if(e.getDescription().getAttributeCount()===1)return;const s=t.parent.m_resultSegments[this.segmentIndex].get().getStartXY(),n=t.parent.m_resultSegments[this.segmentIndex].get().getEndXY(),r=new Jt;e.queryStart(r),i?(r.setXY(s),t.parent.m_resultSegments[this.segmentIndex].get().setStart(r)):(r.setXY(n),t.parent.m_resultSegments[this.segmentIndex].get().setEnd(r)),e.queryEnd(r),i?(r.setXY(n),t.parent.m_resultSegments[this.segmentIndex].get().setEnd(r)):(r.setXY(s),t.parent.m_resultSegments[this.segmentIndex].get().setStart(r))}copyFromWhenOverlap(t,e,i){this.equalEdge=e,e.equalEdge=this,this.segmentIndex=t.parent.allocResultSegmentFromBuffer(t.parent.m_resultSegments[e.segmentIndex]),this.segmentParentage=e.segmentParentage,this.weight=e.weight,this.rank=e.rank,i?(this.start.copyFrom(e.start),this.end.copyFrom(e.end)):(this.start.copyFrom(e.end),this.end.copyFrom(e.start),t.parent.m_resultSegments[this.segmentIndex].get().reverse())}getEnd(){return this.end}getNextInChain(){return this.end.nextInChain}getPrevInChain(){return this.start.prevInChain}};class See{constructor(){this.hash=0,this.pt=new N,this.prevInChain=null,this.nextInChain=null,this.prevInHash=null,this.nextInHash=null,this.prevEqual=null,this.nextEqual=null,this.weight=0,this.rank=0,this.bBigMove=!1,this.bIsBreak=!1}copyFrom(e){this.pt.assign(e.pt),this.weight=e.weight,this.rank=e.rank,this.bBigMove=e.bBigMove,this.bIsBreak=e.bIsBreak}nextNode(){return this.nextInChain?this.nextInChain.end:null}prevNode(){return this.prevInChain?this.prevInChain.start:null}equalListHead(){let e=this;for(;e.prevEqual!==null;e=e.prevEqual);return e}}function zg(t,e,i,s){return{edge1:t,edge2:e,recursion:i,bIsIntersecting:s}}let U4e=class{constructor(e){this.m_pairs=[],this.m_chainOrigin1=null,this.m_chainOrigin2=null,this.m_newNodes=[],this.m_hashTableOfEquals=[],this.m_hashTableOfEqualsSize=0,this.m_origin=new N,this.m_cell=new N,this.parent=e}addSegment(e,i,s,n,r,o,a,l,u,c,h){const d=this.newNode(this.parent.m_resultSegments[e].get().getStartXY(),s,n,u),m=this.newNode(this.parent.m_resultSegments[e].get().getEndXY(),r,o,c);this.newEdge(d,m,e,a,l,h),this.m_chainOrigin1===null?this.m_chainOrigin1=d:this.m_chainOrigin2===null?this.m_chainOrigin2=d:z(0)}intersectCurvesHelper(e,i,s,n,r){var ne,j,oe,ve,Ye,de,fe,Ne,je,Ee,Zt,qt,Mi,oi,si,me,Bi,pt;const o=this.getSegment(e).get(),a=this.getSegment(i).get();if(o.isDegenerate(0)||a.isDegenerate(0))return 0;const l=this.tryOverlapIntersectCurves(e,i,s,n);if(l!==0)return l;const u=Di(.01*s);let c=!1,h=this.processSharpCorners(o,a,s,r>4);const d=h>0;if(!d){if(!(n||5&u4(!0,!1,o,a,s,!0)))return 0;h=q1(!0,o,a,null,this.parent.m_param1,this.parent.m_param2,s)}h===0&&We("");const m=o.getGeometryType(),f=a.getGeometryType(),_=he(N,h),v=he(N,h),x=st(h,Number.NaN),w=st(h,Number.NaN),T=st(h,Number.NaN),C=st(h,Number.NaN),M=eJ(fL,h),A=eJ(fL,h);let I=!1,L=!1;for(let $e=0;$e<h;$e++){const wt=this.parent.m_param1[$e],$i=this.parent.m_param2[$e];let Mt=e.rank,le=e.weight,te=!0,De=!1;wt===0?(Mt=e.start.rank,le=e.start.weight,De=e.start.bIsBreak):wt===1?(Mt=e.end.rank,le=e.end.weight,De=e.end.bIsBreak):(I=!0,te=!1);let et=i.rank,tt=i.weight,Ze=!1,Ct=!0;$i===0?(et=i.start.rank,tt=i.start.weight,Ze=i.start.bIsBreak):$i===1?(et=i.end.rank,tt=i.end.weight,Ze=i.end.bIsBreak):(L=!0,Ct=!1);let gt=Mt,dt=et;if(gt===dt&&(gt*=Ml.c_maxGeometryTypeToRankDelta,dt*=Ml.c_maxGeometryTypeToRankDelta,gt+=Vx(m,o,!1),dt+=Vx(f,a,!1)),te&&Ct&&dt===gt){const ms=o.getCoord2D(wt),we=a.getCoord2D($i);ms.equals(we)&&(dt=gt-1)}let hi=1,ct=0,xt=1,li=0;const jt=new N,Tt=new N,Ii=o.getCoord2D(wt),di=a.getCoord2D($i);if(d&&N.distance(Ii,di)>s)jt.setCoordsPoint2D(Ii),Tt.setCoordsPoint2D(di),hi=le,xt=tt,ct=Mt,li=et,M[$e].bBigMove=!1,A[$e].bBigMove=!1,De=!0,Ze=!0;else if(gt===dt){xt=hi=le+tt,li=ct=Mt,zn(Ii,di,tt/hi,jt),Tt.setCoordsPoint2D(jt);const ms=N.sqrDistance(jt,Ii),we=N.sqrDistance(jt,di);M[$e].bBigMove=ms>u,A[$e].bBigMove=we>u,I||Ii.equals(jt)||(I=!0),L||di.equals(Tt)||(L=!0)}else if(gt>dt){jt.setCoordsPoint2D(Ii),Tt.setCoordsPoint2D(jt),xt=hi=le,li=ct=Mt;const ms=N.sqrDistance(jt,di);M[$e].bBigMove=!1,A[$e].bBigMove=ms>u,L||di.equals(Tt)||(L=!0)}else{Tt.setCoordsPoint2D(di),jt.setCoordsPoint2D(Tt),xt=hi=tt,li=ct=et;const ms=N.sqrDistance(jt,Ii);M[$e].bBigMove=ms>u,A[$e].bBigMove=!1,I||Ii.equals(jt)||(I=!0)}_[$e].assign(jt),v[$e].assign(Tt),x[$e]=hi,w[$e]=xt,T[$e]=ct,C[$e]=li,M[$e].bIsBreak=De||Ze,A[$e].bIsBreak=De||Ze,c||(c=M[$e].bBigMove||A[$e].bBigMove),$e>0&&(wt!==this.parent.m_param1[$e-1]&&$i!==this.parent.m_param2[$e-1]||(T[$e]<=T[$e-1]?(_[$e].assign(v[$e-1]),x[$e]=w[$e-1],T[$e]=C[$e-1],v[$e].assign(v[$e-1]),w[$e]=w[$e-1],C[$e]=C[$e-1],(ne=M[$e]).bBigMove||(ne.bBigMove=M[$e-1].bBigMove),(j=A[$e]).bBigMove||(j.bBigMove=A[$e-1].bBigMove),(oe=M[$e]).bIsBreak||(oe.bIsBreak=M[$e-1].bIsBreak),(ve=A[$e]).bIsBreak||(ve.bIsBreak=A[$e-1].bIsBreak)):(_[$e-1].assign(_[$e]),x[$e-1]=x[$e],T[$e-1]=T[$e],v[$e-1].assign(v[$e]),w[$e-1]=w[$e],C[$e-1]=C[$e],(Ye=M[$e-1]).bBigMove||(Ye.bBigMove=M[$e].bBigMove),(de=A[$e-1]).bBigMove||(de.bBigMove=A[$e].bBigMove),(fe=M[$e-1]).bIsBreak||(fe.bIsBreak=M[$e].bIsBreak),(Ne=A[$e-1]).bIsBreak||(Ne.bIsBreak=A[$e].bIsBreak))))}if(!(I||L||h!==2||m===q.enumLine&&f===q.enumLine)){if(this.processDoublyConnectedEdges(e,i,r+1,s))return this.parent.m_changed1=!0,this.parent.m_changed2=!0,2;z(0)}(je=this.parent).m_changed1||(je.m_changed1=I),(Ee=this.parent).m_changed2||(Ee.m_changed2=L);let D=e,O=e.end.weight,U=e.end.rank,$=e.end.bBigMove,B=e.end.bIsBreak,V=0,H=-1;for(let $e=0;$e<=h;$e++){const wt=$e<h?this.parent.m_param1[$e]:1;if(wt!==V){const $i=this.parent.allocResultSegment(),Mt=this.parent.m_resultSegments[$i];let le,te,De,et;o.queryCut(V,wt,Mt,!1),Mt.get().snapControlPoints(s*s);let tt=!1,Ze=!1,Ct=!1,gt=!1;const dt=new N,hi=new N;H!==-1?(te=T[H],le=x[H],Ct=M[H].bBigMove,tt=M[H].bIsBreak,dt.assign(_[H])):(le=e.start.weight,te=e.start.rank,Ct=e.start.bBigMove,tt=e.start.bIsBreak,dt.assign(Mt.get().getStartXY())),$e<h?(et=T[$e],De=x[$e],gt=M[$e].bBigMove,Ze=M[$e].bIsBreak,hi.assign(_[$e])):(De=O,et=U,gt=$,Ze=B,hi.assign(Mt.get().getEndXY()));let ct=D;wt<1&&(this.splitEdgeInPlace(D),ct=D.getNextInChain()),this.updateSegmentOnly(D,$i),D.start.hash===0||D.start.pt.equals(dt)||(this.m_newNodes.push(D.start),this.removeNodeFromHash(D.start),D.start.hash=0),D.end.hash===0||D.end.pt.equals(hi)||(this.m_newNodes.push(D.end),this.removeNodeFromHash(D.end),D.end.hash=0),D.start.pt.assign(dt),D.end.pt.assign(hi),(Zt=D.start).bBigMove||(Zt.bBigMove=Ct),(qt=D.end).bBigMove||(qt.bBigMove=gt),(Mi=D.start).bIsBreak||(Mi.bIsBreak=tt),(oi=D.end).bIsBreak||(oi.bIsBreak=Ze),D.start.weight=le,D.start.rank=te,D.end.weight=De,D.end.rank=et,D=ct,V=wt,H=$e}else H===-1&&(H=$e)}const Y=D.getNextInChain(),W=[];W.length=h;for(let $e=0;$e<h;$e++)W[$e]=$e;h>2?(W.sort(($e,wt)=>Vm(this.parent.m_param2[$e],this.parent.m_param2[wt])),this.parent.m_param2.sort(Vm)):h===2&&this.parent.m_param2[0]>this.parent.m_param2[1]&&(this.parent.m_param2[1]=Ge(this.parent.m_param2[0],this.parent.m_param2[0]=this.parent.m_param2[1]),W[1]=Ge(W[0],W[0]=W[1])),D=i,O=i.end.weight,U=i.end.rank,$=i.end.bBigMove,B=i.end.bIsBreak,V=0,H=-1;for(let $e=0;$e<=h;$e++){const wt=$e<h?this.parent.m_param2[$e]:1;if(wt!==V){const $i=this.parent.allocResultSegment(),Mt=this.parent.m_resultSegments[$i];let le,te,De,et;a.queryCut(V,wt,Mt,!1),Mt.get().snapControlPoints(s*s);const tt=new N,Ze=new N;let Ct=!1,gt=!1,dt=!1,hi=!1;if(H!==-1){const xt=W[H];le=w[xt],te=C[xt],tt.assign(v[xt]),dt=A[xt].bBigMove,Ct=A[xt].bIsBreak}else le=i.start.weight,te=i.start.rank,dt=i.start.bBigMove,Ct=i.start.bIsBreak,tt.assign(Mt.get().getStartXY());if($e!==h){const xt=W[$e];De=w[xt],et=C[xt],Ze.assign(v[xt]),hi=A[xt].bBigMove,gt=A[xt].bIsBreak}else De=O,et=U,hi=$,gt=B,Ze.assign(Mt.get().getEndXY());let ct=D;wt<1&&(this.splitEdgeInPlace(D),ct=D.getNextInChain()),this.updateSegmentOnly(D,$i),D.start.hash===0||D.start.pt.equals(tt)||(this.m_newNodes.push(D.start),this.removeNodeFromHash(D.start),D.start.hash=0),D.end.hash===0||D.end.pt.equals(Ze)||(this.m_newNodes.push(D.end),this.removeNodeFromHash(D.end),D.end.hash=0),D.start.pt.assign(tt),D.end.pt.assign(Ze),(si=D.start).bBigMove||(si.bBigMove=dt),(me=D.end).bBigMove||(me.bBigMove=hi),(Bi=D.start).bIsBreak||(Bi.bIsBreak=Ct),(pt=D.end).bIsBreak||(pt.bIsBreak=gt),D.start.weight=le,D.start.rank=te,D.end.weight=De,D.end.rank=et,D=ct,V=wt,H=$e}else H===-1&&(H=$e)}const ee=D.getNextInChain();return this.postProcessResultPartsForCurves(e,Y,i,ee,r+1),c?3:2}intersectCurves(e,i){this.parent.m_inputSegments.length!==2&&We(""),this.parent.m_changed1=!1,this.parent.m_changed2=!1,this.parent.m_tolerance=e,this.m_hashTableOfEqualsSize=0,this.m_hashTableOfEquals=XT(16);const s=J.constructEmpty();for(let o=0;o<2;o++){const a=this.parent.allocResultSegmentFromSegment(this.parent.m_inputSegments[this.parent.m_inputParts[o].segmentIndex]),l=J.constructEmpty();this.parent.m_inputSegments[this.parent.m_inputParts[o].segmentIndex].queryLooseEnvelope(l),s.mergeEnvelope2D(l);const u=this.parent.m_inputParts[o];this.addSegment(a,0,u.weightStart,u.rankStart,u.weightEnd,u.rankEnd,u.weightInterior,u.rankInterior,u.u.bBreakStart,u.u.bBreakEnd,u.segmentParentage)}s.inflateCoords(100*e,100*e),this.m_origin.assign(s.getLowerLeft()),this.m_cell.setCoords(2*e,2*e),this.m_pairs.push(zg(this.m_chainOrigin1.nextInChain,this.m_chainOrigin2.nextInChain,0,i));let n=0,r=!0;for(;this.m_pairs.length;){const o=this.m_pairs.at(-1);this.m_pairs.pop(),z(o.recursion>=0),z(o.recursion<=256),this.clusterNodes(e);const a=this.intersectCurvesHelper(o.edge1,o.edge2,e,o.bIsIntersecting,o.recursion);r&&(r=!1,n=a)}for(let o=0;o<2;o++){const a=o===0?this.parent.m_resultParts1:this.parent.m_resultParts2;for(let l=(o===0?this.m_chainOrigin1:this.m_chainOrigin2).nextInChain;l!=null;l=l.getNextInChain())a.push(this.parent.newIntersectionPart_(l.segmentIndex,l.start.weight,l.start.rank,l.end.weight,l.end.rank,l.weight,l.rank,l.start.bIsBreak,l.end.bIsBreak,l.segmentParentage)),a.at(-1).u.bBigMoveStart=l.start.bBigMove,a.at(-1).u.bBigMoveEnd=l.end.bBigMove}return n}tryOverlapIntersectCurves(e,i,s,n){const r=this.parent.m_resultSegments[e.segmentIndex].get(),o=this.parent.m_resultSegments[i.segmentIndex].get(),a=r.getStartXY().equals(o.getStartXY())&&r.getEndXY().equals(o.getEndXY()),l=r.getStartXY().equals(o.getEndXY())&&r.getEndXY().equals(o.getStartXY());if(!a&&!l)return 0;const u=Gl(r,o,!0);if(u!==0&&_fe(r,o)&&e.segmentParentage===i.segmentParentage){let f=!1;if(u>0)f=r.equals(o);else{z(u===-1);const _=new ii({segment:o});_.get().reverse(),f=r.equals(_.get())}if(f)return 1}const c=s*Ml.c_smallToleranceFactor;let h=!1;if(u===0){const f=[.5,.25,.75,.125,.375,.625,.875,.5625,.3125];for(let _=0,v=f.length;_<v;++_){const x=f[_],w=new N;r.queryCoord2D(x,w);const T=o.getClosestCoordinate(w,!1),C=new N;o.queryCoord2D(T,C);const M=N.distance(w,C);if(M>s)return 0;h||(h=M>c)}for(let _=0,v=f.length;_<v;++_){const x=f[_],w=new N;o.queryCoord2D(x,w);const T=r.getClosestCoordinate(w,!1),C=new N;r.queryCoord2D(T,C);const M=N.distance(w,C);if(M>s)return 0;h||(h=M>c)}}let d=e.rank,m=i.rank;return d===m&&(d*=Ml.c_maxGeometryTypeToRankDelta,m*=Ml.c_maxGeometryTypeToRankDelta,d+=Vx(r.getGeometryType(),r,!0),m+=Vx(o.getGeometryType(),o,!0)),d>m?(i.copyFromWhenOverlap(this,e,a),i.transferAttributes(this,r,a)):m>d?(e.copyFromWhenOverlap(this,i,a),e.transferAttributes(this,o,a)):e.segmentParentage<=i.segmentParentage?(e.weight=e.weight+i.weight,i.copyFromWhenOverlap(this,e,a),i.transferAttributes(this,r,a)):(i.weight=e.weight+i.weight,e.copyFromWhenOverlap(this,i,a),e.transferAttributes(this,o,a)),h?3:2}postProcessResultPartsForCurves(e,i,s,n,r){r===iJ()&&We("curve_helper");for(let o=e;o!==i;o=o.getNextInChain())this.updateSegmentToNodes(o);for(let o=s;o!==n;o=o.getNextInChain())this.updateSegmentToNodes(o);for(let o=e;o!==i;o=o.getNextInChain()){const a=o.end.pt.sub(o.start.pt);for(let l=s;l!==n;l=l.getNextInChain()){let u=0;if(o.start.pt.equals(l.start.pt)&&o.end.pt.equals(l.end.pt)?u=1:o.start.pt.equals(l.end.pt)&&o.end.pt.equals(l.start.pt)&&(u=-1),!u){let _=o.start.pt.equals(l.start.pt)?1:0;if(_||(_=o.end.pt.equals(l.end.pt)?2:0,_||(_=o.end.pt.equals(l.start.pt)?3:0,_||(_=o.start.pt.equals(l.end.pt)?4:0))),_){const v=l.end.pt.sub(l.start.pt),x=a.dotProduct(v);let w;switch(_){case 1:case 2:w=x>0;break;case 3:case 4:w=x<0;break;default:We("post_process_result_parts_for_curves_")}w&&this.m_pairs.push(zg(o,l,r,!1))}continue}const c=this.parent.m_resultSegments[o.segmentIndex],h=this.parent.m_resultSegments[l.segmentIndex],d=[.5,.25,.75];for(let _=0,v=d.length;_<v;++_){const x=d[_],w=new N;c.get().queryCoord2D(x,w);const T=h.get().getClosestCoordinate(w,!1),C=new N;if(h.get().queryCoord2D(T,C),N.distance(w,C)>this.parent.m_tolerance){u=0;break}}if(!u){this.m_pairs.push(zg(o,l,r,!1));continue}for(let _=0,v=d.length;_<v;++_){const x=d[_],w=new N;h.get().queryCoord2D(x,w);const T=c.get().getClosestCoordinate(w,!1),C=new N;if(c.get().queryCoord2D(T,C),N.distance(w,C)>this.parent.m_tolerance){u=0;break}}if(!u){this.m_pairs.push(zg(o,l,r,!1));continue}o.equalEdge=l,l.equalEdge=o;let m=o.rank,f=l.rank;m===f&&(m*=Ml.c_maxGeometryTypeToRankDelta,f*=Ml.c_maxGeometryTypeToRankDelta,m+=Vx(c.get().getGeometryType(),c.get(),!0),f+=Vx(h.get().getGeometryType(),h.get(),!0)),m>f||m===f&&o.segmentParentage<=l.segmentParentage?(c.copyTo(h,!1),l.segmentParentage=o.segmentParentage,u===-1&&h.get().reverse()):(h.copyTo(c,!1),o.segmentParentage=l.segmentParentage,u===-1&&c.get().reverse());break}}this.updateAttachedEdgesAfterNodeChange(e.start),i&&this.updateAttachedEdgesAfterNodeChange(i.start),this.updateAttachedEdgesAfterNodeChange(s.start),n&&this.updateAttachedEdgesAfterNodeChange(n.start)}processDoublyConnectedEdges(e,i,s,n){s===iJ()&&We("curve_helper");const r=this.getSegment(e).get(),o=this.getSegment(i).get(),a=r.getStartXY().equals(o.getStartXY())&&r.getEndXY().equals(o.getEndXY())?1:r.getEndXY().equals(o.getStartXY())&&r.getStartXY().equals(o.getEndXY())?-1:0;if(a!==0){const l=new ii;r.queryCut(0,.5,l),l.get().snapControlPoints(n*n);const u=new ii;r.queryCut(.5,1,u),u.get().snapControlPoints(n*n),this.splitEdgeInPlace(e),e.end.pt=l.get().getEndXY(),e.segmentIndex=this.parent.allocResultSegmentFromBuffer(l),e.getNextInChain().segmentIndex=this.parent.allocResultSegmentFromBuffer(u);let c=o.getClosestCoordinate(e.end.pt,!1);return Math.abs(c-.5)>.2&&(c=.5),o.queryCut(0,c,l),l.get().snapControlPoints(n*n),o.queryCut(c,1,u),u.get().snapControlPoints(n*n),this.splitEdgeInPlace(i),i.end.pt=l.get().getEndXY(),i.segmentIndex=this.parent.allocResultSegmentFromBuffer(l),i.getNextInChain().segmentIndex=this.parent.allocResultSegmentFromBuffer(u),a>0?(this.m_pairs.push(zg(e,i,s,!1)),this.m_pairs.push(zg(e.getNextInChain(),i.getNextInChain(),s,!1))):(this.m_pairs.push(zg(e,i.getNextInChain(),s,!1)),this.m_pairs.push(zg(e.getNextInChain(),i,s,!1))),!0}return!1}newNode(e,i,s,n){const r=new See;return this.m_newNodes.push(r),r.pt=e,r.rank=s,r.weight=i,r.bIsBreak=n,r}newEdge(e,i,s,n,r,o){const a=new wee;return a.start=e,a.end=i,e.nextInChain=a,i.prevInChain=a,a.segmentIndex=s,a.segmentParentage=o,a.rank=r,a.weight=n,a}splitEdgeInPlace(e){e.segmentIndex=-1;const i=new wee,s=new See;this.m_newNodes.push(s),s.pt.setNAN(),s.nextInChain=i,s.prevInChain=e,s.prevInHash=null,s.nextInHash=null,s.prevEqual=null,s.nextEqual=null,s.weight=e.weight,s.rank=e.rank,s.bIsBreak=!1,s.bBigMove=!1,i.start=s,i.segmentIndex=-1,i.end=e.end,i.end.prevInChain=i,i.rank=e.rank,i.weight=e.weight,i.segmentParentage=e.segmentParentage,e.end=s,e.equalEdge&&(e.equalEdge.equalEdge=null),e.equalEdge=null}updateSegmentOnly(e,i){e.segmentIndex=i}updateAttachedEdgesAfterNodeChange(e){for(let i=e.equalListHead();i!==null;i=i.nextEqual)this.updateAttachedEdgesAfterNodeChangeImpl(i)}updateAttachedEdgesAfterNodeChangeImpl(e){const i=e.prevInChain;if(i&&i.hasSegment()){const n=this.getSegment(i).get();e.pt.equals(n.getEndXY())||(n.setCoordsForIntersector(i.start.pt,i.end.pt,!1),n.ensureXYMonotone())}const s=e.nextInChain;if(s&&s.hasSegment()){const n=this.getSegment(s).get();e.pt.equals(n.getStartXY())||(n.setCoordsForIntersector(s.start.pt,s.end.pt,!1),n.ensureXYMonotone())}}updateSegmentToNodes(e){const i=this.getSegment(e).get();e.start.pt.equals(i.getStartXY())&&e.end.pt.equals(i.getEndXY())||(i.setCoordsForIntersector(e.start.pt,e.end.pt,!1),i.ensureXYMonotone()),this.updateAttachedEdgesAfterNodeChange(e.start),this.updateAttachedEdgesAfterNodeChange(e.end)}getSegment(e){return this.parent.m_resultSegments[e.segmentIndex]}clusterNodes(e){let i=!1;const s=[],n=[],r=[];for(let o=0,a=this.m_newNodes.length;o<a;o++){const l=this.m_newNodes[o];if(l===null)continue;let u=l;for(let c=o+1;c<a;c++){const h=this.m_newNodes[c];h!==null&&l.pt.equals(h.pt)&&(u.nextInHash=h,h.prevInHash=u,u=h,this.m_newNodes[c]=null)}}for(let o=0,a=this.m_newNodes.length;o<a;o++){const l=this.m_newNodes[o];if(l==null)continue;for(l.hash=this.calculateHash(l.pt);;){const m=XT(4),f=this.hashTableBinsToCheck(l,m);for(let v=0;v<f;v++)if(m[v]!==null)for(let x=m[v];x!==null;){const w=x.nextInHash;N.distance(l.pt,x.pt)<=e&&(s.push(x),this.removeNodeFromHash(x),x.hash=0,r.push(x),n.push(x)),x=w}let _=!1;for(const v of s)if(!l.pt.equals(v.pt)){const x=Afe(l.pt,v.pt,l.weight,l.rank,v.weight,v.rank);l.pt.assign(x.pt),l.weight=x.weight,l.rank=x.rank,_=!0,i=!0}if(s.length=0,!_)break;l.hash=this.calculateHash(l.pt)}r.push(l),n.push(l);for(let m=l.nextInHash;m!==null;){m.prevInHash=null;const f=m.nextInHash;m.nextInHash=null,r.push(m),n.push(m),m=f}const u=l.hash;let c=null,h=null;for(const m of n)l!==m&&(m.hash=u,m.pt.assign(l.pt),m.rank=l.rank,m.weight=l.weight),m.prevInHash=c,c&&(c.nextInHash=m),m.prevEqual=h,m.nextEqual=null,h&&(h.nextEqual=m),h=m,c=m;const d=u%this.m_hashTableOfEquals.length;c.nextInHash=this.m_hashTableOfEquals[d],this.m_hashTableOfEquals[d]!==null&&(this.m_hashTableOfEquals[d].prevInHash=c),this.m_hashTableOfEquals[d]=n[0],this.m_hashTableOfEqualsSize+=n.length,n.length=0,this.rehashIfNeeded()}if(this.m_newNodes.length=0,i)for(const o of r)this.updateAttachedEdgesAfterNodeChange(o)}rehashIfNeeded(){if(2*this.m_hashTableOfEqualsSize>this.m_hashTableOfEquals.length){const e=this.m_hashTableOfEquals;this.m_hashTableOfEquals=XT(2*e.length),this.m_hashTableOfEqualsSize=0;for(const i of e){let s=i;for(;s;){const n=s.nextInHash;s.nextInHash=null,s.prevInHash=null,this.addNodeToHashImpl(s),s=n}}}}addNodeToHashImpl(e){const i=e.hash%this.m_hashTableOfEquals.length,s=this.m_hashTableOfEquals[i];e.nextInHash=s,s!==null&&(s.prevInHash=e),this.m_hashTableOfEquals[i]=e,this.m_hashTableOfEqualsSize++}removeNodeFromHash(e){const i=e.hash%this.m_hashTableOfEquals.length,s=e.prevInHash,n=e.nextInHash;s?s.nextInHash=n:this.m_hashTableOfEquals[i]=n,n&&(n.prevInHash=s),this.m_hashTableOfEqualsSize--,e.prevInHash=null,e.nextInHash=null}hashTableBinsToCheck(e,i){const s=(e.pt.x-this.m_origin.x)/this.m_cell.x,n=(e.pt.y-this.m_origin.y)/this.m_cell.y,r=fo()-1,o=Math.round(Os(s,-2147483646,r)),a=Math.round(Os(n,-2147483646,r));let l=o|a<<32;l=nd(l),i[0]=this.m_hashTableOfEquals[l%this.m_hashTableOfEquals.length];let u=o+1|a<<32;u=nd(u);let c=1;i[1]=this.m_hashTableOfEquals[u%this.m_hashTableOfEquals.length],i[1]!==i[0]&&(c=2);let h=o+1|a+1<<32;h=nd(h),i[c]=this.m_hashTableOfEquals[h%this.m_hashTableOfEquals.length];for(let m=0;m<c;m++)if(i[c]===i[m]){c--;break}c++;let d=o|a+1<<32;d=nd(d),i[c]=this.m_hashTableOfEquals[d%this.m_hashTableOfEquals.length];for(let m=0;m<c;m++)if(i[c]===i[m]){c--;break}return c++,c}calculateHash(e){const i=(e.x-this.m_origin.x)/this.m_cell.x,s=(e.y-this.m_origin.y)/this.m_cell.y,n=fo()-1;let r=Math.round(Os(i,-2147483646,n))|Math.round(Os(s,-2147483646,n))<<32;return r=nd(r),r===0&&(r=1),r}processSharpCorners(e,i,s,n){if(this.parent.m_param1.length=0,this.parent.m_param2.length=0,e.getStartXY().equals(i.getStartXY())){const r=[0,0],o=[0,0],a=GD(e,i,0,0,s,2,r,o,n);if(a){this.parent.m_param1.push(0),this.parent.m_param2.push(0);for(let l=0;l<a;l++)this.parent.m_param1.push(r[l]),this.parent.m_param2.push(o[l]);return a+1}}if(e.getEndXY().equals(i.getEndXY())){const r=[0,0],o=[0,0],a=GD(e,i,1,1,s,2,r,o,n);if(a){for(let l=0;l<a;l++)this.parent.m_param1.push(r[l]),this.parent.m_param2.push(o[l]);return this.parent.m_param1.push(1),this.parent.m_param2.push(1),a+1}}if(e.getStartXY().equals(i.getEndXY())){const r=[0,0],o=[0,0],a=GD(e,i,0,1,s,2,r,o,n);if(a){this.parent.m_param1.push(0),this.parent.m_param2.push(1);for(let l=0;l<a;l++)this.parent.m_param1.push(r[l]),this.parent.m_param2.push(o[l]);return a+1}}if(e.getEndXY().equals(i.getStartXY())){const r=[0,0],o=[0,0],a=GD(e,i,1,0,s,2,r,o,n);if(a){for(let l=0;l<a;l++)this.parent.m_param1.push(r[l]),this.parent.m_param2.push(o[l]);return this.parent.m_param1.push(1),this.parent.m_param2.push(0),a+1}}return 0}};function Vx(t,e,i){let s=0;switch(t){case q.enumLine:s=0;break;case q.enumBezier:s=2;break;case q.enumRationalBezier2:s=3;break;case q.enumBezier2:s=1;break;case q.enumEllipticArc:s=e.projectionBehavior()===0?5:4;break;default:We("")}return i?5-s:s}class V4e extends Cfe{constructor(e){super(e.m_shape,e.m_tolerance,!1),this.m_parent=e}compare(e,i,s){if(this.m_bIntersectionDetected)return-1;const n=e.getElement(s),r=this.m_parent.getEdgeOriginVertices(i),o=this.m_parent.m_edgeVertices.getFirstElement(r),a=this.m_parent.getEdgeOriginVertices(n),l=this.m_parent.m_edgeVertices.getFirstElement(a);return this.m_currentNode=s,this.compareSegments(i,o,n,l)}}class z4e extends Tfe{constructor(e){super(e.m_shape,e.m_tolerance),this.m_parent=e}compare(e,i){if(this.m_bIntersectionDetected)return-1;const s=e.getElement(i),n=this.m_parent.getEdgeOriginVertices(s),r=this.m_parent.m_edgeVertices.getFirstElement(n);return this.m_currentNode=i,this.compareVertex(e,i,r)}}class G4e extends B1{constructor(e){super(),this.pt1=N.getNAN(),this.pt2=N.getNAN(),this.m_shape=e}compare(e,i,s){this.m_shape.queryXY(i,this.pt1);const n=e.getElement(s);return this.m_shape.queryXY(n,this.pt2),this.pt1.compare(this.pt2)}}class B4e{constructor(e){this.m_point=N.getNAN(),this.m_pt=N.getNAN(),this.m_shape=e}setPoint(e){this.m_point.setCoordsPoint2D(e)}compare(e,i){const s=e.getElement(i);return this.m_shape.queryXY(s,this.m_pt),this.m_point.compare(this.m_pt)}}class fB{constructor(e,i){this.m_shape=null,this.m_progressTracker=null,this.m_edges=new xs(8),this.m_clusters=new xs(5),this.m_clusterVertices=new As(!1),this.m_edgeVertices=new As(!1),this.m_helperPoint=new Jt,this.m_eventQ=new mr,this.m_sweepStructure=new mr,this.m_bComplications=!1,this.m_sweepComparator=null,this.m_tempEdgeBuffer=[],this.m_modifiedClusters=[],this.m_edgesToInsertInSweepStructure=[],this.m_prevNeighbour=-1,this.m_nextNeighbour=-1,this.m_bContinuingSegmentChainOptimization=!1,this.m_progressCounter=0,this.m_segmentIntersector=new Ml,this.m_segBuf1=new ii,this.m_segBuf2=new ii,this.m_sweepPoint=new N(0,0),this.m_tolerance=0,this.m_toleranceSqr=0,this.m_sweepPointCluster=-1,this.m_vertexClusterIndex=-1,this.m_bCracked=!1,this.m_bSweepPointClusterWasModified=!1,this.m_progressTracker=e,this.m_bTrackChanges=i}hadComplications(){return this.m_bComplications}sweep(e,i){const s=new Gi;s.setSwapCoordinates(),e.applyTransformation(s),this.setEditShape_(e),this.m_bCracked=!1,this.m_tolerance=i,this.m_toleranceSqr=i*i;let n=this.sweepImpl_();return e.applyTransformation(s),n||(this.fillEventQueuePass2(),n=this.sweepImpl_()||n),this.m_shape.removeUserIndex(this.m_vertexClusterIndex),this.m_shape=null,this.m_bCracked}sweepVertical(e,i){this.setEditShape_(e),this.m_bCracked=!1,this.m_tolerance=i,this.m_toleranceSqr=i*i,this.m_bComplications=!1;let s=this.sweepImpl_();if(!this.m_bComplications){const n=e.filterClosePoints(i,!0,!1,this.m_bTrackChanges,G);this.m_bComplications=n===1,s||(s=n===1)}return this.m_vertexClusterIndex!==-1&&(this.m_shape.removeUserIndex(this.m_vertexClusterIndex),this.m_vertexClusterIndex=-1),this.m_shape=null,s}getEdgeCluster(e,i){return this.m_edges.getField(e,0+i)}setEdgeCluster_(e,i,s){this.m_edges.setField(e,0+i,s)}getEdgeOriginVertices(e){return this.m_edges.getField(e,2)}setEdgeOriginVertices_(e,i){this.m_edges.setField(e,2,i)}getNextEdgeEx(e,i){return this.m_edges.getField(e,3+i)}setNextEdgeEx_(e,i,s){this.m_edges.setField(e,3+i,s)}getEdgeSweepNode(e){return this.m_edges.getField(e,7)}setEdgeSweepNode_(e,i){this.m_edges.setField(e,7,i)}getNextEdge(e,i){const s=this.getEdgeEnd(e,i);return this.m_edges.getField(e,3+s)}setNextEdge_(e,i,s){const n=this.getEdgeEnd(e,i);this.m_edges.setField(e,3+n,s)}getPrevEdge(e,i){const s=this.getEdgeEnd(e,i);return this.m_edges.getField(e,5+s)}setPrevEdge_(e,i,s){const n=this.getEdgeEnd(e,i);this.m_edges.setField(e,5+n,s)}getClusterVertices(e){return this.m_clusters.getField(e,0)}setClusterVertices_(e,i){this.m_clusters.setField(e,0,i)}getClusterSweepEdgeList(e){return this.m_clusters.getField(e,2)}setClusterSweepEdgeList_(e,i){this.m_clusters.setField(e,2,i)}getClusterFirstEdge(e){return this.m_clusters.getField(e,1)}setClusterFirstEdge_(e,i){this.m_clusters.setField(e,1,i)}getClusterEventQNode(e){return this.m_clusters.getField(e,3)}setClusterEventQNode_(e,i){this.m_clusters.setField(e,3,i)}newCluster_(e){const i=this.m_clusters.newElement(),s=this.m_clusterVertices.createList();return this.setClusterVertices_(i,s),e!==G&&(this.m_clusterVertices.addElement(s,e),this.m_shape.setUserIndex(e,this.m_vertexClusterIndex,i)),i}deleteCluster_(e){this.m_clusters.deleteElement(e)}addVertexToCluster_(e,i){const s=this.getClusterVertices(e);this.m_clusterVertices.addElement(s,i),this.m_shape.setUserIndex(i,this.m_vertexClusterIndex,e)}newEdge_(e){const i=this.m_edges.newElement(),s=this.m_edgeVertices.createList();return this.setEdgeOriginVertices_(i,s),e!==-1&&this.m_edgeVertices.addElement(s,e),i}addVertexToEdge_(e,i){const s=this.getEdgeOriginVertices(e);this.m_edgeVertices.addElement(s,i)}deleteEdge_(e){this.m_edges.deleteElement(e);const i=this.m_edgesToInsertInSweepStructure.findIndex(s=>s===e);i>=0&&s3e(this.m_edgesToInsertInSweepStructure,i)}addEdgeToCluster(e,i){this.getEdgeCluster(e,0)===-1?this.setEdgeCluster_(e,0,i):this.getEdgeCluster(e,1)===-1?this.setEdgeCluster_(e,1,i):We(""),this.addEdgeToClusterImpl_(e,i)}addEdgeToClusterImpl_(e,i){const s=this.getClusterFirstEdge(i);if(s!==-1){const n=this.getNextEdge(s,i);this.setPrevEdge_(n,i,e),this.setNextEdge_(e,i,n),this.setNextEdge_(s,i,e),this.setPrevEdge_(e,i,s)}else this.setPrevEdge_(e,i,e),this.setNextEdge_(e,i,e),this.setClusterFirstEdge_(i,e)}getEdgeEnd(e,i){return this.getEdgeCluster(e,0)===i?0:1}mergeClusters_(e,i){this.dbgCheckCluster_(e),this.dbgCheckCluster_(i);const s=this.getClusterEventQNode(i);s!==-1&&(this.m_eventQ.deleteNode(s),this.setClusterEventQNode_(i,-1));let n=this.getClusterFirstEdge(e),r=this.getClusterFirstEdge(i);if(r!==-1){let l=r,u=r,c=!1;do{this.dbgCheckEdge_(l),c=!1;const h=this.getEdgeEnd(l,i),d=this.getNextEdgeEx(l,h);if(this.getEdgeCluster(l,h+1&1)===e){this.disconnectEdge_(l);const m=this.getEdgeOriginVertices(l);if(this.m_edgeVertices.deleteList(m),this.deleteEdge_(l),l===d){r=-1;break}r===l&&(r=this.getClusterFirstEdge(i),u=d,c=!0)}l=d}while(l!==u||c);if(r!==-1){do{const h=this.getEdgeEnd(l,i),d=this.getNextEdgeEx(l,h);this.setEdgeCluster_(l,h,e),l=d}while(l!==u);if(n=this.getClusterFirstEdge(e),n!==-1){const h=this.getNextEdge(n,e),d=this.getNextEdge(r,e);h===n?(this.setClusterFirstEdge_(e,r),this.addEdgeToClusterImpl_(n,e),this.setClusterFirstEdge_(e,n)):d===r&&this.addEdgeToClusterImpl_(r,e),this.setNextEdge_(r,e,h),this.setPrevEdge_(h,e,r),this.setNextEdge_(n,e,d),this.setPrevEdge_(d,e,n)}else this.setClusterFirstEdge_(e,r)}}const o=this.getClusterVertices(e),a=this.getClusterVertices(i);for(let l=this.m_clusterVertices.getFirst(a);l!==-1;l=this.m_clusterVertices.getNext(l)){const u=this.m_clusterVertices.getElement(l);this.m_shape.setUserIndex(u,this.m_vertexClusterIndex,e)}this.m_clusterVertices.concatenateLists(o,a),this.deleteCluster_(i),this.dbgCheckCluster_(e)}mergeEdges_(e,i){this.dbgCheckEdge_(e),this.dbgCheckEdge_(i);const s=this.getEdgeCluster(e,0),n=this.getEdgeCluster(e,1),r=this.getEdgeCluster(i,0),o=this.getEdgeCluster(i,1),a=this.getEdgeOriginVertices(e),l=this.getEdgeOriginVertices(i);if(this.m_edgeVertices.concatenateLists(a,l),i===this.getClusterFirstEdge(s)&&this.setClusterFirstEdge_(s,e),i===this.getClusterFirstEdge(n)&&this.setClusterFirstEdge_(n,e),this.disconnectEdge_(i),this.deleteEdge_(i),!(s===r&&n===o||n===r&&s===o)){const u=this.getClusterXY(s),c=this.getClusterXY(r);u.isEqualPoint2D(c)?(s!==r&&this.mergeClusters_(s,r),n!==o&&this.mergeClusters_(n,o)):(n!==r&&this.mergeClusters_(n,r),s!==o&&this.mergeClusters_(s,o))}this.dbgCheckEdge_(e)}disconnectEdge_(e){const i=this.getEdgeCluster(e,0),s=this.getEdgeCluster(e,1);this.disconnectEdgeFromCluster_(e,i),this.disconnectEdgeFromCluster_(e,s)}disconnectEdgeFromCluster_(e,i){const s=this.getNextEdge(e,i),n=this.getPrevEdge(e,i),r=this.getClusterFirstEdge(i);s!==e?(this.setNextEdge_(n,i,s),this.setPrevEdge_(s,i,n),r===e&&this.setClusterFirstEdge_(i,s)):this.setClusterFirstEdge_(i,-1)}applyIntersectorToEditShape_(e,i,s){let n=this.m_edgeVertices.getFirst(e);const r=this.m_edgeVertices.getElement(n),o=this.getClusterFromVertex(r),a=this.m_shape.getNextVertex(r),l=this.getClusterFromVertex(a),u=this.m_shape.getXY(r),c=this.m_shape.getXY(a);let h=!1,d=!1;const m=i.getResultSegment(s,0).getStartXY(),f=i.getResultSegment(s,i.getResultSegmentCount(s)-1).getEndXY();u.equals(m)||(h=!0),c.equals(f)||(d=!0),this.m_shape.splitSegmentWithIntersector(r,i,s,!0,!0);const _=this.m_bTrackChanges&&i.getSegmentChanged(s);for(_&&this.m_shape.setGeometryModifiedWithVertex(r,!0),n=this.m_edgeVertices.getNext(n);n!==-1;n=this.m_edgeVertices.getNext(n)){const v=this.m_edgeVertices.getElement(n),x=this.getClusterFromVertex(v)===o;this.m_shape.splitSegmentWithIntersector(v,i,s,x,!0),_&&this.m_shape.setGeometryModifiedWithVertex(v,!0)}if(h&&this.updateClusterXY(!0,o,m,i.getResultSegmentStartPointWeight(s,0),i.getResultSegmentStartPointRank(s,0)),d){const v=i.getResultSegmentCount(s)-1;this.updateClusterXY(!0,l,f,i.getResultSegmentEndPointWeight(s,v),i.getResultSegmentEndPointRank(s,v))}}createEdgesAndClustersFromSplitEdge_(e,i,s){this.dbgCheckNewEdgesArray_();const n=this.getEdgeOriginVertices(e),r=this.getEdgeCluster(e,0),o=this.getEdgeCluster(e,1);let a=this.newEdge_(-1);this.m_edgesToInsertInSweepStructure.push(a);const l=xs.impossibleIndex3();this.setEdgeSweepNode_(a,l),this.m_tempEdgeBuffer.push(a),this.addEdgeToCluster(a,r);const u=i.getResultSegmentCount(s);for(let c=1;c<u;c++){const h=this.newCluster_(-1);this.m_modifiedClusters.push(h),this.m_tempEdgeBuffer.push(h),this.addEdgeToCluster(a,h);const d=this.newEdge_(-1);this.m_edgesToInsertInSweepStructure.push(d),this.setEdgeSweepNode_(d,l),this.m_tempEdgeBuffer.push(d),this.addEdgeToCluster(d,h),a=d}this.addEdgeToCluster(a,o);for(let c=this.m_edgeVertices.getFirst(n);c!==-1;c=this.m_edgeVertices.getNext(c)){let h=this.m_edgeVertices.getElement(c);if(this.getClusterFromVertex(h)===r){let d=0;const m=this.m_tempEdgeBuffer.length;do{if(d>0){const _=this.m_tempEdgeBuffer[d-1];this.addVertexToCluster_(_,h)}const f=this.m_tempEdgeBuffer[d];d+=2,this.addVertexToEdge_(f,h),h=this.m_shape.getNextVertex(h)}while(d<m)}else{let d=this.m_tempEdgeBuffer.length-1;do{if(d<this.m_tempEdgeBuffer.length-2){const f=this.m_tempEdgeBuffer[d+1];this.addVertexToCluster_(f,h)}const m=this.m_tempEdgeBuffer[d];d-=2,this.addVertexToEdge_(m,h),h=this.m_shape.getNextVertex(h)}while(d>=0)}}this.m_tempEdgeBuffer.length=0,this.dbgCheckNewEdgesArray_()}getVertexFromClusterIndex(e){const i=this.getClusterVertices(e);return this.m_clusterVertices.getFirstElement(i)}getClusterFromVertex(e){return this.m_shape.getUserIndex(e,this.m_vertexClusterIndex)}processSplitHelper1_(e,i,s){const n=this.getEdgeCluster(i,0),r=this.getClusterXY(n),o=this.getEdgeCluster(i,1),a=this.getClusterXY(o),l=s.getResultSegmentCount(e);let u=s.getResultSegment(e,0);const c=u.getStartXY();if(r.isEqualPoint2D(c)||(this.m_bComplications||r.compare(this.m_sweepPoint)*c.compare(this.m_sweepPoint)<0&&(this.m_bComplications=!0),this.getAffectedEdges(n,this.m_tempEdgeBuffer),this.m_modifiedClusters.push(n)),!this.m_bComplications&&l>1){const d=r.compare(a),m=u.getEndXY();(r.compare(m)!==d||m.compare(a)!==d||m.compare(this.m_sweepPoint)<0)&&(this.m_bComplications=!0)}u=s.getResultSegment(e,l-1);const h=u.getEndXY();a.isEqualPoint2D(h)||(this.m_bComplications||a.compare(this.m_sweepPoint)*h.compare(this.m_sweepPoint)<0&&(this.m_bComplications=!0),this.getAffectedEdges(o,this.m_tempEdgeBuffer),this.m_modifiedClusters.push(o)),this.m_tempEdgeBuffer.push(i);for(let d=0,m=this.m_tempEdgeBuffer.length;d<m;d++){const f=this.m_tempEdgeBuffer[d],_=this.getEdgeSweepNode(f);xs.isValidElement(_)&&(this.m_sweepStructure.deleteNode(_),this.setEdgeSweepNode_(f,-1));const v=xs.impossibleIndex3();f!==i&&this.getEdgeSweepNode(f)!==v&&(this.m_edgesToInsertInSweepStructure.push(f),this.setEdgeSweepNode_(f,v))}this.m_tempEdgeBuffer.length=0}checkAndFixIntersection_(e,i){const s=this.m_sweepStructure.getElement(e);return this.m_sweepComparator.compare(this.m_sweepStructure,s,i),!!this.m_sweepComparator.intersectionDetected()&&(this.m_sweepComparator.clearIntersectionDetectedFlag(),this.fixIntersection_(e,i),!0)}fixIntersection_(e,i){this.m_bCracked=!0;const s=this.m_sweepStructure.getElement(e),n=this.m_sweepStructure.getElement(i);let r=null,o=null;const a=this.getEdgeOriginVertices(s),l=this.m_edgeVertices.getFirstElement(a),u=this.getEdgeOriginVertices(n),c=this.m_edgeVertices.getFirstElement(u),h=this.m_shape.querySegment(l,this.m_segBuf1,!1,!1);z(h),r=this.m_segBuf1.get();const d=this.m_shape.getNextVertex(l),m=this.m_shape.getWeight(l),f=this.m_shape.getSegmentParentageBreakVertex(l),_=this.m_shape.getWeight(d),v=this.m_shape.getSegmentParentageBreakVertex(d),x=this.m_shape.getSegmentWeight(l),w=this.m_shape.getRank(l),T=this.m_shape.getRank(d),C=this.m_shape.getSegmentRank(l),M=this.m_shape.getSegmentParentage(l),A=this.m_shape.querySegment(c,this.m_segBuf2,!1,!1);z(A),o=this.m_segBuf2.get();const I=this.m_shape.getNextVertex(c),L=this.m_shape.getWeight(c),D=this.m_shape.getSegmentParentageBreakVertex(c),O=this.m_shape.getWeight(I),U=this.m_shape.getSegmentParentageBreakVertex(I),$=this.m_shape.getSegmentWeight(c),B=this.m_shape.getRank(c),V=this.m_shape.getRank(I),H=this.m_shape.getSegmentRank(c),Y=this.m_shape.getSegmentParentage(c);this.m_segmentIntersector.pushSegment(r,m,w,_,T,x,C,f,v,M),this.m_segmentIntersector.pushSegment(o,L,B,O,V,$,H,D,U,Y),this.m_segmentIntersector.intersect2D(this.m_tolerance,!0)===3&&(this.m_bComplications=!0),this.splitEdge_(s,n,-1,this.m_segmentIntersector),this.m_segmentIntersector.clear()}fixIntersectionPointSegment_(e,i){this.m_bCracked=!0;const s=this.m_sweepStructure.getElement(i);let n=null;const r=this.getEdgeOriginVertices(s),o=this.m_edgeVertices.getFirstElement(r),a=this.m_shape.querySegment(o,this.m_segBuf1,!1,!1);z(a),n=this.m_segBuf1.get();const l=this.m_shape.getNextVertex(o),u=this.m_shape.getWeight(o),c=this.m_shape.getSegmentParentageBreakVertex(o),h=this.m_shape.getWeight(l),d=this.m_shape.getSegmentParentageBreakVertex(l),m=this.m_shape.getSegmentWeight(o),f=this.m_shape.getRank(o),_=this.m_shape.getRank(l),v=this.m_shape.getSegmentRank(o),x=this.m_shape.getSegmentParentage(o),w=this.getClusterFirstVertex(e);this.m_segmentIntersector.pushSegment(n,u,f,h,_,m,v,c,d,x),this.m_shape.queryPoint(w,this.m_helperPoint);const T=this.m_shape.getWeight(w),C=this.m_shape.getRank(w);this.m_segmentIntersector.intersect2DEx(this.m_tolerance,this.m_helperPoint,C,T,!0),this.splitEdge_(s,-1,e,this.m_segmentIntersector),this.m_segmentIntersector.clear()}insertNewEdges_(){if(this.m_edgesToInsertInSweepStructure.length===0)return!0;this.dbgCheckNewEdgesArray_();let e=!0,i=0;const s=this.m_edgesToInsertInSweepStructure.length,n=Math.max(2*s+200,this.m_sweepStructure.size()+200);for(;this.m_edgesToInsertInSweepStructure.length;){if(this.m_edgesToInsertInSweepStructure.length>Math.max(100,this.m_shape.getTotalPointCount())||i>n){this.m_edgesToInsertInSweepStructure.length=0,this.m_bComplications=!0,e=!1;break}const r=this.m_edgesToInsertInSweepStructure.at(-1);this.m_edgesToInsertInSweepStructure.pop(),this.setEdgeSweepNode_(r,-1);const o=this.isEdgeOnSweepLine_(r);xs.isValidElement(o)?(this.insertNewEdgeToSweepStructure_(r,o),i++):o!==xs.impossibleIndex2()&&(e=!1),this.m_bContinuingSegmentChainOptimization=!1}return e}insertNewEdgeToSweepStructure_(e,i){let s;if(this.m_bContinuingSegmentChainOptimization?(s=this.m_sweepStructure.addElementAtPosition(this.m_prevNeighbour,this.m_nextNeighbour,e,!0,!0),this.m_bContinuingSegmentChainOptimization=!1):s=this.m_sweepStructure.addUniqueElement(e),s===-1){const n=this.m_sweepStructure.getDuplicateElement(),r=this.m_sweepStructure.getElement(n);return this.mergeEdges_(r,e),!1}if(this.setEdgeSweepNode_(e,s),this.m_sweepComparator.intersectionDetected()){this.m_sweepComparator.clearIntersectionDetectedFlag();const n=this.m_sweepComparator.getLastComparedNode();return this.m_prevNeighbour===n&&(this.m_prevNeighbour=-1),this.m_nextNeighbour===n&&(this.m_nextNeighbour=-1),this.fixIntersection_(n,s),!0}return!1}isEdgeOnSweepLine_(e){const i=this.getEdgeCluster(e,0),s=this.getEdgeCluster(e,1),n=this.getClusterXY(i),r=this.getClusterXY(s);if(N.sqrDistance(n,r)<=this.m_toleranceSqr)return this.m_bComplications=!0,-1;const o=n.compare(this.m_sweepPoint),a=r.compare(this.m_sweepPoint);return o<=0&&a>0?s:a<=0&&o>0?i:o>0&&a>0?xs.impossibleIndex2():-1}fillEventQueue(){const e=new Un(0),i=this.m_shape.queryVertexIteratorOnSelection();for(let r=i.next();r!==G;r=i.next())this.m_shape.getUserIndex(r,this.m_vertexClusterIndex)!==-1&&e.add(r);this.m_shape.sortVerticesSimpleByY(e,0,e.size()),this.progress_(!0),this.m_eventQ.clear(),this.m_eventQ.setCapacity(e.size()),this.m_eventQ.setComparator(new G4e(this.m_shape));const s=N.getNAN();s.setNAN();let n=-1;for(let r=0,o=e.size();r<o;r++){const a=e.read(r);if(this.m_shape.getXY(a).isEqualPoint2D(s)){const u=this.m_shape.getUserIndex(a,this.m_vertexClusterIndex);this.mergeClusters_(n,u);continue}n=this.getClusterFromVertex(a),this.m_shape.queryXY(a,s);const l=this.m_eventQ.addBiggestElement(a);this.setClusterEventQNode_(n,l)}}fillEventQueuePass2(){const e=new Un(0);for(let i=this.m_eventQ.getFirst();i!==-1;i=this.m_eventQ.getNext(i)){const s=this.m_eventQ.getElement(i);e.add(s)}this.m_eventQ.clear(),this.m_shape.sortVerticesSimpleByY(e,0,e.size()),this.progress_(!0);for(let i=0,s=e.size();i<s;i++){const n=e.read(i),r=this.getClusterFromVertex(n),o=this.m_eventQ.addBiggestElement(n);this.setClusterEventQNode_(r,o)}}getAffectedEdges(e,i){const s=this.getClusterFirstEdge(e);if(s===-1)return;let n=s;do{const r=this.getEdgeSweepNode(n);xs.isValidElement(r)&&i.push(n),n=this.getNextEdge(n,e)}while(n!==s)}updateClusterXY(e,i,s,n,r){const o=this.getClusterVertices(i);for(let a=this.m_clusterVertices.getFirst(o);a!==-1;a=this.m_clusterVertices.getNext(a)){const l=this.m_clusterVertices.getElement(a);this.m_shape.setXYMonotonicPoint2D(l,s),this.m_shape.setWeight(l,n),this.m_shape.setRank(l,r),e&&this.m_bTrackChanges&&this.m_shape.setGeometryModifiedWithVertex(l,!0),this.m_shape.setSegmentParentageBreakVertex(l,!0)}}splitEdge_(e,i,s,n){this.dbgCheckEdge_(e),i!==-1&&this.dbgCheckEdge_(i),this.disconnectEdge_(e),i!==-1&&this.disconnectEdge_(i),this.processSplitHelper1_(0,e,n),i!==-1&&this.processSplitHelper1_(1,i,n),s!==-1&&n.getResultPointChanged()&&this.m_modifiedClusters.push(s);for(let a=0,l=this.m_modifiedClusters.length;a<l;a++){const u=this.m_modifiedClusters[a],c=this.getClusterEventQNode(u);c!==-1&&(this.m_eventQ.deleteNode(c),this.setClusterEventQNode_(u,-1))}const r=this.getEdgeOriginVertices(e),o=i!==-1?this.getEdgeOriginVertices(i):-1;if(this.applyIntersectorToEditShape_(r,n,0),o!==-1)this.applyIntersectorToEditShape_(o,n,1);else{const a=n.getResultPoint().getXY();this.updateClusterXY(n.getResultPointChanged(),s,a,n.getResultPointWeight(),n.getResultPointRank())}this.createEdgesAndClustersFromSplitEdge_(e,n,0),i!==-1&&this.createEdgesAndClustersFromSplitEdge_(i,n,1),this.m_edgeVertices.deleteList(r),this.deleteEdge_(e),i!==-1&&(this.m_edgeVertices.deleteList(o),this.deleteEdge_(i));for(let a=0,l=this.m_modifiedClusters.length;a<l;a++){const u=this.m_modifiedClusters[a];u===this.m_sweepPointCluster&&(this.m_bSweepPointClusterWasModified=!0);let c=this.getClusterEventQNode(u);if(c===-1){const h=this.getClusterFirstVertex(u);if(c=this.m_eventQ.addUniqueElement(h),c===-1){const d=this.m_eventQ.getDuplicateElement(),m=this.m_eventQ.getElement(d),f=this.getClusterFromVertex(m);this.mergeClusters_(f,u)}else this.setClusterEventQNode_(u,c)}}this.m_modifiedClusters.length=0}getClusterXY(e){const i=this.getClusterFirstVertex(e);return this.m_shape.getXY(i)}getClusterFirstVertex(e){const i=this.getClusterVertices(e);return this.m_clusterVertices.getFirstElement(i)}dbgCheckEdge_(e){}dbgCheckCluster_(e){}dbgCheckNewEdgesArray_(){}dbgSaveSweepStructure_(e){}sweepImpl_(){this.progress_(!0),this.m_bSweepPointClusterWasModified=!1,this.m_sweepPointCluster=-1,this.m_sweepComparator===null&&(this.m_sweepStructure.disableBalancing(),this.m_sweepComparator=new V4e(this),this.m_sweepStructure.setComparator(this.m_sweepComparator));const e=[];let i=null,s=null;this.m_prevNeighbour=-1,this.m_nextNeighbour=-1,this.m_bContinuingSegmentChainOptimization=!1;const n=xs.impossibleIndex2(),r=xs.impossibleIndex3();for(let o=this.m_eventQ.getFirst();o!==-1;){this.progress_(),this.dbgCheckSweepStructure_(),this.m_bContinuingSegmentChainOptimization=!1,this.m_prevNeighbour=-1,this.m_nextNeighbour=-1;const a=this.m_eventQ.getElement(o);this.m_sweepPointCluster=this.getClusterFromVertex(a),this.m_shape.queryXY(a,this.m_sweepPoint),this.m_sweepComparator.setSweepY(this.m_sweepPoint.y,this.m_sweepPoint.x);let l=!1;{const c=this.getClusterFirstEdge(this.m_sweepPointCluster);if(l=c===-1,!l){let h=c;do{const d=this.getEdgeSweepNode(h);d===-1?(this.m_edgesToInsertInSweepStructure.push(h),this.setEdgeSweepNode_(h,r)):d!==r&&e.push(d),h=this.getNextEdge(h,this.m_sweepPointCluster)}while(h!==c)}}if(!this.m_sweepStructure.isAutoBalancing()&&(this.m_sweepStructure.getMaxDepthEver()>4||this.m_edgesToInsertInSweepStructure.length>10)&&this.m_sweepStructure.enableBalancing(),e.length>0){this.m_bContinuingSegmentChainOptimization=e.length===1&&this.m_edgesToInsertInSweepStructure.length===1;for(let d=0,m=e.length;d<m;d++){const f=this.m_sweepStructure.getElement(e[d]);this.setEdgeSweepNode_(f,n)}let c=n,h=n;for(let d=0,m=e.length;d<m;d++){const f=e[d];if(c===n){const _=this.m_sweepStructure.getPrev(f);if(_!==-1){const v=this.m_sweepStructure.getElement(_);this.getEdgeSweepNode(v)!==n&&(c=_)}else c=-1}if(h===n){const _=this.m_sweepStructure.getNext(f);if(_!==-1){const v=this.m_sweepStructure.getElement(_);this.getEdgeSweepNode(v)!==n&&(h=_)}else h=-1}if(c!==n&&h!==n)break}for(let d=0,m=e.length;d<m;d++){const f=e[d],_=this.m_sweepStructure.getElement(f);this.m_sweepStructure.deleteNode(f),this.setEdgeSweepNode_(_,-1)}e.length=0,this.m_prevNeighbour=c,this.m_nextNeighbour=h,c!==-1&&h!==-1?this.m_bContinuingSegmentChainOptimization||this.checkAndFixIntersection_(c,h):c===-1&&h===-1&&(this.m_bContinuingSegmentChainOptimization=!1)}else l&&(i===null&&(i=new z4e(this)),i.setPoint(this.m_sweepPoint),this.m_sweepStructure.searchUpperBound(i),i.intersectionDetected()&&(i.clearIntersectionDetectedFlag(),this.fixIntersectionPointSegment_(this.m_sweepPointCluster,i.getCurrentNode())));const u=this.m_bContinuingSegmentChainOptimization;!this.insertNewEdges_()&&u&&this.m_prevNeighbour!==-1&&this.m_nextNeighbour!==-1&&this.checkAndFixIntersection_(this.m_prevNeighbour,this.m_nextNeighbour),this.m_bSweepPointClusterWasModified?(this.m_bSweepPointClusterWasModified=!1,s===null&&(s=new B4e(this.m_shape)),s.setPoint(this.m_sweepPoint),o=this.m_eventQ.searchUpperBound(s)):o=this.m_eventQ.getNext(o)}return this.m_bCracked}setEditShape_(e){this.m_shape=e,this.m_vertexClusterIndex=this.m_shape.createUserIndex(),this.m_edges.setCapacity(e.getSelectedCount()+32),this.m_clusters.setCapacity(e.getSelectedCount()),this.m_clusterVertices.reserveLists(e.getSelectedCount()),this.m_clusterVertices.reserveNodes(e.getSelectedCount()),this.m_edgeVertices.reserveLists(e.getSelectedCount()+32),this.m_edgeVertices.reserveNodes(e.getSelectedCount()+32);for(let i=this.m_shape.getFirstGeometry();i!==G;i=this.m_shape.getNextGeometry(i))if(Ei(this.m_shape.getGeometryType(i)))for(let s=this.m_shape.getFirstPath(i);s!==G;s=this.m_shape.getNextPath(s)){const n=this.m_shape.getPathSize(s),r=this.m_shape.getFirstVertex(s);if(r===G)continue;let o=this.m_shape.getNextVertex(r);if(o===G||o===r)continue;let a=-1;e.selected(r)&&(a=this.newCluster_(r));let l=-1;a!==-1&&e.selected(o)&&(l=this.newEdge_(r),this.addEdgeToCluster(l,a));let u=l;for(let c=0,h=n-2;c<h;c++){const d=this.m_shape.getNextVertex(o);let m=-1;if(this.m_shape.selected(o)){const f=this.newCluster_(o);u!==-1&&this.addEdgeToCluster(u,f),this.m_shape.selected(d)&&(m=this.newEdge_(o),this.addEdgeToCluster(m,f))}u=m,o=d}if(this.m_shape.isClosedPath(s)){const c=this.m_shape.getNextVertex(o);if(this.m_shape.selected(o)){const h=this.newCluster_(o);if(u!==-1&&this.addEdgeToCluster(u,h),this.m_shape.selected(c)){const d=this.newEdge_(o);this.addEdgeToCluster(d,h),this.addEdgeToCluster(d,a)}}}else{let c=-1;this.m_shape.selected(o)&&(c=this.newCluster_(o),u!==-1&&this.addEdgeToCluster(u,c))}}else for(let s=this.m_shape.getFirstPath(i);s!==G;s=this.m_shape.getNextPath(s)){let n=this.m_shape.getFirstVertex(s);for(let r=0,o=this.m_shape.getPathSize(s);r<o;r++)this.m_shape.selected(n)&&this.newCluster_(n),n=this.m_shape.getNextVertex(n)}this.fillEventQueue()}progress_(e=!1){}dbgCheckSweepStructure_(){}}function q4e(t,e,i,s){i>0&&Mfe(t,i,e,!1,s),new H4e(s).executeImpl_(t,e)}function Eee(t,e,i){return{vertex0:t,vertex1:e,dir:i}}class H4e{constructor(e){this.m_shape=null,this.m_spikes=[],this.m_points=new Un(0),this.m_pointsIndex=-1,this.m_dissolvedEdges=0,this.m_progressTracker=e}executeImpl_(e,i){if(this.m_shape=e,e.getPathCount(i)<2&&e.getPointCount(i)<6)return;this.m_points.resize(0);for(let h=e.getFirstPath(i);h!==G;h=e.getNextPath(h)){let d=e.getFirstVertex(h);for(let m=0,f=e.getPathSize(h);m<f;m++,d=e.getNextVertex(d))this.m_points.add(d)}this.m_pointsIndex=e.createUserIndex();for(let h=0,d=this.m_points.size();h<d;++h)e.setUserIndex(this.m_points.read(h),this.m_pointsIndex,h);e.sortVerticesSimpleByY(this.m_points,0,this.m_points.size());let s=this.m_points.read(0);const n=e.getXY(s);let r=1,o=0;const a=[];for(let h=1;h<this.m_points.size();h++){const d=this.m_points.read(h);if(d===G||e.getUserIndex(d,this.m_pointsIndex)===-1)continue;const m=e.getXY(d);if(m.isEqualPoint2D(n))r++;else{if(r>1){for(let f=o;f<h;f++){const _=this.m_points.read(f);if(e.getUserIndex(_,this.m_pointsIndex)===-1)continue;const v=e.getNextVertex(_),x=e.getPrevVertex(_);if(_!==v&&!e.isEqualXYPoint2D(v,n)){const w=Eee(_,v,1);a.push(w)}if(_!==x&&x!==v&&!e.isEqualXYPoint2D(x,n)){const w=Eee(_,x,-1);a.push(w)}}a.length>0&&this.processBunch_(a,n)}s=d,n.assign(m),r=1,o=h}}if(this.m_dissolvedEdges===0)return e.removeUserIndex(this.m_pointsIndex),void(this.m_pointsIndex=-1);let l=e.getPointCount(i);for(let h=0;h<this.m_points.size();h++){const d=this.m_points.read(h);if(d===G)continue;if(e.getUserIndex(d,this.m_pointsIndex)!==-1){e.setUserIndex(d,this.m_pointsIndex,-1);continue}const m=e.getPathFromVertex(d);e.getFirstVertex(m)===d&&e.setFirstVertex(m,G),e.freeVertex(d),this.m_points.write(h,G),l--}const u=e.createPathUserIndex();let c=e.getPathCount(i);for(let h=0,d=this.m_points.size();h<d;++h){if(this.m_points.read(h)===G)continue;let m=this.m_points.read(h);if(e.getUserIndex(m,this.m_pointsIndex)!==-1)continue;let f=e.getPathFromVertex(m),_=-1;if(e.getPathUserIndex(f,u)===2){f=G;for(let T=e.getNextVertex(m);T!==m;T=e.getNextVertex(T)){const C=e.getPathFromVertex(T);if(e.getPathUserIndex(C,u)!==2){f=C,m=T;break}}f===G&&(f=e.insertPath(i,G),e.setClosedPath(f,!0),c++),z(f!==G)}e.setPathUserIndex(f,u,2),_=e.getFirstVertex(f);let v=0,x=!1,w=m;do{_===w&&(x=!0),e.setUserIndex(w,this.m_pointsIndex,1);const T=e.getPathFromVertex(w);T!==f&&(e.getPathUserIndex(T,u)!==2&&(e.setPathUserIndex(T,u,1),e.setFirstVertex(T,G)),e.setPathToVertex(w,f)),v++,w=e.getNextVertex(w)}while(w!==m);x||e.setFirstVertex(f,m),e.setPathSize(f,v)}for(let h=e.getFirstPath(i);h!==G;){const d=e.getNextPath(h);e.getPathUserIndex(h,u)!==1&&e.getFirstVertex(h)!==G||(e.removePathOnly(h),c--),h=d}e.setGeometryVertexCount(i,l),e.setGeometryPathCount(i,c),e.removePathUserIndex(u),e.removeUserIndex(this.m_pointsIndex),this.m_pointsIndex=-1,e.dbgVerifyVertexCounts(),e.filterClosePoints(0,!0,!1,!1,i)}processBunch_(e,i){e.sort((a,l)=>{const u=this.m_shape.getXY(a.vertex1).sub(i),c=this.m_shape.getXY(l.vertex1).sub(i),h=N.compareVectors(u,c);return h===0?a.dir<l.dir?-1:1:h});let s=0;const n=this.m_shape.getXY(e[0].vertex1);let r=1;const o=this.m_shape.hasCurves();for(let a=1,l=e.length;a<l;a++){const u=this.m_shape.getXY(e[a].vertex1);if(!(u.isEqualPoint2D(n)&&(r++,a+1<l))){if(r===2){const c=e[s],h=e[s+1],d=c.dir;if(d!==h.dir){let m=!0;if(o&&(m=!this.m_shape.isCurve(c.dir===1?c.vertex0:c.vertex1)&&!this.m_shape.isCurve(h.dir===1?h.vertex0:h.vertex1)),m){if(d===1){const f=c.vertex0,_=h.vertex0;this.m_shape.setNextVertex(f,_),this.m_shape.setPrevVertex(_,f),this.m_shape.getPrevVertex(f)===_&&(this.m_shape.setUserIndex(f,this.m_pointsIndex,-1),this.m_shape.setUserIndex(_,this.m_pointsIndex,-1));const v=c.vertex1,x=h.vertex1;this.m_shape.setPrevVertex(v,x),this.m_shape.setNextVertex(x,v),this.m_shape.getNextVertex(v)===x&&(this.m_shape.setUserIndex(v,this.m_pointsIndex,-1),this.m_shape.setUserIndex(x,this.m_pointsIndex,-1))}else{const f=c.vertex0,_=h.vertex0;this.m_shape.setPrevVertex(f,_),this.m_shape.setNextVertex(_,f),this.m_shape.getNextVertex(f)===_&&(this.m_shape.setUserIndex(f,this.m_pointsIndex,-1),this.m_shape.setUserIndex(_,this.m_pointsIndex,-1));const v=c.vertex1,x=h.vertex1;this.m_shape.setNextVertex(v,x),this.m_shape.setPrevVertex(x,v),this.m_shape.getPrevVertex(v)===x&&(this.m_shape.setUserIndex(v,this.m_pointsIndex,-1),this.m_shape.setUserIndex(x,this.m_pointsIndex,-1))}this.m_dissolvedEdges+=2}}}n.assign(u),s=a,r=1}}e.length=0}}function Nfe(t){for(let e=t.getFirstGeometry();e!==G;e=t.getNextGeometry(e))if(Ei(t.getGeometryType(e)))return!0;return!1}function j4e(t,e,i,s){if(!Nfe(t))return!1;const n=new C1(s);n.m_shape=t,n.m_tolerance=e,n.m_bTrackChanges=i;let r=!1;const o=t.hasCurves()?5:15;return r=t.getTotalPointCount()<o?n.crackBruteForce_():n.crackerPlaneSweep_(),r}function oj(t,e,i,s,n){if(!Nfe(e))return!1;let r=new C1(n);if(r.m_shape=e,r.m_tolerance=i,r.m_bAllowCoincident=t,r.m_bNeedsNonSimpleResult=s!==null,r.needsCrackingImpl_())return s&&s.assign(r.m_nonSimpleResult),!0;const o=new Gi;o.setSwapCoordinates(),e.applyTransformation(o),r=new C1(n),r.m_shape=e,r.m_tolerance=i,r.m_bAllowCoincident=t,r.m_bNeedsNonSimpleResult=s!==null;const a=r.needsCrackingImpl_();return e.applyTransformation(o),!!a&&(s&&s.assign(r.m_nonSimpleResult),!0)}function Y4e(t,e,i,s){const n=e.getGeometryType();if(Ei(n))return new C1(s).crackAWithBMultiPath_(t,e,i);_i("crack_A_with_B")}function Cee(t,e){return{t,index:e}}class C1{crackBruteForce_(){let e=this.crackBruteForceImpl_();if(!e&&this.m_shape.hasCurves()){const i=new Gi;i.setSwapCoordinates(),this.m_shape.applyTransformation(i),e=this.crackBruteForceImpl_(),this.m_shape.applyTransformation(i)}return e}crackBruteForceImpl_(){let e=!1;const i=new ii,s=new ii,n=J.constructEmpty(),r=J.constructEmpty(),o=!1,a=new Jt,l=new Ml,u=this.m_shape.getTotalPointCount(),c=u*u*2,h=this.m_shape.queryVertexIteratorOnSelection();for(let d=h.next();d!==G;d=h.next()){const m=this.m_shape.getGeometryType(h.currentGeometry());let f=1,_=1,v=1,x=0,w=0,T=0;const C=this.m_shape.getSegmentParentage(d);let M=!1,A=!1,I=null,L=!1;if(lS(m))f=this.m_shape.getWeight(d),x=this.m_shape.getRank(d);else{if(I=this.getSegment_(d,i),I===null)continue;const $=this.m_shape.getVertexIndex(d);f=this.m_shape.getWeightWithIndex($),x=this.m_shape.getRankWithIndex($),v=this.m_shape.getSegmentWeightWithIndex($),T=this.m_shape.getSegmentRankWithIndex($),M=this.m_shape.getSegmentParentageBreakVertex(d);{const B=this.m_shape.getNextVertex(d);_=this.m_shape.getWeight(B),w=this.m_shape.getRank(B),A=this.m_shape.getSegmentParentageBreakVertex(B)}if(I.queryLooseEnvelope(n),n.inflateCoords(this.m_tolerance,this.m_tolerance),I.isDegenerate(this.m_tolerance)){if(!I.isDegenerate(0))continue;L=!0,I=null}}const D=new cB({copy:h});let O=D.next();O!==G&&(O=D.next());let U=0;for(;O!==G;O=D.next()){if(U!==0){U--;continue}if(this.m_shape.getTotalPointCount()>c)return e;this.progress_();const $=this.m_shape.getGeometryType(D.currentGeometry());let B=null,V=!1,H=0,Y=0,W=0,ee=0,ne=0,j=0,oe=!1,ve=!1;const Ye=this.m_shape.getSegmentParentage(O);if(lS($))H=this.m_shape.getWeight(O),ee=this.m_shape.getRank(O);else{if(B=this.getSegment_(O,s),B===null)continue;const Ne=this.m_shape.getVertexIndex(O);H=this.m_shape.getWeightWithIndex(Ne),ee=this.m_shape.getRankWithIndex(Ne),W=this.m_shape.getSegmentWeightWithIndex(Ne),j=this.m_shape.getSegmentRankWithIndex(Ne),oe=this.m_shape.getSegmentParentageBreakVertex(O);{const je=this.m_shape.getNextVertex(O);Y=this.m_shape.getWeight(je),ne=this.m_shape.getRank(je),ve=this.m_shape.getSegmentParentageBreakVertex(je)}if(B.queryLooseEnvelope(r),B.isDegenerate(this.m_tolerance)){if(!B.isDegenerate(0))continue;V=!0,B=null}}let de=0,fe=0;if(I!==null&&B!==null)n.isIntersectingNe(r)&&u4(!0,!0,I,B,this.m_tolerance,!0)!==0&&(l.pushSegment(I,f,x,_,w,v,T,M,A,C),l.pushSegment(B,H,ee,Y,ne,W,j,oe,ve,Ye),l.intersect2D(this.m_tolerance,!0),e||(e=l.getSegmentChanged(0)||l.getSegmentChanged(1)),de=l.getResultSegmentCount(0),fe=l.getResultSegmentCount(1),de+fe>0&&(this.m_shape.splitSegmentWithIntersector(d,l,0,!0,!0),this.m_shape.splitSegmentWithIntersector(O,l,1,!0,!0),this.m_bTrackChanges&&(l.getSegmentChanged(0)&&this.m_shape.setGeometryModifiedWithVertex(d,!0),l.getSegmentChanged(1)&&this.m_shape.setGeometryModifiedWithVertex(O,!0))),fe>1&&(U+=fe-1),l.clear());else if(I!==null){const Ne=this.m_shape.getXY(O);if(n.contains(Ne)){if(l.pushSegment(I,f,x,_,w,v,T,M,A,C),this.m_shape.queryPoint(O,a),l.intersect2DEx(this.m_tolerance,a,ee,H,o),e||(e=l.getSegmentChanged(0)||l.getResultPointChanged()),de=l.getResultSegmentCount(0),de>0)if(this.m_bTrackChanges&&(l.getSegmentChanged(0)&&this.m_shape.setGeometryModifiedWithVertex(d,!0),l.getSegmentChanged(1)&&this.m_shape.setGeometryModifiedWithVertex(O,!0)),this.m_shape.splitSegmentWithIntersector(d,l,0,!0,!0),V){let je=G;for(let Ee=this.m_shape.getNextVertex(O);Ee!==G&&Ee!==O&&(B=this.getSegment_(Ee,s),je=Ee,B!=null&&B.isDegenerate(0));Ee=this.m_shape.getNextVertex(Ee));for(let Ee=O;Ee!==G&&(this.m_shape.setPoint(Ee,l.getResultPoint(),!0),Ee!==je);Ee=this.m_shape.getNextVertex(Ee));}else this.m_shape.setPoint(O,l.getResultPoint(),!0);l.clear()}}else{if(B===null)continue;{const Ne=this.m_shape.getXY(d);if(r.inflateCoords(this.m_tolerance,this.m_tolerance),r.contains(Ne)){if(l.pushSegment(B,H,ee,Y,ne,W,j,oe,ve,Ye),this.m_shape.queryPoint(d,a),l.intersect2DEx(this.m_tolerance,a,x,f,o),e||(e=l.getSegmentChanged(0)||l.getResultPointChanged()),fe=l.getResultSegmentCount(0),fe>0)if(this.m_bTrackChanges&&(l.getSegmentChanged(0)&&this.m_shape.setGeometryModifiedWithVertex(O,!0),l.getSegmentChanged(1)&&this.m_shape.setGeometryModifiedWithVertex(d,!0)),this.m_shape.splitSegmentWithIntersector(O,l,0,!0,!0),U+=fe-1,L){let je=G;for(let Ee=this.m_shape.getNextVertex(d);Ee!==G&&Ee!==d&&(B=this.getSegment_(Ee,s),je=Ee,B!=null&&B.isDegenerate(0));Ee=this.m_shape.getNextVertex(Ee));for(let Ee=d;Ee!==G&&(this.m_shape.setPoint(Ee,l.getResultPoint(),!0),Ee!==je);Ee=this.m_shape.getNextVertex(Ee));}else this.m_shape.setPoint(d,l.getResultPoint(),!0);l.clear()}}}if(de+fe!==0&&de!==0){let Ne=!1;for(;I=this.getSegment_(d,i),I!=null&&(I.queryEnvelope(n),I.isDegenerate(this.m_tolerance));){if(!(de>1)){Ne=!0;break}d=h.next(),de--,z(d!==G)}if(Ne)break}}}return e}crackerPlaneSweep_(){return this.planesweep_()}planesweep_(){return new fB(this.m_progressTracker,this.m_bTrackChanges).sweep(this.m_shape,this.m_tolerance)}needsCrackingImpl_(){let e=!1;const i=new Un(0);i.resize(this.m_shape.getSelectedCount());const s=this.m_shape.queryVertexIteratorOnSelection();for(let h=0,d=s.next();d!==G;++h,d=s.next())i.write(h,d);this.m_shape.sortVerticesSimpleByY(i,0,i.size()),i.add(G);const n=this.m_shape.createUserIndex(),r=this.m_shape.createUserIndex();this.m_sweepComparator=new Cfe(this.m_shape,this.m_tolerance,!this.m_bAllowCoincident),this.m_sweepStructure.setComparator(this.m_sweepComparator);let o=null;const a=[],l=[];let u=0;const c=new N;for(let h=i.read(u++);h!==G;){this.m_shape.queryXY(h,c);let d=!1;do{let x=this.m_shape.getNextVertex(h),w=this.m_shape.getPrevVertex(h);d||(d=x!==G||w!==G),x===G||this.m_shape.selected(x)||(x=G),w===G||this.m_shape.selected(w)||(w=G),x!==G&&this.m_shape.compareVerticesSimpleY(h,x)<0&&(l.push(h),l.push(x)),w!==G&&this.m_shape.compareVerticesSimpleY(h,w)<0&&(l.push(w),l.push(w));const T=this.m_shape.getUserIndex(h,n);T!==-1&&(a.push(T),this.m_shape.setUserIndex(h,n,-1));const C=this.m_shape.getUserIndex(h,r);C!==-1&&(a.push(C),this.m_shape.setUserIndex(h,r,-1)),h=i.read(u++)}while(h!==G&&this.m_shape.isEqualXYPoint2D(h,c));if(!d&&(o===null&&(o=new Tfe(this.m_shape,this.m_tolerance)),o.setPoint(c),this.m_sweepStructure.searchUpperBound(o),o.intersectionDetected())){e=!0,this.m_bNeedsNonSimpleResult&&(We("needsCrackingIMpl_"),this.m_nonSimpleResult=new Rs(6,-1,-1));break}let m=a.length===1&&l.length===2;a.length>32&&KS(a);let _=-1,v=-1;if(!m)for(let x=0,w=a.length;x<w;x++){const T=a[x],C=this.m_sweepStructure.getPrev(T);if(C!==-1&&a.indexOf(C)===-1)if(_===-1)_=C;else{if(e=!0,!this.m_bNeedsNonSimpleResult)break;this.m_nonSimpleResult=new Rs(6,-1,-1)}const M=this.m_sweepStructure.getNext(T);if(M!==-1&&a.indexOf(M)===-1)if(v===-1)v=M;else{if(e=!0,!this.m_bNeedsNonSimpleResult)break;this.m_nonSimpleResult=new Rs(6,-1,-1)}if(_!==-1&&v!==-1)break}if(e&&!this.m_bNeedsNonSimpleResult)break;if(this.m_sweepComparator.setSweepY(c.y,c.x),!m){for(let x=0,w=a.length;x<w;x++){const T=a[x];this.m_sweepStructure.deleteNode(T)}a.length=0}if(!m&&_!==-1&&v!==-1&&this.checkForIntersections_(_,v)){e=!0,this.m_bNeedsNonSimpleResult&&(this.m_nonSimpleResult=this.m_sweepComparator.getResult());break}for(let x=0,w=l.length;x<w;x+=2){const T=l[x],C=l[x+1];let M;if(m?(M=this.m_sweepStructure.replaceElementAtPosition(a[0],T,!0,!0),a.length=0,m=!1):M=this.m_sweepStructure.addElement(T),this.m_sweepComparator.intersectionDetected()){this.m_bNeedsNonSimpleResult&&(this.m_nonSimpleResult=this.m_sweepComparator.getResult()),e=!0;break}this.m_shape.getUserIndex(C,n)===-1?this.m_shape.setUserIndex(C,n,M):this.m_shape.setUserIndex(C,r,M)}if(e)break;l.length=0}return this.m_shape.removeUserIndex(n),this.m_shape.removeUserIndex(r),e}checkForIntersections_(e,i){const s=this.m_sweepStructure.getElement(e);this.m_sweepComparator.compare(this.m_sweepStructure,s,i);const n=this.m_sweepComparator.intersectionDetected();return this.m_sweepComparator.clearIntersectionDetectedFlag(),n}getSegment_(e,i){return C1.st_getSegment(this.m_shape,e,i)}static st_getSegment(e,i,s){return e.querySegment(i,s,!1,!1)?s.get():null}dbgPrintSweepEdge(e){}dbgPrintSweepStructure(){}dbgSaveSweepStructure(e=null){}dbgCheckSweepStructure(){}progress_(e=!1){this.m_progressCounter++}crackAWithBMultiPath_(e,i,s){const n=J.constructEmpty();e.queryLooseEnvelope(n);const r=J.constructEmpty();if(i.queryLooseEnvelope(r),r.inflateCoords(s,s),!r.isIntersecting(n))return e;const o=e.getImpl(),a=o.getAccelerators();let l=null,u=null;a&&(u=a.getQuadTree()),X4e(e,DP(i))&&(l=cS(o,r),u=l);const c=u?u.getIteratorForQT():null,h=i.querySegmentIterator(),d=e.querySegmentIterator(),m=st(15,Number.NaN),f=[];for(;h.nextPath();)for(;h.hasNextSegment();){const C=h.nextSegment();if(u){c.resetIterator(C,s);for(let M=c.next();M!==-1;M=c.next()){this.progress_();const A=u.getElement(M);if(d.resetToVertex(A,-1),d.hasNextSegment()){const I=d.nextSegment().intersect(C,null,m,null,s);for(let L=0;L<I;L++){const D=m[L];if(D===0||D===1)continue;const O=Cee(D,d.getStartPointIndex());f.push(O)}}}}else{const M=J.constructEmpty();if(C.queryLooseEnvelope(M),M.inflateCoords(s,s),!n.isIntersecting(M))continue;for(d.resetToFirstPath();d.nextPath();)for(;d.hasNextSegment();){const A=d.nextSegment(),I=J.constructEmpty();if(A.queryLooseEnvelope(I),!I.isIntersecting(M))continue;const L=A.intersect(C,null,m,null,s);for(let D=0;D<L;D++){const O=m[D];if(O===0||O===1)continue;const U=Cee(O,d.getStartPointIndex());f.push(U)}}}}if(f.length===0)return e;f.sort((C,M)=>C.index<M.index?-1:C.index>M.index?1:C.t<M.t?-1:C.t>M.t?1:0);const _=e.createInstance();for(_.getGeometryType()===q.enumPolygon&&_.setFillRule(e.getFillRule()),d.resetToFirstPath();d.nextPath()&&!d.hasNextSegment(););z(d.hasNextSegment());let v=d.nextSegment();const x=new ii;let w=-1;for(let C=0,M=f.length;C<M;){const A=f[C].index;let I=C+1;for(;I<M&&f[I].index===A;)++I;for(;d.getStartPointIndex()<A;){this.progress_();const O=d.hasNextSegment(),U=d.getPathIndex();if((O||!d.isClosingSegment()||d.isCurve())&&(z(v!==null),_.addSegment(v,w!==U)),w=U,!O){for(d.isPathClosed();d.nextPath()&&!d.hasNextSegment(););z(d.hasNextSegment())}v=d.nextSegment()}let L=0;for(let O=C;O<I;O++){const U=f[O].t;if(U===L)continue;z(v!==null),v.queryCut(L,U,x),L=U;const $=d.getPathIndex();_.addSegment(x.get(),w!==$),w=$}const D=d.hasNextSegment();if((D||!d.isClosingSegment()||d.isCurve())&&(z(v!=null),v.queryCut(L,1,x),_.addSegment(x.get(),!1)),D)v=d.nextSegment();else{for(;d.nextPath()&&!d.hasNextSegment(););v=d.hasNextSegment()?d.nextSegment():null}C=I}if(v!==null){const C=d.getPathIndex();(d.hasNextSegment()||!d.isClosingSegment()||d.isCurve())&&_.addSegment(v,w!==C),w=C}let T=d.hasNextSegment();for(;;){if(!T){for(;d.nextPath()&&(T=d.hasNextSegment(),!T););if(!T)break}v=d.nextSegment();const C=d.getPathIndex();T=d.hasNextSegment(),(T||!d.isClosingSegment()||d.isCurve())&&_.addSegment(v,w!==C),w=C}return _}constructor(e){this.m_shape=null,this.m_progressTracker=null,this.m_nonSimpleResult=new Rs,this.m_tolerance=0,this.m_sweepComparator=null,this.m_progressCounter=0,this.m_bTrackChanges=!1,this.m_bNeedsNonSimpleResult=!1,this.m_bAllowCoincident=!0,this.m_sweepStructure=new mr,this.m_progressTracker=e}}function X4e(t,e){const i=t.getPointCount();return i<16?!1:2*i+1*(Math.log(i)/Math.log(2))*e<1*i*e}C1.s_bForceBruteForce=!0;class Rfe{constructor(e,i){this.m_monotoneParts=he(ii,16),this.m_xOrds=st(16,Number.NaN),this.m_inputPoint=N.getNAN(),this.m_miny=0,this.m_maxy=0,this.m_windnum=0,this.m_bAlternate=e,this.m_tolerance=i,this.m_toleranceSqr=i*i,this.m_bTestBorder=!!i,this.m_bBreak=!1}_DoOne(e){if(!this.m_bTestBorder&&(this.m_bAlternate&&this.m_inputPoint.equals(e.getStartXY())||this.m_inputPoint.equals(e.getEndXY())))return void(this.m_bBreak=!0);if(e.getStartY()===this.m_inputPoint.y&&e.getStartY()===e.getEndY()){if(this.m_bAlternate&&!this.m_bTestBorder){const n=Math.min(e.getStartX(),e.getEndX()),r=Math.max(e.getStartX(),e.getEndX());this.m_inputPoint.x>n&&this.m_inputPoint.x<r&&(this.m_bBreak=!0)}return}let i=!1;const s=Math.max(e.getStartX(),e.getEndX());if(this.m_inputPoint.x>s)i=!0;else if(this.m_inputPoint.x>=Math.min(e.getStartX(),e.getEndX())){const n=e.intersectionOfYMonotonicWithAxisX(this.m_inputPoint.y,s);i=!Number.isNaN(n)&&n<=this.m_inputPoint.x}if(i){if(this.m_inputPoint.y===e.getStartY()){if(this.m_inputPoint.y<e.getEndY())return}else if(this.m_inputPoint.y===e.getEndY()&&this.m_inputPoint.y<e.getStartY())return;this.m_bAlternate?this.m_windnum^=1:this.m_windnum+=e.getStartY()>e.getEndY()?1:-1}}_Result(){return!!this.m_windnum}testBorder(e){const i=e.getClosestCoordinate(this.m_inputPoint,!1),s=e.getCoord2D(i);return N.sqrDistance(s,this.m_inputPoint)<=this.m_toleranceSqr}setInputPoint(e){this.m_inputPoint.setCoordsPoint2D(e),this.m_miny=e.y-this.m_tolerance,this.m_maxy=e.y+this.m_tolerance}processSegment(e){const i=e.queryInterval(0,1);if(i.vmin>this.m_maxy||i.vmax<this.m_miny)return!1;if(this.m_bTestBorder&&this.testBorder(e))return!0;if(i.vmin>this.m_inputPoint.y||i.vmax<this.m_inputPoint.y)return!1;let s=0;if(e.isCurve()&&(this.m_monotoneParts.length===0&&(this.m_monotoneParts.length=128),s=e.getMonotonicParts(this.m_monotoneParts,!0),z(this.m_monotoneParts.length>=s)),s>0)for(let n=0;n<s;n++){const r=this.m_monotoneParts[n].get(),o=Me.construct(r.getStartY(),r.getEndY());if(!(o.vmin>this.m_inputPoint.y||o.vmax<this.m_inputPoint.y)&&(this._DoOne(r),this.m_bBreak))return!0}else if(this._DoOne(e),this.m_bBreak)return!0;return!1}result(){return z(0),2}}function W4e(t,e,i,s){const n=new J;t.queryLooseEnvelope(n),n.inflateCoords(s,s);const r=t.getFillRule()===0,o=new Rfe(r,s);o.setInputPoint(i);const a=n.clone();a.xmax=i.x+s,a.ymin=i.y-s,a.ymax=i.y+s;const l=t.getImpl().querySegmentIterator(),u=e.getIterator(a,s);for(let c=u.next();c!==-1;c=u.next())if(l.resetToVertex(e.getElement(c),-1),l.hasNextSegment()){const h=l.nextSegment();if(o.processSegment(h))return-1}return o._Result()?1:0}function Z4e(t,e,i){const s=t.getFillRule()===0,n=new Rfe(s,i);n.setInputPoint(e);const r=t.getImpl().querySegmentIterator();for(;r.nextPath();)for(;r.hasNextSegment();){const o=r.nextSegment();if(n.processSegment(o))return-1}return n._Result()?1:0}function K4e(t,e,i){return e.isEmpty()?0:gL(t,e.getXY(),i)}function gL(t,e,i){if(t.isEmpty())return 0;const s=J.constructEmpty();if(t.queryLooseEnvelope(s),s.inflateCoords(i,i),!s.contains(e))return 0;const n=t.getImpl().getAccelerators();if(n){n.getRasterizedGeometry()&&z(0);const r=n.getQuadTree();if(r)return W4e(t,r,e,i)}return Z4e(t,e,i)}function Sy(t,e){const i=t.getPointCount();return i<16?!1:2*i+1*(Math.log(i)/Math.log(2))*e<1*i*e}function Q4e(t,e,i,s,n){const r=new Ofe(n);return r.m_shape=t,r.m_geometry=e,r.m_sortedVertices=i,r.m_bFixSelfTangency=s,r.fixRingOrientation_()}function J4e(t,e,i){const s=new Ofe(i);return s.m_shape=t,s.m_geometry=e,s.m_sortedVertices=null,s.m_bFixSelfTangency=!1,s.fixRingOrientationForMp2sp_()}class eke{getDirection_(e){return this.m_shape.getNextVertex(this.getEnd1(e))===this.getEnd2(e)}getEnd_(e){const i=this.getEnd1(e),s=this.getEnd2(e);return this.m_shape.getNextVertex(i)===s?s:i}constructor(e){this.m_end1Nodes=[],this.m_end2Nodes=[],this.m_directions=[],this.m_shape=e,this.m_firstFree=-1}getSegment(e){return this.m_shape.getSegment(this.getStart(e))}isBottomUp(e){let i=this.getEnd1(e),s=this.getEnd2(e);this.m_shape.getPrevVertex(i)===s&&(s=Ge(i,i=s));const n=N.getNAN(),r=N.getNAN();return this.m_shape.queryXY(i,n),this.m_shape.queryXY(s,r),z(!n.equals(r)),n.y<r.y}getStart(e){const i=this.getEnd1(e),s=this.getEnd2(e);return this.m_shape.getNextVertex(i)===s?i:s}getEnd1(e){return this.m_end1Nodes[e]}getEnd2(e){return this.m_end2Nodes[e]}freeEdge(e){this.m_end1Nodes[e]=this.m_firstFree,this.m_firstFree=e}newEdge(e){if(this.m_firstFree!==-1){const s=this.m_firstFree;return this.m_firstFree=this.m_end1Nodes[s],this.m_end1Nodes[s]=e,this.m_end2Nodes[s]=this.m_shape.getNextVertex(e),s}const i=this.m_end1Nodes.length;return this.m_end1Nodes.push(e),this.m_end2Nodes.push(this.m_shape.getNextVertex(e)),i}getShape(){return this.m_shape}getPath(e){return this.m_shape.getPathFromVertex(this.getEnd1(e))}}let tke=class extends B1{constructor(t){super(),this.m_line1=new mi,this.m_line2=new mi,this.m_leftElm=-1,this.m_leftx=0,this.m_seg1=null,this.m_helper=t}compare(t,e,i){const s=t.getElement(i),n=this.m_helper.m_edges;let r;this.m_leftElm===e?r=this.m_leftx:(this.m_seg1=n.getSegment(e),this.m_seg1?r=this.m_seg1.intersectionOfYMonotonicWithAxisX(this.m_helper.m_yScanline,0):(n.getShape().queryLineConnector(n.getStart(e),this.m_line1,!0),this.m_seg1=this.m_line1,r=this.m_line1.intersectionOfYMonotonicWithAxisX(this.m_helper.m_yScanline,0)),this.m_leftx=r,this.m_leftElm=e);let o,a=n.getSegment(s);if(a?o=a.intersectionOfYMonotonicWithAxisX(this.m_helper.m_yScanline,0):(n.getShape().queryLineConnector(n.getStart(s),this.m_line2,!0),a=this.m_line2,o=this.m_line2.intersectionOfYMonotonicWithAxisX(this.m_helper.m_yScanline,0)),r===o){const l=n.isBottomUp(e),u=n.isBottomUp(s),c=l?this.m_seg1.getEndY():this.m_seg1.getStartY(),h=u?a.getEndY():a.getStartY(),d=Math.min(c,h);let m=.5*(d+this.m_helper.m_yScanline);m===this.m_helper.m_yScanline&&(m=d),r=this.m_seg1.intersectionOfYMonotonicWithAxisX(m,0),o=a.intersectionOfYMonotonicWithAxisX(m,0),r===o&&dG("")}return r<o?-1:r>o?1:0}reset(){this.m_leftElm=-1}};class Tee{constructor(e){this.m_node=-1,this.m_index=0,this.m_sortedVertices=e.m_sortedVertices,this.m_sortedVerticesArray=e.m_sortedVerticesArray,this.m_sortedVertices&&(this.m_node=this.m_sortedVertices.getFirst(this.m_sortedVertices.getFirstList()))}next(){if(this.m_sortedVertices){const e=this.m_node;if(e===-1)return G;const i=this.m_sortedVertices.getData(e);return this.m_node=this.m_sortedVertices.getNext(e),i}if(this.m_index<this.m_sortedVerticesArray.size()){const e=this.m_sortedVerticesArray.read(this.m_index);return this.m_index++,e}return G}}class Ofe{constructor(e){this.m_edges=null,this.m_shape=null,this.m_AET=new mr,this.m_yScanline=0,this.m_geometry=G,this.m_unknownRingOrientationCount=-1,this.m_sortedVertices=null,this.m_sortedVerticesArray=null,this.m_unknownNodes=[],this.m_node1UserIndex=-1,this.m_node2UserIndex=-1,this.m_pathOrientationIndex=-1,this.m_pathParentageIndex=-1,this.m_pathParentsIndex=-1,this.m_progressCounter=0,this.m_bFixSelfTangency=!1,this.m_progressTracker=e,this.m_AET.disableBalancing(),this.m_sweepComparator=new tke(this),this.m_AET.setComparator(this.m_sweepComparator)}fixRingOrientation_(){const e=this.fixRingOrientationImplMain_();return this.m_pathOrientationIndex===-1||this.fixRingOrientationImplSimplify_(),e}fixRingOrientationForMp2sp_(){return this.fixRingOrientationImplMain_(),this.m_pathOrientationIndex===-1?-1:this.fixRingOrientationImplMp2sp_()}processBunchForRingOrientationTest_(e){return this.processBunchForRingOrientationTestOddEven_(e)}processBunchForRingOrientationTestOddEven_(e){let i=!1;if(this.m_edges||(this.m_edges=new eke(this.m_shape)),this.m_unknownNodes.length=0,this.processBunchForRingOrientationRemoveEdges_(e),!this.m_AET.isAutoBalancing()){let s=0;for(let n=0,r=e.length;n<r;n++)e[n]!==-1&&s++;(s>10||this.m_AET.getMaxDepthEver()>4)&&this.m_AET.enableBalancing()}for(let s=0,n=e.length;s<n;s++){const r=e[s];r!==G&&this.insertEdge_(r,-1)}for(let s=0;s<this.m_unknownNodes.length&&this.m_unknownRingOrientationCount>0;s++){const n=this.m_unknownNodes[s],r=this.m_AET.getElement(n),o=this.m_edges.getPath(r),a=this.m_shape.getPathUserIndex(o,this.m_pathOrientationIndex);let l=G;if(a===0){let u=this.m_AET.getPrev(n),c=n,h=!1;for(;u!==mr.st_nullNode();){const d=this.m_AET.getElement(u),m=this.m_edges.getPath(d);if(this.m_shape.getPathUserIndex(m,this.m_pathOrientationIndex)!==0){l=m;break}c=u,u=this.m_AET.getPrev(u)}if(u===mr.st_nullNode())h=!0,u=c;else{const d=this.m_AET.getElement(u);h=this.m_edges.isBottomUp(d),u=this.m_AET.getNext(u),h=!h}do{const d=this.m_AET.getElement(u),m=this.m_edges.getPath(d);if(this.m_shape.getPathUserIndex(m,this.m_pathOrientationIndex)===0){if(h!==this.m_edges.isBottomUp(d)){const f=this.m_shape.getFirstVertex(m);this.m_shape.reverseRingInternal(f),this.m_shape.setLastVertex(m,this.m_shape.getPrevVertex(f)),i=!0}if(this.m_shape.setPathUserIndex(m,this.m_pathOrientationIndex,h?3:2),!h){let f=this.m_shape.getPathUserIndex(l,this.m_pathOrientationIndex);f===2&&(l=this.m_shape.getPathUserIndex(l,this.m_pathParentsIndex),f=this.m_shape.getPathUserIndex(l,this.m_pathOrientationIndex)),z(f===3);const _=this.m_shape.getPathUserIndex(l,this.m_pathParentageIndex);this.m_shape.setPathUserIndex(l,this.m_pathParentageIndex,m),this.m_shape.setPathUserIndex(m,this.m_pathParentageIndex,_),this.m_shape.setPathUserIndex(m,this.m_pathParentsIndex,l)}if(this.m_unknownRingOrientationCount--,!this.m_unknownRingOrientationCount)return i}l=m,c=u,u=this.m_AET.getNext(u),h=!h}while(c!==n)}}return i}processBunchForRingOrientationRemoveEdges_(e){for(let i=0,s=e.length;i<s;i++){const n=e[i],r=this.m_shape.getUserIndex(n,this.m_node1UserIndex),o=this.m_shape.getUserIndex(n,this.m_node2UserIndex);if(r!==-1){const l=this.m_AET.getElement(r);this.m_edges.freeEdge(l),this.m_shape.setUserIndex(n,this.m_node1UserIndex,-1)}if(o!==-1){const l=this.m_AET.getElement(o);this.m_edges.freeEdge(l),this.m_shape.setUserIndex(n,this.m_node2UserIndex,-1)}let a=-1;r!==-1&&o!==-1?(this.m_AET.deleteNode(r),this.m_AET.deleteNode(o),e[i]=G):a=r!==-1?r:o,a!==-1&&(this.insertEdge_(n,a)||this.m_AET.deleteNode(a),e[i]=G)}}dbgVerifyRingOrientation_(){}insertEdge_(e,i){const s=N.getNAN(),n=N.getNAN();this.m_shape.queryXY(e,s);const r=this.m_shape.getNextVertex(e);this.m_shape.queryXY(r,n);let o=!1;if(s.y<n.y){o=!0;const l=this.m_edges.newEdge(e);let u;i===-1?u=this.m_AET.addElement(l):(u=i,this.m_AET.setElement(u,l)),this.m_shape.getUserIndex(r,this.m_node1UserIndex)===-1?this.m_shape.setUserIndex(r,this.m_node1UserIndex,u):this.m_shape.setUserIndex(r,this.m_node2UserIndex,u);const c=this.m_shape.getPathFromVertex(e);this.m_shape.getPathUserIndex(c,this.m_pathOrientationIndex)===0&&this.m_unknownNodes.push(u)}const a=this.m_shape.getPrevVertex(e);if(this.m_shape.queryXY(a,n),s.y<n.y){o=!0;const l=this.m_edges.newEdge(a);let u;i===-1?u=this.m_AET.addElement(l):(u=i,this.m_AET.setElement(u,l)),this.m_shape.getUserIndex(a,this.m_node1UserIndex)===-1?this.m_shape.setUserIndex(a,this.m_node1UserIndex,u):this.m_shape.setUserIndex(a,this.m_node2UserIndex,u);const c=this.m_shape.getPathFromVertex(e);this.m_shape.getPathUserIndex(c,this.m_pathOrientationIndex)===0&&this.m_unknownNodes.push(u)}return o}fixRingSelfTangency_(){const e=[],i=[];let s=-1,n=-1;const r=new N;let o=G,a=G,l=-1;const u=new Tee(this);for(let c=u.next();c!==G;c=u.next()){const h=new N;this.m_shape.queryXY(c,h);const d=this.m_shape.getPathFromVertex(c);r.equals(h)&&a===d?(n===-1&&(s=this.m_shape.createPathUserIndex(),this.m_shape.fillPathUserIndexForGeometry(this.m_geometry,s,-1),n=this.m_shape.createUserIndex(),this.m_shape.fillUserIndexForGeometry(this.m_geometry,n,-1)),l===-1&&(l=i.length,this.m_shape.setUserIndex(o,n,l),i.push(1),this.m_shape.getPathUserIndex(d,s)===-1&&(this.m_shape.setPathUserIndex(d,s,o),e.push(d))),this.m_shape.setUserIndex(c,n,l),i[i.length-1]++):(l=-1,r.assign(h)),o=c,a=d}if(e.length===0)return!1;z(s!==-1);for(let c=0,h=e.length;c<h;c++){const d=e[c];let m=this.m_shape.getPathUserIndex(d,s);const f=this.m_shape.getUserIndex(m,n),_=[],v=[];_.push(m),v.push(f);for(let x=this.m_shape.getNextVertex(m);x!==m;x=this.m_shape.getNextVertex(x)){const w=x,T=this.m_shape.getUserIndex(w,n);if(T!==-1){if(v.length===0){v.push(T),_.push(w);continue}if(v.at(-1)===T){const C=_.at(-1);this.m_shape.peelALoopIntoAPath(C,w),this.m_shape.setUserIndex(x,n,-1),i[T]--,i[T]===1&&(i[T]=0,v.pop(),_.pop()),m=C,x=C}else _.push(x),v.push(T)}}}return this.m_shape.removePathUserIndex(s),this.m_shape.removeUserIndex(n),this.m_shape.dbgVerifyVertexCounts(),!0}progress_(e=!1){}fixRingOrientationImplMain_(){const e={stack:[],error:void 0,hasError:!1};try{let i,s=!1;const n=Da(e,Jme(()=>{this.m_sortedVerticesArray=null}),!1);if(this.m_sortedVertices===null){const l=this.m_shape.getPointCount(this.m_geometry);i=new Un(0);for(let u=this.m_shape.getFirstPath(this.m_geometry);u!==G;u=this.m_shape.getNextPath(u)){let c=this.m_shape.getFirstVertex(u);for(let h=0,d=this.m_shape.getPathSize(u);h<d;h++)i.add(c),c=this.m_shape.getNextVertex(c)}this.m_shape.sortVerticesSimpleByY(i,0,l),this.progress_(!0),this.m_sortedVerticesArray=i}else n.bForget=!0;if(this.m_bFixSelfTangency&&(s=this.fixRingSelfTangency_()),this.m_shape.getPathCount(this.m_geometry)===1){const l=this.m_shape.getFirstPath(this.m_geometry),u=this.m_shape.getRingArea(l);if(this.m_shape.setExterior(l,!0),u<0){const c=this.m_shape.getFirstVertex(l);return this.m_shape.reverseRingInternal(c),this.m_shape.setLastVertex(l,this.m_shape.getPrevVertex(c)),!0}return!1}this.m_shape.dbgVerifyCurves(),this.m_pathOrientationIndex=this.m_shape.createPathUserIndex(),this.m_pathParentageIndex=this.m_shape.createPathUserIndex(),this.m_pathParentsIndex=this.m_shape.createPathUserIndex();for(let l=this.m_shape.getFirstPath(this.m_geometry);l!==G;l=this.m_shape.getNextPath(l))this.m_shape.setPathUserIndex(l,this.m_pathOrientationIndex,0),this.m_shape.setPathUserIndex(l,this.m_pathParentageIndex,-1),this.m_shape.setPathUserIndex(l,this.m_pathParentsIndex,-1);const r=[];this.m_yScanline=Number.NaN;const o=N.getNAN();this.m_unknownRingOrientationCount=this.m_shape.getPathCount(this.m_geometry),this.m_node1UserIndex=this.m_shape.createUserIndexUninitialized(),this.m_shape.fillUserIndexForGeometry(this.m_geometry,this.m_node1UserIndex,-1),this.m_node2UserIndex=this.m_shape.createUserIndexUninitialized(),this.m_shape.fillUserIndexForGeometry(this.m_geometry,this.m_node2UserIndex,-1);const a=new Tee(this);for(let l=a.next();l!==G&&(this.progress_(),this.m_shape.queryXY(l,o),o.y!==this.m_yScanline&&r.length&&(s=this.processBunchForRingOrientationTest_(r)||s,this.m_sweepComparator.reset(),r.length=0),r.push(l),this.m_yScanline=o.y,this.m_unknownRingOrientationCount!==0);l=a.next());return this.m_unknownRingOrientationCount>0&&(s=this.processBunchForRingOrientationTest_(r)||s,r.length=0),this.m_shape.removeUserIndex(this.m_node1UserIndex),this.m_shape.removeUserIndex(this.m_node2UserIndex),this.dbgVerifyRingOrientation_(),s}catch(i){e.error=i,e.hasError=!0}finally{Hf(e)}}fixRingOrientationImplSimplify_(){const e=[];for(let i=this.m_shape.getFirstPath(this.m_geometry);i!==G;)if(this.progress_(),this.m_shape.getPathUserIndex(i,this.m_pathOrientationIndex)===3){this.m_shape.setExterior(i,!0);for(let r=this.m_shape.getPathUserIndex(i,this.m_pathParentageIndex);r!==G;){const o=this.m_shape.getPathUserIndex(r,this.m_pathParentageIndex);e.push(r),this.m_shape.setExterior(r,!1),this.m_shape.setPathUserIndex(r,this.m_pathParentageIndex,i),r=o}let s=i,n=e.length;for(let r=this.m_shape.getNextPath(i);n>0&&r!==G;r=this.m_shape.getNextPath(r),--n){if(this.m_shape.getPathUserIndex(r,this.m_pathParentageIndex)!==i){s=G;break}s=r}if(n!==0){s=i;for(let r=0,o=e.length;r<o;r++){const a=e[r];this.m_shape.setPathUserIndex(a,this.m_pathParentageIndex,uw),this.m_shape.movePath(this.m_geometry,this.m_shape.getNextPath(s),a),s=a}}e.length=0,i=this.m_shape.getNextPath(s)}else i=this.m_shape.getNextPath(i);this.m_shape.removePathUserIndex(this.m_pathOrientationIndex),this.m_shape.removePathUserIndex(this.m_pathParentageIndex),this.m_shape.removePathUserIndex(this.m_pathParentsIndex)}fixRingOrientationImplMp2sp_(){const e=this.m_shape.createPathUserIndex();let i=0;const s=[];for(let n=this.m_shape.getFirstPath(this.m_geometry);n!==G;)if(this.progress_(),this.m_shape.getPathUserIndex(n,this.m_pathOrientationIndex)===3){this.m_shape.setExterior(n,!0),this.m_shape.setPathUserIndex(n,e,i),i++;for(let l=this.m_shape.getPathUserIndex(n,this.m_pathParentageIndex);l!==G;){const u=this.m_shape.getPathUserIndex(l,this.m_pathParentageIndex);s.push(l),this.m_shape.setExterior(l,!1),this.m_shape.setPathUserIndex(l,this.m_pathParentageIndex,n),l=u}let r=n,o=s.length,a=i;for(let l=this.m_shape.getNextPath(n);o>0&&l!==G;l=this.m_shape.getNextPath(l),--o){if(this.m_shape.getPathUserIndex(l,this.m_pathParentageIndex)!==n){r=G;break}r=l,this.m_shape.setPathUserIndex(l,e,-a),a++}if(o!==0){r=n,a=i;for(let l=0,u=s.length;l<u;l++){const c=s[l];this.m_shape.setPathUserIndex(c,e,-a),a++,this.m_shape.setPathUserIndex(c,this.m_pathParentageIndex,uw)}r=n}i=a,s.length=0,n=this.m_shape.getNextPath(r)}else n=this.m_shape.getNextPath(n);return this.m_shape.removePathUserIndex(this.m_pathOrientationIndex),this.m_shape.removePathUserIndex(this.m_pathParentageIndex),this.m_shape.removePathUserIndex(this.m_pathParentsIndex),e}}function bf(t,e,i,s,n,r){const o=new ike(r);return o.m_shape=t,o.m_geometry=e,o.m_knownSimpleResult=i,o.m_bFixSelfTangency=s,o.m_polylineDegeneracies=n,o.m_bHasSegmentParentage=t.hasSegmentParentage(),o.m_bHasSegments=t.hasCurves(),o.simplify_()}class ike{constructor(e){this.m_shape=null,this.m_geometry=G,this.m_sortedVertices=new gf,this.m_bunchEdgeEndPoints=[],this.m_bunchEdgeCenterPoints=[],this.m_bunchEdgeIndices=[],this.m_knownSimpleResult=-1,this.m_sortedVerticesListIndex=-1,this.m_polylineDegeneracies=G,this.m_userIndexSortedIndexToVertex=-1,this.m_userIndexSortedAngleIndexToVertex=-1,this.m_nextVertexToProcess=-1,this.m_firstCoincidentVertex=-1,this.m_progressCounter=0,this.m_bFixSelfTangency=!1,this.m_bHasSegmentParentage=!1,this.m_bHasSegments=!1,this.m_progressTracker=e}compareAngles_(e,i){if(this.m_bHasSegments)return this.compareAnglesCurves_(e,i);const s=this.m_bunchEdgeEndPoints[e],n=new N;this.m_shape.queryXY(s,n);const r=new N,o=this.m_bunchEdgeEndPoints[i];if(this.m_shape.queryXY(o,r),n.equals(r))return 0;const a=this.m_bunchEdgeCenterPoints[e],l=new N;this.m_shape.queryXY(a,l);const u=this.m_bunchEdgeCenterPoints[i],c=new N;this.m_shape.queryXY(u,c);const h=new N;h.setSub(n,l);const d=new N;return d.setSub(r,c),(h.isZero()||d.isZero())&&dG(""),N.compareVectors(h,d)}compareAnglesCurves_(e,i){const s=this.m_bunchEdgeEndPoints[e],n=this.m_bunchEdgeEndPoints[i],r=this.m_bunchEdgeCenterPoints[e],o=this.m_bunchEdgeCenterPoints[i],a=this.m_shape.getNextVertex(r)===s,l=this.m_shape.getNextVertex(o)===n,u=new ii,c=new N;a?(this.m_shape.querySegment(r,u,!1,!0),c.assign(u.get().getTangent(0))):(this.m_shape.querySegment(s,u,!1,!0),c.assign(u.get().getTangent(1)),c.negateThis());const h=new N;return l?(this.m_shape.querySegment(o,u,!1,!0),h.assign(u.get().getTangent(0))):(this.m_shape.querySegment(n,u,!1,!0),h.assign(u.get().getTangent(1)),h.negateThis()),(c.isZero()||h.isZero())&&dG(""),N.compareVectors(c,h)}beforeRemoveVertex_(e,i){const s=this.m_shape.getUserIndex(e,this.m_userIndexSortedIndexToVertex);if(this.m_nextVertexToProcess===s&&(this.m_nextVertexToProcess=this.m_sortedVertices.getNext(this.m_nextVertexToProcess)),this.m_firstCoincidentVertex===s&&(this.m_firstCoincidentVertex=this.m_sortedVertices.getNext(this.m_firstCoincidentVertex)),this.m_sortedVertices.deleteElement(this.m_sortedVerticesListIndex,s),this.removeAngleSortInfo_(e),i){const n=this.m_shape.getPathFromVertex(e);if(n!==G&&this.m_shape.getFirstVertex(n)===e){const r=this.m_shape.getNextVertex(e);if(r!==e){if(this.m_shape.getPathFromVertex(r)===n)return void this.m_shape.setFirstVertex(n,r);{const o=this.m_shape.getPrevVertex(e);if(o!==e&&this.m_shape.getPathFromVertex(o)===n)return void this.m_shape.setFirstVertex(n,o)}}this.m_shape.setFirstVertex(n,G),this.m_shape.setLastVertex(n,G)}}}processBunch_(){let e=!1;const i=new N(0,0);for(;;){this.m_bunchEdgeEndPoints.length=0,this.m_bunchEdgeCenterPoints.length=0,this.m_bunchEdgeIndices.length=0;let s=this.m_firstCoincidentVertex,n=0,r=!0;for(;s!==this.m_nextVertexToProcess;){const a=this.m_sortedVertices.getData(s);r&&(this.m_shape.queryXY(a,i),r=!1);const l=this.m_shape.getPrevVertex(a),u=this.m_shape.getNextVertex(a);this.m_shape.getUserIndex(l,this.m_userIndexSortedAngleIndexToVertex)!==uw&&(this.m_bunchEdgeEndPoints.push(l),this.m_shape.setUserIndex(l,this.m_userIndexSortedAngleIndexToVertex,uw),this.m_bunchEdgeCenterPoints.push(a),this.m_bunchEdgeIndices.push(n++)),this.m_shape.getUserIndex(u,this.m_userIndexSortedAngleIndexToVertex)!==uw&&(this.m_bunchEdgeEndPoints.push(u),this.m_shape.setUserIndex(u,this.m_userIndexSortedAngleIndexToVertex,uw),this.m_bunchEdgeCenterPoints.push(a),this.m_bunchEdgeIndices.push(n++)),s=this.m_sortedVertices.getNext(s)}if(this.m_bunchEdgeEndPoints.length<2){this.m_bunchEdgeEndPoints.length===1&&this.m_shape.setUserIndex(this.m_bunchEdgeEndPoints[0],this.m_userIndexSortedAngleIndexToVertex,-1);break}this.m_bunchEdgeIndices.sort((a,l)=>this.compareAngles_(a,l));for(let a=0,l=this.m_bunchEdgeIndices.length;a<l;a++){const u=this.m_bunchEdgeIndices[a],c=this.m_bunchEdgeEndPoints[u];this.m_shape.setUserIndex(c,this.m_userIndexSortedAngleIndexToVertex,a)}const o=this.processCrossOvers_(i);for(let a=0,l=this.m_bunchEdgeIndices.length;a<l;a++){const u=this.m_bunchEdgeIndices[a];if(u===-1)continue;const c=this.m_bunchEdgeEndPoints[u];this.m_shape.setUserIndex(c,this.m_userIndexSortedAngleIndexToVertex,-1)}if(!o)break;e=!0}return e}processCrossOvers_(e){let i=!1,s=!0;for(;s;){s=!1;let n=0;this.m_bunchEdgeIndices[n]===-1&&(n=this.getNextEdgeIndex_(n));let r=this.getNextEdgeIndex_(n);for(let o=0,a=this.m_bunchEdgeIndices.length;o<a&&n!==-1&&r!==-1&&n!==r;o++){const l=this.m_bunchEdgeIndices[n],u=this.m_bunchEdgeIndices[r],c=this.m_bunchEdgeEndPoints[l],h=this.m_bunchEdgeEndPoints[u];let d=this.m_shape.getNextVertex(c),m=!1;this.m_shape.isEqualXYPoint2D(d,e)||(d=this.m_shape.getPrevVertex(c),m=!0);let f=this.m_shape.getNextVertex(h),_=!1;this.m_shape.isEqualXYPoint2D(f,e)||(f=this.m_shape.getPrevVertex(h),_=!0);const v=m?this.m_shape.getPrevVertex(d):this.m_shape.getNextVertex(d),x=_?this.m_shape.getPrevVertex(f):this.m_shape.getNextVertex(f);let w=!1;(this.removeSpike_(d)||this.removeSpike_(f)||this.removeSpike_(c)||this.removeSpike_(h)||this.removeSpike_(v)||this.removeSpike_(x))&&(w=!0),d!==f&&(!w&&this.m_shape.isEqualXY(c,h)&&(w=this.resolveOverlap_(m,_,d,c,f,h)),!w&&this.m_shape.isEqualXY(v,x)&&(w=this.resolveOverlap_(!m,!_,d,v,f,x)),!w&&this.m_shape.isEqualXY(c,x)&&(w=this.resolveOverlap_(m,!_,d,c,f,x)),!w&&this.m_shape.isEqualXY(v,h)&&(w=this.resolveOverlap_(!m,_,d,v,f,h))),w&&(i=!0),s||(s=w),n=w?this.getNextEdgeIndex_(n):r,r=this.getNextEdgeIndex_(n)}}if(!i){let n=0;this.m_bunchEdgeIndices[n]===-1&&(n=this.getNextEdgeIndex_(n));let r=this.getNextEdgeIndex_(n);for(let o=0,a=this.m_bunchEdgeIndices.length;o<a&&n!==-1&&r!==-1&&n!==r;o++){const l=this.m_bunchEdgeIndices[n],u=this.m_bunchEdgeIndices[r],c=this.m_bunchEdgeEndPoints[l],h=this.m_bunchEdgeEndPoints[u];let d=this.m_shape.getNextVertex(c);this.m_shape.isEqualXYPoint2D(d,e)||(d=this.m_shape.getPrevVertex(c));let m=this.m_shape.getNextVertex(h);this.m_shape.isEqualXYPoint2D(m,e)||(m=this.m_shape.getPrevVertex(h));const f=this.getDirection_(d,c),_=this.getDirection_(m,h),v=f?this.m_shape.getPrevVertex(d):this.m_shape.getNextVertex(d),x=_?this.m_shape.getPrevVertex(m):this.m_shape.getNextVertex(m),w=this.detectAndResolveCrossOver_(f,_,c,d,v,h,m,x);w!==1?w===0?(n=this.getNextEdgeIndex_(n),r=this.getNextEdgeIndex_(n)):(n=this.getPrevEdgeIndex_(n),r=this.getNextEdgeIndex_(n)):i=!0}}return i}simplify_(){this.m_shape.getGeometryType(this.m_geometry)===q.enumPolygon&&this.m_shape.getFillRule(this.m_geometry)===1&&new Vl(this.m_progressTracker).planarSimplifyNoCrackingAndCluster(this.m_bFixSelfTangency,this.m_shape,this.m_geometry,0);let e=!1;this.m_userIndexSortedIndexToVertex=-1,this.m_userIndexSortedAngleIndexToVertex=-1,this.m_userIndexSortedAngleIndexToVertex=this.m_shape.createUserIndexUninitialized();const i=this.m_shape.getPointCount(this.m_geometry),s=new Un(0);this.m_shape.dbgVerifyMonotone();for(let o=this.m_shape.getFirstPath(this.m_geometry);o!==G;o=this.m_shape.getNextPath(o)){let a=this.m_shape.getFirstVertex(o);for(let l=0,u=this.m_shape.getPathSize(o);l<u;l++)this.m_shape.setUserIndex(a,this.m_userIndexSortedAngleIndexToVertex,-1),s.add(a),a=this.m_shape.getNextVertex(a)}this.m_shape.sortVerticesSimpleByY(s,0,i),this.progress_(!0),this.m_userIndexSortedIndexToVertex=this.m_shape.createUserIndexUninitialized(),this.m_sortedVertices.reserveNodes(i),this.m_sortedVerticesListIndex=this.m_sortedVertices.createList(0);for(let o=0;o<i;o++){const a=s.read(o),l=this.m_sortedVertices.addElement(this.m_sortedVerticesListIndex,a);this.m_shape.setUserIndex(a,this.m_userIndexSortedIndexToVertex,l)}this.m_nextVertexToProcess=-1,this.cleanupSpikes_()&&(e=!0);let n=0,r=!1;do{r=!1,this.m_nextVertexToProcess=-1,this.m_firstCoincidentVertex=this.m_sortedVertices.getFirst(this.m_sortedVerticesListIndex);const o=new N(0,0);this.m_firstCoincidentVertex!==gf.st_nullNode()&&this.m_shape.queryXY(this.m_sortedVertices.getData(this.m_firstCoincidentVertex),o);let a=0,l=this.m_firstCoincidentVertex;for(;l!==gf.st_nullNode()&&(l=this.m_sortedVertices.getNext(l),l!==gf.st_nullNode());){this.progress_();const u=this.m_sortedVertices.getData(l),c=N.getNAN();if(this.m_shape.queryXY(u,c),o.equals(c))a++;else{if(a>0){this.m_nextVertexToProcess=l;const h=this.processBunch_();l=this.m_nextVertexToProcess,l!==gf.st_nullNode()&&this.m_shape.queryXY(this.m_sortedVertices.getData(l),c),h&&(r=!0)}o.setCoordsPoint2D(c),this.m_firstCoincidentVertex=l,a=0}}this.m_nextVertexToProcess=-1,a>0&&this.processBunch_()&&(r=!0),n++>10&&We(""),r&&this.fixOrphanVertices_(),this.cleanupSpikes_()&&(r=!0),e||(e=r)}while(r);return this.m_shape.dbgVerifyMonotone(),this.m_shape.dbgVerifyCurves(),this.m_shape.removeUserIndex(this.m_userIndexSortedIndexToVertex),this.m_shape.removeUserIndex(this.m_userIndexSortedAngleIndexToVertex),e=Q4e(this.m_shape,this.m_geometry,this.m_sortedVertices,this.m_bFixSelfTangency,this.m_progressTracker)||e,this.m_shape.dbgVerifyCurves(),e}getDirection_(e,i){return this.m_shape.getNextVertex(i)!==e}detectAndResolveCrossOver_(e,i,s,n,r,o,a,l){if(n===a)return this.removeAngleSortInfo_(s),this.removeAngleSortInfo_(o),-1;const u=this.m_shape.getUserIndex(s,this.m_userIndexSortedAngleIndexToVertex),c=this.m_shape.getUserIndex(r,this.m_userIndexSortedAngleIndexToVertex),h=this.m_shape.getUserIndex(o,this.m_userIndexSortedAngleIndexToVertex),d=this.m_shape.getUserIndex(l,this.m_userIndexSortedAngleIndexToVertex),m=st(8,Number.NaN),f=st(4,Number.NaN);m[0]=0,f[0]=u,m[1]=0,f[1]=c,m[2]=1,f[2]=h,m[3]=1,f[3]=d;for(let v=1;v<4;v++){const x=f[v],w=m[v];let T=v-1;for(;T>=0&&f[T]>x;)f[T+1]=f[T],m[T+1]=m[T],T--;f[T+1]=x,m[T+1]=w}let _=0;if(m[0]&&(_|=1),m[1]&&(_|=2),m[2]&&(_|=4),m[3]&&(_|=8),_!==5&&_!==10)return 0;if(e!==i&&(l=Ge(o,o=l)),e)this.m_shape.setNextVertex(l,n),this.m_shape.setPrevVertex(n,l),this.m_shape.setNextVertex(r,a),this.m_shape.setPrevVertex(a,r),this.m_bHasSegmentParentage&&(this.m_shape.setSegmentParentageBreakVertex(n,!0),this.m_shape.setSegmentParentageBreakVertex(a,!0));else{if(this.m_shape.setPrevVertex(l,n),this.m_shape.setNextVertex(n,l),this.m_shape.setPrevVertex(r,a),this.m_shape.setNextVertex(a,r),this.m_bHasSegmentParentage){const v=this.m_shape.getSegmentParentage(n),x=this.m_shape.getSegmentParentage(a);this.m_shape.setSegmentParentageAndBreak(n,x,!0),this.m_shape.setSegmentParentageAndBreak(a,v,!0)}if(this.m_bHasSegments){const v=this.m_shape.getVertexIndex(n),x=this.m_shape.getVertexIndex(a),w=this.m_shape.getSegmentFromIndex(v);this.m_shape.setSegmentToIndex(v,null);const T=this.m_shape.getSegmentFromIndex(x);this.m_shape.setSegmentToIndex(x,null),this.m_shape.setSegmentToIndex(v,T),this.m_shape.setSegmentToIndex(x,w)}}return 1}resolveOverlap_(e,i,s,n,r,o){return this.resolveOverlapOddEven_(e,i,s,n,r,o)}resolveOverlapOddEven_(e,i,s,n,r,o){if(e!==i){e||(r=Ge(s,s=r),o=Ge(n,n=o));const a=this.m_shape.getNextVertex(r),l=this.m_shape.getNextVertex(s);if(this.m_shape.setNextVertex(s,a),this.m_shape.setPrevVertex(a,s),this.m_shape.setNextVertex(r,l),this.m_shape.setPrevVertex(l,r),this.m_bHasSegments){const u=this.m_shape.getVertexIndex(s),c=this.m_shape.getVertexIndex(r),h=this.m_shape.getSegmentFromIndex(u);this.m_shape.setSegmentToIndex(u,null);const d=this.m_shape.getSegmentFromIndex(c);this.m_shape.setSegmentToIndex(c,null),this.m_shape.setSegmentToIndex(u,d),this.m_shape.setSegmentToIndex(c,h)}if(this.m_bHasSegmentParentage){const u=this.m_shape.getSegmentParentage(s),c=this.m_shape.getSegmentParentage(r);this.m_shape.setSegmentParentageAndBreak(s,c,!0),this.m_shape.setSegmentParentageAndBreak(r,u,!0),this.m_shape.setSegmentParentageBreakVertex(n,!0),this.m_shape.setSegmentParentageBreakVertex(o,!0)}this.removeSpike_(r)}else{const a=e?s:n,l=i?r:o,u=e?n:s,c=i?o:r;let h=null;if(this.m_bHasSegments){const w=this.m_shape.getVertexIndex(c);h=this.m_shape.getSegmentFromIndex(w),this.m_shape.setSegmentToIndex(w,null);const T=this.m_shape.getVertexIndex(l);this.m_shape.setSegmentToIndex(T,null);const C=this.m_shape.getVertexIndex(a);this.m_shape.setSegmentToIndex(C,null)}let d=-1;this.m_bHasSegmentParentage&&(d=this.m_shape.getSegmentParentage(c));let m=!1;this.m_shape.setNextVertex(a,l),this.m_shape.setNextVertex(l,a),this.m_shape.setPrevVertex(u,c),this.m_shape.setPrevVertex(c,u);let f=c;for(;f!==l;){const w=this.m_shape.getPrevVertex(f),T=this.m_shape.getNextVertex(f);if(this.m_shape.setPrevVertex(f,T),this.m_shape.setNextVertex(f,w),m||(m=f===a),this.m_bHasSegments&&f!==a){const C=this.m_shape.getVertexIndex(T),M=h;h=this.m_shape.getSegmentFromIndex(C),M!==null&&M.reverse(),this.m_shape.setSegmentToIndex(C,M)}if(this.m_bHasSegmentParentage){const C=this.m_shape.getSegmentParentage(T);this.m_shape.setSegmentParentagePreserveBreak(T,d),d=C}f=T}let _=null;if(!m){const w=this.m_shape.getPrevVertex(l),T=this.m_shape.getNextVertex(l);if(this.m_shape.setPrevVertex(l,T),this.m_shape.setNextVertex(l,w),this.m_bHasSegments){const C=this.m_shape.getVertexIndex(l);_=this.m_shape.getSegmentFromIndex(C),this.m_shape.setSegmentToIndex(C,null)}}let v=-1,x=-1;if(this.m_bHasSegmentParentage&&(v=m?this.m_shape.getSegmentParentage(a):this.m_shape.getSegmentParentage(l),x=this.m_shape.getSegmentParentage(u)),this.transferVertexData_(l,a),this.beforeRemoveVertex_(l,!0),this.m_shape.removeVertexInternal(l,!0),this.removeAngleSortInfo_(a),this.transferVertexData_(c,u),this.beforeRemoveVertex_(c,!0),this.m_shape.removeVertexInternal(c,!0),this.removeAngleSortInfo_(u),this.m_bHasSegmentParentage&&(this.m_shape.setSegmentParentageAndBreak(a,v,!0),this.m_shape.setSegmentParentageAndBreak(u,x,!0)),_){const w=this.m_shape.getVertexIndex(a);this.m_shape.setSegmentToIndex(w,_)}}return!0}cleanupSpikes_(){let e=!1;for(let i=this.m_shape.getFirstPath(this.m_geometry);i!==G;){const s=this.m_shape.getNextPath(i);let n=this.m_shape.getFirstVertex(i);for(let r=0,o=this.m_shape.getPathSize(i);r<o&&o>1;){this.progress_();const{v:a,bModified:l}=this.checkAndCleanupSpike_(i,n);if(a===G)break;l?(e=!0,n=a,r=0,o=this.m_shape.getPathSize(i)):(n=a,r++)}i=s}return e}checkAndCleanupSpike_(e,i){const s={v:G,bModified:!1};let n=this.m_shape.getPrevVertex(i),r=this.m_shape.getNextVertex(i),o=G,a=G;for(;this.m_shape.isEqualXY(n,r)&&(o=n,a=r,r!==i);)n=this.m_shape.getPrevVertex(n),r=this.m_shape.getNextVertex(r);if(o===G)return s.v=r,s;s.bModified=!0;for(let l=this.m_shape.getNextVertex(o);this.beforeRemoveVertex_(l,!1),l!==a;l=this.m_shape.getNextVertex(l));if(o===i)return this.m_polylineDegeneracies!==G?this.m_shape.movePath(this.m_polylineDegeneracies,G,e):this.m_shape.removePath(e),s.v=G,s;{const l=this.m_shape.peelALoopIntoAPath(o,a);this.m_polylineDegeneracies!==G?this.m_shape.movePath(this.m_polylineDegeneracies,G,l):this.m_shape.removePath(l)}return s.v=o,s}removeSpike_(e){let i=this.m_shape.getPrevVertex(e),s=this.m_shape.getNextVertex(e),n=G,r=G;for(;this.m_shape.isEqualXY(i,s)&&(n=i,r=s,s!==e);)i=this.m_shape.getPrevVertex(i),s=this.m_shape.getNextVertex(s);if(n===G)return!1;if(this.m_shape.peelALoop(n,r),this.m_bHasSegmentParentage&&(this.m_shape.setSegmentParentageBreakVertex(n,!0),this.m_shape.setSegmentParentageBreakVertex(r,!0)),this.removeAngleSortInfo_(n),this.m_polylineDegeneracies===G)for(let o=this.m_shape.getNextVertex(r);;){const a=this.m_shape.getNextVertex(o);if(this.removeAngleSortInfo_(o),this.beforeRemoveVertex_(o,!0),this.m_shape.setSegmentToIndex(this.m_shape.getVertexIndex(o),null),this.m_shape.removeVertexInternal(o,!1),o===r)break;o=a}else{for(let a=r;;){const l=this.m_shape.getNextVertex(a);if(this.removeAngleSortInfo_(a),this.beforeRemoveVertex_(a,!1),a=l,a===r)break}const o=[!1];this.m_shape.insertClosedPath(this.m_polylineDegeneracies,G,r,r,o)}return!0}fixOrphanVertices_(){let e=0;for(let n=this.m_sortedVertices.getFirst(this.m_sortedVertices.getFirstList());n!==-1;n=this.m_sortedVertices.getNext(n)){const r=this.m_sortedVertices.getData(n);this.m_shape.setPathToVertex(r,G)}let i=0;for(let n=this.m_shape.getFirstPath(this.m_geometry);n!==G;){const r=this.m_shape.getFirstVertex(n);if(r===G||this.m_shape.getPathFromVertex(r)!==G){const a=n;n=this.m_shape.getNextPath(n),this.m_shape.removePathOnly(a);continue}this.m_shape.setPathToVertex(r,n);let o=1;for(let a=this.m_shape.getNextVertex(r);a!==r;a=this.m_shape.getNextVertex(a))this.m_shape.setPathToVertex(a,n),o++;this.m_shape.setRingAreaValid(n,!1),this.m_shape.setPathSize(n,o),this.m_shape.setLastVertex(n,this.m_shape.getPrevVertex(r)),i+=o,e++,n=this.m_shape.getNextPath(n)}for(let n=this.m_sortedVertices.getFirst(this.m_sortedVertices.getFirstList());n!==-1;n=this.m_sortedVertices.getNext(n)){const r=this.m_sortedVertices.getData(n);if(this.m_shape.getPathFromVertex(r)!==G)continue;const o=[!1],a=this.m_shape.insertClosedPath(this.m_geometry,G,r,r,o);i+=this.m_shape.getPathSize(a),e++}this.m_shape.setGeometryPathCount(this.m_geometry,e),this.m_shape.setGeometryVertexCount(this.m_geometry,i);let s=0;for(let n=this.m_shape.getFirstGeometry();n!==G;n=this.m_shape.getNextGeometry(n))s+=this.m_shape.getPointCount(n);this.m_shape.setTotalPointCount(s)}getNextEdgeIndex_(e){if(e===-1)return-1;for(let i=0,s=this.m_bunchEdgeIndices.length-1;i<s;i++)if(e=(e+1)%this.m_bunchEdgeIndices.length,this.m_bunchEdgeIndices[e]!==-1)return e;return-1}getPrevEdgeIndex_(e){if(e===-1)return-1;for(let i=0,s=this.m_bunchEdgeIndices.length-1;i<s;i++)if(e=(this.m_bunchEdgeIndices.length+e-1)%this.m_bunchEdgeIndices.length,this.m_bunchEdgeIndices[e]!==-1)return e;return-1}transferVertexData_(e,i){const s=this.m_shape.getUserIndex(i,this.m_userIndexSortedIndexToVertex),n=this.m_shape.getUserIndex(i,this.m_userIndexSortedAngleIndexToVertex);this.m_shape.transferAllDataToTheVertex(e,i),this.m_shape.setUserIndex(i,this.m_userIndexSortedIndexToVertex,s),this.m_shape.setUserIndex(i,this.m_userIndexSortedAngleIndexToVertex,n)}removeAngleSortInfo_(e){const i=this.m_shape.getUserIndex(e,this.m_userIndexSortedAngleIndexToVertex);i!==-1&&(this.m_bunchEdgeIndices[i]=-1,this.m_shape.setUserIndex(e,this.m_userIndexSortedAngleIndexToVertex,-1))}progress_(e=!1){}}function fc(t,e,i,s,n,r=!0){switch(Lfe(s)){case 0:break;case 1:ce("relation string length has to be 9 characters");break;default:ce("relation string")}if(r){const d=cke(s,t.getDimension(),e.getDimension());if(d!==0)return _f(t,e,i,d,n)}let o=0;if(typeof i=="number")o=i;else{const d=J.constructEmpty();t.queryEnvelope(d);const m=J.constructEmpty();e.queryEnvelope(m);const f=J.constructEmpty();f.setCoords({env2D:d}),f.mergeEnvelope2D(m),o=Vy(i,f,!1)}const a=Ree(t,o),l=Ree(e,o);if(a.isEmpty()||l.isEmpty())return uke(a,l,s);const u=a.getGeometryType(),c=l.getGeometryType();let h=!1;switch(u){case q.enumPolygon:switch(c){case q.enumPolygon:h=rke(a,l,o,s,n);break;case q.enumPolyline:h=Pee(a,l,o,s,n);break;case q.enumPoint:h=Iee(a,l,o,s);break;case q.enumMultiPoint:h=Mee(a,l,o,s,n)}break;case q.enumPolyline:switch(c){case q.enumPolygon:h=Pee(l,a,o,zx(s),n);break;case q.enumPolyline:h=oke(a,l,o,s,n);break;case q.enumPoint:h=Dee(a,l,o,s,n);break;case q.enumMultiPoint:h=Aee(a,l,o,s,n)}break;case q.enumPoint:switch(c){case q.enumPolygon:h=Iee(l,a,o,zx(s));break;case q.enumPolyline:h=Dee(l,a,o,zx(s),n);break;case q.enumPoint:h=lke(a,l,o,s);break;case q.enumMultiPoint:h=Nee(l,a,o,zx(s))}break;case q.enumMultiPoint:switch(c){case q.enumPolygon:h=Mee(l,a,o,zx(s),n);break;case q.enumPolyline:h=Aee(l,a,o,zx(s),n);break;case q.enumMultiPoint:h=ake(a,l,o,s,n);break;case q.enumPoint:h=Nee(a,l,o,s)}break;default:h=!1}return h}function ske(t,e,i,s){const n=new Md;n.resetMatrix_(),n.setPredicates_("T*****F**"),n.setAreaAreaPredicates_();const r=J.constructEmpty(),o=J.constructEmpty();t.queryEnvelope(r),e.queryEnvelope(o);let a=!1;if(Ym(r,o,i)&&(n.areaAreaDisjointPredicates_(t,e),a=!0),a||_s(t,e),a)return Ra(n.m_matrix,n.m_scl);let l=new wn,u=l.addGeometry(t),c=l.addGeometry(e),h=null,d=0;if(t.hasNonLinearSegments()||e.hasNonLinearSegments()){h=new pu;const v=mu(i,l.getEnvelope2D(s));d=ud(v,0),nc(l,v,i,12e3,h,null,s)}Qh(l,new pc(i,0).add(d),s,!1,!1);const m=l.getGeometry(c).getBoundary();if(l.filterClosePoints(0,!0,!0,!1,G),bf(l,u,-1,!1,G,s),l.getPointCount(u)===0)return!1;bf(l,c,-1,!1,G,s),n.setEditShape_(l,s);const f=l.getPointCount(c)===0;if(!f){n.computeMatrixTopoGraphHalfEdges_(u,c),n.m_topoGraph.removeShape();const v=Ra(n.m_matrix,n.m_scl);if(!v)return v}const _=l.getGeometry(u);return l=new wn,u=l.addGeometry(_),c=l.addGeometry(m),n.setEditShape_(l,s),n.m_predicateCount=0,n.resetMatrix_(),n.setPredicates_(f?"T*****F**":"******F**"),n.setAreaLinePredicates_(),n.computeMatrixTopoGraphHalfEdges_(u,c),n.m_topoGraph.removeShape(),Ra(n.m_matrix,n.m_scl)}function nke(t,e,i,s){const n=new Md;n.resetMatrix_(),n.setPredicates_("T*****F**"),n.setAreaLinePredicates_();const r=J.constructEmpty(),o=J.constructEmpty();t.queryEnvelope(r),e.queryEnvelope(o);let a=!1;if(Ym(r,o,i)&&(n.areaLineDisjointPredicates_(t,e),a=!0),a||_s(t,e),a)return Ra(n.m_matrix,n.m_scl);const l=new wn,u=l.addGeometry(t),c=l.addGeometry(e);return n.setEditShapeCrackAndCluster_(l,new pc(i,0),s),l.getPointCount(u)===0?!1:(n.computeMatrixTopoGraphHalfEdges_(u,c),n.m_topoGraph.removeShape(),Ra(n.m_matrix,n.m_scl))}function Lfe(t){if(t.length!==9)return 1;for(let e=0;e<9;e++){const i=t[e];if(i!=="*"&&i!=="T"&&i!=="F"&&i!=="0"&&i!=="1"&&i!=="2")return 2}return 0}function rke(t,e,i,s,n){const r=new Md;r.resetMatrix_(),r.setPredicates_(s),r.setAreaAreaPredicates_();const o=J.constructEmpty(),a=J.constructEmpty();t.queryEnvelope(o),e.queryEnvelope(a);let l=!1;if(Ym(o,a,i)&&(r.areaAreaDisjointPredicates_(t,e),l=!0),l||_s(t,e),!l){const u=new wn,c=u.addGeometry(t),h=u.addGeometry(e);r.setEditShapeCrackAndCluster_(u,new pc(i,0),n),r.computeMatrixTopoGraphHalfEdges_(c,h),r.m_topoGraph.removeShape()}return Ra(r.m_matrix,r.m_scl)}function Pee(t,e,i,s,n){const r=new Md;r.resetMatrix_(),r.setPredicates_(s),r.setAreaLinePredicates_();const o=J.constructEmpty(),a=J.constructEmpty();t.queryEnvelope(o),e.queryEnvelope(a);let l=!1;if(Ym(o,a,i)&&(r.areaLineDisjointPredicates_(t,e),l=!0),l||_s(t,e),!l){const u=new wn,c=u.addGeometry(t),h=u.addGeometry(e);r.setEditShapeCrackAndCluster_(u,new pc(i,0),n),r.m_clusterIndexB=r.m_topoGraph.createUserIndexForClusters(),_L(h,r.m_topoGraph,r.m_clusterIndexB),r.computeMatrixTopoGraphHalfEdges_(c,h),r.m_topoGraph.deleteUserIndexForClusters(r.m_clusterIndexB),r.m_topoGraph.removeShape()}return Ra(r.m_matrix,r.m_scl)}function Mee(t,e,i,s,n){const r=new Md;r.resetMatrix_(),r.setPredicates_(s),r.setAreaPointPredicates_();const o=J.constructEmpty(),a=J.constructEmpty();t.queryEnvelope(o),e.queryEnvelope(a);let l=!1;if(Ym(o,a,i)&&(r.areaPointDisjointPredicates_(t),l=!0),l||_s(t,e),!l){const u=new wn,c=u.addGeometry(t),h=u.addGeometry(e);r.setEditShapeCrackAndCluster_(u,new pc(i,0),n),r.computeMatrixTopoGraphClusters_(c,h),r.m_topoGraph.removeShape()}return Ra(r.m_matrix,r.m_scl)}function oke(t,e,i,s,n){const r=new Md;r.resetMatrix_(),r.setPredicates_(s),r.setLineLinePredicates_();const o=J.constructEmpty(),a=J.constructEmpty();t.queryEnvelope(o),e.queryEnvelope(a);let l=!1;if(Ym(o,a,i)&&(r.lineLineDisjointPredicates_(t,e),l=!0),l||_s(t,e),!l){const u=new wn,c=u.addGeometry(t),h=u.addGeometry(e);r.setEditShapeCrackAndCluster_(u,new pc(i,0),n),r.m_clusterIndexA=r.m_topoGraph.createUserIndexForClusters(),r.m_clusterIndexB=r.m_topoGraph.createUserIndexForClusters(),_L(c,r.m_topoGraph,r.m_clusterIndexA),_L(h,r.m_topoGraph,r.m_clusterIndexB),r.computeMatrixTopoGraphHalfEdges_(c,h),r.m_topoGraph.deleteUserIndexForClusters(r.m_clusterIndexA),r.m_topoGraph.deleteUserIndexForClusters(r.m_clusterIndexB),r.m_topoGraph.removeShape()}return Ra(r.m_matrix,r.m_scl)}function Aee(t,e,i,s,n){const r=new Md;r.resetMatrix_(),r.setPredicates_(s),r.setLinePointPredicates_();const o=J.constructEmpty(),a=J.constructEmpty();t.queryEnvelope(o),e.queryEnvelope(a);let l=!1;if(Ym(o,a,i)&&(r.linePointDisjointPredicates_(t),l=!0),l||_s(t,e),!l){const u=new wn,c=u.addGeometry(t),h=u.addGeometry(e);r.setEditShapeCrackAndCluster_(u,new pc(i,0),n),r.m_clusterIndexA=r.m_topoGraph.createUserIndexForClusters(),_L(c,r.m_topoGraph,r.m_clusterIndexA),r.computeMatrixTopoGraphClusters_(c,h),r.m_topoGraph.deleteUserIndexForClusters(r.m_clusterIndexA),r.m_topoGraph.removeShape()}return Ra(r.m_matrix,r.m_scl)}function ake(t,e,i,s,n){const r=new Md;r.resetMatrix_(),r.setPredicates_(s),r.setPointPointPredicates_();const o=new J,a=new J;t.queryEnvelope(o),e.queryEnvelope(a);let l=!1;if(Ym(o,a,i)&&(r.pointPointDisjointPredicates_(),l=!0),!l){const u=new wn,c=u.addGeometry(t),h=u.addGeometry(e);r.setEditShapeCrackAndCluster_(u,new pc(i,0),n),r.computeMatrixTopoGraphClusters_(c,h),r.m_topoGraph.removeShape()}return Ra(r.m_matrix,r.m_scl)}function Iee(t,e,i,s,n){const r=new Md;r.resetMatrix_(),r.setPredicates_(s),r.setAreaPointPredicates_();const o=J.constructEmpty();t.queryEnvelope(o);const a=e.getXY();let l=!1;if(c4(a,o,i)&&(r.areaPointDisjointPredicates_(t),l=!0),!l){const u=ul(t,a,i);if(u===1)r.m_matrix[0]=0,r.m_matrix[2]=2,r.m_matrix[3]=-1,r.m_matrix[5]=1,r.m_matrix[6]=-1;else if(u===2)if(r.m_matrix[6]=-1,t.calculateArea2D()!==0)r.m_matrix[0]=-1,r.m_matrix[3]=0,r.m_matrix[2]=2,r.m_matrix[5]=1;else{r.m_matrix[0]=0,r.m_matrix[3]=-1,r.m_matrix[5]=-1;const c=J.constructEmpty();t.queryEnvelope(c),r.m_matrix[2]=c.height()||c.width()?1:-1}else r.areaPointDisjointPredicates_(t)}return Ra(r.m_matrix,s)}function Dee(t,e,i,s,n){const r=new Md;r.resetMatrix_(),r.setPredicates_(s),r.setLinePointPredicates_();const o=J.constructEmpty();t.queryEnvelope(o);let a=!1;if(c4(e.getXY(),o,i)&&(r.linePointDisjointPredicates_(t),a=!0),!a){let l=null,u=!1,c=!1;if((r.m_performPredicates[0]||r.m_performPredicates[6])&&(_f(t,e,i,4,n)?(r.m_matrix[0]=-1,r.m_matrix[6]=0):(r.m_performPredicates[0]&&(l=pd(t),c=!_f(l,e,i,4,n),u=!0,r.m_matrix[0]=c?-1:0),r.m_matrix[6]=-1)),r.m_performPredicates[3]&&(l!==null&&l.isEmpty()?r.m_matrix[3]=-1:(u||(l==null&&(l=pd(t)),c=!_f(l,e,i,4,n),u=!0),r.m_matrix[3]=c?0:-1)),r.m_performPredicates[5])if(l!==null&&l.isEmpty())r.m_matrix[5]=-1;else if(u&&!c)r.m_matrix[5]=0;else{l===null&&(l=pd(t));const h=_f(l,e,i,3,n);r.m_matrix[5]=h?-1:0}if(r.m_performPredicates[2])if(t.calculateLength2D()!==0)r.m_matrix[2]=1;else{const h=new Dn({vd:t.getDescription()});h.addPoints(t,0,t.getPointCount());const d=_f(h,e,i,3,n);r.m_matrix[2]=d?-1:0}}return Ra(r.m_matrix,r.m_scl)}function Nee(t,e,i,s,n){const r=new Md;r.resetMatrix_(),r.setPredicates_(s),r.setPointPointPredicates_();const o=J.constructEmpty();t.queryEnvelope(o);const a=e.getXY(),l=new N;let u=!1;if(c4(a,o,i)&&(r.pointPointDisjointPredicates_(),u=!0),!u){let c=!1,h=!0;const d=i*i;for(let m=0;m<t.getPointCount()&&(t.queryXY(m,l),N.sqrDistance(l,a)<=d?c=!0:h=!1,!c||h);m++);c?(r.m_matrix[0]=0,r.m_matrix[2]=h?-1:0,r.m_matrix[6]=-1):(r.m_matrix[0]=-1,r.m_matrix[2]=0,r.m_matrix[6]=0)}return Ra(r.m_matrix,s)}function lke(t,e,i,s,n){const r=t.getXY(),o=e.getXY(),a=st(9,-1);return N.sqrDistance(r,o)<=i*i?a[0]=0:(a[2]=0,a[6]=0),a[8]=2,Ra(a,s)}function Ra(t,e){for(let i=0;i<9;i++)switch(e[i]){case"T":if(t[i]===-1)return!1;break;case"F":if(t[i]!==-1)return!1;break;case"0":if(t[i]!==0)return!1;break;case"1":if(t[i]!==1)return!1;break;case"2":if(t[i]!==2)return!1}return!0}function uke(t,e,i){const s=st(9,-1);if(t.isEmpty()&&e.isEmpty())return Ra(s,i);let n,r=!1;t.isEmpty()?(n=e,r=!0):n=t,s[0]=-1,s[1]=-1,s[3]=-1,s[4]=-1,s[6]=-1,s[7]=-1,s[8]=2;const o=n.getGeometryType();if(Ei(o))if(o===q.enumPolygon)if(n.calculateArea2D()!==0)s[2]=2,s[5]=1;else{s[5]=-1;const a=J.constructEmpty();n.queryEnvelope(a),s[2]=a.height()||a.width()?1:0}else{const a=n.calculateLength2D()!==0;s[2]=a?1:0,s[5]=Cv(n)?0:-1}else s[2]=0,s[5]=-1;return r&&Ffe(s),Ra(s,i)}function cke(t,e,i){return hke(t)?3:dke(t)?4:mke(t,e,i)?8:pke(t,e,i)?16:gke(t)?64:fke(t)?1:_ke(t,e,i)?32:0}function hke(t){return t==="T*F**FFF*"}function dke(t){return t==="FF*FF****"}function mke(t,e,i){return(e!==0||i!==0)&&(e===2&&i===2?t==="F***T****":(e===2||e===1)&&i===0&&t==="F**T*****")}function pke(t,e,i){return e>i?t==="T*****T**":e===1&&i===1&&t==="0********"}function fke(t){return t==="T*****FF*"}function gke(t){return t==="T**FF*FF*"}function _ke(t,e,i){return e===i&&(e!==1?t==="T*T***T**":t==="1*T***T**")}function _L(t,e,i){const s=e.getGeometryID(t);for(let n=e.getFirstCluster();n!==G;n=e.getNextCluster(n)){if(!(e.getClusterParentage(n)&s))continue;const r=e.getClusterHalfEdge(n);if(r===G){e.setClusterUserIndex(n,i,0);continue}let o=r,a=0;do{const l=o;e.getHalfEdgeParentage(l)&s&&a++,o=e.getHalfEdgeNext(e.getHalfEdgeTwin(l))}while(o!==r);e.setClusterUserIndex(n,i,a)}}class Md{nullFunc(){return We("should not be called"),!1}constructor(){this.m_clusterIndexA=-1,this.m_clusterIndexB=-1,this.m_visitedIndex=-1,this.m_topoGraph=new sc,this.m_matrix=st(9,0),this.m_maxDim=st(9,0),this.m_performPredicates=st(9,!1),this.m_scl="",this.m_predicateCount=0,this.m_predicatesHalfEdge=this.nullFunc,this.m_predicatesCluster=this.nullFunc}resetMatrix_(){this.m_matrix.fill(-2),this.m_maxDim.fill(-2)}setPredicates_(e){this.m_scl=e;for(let i=0;i<9;i++)this.m_scl[i]!=="*"?(this.m_performPredicates[i]=!0,this.m_predicateCount++):this.m_performPredicates[i]=!1}setRemainingPredicatesToFalse_(){for(let e=0;e<9;e++)this.m_performPredicates[e]&&this.m_matrix[e]===-2&&(this.m_matrix[e]=-1,this.m_performPredicates[e]=!1)}isPredicateKnown_(e){return this.m_matrix[e]!==-2&&(this.m_matrix[e]===-1?(this.m_performPredicates[e]=!1,this.m_predicateCount--,!0):this.m_scl[e]!=="T"&&this.m_scl[e]!=="F"?!(this.m_matrix[e]<this.m_maxDim[e])&&(this.m_performPredicates[e]=!1,this.m_predicateCount--,!0):(this.m_performPredicates[e]=!1,this.m_predicateCount--,!0))}setAreaAreaPredicates_(){this.m_predicatesHalfEdge=this.areaAreaPredicates_,this.m_maxDim[0]=2,this.m_maxDim[1]=1,this.m_maxDim[2]=2,this.m_maxDim[3]=1,this.m_maxDim[4]=1,this.m_maxDim[5]=1,this.m_maxDim[6]=2,this.m_maxDim[7]=1,this.m_maxDim[8]=2,this.m_performPredicates[8]&&(this.m_matrix[8]=2,this.m_performPredicates[8]=!1,this.m_predicateCount--)}setAreaLinePredicates_(){this.m_predicatesHalfEdge=this.areaLinePredicates_,this.m_predicatesCluster=this.areaPointPredicates_,this.m_maxDim[0]=1,this.m_maxDim[1]=0,this.m_maxDim[2]=2,this.m_maxDim[3]=1,this.m_maxDim[4]=0,this.m_maxDim[5]=1,this.m_maxDim[6]=1,this.m_maxDim[7]=0,this.m_maxDim[8]=2,this.m_performPredicates[8]&&(this.m_matrix[8]=2,this.m_performPredicates[8]=!1,this.m_predicateCount--)}setLineLinePredicates_(){this.m_predicatesHalfEdge=this.lineLinePredicates_,this.m_predicatesCluster=this.linePointPredicates_,this.m_maxDim[0]=1,this.m_maxDim[1]=0,this.m_maxDim[2]=1,this.m_maxDim[3]=0,this.m_maxDim[4]=0,this.m_maxDim[5]=0,this.m_maxDim[6]=1,this.m_maxDim[7]=0,this.m_maxDim[8]=2,this.m_performPredicates[8]&&(this.m_matrix[8]=2,this.m_performPredicates[8]=!1,this.m_predicateCount--)}setAreaPointPredicates_(){this.m_predicatesCluster=this.areaPointPredicates_,this.m_maxDim[0]=0,this.m_maxDim[1]=-1,this.m_maxDim[2]=2,this.m_maxDim[3]=0,this.m_maxDim[4]=-1,this.m_maxDim[5]=1,this.m_maxDim[6]=0,this.m_maxDim[7]=-1,this.m_maxDim[8]=2,this.m_performPredicates[1]&&(this.m_matrix[1]=-1,this.m_performPredicates[1]=!1,this.m_predicateCount--),this.m_performPredicates[4]&&(this.m_matrix[4]=-1,this.m_performPredicates[4]=!1,this.m_predicateCount--),this.m_performPredicates[7]&&(this.m_matrix[7]=-1,this.m_performPredicates[7]=!1,this.m_predicateCount--),this.m_performPredicates[8]&&(this.m_matrix[8]=2,this.m_performPredicates[8]=!1,this.m_predicateCount--)}setLinePointPredicates_(){this.m_predicatesCluster=this.linePointPredicates_,this.m_maxDim[0]=0,this.m_maxDim[1]=-1,this.m_maxDim[2]=1,this.m_maxDim[3]=0,this.m_maxDim[4]=-1,this.m_maxDim[5]=0,this.m_maxDim[6]=0,this.m_maxDim[7]=-1,this.m_maxDim[8]=2,this.m_performPredicates[1]&&(this.m_matrix[1]=-1,this.m_performPredicates[1]=!1,this.m_predicateCount--),this.m_performPredicates[4]&&(this.m_matrix[4]=-1,this.m_performPredicates[4]=!1,this.m_predicateCount--),this.m_performPredicates[7]&&(this.m_matrix[7]=-1,this.m_performPredicates[7]=!1,this.m_predicateCount--),this.m_performPredicates[8]&&(this.m_matrix[8]=2,this.m_performPredicates[8]=!1,this.m_predicateCount--)}setPointPointPredicates_(){this.m_predicatesCluster=this.pointPointPredicates_,this.m_maxDim[0]=0,this.m_maxDim[1]=-1,this.m_maxDim[2]=0,this.m_maxDim[3]=-1,this.m_maxDim[4]=-1,this.m_maxDim[5]=-1,this.m_maxDim[6]=0,this.m_maxDim[7]=-1,this.m_maxDim[8]=2,this.m_performPredicates[1]&&(this.m_matrix[1]=-1,this.m_performPredicates[1]=!1,this.m_predicateCount--),this.m_performPredicates[3]&&(this.m_matrix[3]=-1,this.m_performPredicates[3]=!1,this.m_predicateCount--),this.m_performPredicates[4]&&(this.m_matrix[4]=-1,this.m_performPredicates[4]=!1,this.m_predicateCount--),this.m_performPredicates[5]&&(this.m_matrix[5]=-1,this.m_performPredicates[5]=!1,this.m_predicateCount--),this.m_performPredicates[7]&&(this.m_matrix[7]=-1,this.m_performPredicates[7]=!1,this.m_predicateCount--),this.m_performPredicates[8]&&(this.m_matrix[8]=2,this.m_performPredicates[8]=!1,this.m_predicateCount--)}areaAreaDisjointPredicates_(e,i){this.m_matrix[0]=-1,this.m_matrix[1]=-1,this.m_matrix[3]=-1,this.m_matrix[4]=-1,this.areaGeomContainsOrDisjointPredicates_(e,this.m_performPredicates[2]?2:-1,this.m_scl[2],this.m_performPredicates[5]?5:-1,this.m_scl[5]),this.areaGeomContainsOrDisjointPredicates_(i,this.m_performPredicates[6]?6:-1,this.m_scl[6],this.m_performPredicates[7]?7:-1,this.m_scl[7])}areaGeomContainsOrDisjointPredicates_(e,i,s,n,r){const o=i!==-1,a=n!==-1;if(o||a){if(!(s!=="T"&&s!=="F"&&o||r!=="T"&&r!=="F"&&a)||e.calculateArea2D()!==0)o&&(this.m_matrix[i]=2),a&&(this.m_matrix[n]=1);else if(a&&(this.m_matrix[n]=-1),o){const l=J.constructEmpty();e.queryEnvelope(l),this.m_matrix[i]=l.height()||l.width()?1:0}}}areaAreaContainsPredicates_(e){this.m_matrix[2]=2,this.m_matrix[3]=-1,this.m_matrix[4]=-1,this.m_matrix[5]=1,this.m_matrix[6]=-1,this.m_matrix[7]=-1,this.areaGeomContainsOrDisjointPredicates_(e,this.m_performPredicates[0]?0:-1,this.m_scl[0],this.m_performPredicates[1]?1:-1,this.m_scl[1])}areaAreaWithinPredicates_(e){this.areaAreaContainsPredicates_(e),Ffe(this.m_matrix)}areaLineDisjointPredicates_(e,i){if(this.m_matrix[0]=-1,this.m_matrix[1]=-1,this.m_matrix[3]=-1,this.m_matrix[4]=-1,this.m_performPredicates[6]){const s=this.m_scl[6],n=s==="T"||s==="F"||i.calculateLength2D()!==0;this.m_matrix[6]=n?1:0}if(this.m_performPredicates[7]){const s=Cv(i);this.m_matrix[7]=s?0:-1}this.areaGeomContainsOrDisjointPredicates_(e,this.m_performPredicates[2]?2:-1,this.m_scl[2],this.m_performPredicates[5]?5:-1,this.m_scl[5])}areaLineContainsPredicates_(e,i){if(this.m_performPredicates[0]){const s=this.m_scl[0],n=s==="T"||s==="F"||i.calculateLength2D()!==0;this.m_matrix[0]=n?1:0}if(this.m_performPredicates[1]){const s=Cv(i);this.m_matrix[1]=s?0:-1}this.m_matrix[2]=2,this.m_matrix[3]=-1,this.m_matrix[4]=-1,this.m_matrix[5]=1,this.m_matrix[6]=-1,this.m_matrix[7]=-1}areaPointDisjointPredicates_(e){this.m_matrix[0]=-1,this.m_matrix[3]=-1,this.m_matrix[6]=0,this.areaGeomContainsOrDisjointPredicates_(e,this.m_performPredicates[2]?2:-1,this.m_scl[2],this.m_performPredicates[5]?5:-1,this.m_scl[5])}areaPointContainsPredicates_(e){this.m_matrix[0]=0,this.m_matrix[2]=2,this.m_matrix[3]=-1,this.m_matrix[5]=1,this.m_matrix[6]=-1}lineLineDisjointPredicates_(e,i){if(this.m_matrix[0]=-1,this.m_matrix[1]=-1,this.m_matrix[3]=-1,this.m_matrix[4]=-1,this.m_performPredicates[2]){const s=this.m_scl[2],n=s==="T"||s==="F"||e.calculateLength2D()!==0;this.m_matrix[2]=n?1:0}if(this.m_performPredicates[5]){const s=Cv(e);this.m_matrix[5]=s?0:-1}if(this.m_performPredicates[6]){const s=this.m_scl[6],n=s==="T"||s==="F"||i.calculateLength2D()!==0;this.m_matrix[6]=n?1:0}if(this.m_performPredicates[7]){const s=Cv(i);this.m_matrix[7]=s?0:-1}}linePointDisjointPredicates_(e){if(this.m_matrix[0]=-1,this.m_matrix[3]=-1,this.m_performPredicates[2]){const i=this.m_scl[2],s=i==="T"||i==="F"||e.calculateLength2D()!==0;this.m_matrix[2]=s?1:0}if(this.m_performPredicates[5]){const i=Cv(e);this.m_matrix[5]=i?0:-1}this.m_matrix[6]=0}pointPointDisjointPredicates_(){this.m_matrix[0]=-1,this.m_matrix[2]=0,this.m_matrix[6]=0}areaAreaPredicates_(e,i,s){let n=!0;if(this.m_performPredicates[0]){this.interiorAreaInteriorArea_(e,i,s);const r=this.isPredicateKnown_(0);n&&(n=r)}if(this.m_performPredicates[1]){this.interiorAreaBoundaryArea_(e,i,1);const r=this.isPredicateKnown_(1);n&&(n=r)}if(this.m_performPredicates[2]){this.interiorAreaExteriorArea_(e,i,s,2);const r=this.isPredicateKnown_(2);n&&(n=r)}if(this.m_performPredicates[3]){this.interiorAreaBoundaryArea_(e,s,3);const r=this.isPredicateKnown_(3);n&&(n=r)}if(this.m_performPredicates[4]){this.boundaryAreaBoundaryArea_(e,i,s);const r=this.isPredicateKnown_(4);n&&(n=r)}if(this.m_performPredicates[5]){this.boundaryAreaExteriorArea_(e,i,s,5);const r=this.isPredicateKnown_(5);n&&(n=r)}if(this.m_performPredicates[6]){this.interiorAreaExteriorArea_(e,s,i,6);const r=this.isPredicateKnown_(6);n&&(n=r)}if(this.m_performPredicates[7]){this.boundaryAreaExteriorArea_(e,s,i,7);const r=this.isPredicateKnown_(7);n&&(n=r)}return n}areaLinePredicates_(e,i,s){let n=!0;if(this.m_performPredicates[0]){this.interiorAreaInteriorLine_(e,i,s);const r=this.isPredicateKnown_(0);n&&(n=r)}if(this.m_performPredicates[1]){this.interiorAreaBoundaryLine_(e,i,s,this.m_clusterIndexB);const r=this.isPredicateKnown_(1);n&&(n=r)}if(this.m_performPredicates[2]){this.interiorAreaExteriorLine_(e,i,s);const r=this.isPredicateKnown_(2);n&&(n=r)}if(this.m_performPredicates[3]){this.boundaryAreaInteriorLine_(e,i,s,this.m_clusterIndexB);const r=this.isPredicateKnown_(3);n&&(n=r)}if(this.m_performPredicates[4]){this.boundaryAreaBoundaryLine_(e,i,s,this.m_clusterIndexB);const r=this.isPredicateKnown_(4);n&&(n=r)}if(this.m_performPredicates[5]){this.boundaryAreaExteriorLine_(e,i,s);const r=this.isPredicateKnown_(5);n&&(n=r)}if(this.m_performPredicates[6]){this.exteriorAreaInteriorLine_(e,i);const r=this.isPredicateKnown_(6);n&&(n=r)}if(this.m_performPredicates[7]){this.exteriorAreaBoundaryLine_(e,i,s,this.m_clusterIndexB);const r=this.isPredicateKnown_(7);n&&(n=r)}return n}lineLinePredicates_(e,i,s){let n=!0;if(this.m_performPredicates[0]){this.interiorLineInteriorLine_(e,i,s,this.m_clusterIndexA,this.m_clusterIndexB);const r=this.isPredicateKnown_(0);n&&(n=r)}if(this.m_performPredicates[1]){this.interiorLineBoundaryLine_(e,i,s,this.m_clusterIndexA,this.m_clusterIndexB,1);const r=this.isPredicateKnown_(1);n&&(n=r)}if(this.m_performPredicates[2]){this.interiorLineExteriorLine_(e,i,s,2);const r=this.isPredicateKnown_(2);n&&(n=r)}if(this.m_performPredicates[3]){this.interiorLineBoundaryLine_(e,s,i,this.m_clusterIndexB,this.m_clusterIndexA,3);const r=this.isPredicateKnown_(3);n&&(n=r)}if(this.m_performPredicates[4]){this.boundaryLineBoundaryLine_(e,i,s,this.m_clusterIndexA,this.m_clusterIndexB);const r=this.isPredicateKnown_(4);n&&(n=r)}if(this.m_performPredicates[5]){this.boundaryLineExteriorLine_(e,i,s,this.m_clusterIndexA,5);const r=this.isPredicateKnown_(5);n&&(n=r)}if(this.m_performPredicates[6]){this.interiorLineExteriorLine_(e,s,i,6);const r=this.isPredicateKnown_(6);n&&(n=r)}if(this.m_performPredicates[7]){this.boundaryLineExteriorLine_(e,s,i,this.m_clusterIndexB,7);const r=this.isPredicateKnown_(7);n&&(n=r)}return n}areaPointPredicates_(e,i,s){let n=!0;if(this.m_performPredicates[0]){this.interiorAreaInteriorPoint_(e,i);const r=this.isPredicateKnown_(0);n&&(n=r)}if(this.m_performPredicates[2]){this.interiorAreaExteriorPoint_(e,i);const r=this.isPredicateKnown_(2);n&&(n=r)}if(this.m_performPredicates[3]){this.boundaryAreaInteriorPoint_(e,i,s);const r=this.isPredicateKnown_(3);n&&(n=r)}if(this.m_performPredicates[5]){this.boundaryAreaExteriorPoint_(e,i);const r=this.isPredicateKnown_(5);n&&(n=r)}if(this.m_performPredicates[6]){this.exteriorAreaInteriorPoint_(e,i);const r=this.isPredicateKnown_(6);n&&(n=r)}return n}linePointPredicates_(e,i,s){let n=!0;if(this.m_performPredicates[0]){this.interiorLineInteriorPoint_(e,i,s,this.m_clusterIndexA);const r=this.isPredicateKnown_(0);n&&(n=r)}if(this.m_performPredicates[2]){this.interiorLineExteriorPoint_(e,i,s,this.m_clusterIndexA);const r=this.isPredicateKnown_(2);n&&(n=r)}if(this.m_performPredicates[3]){this.boundaryLineInteriorPoint_(e,i,s,this.m_clusterIndexA);const r=this.isPredicateKnown_(3);n&&(n=r)}if(this.m_performPredicates[5]){this.boundaryLineExteriorPoint_(e,i,s,this.m_clusterIndexA);const r=this.isPredicateKnown_(5);n&&(n=r)}if(this.m_performPredicates[6]){this.exteriorLineInteriorPoint_(e,i,s);const r=this.isPredicateKnown_(6);n&&(n=r)}return n}pointPointPredicates_(e,i,s){let n=!0;if(this.m_performPredicates[0]){this.interiorPointInteriorPoint_(e,i,s);const r=this.isPredicateKnown_(0);n&&(n=r)}if(this.m_performPredicates[2]){this.interiorPointExteriorPoint_(e,i,s,2);const r=this.isPredicateKnown_(2);n&&(n=r)}if(this.m_performPredicates[6]){this.interiorPointExteriorPoint_(e,s,i,6);const r=this.isPredicateKnown_(6);n&&(n=r)}return n}interiorAreaInteriorArea_(e,i,s){if(this.m_matrix[0]===2)return;const n=this.m_topoGraph.getHalfEdgeFaceParentage(e);n&i&&n&s&&(this.m_matrix[0]=2)}interiorAreaBoundaryArea_(e,i,s){if(this.m_matrix[s]===1)return;const n=this.m_topoGraph.getHalfEdgeFaceParentage(e),r=this.m_topoGraph.getHalfEdgeFaceParentage(this.m_topoGraph.getHalfEdgeTwin(e));n&i&&r&i&&(this.m_matrix[s]=1)}interiorAreaExteriorArea_(e,i,s,n){if(this.m_matrix[n]===2)return;const r=this.m_topoGraph.getHalfEdgeFaceParentage(e);r&i&&!(r&s)&&(this.m_matrix[n]=2)}boundaryAreaBoundaryArea_(e,i,s){if(this.m_matrix[4]===1)return;const n=this.m_topoGraph.getHalfEdgeParentage(e);if(n&i&&n&s)this.m_matrix[4]=1;else if(this.m_matrix[4]!==0&&this.m_topoGraph.getHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgePrev(this.m_topoGraph.getHalfEdgeTwin(e)),this.m_visitedIndex)!==1){const r=this.m_topoGraph.getHalfEdgeTo(e),o=this.m_topoGraph.getClusterParentage(r);if(o&i&&o&s)return void(this.m_matrix[4]=0)}}boundaryAreaExteriorArea_(e,i,s,n){if(this.m_matrix[n]===1)return;const r=this.m_topoGraph.getHalfEdgeFaceParentage(e),o=this.m_topoGraph.getHalfEdgeFaceParentage(this.m_topoGraph.getHalfEdgeTwin(e));r&s||o&s||(this.m_matrix[n]=1)}interiorAreaInteriorLine_(e,i,s){if(this.m_matrix[0]===1)return;const n=this.m_topoGraph.getHalfEdgeFaceParentage(e),r=this.m_topoGraph.getHalfEdgeFaceParentage(this.m_topoGraph.getHalfEdgeTwin(e));n&i&&r&i&&(this.m_matrix[0]=1)}interiorAreaBoundaryLine_(e,i,s,n){if(this.m_matrix[1]!==0&&this.m_topoGraph.getHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgePrev(this.m_topoGraph.getHalfEdgeTwin(e)),this.m_visitedIndex)!==1){const r=this.m_topoGraph.getHalfEdgeTo(e),o=this.m_topoGraph.getClusterParentage(r);if(!(o&i)&&this.m_topoGraph.getHalfEdgeFaceParentage(e)&i){const a=this.m_topoGraph.getClusterUserIndex(r,n);if(o&s&&a%2!=0)return void(this.m_matrix[1]=0)}}}interiorAreaExteriorLine_(e,i,s){this.m_matrix[2]!==2&&this.m_topoGraph.getHalfEdgeParentage(e)&i&&(this.m_matrix[2]=2)}boundaryAreaInteriorLine_(e,i,s,n){if(this.m_matrix[3]===1)return;const r=this.m_topoGraph.getHalfEdgeParentage(e);if(r&i&&r&s)this.m_matrix[3]=1;else if(this.m_matrix[3]!==0&&this.m_topoGraph.getHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgePrev(this.m_topoGraph.getHalfEdgeTwin(e)),this.m_visitedIndex)!==1){const o=this.m_topoGraph.getHalfEdgeTo(e),a=this.m_topoGraph.getClusterParentage(o);if(a&i){const l=this.m_topoGraph.getClusterUserIndex(o,n);if(a&s&&l%2==0)return void(this.m_matrix[3]=0)}}}boundaryAreaBoundaryLine_(e,i,s,n){if(this.m_matrix[4]!==0&&this.m_topoGraph.getHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgePrev(this.m_topoGraph.getHalfEdgeTwin(e)),this.m_visitedIndex)!==1){const r=this.m_topoGraph.getHalfEdgeTo(e),o=this.m_topoGraph.getClusterParentage(r);if(o&i){const a=this.m_topoGraph.getClusterUserIndex(r,n);if(o&s&&a%2!=0)return void(this.m_matrix[4]=0)}}}boundaryAreaExteriorLine_(e,i,s){if(this.m_matrix[5]===1)return;const n=this.m_topoGraph.getHalfEdgeParentage(e);n&i&&!(n&s)&&(this.m_matrix[5]=1)}exteriorAreaInteriorLine_(e,i){if(this.m_matrix[6]===1)return;const s=this.m_topoGraph.getHalfEdgeFaceParentage(e),n=this.m_topoGraph.getHalfEdgeFaceParentage(this.m_topoGraph.getHalfEdgeTwin(e));s&i||n&i||(this.m_matrix[6]=1)}exteriorAreaBoundaryLine_(e,i,s,n){if(this.m_matrix[7]!==0&&this.m_topoGraph.getHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgePrev(this.m_topoGraph.getHalfEdgeTwin(e)),this.m_visitedIndex)!==1){const r=this.m_topoGraph.getHalfEdgeTo(e),o=this.m_topoGraph.getClusterParentage(r);if(!(o&i)&&!(this.m_topoGraph.getHalfEdgeFaceParentage(e)&i)){const a=this.m_topoGraph.getClusterUserIndex(r,n);if(o&s&&a%2!=0)return void(this.m_matrix[7]=0)}}}interiorLineInteriorLine_(e,i,s,n,r){if(this.m_matrix[0]===1)return;const o=this.m_topoGraph.getHalfEdgeParentage(e);if(o&i&&o&s)this.m_matrix[0]=1;else if(this.m_matrix[0]!==0&&this.m_topoGraph.getHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgePrev(this.m_topoGraph.getHalfEdgeTwin(e)),this.m_visitedIndex)!==1){const a=this.m_topoGraph.getHalfEdgeTo(e),l=this.m_topoGraph.getClusterParentage(a);if(l&i&&l&s){const u=this.m_topoGraph.getClusterUserIndex(a,n),c=this.m_topoGraph.getClusterUserIndex(a,r);if(u%2==0&&c%2==0)return void(this.m_matrix[0]=0)}}}interiorLineBoundaryLine_(e,i,s,n,r,o){if(this.m_matrix[o]!==0&&this.m_topoGraph.getHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgePrev(this.m_topoGraph.getHalfEdgeTwin(e)),this.m_visitedIndex)!==1){const a=this.m_topoGraph.getHalfEdgeTo(e),l=this.m_topoGraph.getClusterParentage(a);if(l&i&&l&s){const u=this.m_topoGraph.getClusterUserIndex(a,n),c=this.m_topoGraph.getClusterUserIndex(a,r);if(u%2==0&&c%2!=0)return void(this.m_matrix[o]=0)}}}interiorLineExteriorLine_(e,i,s,n){if(this.m_matrix[n]===1)return;const r=this.m_topoGraph.getHalfEdgeParentage(e);r&i&&!(r&s)&&(this.m_matrix[n]=1)}boundaryLineBoundaryLine_(e,i,s,n,r){if(this.m_matrix[4]!==0&&this.m_topoGraph.getHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgePrev(this.m_topoGraph.getHalfEdgeTwin(e)),this.m_visitedIndex)!==1){const o=this.m_topoGraph.getHalfEdgeTo(e),a=this.m_topoGraph.getClusterParentage(o);if(a&i&&a&s){const l=this.m_topoGraph.getClusterUserIndex(o,n),u=this.m_topoGraph.getClusterUserIndex(o,r);if(l%2!=0&&u%2!=0)return void(this.m_matrix[4]=0)}}}boundaryLineExteriorLine_(e,i,s,n,r){if(this.m_matrix[r]!==0&&this.m_topoGraph.getHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgePrev(this.m_topoGraph.getHalfEdgeTwin(e)),this.m_visitedIndex)!==1){const o=this.m_topoGraph.getHalfEdgeTo(e);if(!(this.m_topoGraph.getClusterParentage(o)&s)&&this.m_topoGraph.getClusterUserIndex(o,n)%2!=0)return void(this.m_matrix[r]=0)}}interiorAreaInteriorPoint_(e,i){if(this.m_matrix[0]!==0&&!(this.m_topoGraph.getClusterParentage(e)&i)){const s=this.m_topoGraph.getClusterChain(e);if(this.m_topoGraph.getChainParentage(s)&i)return void(this.m_matrix[0]=0)}}interiorAreaExteriorPoint_(e,i){this.m_matrix[2]!==2&&this.m_topoGraph.getClusterParentage(e)&i&&(this.m_matrix[2]=2)}boundaryAreaInteriorPoint_(e,i,s){if(this.m_matrix[3]===0)return;const n=this.m_topoGraph.getClusterParentage(e);n&i&&n&s&&(this.m_matrix[3]=0)}boundaryAreaExteriorPoint_(e,i){this.m_matrix[5]!==1&&this.m_topoGraph.getClusterParentage(e)&i&&(this.m_matrix[5]=1)}exteriorAreaInteriorPoint_(e,i){if(this.m_matrix[6]!==0&&!(this.m_topoGraph.getClusterParentage(e)&i)){const s=this.m_topoGraph.getClusterChain(e);if(!(this.m_topoGraph.getChainParentage(s)&i))return void(this.m_matrix[6]=0)}}interiorLineInteriorPoint_(e,i,s,n){if(this.m_matrix[0]===0)return;const r=this.m_topoGraph.getClusterParentage(e);if(r&i&&r&s&&this.m_topoGraph.getClusterUserIndex(e,n)%2==0)return void(this.m_matrix[0]=0)}interiorLineExteriorPoint_(e,i,s,n){if(this.m_matrix[2]!==1)if(this.m_topoGraph.getClusterHalfEdge(e)===-1){if(this.m_matrix[2]!==0&&!(this.m_topoGraph.getClusterParentage(e)&s))return void(this.m_matrix[2]=0)}else this.m_matrix[2]=1}boundaryLineInteriorPoint_(e,i,s,n){if(this.m_matrix[3]===0)return;const r=this.m_topoGraph.getClusterParentage(e);if(r&i&&r&s&&this.m_topoGraph.getClusterUserIndex(e,n)%2!=0)return void(this.m_matrix[3]=0)}boundaryLineExteriorPoint_(e,i,s,n){if(this.m_matrix[5]===0)return;const r=this.m_topoGraph.getClusterParentage(e);if(r&i&&!(r&s)&&this.m_topoGraph.getClusterUserIndex(e,n)%2!=0)return void(this.m_matrix[5]=0)}exteriorLineInteriorPoint_(e,i,s){if(this.m_matrix[6]===0)return;const n=this.m_topoGraph.getClusterParentage(e);n&i||!(n&s)||(this.m_matrix[6]=0)}interiorPointInteriorPoint_(e,i,s){if(this.m_matrix[0]===0)return;const n=this.m_topoGraph.getClusterParentage(e);n&i&&n&s&&(this.m_matrix[0]=0)}interiorPointExteriorPoint_(e,i,s,n){if(this.m_matrix[n]===0)return;const r=this.m_topoGraph.getClusterParentage(e);!(r&i)||r&s||(this.m_matrix[n]=0)}computeMatrixTopoGraphHalfEdges_(e,i){let s=!1;const n=this.m_topoGraph.getGeometryID(e),r=this.m_topoGraph.getGeometryID(i);this.m_visitedIndex=this.m_topoGraph.createUserIndexForHalfEdges();for(let o=this.m_topoGraph.getFirstCluster();o!==G;o=this.m_topoGraph.getNextCluster(o)){const a=this.m_topoGraph.getClusterHalfEdge(o);if(a===G){if(this.m_predicatesCluster!==null&&(s=this.m_predicatesCluster(o,n,r),s))break;continue}let l=a;do{let u=l;if(this.m_topoGraph.getHalfEdgeUserIndex(u,this.m_visitedIndex)!==1)do{if(s=this.m_predicatesHalfEdge(u,n,r),s)break;this.m_topoGraph.setHalfEdgeUserIndex(u,this.m_visitedIndex,1),u=this.m_topoGraph.getHalfEdgeNext(u)}while(u!==l&&!s);if(s)break;l=this.m_topoGraph.getHalfEdgeNext(this.m_topoGraph.getHalfEdgeTwin(u))}while(l!==a);if(s)break}s||this.setRemainingPredicatesToFalse_(),this.m_topoGraph.deleteUserIndexForHalfEdges(this.m_visitedIndex)}computeMatrixTopoGraphClusters_(e,i){let s=!1;const n=this.m_topoGraph.getGeometryID(e),r=this.m_topoGraph.getGeometryID(i);for(let o=this.m_topoGraph.getFirstCluster();o!==G&&(s=this.m_predicatesCluster(o,n,r),!s);o=this.m_topoGraph.getNextCluster(o));s||this.setRemainingPredicatesToFalse_()}setEditShape_(e,i){this.m_topoGraph.setEditShape(e,i)}setEditShapeCrackAndCluster_(e,i,s){let n=0;if(e.hasCurves()){const r=new pu,o=e.getEnvelope2D(s),a=mu(i.total(),o);n=ud(a,0),nc(e,a,i.total(),12e3,r,null,s),r.clearStitcher(e)}Qh(e,i.add(n),s,!1,!1),e.filterClosePoints(0,!0,!0,!1,G);for(let r=e.getFirstGeometry();r!==G;r=e.getNextGeometry(r))e.getGeometryType(r)===q.enumPolygon&&bf(e,r,-1,!1,G,s);this.setEditShape_(e,s)}}function Ffe(t){const e=t[1],i=t[2],s=t[5];t[1]=t[3],t[2]=t[6],t[5]=t[7],t[3]=e,t[6]=i,t[7]=s}function Ree(t,e,i){const s=t.getGeometryType();if(nr(s)){const n=new Qi({vd:t.getDescription()});return n.addSegment(t,!0),n}if(s===q.enumEnvelope){const n=t,r=J.constructEmpty();if(t.queryEnvelope(r),r.height()<=e&&r.width()<=e){const a=new Jt({vd:t.getDescription()});return n.getCenter(a),a}if(r.height()<=e||r.width()<=e){const a=new Qi({vd:t.getDescription()}),l=new Jt;return n.queryCornerByVal(0,l),a.startPathPoint(l),n.queryCornerByVal(2,l),a.lineToPoint(l),a}const o=new Ci({vd:t.getDescription()});return o.addEnvelope(n,!1),o}return t}function zx(t){return`${t[0]}${t[3]}${t[6]}${t[1]}${t[4]}${t[7]}${t[2]}${t[5]}${t[8]}`}class Du{nullFunc(){return We("should not be called"),!1}constructor(e,i,s,n=!1){this.m_bDone=!1,this.m_tolerance=0,this.m_elementHandle=-1,this.m_query=J.constructEmpty(),this.m_envInter=J.constructEmpty(),this.m_quadTree=null,this.m_intersector=null,this.m_function=this.nullFunc;const r=e.getAccelerators();let o=null;r!=null&&(o=n?r.getQuadTreeForPaths():r.getQuadTree());const a=i.getAccelerators();let l=null;if(a!=null&&(l=n?a.getQuadTreeForPaths():a.getQuadTree()),o===null&&l===null&&!n){const u=e.getPointCount(),c=i.getPointCount();if(u>10&&c>10){const h=J.constructEmpty(),d=J.constructEmpty(),m=J.constructEmpty();e.queryLooseEnvelope(h),i.queryLooseEnvelope(d),h.inflateCoords(s,s),d.inflateCoords(s,s),m.setCoords({env2D:h}),m.intersect(d),u>=c?o=Ei(e.getGeometryType())?cS(e,m):hJ(e,m):l=Ei(i.getGeometryType())?cS(i,m):hJ(i,m)}}this.construct_(e,o,i,l,s,n)}next(){if(this.m_bQuadTree){if(this.m_bDone)return!1;for(;this.m_function(););return!this.m_bDone}return!!this.m_intersector&&this.m_intersector.next()}getRedElement(){return this.m_bQuadTree?this.m_bSwapElements?this.m_quadTree.getElement(this.m_elementHandle):Ei(this.m_queryType)?this.m_bPaths?this.m_pathIndex:this.m_segIter.getStartPointIndex():this.m_pointIndex:this.m_bSwapElements?this.m_intersector.getBlueElement(this.m_intersector.getHandleB()):this.m_intersector.getRedElement(this.m_intersector.getHandleA())}getBlueElement(){return this.m_bQuadTree?this.m_bSwapElements?Ei(this.m_queryType)?this.m_bPaths?this.m_pathIndex:this.m_segIter.getStartPointIndex():this.m_pointIndex:this.m_quadTree.getElement(this.m_elementHandle):this.m_bSwapElements?this.m_intersector.getRedElement(this.m_intersector.getHandleA()):this.m_intersector.getBlueElement(this.m_intersector.getHandleB())}getRedEnvelope(){return this.m_bPaths||un(""),this.m_bQuadTree?this.m_bSwapElements?this.m_quadTree.getElementExtent(this.m_elementHandle):this.m_query:this.m_bSwapElements?this.m_intersector.getBlueEnvelope(this.m_intersector.getHandleB()):this.m_intersector.getRedEnvelope(this.m_intersector.getHandleA())}getBlueEnvelope(){return this.m_bPaths||un(""),this.m_bQuadTree?this.m_bSwapElements?this.m_query:this.m_quadTree.getElementExtent(this.m_elementHandle):this.m_bSwapElements?this.m_intersector.getRedEnvelope(this.m_intersector.getHandleA()):this.m_intersector.getBlueEnvelope(this.m_intersector.getHandleB())}construct_(e,i,s,n,r,o){const a=J.constructEmpty(),l=J.constructEmpty();e.queryLooseEnvelope(a),s.queryLooseEnvelope(l),a.inflateCoords(r,r),l.inflateCoords(r,r),this.m_envInter.setCoords({env2D:a}),this.m_envInter.intersect(l),this.m_multiVertexImplA=e,this.m_multiVertexImplB=s;const u=e.getGeometryType(),c=s.getGeometryType();this.m_bPaths=o,this.m_pathIndex=-1,this.m_pointIndex=-1,this.m_bSwapElements=!1,this.m_queryType=q.enumUnknown,this.m_bQuadTree=!1,i!==null&&(this.m_bDone=!1,this.m_tolerance=r,this.m_quadTree=i,this.m_qtIter=this.m_quadTree.getIteratorForQT(),this.m_bQuadTree=!0,this.m_bSwapElements=!0,Ei(c)?(this.m_queryType=c,this.m_function=this.nextPath_,o?this.m_pathIndex=s.getPathCount():this.m_segIter=s.querySegmentIterator()):(this.m_queryType=c,this.m_function=this.nextPoint_,this.m_pointIndex=s.getPointCount())),this.m_bQuadTree||n!==null&&(this.m_bDone=!1,this.m_tolerance=r,this.m_quadTree=n,this.m_qtIter=this.m_quadTree.getIteratorForQT(),this.m_bQuadTree=!0,this.m_bSwapElements=!1,Ei(u)?(this.m_queryType=u,this.m_function=this.nextPath_,o?this.m_pathIndex=e.getPathCount():this.m_segIter=e.querySegmentIterator()):(this.m_queryType=u,this.m_function=this.nextPoint_,this.m_pointIndex=e.getPointCount())),this.m_bQuadTree||(o&&Ei(u)&&Ei(c)?this.m_intersector=sOe(e,s,r):Ei(u)&&Ei(c)?(this.m_intersector=iOe(e,s,r),this.m_bSwapElements=!1):Ei(u)&&!Ei(c)?(this.m_intersector=cJ(e,s,r),this.m_bSwapElements=!1):!Ei(u)&&Ei(c)?(this.m_intersector=cJ(s,e,r),this.m_bSwapElements=!0):(this.m_intersector=nOe(e,s,r),this.m_bSwapElements=!1))}nextPath_(){return this.m_bPaths?--this.m_pathIndex==-1?(this.m_bDone=!0,!1):(this.m_bSwapElements?this.m_multiVertexImplB.queryPathEnvelope(this.m_pathIndex,this.m_query):this.m_multiVertexImplA.queryPathEnvelope(this.m_pathIndex,this.m_query),this.m_qtIter.resetIterator(this.m_query,this.m_tolerance),this.m_function=this.iterate_,!0):this.m_segIter.nextPath()?(this.m_function=this.nextSegment_,!0):(this.m_bDone=!0,!1)}nextSegment_(){if(!this.m_segIter.hasNextSegment())return this.m_function=this.nextPath_,!0;const e=this.m_segIter.nextSegment(),i=new J;return e.queryLooseEnvelope(i),!i.isIntersecting(this.m_envInter)||(this.m_qtIter.resetIterator(e,this.m_tolerance),this.m_function=this.iterate_,!0)}nextPoint_(){if(--this.m_pointIndex==-1)return this.m_bDone=!0,!1;const e=new N;if(this.m_bSwapElements){const i=this.m_multiVertexImplB.getXY(this.m_pointIndex);e.setCoordsPoint2D(i)}else{const i=this.m_multiVertexImplA.getXY(this.m_pointIndex);e.setCoordsPoint2D(i)}return!this.m_envInter.contains(e)||(this.m_qtIter.resetIterator(J.construct(e.x,e.y,e.x,e.y),this.m_tolerance),this.m_function=this.iterate_,!0)}iterate_(){return this.m_elementHandle=this.m_qtIter.next(),this.m_elementHandle===-1&&(Ei(this.m_queryType)?(this.m_function=this.m_bPaths?this.nextPath_:this.nextSegment_,!0):(this.m_function=this.nextPoint_,!0))}}function HU(t){return t===2?1:t===1?2:t===128?64:t===64?128:t}function yke(t,e,i){let s;if(t instanceof Wf||t===null){const n=J.constructEmpty();n.setCoords({pt:e}),n.mergeEnvelope2D(i),s=Vy(t,n,!1)}else s=t;return s}function kfe(t,e,i){let s;if(t instanceof Wf||t===null){const n=J.constructEmpty();n.setCoords({env2D:e}),n.mergeEnvelope2D(i),s=Vy(t,n,!1)}else s=t;return s}function _f(t,e,i,s,n){if(t.isEmpty()||e.isEmpty())return s===4;Um(t),Um(e);let r=t.getGeometryType(),o=e.getGeometryType();if(r===q.enumEnvelope){if(o===q.enumEnvelope)return vke(t,e,i,s);if(o===q.enumPoint)return Oee(e,t,i,HU(s))}else if(r===q.enumPoint){if(o===q.enumEnvelope)return Oee(t,e,i,s);if(o===q.enumPoint)return xke(t,e,i,s)}const a=J.constructEmpty();t.queryEnvelope(a);const l=J.constructEmpty();e.queryEnvelope(l);const u=kfe(i,a,l);if(Ym(a,l,u))return s===4;let c=!1,h=null,d=null,m=null,f=null;switch(nr(r)?(h=new Qi({vd:t.getDescription()}),h.addSegment(t,!0),m=h,r=q.enumPolyline):m=t,nr(o)?(d=new Qi({vd:e.getDescription()}),d.addSegment(e,!0),f=d,o=q.enumPolyline):f=e,r!==q.enumEnvelope&&o!==q.enumEnvelope?(m.getDimension()<f.getDimension()||r===q.enumPoint&&o===q.enumMultiPoint)&&(s=HU(s)):r!==q.enumPolygon&&o!==q.enumEnvelope&&(s=HU(s)),r){case q.enumPolygon:switch(o){case q.enumPolygon:c=bke(m,f,u,s,n);break;case q.enumPolyline:c=Lee(m,f,u,s,n);break;case q.enumPoint:c=Fee(m,f,u,s);break;case q.enumMultiPoint:c=kee(m,f,u,s);break;case q.enumEnvelope:c=$ee(m,f,u,s,n)}break;case q.enumPolyline:switch(o){case q.enumPolygon:c=Lee(f,m,u,s,n);break;case q.enumPolyline:c=wke(m,f,u,s,n);break;case q.enumPoint:c=Uee(m,f,u,s);break;case q.enumMultiPoint:c=Vee(m,f,u,s);break;case q.enumEnvelope:c=zee(m,f,u,s,n)}break;case q.enumPoint:switch(o){case q.enumPolygon:c=Fee(f,m,u,s);break;case q.enumPolyline:c=Uee(f,m,u,s);break;case q.enumMultiPoint:c=Gee(f,m,u,s)}break;case q.enumMultiPoint:switch(o){case q.enumPolygon:c=kee(f,m,u,s);break;case q.enumPolyline:c=Vee(f,m,u,s);break;case q.enumMultiPoint:c=Ske(m,f,u,s);break;case q.enumPoint:c=Gee(m,f,u,s);break;case q.enumEnvelope:c=Bee(m,f,u,s)}break;case q.enumEnvelope:switch(o){case q.enumPolygon:c=$ee(f,m,u,s,n);break;case q.enumPolyline:c=zee(f,m,u,s,n);break;case q.enumMultiPoint:c=Bee(f,m,u,s)}}return c}function vke(t,e,i,s,n){if(t.isEmpty()||e.isEmpty())return s===4;const r=J.constructEmpty();t.queryEnvelope(r);const o=J.constructEmpty();e.queryEnvelope(o);const a=kfe(i,r,o);switch(s){case 4:return Ym(r,o,a);case 2:return HD(o,r,a,!1);case 128:return HD(o,r,a,!0);case 1:return HD(r,o,a,!1);case 64:return HD(r,o,a,!0);case 3:return Xf(r,o,a);case 8:return g$e(r,o,a);case 32:return _$e(r,o,a);case 16:return!1}return!1}function Oee(t,e,i,s,n){if(t.isEmpty()||e.isEmpty())return s===4;const r=t.getXY(),o=J.constructEmpty();e.queryEnvelope(o);const a=yke(i,r,o);switch(s){case 4:return c4(r,o,a);case 2:case 128:return f$e(r,o,a);case 1:case 64:return!1;case 3:return m$e(r,o,a);case 8:return p$e(r,o,a)}return!1}function xke(t,e,i,s,n){if(t.isEmpty()||e.isEmpty())return s===4;const r=t.getXY(),o=e.getXY();let a;if(i instanceof Wf||i===null){const l=J.constructEmpty();l.setCoords({pt:r}),l.merge(o),a=Vy(i,l,!1)}else a=i;switch(s){case 4:return d$e(r,o,a);case 2:case 128:return Jee(o,r,a);case 1:case 64:return Jee(r,o,a);case 3:return Gfe(r,o,a)}return!1}function Ym(t,e,i){const s=J.constructEmpty();return s.setCoords({env2D:e}),s.inflateCoords(i,i),!t.isIntersecting(s)}function _s(t,e,i,s=!1){const n=t.getGeometryType(),r=e.getGeometryType();if(ll(n)){const o=t.getImpl().getAccelerators();if(o!==null){const a=o.getRasterizedGeometry();z(a===null)}}if(ll(r)){const o=e.getImpl().getAccelerators();if(o!==null){const a=o.getRasterizedGeometry();z(a===null)}}return 0}function c4(t,e,i,s){const n=J.constructEmpty();return n.setCoords({env2D:e}),n.inflateCoords(i,i),!n.contains(t)}function bke(t,e,i,s,n){switch(s){case 4:return Eke(t,e,i);case 2:return qee(e,t,i,n);case 128:return Hee(e,t,i);case 1:return qee(t,e,i,n);case 64:return Hee(t,e,i);case 3:return $fe(t,e,i,n);case 8:return Cke(t,e,i);case 32:return Tke(t,e,i,n)}return!1}function Lee(t,e,i,s,n){switch(s){case 4:return Pke(t,e,i);case 1:return Ake(t,e,i,n);case 64:return Ike(t,e,i);case 8:return Ufe(t,e,i,n);case 16:return Mke(t,e,i)}return!1}function Fee(t,e,i,s,n){switch(s){case 4:return Dke(t,e,i);case 1:case 64:return Rke(t,e,i);case 8:return Nke(t,e,i)}return!1}function kee(t,e,i,s,n){switch(s){case 4:return Oke(t,e,i);case 1:return jee(t,e,i,!1);case 64:return jee(t,e,i,!0);case 8:return Lke(t,e,i);case 16:return Fke(t,e,i)}return!1}function $ee(t,e,i,s,n){if($ke(t,e,i))return s===4;if(s===4)return!1;switch(s){case 2:return Yee(t,e,i,!1);case 128:return Yee(t,e,i,!0);case 1:return Xee(t,e,i,!1,n);case 64:return Xee(t,e,i,!0,n);case 3:return kke(t,e,i,n);case 8:return Uke(t,e,i,n);case 32:return Vke(t,e,i,n);case 16:return!1}return!1}function wke(t,e,i,s,n){switch(s){case 4:return Gke(t,e,i);case 2:return Wee(e,t,i,n);case 128:return Zee(e,t,i,n);case 1:return Wee(t,e,i,n);case 64:return Zee(t,e,i,n);case 3:return zke(t,e,i,n);case 8:return Bke(t,e,i,n);case 32:return Hke(t,e,i,n);case 16:return qke(t,e,i,n)}return!1}function Uee(t,e,i,s,n){switch(s){case 4:return jke(t,e,i);case 1:case 64:return Xke(t,e,i);case 8:return Yke(t,e,i)}return!1}function Vee(t,e,i,s,n){switch(s){case 4:return Wke(t,e,i);case 1:case 64:return Qke(t,e,i);case 8:return Zke(t,e,i);case 16:return Kke(t,e,i)}return!1}function zee(t,e,i,s,n){if(e$e(t,e,i))return s===4;if(s===4)return!1;switch(s){case 2:return Kee(t,e,i,!1);case 128:return Kee(t,e,i,!0);case 1:case 64:case 32:return!1;case 3:return Jke(t,e,i);case 8:return t$e(t,e,i,n);case 16:return i$e(t,e,i)}return!1}function Ske(t,e,i,s,n){switch(s){case 4:return n$e(t,e,i);case 2:case 128:return T1(e,t,i);case 1:case 64:return T1(t,e,i);case 3:return s$e(t,e,i);case 32:return r$e(t,e,i)}return!1}function Gee(t,e,i,s,n){switch(s){case 4:return zfe(t,e,i);case 2:case 128:return o$e(t,e,i);case 1:case 64:return a$e(t,e,i);case 3:return Vfe(t,e,i)}return!1}function Bee(t,e,i,s,n){switch(s){case 4:return u$e(t,e,i);case 2:return Qee(t,e,i,!1);case 128:return Qee(t,e,i,!0);case 1:case 64:return!1;case 3:return l$e(t,e,i);case 8:return c$e(t,e,i);case 16:return h$e(t,e,i)}return!1}function $fe(t,e,i,s){const n=J.constructEmpty(),r=J.constructEmpty();if(t.queryEnvelope(n),e.queryEnvelope(r),!Xf(n,r,i))return!1;if(_s(t,e),qfe(t,e,i))return!0;const o=t.calculateLength2D(),a=e.calculateLength2D(),l=Math.max(t.getPointCount(),e.getPointCount());return Math.abs(o-a)>4*l*i?!1:t.hasNonLinearSegments()||e.hasNonLinearSegments()?fc(t,e,i,"**F**FFF*",s,!1):Hfe(t,e,i,!0)}function Eke(t,e,i,s){return _s(t,e,i,!0),fA(t,e,i,!0)===1}function Cke(t,e,i,s){return _s(t,e),Zfe(t,e,i,null)}function Tke(t,e,i,s){return _s(t,e),Kfe(t,e,i,s)}function qee(t,e,i,s){const n=J.constructEmpty(),r=J.constructEmpty();return t.queryEnvelope(n),e.queryEnvelope(r),!!Mr(n,r,i)&&(_s(t,e),Qfe(t,e,i,s))}function Hee(t,e,i,s){const n=J.constructEmpty(),r=J.constructEmpty();return t.queryEnvelope(n),e.queryEnvelope(r),!!Mr(n,r,i)&&(_s(t,e),fA(t,e,i,!1)===2)}function Pke(t,e,i,s){return _s(t,e,i,!0),fA(t,e,i,!0)===1}function Ufe(t,e,i,s){return _s(t,e),b$e(t,e,i,s)}function Mke(t,e,i,s){return _s(t,e),w$e(t,e,i,null)}function Ake(t,e,i,s){const n=J.constructEmpty(),r=J.constructEmpty();return t.queryEnvelope(n),e.queryEnvelope(r),!!Mr(n,r,i)&&(_s(t,e),S$e(t,e,i,s))}function Ike(t,e,i,s){const n=J.constructEmpty(),r=J.constructEmpty();return t.queryEnvelope(n),e.queryEnvelope(r),!!Mr(n,r,i)&&(_s(t,e),fA(t,e,i,!1)===2)}function Dke(t,e,i,s){return tge(t,e,i)===0}function Nke(t,e,i,s){return C$e(t,e.getXY(),i)}function Rke(t,e,i,s){return E$e(t,e.getXY(),i)}function Oke(t,e,i,s,n){return _s(t,e),y$e(t,e,i)===1}function Lke(t,e,i,s){_s(t,e);const n=J.constructEmpty();t.queryEnvelope(n),n.inflateCoords(i,i);const r=new N;let o=!1;const a=t.getImpl(),l=new Ci;let u=t,c=!1;for(let h=0;h<e.getPointCount();h++){if(e.queryXY(h,r),n.contains(r)){const d=ul(u,r,i);if(d===2)o=!0;else if(d===1)return!1}c||(!Sy(t,e.getPointCount()-1)||a.getAccelerators()!==null&&a.getAccelerators().getQuadTree()!==null?u=t:(t.copyTo(l),l.getImpl().buildQuadTreeAccelerator(1),u=l),c=!0)}return!!o}function Fke(t,e,i,s){_s(t,e);const n=new J,r=new J,o=new J;t.queryEnvelope(n),e.queryEnvelope(o),r.setCoords({env2D:n}),r.inflateCoords(i,i);let a=!1,l=!1;const u=new N,c=t.getImpl(),h=new Ci;let d=t,m=!1;for(let f=0;f<e.getPointCount();f++){if(e.queryXY(f,u),r.contains(u)){const _=ul(d,u,i);_===0?l=!0:_===1&&(a=!0)}else l=!0;if(a&&l)return!0;m||(!Sy(t,e.getPointCount()-1)||c.getAccelerators()!==null&&c.getAccelerators().getQuadTree()!==null?d=t:(t.copyTo(h),h.getImpl().buildQuadTreeAccelerator(1),d=h),m=!0)}return!1}function jee(t,e,i,s,n){const r=J.constructEmpty(),o=J.constructEmpty();if(t.queryEnvelope(r),e.queryEnvelope(o),!Mr(r,o,i))return!1;_s(t,e);let a=!1;const l=new N,u=t.getImpl(),c=new Ci;let h=t,d=!1;for(let m=0;m<e.getPointCount();m++){if(e.queryXY(m,l),!r.contains(l))return!1;const f=ul(h,l,i);if(f===1)a=!0;else if(f===0)return!1;if(s&&f===2)return!1;d||(!Sy(t,e.getPointCount()-1)||u.getAccelerators()!==null&&u.getAccelerators().getQuadTree()!==null?h=t:(t.copyTo(c),c.getImpl().buildQuadTreeAccelerator(1),h=c),d=!0)}return a}function kke(t,e,i,s){const n=new J,r=new J;if(t.queryEnvelope(n),e.queryEnvelope(r),!Xf(n,r,i))return!1;const o=new Ci;return o.addEnvelope(e,!1),$fe(t,o,i,s)}function $ke(t,e,i,s){_s(t,e);const n=J.constructEmpty(),r=J.constructEmpty();return t.queryEnvelope(n),e.queryEnvelope(r),Mr(r,n,i)?!1:ul(t,r.getLowerLeft(),0)===0&&!r.contains(t.getXY(0))&&!Wfe(t,r,i)}function Uke(t,e,i,s){_s(t,e);const n=new J,r=new J;if(t.queryEnvelope(n),e.queryEnvelope(r),Mr(r,n,i)||r.height()<=i||r.width()<=i)return!1;const o=new Ci;return o.addEnvelope(e,!1),Zfe(t,o,i,s)}function Vke(t,e,i,s){_s(t,e);const n=new J,r=new J;if(t.queryEnvelope(n),e.queryEnvelope(r),Mr(r,n,i)||r.height()<=i||r.width()<=i)return!1;const o=new Ci;return o.addEnvelope(e,!1),Kfe(t,o,i,s)}function Yee(t,e,i,s,n){const r=J.constructEmpty(),o=J.constructEmpty();return t.queryEnvelope(r),e.queryEnvelope(o),s?h4(o,r,i):Mr(o,r,i)}function Xee(t,e,i,s,n){const r=J.constructEmpty(),o=J.constructEmpty();if(t.queryEnvelope(r),e.queryEnvelope(o),!Mr(r,o,i))return!1;_s(t,e);const a=new Ci;return a.addEnvelope(e,!1),s?fA(t,a,i,!1)===2:Qfe(t,a,i,n)}function zke(t,e,i,s){const n=J.constructEmpty(),r=J.constructEmpty();return t.queryEnvelope(n),e.queryEnvelope(r),Xf(n,r,i)?(_s(t,e),qfe(t,e,i)?!0:t.hasNonLinearSegments()||e.hasNonLinearSegments()?fc(t,e,i,"**F**FFF*",s,!1):Hfe(t,e,i,!1)):!1}function Gke(t,e,i,s){_s(t,e);const n=t.getImpl(),r=e.getImpl();return!new Du(n,r,i,!0).next()||!jfe(t,e,i)}function Bke(t,e,i,s){_s(t,e);const n=[],r=lj(t,e,i,n);if(r===-2){const u=J.constructEmpty(),c=J.constructEmpty(),h=J.constructEmpty();let d,m;if(t.queryEnvelope(u),e.queryEnvelope(c),u.inflateCoords(1e3*i,1e3*i),c.inflateCoords(1e3*i,1e3*i),h.setCoords({env2D:u}),h.intersect(c),t.getPointCount()>10){if(d=Is(t,h,i,0,s),d.isEmpty())return!1}else d=t;if(e.getPointCount()>10){if(m=Is(e,h,i,0,s),m.isEmpty())return!1}else m=e;return fc(d,m,i,"F********",s,!1)}if(r!==0)return!1;const o=new Dn;for(let u=0;u<n.length;u+=2){const c=n[u],h=n[u+1];o.addXY(c,h)}const a=t.getBoundary(),l=e.getBoundary();return a.addPoints(l,0,l.getPointCount()),!a.isEmpty()&&T1(a,o,i)}function qke(t,e,i,s){_s(t,e);const n=[],r=lj(t,e,i,n);if(r===-2){const u=J.constructEmpty(),c=J.constructEmpty(),h=J.constructEmpty();let d,m;if(t.queryEnvelope(u),e.queryEnvelope(c),u.inflateCoords(1e3*i,1e3*i),c.inflateCoords(1e3*i,1e3*i),h.setCoords({env2D:u}),h.intersect(c),t.getPointCount()>10){if(d=Is(t,h,i,0,s),d.isEmpty())return!1}else d=t;if(e.getPointCount()>10){if(m=Is(e,h,i,0,s),m.isEmpty())return!1}else m=e;return fc(d,m,i,"0********",s,!1)}if(r!==0)return!1;const o=new Dn;for(let u=0;u<n.length;u+=2){const c=n[u],h=n[u+1];o.addXY(c,h)}const a=t.getBoundary(),l=e.getBoundary();return a.addPoints(l,0,l.getPointCount()),!!a.isEmpty()||!T1(a,o,i)}function Hke(t,e,i,s){_s(t,e);const n=J.constructEmpty(),r=J.constructEmpty();t.queryEnvelope(n),e.queryEnvelope(r);const o=nM(n,r,i),a=nM(r,n,i),l=t.hasNonLinearSegments(),u=e.hasNonLinearSegments(),c=lj(t,e,i,null);if(c===-1)return!1;if(c===1){if(o&&a)return!0;if(!l&&!u)return o&&!a?!$v(e,t,i,!1):a&&!o?!$v(t,e,i,!1):!$v(t,e,i,!1)&&!$v(e,t,i,!1)}const h=J.constructEmpty(),d=J.constructEmpty(),m=J.constructEmpty();let f,_;h.setCoords({env2D:n}),h.inflateCoords(1e3*i,1e3*i),d.setCoords({env2D:r}),d.inflateCoords(1e3*i,1e3*i),m.setCoords({env2D:h}),m.intersect(d);let v="";if(v+="1*",o){if(e.getPointCount()>10){if(_=Is(e,m,i,0,s),_.isEmpty())return!1}else _=e;v+="****"}else _=e,v+="T***";if(a){if(t.getPointCount()>10){if(f=Is(t,m,i,0,s),f.isEmpty())return!1}else f=t;v+="***"}else f=t,v+="T**";return fc(f,_,i,v,s,!1)}function Wee(t,e,i,s){const n=J.constructEmpty(),r=J.constructEmpty();return t.queryEnvelope(n),e.queryEnvelope(r),Mr(n,r,i)?(_s(t,e),t.hasNonLinearSegments()||e.hasNonLinearSegments()?fc(t,e,i,"******FF*",s,!1):$v(e,t,i,!1)):!1}function Zee(t,e,i,s){const n=J.constructEmpty(),r=J.constructEmpty();return t.queryEnvelope(n),e.queryEnvelope(r),Mr(n,r,i)?(_s(t,e),fc(t,e,i,"T**FF*FF*",s,!1)):!1}function jke(t,e,i,s){return _s(t,e),!Xfe(t,e.getXY(),i)}function Yke(t,e,i,s){return _s(t,e),ege(t,e.getXY(),i)}function Xke(t,e,i,s){return _s(t,e),x$e(t,e.getXY(),i)}function Wke(t,e,i,s){return _s(t,e),!Yfe(t,e,i,!1)}function Zke(t,e,i,s){_s(t,e);const n=t.getImpl(),r=e.getImpl(),o=new Dn,a=new Du(n,r,i,!1),l=n.querySegmentIterator();let u=!1;for(;a.next();){const h=a.getRedElement(),d=a.getBlueElement();l.resetToVertex(h,-1);const m=l.nextSegment(),f=r.getXY(d);m.isIntersectingPoint(f,i)&&(u=!0,o.addPoint2D(f))}if(!u)return!1;const c=t.getBoundary();return!c.isEmpty()&&T1(c,o,i)}function Kke(t,e,i,s){_s(t,e);const n=t.getImpl(),r=e.getImpl(),o=r.getPointCount(),a=st(o,!1),l=new Du(n,r,i,!1),u=n.querySegmentIterator();let c=!1;for(;l.next();){const f=l.getRedElement(),_=l.getBlueElement();u.resetToVertex(f,-1);const v=u.nextSegment(),x=r.getXY(_);v.isIntersectingPoint(x,i)&&(c=!0,a[_]=!0)}if(!c)return!1;let h=!1;for(let f=0;f<o;f++)if(!a[f]){h=!0;break}if(!h)return!1;const d=t.getBoundary();if(d.isEmpty())return!0;const m=new Dn;for(let f=0;f<o;f++)a[f]&&m.addPoint2D(r.getXY(f));return!T1(d,m,i)}function Qke(t,e,i,s,n){const r=J.constructEmpty(),o=J.constructEmpty();if(t.queryEnvelope(r),e.queryEnvelope(o),!Mr(r,o,i))return!1;_s(t,e);const a=Yfe(t,e,i,!0);if(!a)return a;const l=t.getBoundary();return l.isEmpty()?a:!T1(l,e,i)}function Jke(t,e,i,s){const n=new J,r=new J;return t.queryEnvelope(n),e.queryEnvelope(r),!(r.height()>i&&r.width()>i)&&Xf(n,r,i)}function e$e(t,e,i,s){const n=J.constructEmpty(),r=J.constructEmpty();t.queryEnvelope(n),e.queryEnvelope(r);const o=T$e(r,n,i);return o===0?!Wfe(t,r,i):o===4}function t$e(t,e,i,s){const n=new J,r=new J;if(t.queryEnvelope(n),e.queryEnvelope(r),r.height()<=i||r.width()<=i)return!1;const o=new J,a=new J;if(o.setCoords({env2D:r}),a.setCoords({env2D:r}),o.inflateCoords(i,i),a.inflateCoords(-i,-i),a.containsEnvelope(n)||!n.isIntersecting(o))return!1;const l=t.getImpl().querySegmentIterator();l.stripAttributes();const u=t.getImpl().getAccelerators();let c=null,h=null;u!==null&&(c=u.getQuadTree(),c!==null&&(h=c.getIterator(r,i))),h||l.nextPath()||We("relational_operations");let d=!1,m=null;const f=new N,_=new N,v=t.hasNonLinearSegments();let x=!1;for(;;){if(h!==null){const T=h.next();if(T===-1)break;l.resetToVertex(c.getElement(T),-1),m=l.nextSegment()}else{for(;!l.hasNextSegment()&&l.nextPath(););if(!l.hasNextSegment())break;m=l.nextSegment()}if(v&&m.getGeometryType()!==q.enumLine){const T=new J;if(m.queryEnvelope(T),a.containsEnvelope(T))return!1;if(o.isIntersecting(T)){x=!0;break}}else{f.assign(m.getStartXY()),_.assign(m.getEndXY());let T=a.clipLine(f,_);if(T!==0)return!1;d||(T=o.clipLine(f,_),T!==0&&(d=!0))}}if(!x)return d;const w=new Ci;return w.addEnvelope(r,!1),Ufe(w,t,i,s)}function Kee(t,e,i,s,n){const r=J.constructEmpty(),o=J.constructEmpty();if(t.queryEnvelope(r),e.queryEnvelope(o),o.height()<=i||o.width()<=i)return!1;if(s)return h4(o,r,i);if(!Mr(o,r,i))return!1;const a=J.constructEmpty();a.setCoords({env2D:o}),a.inflateCoords(-i,-i);const l=J.constructEmpty();if(l.setCoords({env2D:o}),l.inflateCoords(i,i),a.containsEnvelope(r))return!0;const u=t.getImpl().querySegmentIterator();u.stripAttributes(),u.nextPath()||We("relational_operations");let c,h,d,m,f,_,v=!1;const x=t.hasNonLinearSegments();for(x&&(d=new mi,m=new mi,f=new mi,_=new mi,a.querySide(0,d),a.querySide(1,m),a.querySide(2,f),a.querySide(3,_));;){for(;!u.hasNextSegment()&&u.nextPath(););if(!u.hasNextSegment())break;const w=u.nextSegment();if(x&&w.getGeometryType()!==q.enumLine){if(w.isIntersecting(d,i)){v=!0;break}if(w.isIntersecting(m,i)){v=!0;break}if(w.isIntersecting(f,i)){v=!0;break}if(w.isIntersecting(_,i)){v=!0;break}}else if(c=w.getStartXY(),h=w.getEndXY(),a.clipLine(c,h)!==0){v=!0;break}}return v}function i$e(t,e,i,s){const n=new J,r=new J;if(t.queryEnvelope(n),e.queryEnvelope(r),r.height()<=i||r.width()<=i)return!1;const o=new J;if(o.setCoords({env2D:r}),o.inflateCoords(i,i),o.containsEnvelope(n))return!1;const a=!0,l=new J;if(l.setCoords({env2D:r}),l.inflateCoords(-i,-i),!l.isIntersecting(n))return!1;const u=t.getImpl().querySegmentIterator();u.stripAttributes();const c=t.getImpl().getAccelerators();let h=null,d=null;if(c!==null&&(h=c.getQuadTree(),h!==null&&(d=h.getIterator(r,i))),!d){const M=u.nextPath();z(M)}let m=!1,f=null;const _=new N,v=new N;let x=null,w=null,T=null,C=null;for(t.hasNonLinearSegments()&&(x=new mi,w=new mi,T=new mi,C=new mi,l.querySide(0,x),l.querySide(1,w),l.querySide(2,T),l.querySide(3,C));;){if(d!==null){const M=d.next();if(M===-1)break;u.resetToVertex(h.getElement(M),-1),f=u.nextSegment()}else{for(;!u.hasNextSegment()&&u.nextPath(););if(!u.hasNextSegment())break;f=u.nextSegment()}if(f.getGeometryType()===q.enumLine){if(_.assign(f.getStartXY()),v.assign(f.getEndXY()),l.clipLine(_,v)!==0){m=!0;break}}else{if(x.isIntersecting(f,i)){m=!0;break}if(w.isIntersecting(f,i)){m=!0;break}if(T.isIntersecting(f,i)){m=!0;break}if(C.isIntersecting(f,i)){m=!0;break}}}return m&&a}function s$e(t,e,i,s){const n=J.constructEmpty(),r=J.constructEmpty();return t.queryEnvelope(n),e.queryEnvelope(r),!!Xf(n,r,i)&&(!!v$e(t,e,i)||aj(t,e,i,!1,!0,!1))}function n$e(t,e,i,s){const n=t,r=e,o=new Du(n,r,i,!1),a=i*i,l=new N,u=new N;for(;o.next();){const c=o.getRedElement(),h=o.getBlueElement();if(n.queryXY(c,l),r.queryXY(h,u),N.sqrDistance(l,u)<=a)return!1}return!0}function r$e(t,e,i,s){return aj(t,e,i,!1,!1,!0)}function T1(t,e,i,s){const n=J.constructEmpty(),r=J.constructEmpty();return t.queryEnvelope(n),e.queryEnvelope(r),!!Mr(n,r,i)&&aj(e,t,i,!0,!1,!1)}function Vfe(t,e,i,s){const n=J.constructEmpty(),r=J.constructEmpty();return t.queryEnvelope(n),e.queryEnvelope(r),Xf(n,r,i)}function zfe(t,e,i,s){return Jfe(t,e.getXY(),i)}function o$e(t,e,i,s){return Vfe(t,e,i)}function a$e(t,e,i,s){return!zfe(t,e,i)}function l$e(t,e,i,s){const n=new J,r=new J;return t.queryEnvelope(n),e.queryEnvelope(r),!(r.height()>i||r.width()>i)&&Xf(n,r,i)}function u$e(t,e,i,s){const n=J.constructEmpty(),r=J.constructEmpty();if(t.queryEnvelope(n),e.queryEnvelope(r),Mr(r,n,i))return!1;const o=J.constructEmpty();o.setCoords({env2D:r}),o.inflateCoords(i,i);const a=new N;for(let l=0;l<t.getPointCount();l++)if(t.queryXY(l,a),o.contains(a))return!1;return!0}function c$e(t,e,i,s){const n=new J,r=new J,o=new J;if(e.queryEnvelope(n),n.height()<=i||n.width()<=i)return!1;r.setCoords({env2D:n}),o.setCoords({env2D:n}),r.inflateCoords(i,i),o.inflateCoords(-i,-i);const a=new N;let l=!1;for(let u=0;u<t.getPointCount();u++)if(t.queryXY(u,a),r.contains(a)){if(o.containsExclusive(a))return!1;l=!0}return l}function Qee(t,e,i,s,n){const r=J.constructEmpty(),o=J.constructEmpty();if(t.queryEnvelope(r),e.queryEnvelope(o),o.height()<=i||o.width()<=i)return!1;if(s)return h4(o,r,i);if(!Mr(o,r,i))return!1;let a=!1;const l=J.constructEmpty(),u=J.constructEmpty();l.setCoords({env2D:o}),u.setCoords({env2D:o}),l.inflateCoords(-i,-i),u.inflateCoords(i,i);const c=new N;for(let h=0;h<t.getPointCount();h++){if(t.queryXY(h,c),!u.contains(c))return!1;l.containsExclusive(c)&&(a=!0)}return a}function h$e(t,e,i,s){const n=new J,r=new J;if(t.queryEnvelope(n),e.queryEnvelope(r),Mr(r,n,i)||r.height()<=i||r.width()<=i)return!1;const o=new J,a=new J;o.setCoords({env2D:r}),o.inflateCoords(-i,-i),a.setCoords({env2D:r}),a.inflateCoords(i,i);const l=new N;let u=!1,c=!1;for(let h=0;h<t.getPointCount();h++)if(t.queryXY(h,l),!u&&o.containsExclusive(l)&&(u=!0),c||a.contains(l)||(c=!0),u&&c)return!0;return!1}function Gfe(t,e,i,s){return N.sqrDistance(t,e)<=i*i}function d$e(t,e,i,s){return N.sqrDistance(t,e)>i*i}function Jee(t,e,i,s){return Gfe(t,e,i)}function m$e(t,e,i,s){const n=new J;return n.setCoords({pt:t}),Xf(n,e,i)}function p$e(t,e,i,s){if(e.height()<=i||e.width()<=i)return!1;const n=new J,r=new J;return n.setCoords({env2D:e}),n.inflateCoords(i,i),!!n.contains(t)&&(r.setCoords({env2D:e}),r.inflateCoords(-i,-i),!r.containsExclusive(t))}function f$e(t,e,i,s){if(e.height()<=i||e.width()<=i)return!1;const n=J.constructEmpty();return n.setCoords({env2D:e}),n.inflateCoords(-i,-i),n.containsExclusive(t)}function Xf(t,e,i,s){return Mr(t,e,i)&&Mr(e,t,i)}function g$e(t,e,i,s){if(t.height()<=i||t.width()<=i||e.height()<=i||e.width()<=i)return!1;const n=new J;return n.setCoords({env2D:t}),n.inflateCoords(-i,-i),n.intersect(e),!(!n.isEmpty()&&n.height()>i&&n.width()>i)&&(n.setCoords({env2D:t}),n.inflateCoords(i,i),n.intersect(e),!n.isEmpty())}function _$e(t,e,i,s){if(t.height()<=i||t.width()<=i||e.height()<=i||e.width()<=i||Mr(t,e,i)||Mr(e,t,i))return!1;const n=new J;return n.setCoords({env2D:t}),n.inflateCoords(-i,-i),n.intersect(e),!n.isEmpty()&&(n.height()>i||n.width()>i)}function HD(t,e,i,s,n){if(t.height()<=i||t.width()<=i)return!1;if(s)return h4(t,e,i);if(!Mr(t,e,i))return!1;const r=J.constructEmpty();return r.setCoords({env2D:t}),r.inflateCoords(-i,-i),r.intersect(e),!r.isEmpty()}function fA(t,e,i,s,n){const r=new N,o=new N,a=J.constructEmpty(),l=J.constructEmpty(),u=t.getImpl(),c=e.getImpl(),h=c.getGeometryType(),d=new Du(u,c,i,!0);if(!d.next())return 1;if(jfe(t,e,i))return s?4:0;const m=new Ci;let f=t;const _=new Ci;let v=null;h===q.enumPolygon&&(v=e);const x=h===q.enumPolygon?st(u.getPathCount(),!1):[],w=st(c.getPathCount(),!1);let T=!1,C=!1,M=!1,A=!1,I=!1,L=!1;do{if(M&&I||A&&L||M&&A)break;const D=d.getRedElement(),O=d.getBlueElement();if(!w[O]&&(o.assign(e.getXY(e.getPathStart(O))),a.setCoords({env2D:d.getRedEnvelope()}),a.inflateCoords(i,i),a.contains(o))){if(ul(f,o,0)!==0){if(A=!0,s)return 4}else L=!0;w[O]=!0}if(h===q.enumPolygon&&!x[D]&&(r.assign(t.getXY(t.getPathStart(D))),l.setCoords({env2D:d.getBlueEnvelope()}),l.inflateCoords(i,i),l.contains(r))){if(ul(v,r,0)!==0){if(M=!0,s)return 4}else I=!0;x[D]=!0}if(T||(!Sy(t,e.getPathCount()-1)||u.getAccelerators()!==null&&u.getAccelerators().getQuadTree()!==null?f=t:(t.copyTo(m),m.getImpl().buildQuadTreeAccelerator(1),f=m),T=!0),h===q.enumPolygon&&!C){const U=e;!Sy(U,t.getPathCount()-1)||c.getAccelerators()!==null&&c.getAccelerators().getQuadTree()!==null?v=e:(U.copyTo(_),_.getImpl().buildQuadTreeAccelerator(1),v=_),C=!0}}while(d.next());if(!M&&!A)return 1;if(!I||!L){if(h===q.enumPolygon){for(let D=0,O=u.getPathCount();D<O;D++)if(!x[D]){I=!0;break}}for(let D=0,O=c.getPathCount();D<O;D++)if(!w[D]){L=!0;break}}return M&&I||A&&L||M&&A?4:A?2:3}function y$e(t,e,i,s,n){const r=J.constructEmpty();t.queryEnvelope(r),r.inflateCoords(i,i);const o=new N,a=t.getImpl(),l=new Ci;let u=t,c=!1,h=!1,d=!1;for(let m=0;m<e.getPointCount();m++){if(e.queryXY(m,o),r.contains(o)){const f=ul(u,o,i);if(f===1)return h=!0,4;if(f===2)return 4;d=!0}else d=!0;c||(!Sy(t,e.getPointCount()-1)||a.getAccelerators()!==null&&a.getAccelerators().getQuadTree()!=null?u=t:(t.copyTo(l),l.getImpl().buildQuadTreeAccelerator(1),u=l),c=!0)}return h?d?4:2:1}function Bfe(t,e,i,s,n){s[0]=!1;const r=t.getImpl(),o=e.getImpl(),a=r.querySegmentIterator(),l=o.querySegmentIterator(),u=[0,0],c=[0,0],h=new Du(r,o,i);let d=!1;for(;h.next();){const m=h.getRedElement(),f=h.getBlueElement();a.resetToVertex(m,-1),l.resetToVertex(f,-1);const _=a.nextSegment(),v=l.nextSegment();let x=0;if(sE(_,v)?!d&&v.isIntersecting(_,i)&&(d=!0):x=v.intersect(_,null,c,u,i),x!==0&&(d=!0,x===1)){const w=u[0],T=c[0];if(w>0&&w<1&&T>0&&T<1)return s[0]=!0,!1}}if(!d){s[0]=!0;const m=J.constructEmpty();t.queryEnvelope(m),m.inflateCoords(i,i);const f=new Ci;let _=t,v=!1;for(let A=0,I=e.getPathCount();A<I;A++)if(e.getPathSize(A)>0){const L=J.constructEmpty();if(e.queryPathEnvelope(A,L),!m.isIntersecting(L))return!1;{const D=gL(_,e.getXY(e.getPathStart(A)),0);if(z(D!==-1),D===0)return!1}v||(!Sy(t,e.getPathCount()-1)||r.getAccelerators()!==null&&r.getAccelerators().getQuadTree()!==null?_=t:(t.copyTo(f),f.getImpl().buildQuadTreeAccelerator(1),_=f),v=!0)}if(t.getPathCount()===1||e.getGeometryType()===q.enumPolyline)return!0;const x=e,w=J.constructEmpty();x.queryEnvelope(w),w.inflateCoords(i,i);const T=new Ci;let C=x,M=!1;for(let A=0,I=t.getPathCount();A<I;A++)if(t.getPathSize(A)>0){const L=J.constructEmpty();if(t.queryPathEnvelope(A,L),w.isIntersecting(L)){const D=gL(C,t.getXY(t.getPathStart(A)),0);if(z(D!==-1),D===1)return!1}M||(!Sy(x,t.getPathCount()-1)||o.getAccelerators()!==null&&o.getAccelerators().getQuadTree()!==null?C=x:(x.copyTo(T),T.getImpl().buildQuadTreeAccelerator(1),C=T),M=!0)}return!0}return!1}function Mr(t,e,i){const s=J.constructEmpty();return s.setCoords({env2D:t}),s.inflateCoords(i,i),s.containsEnvelope(e)}function h4(t,e,i){const s=J.constructEmpty();return s.setCoords({env2D:e}),s.inflateCoords(i,i),t.containsExclusiveEnvelope(s)}function nM(t,e,i){const s=J.constructEmpty();return s.setCoords({env2D:e}),s.inflateCoords(i,i),!s.contains(t.getLowerLeft())||!s.contains(t.getLowerRight())||!s.contains(t.getUpperLeft())||!s.contains(t.getUpperRight())}function qfe(t,e,i,s){if(t.getPathCount()!==e.getPathCount()||t.getPointCount()!==e.getPointCount())return!1;if(t.hasNonLinearSegments()||e.hasNonLinearSegments())return t.equals(e);const n=new N,r=new N;let o=!0;const a=i*i;for(let l=0;l<t.getPathCount();l++){if(t.getPathEnd(l)!==e.getPathEnd(l)){o=!1;break}for(let u=t.getPathStart(l);u<e.getPathEnd(l);u++)if(t.queryXY(u,n),e.queryXY(u,r),N.sqrDistance(n,r)>a){o=!1;break}if(!o)break}return!!o}function v$e(t,e,i,s){if(t.getPointCount()!==e.getPointCount())return!1;const n=new N,r=new N;let o=!0;const a=i*i;for(let l=0;l<t.getPointCount();l++)if(t.queryXY(l,n),e.queryXY(l,r),N.sqrDistance(n,r)>a){o=!1;break}return!!o}function aj(t,e,i,s,n,r,o){const a=t.getImpl(),l=e.getImpl(),u=a.getPointCount(),c=l.getPointCount(),h=st(u,!1),d=n||r?st(c,!1):[],m=i*i,f=new Du(a,l,i);for(;f.next();){const T=f.getRedElement(),C=f.getBlueElement(),M=a.getXY(T),A=l.getXY(C);N.sqrDistance(M,A)<=m&&(h[T]=!0,(n||r)&&(d[C]=!0))}let _=!1,v=!1;for(let T=0;T<u;T++){const C=h[T];if(_||(_=!C),v||(v=C),(n||s)&&_)return!1}if(s)return!0;let x=!1,w=!1;for(let T=0;T<c;T++){const C=d[T];if(x||(x=!C),w||(w=C),n&&x)return!1}return!!n||_&&v&&x&&w}function Hfe(t,e,i,s){return $v(t,e,i,s)&&$v(e,t,i,s)}function $v(t,e,i,s){if(NP(t),NP(e),e.isEmpty())return!1;let n=!0;const r=st(2,Number.NaN),o=st(2,Number.NaN),a=[],l=new M$e;let u;const c=J.constructEmpty(),h=J.constructEmpty(),d=J.constructEmpty();t.queryEnvelope(c),e.queryEnvelope(h),c.inflateCoords(i,i),h.inflateCoords(i,i),d.setCoords({env2D:c}),d.intersect(h);const m=t.getImpl().querySegmentIterator(),f=e.getImpl().querySegmentIterator(),_=e.getImpl().getAccelerators();let v=null,x=null,w=null,T=null;if(_!==null&&(v=_.getQuadTree(),x=_.getQuadTreeForPaths(),x!==null&&(T=x.getIteratorForQT())),v===null){const C=t.getPointCount(),M=e.getPointCount();C>10&&M>10&&(v=cS(e.getImpl(),d))}for(v!==null&&(w=v.getIteratorForQT());m.nextPath();)for(;m.hasNextSegment();){let C=m.nextSegment();if(C.queryEnvelope(c),!c.isIntersecting(d))return n=!1,!1;if(T!==null&&(T.resetIterator(c,i),T.next()===-1))continue;let M=0,A=null;if(w!=null)w.resetIterator(C,i);else if(f.resetToFirstPath(),!f.nextPath())return n=!1,!1;do if(M=0,w!==null){const V=w.next();if(V===-1)return n=!1,!1;f.resetToVertex(v.getElement(V),-1),A=f.nextSegment(),M=C.intersect(A,null,r,o,i)}else{for(;!f.hasNextSegment();)if(!f.nextPath())return n=!1,!1;A=f.nextSegment(),A.queryEnvelope(h),h.inflateCoords(i,i),c.isIntersecting(h)&&(M=C.intersect(A,null,r,o,i))}while(M!==2||r[0]!==0||s&&!(o[0]<=o[1]));let I=Number.NaN,L=!1;do{let V=!1;if(r[1]===1){if(!m.hasNextSegment()){L=!0;break}C=m.nextSegment(),V=!0}if(o[1]===1&&o[0]<=o[1]){if(I===-1||(I=1,!f.hasNextSegment()))break;A=f.nextSegment(),V=!0}if(o[1]===0&&o[0]>o[1]){if(I===1)break;if(Number.isNaN(I)){if(!f.hasPreviousSegment())break;f.previousSegment(),I=-1}if(!f.hasPreviousSegment())break;A=f.previousSegment(),V=!0}if(!V)break;M=C.intersect(A,null,r,o,i)}while(M===2&&(!s||o[0]<=o[1]));if(L)continue;const D=C.calculateLength2D();C.queryEnvelope(c),a.length=0,l.m_overlapEvents.length=0;let O=!1,U=!1,$=0;const B=Vy(null,c,!0);for(w!==null?w.resetIterator(C,i):(f.resetToFirstPath(),f.nextPath()||We("relational_operations"));;){if(M=0,w!==null){const V=w.next();if(V===-1)break;f.resetToVertex(v.getElement(V),-1),A=f.nextSegment(),M=C.intersect(A,null,r,o,i)}else{for(;!f.hasNextSegment()&&f.nextPath(););if(!f.hasNextSegment())break;A=f.nextSegment(),A.queryEnvelope(h),h.inflateCoords(i,i),c.isIntersecting(h)&&(M=C.intersect(A,null,r,o,i))}if(M===2&&(!s||o[0]<=o[1])){const V=m.getStartPointIndex(),H=m.getPathIndex(),Y=f.getStartPointIndex(),W=f.getPathIndex();if(u=P$e(V,H,r[0],r[1],Y,W,o[0],o[1]),l.m_overlapEvents.push(u),a.push(a.length),!(O||u.m_scalarA0<$&&u.m_scalarA1<$)){if($===0&&D*(u.m_scalarA0-$)>i)O=!0;else if($!==0&&D*(u.m_scalarA0-$)>B)O=!0;else if($=u.m_scalarA1,D*(1-$)<=i||$===1){U=!0;break}}}}if(!U){if(!O)return n=!1,!1;a.length>1&&a.sort((V,H)=>l.compareOverlapEvents(V,H)),$=0;for(let V=0;V<l.m_overlapEvents.length;V++)if(u=l.m_overlapEvents[a[V]],!(u.m_scalarA0<$&&u.m_scalarA1<$)){if($===0&&D*(u.m_scalarA0-$)>i||$!==0&&D*(u.m_scalarA0-$)>B)return n=!1,!1;if($=u.m_scalarA1,D*(1-$)<=i||$===1)break}if(D*(1-$)>i)return n=!1,!1;a.length=0,l.m_overlapEvents.length=0}}return n}function jfe(t,e,i){const s=t.getImpl(),n=e.getImpl(),r=s.querySegmentIterator(),o=n.querySegmentIterator(),a=new Du(s,n,i);for(;a.next();){const l=a.getRedElement(),u=a.getBlueElement();r.resetToVertex(l,-1),o.resetToVertex(u,-1);const c=r.nextSegment();if(o.nextSegment().isIntersecting(c,i))return!0}return!1}function lj(t,e,i,s){const n=t.getImpl(),r=e.getImpl(),o=n.querySegmentIterator(),a=r.querySegmentIterator(),l=st(2,Number.NaN),u=new Du(n,r,i);let c=!1,h=-1;for(;u.next();){const d=u.getRedElement(),m=u.getBlueElement();o.resetToVertex(d,-1),a.resetToVertex(m,-1);const f=o.nextSegment(),_=a.nextSegment();let v=0;if(sE(f,_)){if(_.isIntersecting(f,i))return-2}else v=f.intersect(_,null,l,null,i);if(v){if(v===2){const x=f.calculateLength2D(),w=l[0];if(x*(l[1]-w)>i)return h=1,h;c=!0}else if(h=0,s){const x=l[0],w=new N;f.queryCoord2D(x,w),s.push(w.x),s.push(w.y)}}}return c?-2:h}function Yfe(t,e,i,s){const n=t.getImpl(),r=e,o=r.getPointCount(),a=s?st(o,!1):[],l=new Du(n,r,i,!1),u=n.querySegmentIterator();for(;l.next();){const c=l.getRedElement(),h=l.getBlueElement();u.resetToVertex(c,-1);const d=u.nextSegment(),m=r.getXY(h);if(d.isIntersectingPoint(m,i)){if(!s)return!0;a[h]=!0}}if(!s)return!1;for(let c=0;c<o;c++)if(!a[c])return!1;return!0}function Xfe(t,e,i){const s=new N,n=i*i,r=t.querySegmentIterator(),o=t.getImpl().getAccelerators();if(o!==null){const l=o.getQuadTree();if(l!==null){const u=J.constructEmpty();u.setCoords({pt:e});const c=l.getIterator(u,i);for(let h=c.next();h!==-1;h=c.next())if(r.resetToVertex(l.getElement(h),-1),r.hasNextSegment()){const d=r.nextSegment(),m=d.getClosestCoordinate(e,!1);if(d.queryCoord2D(m,s),N.sqrDistance(e,s)<=n)return!0}return!1}}const a=J.constructEmpty();for(;r.nextPath();)for(;r.hasNextSegment();){const l=r.nextSegment();if(l.queryEnvelope(a),a.inflateCoords(i,i),!a.contains(e))continue;const u=l.getClosestCoordinate(e,!1);if(l.queryCoord2D(u,s),N.sqrDistance(e,s)<=n)return!0}return!1}function x$e(t,e,i){return Xfe(t,e,i)&&!ege(t,e,i)}function Wfe(t,e,i,s){const n=t.querySegmentIterator(),r=t.getImpl().getAccelerators(),o=t.hasNonLinearSegments();let a=null,l=null,u=null,c=null;if(r!==null){const h=r.getQuadTree();if(h!==null){const d=h.getIterator(e,i);o&&(a=new mi,l=new mi,u=new mi,c=new mi,e.querySide(0,a),e.querySide(1,l),e.querySide(2,u),e.querySide(3,c));const m=J.constructEmpty();m.setCoords({env2D:e}),m.inflateCoords(i,i);for(let f=d.next();f!==-1;f=d.next())if(n.resetToVertex(h.getElement(f),-1),n.hasNextSegment()){const _=n.nextSegment();if(_.getGeometryType()===q.enumLine){const v=_.getStartXY(),x=_.getEndXY();if(m.clipLine(v,x))return!0;continue}if(e.contains(_.getStartXY())||e.contains(_.getEndXY())||_.isIntersecting(a,i)||_.isIntersecting(l,i)||_.isIntersecting(u,i)||_.isIntersecting(c,i))return!0}return!1}}if(o){a=new mi,l=new mi,u=new mi,c=new mi,e.querySide(0,a),e.querySide(1,l),e.querySide(2,u),e.querySide(3,c);const h=t.querySegmentIterator();for(;h.nextPath();)for(;h.hasNextSegment();){const d=h.nextSegment();if(e.contains(d.getStartXY())||e.contains(d.getEndXY())||d.isIntersecting(a,i)||d.isIntersecting(l,i)||d.isIntersecting(u,i)||d.isIntersecting(c,i))return!0}}else{const h=J.constructEmpty();h.setCoords({env2D:e}),h.inflateCoords(i,i);const d=t.getImpl(),m=d.getAttributeStreamRef(0),f=new N;for(let _=0,v=d.getPathCount();_<v;_++){let x=!0;const w=new N,T=new N,C=new N,M=d.getPathStart(_),A=new N;for(let I=M,L=d.getPathEnd(_);I<L;I++)if(x)m.queryPoint2D(2*I,w),A.assign(w),x=!1;else{if(m.queryPoint2D(2*I,f),T.setCoordsPoint2D(w),C.setCoordsPoint2D(f),h.clipLine(T,C))return!0;w.assign(f)}if(d.isClosedPath(_)&&!x&&(T.setCoordsPoint2D(w),C.setCoordsPoint2D(A),h.clipLine(T,C)))return!0}}return!1}function Zfe(t,e,i,s){const n=t.getImpl(),r=e.getImpl(),o=[0],a=Gm(n.getIsSimple(0,o))&&Gm(r.getIsSimple(0,o)),l=n.querySegmentIterator(),u=r.querySegmentIterator(),c=st(2,0),h=st(2,0),d=new Du(n,r,i);let m=!1;for(;d.next();){const T=d.getRedElement(),C=d.getBlueElement();l.resetToVertex(T,-1),u.resetToVertex(C,-1);const M=l.nextSegment(),A=u.nextSegment();let I=0;if(sE(M,A)){if(A.isIntersecting(M,i)){m=!0;break}}else I=A.intersect(M,null,h,c,i);if(I===2){const L=c[0],D=c[1],O=M.calculateLength2D();if(a&&(D-L)*O>i)return!1;m=!0}else if(I){const L=c[0],D=h[0];if(L>0&&L<1&&D>0&&D<1)return!1;m=!0}}if(!m)return!1;const f=J.constructEmpty(),_=J.constructEmpty(),v=J.constructEmpty();let x,w;if(t.queryEnvelope(f),e.queryEnvelope(_),f.inflateCoords(1e3*i,1e3*i),_.inflateCoords(1e3*i,1e3*i),v.setCoords({env2D:f}),v.intersect(_),t.getPointCount()>10){if(x=Is(t,v,i,0,s),x.isEmpty())return!1}else x=t;if(e.getPointCount()>10){if(w=Is(e,v,i,0,s),w.isEmpty())return!1}else w=e;return fc(x,w,i,"F********",s,!1)}function Kfe(t,e,i,s){const n=t.getImpl(),r=e.getImpl(),o=[0],a=Gm(n.getIsSimple(0,o))&&Gm(r.getIsSimple(0,o)),l=J.constructEmpty(),u=J.constructEmpty(),c=J.constructEmpty();t.queryEnvelope(l),e.queryEnvelope(u);let h=!1;const d=nM(l,u,i),m=nM(u,l,i),f=n.querySegmentIterator(),_=r.querySegmentIterator(),v=st(2,Number.NaN),x=st(2,Number.NaN),w=new Du(n,r,i);for(;w.next();){const L=w.getRedElement(),D=w.getBlueElement();f.resetToVertex(L,-1),_.resetToVertex(D,-1);const O=f.nextSegment(),U=_.nextSegment();let $=0;if(sE(O,U)){if(U.isIntersecting(O,i))break}else $=U.intersect(O,null,x,v,i);if($===2){const B=v[0],V=v[1],H=O.calculateLength2D();if(a&&(V-B)*H>i&&(h=!0,d&&m))return!0}else if($){const B=v[0],V=x[0];if(B>0&&B<1&&V>0&&V<1)return!0}}const T=J.constructEmpty(),C=J.constructEmpty();let M,A;T.setCoords({env2D:l}),T.inflateCoords(1e3*i,1e3*i),C.setCoords({env2D:u}),C.inflateCoords(1e3*i,1e3*i),c.setCoords({env2D:T}),c.intersect(C);let I="";if(I+=h?"**":"T*",d){if(e.getPointCount()>10){if(A=Is(e,c,i,0,s),A.isEmpty())return!1}else A=e;I+="****"}else A=e,I+="T***";if(m){if(t.getPointCount()>10){if(M=Is(t,c,i,0,s),M.isEmpty())return!1}else M=t;I+="***"}else M=t,I+="T**";return fc(M,A,i,I,s,!1)}function Qfe(t,e,i,s){const n=[!1],r=Bfe(t,e,i,n);if(n[0])return r;const o=J.constructEmpty();let a;if(e.queryEnvelope(o),o.inflateCoords(1e3*i,1e3*i),t.getPointCount()>10){if(a=Is(t,o,i,0,s),a.isEmpty())return!1}else a=t;return ske(a,e,i,s)}function b$e(t,e,i,s){const n=t.getImpl(),r=e.getImpl(),o=n.querySegmentIterator(),a=r.querySegmentIterator(),l=st(2,Number.NaN),u=st(2,Number.NaN),c=new Du(n,r,i);let h=!1;for(;c.next();){const x=c.getRedElement(),w=c.getBlueElement();o.resetToVertex(x,-1),a.resetToVertex(w,-1);const T=o.nextSegment(),C=a.nextSegment();let M=0;if(sE(T,C)?!h&&C.isIntersecting(T,i)&&(h=!0):M=C.intersect(T,null,u,l,i),M===2)h=!0;else if(M){const A=l[0],I=u[0];if(A>0&&A<1&&I>0&&I<1)return!1;h=!0}}if(!h)return!1;const d=J.constructEmpty(),m=J.constructEmpty(),f=J.constructEmpty();let _,v;if(t.queryEnvelope(d),e.queryEnvelope(m),d.inflateCoords(1e3*i,1e3*i),m.inflateCoords(1e3*i,1e3*i),f.setCoords({env2D:d}),f.intersect(m),t.getPointCount()>10){if(_=Is(t,f,i,0,s),_.isEmpty())return!1}else _=t;if(e.getPointCount()>10){if(v=Is(e,f,i,0,s),v.isEmpty())return!1}else v=e;return fc(_,v,i,"F********",s,!1)}function w$e(t,e,i,s){const n=t.getImpl(),r=e.getImpl(),o=n.querySegmentIterator(),a=r.querySegmentIterator(),l=st(2,Number.NaN),u=st(2,Number.NaN),c=new Du(n,r,i);let h=!1;for(;c.next();){const x=c.getRedElement(),w=c.getBlueElement();o.resetToVertex(x,-1),a.resetToVertex(w,-1);const T=o.nextSegment(),C=a.nextSegment();let M=0;if(sE(T,C)?!h&&C.isIntersecting(T,i)&&(h=!0):M=C.intersect(T,null,u,l,i),M===2)h=!0;else if(M){const A=l[0],I=u[0];if(A>0&&A<1&&I>0&&I<1)return!0;h=!0}}if(!h)return!1;const d=J.constructEmpty(),m=J.constructEmpty(),f=J.constructEmpty(),_=J.constructEmpty(),v=J.constructEmpty();if(t.queryEnvelope(d),e.queryEnvelope(m),nM(m,d,i)){let x,w;if(f.setCoords({env2D:d}),f.inflateCoords(1e3*i,1e3*i),_.setCoords({env2D:m}),_.inflateCoords(1e3*i,1e3*i),v.setCoords({env2D:f}),v.intersect(_),t.getPointCount()>10){if(x=Is(t,v,i,0,s),x.isEmpty())return!1}else x=t;if(e.getPointCount()>10){if(w=Is(e,v,i,0,s),w.isEmpty())return!1}else w=e;return fc(x,w,i,"T********",s,!1)}return fc(t,e,i,"T*****T**",s,!1)}function S$e(t,e,i,s){const n=[!1],r=Bfe(t,e,i,n);if(n[0])return r;const o=J.constructEmpty();let a;if(e.queryEnvelope(o),o.inflateCoords(1e3*i,1e3*i),t.getPointCount()>10){if(a=Is(t,o,i,0,s),a.isEmpty())return!1}else a=t;return nke(a,e,i,s)}function E$e(t,e,i,s){return ul(t,e,i)===1}function C$e(t,e,i,s){return ul(t,e,i)===2}function Jfe(t,e,i,s){const n=new N,r=i*i;for(let o=0;o<t.getPointCount();o++)if(t.queryXY(o,n),N.sqrDistance(n,e)<=r)return!1;return!0}function ege(t,e,i){const s=t.getBoundary();return!s.isEmpty()&&!Jfe(s,e,i)}function T$e(t,e,i){const s=J.constructEmpty();return s.setCoords({env2D:t}),s.inflateCoords(i,i),s.containsEnvelope(e)?1073741824:s.isIntersecting(e)?t.isIntersecting(e)?t.xmin<e.xmin&&e.xmax<t.xmax?e.ymin<t.ymin&&e.ymax>t.ymax?0:1073741824:t.ymin<e.ymin&&e.ymax<t.ymax?e.xmin<t.xmin&&e.xmax>t.xmax?0:1073741824:0:0:4}function sE(t,e){return t.getGeometryType()!==q.enumLine||e.getGeometryType()!==q.enumLine}function P$e(t,e,i,s,n,r,o,a){return{m_ivertexA:t,m_ipathA:e,m_scalarA0:i,m_scalarA1:s,m_ivertexB:n,m_ipathB:r,m_scalarB0:o,m_scalarB1:a}}class M$e{constructor(){this.m_overlapEvents=[]}compareOverlapEvents(e,i){const s=this.m_overlapEvents[e],n=this.m_overlapEvents[i];return s.m_ipathA<n.m_ipathA||s.m_ipathA===n.m_ipathA&&(s.m_ivertexA<n.m_ivertexA||s.m_ivertexA===n.m_ivertexA&&(s.m_scalarA0<n.m_scalarA0||s.m_scalarA0===n.m_scalarA0&&(s.m_scalarA1<n.m_scalarA1||s.m_scalarA1===n.m_scalarA1&&s.m_ivertexB<n.m_ivertexB)))?-1:1}}function tge(t,e,i){const s=K4e(t,e,i);return s?s===1?1:2:0}function ul(t,e,i){const s=gL(t,e,i);return s?s===1?1:2:0}function A$e(t,e,i,s,n){for(let r=0;r<i;r++)n[r]=ul(t,e[r],s)}function uj(t,e,i,s,n){if(t.getGeometryType()===q.enumPolygon)A$e(t,e,i,s,n);else if(t.getGeometryType()===q.enumEnvelope){const r=J.constructEmpty();t.queryEnvelope(r),I$e(r,e,i,s,n)}else un("")}function ige(t,e,i,s,n){const r=t.getGeometryType();r===q.enumPolyline?O$e(t,e,i,s,n):nr(r)?R$e():un("")}function I$e(t,e,i,s,n){if(t.isEmpty()){for(let a=0;a<i;a++)n[a]=0;return}const r=t.clone();r.inflateCoords(.5*-s,.5*-s);const o=t.clone();o.inflateCoords(.5*s,.5*s);for(let a=0;a<i;a++)r.contains(e[a])?n[a]=1:o.contains(e[a])?n[a]=2:n[a]=0}function D$e(t){if(t.isEmpty())return 0;switch(t.getGeometryType()){case q.enumMultiPoint:return t.getImpl().getPointCount();case q.enumPolyline:return t.getImpl().getPathCount();case q.enumPolygon:return t.getImpl().getOGCPolygonCount();case q.enumGeometryCollection:return t.getGeometryCount()}return 1}function N$e(t,e,i){if(i.reset(),e<3)return;const s=t[0].clone(),n=s.x,r=s.y,o=t[1].clone(),a=new N;for(let l=2;l<e;l++)a.assign(t[l]),i.pe((a.x-s.x)*(o.y-r)),s.assign(o),o.assign(a);i.pe((n-s.x)*(o.y-r))}function R$e(t,e,i,s,n){z(0)}function O$e(t,e,i,s,n){const r=t.getImpl(),o=r.getAccelerators();let a=null;o&&(a=o.getRasterizedGeometry());let l=i;for(let u=0;u<i;u++)n[u]=1,a&&z(0);if(l){if(o){let c=null;o!==null&&o.getQuadTree()!==null&&(c=o.getQuadTree());const h=r.getPointCount();if(c===null&&h>20&&h*i>4*h+Math.log(h)*i&&(c=cS(r)),c){let d=null;const m=r.querySegmentIterator(),f=new J;for(let _=0;_<i&&l;_++)if(n[_]===1){f.setCoords(e[_]),d===null?d=c.getIterator(f,s):d.resetIterator(f,s);let v=-1;for(let x=d.next();x!==-1;x=d.next()){if(m.resetToVertex(c.getElement(x),v),v=m.getPathIndex(),m.nextSegment().isIntersectingPoint(e[_],s)){n[_]=2,l--;break}n[_]=0}}return}}const u=r.querySegmentIterator();for(;u.nextPath()&&l;)for(;u.hasNextSegment()&&l;){const c=u.nextSegment();for(let h=0;h<i&&l;h++)n[h]===1&&c.isIntersectingPoint(e[h],s)&&(n[h]=2,l--)}}for(let u=0;u<i;u++)n[u]===1&&(n[u]=0)}function L$e(t,e,i,s,n){const r=Em(e),o=Math.max(4*r,i);return new yL(e,null,o,Number.NaN,n).approximateWithCirclesImpl(t,s)}function F$e(){return Number.isNaN(this.radius.value())}function k$e(){return{ptStart:new N,ptEnd:new N,center:new Et,radius:new ge,fcenter:new ln,fradius2:new nt,maxError:Number.NaN,isLine:F$e}}const $$e=5,U$e=1/8;function V2(t,e,i,s){return{pt:t.clone(),t:e,err:i,checkCount:s}}class yL{constructor(e,i,s,n,r){this.m_left=e,this.m_tracker=r,this.m_eps=s,this.m_trackerCounter=0,this.m_tolerance=n,this.m_circleCheckCounter=0,this.m_bReversedLeft=!1,this.m_leftArc=k$e()}closeToCircularArc(e,i,s,n,r,o){if(this.m_circleCheckCounter++,o.maxError=0,!yL.checkSweepAngle(e,i))return!1;if(o.ptStart.setCoordsPoint2D(s),o.ptEnd.setCoordsPoint2D(r),e.isCircular()){const M=e;return o.fradius2=nt.constructDouble(M.getSemiMajorAxis()).mulDouble(M.getSemiMajorAxis()),o.radius.set(M.getSemiMajorAxis()),o.fcenter.assignPoint2D(M.getCenter()),o.center.set(M.getCenter()),!0}const a=o.ptEnd.sub(o.ptStart).clone();if(a.leftPerpendicularThis(),a.normalize(),Math.abs(a.dotProduct(n.sub(o.ptStart)))<=this.m_eps)return!!this.confirmIsLine(o,a)&&(o.radius.set(Number.NaN),o.center.setCoords(0,0),!0);{const M=o.ptEnd.sub(o.ptStart),A=n.sub(o.ptStart),I=M.crossProduct(A);if(I===0)return!1;const L=.5*M.sqrLength(),D=.5*A.sqrLength();let O=L*A.y-D*M.y;O/=I;let U=M.x*D-A.x*L;U/=I;const $=Math.sqrt(O*O+U*U);if(4*Number.EPSILON*$>this.m_eps)return!1;const B=O+o.ptStart.x,V=U+o.ptStart.y;o.radius.set($),o.center.setCoords(B,V);const H=this.maxCircleApproximationError(e,i,o);if(H>this.m_eps)return o.maxError=H,!1}const l=new ln().assignPoint2D(o.ptStart),u=new ln().assignPoint2D(o.ptEnd).sub(l),c=new ln().assignPoint2D(n).sub(l),h=u.crossProduct(c);if(h.isZero())return!1;const d=u.sqrLength().mulDouble(.5),m=c.sqrLength().mulDouble(.5),f=d.mul(c.y).sub(m.mul(u.y)),_=u.x.mul(m).sub(c.x.mul(d)),v=f.mul(f).add(_.mul(_)),x=h.clone();x.invertThis(),o.fradius2=v.mul(x).mul(x),o.fcenter.setCoords(f.mul(x).add(l.x),_.mul(x).add(l.y)),o.center.setWithEps(o.fcenter.asPoint2D()),o.radius.setWithEps(Math.sqrt(o.fradius2.toDouble()));const w=Et.constructPoint2D(o.ptStart).subE(o.center),T=Et.constructPoint2D(o.ptEnd).subE(o.center);if(!w.dotProduct(T).gt(ZS))return!1;const C=this.maxCircleApproximationError(e,i,o);return o.maxError=C,C<=this.m_eps}static checkSweepAngle(e,i){if(e.getGeometryType()===q.enumEllipticArc){const s=e,n=Vc(s,i.vmin),r=Vc(s,i.vmax);return!(Math.abs(r-n)>.5*zi)}return!0}confirmIsLine(e,i){const s=e.ptEnd.sub(e.ptStart);return!(Math.abs(i.dotProduct(s.mul(.25)))>this.m_eps)&&!(Math.abs(i.dotProduct(s.mul(.75)))>this.m_eps)}maxCircleApproximationError(e,i,s){const n=[.25,.75],r=[.1,.25,.75,.9];let o,a;e.getGeometryType()===q.enumEllipticArc?(o=n,a=n.length):(o=r,a=r.length);let l=0;for(let u=0;u<a;++u){const c=new N;e.queryCoord2D(es(i.vmin,i.vmax,o[u]),c);const h=c.sub(s.center.value()).length(),d=Math.abs(h-s.radius.value());d>l&&(l=d)}return l}approximateWithCirclesImpl(e,i){let s=1;i&&i.push(0);const n=st(9,Number.NaN);let r;e?r=this.m_left.getMonotonicPartParams(n.length,n):(n[0]=0,n[1]=1,r=2);const o=[],a=[],l=new N(0,0);for(let u=1;u<r;u++){const c=new Me(n[u-1],n[u]);for(this.m_bReversedLeft=!yL.goodOrientation(this.m_left,c),this.m_bReversedLeft?(o.push(V2(l,c.vmin,0,0)),o.push(V2(l,c.vmax,0,0))):(o.push(V2(l,c.vmax,0,0)),o.push(V2(l,c.vmin,0,0))),o[0].pt=this.m_left.getCoord2D(o[0].t),o[1].pt=this.m_left.getCoord2D(o[1].t);o.length>1;){this.progress_();const h=o.at(-1);let d=h.checkCount,m=h.err;const f=h.pt.clone(),_=h.t,v=o[o.length-2].t,x=.5*(_+v),w=this.m_left.getCoord2D(x);if(m<=this.m_eps||d>=$$e){const T=new Me;if(T.setCoords(_,v),this.closeToCircularArc(this.m_left,T,f,w,o[o.length-2].pt,this.m_leftArc)){i&&(this.m_bReversedLeft?a.push(_):i.push(v)),s++,o.pop();continue}d=0,m=this.m_leftArc.maxError}h.t=x,h.pt.setCoordsPoint2D(w),m*=U$e,d++,h.err=m,h.checkCount=d,o.push(V2(f,_,m,d))}this.m_bReversedLeft&&i&&(i.length=i.length+a.length,Qs(i,a.reverse(),i.length-a.length,0,a.length),a.length=0),o.length=0}return s}approximateWithCirclesImplPolyline(e){const i=new Qi,s=[];if(!this.approximateWithCirclesImpl(!0,s))return i;let n=0;const r=this.m_left.getStartXY();i.startPath(r);for(let o=1;o<s.length;++o)if(e)i.lineTo(this.m_left.getCoord2D(s[o]));else{const a=new N;this.m_left.queryCoord2D(s[o],a);const l=new N;this.m_left.queryCoord2D(.5*(s[o]+n),l);const u=new Ed;u.constructCircularArcThreePoint(r,a,l),i.addSegment(u,!1),r.assign(a),n=s[o]}return i}static goodOrientation(e,i){const s=e.getCoord2D(i.vmin),n=e.getCoord2D(i.vmax);return s.compare(n)<0}progress_(e=!1){}}function nc(t,e,i,s,n,r,o){z$e(t,e,i,n,r,o)}function V$e(t,e,i,s){if(!Ei(t.getGeometryType()))return t;const n=t.getImpl();if(!n.hasNonLinearSegments())return t;const r=t.createInstance();r.getGeometryType()===q.enumPolygon&&r.setFillRule(t.getFillRule()),new wn;const o=new Jt,a=new ii,l=[],u=[],c=[],h=t.getDescription().getAttributeCount()>1,d=n.querySegmentIterator();for(;d.nextPath();){let m=!0;for(;d.hasNextSegment();){const f=d.isClosingSegment(),_=d.nextSegment();if(!_.isCurve()){r.addSegment(_,m,f),m=!1;continue}let v,x=!1;const w=!0,T=!0;switch(_.getGeometryType()){case q.enumEllipticArc:case q.enumRationalBezier2:v=dL(_,e,i,w,T,u,c,l),x=!0;break;default:v=K7(_,e,i,!0,w,u,l)}const C=x?2:3;u[1].isNAN()?(a.createLine(),a.get().construct(u[0],u[C])):x?(a.createQuadraticRationalBezier(),a.get().constructArrayWeights(u,c)):(a.createCubicBezier(),a.get().constructPoints(u)),h&&m&&(_.queryCoord(l[0],o),a.get().setStart(o)),h&&(_.queryCoord(l[1],o),a.get().setEnd(o)),r.addSegment(a.get(),m,f&&v===1),m=!1;for(let M=1,A=v,I=C;M<A;++M,I+=C)u[I+1].isNAN()?(a.createLine(),a.get().construct(u[I],u[I+C])):x?(a.createQuadraticRationalBezier(),a.get().constructArrayWeights(u.slice(I),c.slice(I))):(a.createCubicBezier(),a.get().constructPoints(u.slice(I))),h&&(_.queryCoord(l[M+1],o),a.get().setEnd(o)),r.addSegment(a.get(),!1,f&&M+1===A)}}return r}function z$e(t,e,i,s,n,r){t.hasCurves()?(t.setCurveStitcherPointer(s),s.m_impl=new nge(r,!1,null),s.m_impl.buildMonotonicCurveParentage(t,e,i,n)):s.m_impl=null}function sge(t,e,i,s,n,r,o,a){t.hasCurves()?(t.setCurveStitcherPointer(r),r.m_impl=new nge(a,!0,n),r.m_impl.buildMonotonicCurveParentage(t,e,i,o),Y$e(t,i,a)):r.m_impl=null}function G$e(t){if(!t.hasSegmentParentage())return;const e=new Un(0),i=t.queryVertexIteratorOnSelection();for(let o=i.next();o!==G;o=i.next())e.add(o);if(e.size()===0)return;t.sortVerticesSimpleByY(e,0,e.size()),e.add(G);const s=N.getNAN();t.queryXY(e.read(0),s);let n=0;const r=N.getNAN();for(let o=1,a=e.size();o<a;o++){{const l=e.read(o);l!==G?t.queryXY(l,r):r.setNAN()}if(!r.isEqualPoint2D(s)){let l=!1,u=-2;for(let c=n;c<o;++c){const h=e.read(c);if(t.getSegmentParentageBreakVertex(h)){l=!0;break}let d=t.getSegmentParentage(h);const m=t.getPrevVertex(h);if(m!==G){let f=t.getSegmentParentage(m);if(d===-1&&(d=f),f===-1&&(f=d),d!==f){l=!0;break}}if(u!==-2&&d!==u){l=!0;break}u=d}if(l)for(let c=n;c<o;++c)t.setSegmentParentageBreakVertex(e.read(c),!0);s.setCoordsPoint2D(r),n=o}}}function B$e(t,e){let i=e.isEmpty()?t:yr(null,e,!0).total();return i>t&&(i=t),.125*i}function mu(t,e){return e||(e=J.constructEmpty()),B$e(t,e)}function od(t,e){return .125*t}function ud(t,e){return 3*t+3*e}class pu{constructor(){this.m_impl=null}stitchCurves(e,i,s,n){this.m_impl&&(this.m_impl.stitchCurves(e,i,s),n&&this.clearStitcher(e))}clearStitcher(e){this.m_impl&&(this.m_impl.clearStitcher(e),this.m_impl=null)}getOriginalVertexIndex(e,i){return this.m_impl.getOriginalVertexIndex(e,i)}getOriginalSegmentTypeInfo(e){return this.m_impl.getOriginalSegmentTypeInfo(e)}}let nge=class Cb{constructor(e,i,s){this.m_originalPlanarSegments=[],this.m_progressTracker=null,this.m_nsr=null,this.m_progressTracker=e,this.m_nsr=s,this.m_tolerance=0,this.m_originalVertexIndex=-1,this.m_type=0,this.m_progressCounter=0,this.m_bIsSimple=i}buildMonotonicCurveParentage(e,i,s,n){if(!e.hasCurves())return;z(!e.hasSegmentParentage()),this.m_type=1,this.m_originalPlanarSegments.length=0,this.m_bIsSimple&&(this.m_originalVertexIndex=e.createUserIndex()),this.m_tolerance=s;const a=new Jt,l=new ii,u=[],c=[],h=[];for(let d=e.getFirstGeometry();d!==G;d=e.getNextGeometry(d))for(let m=e.getFirstPath(d);m!==G;m=e.getNextPath(m)){let f=e.getPathSize(m),_=e.getFirstVertex(m),v=0,x=-1;for(let w=0;w<f;w++){let T=e.getNextVertex(_);if(!e.querySegment(_,l,!0,!1)){_=T;continue}if(v===0){x=e.getVertexIndex(_);const D=Cb.regularizeCurve(e,l.get(),_,s);if(D>=0){this.m_nsr&&this.m_nsr.m_reason===0&&this.m_nsr.assign(new Rs(13,x,-1)),v=D,f=e.getPathSize(m),T=e.getNextVertex(_);const O=e.querySegment(_,l,!0,!1);z(O)}}else v--;const C=e.getVertexIndex(_);let M;this.m_originalVertexIndex!==-1&&e.setUserIndex(_,this.m_originalVertexIndex,x),e.setSegmentToIndex(C,null);let A=!1;switch(l.get().getGeometryType()){case q.enumEllipticArc:case q.enumRationalBezier2:M=dL(l.get(),i,s,!1,!0,c,h,u),A=!0;break;default:{const D=!this.m_bIsSimple||!l.get().isMonotoneQuickAndDirty();M=K7(l.get(),i,s,D,!1,c,u)}}const I=this.m_originalPlanarSegments.length;if(e.setSegmentParentageAndBreak(_,I,!0),!c[1].isNAN()){let D=null;D=A?new il({points:c,weights:h}):new hc({cp:c}),D.snapControlPoints(s*s),e.setSegmentToIndex(C,D)}const L=A?2:3;for(let D=1,O=M,U=L;D<O;++D,U+=L){l.get().queryCoord(u[D],a);const $=e.insertVertex(m,T,a);if(this.m_originalVertexIndex!==-1&&e.setUserIndex($,this.m_originalVertexIndex,x),!c[U+1].isNAN())if(A){const B=new il({points:c.slice(U),weights:h.slice(U)});B.snapControlPoints(s*s),e.setSegmentToIndex(e.getVertexIndex($),B)}else{const B=new hc({cp:c.slice(U)});B.snapControlPoints(s*s),e.setSegmentToIndex(e.getVertexIndex($),B)}e.setSegmentParentageAndBreak($,I,!1)}M>1&&(w+=M-1,f=e.getPathSize(m)),this.m_originalPlanarSegments.push(l.releaseSegment()),_=T}}}stitchCurves(e,i,s){Cb.st_stitchCurvesImpl(this,e,i,s,!1)}clearStitcher(e){this.m_originalPlanarSegments.length=0,this.m_originalVertexIndex!==-1&&(e.removeUserIndex(this.m_originalVertexIndex),this.m_originalVertexIndex=-1),e.deleteSegmentParentage()}static st_verifyParentage(e){Cb.st_stitchCurvesImpl(null,e,G,0,!0)}getOriginalVertexIndex(e,i){return this.m_originalVertexIndex!==-1&&i!==G?e.getUserIndex(i,this.m_originalVertexIndex):-1}getOriginalSegmentTypeInfo(e){if(e!==-1){const i=this.m_originalPlanarSegments[e];switch(i.getGeometryType()){case q.enumEllipticArc:return i.projectionBehavior()===0?0:1;case q.enumBezier:return 2;case q.enumBezier2:return 3;case q.enumLine:return-1;case q.enumRationalBezier2:return 4;default:_i("")}}return-1}progress_(e=!1){this.m_progressCounter++}processSpan_(e,i,s,n,r,o,a){if(i===s&&n===0)return z(e.getNextVertex(i)===G),e.setSegmentToIndex(e.getVertexIndex(i),null),void e.setSegmentParentageAndBreak(i,-1);const l=e.getNextVertex(i);{let h=2;for(let d=l;d!==s;d=e.getNextVertex(d))h++;z(h===n)}if(r===null){e.setSegmentToIndex(e.getVertexIndex(i),null);for(let h=l;h!==s;)h=e.removeVertex(h,!0);return}const u=e.getXY(i),c=e.getXY(s);if(r.isClosed()){if(u.isEqualPoint2D(c)&&u.isEqualPoint2D(r.getStartXY())){let h;if(h=this.verifySegmentFitness(e,i,s,n,r,o,a)){const d=r.clone();return d.dropAllAttributes(),h<0&&d.reverse(),this.removeSpan(e,i,s),void e.setSegmentToIndex(e.getVertexIndex(i),d)}}}else if(u.isEqualPoint2D(r.getStartXY())){if(c.isEqualPoint2D(r.getEndXY())){const h=r.clone();if(h.dropAllAttributes(),this.verifySegmentFitness(e,i,s,n,h,o,a))return this.removeSpan(e,i,s),void e.setSegmentToIndex(e.getVertexIndex(i),h)}}else if(c.isEqualPoint2D(r.getStartXY())&&u.isEqualPoint2D(r.getEndXY())){const h=r.getReversed();if(h.dropAllAttributes(),this.verifySegmentFitness(e,i,s,n,h,o,a))return this.removeSpan(e,i,s),void e.setSegmentToIndex(e.getVertexIndex(i),h)}this.processSpanSplitSegment(e,i,s,n,r,o,a)}processSpanSplitSegment(e,i,s,n,r,o,a){if(r.isLine()||this.fitSegmentToSpan(e,i,s,n,r,o,a))return;const l=a*a;let u=n,c=i;const h=e.getXY(i);let d=r.getClosestCoordinate(h,!1);const m=r.getCoord2D(d);let f=!1;const _=N.sqrDistance(h,m);if(_>l){const I=e.getNextVertex(i);if(this.approximateSpanSection(e,i,r,o,a),I===s)return;c=I,f=!0,u-=1}let v=s;const x=e.getXY(s);d=r.getClosestCoordinate(x,!1);const w=r.getCoord2D(d);let T=!1;const C=N.sqrDistance(x,w);if(C>l){const I=e.getPrevVertex(s);if(this.approximateSpanSection(e,I,r,o,a),I===c)return;v=I,T=!0,u-=1}if((f||T)&&this.fitSegmentToSpan(e,c,v,u,r,o,a))return;let M=!1;if(!f&&_>0){const I=e.getNextVertex(i);if(this.approximateSpanSection(e,i,r,o,a),I===v)return;c=I,f=!0,M=!0,u-=1}if(!T&&C>0){const I=e.getPrevVertex(s);if(this.approximateSpanSection(e,I,r,o,a),I===c)return;v=I,T=!0,M=!0,u-=1}if(M&&this.fitSegmentToSpan(e,c,v,u,r,o,a))return;let A=c;for(;;){const I=e.getNextVertex(A);if(this.approximateSpanSection(e,A,r,o,a),A=I,A===v)return}}fitSegmentToSpan(e,i,s,n,r,o,a){const l=this.m_type===0,u=[];if(u.push(e.getXY(i)),l){let d=i;const m=32;if(n>m){const f=BigInt(n-1),_=BigInt(m-1);let v=_,x=0n;for(let w=1;w<n;w++,v+=_)if(d=e.getNextVertex(d),v>=x+f){x+=f;const T=e.getXY(d);u.push(T)}z(d===s)}else{for(let f=1;f<n;f++){d=e.getNextVertex(d);const _=e.getXY(d);u.push(_)}z(d===s)}}else{let d=i;const m=new ii;for(;;){e.querySegment(d,m,!1,!0);const f=[.1,.25,.4,.5,.6,.75,.9,1];let _=0;for(const v of f)(n===2||1&_)&&u.push(m.get().getCoord2D(v)),_++;if(d=e.getNextVertex(d),d===s)break}}const c=(()=>{let d=u[0].compare(u.at(-1));if(d===0){const m=new Wr(0);N$e(u,u.length,m),d=m.getResult()>=0?-1:1}return d>0})();c&&u.reverse();const h=r.clone();if(h.dropAllAttributes(),h.setSegmentFromCoords(u,u.length),c&&h.reverse(),h.snapControlPoints(this.m_tolerance*this.m_tolerance),this.verifySegmentFitness(e,i,s,n,h,o,a)){this.removeSpan(e,i,s);const d=e.getVertexIndex(i);return e.setSegmentToIndex(d,h),!0}return!1}approximateSpanSection(e,i,s,n,r){const o=new ii;if(!e.querySegment(i,o,!0,!1))return;const a=s.getGeometryType();if(a!==o.get().getGeometryType()){if(a===q.enumEllipticArc){if(o.get().getGeometryType()!==q.enumRationalBezier2)return;if(s.projectionBehavior()===0){const l=[];L$e(!1,o.get(),r,l,this.m_progressTracker);const u=e.getNextVertex(i),c=e.getPathFromVertex(i),h=new Jt;let d=i;for(let m=1,f=l.length;m<f;m++){const _=l[m],v=o.get().getCoord2D(l[m-1]),x=o.get().getCoord2D(es(l[m-1],_,.5));o.get().queryCoord(_,h);const w=h.getXY(),T=new Ed;T.constructCircularArcThreePoint(v,w,x);let C=G;_<1&&(C=e.insertVertex(c,u,h)),e.setSegmentToIndex(e.getVertexIndex(d),T),d=C}return}{const l=he(N,3);o.get().queryControlPoints(l);const u=[0,0,0];o.get().queryWeights(u);const c=oh(u),h=new Ed;return UFe(l,c*c,null,!1,h),void e.setSegmentToIndex(e.getVertexIndex(i),h)}}We("approximate_span_section_")}}verifySegmentFitness(e,i,s,n,r,o,a){return this.m_type===0?this.verifySegmentFitnessLines(e,i,s,n,r,o,a):this.verifySegmentFitnessCurves(e,i,s,n,r,o,a)}verifySegmentFitnessCurves(e,i,s,n,r,o,a){const l=e.getXY(i),u=e.getXY(s);if(!l.isEqualPoint2D(r.getStartXY())||!u.isEqualPoint2D(r.getEndXY()))return 0;let c=0;if(r.isClosed()){const w=r.getCoord2D(.1).sub(l);c=r.getCoord2D(.7).sub(l).crossProduct(w)>=0?1:-1}const h=st(dA.s_maxMonotonicPartParams,Number.NaN);let d=r.getMonotonicPartParams(h.length,h);d--;const m=new mi,f=[1,.5,.75,.25];let _=0,v=i;const x=l.clone();for(;;){const w=e.getNextVertex(v);let T=e.getSegment(v);T===null&&(e.queryLineConnector(v,m,!0),T=m);for(let C=w===s?1:0;C<f.length;C++){const M=T.getCoord2D(f[C]);if(!r.isCloserThanDistance(M,Me.unit(),a))return 0}if(d>1)for(let C=1;C<d;){const M=r.getCoord2D(h[C]);T.isCloserThanDistance(M,Me.unit(),a)?(h[d-1]=Ge(h[C],h[C]=h[d-1]),d--):C++}if(c){const C=T.getCoord2D(.25);_+=C.sub(l).crossProduct(x.sub(l)),x.assign(C),C.assign(T.getCoord2D(.75)),_+=C.sub(l).crossProduct(x.sub(l)),x.assign(C)}if(v=w,v===s)return d>1?0:c?_<0?-c:c:1}}verifySegmentFitnessLines(e,i,s,n,r,o,a){return z(0),0}removeSpan(e,i,s){e.setSegmentToIndex(e.getVertexIndex(i),null);const n=e.getNextVertex(i);n!==s&&e.removeVertices(n,s)}static st_stitchCurvesImpl(e,i,s,n,r){if(i.hasSegmentParentage())return i.hasCurves()?Cb.st_stitchCurvesFromCurvesImpl(e,i,s,n,r):Cb.st_stitchCurvesFromLinesImpl(e,i,s,n,r)}static st_stitchCurvesFromLinesImpl(e,i,s,n,r){let o=s===G?i.getFirstGeometry():s;for(;o!==G;){for(let a=i.getFirstPath(o);a!==G;a=i.getNextPath(a)){let l=i.getPathSize(a);i.isClosedPath(a)&&(l+=1);let u=!0,c=!1;const h=i.getFirstVertex(a);let d=h;for(let m=0;m<l&&d!==G;){let f=i.getSegmentParentage(d);if(f===-1||u){u=!1,m++,d=i.getNextVertex(d),c=!0;continue}let _,v,x=0;if(c?(_=i.getPrevVertex(d),v=d,z(_!==G),z(v!==_),z(i.getSegmentParentage(_)===-1||h===_)):(_=d,v=i.getNextVertex(_),m++,z(v!==G),z(v!==_),f=i.getSegmentParentage(v)),x=2,c=!1,f===-1||i.getSegmentParentageBreakVertex(v)){d=v;continue}let w=i.getNextVertex(v);for(m++;m<l&&w!==G;){v=w,x++;const T=i.getSegmentParentage(w);if(T===-1||i.getSegmentParentageBreakVertex(w))break;z(T===f),m++,w=i.getNextVertex(w)}if(!r){const T=e.m_originalPlanarSegments[f];e.processSpan_(i,_,v,x,T,f,n)}d=v}}if(s!==G)break;o=i.getNextGeometry(o)}}static st_stitchCurvesFromCurvesImpl(e,i,s,n,r){let o=s===G?i.getFirstGeometry():s;for(;o!==G;)if(MRe(i.getGeometryType(o))){for(let a=i.getFirstPath(o);a!==G;a=i.getNextPath(a)){let l=i.getPathSize(a);const u=i.isClosedPath(a);u&&(l+=1);let c=i.getFirstVertex(a);if(u){if(i.getSegmentParentage(c)!==-1){let d=c;for(let m=0;!i.getSegmentParentageBreakVertex(d);m++){if(m===l){c=i.getFirstVertex(a),i.setSegmentParentageBreakVertex(d,!0);break}d=i.getPrevVertex(d)}}}else z(i.getSegmentParentage(c)===-1||i.getSegmentParentageBreakVertex(c));let h=c;for(let d=0;d<l&&h!==G;){const m=i.getSegmentParentage(h);if(m===-1){d++,h=i.getNextVertex(h);continue}let f=0,_=G;const v=h;f=1;let x=i.getNextVertex(v);for(;d<l&&x!==G;){d++,_=x,f++;const w=i.getSegmentParentage(x);if(w===-1||i.getSegmentParentageBreakVertex(x))break;z(w===m),x=i.getNextVertex(x)}if(_===G)break;if(!r){const w=e.m_originalPlanarSegments[m];e.processSpan_(i,v,_,f,w,m,n)}h=_}}if(s!==G)break;o=i.getNextGeometry(o)}else o=s===G?i.getNextGeometry(o):G}static regularizeCurve(e,i,s,n){let r=i.snapControlPoints(n*n);if(r){const o=e.getVertexIndex(s),a=i.clone();e.setSegmentToIndex(o,a)}if(i.getGeometryType()===hc.type){const o=[],a=i.calculateSpecialPointsForCracking(n,o);if(a>0){e.splitSegment(s,o,a),r=e.snapControlPoints(s,a+1,n*n)||r;for(let l=0;l<a;l++)s=e.getNextVertex(s),e.setSegmentParentageBreakVertex(s,!0);return a}}return r?0:-1}};function Qh(t,e,i,s,n){return new d4(t,i,e,s,n).do_()}function q$e(t,e,i){const s=Pu(t);return rj(e.getX(),e.getY(),i.getX(),i.getY(),Di(s))}function H$e(t,e,i=1,s=1,n=1,r=1){if(s>r)return t;if(r>s)return e;const o=[0],a=[0],l=new Jt;return L4e(t,e,i,s,n,r,l,a,o),l}function j$e(t,e,i){const s=Pu(e),n=F7(e);return!!F4e(t,s,G,null,i)||oj(!0,t,n,null,i)}function Y$e(t,e,i){return d4.fixCurveTwoPointLoops(t,e,i)}function rge(t){return Pu(t)}class d4{constructor(e,i,s,n,r){this.m_shape=e,this.m_progressTracker=i,this.m_tolerance=s,this.m_bFilterDegenerateSegments=n,this.m_bTrackChanges=r,this.m_progressCounter=0}do_(){const e=new pc(this.m_tolerance.tolerance,this.m_tolerance.resolution),i=1e-5,s=1e-6,n=rge(e);let r=F7(e);const o=r*(1+i);r*=1+s;let a=!1;const l=this.m_shape.getTotalPointCount()+10>30?1e3:(this.m_shape.getTotalPointCount()+10)*(this.m_shape.getTotalPointCount()+10),u=this.m_shape.hasPointFeatures();for(let c=0;;c++){this.m_shape.dbgCheckSelection(),c>l&&We("crack_and_cluster_iteration_exceeded"),this.m_shape.dbgVerifyMonotone();let h=-1;c===0&&(h=this.firstCrack_(),a||(a=h>0));const d=this.cluster_(n);if(this.m_shape.dbgVerifyMonotone(),a||(a=d),this.m_bFilterDegenerateSegments){const _=this.m_shape.filterClosePoints(n,!0,!1,this.m_bTrackChanges,G)!==0;a||(a=_),this.m_shape.dbgVerifyMonotone()}const m=this.m_shape.snapControlPointsOnSelection(o*o);a||(a=m),this.m_shape.dbgCheckSelection();let f=!1;if((c===0&&h===-1||u||oj(!0,this.m_shape,r,null,this.m_progressTracker))&&(f=this.crack_(o),a||(a=f),this.m_shape.dbgVerifyMonotone()),!f&&!d4.fixCurveTwoPointLoops(this.m_shape,n,this.m_progressTracker)){this.m_shape.dbgVerifyMonotone();break}}return a&&G$e(this.m_shape),a}cluster_(e){return Mfe(this.m_shape,e,G,this.m_bTrackChanges,this.m_progressTracker)}crack_(e){return j4e(this.m_shape,e,this.m_bTrackChanges,this.m_progressTracker)}static fixCurveTwoPointLoops(e,i,s){if(!e.hasCurves())return!1;e.dbgVerifyCurves();const n=e.createUserIndexUninitialized(),r=new Un(0),o=e.queryVertexIteratorOnSelection();for(let h=o.next();h!==G;h=o.next())r.add(h),e.setUserIndex(h,n,-1);if(r.size()===0)return!1;r.add(G),e.sortVerticesSimpleByY(r,0,r.size()-1);let a=0;const l=e.getXY(r.read(a)),u=new N(Number.NaN,Number.NaN),c=[];for(let h=1,d=r.size();h<d;++h){const m=r.read(h),f=m!==G?e.getXY(m):u;if(f.equals(l))continue;const _=[];for(let v=a;v<h;v++){const x=r.read(v),w=e.getPrevVertex(x);if(w!==G&&e.getUserIndex(w,n)===-1){const C=jU(e.getXY(w),e.getSegment(w));N.sqrDistance(l,C.otherPt)!==0&&(C.vert=w,C.dir=-1,_.push(C)),e.setUserIndex(w,n,1)}const T=e.getNextVertex(x);if(T!==G&&e.getUserIndex(x,n)===-1){const C=jU(e.getXY(T),e.getSegment(x));N.sqrDistance(l,C.otherPt)!==0&&(C.vert=x,C.dir=1,_.push(C)),e.setUserIndex(x,n,1)}}if(_.length>1){_.sort((w,T)=>Z$e(w,T));const v=jU(u.clone(),null);_.push(v);let x=0;for(let w=1,T=_.length;w<T;w++)if(!_[w].otherPt.equals(_[w-1].otherPt)){if(w-x>1&&_[x].seg!==null){let C=!1;const M=x;for(let A=x+1;A<w;A++)if(!X$e(_[M],_[A])){C=!0;break}if(C)for(let A=x;A<w&&_[A].seg!==null;A++)c.push(_[A].vert)}x=w}}a=h,l.setCoordsPoint2D(f)}for(const h of c){const d=e.getSegment(h);z(d!==null);const m=e.getXY(h),f=e.getXY(e.getNextVertex(h));if(N.distance(m,f)<3*i)e.setSegmentToIndex(e.getVertexIndex(h),null);else{const _=d.lengthToT(.5*d.calculateLength2D());e.splitSegment(h,[_],1)}}return e.removeUserIndex(n),c.length>0}firstCrack_(){const e=this.m_shape.getEnvelope2D(this.m_progressTracker),i=yr(null,e,!0).total();if(4*i<this.m_tolerance.total()){let s=!1;const n=1.1*i,r=i,o=this.cluster_(n);s||(s=o);let a=0;this.m_bFilterDegenerateSegments&&(a=this.m_shape.filterClosePoints(0,!0,!1,this.m_bTrackChanges,G));const l=this.crack_(r);return s||(s=l),s?1:a?2:0}return-1}progress_(e=!1){this.m_progressCounter++,!e&&4095&this.m_progressCounter||(this.m_progressCounter=0)}}function jU(t,e){return{otherPt:t,seg:e,vert:-1,dir:0}}function X$e(t,e){if(z(t.otherPt.equals(e.otherPt)),t.seg===null)return e.seg===null;if(e.seg===null)return!1;const i=t.seg.getGeometryType();if(i!==e.seg.getGeometryType())return!1;if(i===q.enumBezier){const s=t.seg,n=e.seg;let r=s.getControlPoint1(),o=s.getControlPoint2();t.dir===-1&&(o=Ge(r,r=o));let a=n.getControlPoint1(),l=n.getControlPoint2();return e.dir===-1&&(l=Ge(a,a=l)),r.equals(a)&&o.equals(l)}if(i===q.enumRationalBezier2){const s=t.seg,n=e.seg,r=s.getControlPoint1(),o=n.getControlPoint1();if(!r.equals(o))return!1;const a=[0,0,0];s.queryWeights(a),t.dir===-1&&(a[2]=Ge(a[0],a[0]=a[2]));const l=[0,0,0];return n.queryWeights(l),e.dir===-1&&(l[2]=Ge(l[0],l[0]=l[2])),a[0]===l[0]&&a[1]===l[1]&&a[2]===l[2]}We("")}function W$e(t,e){if(t.seg===null||e.seg===null)return t.seg!==null?-1:e.seg!==null?1:0;const i=t.seg.getGeometryType(),s=e.seg.getGeometryType();return i<s?-1:i>s?1:0}function Z$e(t,e){const i=t.otherPt.compare(e.otherPt);return i!==0?i:W$e(t,e)}var m4=Ei,K$e=nr,jD=Pl;function Q$e(t){switch(t){case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 0:return 0;default:z(0,"unrecognized cut side")}return 3}function b0(){return{unsplitBehavior:0,allCrossRoadsImpassable:!1,ogcRule:!1}}function J$e(t,e,i,s){return new Vl(s).autoCompleteImpl(t,e,i)}function gB(t,e,i,s,n,r,o){const a=new Vl(n);a.m_bOGCOutput=!0;const l=t.getGeometryType()===q.enumPolygon&&t.getFillRule()===1&&!Gm(s);return a.planarSimplifyImpl_(t,e,l,i,s,n,r,o)}function vL(t,e,i,s,n,r,o,a){return new Vl(r).planarSimplifyImpl_(t,e,i,s,n,r,o,a)}function eUe(t,e,i,s){const n=new Vl(s),r=new wn,o=r.addGeometry(e),a=n.planarSimplifyNoCrackingAndCluster(t,r,o,i);return z(a,"planar_simplify_no_cracking_and_cluster"),r.getGeometry(o)}function tUe(t,e,i,s,n,r,o){return z(0),{}}function iUe(t,e,i,s){return z(0),{}}function ete(t,e,i){return cUe(t,e,i)}function sUe(t,e,i,s){if(t.isEmpty()||e.isEmpty()||t.getDimension()>e.getDimension())return fu(_r(t),t,e,"-");const n=new J;t.queryEnvelope(n);const r=new J;e.queryEnvelope(r);const o=new J;o.setCoords({env2D:n}),o.mergeEnvelope2D(r);const a=yr(i,o,!0),l=r.clone(),u=Pu(a);if(l.inflateCoords(u,u),!n.isIntersecting(l))return fu(_r(t),t,e,"-");const c=new Vl(s),h=new wn,d=h.addGeometry(_r(t)),m=h.addGeometry(_r(e));let f=0,_=0,v=null;if(h.hasCurves()){v=new pu;const T=h.getEnvelope2D(s);_=od(a.total());const C=mu(a.total(),T);f=ud(C,_),nc(h,C,a.total(),12e3,v,null,s)}c.setEditShapeCrackAndCluster(h,a.add(f));const x=c.difference(d,m);v!==null&&v.stitchCurves(h,x,_,!0);const w=fu(h.getGeometry(x),t,e,"-");return m4(w.getGeometryType())&&(w.getImpl().setIsSimple(4,a.total()),w.getGeometryType()===q.enumPolygon&&w.getImpl().updateOGCFlagsProtected()),w}function nUe(t,e,i,s){if(t.getDimension()>e.getDimension())return fu(_r(t),t,e,"^");if(t.getDimension()<e.getDimension()||t.isEmpty())return fu(_r(e),t,e,"^");if(e.isEmpty())return fu(_r(t),t,e,"^");const n=new J;t.queryEnvelope(n);const r=new J;e.queryEnvelope(r);const o=new J;o.setCoords({env2D:n}),o.mergeEnvelope2D(r);const a=yr(i,o,!0),l=new Vl(s),u=new wn,c=u.addGeometry(_r(t)),h=u.addGeometry(_r(e));let d=0,m=null;if(u.hasCurves()){m=new pu;const v=u.getEnvelope2D(s);d=od(a.total()),nc(u,mu(a.total(),v),a.total(),12e3,m,null,s)}l.setEditShapeCrackAndCluster(u,a);const f=l.symmetricDifference(c,h);m!==null&&m.stitchCurves(u,f,d,!0);const _=fu(u.getGeometry(f),t,e,"^");return m4(_.getGeometryType())&&(_.getImpl().setIsSimple(4,a.total()),_.getGeometryType()===q.enumPolygon&&_.getImpl().updateOGCFlagsProtected()),_}function tte(t,e,i){return uUe(t,e,i,!0)}function rUe(t,e,i){return t.isEmpty()||e.isEmpty()?t.createInstance():q$e(i,t,e)?new Jt({copy:H$e(t,e)}):t.createInstance()}function oUe(t,e,i,s){const n=J.constructEmpty();t.queryEnvelope(n);const r=J.constructEmpty();e.queryEnvelope(r);const o=J.constructEmpty();o.setCoords({env2D:n}),o.mergeEnvelope2D(r);const a=yr(i,o,!0),l=new J(r),u=Pu(a);if(l.inflateCoords(u,u),!n.isIntersecting(l)){if(t.getDimension()<=e.getDimension())return fu(_r(t.createInstance()),t,e,"&");if(t.getDimension()>e.getDimension())return fu(_r(e.createInstance()),t,e,"&")}const c=new Vl(s),h=new wn,d=h.addGeometry(_r(t)),m=h.addGeometry(_r(e));let f=0,_=0,v=null;if(h.hasCurves()){v=new pu;const T=h.getEnvelope2D(s);_=od(a.total());const C=mu(a.total(),T);f=ud(C,_),nc(h,C,a.total(),12e3,v,null,s)}c.setEditShapeCrackAndCluster(h,a.add(f));const x=c.intersection(d,m);v!==null&&v.stitchCurves(h,x,_,!0);const w=fu(h.getGeometry(x),t,e,"&");return m4(w.getGeometryType())&&(w.getImpl().setIsSimple(4,a.total()),w.getGeometryType()===q.enumPolygon&&w.getImpl().updateOGCFlagsProtected()),w}function aUe(t,e,i,s){const n=new Array(3),r=J.constructEmpty();t.queryEnvelope(r);const o=J.constructEmpty();e.queryEnvelope(o);const a=J.constructEmpty();a.setCoords({env2D:r}),a.mergeEnvelope2D(o);const l=yr(i,a,!0),u=new J(o),c=Pu(l);if(u.inflateCoords(c,c),!r.isIntersecting(u)){if(t.getDimension()<=e.getDimension()){const T=fu(_r(t.createInstance()),t,e,"&");return n[T.getDimension()]=T,n}if(t.getDimension()>e.getDimension()){const T=fu(_r(e.createInstance()),t,e,"&");return n[T.getDimension()]=T,n}}const h=new Vl(s),d=new wn,m=d.addGeometry(_r(t)),f=d.addGeometry(_r(e));let _=0,v=0,x=null;if(d.hasCurves()){x=new pu;const T=d.getEnvelope2D(s);v=od(l.total());const C=mu(l.total(),T);_=ud(C,v),nc(d,C,l.total(),12e3,x,null,s)}h.setEditShapeCrackAndCluster(d,l.add(_)),d.dbgVerifyCurves();const w=h.intersectionEx(m,f);for(const T of w){x!==null&&x.stitchCurves(d,T,v,!1);const C=fu(d.getGeometry(T),t,e,"&");m4(C.getGeometryType())&&(C.getImpl().setIsSimple(4,l.total()),C.getGeometryType()===q.enumPolygon&&C.getImpl().updateOGCFlagsProtected()),n[C.getDimension()]=C}return x!==null&&x.clearStitcher(d),n}function YU(t,e,i,s,n,r=!1){e===0&&ce("not enough geometries to dissolve");let o=0;for(let f=0,_=e;f<_;f++)o=Math.max(t[f].getDimension(),o);if(o===2||o===1)return new Vl(s).dissolveMultiPaths_(o,!1,t,e,i,n,r);let a=0,l=-1;for(let f=0,_=e;f<_;f++)t[f].getDimension()===o&&(l===-1&&(l=f),t[f].isEmpty()||(l=f,a++));if(a<2)return _r(t[l]);const u=Sd.constructEmpty(),c=new wn;let h=G;for(let f=0,_=e;f<_;f++)if(t[f].getDimension()===o&&!t[f].isEmpty()){h===G?h=c.addGeometry(_r(t[f])):c.appendGeometry(h,_r(t[f]));const v=Sd.constructEmpty();t[f].queryLooseEnvelope(v),u.mergeEnv3D(v)}const d=yr(i,u.getEnvelope2D(),!0),m=new Vl(s);if(r){const f=kP(i,u.getEnvelopeZs(),!0);return m.planarSimplify3DImpl_(c,d,f,0,!0)}return m.m_bOGCOutput=!0,m.planarSimplifyMultiPoints(c,d,!1,-1)}function lUe(t,e,i,s,n,r=!1){e<2&&ce("not enough geometries to dissolve");let o=0;for(let _=0,v=e;_<v;_++)o=Math.max(t[_].getDimension(),o);if(o===2||o===1)return new Vl(s).dissolveMultiPaths_(o,!0,t,e,i,n,r);const a=Sd.constructEmpty(),l=new wn;let u=G,c=0,h=-1;for(let _=0,v=e;_<v;_++)if(t[_].getDimension()===o&&(h===-1&&(h=_),!t[_].isEmpty())){h=_,u===G?u=l.addGeometry(_r(t[_])):l.appendGeometry(u,_r(t[_]));const x=Sd.constructEmpty();t[_].queryLooseEnvelope(x),a.mergeEnv3D(x),c++}if(c<2)return _r(t[h]);const d=o===0?i:null,m=yr(d,a.getEnvelope2D(),!0),f=new Vl(s);if(r){const _=kP(d,a.getEnvelopeZs(),!0);return f.m_bOGCOutput=!0,f.planarSimplify3DImpl_(l,m,_,0,!0)}return f.planarSimplifyMultiPoints(l,m,!0,-1)}class Vl{constructor(e){this.m_topoGraph=null,this.m_maskLookup=[],this.m_dummyPt1=N.getNAN(),this.m_dummyPt2=N.getNAN(),this.m_fromEdgeForPolylines=G,this.m_progressCounter=0,this.m_bOGCOutput=!1,this.m_progressTracker=e}linesToPolygonsImpl(e,i){let s=0,n=0,r=null;if(e.hasCurves()){r=new pu;const u=e.getEnvelope2D(this.m_progressTracker);n=od(i.total());const c=mu(i.total(),u);s=ud(c,n),nc(e,c,i.total(),12e3,r,null,this.m_progressTracker)}this.setEditShapeCrackAndCluster(e,i.add(s));const o=this.m_topoGraph.createUserIndexForChains(),a=this.m_topoGraph.getFirstChain();this.m_topoGraph.setChainUserIndex(a,o,1);for(let u=this.m_topoGraph.getChainFirstIsland(a);u!==G;u=this.m_topoGraph.getChainNextInParent(u))this.m_topoGraph.setChainUserIndex(u,o,1);const l=[];for(let u=this.m_topoGraph.getFirstChain();u!==G;u=this.m_topoGraph.getChainNext(u)){if(this.m_topoGraph.getChainUserIndex(u,o)===1)continue;this.m_topoGraph.setChainUserIndex(u,o,1);for(let d=this.m_topoGraph.getChainFirstIsland(u);d!==G;d=this.m_topoGraph.getChainNextInParent(d))this.m_topoGraph.setChainUserIndex(d,o,1);if(this.m_topoGraph.getChainArea(u)===0)continue;const c=this.m_topoGraph.extractPolygonFromChainAndIslands(e,G,u,G);r!=null&&r.stitchCurves(e,c,n,!1);const h=e.getGeometry(c);l.push(h)}return new zm(l)}autoCompleteImpl(e,i,s){let n=0,r=0,o=null;if(e.hasCurves()){o=new pu;const h=e.getEnvelope2D(this.m_progressTracker);r=od(s.total());const d=mu(s.total(),h);n=ud(d,r),nc(e,d,s.total(),12e3,o,null,this.m_progressTracker)}this.setEditShapeCrackAndCluster(e,s.add(n));const a=this.m_topoGraph.getGeometryID(i),l=this.m_topoGraph.createUserIndexForChains(),u=this.m_topoGraph.getFirstChain();this.m_topoGraph.setChainUserIndex(u,l,1);for(let h=this.m_topoGraph.getChainFirstIsland(u);h!==G;h=this.m_topoGraph.getChainNextInParent(h))this.m_topoGraph.setChainUserIndex(h,l,1);const c=[];for(let h=this.m_topoGraph.getFirstChain();h!==G;h=this.m_topoGraph.getChainNext(h)){if(this.m_topoGraph.getChainUserIndex(h,l)===1)continue;this.m_topoGraph.setChainUserIndex(h,l,1);for(let x=this.m_topoGraph.getChainFirstIsland(h);x!==G;x=this.m_topoGraph.getChainNextInParent(x))this.m_topoGraph.setChainUserIndex(x,l,1);if(this.m_topoGraph.getChainParentage(h)!==0)continue;const d=this.m_topoGraph.getChainHalfEdge(h);let m=d,f=!1;do{const x=this.m_topoGraph.getHalfEdgeTwin(m);if(this.m_topoGraph.getHalfEdgeChain(x)!==h&&this.m_topoGraph.getHalfEdgeParentage(m)&a){f=!0;break}m=this.m_topoGraph.getHalfEdgeNext(m)}while(m!==d);if(!f||this.m_topoGraph.getChainArea(h)===0)continue;const _=this.m_topoGraph.extractPolygonFromChainAndIslands(e,G,h,G);o!==null&&o.stitchCurves(e,_,r,!1);const v=e.getGeometry(_);c.push(v)}return new zm(c)}setEditShape(e,i=!1){this.m_topoGraph===null&&(this.m_topoGraph=new sc),this.m_topoGraph.setEditShape(e,this.m_progressTracker,!0,i)}setEditShapeCrackAndCluster(e,i){Qh(e,i,this.m_progressTracker,!0,!1);for(let s=e.getFirstGeometry();s!==G;s=e.getNextGeometry(s))e.getGeometryType(s)===q.enumPolygon&&bf(e,s,-1,this.m_bOGCOutput,G,this.m_progressTracker);this.setEditShape(e)}setHalfEdgeOrientations_(e,i){const s=this.m_topoGraph.getShape();for(let n=s.getFirstGeometry();n!==G;n=s.getNextGeometry(n))if(n===i)for(let r=s.getFirstPath(n);r!==G;r=s.getNextPath(r)){let o=s.getFirstVertex(r);if(o===G)continue;let a=s.getNextVertex(o);for(;a!==G;){const l=this.m_topoGraph.getClusterFromVertex(o),u=this.m_topoGraph.getClusterFromVertex(a),c=this.m_topoGraph.getHalfEdgeConnector(l,u);if(c!==G){const h=this.m_topoGraph.getHalfEdgeTwin(c);this.m_topoGraph.setHalfEdgeUserIndex(c,e,1),this.m_topoGraph.setHalfEdgeUserIndex(h,e,2)}o=a,a=s.getNextVertex(o)}}}flushVertices_(e,i){const s=this.m_topoGraph.getShape(),n=s.hasSegmentParentage(),r=new ii,o=s.insertPath(e,G);i.push(i[0]);const a=i.length;let l=G;for(let u=0;u<a;u++){const c=i[u];if(l=s.addVertex(o,c),!n)continue;const h=this.m_topoGraph.getClusterFromVertex(c);if(u>0&&this.m_topoGraph.isBreakNode(h)&&s.setSegmentParentageBreakVertex(l,!0),u<a-1){const d=this.m_topoGraph.getHalfEdgeConnector(h,this.m_topoGraph.getClusterFromVertex(i[u+1])),m=this.m_topoGraph.getSegmentParentage(d);s.setSegmentParentageAndBreak(l,m,u>0||this.m_topoGraph.isBreakNode(h)),this.m_topoGraph.isHalfEdgeCurve(d)&&(this.m_topoGraph.querySegmentXY(d,r),s.setSegmentToIndex(s.getVertexIndex(l),r.get().clone()))}}if(n){const u=this.m_topoGraph.getClusterFromVertex(i[a-1]);this.m_topoGraph.isBreakNode(u)&&s.setSegmentParentageBreakVertex(l,!0)}s.setClosedPath(o,!0)}processPolygonCuts_(e,i,s,n){const r=this.m_topoGraph.getGeometryID(s),o=this.m_topoGraph.getGeometryID(n),a=[],l=this.m_topoGraph.getShape(),u=this.m_topoGraph.createUserIndexForHalfEdges();for(let c=this.m_topoGraph.getFirstCluster();c!==G;c=this.m_topoGraph.getNextCluster(c)){const h=this.m_topoGraph.getClusterHalfEdge(c);if(h===G)continue;let d=h;do{if(this.m_topoGraph.getHalfEdgeUserIndex(d,u)!==1){let m=d,f=d,_=!1,v=0;do{if(this.m_topoGraph.setHalfEdgeUserIndex(m,u,1),!_&&this.m_topoGraph.getHalfEdgeParentage(m)&o&&this.m_topoGraph.getHalfEdgeFaceParentage(m)&r&&(f=m,_=!0),_){const x=this.m_topoGraph.getHalfEdgeOrigin(m),w=this.m_topoGraph.getClusterVertexIterator(x),T=this.m_topoGraph.getVertexFromVertexIterator(w);a.push(T),e!==-1&&this.m_topoGraph.getHalfEdgeParentage(m)&o&&(v|=this.m_topoGraph.getHalfEdgeUserIndex(m,e))}m=this.m_topoGraph.getHalfEdgeNext(m)}while(m!==f);if(_&&this.m_topoGraph.getChainArea(this.m_topoGraph.getHalfEdgeChain(f))>0){const x=l.createGeometry(q.enumPolygon);this.flushVertices_(x,a),i!==-1&&l.setGeometryUserIndex(x,i,v)}a.length=0}d=this.m_topoGraph.getHalfEdgeNext(this.m_topoGraph.getHalfEdgeTwin(d))}while(d!==h)}this.m_topoGraph.deleteUserIndexForHalfEdges(u)}cutPolygonPolyline_(e,i,s,n){this.m_topoGraph.removeSpikes_();let r=-1;e!==-1&&(r=this.m_topoGraph.createUserIndexForHalfEdges(),this.setHalfEdgeOrientations_(r,s)),this.processPolygonCuts_(r,e,i,s),r!==-1&&(this.m_topoGraph.deleteUserIndexForHalfEdges(r),r=-1);const o=this.m_topoGraph.getShape();for(let a=o.getFirstGeometry();a!==G;a=o.getNextGeometry(a))a!==i&&a!==s&&n.push(a);n.sort((a,l)=>{const u=o.getFirstPath(a),c=o.getRingArea(u),h=o.getFirstPath(l),d=o.getRingArea(h);return c<d?-1:c>d?1:0})}cut(e,i,s,n,r){const o=this.m_topoGraph.getShape().getGeometryType(s),a=this.m_topoGraph.getShape().getGeometryType(n),l=Pl(o),u=Pl(a);l!==2||u!==1?l!==1||u!==1?We(""):new hUe(this,e,i,s,n,r).Do():this.cutPolygonPolyline_(i,s,n,r)}progress_(e=!1){}isGoodParentage(e){return e>=0&&e<this.m_maskLookup.length&&this.m_maskLookup[e]}normalizeInputGeometry(e){const i=e.getGeometryType();if(i===q.enumEnvelope){const s=new Ci({vd:e.getDescription()});return e.isEmpty()||s.addEnvelope(e,!1),s}if(i===q.enumPoint){const s=new Dn({vd:e.getDescription()});return e.isEmpty()||s.add(e),s}if(nr(i)){const s=new Qi({vd:e.getDescription()});return e.isEmpty()||s.addSegment(e,!0),s}return i!==q.enumMultiPoint&&i!==q.enumPolyline&&i!==q.enumPolygon&&ce("Unexpected geometry type"),e}dissolveNonSimplePolygons(e,i,s,n){z(i>0);const r=new wn;let o=0,a=-1;for(let l=0,u=i;l<u;l++)e[l].getDimension()===2&&(a===-1&&(a=l),e[l].isEmpty()||(o++,r.addGeometry(e[l])));return o===0?(z(a>=0),this.normalizeInputGeometry(e[a])):this.planarSimplifyPolygons(r,s,!0,!1,-1,!0)}dissolveMultiPaths_(e,i,s,n,r,o,a){z(e>=1&&e<=2),z(n>0);const l=8&o?1:2,u=Sd.constructEmpty();let c=0,h=-1,d=!0;for(let V=0,H=n;V<H;V++)if(s[V].getDimension()===e&&(h===-1&&(h=V),!s[V].isEmpty())){h=V,c++;const Y=Sd.constructEmpty();if(s[V].queryLooseEnvelope(Y),u.mergeEnv3D(Y),e===2&&d&&s[V].getGeometryType()===q.enumPolygon)if(16&o){const W=[0],ee=s[V].getImpl().getIsSimple(0,W),ne=this.m_bOGCOutput?ee===5:ry(ee);d&&(d=ne)}else{const W=J3e(s[V],0);d&&(d=W)}}if(c<2&&(z(h>=0),c===0||!(16&o)))return this.normalizeInputGeometry(s[h]);if(!d){const V=yr(i?null:r,u.getEnvelope2D(),!0);return this.dissolveNonSimplePolygons(s,n,V,o)}const m=s.slice(0,n),f=yr(r,u.getEnvelope2D(),!0),_=10*Pu(f);let v=new pc(0,0);if(a&&(v=kP(r,u.getEnvelopeZs(),!0)),c===1&&e===1&&l===2&&!i)return a?tUe():this.m_bOGCOutput?gB(m[h],f,!1,-1,this.m_progressTracker,l,!1):vL(m[h],f,!1,!1,-1,this.m_progressTracker,l,!1);const x=new hA;x.startConstruction();let w=e===2?3:4,T=0;for(let V=0,H=n;V<H;V++){if(m[V].getDimension()!==e||m[V].isEmpty())continue;let Y=m[V].getGeometryType();if(Y!==q.enumEnvelope){if(nr(Y)?(m[V]=this.normalizeInputGeometry(m[V]),Y=q.enumPolyline):z(Ei(Y)),e===1){z(Y===q.enumPolyline);let ee=-1;if(a)z(0,"3d not implemented yet");else{const ne=[0];ee=m[V].getImpl().getIsSimple(f.total(),ne)}if(this.m_bOGCOutput?ee!==5:!ry(ee))if(i)w=-1;else{a?z(0,"3d not implemented yet"):this.m_bOGCOutput?m[V]=gB(m[V],f,!1,-1,this.m_progressTracker,l,!1):m[V]=vL(m[V],f,!1,!1,-1,this.m_progressTracker,l,!1);const ne=[0];z(ry(m[V].getImpl().getIsSimple(f.total(),ne)))}}else{z(Y===q.enumPolygon);const ee=[0],ne=m[V].getImpl().getIsSimple(0,ee);z(Gm(ne))}const W=m[V].getImpl();for(let ee=0,ne=W.getPathCount();ee<ne;ee++){const j=J.constructEmpty();W.queryLoosePathEnvelope(ee,j),j.inflateCoords(_,_),x.addEnvelope(T,j),T++}}else{z(Y===q.enumEnvelope);const W=J.constructEmpty();m[V].queryLooseEnvelope(W),W.inflateCoords(_,_),x.addEnvelope(T,W),T++,w=-1}}x.endConstruction();const C=T,M=st(C,-2147483647),A=st(C,-1);let I=0;h=-1,T=0;for(let V=0,H=n;V<H;V++){if(m[V].getDimension()!==e||(h===-1&&(h=V),m[V].isEmpty()))continue;h=V,I++;const Y=m[V].getGeometryType();if(Ei(Y))for(let W=0,ee=m[V].getPathCount();W<ee;W++)A[T]=V,M[T]=-W-1,T++;else z(Y===q.enumEnvelope),A[T]=V,M[T]=-1,T++}if(I<2&&e===2)return z(h>=0),this.normalizeInputGeometry(m[h]);let L=C;for(;x.next()&&L>0;){this.progress_();const V=x.getHandleA(),H=x.getHandleB(),Y=x.getElement(V),W=x.getElement(H);A[Y]!==A[W]&&(M[Y]<0&&(L--,M[Y]=-(M[Y]+1)),M[W]<0&&(L--,M[W]=-(M[W]+1)))}const D=new wn;let O=!1,U=0;for(let V=0,H=n;V<H;V++){if(m[V].getDimension()!==e||m[V].isEmpty())continue;const Y=m[V].getGeometryType(),W=U;let ee=0,ne=0;const j=Ei(Y)?m[V]:null;for(let oe=W,ve=M.length;oe<ve&&A[oe]===V;oe++)M[oe]>=0&&(ee++,ne+=j?j.getPathSize(M[oe]):DP(m[V])),U++;if(ne>.95*DP(m[V])){D.addGeometry(this.normalizeInputGeometry(m[V]));for(let oe=W;oe<U;oe++)M[oe]<0&&(M[oe]=-(M[oe]+1))}else{if(ee===0){O=!0;continue}{O=!0,z(Ei(Y)),z(j!=null);const oe=new Ci({vd:m[V].getDescription()}),ve=new Qi({vd:m[V].getDescription()}),Ye=Y===q.enumPolygon?oe:ve;for(let de=W;de<U;de++)M[de]>=0&&Ye.addPath(j,M[de],!0);D.addGeometry(Ye)}}}let $;if(D.getFirstGeometry()!==G){const V=e===2,H=i?yr(null,u.getEnvelope2D(),!0):f;let Y=new pc(0,0);if(a&&(Y=i?kP(null,u.getEnvelopeZs(),!0):v),e===2&&!(2&o)){D.collapseAllGeometriesToFirst();let W=0,ee=null;if(D.hasCurves()&&!D.hasSegmentParentage()){ee=new pu;const ne=D.getEnvelope2D(this.m_progressTracker);W=od(H.total()),nc(D,mu(H.total(),ne),H.total(),12e3,ee,null,this.m_progressTracker)}q4e(D,D.getFirstGeometry(),H.total(),this.m_progressTracker),ee!==null&&ee.stitchCurves(D,G,W,!0)}if(a)$=this.planarSimplify3DImpl_(D,H,Y,l,!0);else if(e===2)$=this.planarSimplifyPolygons(D,H,V,i,-1,!1);else{const W=b0();W.ogcRule=this.m_bOGCOutput,W.allCrossRoadsImpassable=!0,W.unsplitBehavior=l,$=this.planarSimplifyPolylines(D,H,i,W,-1)}if(!O){const W=[0];w=$.getImpl().getIsSimple(H.total(),W)}}else z(O),z(h>=0),$=e===2?new Ci({vd:m[h].getDescription()}):new Qi({vd:m[h].getDescription()});if(O){let V=0;for(let H=0,Y=M.length;H<Y;H++){const W=A[H];if(!(W<0)&&M[H]<0){const ee=m[W].getGeometryType(),ne=Ei(ee)?m[W]:null;if(ne){const j=-(M[H]+1);V+=ne.getPathSize(j)}else V+=4}}$.reserve($.getPointCount()+V);for(let H=0,Y=M.length;H<Y;H++){const W=A[H];if(!(W<0)&&M[H]<0){const ee=m[W].getGeometryType(),ne=Ei(ee)?m[W]:null;if(ne){const j=-(M[H]+1);$.addPath(ne,j,!0)}else ee===q.enumEnvelope?$.addEnvelope(m[W],!1):(z(nr(ee)),$.addSegment(m[W],!0))}}}let B=0;if(e===2?w!==-1&&(w=3,B=i?0:f.total()):(z(e===1),i||w===-1||(B=f.total())),a||$.getImpl().setIsSimple(w,B),!i&&O)if(e===2){if(!a)return new Am().execute($,r,!1,this.m_progressTracker);z(0,"3d not yet implemented")}else e===1&&l!==1&&($=a?iUe():eUe(this.m_bOGCOutput,$,l,this.m_progressTracker),$.getImpl().setIsSimple(w,B));return $}dissolveTopoGraphCommonEdges_(){const e=this.m_topoGraph.createUserIndexForHalfEdges(),i=[];for(let s=this.m_topoGraph.getFirstCluster();s!==G;s=this.m_topoGraph.getNextCluster(s)){const n=this.m_topoGraph.getClusterHalfEdge(s);let r=n;if(n!==G)do{if(this.progress_(),this.m_topoGraph.getHalfEdgeUserIndex(r,e)!==1){const o=this.m_topoGraph.getHalfEdgeTwin(r);this.m_topoGraph.setHalfEdgeUserIndex(o,e,1),this.m_topoGraph.setHalfEdgeUserIndex(r,e,1);const a=this.m_topoGraph.getHalfEdgeFaceParentage(r);if(this.isGoodParentage(a)){const l=this.m_topoGraph.getHalfEdgeFaceParentage(o);this.isGoodParentage(l)&&i.push(r)}}r=this.m_topoGraph.getHalfEdgeNext(this.m_topoGraph.getHalfEdgeTwin(r))}while(r!==n)}this.m_topoGraph.deleteUserIndexForHalfEdges(e),this.m_topoGraph.deleteEdgesBreakFaces_(i)}chooseVertexByOrder(e,i,s,n){let r=Aa(),o=G;for(let l=this.m_topoGraph.getClusterVertexIterator(e);l!==G;l=this.m_topoGraph.incrementVertexIterator(l)){const u=this.m_topoGraph.getVertexFromVertexIterator(l),c=i.getUserIndex(u,s);c>=0&&c<r&&(r=c,o=u)}z(o!==G);let a=i.getUserIndex(o,n);return a>0&&(i.setUserIndex(o,n,--a),a===0&&i.setUserIndex(o,s,-1)),o}chooseVertexFromCluster_(e,i){return this.m_topoGraph.getVertexDominantFromCluster(e,i)}chooseVertexFromVertexCluster_(e,i){return this.m_topoGraph.getVertexDominant(e,i)}collectPolygonPathsPreservingFrom_(e,i,s,n,r){const o=this.m_topoGraph.getShape();if(o.getGeometryType(e)!==q.enumPolygon)return;const a=o.hasSegmentParentage(),l=new ii;for(let u=o.getFirstPath(e);u!==G;u=o.getNextPath(u)){const c=o.getFirstVertex(u);this.m_topoGraph.getClusterFromVertex(c);const h=this.m_topoGraph.getHalfEdgeFromVertex(c);if(h===G)continue;const d=this.m_topoGraph.getHalfEdgeUserIndex(h,s);if(d===1||d===2)continue;const m=this.m_topoGraph.getHalfEdgeFaceParentage(h);if(!this.isGoodParentage(m)){this.m_topoGraph.setHalfEdgeUserIndex(h,s,2);continue}this.m_topoGraph.setHalfEdgeUserIndex(h,s,1);const f=o.insertPath(i,G);o.setClosedPath(f,!0);let _=h,v=c,x=this.m_topoGraph.getClusterFromVertex(v),w=1;do{this.progress_();const T=this.chooseVertexFromVertexCluster_(v,r),C=o.addVertex(f,T);if(this.m_topoGraph.isHalfEdgeCurve(_)&&(this.m_topoGraph.querySegmentXY(_,l),o.setSegmentToIndex(o.getVertexIndex(C),l.get().clone())),a){const L=this.m_topoGraph.getSegmentParentage(_);o.setSegmentParentageAndBreak(C,L,this.m_topoGraph.isBreakNode(x))}let M,A;n!==-1&&this.m_topoGraph.setClusterUserIndex(x,n,1),this.m_topoGraph.setHalfEdgeUserIndex(_,s,1),_=this.m_topoGraph.getHalfEdgeNext(_);do M=w===1?o.getNextVertex(v):o.getPrevVertex(v),A=M!==G?this.m_topoGraph.getClusterFromVertex(M):G;while(A===x);const I=this.m_topoGraph.getHalfEdgeOrigin(_);if(I!==A){do M=w===1?o.getPrevVertex(v):o.getNextVertex(v),A=M!==G?this.m_topoGraph.getClusterFromVertex(M):G;while(A===x);if(I!==A){A=I;const L=this.m_topoGraph.getClusterVertexIterator(A);M=this.m_topoGraph.getVertexFromVertexIterator(L)}else w=-w}x=A,v=M}while(_!==h)}}topoOperationPolygonPolygonHelper_(e,i,s,n,r,o){this.progress_(!0),e!==G&&this.collectPolygonPathsPreservingFrom_(e,s,r,o,n),i!==G&&this.collectPolygonPathsPreservingFrom_(i,s,r,o,n);const a=new ii,l=this.m_topoGraph.getShape();l.dbgVerifyCurves();const u=l.hasSegmentParentage();for(let c=this.m_topoGraph.getFirstCluster();c!==G;c=this.m_topoGraph.getNextCluster(c)){const h=this.m_topoGraph.getClusterHalfEdge(c);if(h===G)continue;let d=h;do{this.progress_();const m=this.m_topoGraph.getHalfEdgeUserIndex(d,r);if(m!==1&&m!==2){const f=this.m_topoGraph.getHalfEdgeFaceParentage(d);if(this.isGoodParentage(f)){const _=l.insertPath(s,G);l.setClosedPath(_,!0);let v=d;do{const x=this.m_topoGraph.getHalfEdgeVertexIterator(v);let w=G;if(x!==G)w=this.m_topoGraph.getVertexFromVertexIterator(x);else{const M=this.m_topoGraph.getHalfEdgeVertexIterator(this.m_topoGraph.getHalfEdgeTwin(v));w=this.m_topoGraph.getVertexFromVertexIterator(M),w=l.getNextVertex(w)}const T=this.chooseVertexFromVertexCluster_(w,n),C=l.addVertex(_,T);if(u){const M=this.m_topoGraph.getSegmentParentage(v),A=this.m_topoGraph.getHalfEdgeOrigin(v);l.setSegmentParentageAndBreak(C,M,this.m_topoGraph.isBreakNode(A))}if(this.m_topoGraph.isHalfEdgeCurve(v)&&(this.m_topoGraph.querySegmentXY(v,a),l.setSegmentToIndex(l.getVertexIndex(C),a.get().clone())),this.m_topoGraph.setHalfEdgeUserIndex(v,r,1),o!==-1){const M=this.m_topoGraph.getClusterFromVertex(T);this.m_topoGraph.setClusterUserIndex(M,o,1)}v=this.m_topoGraph.getHalfEdgeNext(v)}while(v!==d)}else this.m_topoGraph.setHalfEdgeUserIndex(d,r,2)}d=this.m_topoGraph.getHalfEdgeNext(this.m_topoGraph.getHalfEdgeTwin(d))}while(d!==h)}}topoOperationPolygonPolygon_(e,i,s,n=!1){this.dissolveTopoGraphCommonEdges_();const r=this.m_topoGraph.getShape(),o=r.createGeometry(q.enumPolygon),a=this.m_topoGraph.createUserIndexForHalfEdges();return this.topoOperationPolygonPolygonHelper_(e,i,o,s,a,-1),this.m_topoGraph.deleteUserIndexForHalfEdges(a),n||bf(r,o,3,this.m_bOGCOutput,G,this.m_progressTracker),o}topoOperationPolyline_(e,i){const s=b0();return s.allCrossRoadsImpassable=!1,s.ogcRule=i,s.unsplitBehavior=0,this.topoOperationPolylineSimplifyOrPolylineTopoHelper_(G,e,!1,s).first}topoOperationMultiPoint_(){const e=this.m_topoGraph.getShape(),i=e.createGeometry(q.enumMultiPoint),s=e.insertPath(i,G);for(let n=this.m_topoGraph.getFirstCluster();n!==G;n=this.m_topoGraph.getNextCluster(n)){const r=this.m_topoGraph.getClusterParentage(n);if(this.isGoodParentage(r)){let o=G;for(let a=this.m_topoGraph.getClusterVertexIterator(n);a!==G;a=this.m_topoGraph.incrementVertexIterator(a)){const l=this.m_topoGraph.getVertexFromVertexIterator(a);o===G&&(o=l);const u=e.getGeometryFromPath(e.getPathFromVertex(l)),c=this.m_topoGraph.getGeometryID(u);if(this.isGoodParentage(c)){o=l;break}}e.addVertex(s,o)}}return i}intersection(e,i){const s=this.m_topoGraph.getShape().getGeometryType(e),n=this.m_topoGraph.getShape().getGeometryType(i),r=Pl(s),o=Pl(n),a=this.m_topoGraph.getGeometryID(e),l=this.m_topoGraph.getGeometryID(i);z(a>=0),z(l>=0),this.m_maskLookup.length=0,this.m_maskLookup.length=1+(a|l),this.m_maskLookup[a|l]=!0;let u=G;return this.m_topoGraph.getShape().getVertexDescription().getAttributeCount()>1&&(u=e),r===2&&o===2?this.topoOperationPolygonPolygon_(e,i,u):r===1&&o>0||o===1&&r>0?this.topoOperationPolyline_(u,this.m_bOGCOutput):r===0||o===0?this.topoOperationMultiPoint_():void We("")}topoOperationPolygonPolygonEx(e,i,s){const n=this.m_topoGraph.getShape(),r=n.createGeometry(q.enumPolygon),o=n.createGeometry(q.enumPolyline),a=n.createGeometry(q.enumMultiPoint);this.dissolveTopoGraphCommonEdges_();let l=G;const u=this.m_topoGraph.createUserIndexForHalfEdges(),c=this.m_topoGraph.createUserIndexForClusters();n.dbgVerifyCurves(),this.topoOperationPolygonPolygonHelper_(e,i,r,s,u,c),n.dbgVerifyCurves();const h=n.hasSegmentParentage(),d=new ii;for(let f=this.m_topoGraph.getFirstCluster();f!==G;f=this.m_topoGraph.getNextCluster(f)){const _=this.m_topoGraph.getClusterHalfEdge(f);if(_===G)continue;let v=_;do{let x=this.m_topoGraph.getHalfEdgeUserIndex(v,u),w=this.m_topoGraph.getHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgeTwin(v),u),T=x|w;if(T===2){let C=this.m_topoGraph.getHalfEdgeParentage(v);if(this.isGoodParentage(C)){const M=n.insertPath(o,G);let A=v;const I=this.chooseVertexFromCluster_(f,s);let L=n.addVertex(M,I);if(h){const D=this.m_topoGraph.getSegmentParentage(v),O=this.m_topoGraph.getHalfEdgeOrigin(v);n.setSegmentParentageAndBreak(L,D,this.m_topoGraph.isBreakNode(O))}this.m_topoGraph.isHalfEdgeCurve(v)&&(this.m_topoGraph.querySegmentXY(v,d),n.setSegmentToIndex(n.getVertexIndex(L),d.get().clone())),this.m_topoGraph.setClusterUserIndex(f,c,1);do{this.progress_();const D=this.m_topoGraph.getHalfEdgeTo(A),O=this.chooseVertexFromCluster_(D,s);if(L=n.addVertex(M,O),h){const U=this.m_topoGraph.getSegmentParentage(v),$=this.m_topoGraph.getHalfEdgeOrigin(v);n.setSegmentParentageAndBreak(L,U,this.m_topoGraph.isBreakNode($))}if(this.m_topoGraph.setHalfEdgeUserIndex(A,u,1),this.m_topoGraph.setHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgeTwin(A),u,1),this.m_topoGraph.setClusterUserIndex(D,c,1),A=this.m_topoGraph.getHalfEdgeNext(A),x=this.m_topoGraph.getHalfEdgeUserIndex(A,u),w=this.m_topoGraph.getHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgeTwin(A),u),T=x|w,T!==2)break;if(C=this.m_topoGraph.getHalfEdgeParentage(A),!this.isGoodParentage(C)){this.m_topoGraph.setHalfEdgeUserIndex(A,u,1),this.m_topoGraph.setHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgeTwin(A),u,1);break}this.m_topoGraph.isHalfEdgeCurve(v)&&A!==v&&(this.m_topoGraph.querySegmentXY(v,d),n.setSegmentToIndex(n.getVertexIndex(L),d.get().clone()))}while(A!==v)}else this.m_topoGraph.setHalfEdgeUserIndex(v,u,1),this.m_topoGraph.setHalfEdgeUserIndex(this.m_topoGraph.getHalfEdgeTwin(v),u,1)}v=this.m_topoGraph.getHalfEdgeNext(this.m_topoGraph.getHalfEdgeTwin(v))}while(v!==_)}for(let f=this.m_topoGraph.getFirstCluster();f!==G;f=this.m_topoGraph.getNextCluster(f)){if(this.progress_(),this.m_topoGraph.getClusterUserIndex(f,c)===1)continue;const _=this.m_topoGraph.getClusterParentage(f);if(this.isGoodParentage(_)){l===G&&(l=n.insertPath(a,G));const v=this.m_topoGraph.getClusterVertexIterator(f);let x=G;if(v!==G){x=this.m_topoGraph.getVertexFromVertexIterator(v);const w=this.chooseVertexFromVertexCluster_(x,s);n.addVertex(l,w)}}}this.m_topoGraph.deleteUserIndexForClusters(c),this.m_topoGraph.deleteUserIndexForHalfEdges(u),n.dbgVerifyCurves(),bf(n,r,3,this.m_bOGCOutput,G,this.m_progressTracker);const m=[G,G,G];return m[0]=a,m[1]=o,m[2]=r,m}topoOperationPolylinePolylineOrPolygonEx(e,i){const s=b0();return s.allCrossRoadsImpassable=!1,s.ogcRule=i,s.unsplitBehavior=0,this.topoOperationPolylineSimplifyOrPolylineTopoHelper_(G,e,!0,s)}topoOperationMultiPoint(){const e=this.m_topoGraph.getShape(),i=e.createGeometry(q.enumMultiPoint),s=e.insertPath(i,G);for(let n=this.m_topoGraph.getFirstCluster();n!==G;n=this.m_topoGraph.getNextCluster(n)){const r=this.m_topoGraph.getClusterParentage(n);if(this.isGoodParentage(r)){let o=G;for(let a=this.m_topoGraph.getClusterVertexIterator(n);a!==G;a=this.m_topoGraph.incrementVertexIterator(a)){const l=this.m_topoGraph.getVertexFromVertexIterator(a);o===G&&(o=l);const u=e.getGeometryFromPath(e.getPathFromVertex(l)),c=this.m_topoGraph.getGeometryID(u);if(this.isGoodParentage(c)){o=l;break}}e.addVertex(s,o)}}return i}intersectionEx(e,i){const s=this.m_topoGraph.getShape().getGeometryType(e),n=this.m_topoGraph.getShape().getGeometryType(i),r=jD(s),o=jD(n),a=this.m_topoGraph.getGeometryID(e),l=this.m_topoGraph.getGeometryID(i);z(a>=0),z(l>=0),this.m_maskLookup.length=0,this.m_maskLookup.length=1+(a|l),this.m_maskLookup[a|l]=!0;let u=G;if(this.m_topoGraph.getShape().getVertexDescription().getAttributeCount()>1&&(u=e),r===2&&o===2)return this.topoOperationPolygonPolygonEx(e,i,u);if(r===1&&o>0||o===1&&r>0){const{first:c,second:h}=this.topoOperationPolylinePolylineOrPolygonEx(u,this.m_bOGCOutput);return[h,c]}if(r===0||o===0){const c=[];return c.push(this.topoOperationMultiPoint()),c}We("")}getCombinedHalfEdgeParentage(e){return this.m_topoGraph.getHalfEdgeParentage(e)|this.m_topoGraph.getHalfEdgeFaceParentage(e)|this.m_topoGraph.getHalfEdgeFaceParentage(this.m_topoGraph.getHalfEdgeTwin(e))}prevailingDirection(e,i){const s=this.getCombinedHalfEdgeParentage(i),n=this.m_topoGraph.getHalfEdgeOrigin(i),r=this.m_topoGraph.getHalfEdgeTo(i);let o=0,a=0;for(let l=this.m_topoGraph.getClusterVertexIterator(n);l!==G;l=this.m_topoGraph.incrementVertexIterator(l)){const u=this.m_topoGraph.getVertexFromVertexIterator(l),c=e.getPathFromVertex(u),h=e.getGeometryFromPath(c),d=this.m_topoGraph.getGeometryID(h),m=e.getFirstVertex(c),f=!!(d&s);f&&m===u&&(this.m_fromEdgeForPolylines=i);const _=e.getNextVertex(u);if(_!==G&&this.m_topoGraph.getClusterFromVertex(_)===r){if(o++,f){if(this.m_fromEdgeForPolylines===G&&m===_){const v=this.m_topoGraph.getHalfEdgeNext(i);this.isGoodParentage(this.getCombinedHalfEdgeParentage(v))&&(this.m_fromEdgeForPolylines=v)}a++}}else{const v=e.getPrevVertex(u);if(v!==G&&this.m_topoGraph.getClusterFromVertex(v)===r&&(o--,f)){if(this.m_fromEdgeForPolylines===G&&m===v){const x=this.m_topoGraph.getHalfEdgeNext(i);this.isGoodParentage(this.getCombinedHalfEdgeParentage(x))&&(this.m_fromEdgeForPolylines=x)}a--}}}return this.m_topoGraph.queryXY(n,this.m_dummyPt1),this.m_topoGraph.queryXY(r,this.m_dummyPt2),(a!==0?a:o)*N.distance(this.m_dummyPt1,this.m_dummyPt2)}tryMoveThroughCrossroadBackwards(e,i){const s=this.m_topoGraph.getHalfEdgePrev(e),n=this.m_topoGraph.getHalfEdgeTwin(s);if(!i){if(this.m_topoGraph.isStrongPathNode(this.m_topoGraph.getHalfEdgeOrigin(e)))return G;const a=this.m_topoGraph.getHalfEdgeTwin(e);if(n===this.m_topoGraph.getHalfEdgeNext(a))return s}let r=n,o=G;for(;r!==e;){const a=this.getCombinedHalfEdgeParentage(r);if(this.isGoodParentage(a)){if(o!==G)return G;o=this.m_topoGraph.getHalfEdgeTwin(r)}r=this.m_topoGraph.getHalfEdgeTwin(this.m_topoGraph.getHalfEdgePrev(r))}return o}tryMoveThroughCrossroadForward(e,i){const s=this.m_topoGraph.getHalfEdgeNext(e),n=this.m_topoGraph.getHalfEdgeTwin(s);if(!i){const a=this.m_topoGraph.getHalfEdgeTwin(e);if(this.m_topoGraph.isStrongPathNode(this.m_topoGraph.getHalfEdgeOrigin(a)))return G;if(n===this.m_topoGraph.getHalfEdgePrev(a))return s}let r=n,o=G;for(;r!==e;){const a=this.getCombinedHalfEdgeParentage(r);if(this.isGoodParentage(a)){if(o!==G)return G;o=this.m_topoGraph.getHalfEdgeTwin(r)}r=this.m_topoGraph.getHalfEdgeTwin(this.m_topoGraph.getHalfEdgeNext(r))}return o}isOnALoop(e,i){let s=e;const n=2*this.m_topoGraph.getShape().getTotalPointCount()+10;for(let r=0;r<n;r++){if(this.m_topoGraph.getHalfEdgeUserIndex(s,i)===1)return!1;const o=this.m_topoGraph.getHalfEdgeNext(s);if(o===this.m_topoGraph.getHalfEdgeTwin(s))return!1;if(s=o,s===e)return!0}We("is_on_a_loop_")}restorePolylineParts(e,i,s,n,r,o,a,l,u,c){z(r===G&&o>=0&&a>=0||o===-1&&a===-1),z(l===-1&&c.unsplitBehavior!==1||l!==-1&&c.unsplitBehavior===1);const h=c.ogcRule,d=c.allCrossRoadsImpassable,m=c.unsplitBehavior===1,f=c.unsplitBehavior===0,_=this.m_topoGraph.getShape(),v=_.hasSegmentParentage();let x=e,w=this.m_topoGraph.getHalfEdgeTwin(x);const T=new ii;this.m_fromEdgeForPolylines=G;let C=this.prevailingDirection(_,x),M=x,A=G,I=!1,L=!1,D=!1;if(!m)for(;;){const de=this.m_topoGraph.getHalfEdgePrev(x);if(de===w){D=!0;break}const fe=this.m_topoGraph.getHalfEdgeNext(w);if(this.m_topoGraph.isStrongPathNode(this.m_topoGraph.getHalfEdgeOrigin(fe))){I=!0;break}if(this.m_topoGraph.getHalfEdgeTwin(de)!==fe){if(d){I=!0;break}if(x=this.tryMoveThroughCrossroadBackwards(x,!0),x===G){I=!0;break}w=this.m_topoGraph.getHalfEdgeTwin(x)}else x=de,w=fe;if(this.m_topoGraph.getHalfEdgeUserIndex(x,s)===1){D=!0;break}if(x===e){A=e,L=!0;break}const Ne=this.getCombinedHalfEdgeParentage(x);if(!this.isGoodParentage(Ne))break;M=x,C+=this.prevailingDirection(_,x)}if(A===G){for(x=e,w=this.m_topoGraph.getHalfEdgeTwin(x),A=x;;){const fe=this.m_topoGraph.getHalfEdgeNext(x),Ne=this.m_topoGraph.isStrongPathNode(this.m_topoGraph.getHalfEdgeOrigin(fe));if(Ne){I=!0;break}if(fe===w){D=!0;break}if(l!==-1){const Zt=this.m_topoGraph.getHalfEdgeOrigin(w);if(this.m_topoGraph.getClusterUserIndex(Zt,l)===1){I=!0;break}}const je=this.m_topoGraph.getHalfEdgePrev(w);if(this.m_topoGraph.getHalfEdgeTwin(fe)!==je){if(Ne||d){I=!0;break}if(x=this.tryMoveThroughCrossroadForward(x,!0),x===G){I=!0;break}w=this.m_topoGraph.getHalfEdgeTwin(x)}else x=fe,w=je;if(this.m_topoGraph.getHalfEdgeUserIndex(x,s)===1){D=!0;break}const Ee=this.getCombinedHalfEdgeParentage(x);if(!this.isGoodParentage(Ee))break;A=x,C+=this.prevailingDirection(_,x)}const de=this.m_topoGraph.getHalfEdgeOrigin(M);L=this.m_topoGraph.getHalfEdgeTo(A)===de}else if(this.m_fromEdgeForPolylines!==G){M=e,A=this.tryMoveThroughCrossroadBackwards(M,!1),z(A!==G);const de=this.m_topoGraph.getHalfEdgeTwin(M);this.m_topoGraph.getHalfEdgeNext(de)}let O=L;L||D||u&&(O=this.isOnALoop(e,s),O||(O=this.isOnALoop(w,s)));const U=C>=0;let $=!1;O&&I&&(L?($=h,U&&($||m||f)&&M!==e&&(z(!m),M=e,$=!1)):(m||U&&f)&&(M=e));let B=0;for(x=M;w=this.m_topoGraph.getHalfEdgeTwin(x),this.m_topoGraph.setHalfEdgeUserIndex(x,s,1),this.m_topoGraph.setHalfEdgeUserIndex(w,s,1),B++,x!==A;)x=d?this.m_topoGraph.getHalfEdgeNext(x):this.tryMoveThroughCrossroadForward(x,!1);U||(A=Ge(M,M=A),A=this.m_topoGraph.getHalfEdgeTwin(A),M=this.m_topoGraph.getHalfEdgeTwin(M));let V=_.insertPath(i,G);x=M;const H=this.m_topoGraph.getHalfEdgeOrigin(M);let Y;Y=o!==-1?this.chooseVertexByOrder(H,_,o,a):this.chooseVertexFromCluster_(H,r),this.m_topoGraph.isStrongPathNode(H)&&_.setStrongPathStart(V,!0);let W=_.addVertex(V,Y),ee=W;n!==-1&&this.m_topoGraph.setClusterUserIndex(H,n,1);let ne=0;const j=$?Math.trunc((B+1)/2):-1;let oe=G,ve=!0,Ye=G;for(;;){if(v){const je=this.m_topoGraph.getSegmentParentage(x),Ee=this.m_topoGraph.getHalfEdgeOrigin(x);_.setSegmentParentageAndBreak(ee,je,ve||this.m_topoGraph.isBreakNode(Ee))}ve=!1,this.m_topoGraph.isHalfEdgeCurve(x)&&(this.m_topoGraph.querySegmentXY(x,T),_.setSegmentToIndex(_.getVertexIndex(ee),T.get().clone())),oe!==G&&a!==-1&&_.addToUserIndex(oe,a,-1);const de=d?this.m_topoGraph.getHalfEdgeNext(x):this.tryMoveThroughCrossroadForward(x,!1),fe=this.m_topoGraph.getHalfEdgeTo(x);let Ne;if(Ne=o!==-1?this.chooseVertexByOrder(fe,_,o,a):this.chooseVertexFromCluster_(fe,r),W=_.addVertex(V,Ne),Ye=fe,n!==-1&&this.m_topoGraph.setClusterUserIndex(fe,n,1),v&&this.m_topoGraph.isBreakNode(fe)&&_.setSegmentParentageBreakVertex(W,!0),oe=Ne,ne++,$&&ne===j&&(V=_.insertPath(i,G),W=_.addVertex(V,Ne),ve=!0,a!==-1&&_.addToUserIndex(Ne,a,-1),oe=G),x===A)break;x=de,ee=W}Ye!==G&&this.m_topoGraph.isStrongPathNode(Ye)&&_.setStrongPathEnd(V,!0)}topoOperationPolylineSimplify_(e,i){return this.topoOperationPolylineSimplifyOrPolylineTopoHelper_(e,G,!1,i).first}topoOperationPolylineSimplifyOrPolylineTopoHelper_(e,i,s,n){z(i===G||e===G);const r=this.m_topoGraph.getShape(),o=f=>f=e===G?f===G?r.getFirstGeometry():r.getNextGeometry(f):f===G?e:G,a=r.createGeometry(q.enumPolyline);let l=-1;s&&(l=this.m_topoGraph.createUserIndexForClusters());const u=this.m_topoGraph.createUserIndexForHalfEdges(),c=i===G?r.createUserIndex():-1,h=i===G?r.createUserIndex():-1;let d=-1;if(n.unsplitBehavior===1){d=this.m_topoGraph.createUserIndexForClusters();for(let f=o(G);f!==G;f=o(f))for(let _=r.getFirstPath(f);_!==G;_=r.getNextPath(_)){{const v=r.getFirstVertex(_),x=this.m_topoGraph.getClusterFromVertex(v);this.m_topoGraph.setClusterUserIndex(x,d,1)}if(!r.isClosedPath(_)){const v=r.getLastVertex(_),x=this.m_topoGraph.getClusterFromVertex(v);this.m_topoGraph.setClusterUserIndex(x,d,1)}}}if(i===G){let f=0;for(let _=o(G);_!==G;_=o(_))for(let v=r.getFirstPath(_);v!==G;v=r.getNextPath(v))if(r.isClosedPath(v)){let x=r.getFirstVertex(v);for(let w=0,T=r.getPathSize(v);w<T;w++,x=r.getNextVertex(x))r.setUserIndex(x,c,f++),r.setUserIndex(x,h,2)}else{const x=r.getFirstVertex(v);r.setUserIndex(x,c,f++),r.setUserIndex(x,h,1);let w=r.getNextVertex(x);for(let T=1,C=r.getPathSize(v)-1;T<C;++T)r.setUserIndex(w,c,f++),r.setUserIndex(w,h,2),w=r.getNextVertex(w);r.setUserIndex(w,c,f++),r.setUserIndex(w,h,1)}}for(let f=o(G);f!==G;f=o(f))for(let _=r.getFirstPath(f);_!==G;_=r.getNextPath(_)){let v=r.getFirstVertex(_);for(let x=0,w=r.getPathSize(_);x<w;x++,v=r.getNextVertex(v)){const T=this.m_topoGraph.getHalfEdgeFromVertex(v);if(T===G||this.m_topoGraph.getHalfEdgeUserIndex(T,u)===1)continue;const C=this.getCombinedHalfEdgeParentage(T);if(this.isGoodParentage(C)){const M=x===0;this.restorePolylineParts(T,a,u,l,i,c,h,d,M,n)}}}let m=G;if(s){m=r.createGeometry(q.enumMultiPoint);let f=G;for(let _=this.m_topoGraph.getFirstCluster();_!==G;_=this.m_topoGraph.getNextCluster(_))if(this.progress_(),this.m_topoGraph.getClusterUserIndex(_,l)!==1){const v=this.m_topoGraph.getClusterParentage(_);if(this.isGoodParentage(v)){f===G&&(f=r.insertPath(m,G));const x=this.m_topoGraph.getClusterVertexIterator(_);if(x!==G){let w;this.m_topoGraph.getVertexFromVertexIterator(x),w=c!==-1?this.chooseVertexByOrder(_,r,c,h):this.chooseVertexFromCluster_(_,i),r.addVertex(f,w)}}}}return h!==-1&&r.removeUserIndex(h),c!==-1&&r.removeUserIndex(c),l!==-1&&r.removeUserIndex(l),this.m_topoGraph.deleteUserIndexForHalfEdges(u),gr(a,m)}difference(e,i){const s=this.m_topoGraph.getShape().getGeometryType(e),n=this.m_topoGraph.getShape().getGeometryType(i),r=Pl(s),o=Pl(n);if(r>o)return e;const a=this.m_topoGraph.getGeometryID(e),l=this.m_topoGraph.getGeometryID(i);if(this.m_maskLookup.length=0,this.m_maskLookup.length=1+(a|l),this.m_maskLookup[a]=!0,r===2&&o===2){let u=G;return this.m_topoGraph.getShape().getVertexDescription().getAttributeCount()>1&&(u=e),this.topoOperationPolygonPolygon_(e,i,u)}if(r===1&&o===2){const u=b0();return u.allCrossRoadsImpassable=!1,u.ogcRule=this.m_bOGCOutput,u.unsplitBehavior=0,this.topoOperationPolylineSimplifyOrPolylineTopoHelper_(e,G,!1,u).first}if(r===1&&o===1){const u=b0();return u.allCrossRoadsImpassable=!0,u.ogcRule=this.m_bOGCOutput,u.unsplitBehavior=0,this.topoOperationPolylineSimplifyOrPolylineTopoHelper_(e,G,!1,u).first}if(r===0)return this.topoOperationMultiPoint_();We("")}symmetricDifference(e,i){const s=this.m_topoGraph.getShape().getGeometryType(e),n=this.m_topoGraph.getShape().getGeometryType(i),r=jD(s),o=jD(n),a=this.m_topoGraph.getGeometryID(e),l=this.m_topoGraph.getGeometryID(i);return z(a>=0),z(l>=0),this.m_maskLookup.length=0,this.m_maskLookup.length=1+(a|l),this.m_maskLookup[a]=!0,this.m_maskLookup[a]=!0,this.m_maskLookup[l]=!0,r===2&&o===2?this.topoOperationPolygonPolygon_(e,i,G):r===1&&o===1?this.topoOperationPolyline_(G,this.m_bOGCOutput):r===0&&o===0?this.topoOperationMultiPoint():void We("")}planarSimplifyNoCrackingAndCluster(e,i,s,n){this.m_bOGCOutput=e,this.m_topoGraph=new sc;const r=i.getFillRule(s),o=i.getGeometryType(s);if(r!==1||o===q.enumMultiPoint?this.m_topoGraph.setAndSimplifyEditShapeAlternate(i,s,this.m_progressTracker):this.m_topoGraph.setAndSimplifyEditShapeWinding(i,s,this.m_progressTracker),this.m_topoGraph.dirtyCheckFailed())return!1;this.m_topoGraph.setCheckDirtyPlanesweepTolerance(Number.NaN);const a=this.m_topoGraph.getGeometryID(s);if(z(a>=0),this.m_maskLookup.length=0,this.m_maskLookup.length=a+1,this.m_maskLookup[a]=!0,i.getGeometryType(s)===q.enumPolygon||r===1&&i.getGeometryType(s)!==q.enumMultiPoint){i.setFillRule(s,0);const l=this.topoOperationPolygonPolygon_(s,G,G);if(i.swapGeometry(l,s),i.removeGeometry(l),r===1&&this.m_bOGCOutput)return this.planarSimplifyNoCrackingAndCluster(e,i,s,n)}else if(i.getGeometryType(s)===q.enumPolyline){const l=b0();l.ogcRule=this.m_bOGCOutput,l.allCrossRoadsImpassable=!0,l.unsplitBehavior=n;const u=this.topoOperationPolylineSimplify_(i.getFirstGeometry(),l);i.swapGeometry(u,s),i.removeGeometry(u)}else if(i.getGeometryType(s)===q.enumMultiPoint){const l=this.topoOperationMultiPoint_();i.swapGeometry(l,s),i.removeGeometry(l)}else We("");return!0}unsplitPolylineExact(e){return z(0),new Qi}planarSimplifyPolylines(e,i,s,n,r){for(let m=e.getFirstGeometry();m!==G;m=e.getNextGeometry(m)){const f=e.getGeometryType(m);z(f===q.enumPolyline)}let o=0,a=0,l=null;if(e.hasCurves()&&!e.hasSegmentParentage()){l=new pu;const m=e.getEnvelope2D(this.m_progressTracker);a=od(i.total());const f=mu(i.total(),m);o=ud(f,a),nc(e,f,i.total(),12e3,l,null,this.m_progressTracker)}{const m=rge(i.add(o));e.filterClosePoints(m,!1,!1,!1,G)}if(this.m_topoGraph=new sc,r!==4&&r!==5)if(l===null&&s){const m=new fB(this.m_progressTracker,!1);m.sweepVertical(e,i.total()),m.hadComplications()?(Qh(e,i,this.m_progressTracker,!0,!1),s=!1):this.m_topoGraph.setCheckDirtyPlanesweepTolerance(i.total())}else Qh(e,i.add(o),this.m_progressTracker,!0,!1),s=!1;else s=!1;e.removeSelection(),e.collapseAllGeometriesToFirst();const u=e.getFirstGeometry();if(this.m_topoGraph.setAndSimplifyEditShapeAlternate(e,u,this.m_progressTracker),this.m_topoGraph.dirtyCheckFailed())return z(s&&l===null),this.m_topoGraph.removeShape(),this.m_topoGraph=null,this.planarSimplifyPolylines(e,i,!1,n,-1);this.m_topoGraph.setCheckDirtyPlanesweepTolerance(Number.NaN);const c=this.m_topoGraph.getGeometryID(u);z(c>=0),this.m_maskLookup.length=0,this.m_maskLookup.length=c+1,this.m_maskLookup[c]=!0;const h=this.topoOperationPolylineSimplify_(e.getFirstGeometry(),n);l!==null&&l.stitchCurves(e,h,a,!0);const d=e.getGeometry(h);return s||d.getImpl().setIsSimple(4,i.total()),d}planarSimplifyMultiPoints(e,i,s,n){for(let u=e.getFirstGeometry();u!==G;u=e.getNextGeometry(u)){const c=e.getGeometryType(u);z(c===q.enumMultiPoint)}this.m_topoGraph=new sc,n!==4&&n!==5&&Qh(e,i,this.m_progressTracker,!0,!1),s=!1,e.removeSelection(),e.collapseAllGeometriesToFirst();const r=e.getFirstGeometry();if(this.m_topoGraph.setAndSimplifyEditShapeAlternate(e,r,this.m_progressTracker),this.m_topoGraph.dirtyCheckFailed())return z(s),this.m_topoGraph.removeShape(),this.m_topoGraph=null,this.planarSimplifyMultiPoints(e,i,!1,-1);this.m_topoGraph.setCheckDirtyPlanesweepTolerance(Number.NaN);const o=this.m_topoGraph.getGeometryID(r);z(o>=0),this.m_maskLookup.length=0,this.m_maskLookup.length=o+1,this.m_maskLookup[o]=!0;const a=this.topoOperationMultiPoint(),l=e.getGeometry(a);return s||l.getImpl().setIsSimple(4,i.total()),l}planarSimplifyPolygons(e,i,s,n,r,o){for(let v=e.getFirstGeometry();v!==G;v=e.getNextGeometry(v)){const x=e.getGeometryType(v);z(x===q.enumPolygon||x===q.enumPolyline&&s)}let a=0,l=0,u=null;if(e.hasCurves()&&!e.hasSegmentParentage()){u=new pu;const v=e.getEnvelope2D(this.m_progressTracker);l=od(i.total());const x=mu(i.total(),v);a=ud(x,l),nc(e,x,i.total(),12e3,u,null,this.m_progressTracker)}if(o){Qh(e,i.add(a),this.m_progressTracker,!0,!1);for(let v=e.getFirstGeometry();v!==G;v=e.getNextGeometry(v))e.getGeometryType(v)===q.enumPolygon&&bf(e,v,-1,!1,G,this.m_progressTracker)}if(this.m_topoGraph=new sc,o||r===4||r===5)n=!1;else if(u===null&&n){const v=new fB(this.m_progressTracker,!1);v.sweepVertical(e,i.total()),v.hadComplications()?(Qh(e,i,this.m_progressTracker,!0,!1),n=!1):this.m_topoGraph.setCheckDirtyPlanesweepTolerance(i.total())}else Qh(e,i.add(a),this.m_progressTracker,!0,!1),n=!1;e.removeSelection(),e.collapseAllGeometriesToFirst();const c=e.getFirstGeometry();if(s?this.m_topoGraph.setAndSimplifyEditShapeWinding(e,c,this.m_progressTracker):this.m_topoGraph.setAndSimplifyEditShapeAlternate(e,c,this.m_progressTracker),this.m_topoGraph.dirtyCheckFailed())return z(n&&u===null),this.m_topoGraph.removeShape(),this.m_topoGraph=null,this.planarSimplifyPolygons(e,i,s,!1,-1,!1);this.m_topoGraph.setCheckDirtyPlanesweepTolerance(Number.NaN);const h=this.m_topoGraph.getGeometryID(c);z(h>=0),this.m_maskLookup.length=0,this.m_maskLookup.length=h+1,this.m_maskLookup[h]=!0,e.setFillRule(c,0);const d=this.m_bOGCOutput&&s,m=d;let f=this.topoOperationPolygonPolygon_(c,G,G,m);d&&(this.m_topoGraph.removeShape(),this.m_topoGraph=null,e.removeGeometry(c),this.m_topoGraph=new sc,this.m_topoGraph.setAndSimplifyEditShapeAlternate(e,f,this.m_progressTracker),f=this.topoOperationPolygonPolygon_(f,G,G,!1)),u!==null&&u.stitchCurves(e,f,l,!0);const _=e.getGeometry(f);return _.setFillRule(0),n?_.getImpl().setIsSimple(3,0):(_.getImpl().setIsSimple(4,i.total()),_.getImpl().updateOGCFlagsProtected()),_}planarSimplify3DImpl_(e,i,s,n,r){return z(0),{}}planarSimplifyImpl_(e,i,s,n,r,o,a,l){if(e.isEmpty())return e.clone();const u=e.getGeometryType(),c=new wn,h=c.addGeometry(e);if(Gm(r)&&u===q.enumPolygon&&(s=!1,c.setFillRule(h,0)),l&&(e.hasAttribute(1)&&c.replaceNaNs(1,0),c.removeNaNVertices()),u===q.enumPolygon||u===q.enumPolyline&&s)return this.planarSimplifyPolygons(c,i,s,n,r,!1);if(u===Qi.type){const d=b0();return d.allCrossRoadsImpassable=!0,d.ogcRule=this.m_bOGCOutput,d.unsplitBehavior=a,this.planarSimplifyPolylines(c,i,n,d,r)}if(u===q.enumMultiPoint)return this.planarSimplifyMultiPoints(c,i,n,r);We("what else?")}}function uUe(t,e,i,s){if(t.isEmpty())return t.createInstance();if(e.isEmpty())return s?t.createInstance():new Jt({copy:t});const n=[new N],r=[0],o=e.getDimension()===2;return e.getDimension()!==1&&e.getDimension()!==2&&We(""),n[0]=t.getXY(),o?uj(e,n,1,i.total(),r):ige(e,n,1,i.total(),r),r[0]===0?t.createInstance():t}function cUe(t,e,i,s){const n=t.createInstance(),r=he(N,100),o=new Array(100),a=t.getPointCount();let l=!0;const u=e.getDimension()===2;e.getDimension()!==1&&e.getDimension()!==2&&We("");for(let c=0;c<a;){const h=t.queryCoordinates(r,r.length,c,-1)-c;u?uj(e,r,h,i.total(),o):ige(e,r,h,i.total(),o);let d=0;for(let m=0;m<h;m++)o[m]===0&&(l&&(l=!1,n.addPoints(t,0,c)),d!==m&&n.addPoints(t,c+d,c+m),d=m+1);l||d===h||n.addPoints(t,c+d,c+h),c+=h}return l?t:n}function fu(t,e,i,s){const n=t.getGeometryType();if(n===q.enumEnvelope){const r=new Ci({vd:t.getDescription()});return t.isEmpty()||r.addEnvelope(t,!1),r}if(n===q.enumPoint&&(s==="|"||s==="^")){const r=new Dn({vd:t.getDescription()});return t.isEmpty()||r.add(t),r}if(n===q.enumLine){const r=new Qi({vd:t.getDescription()});return t.isEmpty()||r.addSegment(t,!0),r}if(n===q.enumMultiPoint&&s==="-"&&e.getGeometryType()===q.enumPoint){const r=new Jt({vd:t.getDescription()});return t.isEmpty()||t.getPointByVal(0,r),r}if(n===q.enumMultiPoint&&s==="&"&&e.getGeometryType()===q.enumPoint){const r=new Jt({vd:t.getDescription()});return t.isEmpty()||t.getPointByVal(0,r),r}return t}function _r(t){const e=t.getGeometryType();if(e===q.enumEnvelope){const i=new Ci({vd:t.getDescription()});return t.isEmpty()||i.addEnvelope(t,!1),i}if(e===q.enumPoint){const i=new Dn({vd:t.getDescription()});return t.isEmpty()||i.add(t),i}if(K$e(e)){const i=new Qi({vd:t.getDescription()});return t.isEmpty()||i.addSegment(t,!0),i}return e!==q.enumMultiPoint&&e!==q.enumPolyline&&e!==q.enumPolygon&&ce("Unexpected geometry type"),t}function XU(t,e,i,s){const n=i===G?t.getClusterHalfEdge(e):i;let r=n;z(t.getHalfEdgeOrigin(n)===e);do s(r),r=t.getHalfEdgeNext(t.getHalfEdgeTwin(r));while(r!==n)}class hUe{constructor(e,i,s,n,r,o){this.m_rParent=e,this.m_rTopoGraph=e.m_topoGraph,this.m_rShape=this.m_rTopoGraph.getShape(),this.m_IDCuttee=this.m_rTopoGraph.getGeometryID(n),this.m_IDCutter=this.m_rTopoGraph.getGeometryID(r),this.m_IDBoth=this.m_IDCuttee|this.m_IDCutter,this.m_bConsiderTouch=i,this.m_sideIndex=s,this.m_cuttee=n,this.m_cutter=r,this.m_rCutHandles=o,this.m_cutteeBreadcrumbsIndex=this.m_rShape.createUserIndexUninitialized(),this.m_clusterParentageIndex=this.m_rShape.createUserIndexUninitialized();for(let a=this.m_rShape.getFirstPath(this.m_cuttee);a!==G;a=this.m_rShape.getNextPath(a)){let l=0;const u=this.m_rShape.getPathSize(a);for(let c=this.m_rShape.getFirstVertex(a);l<u;l++,c=this.m_rShape.getNextVertex(c))this.m_rShape.setUserIndex(c,this.m_clusterParentageIndex,this.m_rTopoGraph.getClusterParentage(this.m_rTopoGraph.getClusterFromVertex(c)))}}Do(){this.cutPolylinePolyline_(),this.m_rShape.removeUserIndex(this.m_cutteeBreadcrumbsIndex),this.m_rShape.removeUserIndex(this.m_clusterParentageIndex)}setTbd(e){return 8|e}classifyStandardCut(e,i,s,n){const r=this.m_rShape.getPrevVertex(e),o=this.m_rShape.getNextVertex(e),a=r===G?G:this.m_rTopoGraph.getHalfEdgeConnector(i,this.m_rTopoGraph.getClusterFromVertex(r)),l=o===G?G:this.m_rTopoGraph.getHalfEdgeConnector(i,this.m_rTopoGraph.getClusterFromVertex(o)),u=this.m_rTopoGraph.getHalfEdgeConnector(i,this.m_rTopoGraph.getClusterFromVertex(s)),c=this.m_rTopoGraph.getHalfEdgeConnector(i,this.m_rTopoGraph.getClusterFromVertex(n));let h=1,d=32,m=32;if(XU(this.m_rTopoGraph,i,c,f=>{f===u&&(h=2),f===a&&(d=h),f===l&&(m=h)}),this.m_bConsiderTouch)d!==32&&this.m_rShape.setUserIndex(r,this.m_cutteeBreadcrumbsIndex,this.m_rShape.getUserIndex(r,this.m_cutteeBreadcrumbsIndex)|d),m!==32&&this.m_rShape.setUserIndex(e,this.m_cutteeBreadcrumbsIndex,this.m_rShape.getUserIndex(e,this.m_cutteeBreadcrumbsIndex)|m);else{if(d===32||m===32||d===m&&!(a===u||a===c||l===u||l===c))return 1;this.m_rShape.setUserIndex(r,this.m_cutteeBreadcrumbsIndex,this.m_rShape.getUserIndex(r,this.m_cutteeBreadcrumbsIndex)|d),this.m_rShape.setUserIndex(e,this.m_cutteeBreadcrumbsIndex,this.m_rShape.getUserIndex(e,this.m_cutteeBreadcrumbsIndex)|m)}return 0}classifyTouchCut(e,i,s,n){const r=this.m_rShape.getPrevVertex(e),o=this.m_rShape.getNextVertex(e),a=r===G?G:this.m_rTopoGraph.getHalfEdgeConnector(i,this.m_rTopoGraph.getClusterFromVertex(r)),l=o===G?G:this.m_rTopoGraph.getHalfEdgeConnector(i,this.m_rTopoGraph.getClusterFromVertex(o)),u=s===G?G:this.m_rTopoGraph.getHalfEdgeConnector(i,this.m_rTopoGraph.getClusterFromVertex(s)),c=n===G?G:this.m_rTopoGraph.getHalfEdgeConnector(i,this.m_rTopoGraph.getClusterFromVertex(n));if(!this.m_bConsiderTouch){let h;return(h=u===a||c===a)?this.m_rShape.setUserIndex(e,this.m_cutteeBreadcrumbsIndex,this.setTbd(this.m_rShape.getUserIndex(e,this.m_cutteeBreadcrumbsIndex))):(h=u===l||c===l)&&this.m_rShape.setUserIndex(r,this.m_cutteeBreadcrumbsIndex,this.setTbd(this.m_rShape.getUserIndex(r,this.m_cutteeBreadcrumbsIndex))),h?0:1}if(a===G)return this.m_rShape.setUserIndex(e,this.m_cutteeBreadcrumbsIndex,this.setTbd(this.m_rShape.getUserIndex(e,this.m_cutteeBreadcrumbsIndex))),0;if(l===G)return this.m_rShape.setUserIndex(r,this.m_cutteeBreadcrumbsIndex,this.setTbd(this.m_rShape.getUserIndex(r,this.m_cutteeBreadcrumbsIndex))),0;if(a===l)return this.m_rShape.setUserIndex(r,this.m_cutteeBreadcrumbsIndex,this.setTbd(this.m_rShape.getUserIndex(r,this.m_cutteeBreadcrumbsIndex))),this.m_rShape.setUserIndex(e,this.m_cutteeBreadcrumbsIndex,this.setTbd(this.m_rShape.getUserIndex(e,this.m_cutteeBreadcrumbsIndex))),0;if(c!==G){if(a===c)return this.m_rShape.setUserIndex(e,this.m_cutteeBreadcrumbsIndex,this.setTbd(this.m_rShape.getUserIndex(e,this.m_cutteeBreadcrumbsIndex))),0;if(l===c)return this.m_rShape.setUserIndex(r,this.m_cutteeBreadcrumbsIndex,this.setTbd(this.m_rShape.getUserIndex(r,this.m_cutteeBreadcrumbsIndex))),0;let h=1;XU(this.m_rTopoGraph,i,c,d=>{if(d===a){const m=this.m_rShape.getUserIndex(r,this.m_cutteeBreadcrumbsIndex)|h;this.m_rShape.setUserIndex(r,this.m_cutteeBreadcrumbsIndex,m),h=2}else if(d===l){const m=this.m_rShape.getUserIndex(e,this.m_cutteeBreadcrumbsIndex)|h;this.m_rShape.setUserIndex(e,this.m_cutteeBreadcrumbsIndex,m),h=2}})}else{if(a===u)return this.m_rShape.setUserIndex(e,this.m_cutteeBreadcrumbsIndex,this.setTbd(this.m_rShape.getUserIndex(e,this.m_cutteeBreadcrumbsIndex))),0;if(l===u)return this.m_rShape.setUserIndex(r,this.m_cutteeBreadcrumbsIndex,this.setTbd(this.m_rShape.getUserIndex(r,this.m_cutteeBreadcrumbsIndex))),0;let h=2;XU(this.m_rTopoGraph,i,u,d=>{if(d===a){const m=this.m_rShape.getUserIndex(r,this.m_cutteeBreadcrumbsIndex)|h;this.m_rShape.setUserIndex(r,this.m_cutteeBreadcrumbsIndex,m),h=1}else if(d===l){const m=this.m_rShape.getUserIndex(e,this.m_cutteeBreadcrumbsIndex)|h;this.m_rShape.setUserIndex(e,this.m_cutteeBreadcrumbsIndex,m),h=1}})}return 0}classifyCutVertex(e,i){let s=0,n=0;for(let r=this.m_rTopoGraph.getClusterVertexIterator(i);r!==G;r=this.m_rTopoGraph.incrementVertexIterator(r)){const o=this.m_rTopoGraph.getVertexFromVertexIterator(r);if(this.m_rShape.getGeometryFromVertex(o)===this.m_cutter){n++;const a=this.m_rShape.getPrevVertex(o),l=this.m_rShape.getNextVertex(o);s+=a===G||l===G?this.classifyTouchCut(e,i,a,l):this.classifyStandardCut(e,i,a,l)}}n&&s===n&&!this.m_bConsiderTouch&&this.m_rShape.setUserIndex(e,this.m_clusterParentageIndex,this.m_IDCuttee)}cutPolylinePolyline_(){this.m_rShape.getGeometryType(this.m_cuttee),this.m_rShape.getGeometryType(this.m_cutter),this.m_rParent.m_maskLookup.length=0,this.m_rParent.m_maskLookup.length=this.m_IDBoth+1,this.m_rParent.m_maskLookup[this.m_IDBoth]=!0;for(let a=this.m_rShape.getFirstPath(this.m_cuttee);a!==G;a=this.m_rShape.getNextPath(a)){const l=this.m_rShape.getPathSize(a);let u=this.m_rShape.getFirstVertex(a);for(let c=0;c<l;++c,u=this.m_rShape.getNextVertex(u))this.m_rShape.setUserIndex(u,this.m_cutteeBreadcrumbsIndex,0);u=this.m_rShape.getFirstVertex(a);for(let c=0;c<l;++c,u=this.m_rShape.getNextVertex(u)){const h=this.m_rTopoGraph.getClusterFromVertex(u);this.m_rTopoGraph.getClusterParentage(h)===this.m_IDBoth&&this.classifyCutVertex(u,h)}}const e=(a,l)=>{let u=this.m_rShape.getUserIndex(a,this.m_cutteeBreadcrumbsIndex);const c=this.m_rTopoGraph.getHalfEdgeConnector(this.m_rTopoGraph.getClusterFromVertex(a),this.m_rTopoGraph.getClusterFromVertex(l));return(this.m_rTopoGraph.getHalfEdgeParentage(c)&this.m_IDBoth)===this.m_IDBoth&&(u|=4),u};for(let a=this.m_rShape.getFirstPath(this.m_cuttee);a!==G;a=this.m_rShape.getNextPath(a)){let l=this.m_rShape.getFirstVertex(a);const u=this.m_rShape.isClosedPath(a),c=this.m_rShape.getPathSize(a)+(u?1:0);let h=1,d=32;for(let f=this.m_rShape.getNextVertex(l);h<c;++h,l=f,f=this.m_rShape.getNextVertex(f)){const _=e(l,f);this.m_rShape.getUserIndex(l,this.m_clusterParentageIndex)===this.m_IDBoth&&(d=_),d!==32&&this.m_rShape.setUserIndex(l,this.m_cutteeBreadcrumbsIndex,d|_)}l=this.m_rShape.getLastVertex(a);let m=32;h=1;for(let f=this.m_rShape.getPrevVertex(l);h<c;++h,l=f,f=this.m_rShape.getPrevVertex(f)){const _=e(f,l);this.m_rShape.getUserIndex(l,this.m_clusterParentageIndex)===this.m_IDBoth&&(m=_),m!==32&&this.m_rShape.setUserIndex(f,this.m_cutteeBreadcrumbsIndex,m|_)}}let i=G,s=G,n=32;const r=this.m_rShape.hasSegmentParentage(),o=new ii;for(let a=this.m_rShape.getFirstPath(this.m_cuttee);a!==G;a=this.m_rShape.getNextPath(a)){const l=this.m_rShape.isClosedPath(a),u=this.m_rShape.getPathSize(a)+(l?1:0);let c=1,h=this.m_rShape.getFirstVertex(a),d=G,m=!0;for(let f=this.m_rShape.getNextVertex(h);c<u;++c,f=this.m_rShape.getNextVertex(f)){let _=this.m_rShape.getUserIndex(h,this.m_cutteeBreadcrumbsIndex);_===8?_=3:(_&=-9,4&_?_=4:3&~_||(_=3)),_!==n?(i!==G&&(d=this.m_rShape.addVertex(s,h),r&&this.m_rTopoGraph.isBreakNode(this.m_rTopoGraph.getClusterFromVertex(h))&&this.m_rShape.setSegmentParentageBreakVertex(d,!0),this.m_rCutHandles.push(i),this.m_rShape.setGeometryUserIndex(i,this.m_sideIndex,n)),i=this.m_rShape.createGeometry(q.enumPolyline),s=this.m_rShape.insertPath(i,G),n=_,m=!0):this.m_rShape.getUserIndex(h,this.m_clusterParentageIndex)===this.m_IDBoth&&_!==4&&(d=this.m_rShape.addVertex(s,h),r&&this.m_rTopoGraph.isBreakNode(this.m_rTopoGraph.getClusterFromVertex(h))&&this.m_rShape.setSegmentParentageBreakVertex(d,!0),s=this.m_rShape.insertPath(i,G),m=!0),d=this.m_rShape.addVertex(s,h);const v=this.m_rTopoGraph.getClusterFromVertex(h);!m&&r&&this.m_rTopoGraph.isBreakNode(v)&&this.m_rShape.setSegmentParentageBreakVertex(d,!0);const x=this.m_rTopoGraph.getHalfEdgeFromVertex(h);if(r){const w=this.m_rTopoGraph.getSegmentParentage(x);this.m_rShape.setSegmentParentageAndBreak(d,w,m||this.m_rTopoGraph.isBreakNode(v))}this.m_rTopoGraph.isHalfEdgeCurve(x)&&(this.m_rTopoGraph.querySegmentXY(x,o),this.m_rShape.setSegmentToIndex(this.m_rShape.getVertexIndex(d),o.get().clone())),h=f,m=!1}d=this.m_rShape.addVertex(s,h),r&&this.m_rTopoGraph.isBreakNode(this.m_rTopoGraph.getClusterFromVertex(h))&&this.m_rShape.setSegmentParentageBreakVertex(d,!0),this.m_rCutHandles.push(i),this.m_rShape.setGeometryUserIndex(i,this.m_sideIndex,n),i=G,s=G,n=32}}}function dUe(t,e,i){return new Vl(i).linesToPolygonsImpl(t,e)}function mUe(t,e,i,s,n){if(s&&(s.m_reason=0,s.m_vertexIndex1=-1,s.m_vertexIndex2=-1),t.isEmpty())return 5;const r=t.getGeometryType();if(r===q.enumPoint)return gA(t,s);const o=Fl(e,t,!1).total();if(r===q.enumEnvelope){const h=t,d=new J;return h.queryEnvelope(d),d.isDegenerate(o)?(s&&(s.m_reason=4,s.m_vertexIndex1=-1,s.m_vertexIndex2=-1),0):5}if(nr(r)){const h=t,d=new Qi({vd:h.getDescription()});return d.addSegment(h,!0),cj(d,e,i,s,n)}const a=[0],l=t.getImpl().getIsSimple(o,a);let u=i?-1:l;if(ry(u)||u===0)return u;const c=new qc(t,e,u,n,!1);return r===q.enumMultiPoint||r===q.enumPolyline||r===q.enumPolygon?u=c.isSimplePlanarImpl():We(""),t.getImpl().setIsSimple(u,o),s&&s.assign(c.m_nonSimpleResult),u}function oge(t,e,i,s,n){if(s&&(s.m_reason=0,s.m_vertexIndex1=-1,s.m_vertexIndex2=-1),t.isEmpty())return 5;const r=t.getGeometryType();if(r===q.enumPoint)return gA(t,s);const o=Fl(e,t,!1).total();if(r===q.enumEnvelope){const h=t,d=new J;return h.queryEnvelope(d),d.isDegenerate(o)?(s&&(s.m_reason=4,s.m_vertexIndex1=-1,s.m_vertexIndex2=-1),0):5}if(nr(r)){const h=t,d=new Qi({vd:h.getDescription()});return d.addSegment(h,!0),oge(d,e,i,s,n)}ZF(r),ll(r)||_i("OGC simplify is not implemented for this geometry type");const a=[0],l=t.getImpl().getIsSimple(o,a);let u=i?-1:l;if(u===5||u===0)return u;const c=new qc(t,e,u,n,!0);return r===q.enumMultiPoint||r===q.enumPolyline||r===q.enumPolygon?(u=c.isSimplePlanarImpl(),ry(u)&&(u=5)):We(""),t.getImpl().setIsSimple(u,o),s&&s.assign(c.m_nonSimpleResult),u}function cj(t,e,i,s,n){if(s&&(s.m_reason=0,s.m_vertexIndex1=-1,s.m_vertexIndex2=-1),t.isEmpty())return 5;const r=t.getGeometryType();if(r===q.enumPoint)return gA(t,s);const o=Fl(e,t,!1).total();if(r===q.enumEnvelope){const h=t,d=J.constructEmpty();return h.queryEnvelope(d),d.isDegenerate(o)?(s&&(s.m_reason=4,s.m_vertexIndex1=-1,s.m_vertexIndex2=-1),0):5}if(nr(r)){const h=t,d=new Qi({vd:h.getDescription()});return d.addSegment(h,!0),cj(d,e,i,s,n)}const a=[0],l=t.getImpl().getIsSimple(o,a);let u=i?-1:l;if(u!==-1)return u;const c=new qc(t,e,u,n,!1);return r===q.enumMultiPoint?u=c.multipointIsSimpleAsFeature():r===q.enumPolyline?u=c.polylineIsSimpleAsFeature():r===q.enumPolygon?u=c.polygonIsSimpleAsFeature():We(""),t.getImpl().setIsSimple(u,o),s&&s.assign(c.m_nonSimpleResult),u}function age(t,e,i,s){if(t.isEmpty())return t;const n=t.getGeometryType();if(n===q.enumPoint){const h=new Rs;if(gA(t,h),h.m_reason===3){const d=t.clone();return d.replaceNaNs(1,0),d}return h.m_reason===2?t.createInstance():t}if(n===q.enumEnvelope){const h=Fl(e,t,!0).total(),d=t,m=J.constructEmpty();return d.queryEnvelope(m),m.isDegenerate(h)?d.createInstance():t}if(nr(n)){const h=t,d=new Qi({vd:h.getDescription()});return d.addSegment(h,!0),age(d,e,i,s)}ZF(n);const r=Fl(e,t,!1).total(),o=[0],a=t.getImpl().getIsSimple(r,o),l=i?-1:a;if(ry(l)){if(n===q.enumPolygon&&t.getFillRule()!==0){const h=t.clone();return h.setFillRule(0),h}return t}if((n===q.enumMultiPoint||n===q.enumPolyline)&&l>=1)return t;const u=new qc(t,e,l,s,!1);let c;return n===q.enumMultiPoint?c=u.multipointSimplifyAsFeature():n===q.enumPolyline?c=u.polylineSimplifyAsFeature():n===q.enumPolygon?c=u.polygonSimplifyAsFeature():We(""),c}function lge(t,e,i,s){if(t.isEmpty())return t;const n=t.getGeometryType();if(n===q.enumPoint){const u=new Rs;if(gA(t,u),u.m_reason===3){const c=t.clone();return c.replaceNaNs(1,0),c}return u.m_reason===2?t.createInstance():t}if(n===q.enumEnvelope){const u=t,c=new J;u.queryEnvelope(c);const h=Fl(e,t,!0).total();return c.isDegenerate(h)?u.createInstance():t}if(nr(n)){const u=t,c=new Qi({vd:u.getDescription()});return c.addSegment(u,!0),lge(c,e,i,s)}ZF(n),ll(n)||_i("OGC simplify is not implemented for this geometry type");const r=Fl(e,t,!1).total(),o=[0],a=t.getImpl().getIsSimple(r,o),l=i?-1:a;if(l===5){if(n===q.enumPolygon&&t.getFillRule()!==0){const u=t.clone();return u.setFillRule(0),u}return t}return gB(t,Fl(e,t,!0),!1,l,s,0,!0)}function gA(t,e){const i=t.getX(),s=t.getY();if(!Number.isFinite(i)||!Number.isFinite(s))return e&&(e.m_reason=2,e.m_vertexIndex1=-1,e.m_vertexIndex2=-1),0;if(t.hasAttribute(1)){const n=t.getZ();if(!Number.isFinite(n))return e&&(e.m_reason=Number.isNaN(n)?3:2,e.m_vertexIndex1=-1,e.m_vertexIndex2=-1),0}return 5}class ite{constructor(){this.m_segment=null,this.m_vertexIndex=-1,this.m_pathIndex=-1,this.m_flags=0}setReversed(e){this.m_flags&=-2,this.m_flags=this.m_flags|(e?1:0)}getReversed(){return!!(1&this.m_flags)}getRightSide(){return this.getReversed()?0:1}}function pUe(){return{x:-1,y:-1,ipath:-1,ivertex:-1,ipolygon:-1}}function fUe(t,e,i,s,n){return{x:t,y:e,ipath:i,ivertex:s,ipolygon:n}}function gUe(t,e){return t.x===e.x&&t.y===e.y&&t.ipath===e.ipath&&t.ivertex===e.ivertex&&t.ipolygon===e.ipolygon}function _Ue(t,e){t.x=e.x,t.y=e.y,t.ipath=e.ipath,t.ivertex=e.ivertex,t.ipolygon=e.ipolygon}function yUe(){return{x:-1,y:-1,ipath:-1,ivertex:-1,bBoundary:!1,bEndPoint:!1}}function vUe(t,e,i,s,n,r){return{x:t,y:e,ipath:i,ivertex:s,bBoundary:n,bEndPoint:r}}function xUe(t,e){t.x=e.x,t.y=e.y,t.ipath=e.ipath,t.ivertex=e.ivertex,t.bBoundary=e.bBoundary,t.bEndPoint=e.bEndPoint}class bUe extends B1{constructor(e){super(),this.m_helper=e}compare(e,i,s){const n=e.getElement(s),r=this.m_helper.m_xy.read(2*i)-this.m_helper.m_xy.read(2*n);return r<0?-1:r>0?1:0}}class wUe extends B1{constructor(e){super(),this.m_helper=e}compare(e,i,s){const n=e.getElement(s),r=this.m_helper.m_edges[i],o=this.m_helper.m_edges[n],a=r.getReversed(),l=o.getReversed();let u=r.m_segment.intersectionOfYMonotonicWithAxisX(this.m_helper.m_yScanline,0),c=o.m_segment.intersectionOfYMonotonicWithAxisX(this.m_helper.m_yScanline,0);if(u===c){const h=a?r.m_segment.getStartY():r.m_segment.getEndY(),d=l?o.m_segment.getStartY():o.m_segment.getEndY(),m=Math.min(h,d);let f=.5*(m-this.m_helper.m_yScanline)+this.m_helper.m_yScanline;f===this.m_helper.m_yScanline&&(f=m),u=r.m_segment.intersectionOfYMonotonicWithAxisX(f,0),c=o.m_segment.intersectionOfYMonotonicWithAxisX(f,0)}return u<c?-1:u>c?1:0}}class qc{constructor(e,i,s,n,r){this.m_multiVertexGeom=null,this.m_edges=[],this.m_freeEdges=[],this.m_lineEdgesRecycle=[],this.m_newEdges=[],this.m_recycledSegIter=null,this.m_crossOverHelperList=new gf,this.m_progressTracker=null,this.m_progressCounter=0,this.m_AET=new mr,this.m_xyToNode1=null,this.m_xyToNode2=null,this.m_pathOrientations=null,this.m_pathParentage=null,this.m_xy=null,this.m_pairs=[],this.m_pairIndices=null,this.m_pathsForOGCTests=[],this.m_curveStitcher=null,this.m_editShape=null,this.m_multiPathStitcher=null,this.m_nonSimpleResult=new Rs,this.m_progressCounter=0,this.m_progressTracker=n,this.m_geometry=e,this.m_knownSimpleResult=s,this.m_sr=i;const o=Fl(i,e,!1);this.m_toleranceIsSimple=o,this.m_toleranceIsSimpleClustering=Pu(o),this.m_toleranceIsSimpleCracking=F7(o),this.m_toleranceSimplify=Fl(i,e,!0),this.m_description=this.m_geometry.getDescription(),this.m_attributeCount=this.m_description.getAttributeCount(),this.m_bOGCRestrictions=r,this.m_bPlanarSimplify=this.m_bOGCRestrictions,this.m_unknownOrientationPathCount=-1,this.m_yScanline=0,this.m_progressCounter=0}isSimplePlanarImpl(){if(this.m_bPlanarSimplify=!0,!this.checkStructure())return 0;const e=this.m_geometry.getGeometryType();return Ei(e)&&!this.checkDegenerateSegments(!1)?0:this._CheckClustering()?Ei(e)?this._CheckCracking()?this.m_geometry.getGeometryType()===q.enumPolyline?this.checkSelfIntersectionsPolylinePlanar()?4:0:this._CheckSelfIntersections()?this._CheckValidRingOrientation():0:0:5:0}isSimplePlanarImpl3D(){return z(0),7}generateSortedPairs(e){let i=null;Ei(e.getGeometryType())&&(i=e);const s=(this.m_bPlanarSimplify||this.m_bOGCRestrictions)&&i!==null,n=e.getPointCount();this.m_xy=e.getAttributeStreamRef(0),this.m_pairs.length=0,this.m_pairIndices=new Un(0),s&&(this.m_pathsForOGCTests.length=0);let r=0;for(let l=0;l<n;l++)if(this.m_pairs.push(2*l),this.m_pairs.push(2*l+1),this.m_pairIndices.add(2*l),this.m_pairIndices.add(2*l+1),s){for(;l>=i.getPathEnd(r);)r++;this.m_pathsForOGCTests.push(r)}const o=new Uy,a={parent:this,workPt:new N,userSort(l,u,c){c.sort(l,u,(h,d)=>this.parent.compareVerticesForPlanarClustering(h,d,s))},getValue(l){const u=this.parent.m_pairs[l],c=u>>1;return this.parent.m_xy.queryPoint2D(2*c,this.workPt),this.workPt.y+(1&u?this.parent.m_toleranceIsSimpleClustering:-this.parent.m_toleranceIsSimpleClustering)}};o.sort(this.m_pairIndices,0,2*n,a)}_TestToleranceDistancePlanar(e,i){const s=this.m_xy.read(2*e),n=this.m_xy.read(2*e+1),r=this.m_xy.read(2*i),o=this.m_xy.read(2*i+1);return rj(s,n,r,o,this.m_toleranceIsSimpleClustering*this.m_toleranceIsSimpleClustering)?this.m_geometry.getDimension()===0?!1:s===r&&n===o:!0}checkStructure(){const e=this.m_geometry.getGeometryType();if(Ei(e)){const i=this.m_geometry.getImpl(),s=this.m_geometry.getGeometryType()===q.enumPolygon?3:2;for(let n=0,r=i.getPathCount();n<r;n++)if(i.getPathSize(n)<s){if(i.hasNonLinearSegments()&&i.hasNonLinearSegmentsPath(n)&&i.getPathSize(n)>0)continue;return this.m_nonSimpleResult=new Rs(1,n,0),!1}}if(ll(e)){const i=this.m_geometry.getImpl(),s=i.getAttributeStreamRef(0);for(let n=0,r=i.getPointCount();n<r;n++)if(!s.readPoint2D(2*n).isFinite())return this.m_nonSimpleResult=new Rs(2,n,0),!1;if(this.m_geometry.hasAttribute(1)){const n=i.getAttributeStreamRef(1);for(let r=0,o=i.getPointCount();r<o;r++){const a=n.read(r);if(!Number.isFinite(a))return Number.isNaN(a)?this.m_nonSimpleResult=new Rs(3,r,0):this.m_nonSimpleResult=new Rs(2,r,0),!1}}}return!0}checkDegenerateSegments(e){const i=this.m_geometry.getImpl(),s=i.querySegmentIterator(),n=i.hasAttribute(1),r=n?uJ(this.m_sr,i,!1).total():0,o=i.hasNonLinearSegments(),a=this.m_toleranceIsSimple.total();for(;s.nextPath();)for(;s.hasNextSegment();){const l=s.nextSegment();let u=l.calculateLowerLength2D();if(!(u>a)&&!(o&&l.isCurve()&&(u=l.calculateLength2D(),u>a))){if(e&&n){const c=l.getStartAttributeAsDbl(1,0),h=l.getEndAttributeAsDbl(1,0);if(Math.abs(h-c)>r)continue}return this.m_nonSimpleResult=new Rs(4,s.getStartPointIndex(),-1),!1}}return!0}checkDegenerateSegments3D(){return z(0),!1}_CheckClustering(){const e=this.m_geometry.getImpl();this.generateSortedPairs(e);const i=e.getPointCount();this.m_AET.clear(),this.m_AET.setComparator(new bUe(this)),this.m_AET.setCapacity(i);for(let s=0,n=2*i;s<n;s++){this.progress_();const r=this.m_pairIndices.read(s),o=this.m_pairs[r],a=o>>1;if(1&o){const l=this.m_AET.search(a),u=this.m_AET.getPrev(l),c=this.m_AET.getNext(l);if(this.m_AET.deleteNode(l),u!==mr.st_nullNode()&&c!==mr.st_nullNode()&&!this._TestToleranceDistancePlanar(this.m_AET.getElement(u),this.m_AET.getElement(c)))return this.m_nonSimpleResult=new Rs(5,this.m_AET.getElement(u),this.m_AET.getElement(c)),!1}else{const l=this.m_AET.addElement(a),u=this.m_AET.getPrev(l);if(u!==mr.st_nullNode()&&!this._TestToleranceDistancePlanar(this.m_AET.getElement(u),a))return this.m_nonSimpleResult=new Rs(5,a,this.m_AET.getElement(u)),!1;const c=this.m_AET.getNext(l);if(c!==mr.st_nullNode()&&!this._TestToleranceDistancePlanar(this.m_AET.getElement(c),a))return this.m_nonSimpleResult=new Rs(5,a,this.m_AET.getElement(c)),!1}}return!0}_CheckCracking(){const e=this.m_geometry.getImpl(),i=e.getPointCount();return!e.hasNonLinearSegments()&&i<10?this._CheckCrackingBrute():this._CheckCrackingPlanesweep()}_CheckCrackingPlanesweep(){if(this.m_editShape=new wn,this.m_editShape.addGeometry(this.m_geometry),this.m_editShape.hasCurves()){this.m_curveStitcher=new pu;const i=J.constructEmpty();this.m_geometry.queryEnvelope(i);const s=mu(this.m_toleranceSimplify.total(),i),n=new Rs;if(sge(this.m_editShape,s,this.m_toleranceSimplify.total(),12e3,n,this.m_curveStitcher,null,this.m_progressTracker),n.m_reason!==0)return this.m_editShape=null,this.m_nonSimpleResult.assign(n),!1}const e=new Rs;return oj(!1,this.m_editShape,this.m_toleranceIsSimpleCracking,e,this.m_progressTracker)?(this.m_curveStitcher!=null?(e.m_vertexIndex1=this.m_curveStitcher.getOriginalVertexIndex(this.m_editShape,e.m_vertexIndex1),e.m_vertexIndex2=this.m_curveStitcher.getOriginalVertexIndex(this.m_editShape,e.m_vertexIndex2),this.m_curveStitcher=null):(e.m_vertexIndex1=this.m_editShape.getVertexIndex(e.m_vertexIndex1),e.m_vertexIndex2=this.m_editShape.getVertexIndex(e.m_vertexIndex2)),this.m_editShape=null,this.m_nonSimpleResult.assign(e),!1):(this.m_curveStitcher==null&&(this.m_editShape=null),!0)}_CheckCrackingBrute(){const e=this.m_geometry.getImpl(),i=e.querySegmentIterator(),s=e.querySegmentIterator();for(;i.nextPath();)for(;i.hasNextSegment();){const n=i.nextSegment();if(!i.isLastSegmentInPath()||!i.isLastPath()){s.resetTo(i);do for(;s.hasNextSegment();){const r=s.nextSegment(),o=tE(!0,n,r,this.m_toleranceIsSimpleCracking,!0);if(o){const a=o===2?7:6;return this.m_nonSimpleResult=new Rs(a,i.getStartPointIndex(),s.getStartPointIndex()),!1}}while(s.nextPath())}}return!0}_CheckSelfIntersections(){let e=this.m_geometry.getImpl();this.m_curveStitcher!==null&&(this.m_multiPathStitcher=this.m_editShape.getGeometry(this.m_editShape.getFirstGeometry()),e=this.m_multiPathStitcher.getImpl(),this.generateSortedPairs(e)),this.m_edges.length=0,this.m_lineEdgesRecycle.length=0,this.m_recycledSegIter=e.querySegmentIterator(),this.m_recycledSegIter.setCirculator(!0);const i=[],s=e.getPointCount();let n=Number.NaN,r=0;for(let o=0,a=2*s;o<a;o++){this.progress_();const l=this.m_pairIndices.read(o),u=this.m_pairs[l];if(1&u)continue;const c=u>>1,h=this.m_xy.read(2*c),d=this.m_xy.read(2*c+1);if(i.length&&(h!==n||d!==r)){if(!this.processBunchForSelfIntersectionTest(i))return!1;i.length=0}i.push(c),n=h,r=d}return!!this.processBunchForSelfIntersectionTest(i)}checkSelfIntersectionsPolylinePlanar(){const e=this.m_geometry.getImpl(),i=[];for(let a=0,l=e.getPathCount();a<l;a++)i.push(e.isClosedPathInXYPlane(a));const s=yUe();let n,r,o;{const a=this.m_pairIndices.read(0),l=this.m_pairs[a]>>1,u=this.m_xy.readPoint2D(2*l),c=this.m_pathsForOGCTests[l];n=i[c],r=e.getPathStart(c),o=e.getPathEnd(c)-1,s.bEndPoint=l===r||l===o,this.m_bOGCRestrictions?s.bBoundary=!n&&s.bEndPoint:s.bBoundary=s.bEndPoint,s.ipath=c,s.x=u.x,s.y=u.y,s.ivertex=l}for(let a=1,l=this.m_pairIndices.size();a<l;a++){const u=this.m_pairIndices.read(a),c=this.m_pairs[u];if(1&c)continue;const h=c>>1,d=this.m_xy.readPoint2D(2*h),m=this.m_pathsForOGCTests[h];let f;m!==s.ipath&&(n=i[m],r=e.getPathStart(m),o=e.getPathEnd(m)-1);const _=h===r||h===o;f=this.m_bOGCRestrictions?!n&&_:_;const v=vUe(d.x,d.y,m,h,f,_);if(v.x===s.x&&v.y===s.y){if(this.m_bOGCRestrictions){if(!(v.bBoundary&&s.bBoundary||v.ipath===s.ipath&&v.bEndPoint&&s.bEndPoint))return this.m_nonSimpleResult=new Rs(10,v.ivertex,s.ivertex),!1}else if(!v.bEndPoint||!s.bEndPoint)return this.m_nonSimpleResult=new Rs(7,v.ivertex,s.ivertex),!1}xUe(s,v)}return!0}checkSelfIntersectionsPolylinePlanar3D(e){return z(0),!1}checkSelfIntersectionsPolygonsOGC(){const e=this.m_geometry.getImpl(),i=[];let s=-1,n=!1;for(let h=0,d=e.getPathCount();h<d;h++)e.isExteriorRingOGC(h)&&(n=!1,s++,h<d-1&&(e.isExteriorRingOGC(h+1)||(n=!0))),i.push(n?s:-1);const r=pUe();{const h=this.m_pairIndices.read(0),d=this.m_pairs[h]>>1,m=this.m_xy.readPoint2D(2*d),f=this.m_pathsForOGCTests[d];r.ipath=f,r.x=m.x,r.y=m.y,r.ivertex=d,r.ipolygon=i[f]}const o=[];for(let h=1,d=this.m_pairIndices.size();h<d;h++){const m=this.m_pairIndices.read(h),f=this.m_pairs[m];if(1&f)continue;const _=f>>1,v=this.m_xy.readPoint2D(2*_),x=this.m_pathsForOGCTests[_],w=fUe(v.x,v.y,x,_,i[x]);if(w.x===r.x&&w.y===r.y){if(w.ipath===r.ipath)return this.m_nonSimpleResult=new Rs(11,w.ivertex,r.ivertex),!1;i[w.ipath]>=0&&i[w.ipath]===i[r.ipath]&&(o.length!==0&&gUe(o.at(-1),r)||o.push({...r}),o.push(w))}_Ue(r,w)}if(o.length===0)return!0;const a=new gf(!0);i.fill(-1);let l=-1;const u=new N;for(let h=0,d=o.length;h<d;h++){const m=o[h];m.x===u.x&&m.y===u.y||(l=a.createList(0),u.x=m.x,u.y=m.y);let f=i[m.ipath];f===-1&&(f=a.createList(2),i[m.ipath]=f),a.addElement(f,l),a.addElement(l,f)}const c=[];for(let h=a.getFirstList();h!==-1;h=a.getNextList(h)){const d=a.getListData(h);if(1&d||!(2&d))continue;let m=-1;for(c.push(h),c.push(-1);c.length;){const f=c.at(-1);c.pop();const _=c.at(-1);c.pop();const v=a.getListData(_);if(1&v){m=2&v?_:f;break}a.setListData(_,1|v);for(let x=a.getFirst(_);x!==-1;x=a.getNext(x)){const w=a.getData(x);w!==f&&(c.push(w),c.push(_))}}if(m!==-1){const f=i.indexOf(m);return this.m_nonSimpleResult=new Rs(12,f,-1),!1}}return!0}_CheckValidRingOrientation(){const e=this.m_multiPathStitcher!==null?this.m_multiPathStitcher.getImpl():this.m_geometry.getImpl();if(e.calculateArea2D()<=0)return this.m_nonSimpleResult=new Rs(8,e.getPathCount()===1?1:-1,-1),0;if(e.getPathCount()===1)return this.m_bOGCRestrictions&&!this.checkSelfIntersectionsPolygonsOGC()?0:4;this.m_pathOrientations=new O7(e.getPathCount(),0),this.m_pathParentage=new Un(e.getPathCount(),-1);let i=-1,s=0;for(let o=0,a=e.getPathCount();o<a;o++){const l=e.calculateRingArea2D(o);if(this.m_pathOrientations.write(o,l<0?0:8),l>0)i=o,s=l;else{if(l===0)return this.m_nonSimpleResult=new Rs(8,o,-1),0;if((i<0||s<Math.abs(l))&&(this.m_nonSimpleResult=new Rs(9,o,-1),this.m_bOGCRestrictions))return 0;this.m_pathParentage.write(o,i)}}this.m_unknownOrientationPathCount=e.getPathCount(),this.m_newEdges.length=0;const n=e.getPointCount();this.m_yScanline=Number.NaN;const r=[];this.m_xyToNode1=new Un(n,mr.st_nullNode()),this.m_xyToNode2=new Un(n,mr.st_nullNode()),this.m_freeEdges.length=0,this.m_AET.clear(),this.m_AET.setComparator(new wUe(this));for(let o=0,a=2*n;this.m_unknownOrientationPathCount>0&&o<a;o++){const l=this.m_pairIndices.read(o),u=this.m_pairs[l];if(1&u)continue;const c=u>>1,h=this.m_xy.read(2*c+1);if(h!==this.m_yScanline&&r.length){if(!this.processBunchForRingOrientationTest(r))return 0;r.length=0}r.push(c),this.m_yScanline=h}return this.m_unknownOrientationPathCount>0&&!this.processBunchForRingOrientationTest(r)?0:this.m_bOGCRestrictions?this.m_nonSimpleResult.m_reason!==0?0:this.checkSelfIntersectionsPolygonsOGC()?5:0:this.m_nonSimpleResult.m_reason===0?4:3}processBunchForSelfIntersectionTest(e){if(e.length===1)return!0;for(let a=0,l=e.length;a<l;a++){const u=e[a];this.m_recycledSegIter.resetToVertex(u,-1);const c=this.m_recycledSegIter.previousSegment();this.m_edges.push(this.createEdge(c,u,this.m_recycledSegIter.getPathIndex(),!0)),this.m_recycledSegIter.nextSegment();const h=this.m_recycledSegIter.nextSegment();this.m_edges.push(this.createEdge(h,u,this.m_recycledSegIter.getPathIndex(),!1))}this.m_edges.sort((a,l)=>this.edgeAngleCompare(a,l));let i=this.m_crossOverHelperList.getFirstList();i===-1&&(i=this.m_crossOverHelperList.createList(0)),this.m_crossOverHelperList.reserveNodes(this.m_edges.length);for(let a=0,l=this.m_edges.length;a<l;a++)this.m_crossOverHelperList.addElement(i,a);let s=!0,n=-1,r=-1;for(;s;){s=!1;let a=this.m_crossOverHelperList.getFirst(i);if(a===-1)break;let l=this.m_crossOverHelperList.getNext(a);for(;l!==-1;){const u=this.m_crossOverHelperList.getData(a),c=this.m_crossOverHelperList.getData(l);if(n=this.m_edges[u].m_vertexIndex,r=this.m_edges[c].m_vertexIndex,n!==r)a=l,l=this.m_crossOverHelperList.getNext(a);else if(s=!0,this.m_crossOverHelperList.deleteElement(i,a),a=this.m_crossOverHelperList.getPrev(l),l=this.m_crossOverHelperList.deleteElement(i,l),l===-1||a===-1)break}}const o=this.m_crossOverHelperList.getListSize(i);if(this.m_crossOverHelperList.clear(i),o>0)return this.m_nonSimpleResult=new Rs(7,n,r),!1;for(let a=0,l=e.length;a<l;a++)this.recycleEdge(this.m_edges[a]);return this.m_edges.length=0,!0}processBunchForRingOrientationTest(e){for(let i=0,s=e.length;i<s;i++){const n=e[i];let r=this.m_xyToNode1.read(n);if(r!==mr.st_nullNode()){const o=this.m_AET.getElement(r);this.m_freeEdges.push(o),this.m_AET.deleteNode(r),this.recycleEdge(this.m_edges[o]),this.m_edges[o]=null,this.m_xyToNode1.write(n,mr.st_nullNode())}if(r=this.m_xyToNode2.read(n),r!==mr.st_nullNode()){const o=this.m_AET.getElement(r);this.m_freeEdges.push(o),this.m_AET.deleteNode(r),this.recycleEdge(this.m_edges[o]),this.m_edges[o]=null,this.m_xyToNode2.write(n,mr.st_nullNode())}}for(let i=0,s=e.length;i<s;i++){const n=e[i];this.m_recycledSegIter.resetToVertex(n,-1);const r=this.m_recycledSegIter.previousSegment();if(r.getStartY()>r.getEndY()){const a=this.m_recycledSegIter.getStartPointIndex(),l=this.createEdge(r,n,this.m_recycledSegIter.getPathIndex(),!0);let u;this.m_freeEdges.length>0?(u=this.m_freeEdges.at(-1),this.m_freeEdges.pop(),this.m_edges[u]=l):(u=this.m_edges.length,this.m_edges.push(l));const c=this.m_AET.addElement(u);this.m_xyToNode1.read(a)===mr.st_nullNode()?this.m_xyToNode1.write(a,c):this.m_xyToNode2.write(a,c),3&this.m_pathOrientations.read(this.m_recycledSegIter.getPathIndex())||this.m_newEdges.push(c)}this.m_recycledSegIter.nextSegment();const o=this.m_recycledSegIter.nextSegment();if(o.getStartY()<o.getEndY()){const a=this.m_recycledSegIter.getEndPointIndex(),l=this.createEdge(o,n,this.m_recycledSegIter.getPathIndex(),!1);let u;this.m_freeEdges.length>0?(u=this.m_freeEdges.at(-1),this.m_freeEdges.pop(),this.m_edges[u]=l):(u=this.m_edges.length,this.m_edges.push(l));const c=this.m_AET.addElement(u);this.m_xyToNode1.read(a)===mr.st_nullNode()?this.m_xyToNode1.write(a,c):this.m_xyToNode2.write(a,c),3&this.m_pathOrientations.read(this.m_recycledSegIter.getPathIndex())||this.m_newEdges.push(c)}}for(let i=0,s=this.m_newEdges.length;i<s&&this.m_unknownOrientationPathCount>0;i++){const n=this.m_newEdges[i],r=this.m_AET.getElement(n),o=this.m_edges[r].m_pathIndex;if(!(3&this.m_pathOrientations.read(o))){let a=-1,l=this.m_AET.getPrev(n),u=n,c=0;{let h=-1,d=null,m=-1,f=0;for(;l!==mr.st_nullNode()&&(h=this.m_AET.getElement(l),d=this.m_edges[h],m=d.m_pathIndex,f=this.m_pathOrientations.read(m),!(3&f));)u=l,l=this.m_AET.getPrev(l);l===mr.st_nullNode()?(c=1,l=u):(a=(3&f)==1?m:this.m_pathParentage.read(m),c=d.getRightSide()?0:1,l=this.m_AET.getNext(l))}do{const h=this.m_AET.getElement(l),d=this.m_edges[h],m=d.m_pathIndex;let f=this.m_pathOrientations.read(m);if(!(3&f)){if(c!==d.getRightSide())return this.m_nonSimpleResult=new Rs(8,m,-1),!1;const _=c&&!d.getReversed()?1:2;if(f=-4&f|_,this.m_pathOrientations.write(m,f),_===2&&this.m_nonSimpleResult.m_reason===0){const v=this.m_pathParentage.read(m);if(v!==a&&(this.m_nonSimpleResult=new Rs(9,m,v),this.m_bOGCRestrictions))return!1}if(this.m_unknownOrientationPathCount--,!this.m_unknownOrientationPathCount)return!0}a=(3&f)==1?m:this.m_pathParentage.read(m),u=l,l=this.m_AET.getNext(l),c=c?0:1}while(u!==n)}}return this.m_newEdges.length=0,!0}createEdge(e,i,s,n){let r;return e.getGeometryType()===q.enumLine?r=this.createEdgeLine(e):(r=new ite,r.m_segment=e.clone()),r.m_vertexIndex=i,r.m_pathIndex=s,r.m_flags=0,r.setReversed(n),r}createEdgeLine(e){let i;return this.m_lineEdgesRecycle.length>0?(i=this.m_lineEdgesRecycle.at(-1),this.m_lineEdgesRecycle.pop(),e.copyTo(i.m_segment)):(i=new ite,i.m_segment=e.clone()),i}recycleEdge(e){e.m_segment.getGeometryType()===q.enumLine&&this.m_lineEdgesRecycle.push(e)}static isShortSegment(e,i,s,n){let r=e.calculateLowerLength2D();if(r<=s){let o=!0;if(e.isCurve()&&(r=e.calculateLength2D(),o=r<=s),o){if(i){let a=e.getEndAttributeAsDbl(1,0);Number.isNaN(a)&&(a=0);let l=e.getStartAttributeAsDbl(1,0);return Number.isNaN(l)&&(l=0),Math.abs(l-a)<=n}return!0}return!1}return!1}static isShortSegmentPoints(e,i,s,n,r){if(s){const o=e.getXYZ(),a=i.getXYZ();return eOe(o,a,n,r)}{const o=e.getXY(),a=i.getXY();return N.sqrDistance(o,a)<=n*n}}removeDegenerateSegmentsFromCurvedPath(e,i,s,n){const r=e.hasAttribute(1),o=e.querySegmentIterator();o.resetToPath(i),z(o.nextPath());const a=this.m_toleranceSimplify.total();let l=!1,u=!0;const c=new Jt,h=new Jt,d=new N;for(;o.hasNextSegment();){this.progress_();const _=o.nextSegment();if(qc.isShortSegment(_,r,a,s))if(l){if(_.queryEnd(h),qc.isShortSegmentPoints(c,h,r,a,s))continue;u&&(n.startPathPoint(c),u=!1),_.queryEnd(c),n.lineToPoint(c),l=!1}else d.assign(_.getStartXY()),_.queryStart(c),l=!0;else if(l)if(_.isCurve()){const v=_.clone();if(v.setCoordsForIntersector(d,_.getEndXY(),!1),v.setStart(c),qc.isShortSegment(v,r,a,s))continue;n.addSegment(v,u),u=!1,l=!1}else{if(_.queryEnd(h),qc.isShortSegmentPoints(c,h,r,a,s))continue;u&&(n.startPathPoint(c),u=!1),n.lineToPoint(h),l=!1}else n.addSegment(_,u),u=!1}if(u||!l)return;e.isClosedPath(i)?e.getPointByVal(e.getPathStart(i),c):e.getPointByVal(e.getPathEnd(i)-1,c);const m=n.querySegmentIterator();m.resetToLastPath(),m.resetToLastSegment();const f=n.getDescription().getAttributeCount()>1;for(z(m.previousPath());m.hasPreviousSegment();){const _=m.previousSegment();if(_.isCurve()){const v=_.clone();if(v.setCoordsForIntersector(_.getStartXY(),c.getXY(),!1),!qc.isShortSegment(v,r,a,s)){f&&v.setEnd(c);const x=m.getEndPointIndex();for(let w=n.getPointCount()-1;w>=x;w--)n.removePoint(w);return void n.addSegment(v,!1)}}else if(_.queryStart(h),!qc.isShortSegmentPoints(h,c,r,a,s)){const v=m.getEndPointIndex();for(let x=n.getPointCount()-1;x>=v;x--)n.removePoint(x);return void n.lineToPoint(c)}}n.removePath(n.getPathCount()-1)}multipointIsSimpleAsFeature(){if(!this.checkStructure())return 0;const e=this.m_geometry.getImpl();this.m_multiVertexGeom=e;const i=e.getPointCount(),s=st(i,0);for(let n=0;n<i;n++)s[n]=n;s.sort((n,r)=>this.compareVerticesMultiPoint(n,r));for(let n=1;n<i;n++)if(this.compareVerticesMultiPoint(s[n-1],s[n])===0)return this.m_nonSimpleResult=new Rs(5,s[n-1],s[n]),0;return 1}polylineIsSimpleAsFeature(){return this.checkStructure()&&this.checkDegenerateSegments(!0)?1:0}polygonIsSimpleAsFeature(){return this.isSimplePlanarImpl()}multipointSimplifyAsFeature(){let e=this.m_geometry.getImpl();const i=qc.hasNanZs(e);let s,n=this.m_geometry;i&&(s=this.m_geometry.clone(),e=s.getImpl(),s.replaceNaNs(1,Hs.getDefaultValue(1)),n=s),this.m_multiVertexGeom=e;const r=e.getPointCount(),o=st(r,0);for(let d=0;d<r;d++)o[d]=d;o.sort((d,m)=>this.compareVerticesMultiPoint(d,m));const a=new Array(r);a.fill(!1);let l=-1;for(let d=0;d<r;d++){const m=o[d];e.getXY(m).isFinite()&&((l<0||this.compareVerticesMultiPoint(l,m)!==0)&&(a[m]=!0),l=m)}const u=this.m_geometry.createInstance();let c=0,h=0;for(let d=0;d<r;d++)a[d]?h=d+1:(c<h&&u.addPoints(n,c,h),c=d+1);return c<h&&u.addPoints(n,c,h),u.getImpl().setIsSimple(1,this.m_toleranceSimplify.total()),u}polylineSimplifyAsFeature(){const e=this.m_geometry.getImpl(),i=e.querySegmentIterator(),s=e.querySegmentIterator(),n=this.m_geometry.createInstance(),r=this.m_geometry,o=e.hasAttribute(1),a=o?uJ(this.m_sr,e,!0).total():0,l=[],u=[];let c=null;o&&(c=e.getAttributeStreamRef(1));const h=new Jt,d=e.hasNonLinearSegments(),m=this.m_toleranceSimplify.total();for(;i.nextPath();){if(s.nextPath(),e.getPathSize(i.getPathIndex())<2)continue;if(d&&e.hasNonLinearSegmentsPath(i.getPathIndex())){this.removeDegenerateSegmentsFromCurvedPath(e,i.getPathIndex(),a,n);continue}s.resetToLastSegment();let f=0,_=0,v=!0,x=!0;for(;i.hasNextSegment();){this.progress_();const w=i.nextSegment(),T=s.previousSegment();if(i.getStartPointIndex()>s.getStartPointIndex())break;if(v){const C=i.getStartPointIndex();e.getXY(C).isNAN()||(v=!1,l.push(C))}if(x){const C=s.getEndPointIndex();e.getXY(C).isNAN()||(u.push(C),x=!1)}if(!v){const C=l.at(-1),M=i.getEndPointIndex();if(M-C>1){const A=new N;A.setSub(e.getXY(C),e.getXY(M)),f=A.length()}else f=w.calculateLength2D();if(f>m)l.push(M),f=0;else if(o){let A=c.read(C);Number.isNaN(A)&&(A=0);let I=c.read(M);Number.isNaN(I)&&(I=0),Math.abs(I-A)>a&&(l.push(M),f=0)}}if(!x){const C=u.at(-1),M=s.getStartPointIndex();if(M-C>1){const A=new N;A.setSub(e.getXY(C),e.getXY(M)),_=A.length()}else _=T.calculateLength2D();if(_>m)u.push(M),_=0;else if(o){let A=c.read(C);Number.isNaN(A)&&(A=0);let I=c.read(M);Number.isNaN(I)&&(I=0),Math.abs(I-A)>a&&(u.push(M),_=0)}}}if(l.length>0&&u.length>0&&(l.at(-1)<u.at(-1)?l.length>u.length?l.pop():u.pop():(l.at(-1)===u.at(-1)||u.pop(),u.pop())),u.length+l.length>=2){let w=!1;for(let T=0,C=l.length;T<C;T++)r.getPointByVal(l[T],h),w?n.lineToPoint(h):(n.startPathPoint(h),w=!0);for(let T=u.length-1;T>0;T--)r.getPointByVal(u[T],h),w?n.lineToPoint(h):(n.startPathPoint(h),w=!0);r.isClosedPath(i.getPathIndex())?n.closePathWithLine():u.length>0&&(r.getPointByVal(u[0],h),n.lineToPoint(h))}l.length=0,u.length=0}return o&&n.replaceNaNs(1,0),n.getImpl().setIsSimple(1,m),n}polygonSimplifyAsFeature(){return this.simplifyPlanar()}simplifyPlanar(){if(this.m_geometry.getFillRule()===1&&!Gm(this.m_knownSimpleResult))return vL(this.m_geometry,this.m_toleranceSimplify,!0,!1,this.m_knownSimpleResult,this.m_progressTracker,0,!0);const e=new wn;if(e.addGeometry(this.m_geometry),this.m_geometry.hasAttribute(1)&&e.replaceNaNs(1,0),e.removeNaNVertices(),e.getTotalPointCount()!==0){let s=null,n=0,r=0;if(e.hasCurves()){s=new pu;const o=J.constructEmpty();this.m_geometry.queryEnvelope(o);const a=mu(this.m_toleranceSimplify.total(),o);n=od(this.m_toleranceSimplify.total()),r=ud(a,n),nc(e,a,this.m_toleranceSimplify.total(),12e3,s,null,this.m_progressTracker)}Gm(this.m_knownSimpleResult)||Qh(e,this.m_toleranceSimplify.add(r),this.m_progressTracker,!0,!1),this.m_geometry.getGeometryType()===q.enumPolygon&&bf(e,e.getFirstGeometry(),this.m_knownSimpleResult,!1,-1,this.m_progressTracker),s!==null&&s.stitchCurves(e,e.getFirstGeometry(),n,!0)}const i=e.getGeometry(e.getFirstGeometry());return i.getGeometryType()===q.enumPolygon&&(i.getImpl().updateOGCFlagsProtected(),i.setFillRule(0)),i.getImpl().setIsSimple(4,this.m_toleranceSimplify.total()),i}progress_(){}static hasNanZs(e){if(e.hasAttribute(1)){const i=e.getAttributeStreamRef(1);for(let s=0,n=e.getPointCount();s<n;s++){const r=i.read(s);if(Number.isNaN(r))return!0}}return!1}compareVerticesForPlanarClustering(e,i,s){if(e===i)return 0;const n=this.m_pairs[e],r=this.m_pairs[i],o=n>>1,a=r>>1,l=this.m_xy.readPoint2D(2*o);l.y+=1&n?this.m_toleranceIsSimpleClustering:-this.m_toleranceIsSimpleClustering;const u=this.m_xy.readPoint2D(2*a);u.y+=1&r?this.m_toleranceIsSimpleClustering:-this.m_toleranceIsSimpleClustering;const c=l.compare(u);if(c===0&&s){const h=this.m_pathsForOGCTests[o]-this.m_pathsForOGCTests[a];return In(h)}return c}compareVerticesMultiPoint(e,i){if(e===i)return 0;const s=this.m_multiVertexGeom.getXY(e),n=this.m_multiVertexGeom.getXY(i),r=!s.isFinite(),o=!n.isFinite();if(r||o)return r<o?-1:r>o?1:0;if(s.y<n.y)return-1;if(s.y>n.y)return 1;if(s.x<n.x)return-1;if(s.x>n.x)return 1;for(let a=1;a<this.m_attributeCount;a++){const l=this.m_description.getSemantics(a),u=Hs.getComponentCount(l);for(let c=0;c<u;c++){const h=this.m_multiVertexGeom.getAttributeAsDbl(l,e,c),d=this.m_multiVertexGeom.getAttributeAsDbl(l,i,c),m=h3e(h,d);if(m!==0)return m}}return 0}edgeAngleCompare(e,i){if(e===i)return 0;const s=e.m_segment.getTangent(e.getReversed()?1:0);e.getReversed()&&s.negateThis();const n=i.m_segment.getTangent(i.getReversed()?1:0);i.getReversed()&&n.negateThis();const r=s.getQuarter(),o=n.getQuarter();if(o===r){const a=s.crossProduct(n);return a<0?1:a>0?-1:0}return r<o?-1:1}}class Am{getOperatorType(){return 10103}accelerateGeometry(e,i,s){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}isSimpleAsFeature(e,i,s,n,r){const o=cj(e,i,s,n,r);return tOe(e.getGeometryType(),o)}isSimplePlanarDONOTUSE(e,i,s,n,r){const o=mUe(e,i,s,n,r);return ry(o)}executeMany(e,i,s,n){return new SUe(e,i,s,n)}execute(e,i,s,n){const r=new zm([e]),o=this.executeMany(r,i,s,n).next();return o||We("null geometry"),o}}class SUe extends Pd{constructor(e,i,s,n){super(),this.m_progressTracker=n,this.m_bForceSimplify=s,this.m_index=-1,this.m_inputGeometryCursor=e,this.m_spatialReference=i}next(){const e=this.m_inputGeometryCursor.next();return e?(this.m_index=this.m_inputGeometryCursor.getGeometryID(),this.simplify(e)):null}getGeometryID(){return this.m_index}tock(){return!1}getRank(){return 1}simplify(e){if(e||ce(""),e.getGeometryType()===q.enumGeometryCollection){const i=gOe(e,-1),s=new Am().executeMany(i,this.m_spatialReference,this.m_bForceSimplify,this.m_progressTracker),n=e.createInstance();for(let r=s.next();r!=null;r=s.next())n.addGeometry(r);return n}return age(e,this.m_spatialReference,this.m_bForceSimplify,this.m_progressTracker)}}function EUe(t,e,i){const s=new J;t.queryEnvelope(s);const n=new J;e.queryEnvelope(n);const r=new J(n);if(r.inflate(2*i),!r.isIntersecting(s))return 4;const o=t.getGeometryType(),a=e.getGeometryType();if(o===q.enumEnvelope&&s.containsEnvelope(r))return 1;if(a===q.enumEnvelope){const l=new J(s);if(l.inflate(2*i),n.containsEnvelope(l))return 2}return 0}class Kv{constructor(e,i,s,n){this.m_intersectorGeom=null,this.m_sr=null,this.m_dimensionMask=-1,this.m_progressTracker=null,this.m_intersectorGeomType=q.enumUnknown,this.m_geomIntersectorEmptyGeom=null,this.m_intersectorGeom=e,this.m_sr=i,this.m_dimensionMask=s,this.m_progressTracker=n,this.m_intersectorGeomType=e.getGeometryType()}intersect(e){const i=this.tryFastImplementation(e);if(i!==null)return i;const s=ID(this.m_intersectorGeom,e),n=yr(this.m_sr,s,!0).total(),r=J.constructEmpty();this.m_intersectorGeom.queryEnvelope(r);const o=J.constructEmpty();e.queryEnvelope(o),r.inflateCoords(2*n,2*n),r.intersect(o),r.inflateCoords(100*n,100*n);const a=0;let l=Is(this.m_intersectorGeom,r,a,0,this.m_progressTracker),u=Is(e,r,a,0,this.m_progressTracker);return e.getDimension()>this.m_intersectorGeom.getDimension()&&(l=Ge(u,u=l)),oUe(u,l,this.m_sr,this.m_progressTracker)}intersectEx(e){const i=this.tryFastImplementation(e);if(i!==null){const h=[];return h.length=3,h[i.getDimension()]=i,this.prepareVector(e.getDescription(),this.m_dimensionMask,h)}const s=ID(this.m_intersectorGeom,e),n=yr(this.m_sr,s,!0).total(),r=J.constructEmpty();this.m_intersectorGeom.queryEnvelope(r);const o=J.constructEmpty();e.queryEnvelope(o),r.inflateCoords(2*n,2*n),r.intersect(o),r.inflateCoords(100*n,100*n);const a=0;let l=Is(this.m_intersectorGeom,r,a,0,this.m_progressTracker),u=Is(e,r,a,0,this.m_progressTracker);e.getDimension()>this.m_intersectorGeom.getDimension()&&(l=Ge(u,u=l));const c=aUe(u,l,this.m_sr,this.m_progressTracker);return this.prepareVector(e.getDescription(),this.m_dimensionMask,c)}init(e,i,s,n=null){z(0)}static intersectPoints(e,i,s){const n=ID(e,i);return rUe(e,i,yr(s,n,!0))}tryFastImplementation(e){const i=e.getGeometryType();if(this.m_intersectorGeomType===q.enumPoint&&i===q.enumPoint){const l=Kv.intersectPoints(e,this.m_intersectorGeom,this.m_sr);if(this.m_dimensionMask!==-1){const u=new Dn({vd:l.getDescription()});return l.isEmpty()||u.add(l),u}return l}if(i===q.enumEnvelope&&this.m_intersectorGeomType===q.enumEnvelope&&(this.m_dimensionMask===-1||this.m_dimensionMask===4)){const l=e,u=this.m_intersectorGeom,c=new Fo({copy:l});return c.intersect(u),c}const s=ID(e,this.m_intersectorGeom),n=yr(this.m_sr,s,!0),r=e.isEmpty(),o=this.m_intersectorGeom.isEmpty();let a=r||o;if(!a){const l=EUe(this.m_intersectorGeom,e,n.total());if(l===4)a=!0;else{if(2&l)return this.m_intersectorGeom;if(1&l)return e}}if(a){const l=Pl(i),u=Pl(this.m_intersectorGeomType);return l<u?Kv.ReturnEmpty(e,r):l>u||l===0&&i===q.enumMultiPoint&&this.m_intersectorGeomType===q.enumPoint?this.ReturnEmptyIntersector():Kv.ReturnEmpty(e,r)}if(i===q.enumEnvelope&&Pl(this.m_intersectorGeomType)===0||this.m_intersectorGeomType===q.enumEnvelope&&Pl(i)===0){const l=i===q.enumEnvelope?e:this.m_intersectorGeom,u=i===q.enumEnvelope?this.m_intersectorGeom:e,c=J.constructEmpty();return l.queryEnvelope(c),Is(u,c,n.total(),0,this.m_progressTracker)}if(Pl(i)===0&&Pl(this.m_intersectorGeomType)>0||Pl(i)>0&&Pl(this.m_intersectorGeomType)===0){if(i===q.enumMultiPoint)return ete(e,this.m_intersectorGeom,n);if(i===q.enumPoint)return tte(e,this.m_intersectorGeom,n);if(this.m_intersectorGeomType===q.enumMultiPoint)return ete(this.m_intersectorGeom,e,n);if(this.m_intersectorGeomType===q.enumPoint)return tte(this.m_intersectorGeom,e,n);We("")}return null}ReturnEmptyIntersector(){return this.m_geomIntersectorEmptyGeom===null&&(this.m_geomIntersectorEmptyGeom=this.m_intersectorGeom.createInstance()),this.m_geomIntersectorEmptyGeom}static ReturnEmpty(e,i){return i?e:e.createInstance()}prepareVector(e,i,s){let n=0;return 1&i?(s[0]||(s[0]=new Dn({vd:e})),n++):s.shift(),2&i?(s[n]||(s[n]=new Qi({vd:e})),n++):s.splice(n,1),4&i?s[n]||(s[n]=new Ci({vd:e})):s.splice(n,1),new zm(s)}}class CUe extends Pd{constructor(e,i,s,n,r){super(),this.m_smallCursor=null,this.m_progressTracker=n,this.m_geomIntersector=i.next(),this.m_intersector=new Kv(this.m_geomIntersector,s,r,n),this.m_index=-1,this.m_inputGeoms=e,this.m_dimensionMask=r,this.m_dimensionMask!==-1&&(this.m_dimensionMask<=0||this.m_dimensionMask>7)&&ce("bad dimension mask")}next(){if(!this.m_geomIntersector)return null;let e;if(this.m_smallCursor!==null){if(e=this.m_smallCursor.next(),e)return e;this.m_smallCursor=null}for(;e=this.m_inputGeoms.next();)return Um(e),this.m_index=this.m_inputGeoms.getGeometryID(),this.m_dimensionMask===-1?this.m_intersector.intersect(e):(this.m_smallCursor=this.m_intersector.intersectEx(e),this.m_smallCursor.next());return null}getGeometryID(){return this.m_index}tock(){return!0}getRank(){return 1}}class P1{getOperatorType(){return 1e4}accelerateGeometry(e,i,s){if(!this.canAccelerateGeometry(e))return!1;Fl(i,e,!0);let n=0;return e.getGeometryType()!==q.enumPolygon&&e.getGeometryType()!==q.enumPolyline||!nL(e)||s===0||(n|=e.getImpl().buildQuadTreeAccelerator(s)?1:0),!!n}canAccelerateGeometry(e){return nL(e)}supportsCurves(){return!0}executeMany(e,i,s,n,r=-1){return new CUe(e,i,s,n,r)}execute(e,i,s,n){if(e.getGeometryType()===q.enumPoint&&i.getGeometryType()===q.enumPoint)return Kv.intersectPoints(e,i,s);const r=new zm([e]),o=new zm([i]),a=this.executeMany(r,o,s,n,-1).next();return a||We("null output"),a}}function uge(t,e,i){return e.m_projector.project(t,i)}function TUe(t,e,i,s,n){t.m_projector.transformInPlaceZ(e,null,i,s,null,n);const r=s.slice(0,i).filter(o=>!o.isNAN());for(let o=0,a=r.length;o<a;++o)s[o].assign(r[o]);return r.length}function hj(t,e,i,s,n){return t.m_projector.transformInPlaceZ(e,null,i,s,null,n)}function _B(t,e,i,s){if(t&&e&&e.isPannable()||ce("fold_into_360_range_geodetic"),t.isEmpty())return t;if(i===4)return xL(t,e,s);let n=t;const r=n.getGeometryType();if(Ei(r)){n=nE(t,e);const o=new J;n.queryEnvelope(o);const a=yr(e,o,!1).total(),l=e.getPannableExtent();let u=Math.floor((o.xmin-l.xmin)/l.width())*l.width()+l.xmin,c=n;for(;u<o.xmax;)u>o.xmin+a&&u<o.xmax-a&&(c=Sge(c,e,i,!0,u)),u+=l.width();n=c}else{if(r===q.enumEnvelope){const o=new Ci({vd:n.getDescription()});return o.addEnvelope(n,!1),_B(o,e,i,s)}if(nr(r)){const o=new Qi({vd:n.getDescription()});return o.addSegment(n,!0),_B(o,e,i,s)}}return xL(n,e,s)}function xL(t,e,i){if(t&&e&&e.isPannable()||ce(""),t.isEmpty())return t;let s;const n=t.getGeometryType();if(n===q.enumEnvelope){const o=new Ci({vd:t.getDescription()});o.addEnvelope(t,!1),s=o}else if(nr(n)){const o=new Qi({vd:t.getDescription()});o.addSegment(t,!0),s=o}else s=t;const r=nE(s,e);return r.isEmpty()?r:vS(r,e,0,r!==t,0,i)}function PUe(t,e,i){if(!e.isPannable()||t.isEmpty())return t;const s=e.getPannableExtent().width(),n=.5*s,r=t.queryInterval(0,0);if(r.width()<n||!ll(t.getGeometryType())){if(Number.isNaN(i))return t;const x=r.getCenter();if(Math.abs(x-i)<=n)return t;{const w=new Gi,T=g1((i-x)/s)*s;w.setShiftCoords(T,0);const C=t.clone();return C.applyTransformation(w),C}}const o=t.getGeometryType(),a=t,l=a.getAttributeStreamRef(0),u=t.clone(),c=u.getAttributeStreamRef(0);let h=0,d=0,m=0,f=Ei(o)?0:-1;const _=Me.constructEmpty();let v=!1;for(let x=0,w=a.getPointCount();x<w;x++){const T=l.read(2*x);x===d&&(Ei(o)?(f===0&&Number.isNaN(i)&&(v=!0),f>0&&Number.isNaN(i)&&(i=_.getCenter(),v=!1),d=a.getPathEnd(f),f++):d=a.getPointCount(),Number.isNaN(i)?m=T:(m=i,h=0));let C=T-m;Math.abs(C)>n&&(C=g1(C/s)*s,h-=C,Math.abs(h)<.1*s&&(h=0));const M=T+h;c.write(2*x,M),v&&_.mergeCoordinate(M),m=T}return u.notifyModified(),u}const MUe="missing implementation";function AUe(t,e,i,s){const n=e.getCoordinateSystemType();if(n===0){const a=new ta;return e.queryPrecisionDescriptor(a),ste(t,a,e,i)}let r=t;s!==2&&s!==3||!e.isPannable()||(r=xL(r,e,i));const o=new ta;if(e.queryPrecisionDescriptor(o),r=ste(r,o,e,i),s===0||r.isEmpty())return r;if(n===1){if(s===1){const a=new J;r.queryLooseEnvelope(a);const l=e.getPannableExtent(),u=.01*l.width();return l.xmin=a.xmin-u,l.xmax=a.xmax+u,new _S().execute(r,l,e,i)}return r}if(n===2){const a=e.getPCSHorizon();if(s===1||s===2){const l=new P1().execute(r,a,e,i);return l===a?l.clone():l}return r}if(n===3)return r;We(MUe)}function ste(t,e,i,s){const n=e.getXYGridRange(),r=t.hasAttribute(1),o=t.hasAttribute(2);let a=new Me,l=new Me;r&&(a=e.getZGridRange()),o&&(l=e.getMGridRange());let u=new _S().execute(t,n,i,s);if(r){const c=u.queryInterval(1,0);a.contains(c)||(t===u&&(u=u.clone()),PG(u,a,1,0))}if(o){const c=u.queryInterval(2,0);l.contains(c)||(t===u&&(u=u.clone()),PG(u,l,2,0))}return u}class IUe{constructor(e){this.m_inputPCSHorizonClipOption=0,this.m_outputPCSHorizonClipOption=0,this.m_bDontGeonormalizePolygon=!1,this.m_bClipOutCurvedPoles=!1,this.m_bNormalizeOutputGeometry=!1,this.m_bDontHackPolesInGeogToGeog=!1,this.m_centralMeridianOfOutputGCS=0,this.m_densificationStepInput=0,e||ce(""),this.m_projTransform=e,this.m_bClipOutCurvedPoles=!1;const i=this.m_projTransform.getExtendedParamsImpl();this.m_bNormalizeOutputGeometry=i.normalizeResultGeometry,this.m_bNormalizeOutputGeometry&&(i.legacyHorizonClipping?this.m_bNormalizeOutputGeometry=!1:this.m_projTransform.getOutputSR().isPannable()||(this.m_bNormalizeOutputGeometry=!1)),i.clipWithInputHorizon?(this.m_inputPCSHorizonClipOption=0,!i.legacyHorizonClipping&&this.m_projTransform.getInputSR().isPannable()&&(this.m_inputPCSHorizonClipOption=this.m_bNormalizeOutputGeometry?4:2)):this.m_inputPCSHorizonClipOption=1,i.clipWithOutputHorizon?(this.m_outputPCSHorizonClipOption=0,!i.legacyHorizonClipping&&this.m_projTransform.getOutputSR().isPannable()&&(this.m_outputPCSHorizonClipOption=this.m_bNormalizeOutputGeometry?4:2)):this.m_outputPCSHorizonClipOption=1,this.m_centralMeridianOfOutputGCS=i.centralMeridianOfOutputGCS,this.m_densificationStepInput=i.densificationStep;const s=this.m_projTransform.getExtendedParamsInternal();this.m_bDontGeonormalizePolygon=s.hasFlag(2147483648),this.m_bDontHackPolesInGeogToGeog=s.hasFlag(1073741824),this.m_bClipOutCurvedPoles=s.hasFlag(536870912)}project(e,i){if(this.m_projTransform.isIdentity()||e.isEmpty())return e;const s=e.getGeometryType();if(s===q.enumPoint)return this.projectPoint(e,i);const n=this.m_projTransform.getInputSR().getCoordinateSystemType(),r=this.m_projTransform.getOutputSR().getCoordinateSystemType(),o=this.m_projTransform.getInputSR(),a=this.m_projTransform.getOutputSR();if(n===0&&n===r){const l=nte(o,a),u=e.clone();return u.applyTransformation(l),u}switch(s){case q.enumPolyline:case q.enumPolygon:return this.projectMultiPath(e,i);case q.enumMultiPoint:return this.projectMultiPoint(e,i);case q.enumEnvelope:return this.projectEnvelope(e,i);case q.enumGeometryCollection:return this.projectGeometryCollection(e,i);default:We("")}}projectPoint(e,i){const s=[e.getXY()];let n,r=null;(n=e.hasAttribute(1))&&(r=[e.getZ()]),this.transformInPlaceZ(s,r,1,s,r,null);const o=e.clone();return o.setXY(s[0]),n&&o.setZ(r[0]),o}projectMultiPoint(e,i){let s=new Dn({copy:e});const n=this.m_projTransform.getInputSR(),r=this.m_projTransform.getOutputSR(),o=n.getCoordinateSystemType(),a=r.getCoordinateSystemType();if(o===3&&z(0),s=u3(s,n,this.m_inputPCSHorizonClipOption,i),s.isEmpty())return s;o===2&&Tge(n,0,s),Mge(this.m_projTransform,s,!1);let l=0;a===3&&z(0);const u=a===2;return u?l=r.getCentralMeridian():Number.isNaN(this.m_centralMeridianOfOutputGCS)||(l=this.m_centralMeridianOfOutputGCS),u&&this.m_outputPCSHorizonClipOption!==0||(s=vS(s,h3(r),l,!1,0,i)),u&&(s=WU(s,r,this.m_outputPCSHorizonClipOption,i),Cge(r,s,this.m_bNormalizeOutputGeometry),s.isEmpty()),s}projectMultiPath(e,i){const s=e.getGeometryType();return s===q.enumPolygon?this.projectPolygon(e,i):s===q.enumPolyline?this.projectPolyline(e,i):void We("project_multi_path_")}projectEnvelope(e,i){this.m_projTransform.getInputSR(),this.m_projTransform.getOutputSR();const s=this.m_projTransform.isVertical()&&e.hasAttribute(1);let n=Me.constructEmpty();if(s&&(n=e.queryInterval(1,0)),n.width()>0){const r=e.clone();r.setInterval(1,0,n.vmin,n.vmin);const o=this.projectEnvelopeHelper(r,i);r.setInterval(1,0,n.vmax,n.vmax);const a=this.projectEnvelopeHelper(r,i);return o.merge(a),o}return this.projectEnvelopeHelper(e,i)}projectPolygon(e,i){z(e.getGeometryType()===q.enumPolygon),z(!this.m_projTransform.isIdentity()),z(!e.isEmpty());const s=this.m_projTransform.getInputSR(),n=this.m_projTransform.getOutputSR(),r=s.getCoordinateSystemType(),o=n.getCoordinateSystemType(),a=new Ci({copy:e});r===3&&z(0),o===3&&z(0);const l=r===2,u=o===2,c=l?s.getGCS():s,h=u?n.getGCS():n,d=!u&&!this.m_bDontHackPolesInGeogToGeog;let m=!1,f=u3(a,s,this.m_inputPCSHorizonClipOption,i);if(f.isEmpty())return f;let _=this.m_densificationStepInput;const v=!Number.isNaN(_);let x;v&&(f=new Tv().execute(f,_,0,0,i));let w=u?n.getPCSInfo():null,T=Number.NaN;l&&(T=s.getCentralMeridian());const C=n.getGCSSplitLines()!==null;if(this.m_bDontGeonormalizePolygon){const M=f;if(l&&(XD(s,T,M),v)){const A=s.getUnitsPerMillimeter();_*=s.getGCS().getUnitsPerMillimeter()/A}if(WD(this.m_projTransform,M,d),v){const A=s.getGCS().getUnitsPerMillimeter();_*=n.getGCS().getUnitsPerMillimeter()/A}x=M}else{let M=new Qi({vd:f.getDescription()});if(M.addAndExplicitlyOpenAllPaths(f,!1),l){if(XD(s,T,M),v){const D=s.getUnitsPerMillimeter();_*=s.getGCS().getUnitsPerMillimeter()/D}if(this.m_bClipOutCurvedPoles){const D=s.getPCSInfo(),O=D.getSouthPoleGeometry()===_o.PE_POLE_LINE_CURVED,U=D.getNorthPoleGeometry()===_o.PE_POLE_LINE_CURVED;if(O||U){const $=J.constructEmpty();M.queryLooseEnvelope($),$.inflateCoords(1,1);const B=89.9999*c.getOneDegreeGCSUnit();O&&($.ymin=-B),U&&($.ymax=B),M=t4e(M,$,c,0,0,i)}}}if(WD(this.m_projTransform,M,d),v){const D=h3(s).getUnitsPerMillimeter();_*=h3(n).getUnitsPerMillimeter()/D}let A=Number.NaN;u?(w=n.getPCSInfo(),A=n.getCentralMeridian()):Number.isNaN(this.m_centralMeridianOfOutputGCS)||(A=this.m_centralMeridianOfOutputGCS);let I=YD(s)|YD(n),L=10*h.getTolerance(0);this.m_bDontHackPolesInGeogToGeog&&(I=3,L=10*h.getTolerance(0)),x=D5e(f,s,M,h,A,i,I,L,this.m_bNormalizeOutputGeometry),I=0}if(C&&(z(!n.isPannable()),x=wB(x,n,i)),u){if(!m){const M=h.getPannableExtent().width();if(x.queryInterval(0,0).width()>=M-10*h.getTolerance(0)){const A=w.getNorthPoleLocation(),I=w.getSouthPoleLocation(),L=w.getNorthPoleGeometry(),D=w.getSouthPoleGeometry();let O=0;L===_o.PE_POLE_POINT&&A!==_o.PE_POLE_OUTSIDE_BOUNDARY&&(O=1),D===_o.PE_POLE_POINT&&I!==_o.PE_POLE_OUTSIDE_BOUNDARY&&(O|=2),m||(m=O!==0)}}x=WU(x,n,this.m_outputPCSHorizonClipOption,i),v&&(x=new Tv().execute(x,_,0,0,i)),fte(n,x,this.m_bNormalizeOutputGeometry)}return x.isEmpty()||m&&(x=new Am().execute(x,n,!1,i)),x}projectPolyline(e,i){z(e.getGeometryType()===q.enumPolyline),z(!this.m_projTransform.isIdentity()),z(!e.isEmpty());const s=this.m_projTransform.getInputSR(),n=this.m_projTransform.getOutputSR(),r=s.getCoordinateSystemType(),o=n.getCoordinateSystemType(),a=new Qi({copy:e});r===3&&z(0),o===3&&z(0);const l=r===2,u=o===2;l&&s.getGCS();const c=u?n.getGCS():n,h=!u&&!this.m_bDontHackPolesInGeogToGeog;let d=u3(a,s,this.m_inputPCSHorizonClipOption,i);if(d.isEmpty())return d;let m=Number.NaN;l&&(m=s.getCentralMeridian());const f=n.getGCSSplitLines()!==null;let _=this.m_densificationStepInput;const v=!Number.isNaN(_);let x;if(v&&(d=new Tv().execute(d,_,0,0,i)),this.m_bDontGeonormalizePolygon){if(l&&(XD(s,m,d),v)){const w=s.getUnitsPerMillimeter();_*=s.getGCS().getUnitsPerMillimeter()/w}if(WD(this.m_projTransform,d,h),v){const w=s.getGCS().getUnitsPerMillimeter();_*=n.getGCS().getUnitsPerMillimeter()/w}x=d}else{const w=new Qi({vd:d.getDescription()});if(w.addAndExplicitlyOpenAllPaths(d,!1),l&&(XD(s,m,w),v)){const A=s.getUnitsPerMillimeter();_*=s.getGCS().getUnitsPerMillimeter()/A}if(WD(this.m_projTransform,w,h),v){const A=s.getGCS().getUnitsPerMillimeter();_*=n.getGCS().getUnitsPerMillimeter()/A}let T=Number.NaN;u?T=n.getCentralMeridian():Number.isNaN(this.m_centralMeridianOfOutputGCS)||(T=this.m_centralMeridianOfOutputGCS);let C=YD(s)|YD(n),M=10*c.getTolerance(0);this.m_bDontHackPolesInGeogToGeog&&(C=3,M=0),x=N5e(d,s,w,c,T,i,C,M,this.m_bNormalizeOutputGeometry),C=0}return f&&(z(!n.isPannable()),x=wB(x,n,i)),u&&(x=WU(x,n,this.m_outputPCSHorizonClipOption,i),v&&(x=new Tv().execute(x,_,0,0,i)),fte(n,x,this.m_bNormalizeOutputGeometry)),x.isEmpty(),x}projectGeometryCollection(e,i){return z(0),{}}projectEnvelopeHelper(e,i){const s=(e.height()+e.width())/400;if(s!==0){const n=new Tv().execute(e,s,0,0,i),r=this.projectMultiPath(n,i),o=new Fo({vd:e.getDescription()});if(r.isEmpty()){const a=Math.min(e.height(),e.width()),l=Fl(this.m_projTransform.getInputSR(),e,!0).total();if(a>100*l){const f=J.constructEmpty(),_=yr(this.m_projTransform.getOutputSR(),f,!0).total(),v=this.m_projTransform.getInputSR().getOneMeter()/this.m_projTransform.getOutputSR().getOneMeter();if(a>100*Math.max(l,_*v))return o}const u=new Qi;u.addAndExplicitlyOpenAllPaths(n,!1),this.projectMultiPath(u,i).queryEnvelope(o);const c=new Dn({vd:e.getDescription()});c.reserve(4);const h=new Jt;for(let f=0;f<4;f++)e.queryCornerByVal(f,h),c.add(h);const d=this.projectMultiPoint(c,i),m=new Fo;return d.queryEnvelope(m),o.merge(m),o}return r.queryEnvelope(o),o}{const n=e.getCenterXY(),r=new Jt(n),o=this.projectPoint(r,i),a=new Fo({vd:e.getDescription()});if(o.isEmpty())a.setEmpty();else{e.copyTo(a);const l=o.getXY();a.setCoords(l.x,l.y,l.x,l.y)}return a}}transformInPlace(e,i,s,n){return z(0),0}transformInPlaceZ(e,i,s,n,r,o){if(this.m_projTransform.isIdentity())return e!==n&&JO(n,e,s),i!==r&&Qs(r,i,0,0,s),s;const a=this.m_projTransform,l=a.getInputSR(),u=a.getOutputSR(),c=l.getCoordinateSystemType(),h=u.getCoordinateSystemType();if(c===0&&c===h)return nte(l,u).transformPoints2D(e,s,n),a.isVertical()&&z(0),s;c===3&&_i("image: transform_in_place_"),h===3&&_i("image: transform_in_place_"),F5e(e,s,n,l,this.m_inputPCSHorizonClipOption),r!==i&&Qs(r,i,0,0,s),c===2&&y4(l,0,n,s),M1(this.m_projTransform,n,r,s,!1);let d=0;const m=h===2;if(m?d=u.getCentralMeridian():Number.isNaN(this.m_centralMeridianOfOutputGCS)||(d=this.m_centralMeridianOfOutputGCS),m&&this.m_outputPCSHorizonClipOption!==0||wge(n,s,u.getGCS(),d),m){if(!EB(n,s,u,this.m_outputPCSHorizonClipOption))for(let _=0;_<s;++_)n[_].setNAN();g4(u,n,s,!1)}let f=s;for(let _=0;_<s;++_)n[_].isNAN()&&(r&&(r[_]=Number.NaN),f--);return f}}function YD(t){if(t.getCoordinateSystemType()!==2)return 0;let e=0;const i=t.getPCSInfo(),s=i.getNorthPoleLocation(),n=i.getSouthPoleLocation(),r=i.getNorthPoleGeometry(),o=i.getSouthPoleGeometry();return r===_o.PE_POLE_POINT&&s!==_o.PE_POLE_OUTSIDE_BOUNDARY&&(e=1),o===_o.PE_POLE_POINT&&n!==_o.PE_POLE_OUTSIDE_BOUNDARY&&(e|=2),e}function nte(t,e){const i=t.getHorzUnitFactor(),s=e.getHorzUnitFactor();let n=1,r=1;const o=20015077/180;t.getUnit().getUnitType()===1&&(n=o),e.getUnit().getUnitType()===1&&(r=o);const a=i/s*(n!==r?n/r:1),l=new Gi;return l.setScaleCoords(a,a),l}let Cd=class{getOperatorType(){return 10300}supportsCurves(){return!0}accelerateGeometry(t,e,i){return!1}canAccelerateGeometry(t){return!1}executeMany(t,e,i){return!e||e.isIdentity()?t:new DUe(t,e,i)}execute(t,e,i){return e.isIdentity()?t:uge(t,e,i)}transform(t,e,i,s,n=!0){return n?TUe(t,e,i,s,null):hj(t,e,i,s,null)}transform3D(t,e,i,s,n=!0){return z(0),0}foldInto360Range(t,e){return xL(t,e,null)}foldInto360RangeGeodetic(t,e,i){return _B(t,e,i,null)}normalizeGeometryEx(t,e,i,s,n=0){return e5e(t,e,i,s,n)}normalizeGeometry(t,e,i){return PUe(t,e,i)}clipToSpatialReference(t,e,i,s=0){return AUe(t,e,i,s)}};class DUe extends Pd{constructor(e,i,s){super(),this.m_projTrans=i,this.m_progressTracker=s,this.m_index=-1,e||ce(""),this.m_inputGeoms=e}next(){const e=this.m_inputGeoms.next();return e!=null?(NP(e),Um(e),this.m_index=this.m_inputGeoms.getGeometryID(),uge(e,this.m_projTrans,this.m_progressTracker)):null}getGeometryID(){return this.m_index}tock(){return!0}getRank(){return 1}}function yB(t,e,i,s,n,r,o=!1){t||ce("Geometry.Geodetic_densify.densify");let a=t.getGeometryType();if(Um(t),t.isEmpty()||lS(a))return t;const l=new RUe;l.m_sr=e,l.m_gcs=e.getGCS(),l.m_transform=l.m_gcs!==e?e.getSRToGCSTransform():null,l.m_progressTracker=r;const u=H1();let c,h,d;if(l.m_gcs.querySpheroidData(u),l.m_a=u.majorSemiAxis,l.m_eSquared=u.e2,l.m_rpu=l.m_gcs.getUnit().getUnitToBaseFactor(),l.m_gcsTolerance=l.m_gcs.getTolerance(0),l.m_radTolerance=l.m_gcsTolerance*l.m_rpu,l.m_maxLength=s,l.m_maxDeviation=n,l.m_curveType=i,a===q.enumEnvelope){const m=new Ci({vd:t.getDescription()});m.addEnvelope(t,!1),c=m,a=q.enumPolygon}else if(nr(a)){const m=new Qi({vd:t.getDescription()});m.addSegment(t,!0),c=m,a=q.enumPolyline}else c=t;if(l.m_curveType!==4){if(z(Ei(a)),h=l.replaceCurvesWithLinesAndProjectToGCSAsMultiPoint_(c),h.isEmpty())return h;h=cge(l.m_rpu,h);let m=l.geodeticDensify(h);o||(m=new Cd().foldInto360RangeGeodetic(m,l.m_gcs,l.m_curveType)),d=l.m_transform&&!l.m_transform.isIdentity()?new Cd().execute(m,l.m_transform.getInverse(),r):m}else{let m;if(z(Ei(a)),e.isPannable())m=nE(c,e);else{const f=e.getPCSHorizon();m=new P1().execute(c,f,e,r),m===f&&(m=f.clone())}if(h=m,h.isEmpty())return h;d=l.shapePreservingDensify(h)}return d}function cge(t,e){const i=new J;if(e.queryLooseEnvelope(i),i.width()*t<Math.PI)return e;let s=!1;const n=e.querySegmentIterator(),r=new N,o=new N;for(;n.nextPath();)for(;n.hasNextSegment();){const f=n.nextSegment();if(r.setCoordsPoint2D(f.getStartXY()),o.setCoordsPoint2D(f.getEndXY()),r.scale(t),o.scale(t),Math.abs(r.x-o.x)>Math.PI){if(!vB(r,o)){s=!0;break}if(Math.abs(r.x-o.x)>2*Math.PI){s=!0;break}}}if(!s)return e;const a=e.createInstance();a.reserve(e.getPointCount());const l=e.getDescription().getAttributeCount()>1,u=new N,c=new N,h=new N(0,0),d=new N(0,0),m=new Jt;for(n.resetToFirstPath();n.nextPath();){let f=Number.NaN,_=0;for(;n.hasNextSegment();){const v=n.nextSegment();if(r.setCoordsPoint2D(v.getStartXY()),o.setCoordsPoint2D(v.getEndXY()),r.scale(t),o.scale(t),Number.isNaN(f)?(_=Uv(r.x,Number.NaN,_),h.setCoordsPoint2D(r)):h.setCoordsPoint2D(d),f=h.x,vB(r,o)){if(o.x-r.x>2*Math.PI)for(;o.x-r.x>2*Math.PI;)o.x-=2*Math.PI;else if(o.x-r.x<2*-Math.PI)for(;o.x-r.x<2*-Math.PI;)o.x+=2*Math.PI;_=Uv(o.x,Number.NaN,_),d.setCoordsPoint2D(o)}else u.setCoordsPoint2D(o),UUe(u),_=Uv(u.x,f,_),d.setCoords(_+u.x,u.y);if(Math.abs(d.x-o.x)<.5&&d.setCoordsPoint2D(o),l)v.queryCoord(0,m),c.setCoordsPoint2D(h),c.scale(1/t),m.setXY(c),n.isFirstSegmentInPath()?a.startPathPoint(m):a.lineToPoint(m),n.isLastSegmentInPath()&&!n.isPathClosed()&&(v.queryCoord(1,m),c.setCoordsPoint2D(d),c.scale(1/t),m.setXY(c),a.lineToPoint(m));else{n.isFirstSegmentInPath()&&a.insertPath2D(-1,null,0,0,!0);const x=a.getPathCount()-1;c.setCoordsPoint2D(h),c.scale(1/t),a.insertPoint2D(x,-1,c),n.isLastSegmentInPath()&&!n.isPathClosed()&&(c.setCoordsPoint2D(d),c.scale(1/t),a.insertPoint2D(x,-1,c))}}}return a}function NUe(t,e,i,s,n,r,o,a,l,u,c,h){const d=new N,m=new N,f=s.compare(n)>0;pge(f,s,n,d,m);const _=mge(t,e,i,d,m,r,o,a,l,u,null,c,h);return f&&xB(l,u,null,c),_}function vB(t,e){return!(!Ts(t.y,zi)||!Ts(e.y,zi))||!(!Ts(t.y,-zi)||!Ts(e.y,-zi))}function hge(t,e){return!(!Ts(t.y,zi)||Ts(e.y,zi))||!(!Ts(t.y,-zi)||Ts(e.y,-zi))}function dge(t,e){return!(!Ts(e.y,zi)||Ts(t.y,zi))||!(!Ts(e.y,-zi)||Ts(t.y,-zi))}class RUe{constructor(){this.m_sr=null,this.m_gcs=null,this.m_transform=null,this.m_progressTracker=null,this.m_a=0,this.m_eSquared=0,this.m_rpu=0,this.m_gcsTolerance=0,this.m_radTolerance=0,this.m_maxLength=0,this.m_maxDeviation=0,this.m_curveType=0}geodeticDensify(e){const i=e.createInstance(),s=e.querySegmentIterator(),n=[],r=[],o=new ii,a=e.getDescription().getAttributeCount()>1;for(;s.nextPath();){const l=[0];for(;s.hasNextSegment();){const u=s.nextSegment(),c=u.getStartXY(),h=u.getEndXY();c.scale(this.m_rpu),h.scale(this.m_rpu);const d=new N,m=new N,f=c.compare(h)>0;pge(f,c,h,d,m),n.length=0,r.length=0,this.m_maxLength>0?mge(this.m_a,this.m_eSquared,this.m_curveType,d,m,this.m_maxLength,this.m_maxDeviation,this.m_radTolerance,null,null,a?r:null,n,l):OUe(),f&&xB(null,null,a?r:null,n),n[0].setCoordsPoint2D(u.getStartXY()),n.at(-1).setCoordsPoint2D(u.getEndXY());const _=1/this.m_rpu;for(let v=1,x=n.length-1;v<x;v++)n[v].scale(_);if(a){const v=lte(f,u,o);ote(s.isFirstSegmentInPath(),s.isLastSegmentInPath()&&!s.isPathClosed(),u,v,r,n,i)}else rte(s.isFirstSegmentInPath(),s.isLastSegmentInPath()&&!s.isPathClosed(),n,i)}}return i}shapePreservingDensify(e){const i=e.createInstance(),s=e.querySegmentIterator(),n=[],r=[],o=new ii,a=e.getDescription().getAttributeCount()>1;for(;s.nextPath();)for(;s.hasNextSegment();){const l=s.nextSegment(),u=l.getStartXY(),c=l.getEndXY(),h=u.compare(c)>0,d=lte(h,l,o);n.length=0,r.length=0,kUe(this.m_a,this.m_eSquared,this.m_rpu,d,this.m_sr,this.m_maxLength,this.m_maxDeviation,a?r:null,n),h&&xB(null,null,a?r:null,n),a?ote(s.isFirstSegmentInPath(),s.isLastSegmentInPath()&&!s.isPathClosed(),l,d,r,n,i):rte(s.isFirstSegmentInPath(),s.isLastSegmentInPath()&&!s.isPathClosed(),n,i)}return i}replaceCurvesWithLinesAndProjectToGCSAsMultiPoint_(e){const i=e.hasNonLinearSegments();if((!this.m_transform||this.m_transform.isIdentity())&&(e=nE(e,this.m_gcs),!i))return e;const s=e.createInstance();s.reserveParts(e.getPointCount(),e.getPathCount());for(let n=0,r=e.getPathCount();n<r;++n){let o=new Dn;const a=e.getPathStart(n),l=e.getPathEnd(n);o.addPoints(e,a,l);const u=e.isClosedPath(n);let c=!1;if(u&&l-a==1&&e.hasNonLinearSegmentsPath(n)){const h=new Jt;e.getPointByVal(a,h),o.add(h),c=!0}if(this.m_transform&&!this.m_transform.isIdentity()){if(u&&!c){const h=new Jt;e.getPointByVal(a,h),o.add(h)}if(o=new Cd().execute(o,this.m_transform,this.m_progressTracker),u&&o.getPointCount()>1){const h=o.getXY(0),d=o.getXY(o.getPointCount()-1);h.equals(d)&&o.removePoint(o.getPointCount()-1)}}o.getPointCount()>1&&(s.addPathMultiPoint(o,0,-1,!0),u&&s.closePathWithLine())}return s}}function rte(t,e,i,s){t&&s.insertPath2D(-1,null,0,0,!0);const n=s.getPathCount()-1;s.insertPointsFromPoints(n,-1,i,0,i.length-1,!0),e&&s.insertPoint2D(n,-1,i.at(-1))}function ote(t,e,i,s,n,r,o){o.reserve(o.getPointCount()+r.length-1);const a=new Jt;if(i.queryStart(a),t?o.startPathPoint(a):o.lineToPoint(a),r.length>2){const l=s.calculateLength2D();for(let u=1;u<r.length-1;u++){const c=s.lengthToT(n[u]*l);s.queryCoord(c,a),a.setXY(r[u]),o.lineToPoint(a)}}e&&(i.queryEnd(a),o.lineToPoint(a))}function mge(t,e,i,s,n,r,o,a,l,u,c,h,d){const m={stack:[],error:void 0,hasError:!1};try{const f=Da(m,new Lo,!1),_=Da(m,new Lo,!1),v=Da(m,new Lo,!1);zl.geodeticDistance(t,e,s.x,s.y,n.x,n.y,v,f,_,i);const x=v.val,w=f.val,T=_.val;let C=w,M=T;C<0&&(C+=2*Math.PI),M<0&&(M+=2*Math.PI),l&&(l[0]=C),u&&(u[0]=M);let A=Number.NaN,I=Number.NaN;if(c!==null){const j=lM.q90(t,e),oe=lM.q(t,e,s.y);A=(j-oe)/x,I=(j+oe)/x}const L=hge(s,n),D=dge(s,n),O=L||D,U=$Ue(s,n,a),$=Da(m,new r3e(new Lo,new Lo),!1),B=new N,V=new N,H=new N;d[0]=Uv(s.x,Number.NaN,d[0]);let Y=d[0];if(x<=r)return h.push(s.clone()),d[0]=Uv(n.x,Number.NaN,d[0]),c!=null&&c.push(0),O?(L&&ute(s,n,c,h),D&&cte(s,n,c,h)):U?hte(s,n,w,A,I,c,h):o>0&&(V.setCoords(s.x-Y,s.y),B.setCoords(n.x-d[0],n.y),Y=ate()),h.push(n.clone()),x;const W=1+Math.ceil(x/r),ee=x/(W-1),ne=new N;h.push(s.clone()),ne.setCoordsPoint2D(s),V.setCoords(s.x-d[0],s.y),c!==null&&c.push(0);for(let j=1;j<W;j++){let oe;if(j<W-1){const ve=j*ee;zl.geodeticCoordinate(t,e,s.x,s.y,ve,w,$.at(0),$.at(1),i),B.setCoords($.at(0).val,$.at(1).val),d[0]=Uv(B.x,ne.x,d[0]),H.setCoords(d[0]+B.x,B.y),oe=j/(W-1)}else d[0]=Uv(n.x,Number.NaN,d[0]),B.setCoords(n.x-d[0],n.y),H.setCoordsPoint2D(n),oe=1;O?(j===1&&L&&ute(s,H,c,h),j===W-1&&D&&cte(ne,n,c,h)):U?fge(ne,H,a)&&(s.x<n.x?ne.x>H.x&&(d[0]+=2*Math.PI,H.setCoords(d[0]+B.x,B.y)):ne.x<H.x&&(d[0]-=2*Math.PI,H.setCoords(d[0]+B.x,B.y)),hte(ne,H,w,A,I,c,h)):o>0&&ate(),h.push(H.clone()),c!=null&&c.push(oe),ne.setCoordsPoint2D(H),V.setCoordsPoint2D(B),Y=d[0]}return x}catch(f){m.error=f,m.hasError=!0}finally{Hf(m)}}function OUe(t,e,i,s,n,r,o,a,l,u){z(0)}function ate(t,e,i,s,n,r,o,a,l,u,c,h,d,m,f){return z(0),0}function LUe(t,e,i,s){const n=Cr(t,e,i),r=Cr(t,e,s);return gi.distance(n,r)}function FUe(t,e,i,s,n,r,o,a){const l=new Array,u=he(Array,8);let c=2,h=n.getCoord2D(r);u[0][0]=h.x,u[0][1]=h.y,h=n.getCoord2D(o),u[1][0]=h.x,u[1][1]=h.y;const d=_=>{if(i!==null){const v=yo.projToGeog(i,_,u);z(v===_)}for(const v of u)v[0]*=s,v[1]*=s};d(2),l.push(Cr(t,e,new N(u[0][0],u[0][1]))),l.push(Cr(t,e,new N(u[1][0],u[1][1])));let m=gi.distance(l[0],l[1]);if(m>a)return m;let f=0;for(c=3;c<=17;){const _=1/(c-1);let v=0;for(let C=1;C<c;++C)if(1&C){const M=es(r,o,C*_);n.queryCoord2D(M,h),u[v][0]=h.x,u[v][1]=h.y,v++}d(v);let x=1;for(let C=0;C<v;++C)l.splice(x,0,Cr(t,e,new N(u[C][0],u[C][1]))),x++;x=0;let w=l[x];x++;let T=0;for(;x!==l.length;++x){const C=l[x];T+=gi.distance(w,C),w=C}if(T>a)return T;if(f=T-m,z(f>=0||Math.abs(f)<1e-14*T),f<0&&(f=0),m=T,T+f<=a)return T+f;c=2*c-1}return m+f}function kUe(t,e,i,s,n,r,o,a,l){const u=s.isCurve(),c=w4e(t,e)*Math.PI*179/180;let h=r;r>0&&!(r>c)||(h=c);const d=o,m=d>0;let f=Number.NaN;m&&(f=P4e(t,e,d));const _=n.getCoordinateSystemType()===1;let v=null;_||(v=n.getPECoordSys());const x=n.getTolerance(0),w=s.getStartXY(),T=s.getEndXY(),C=new N,M=new N;if(_)C.setCoordsPoint2D(w),C.scale(i),M.setCoordsPoint2D(T),M.scale(i);else{const Y=[w.x,w.y,T.x,T.y];yo.projToGeog(v,2,Y),C.setCoords(Y[0],Y[1]),C.scale(i),M.setCoords(Y[2],Y[3]),M.scale(i)}let A=0,I=0;const L=[],D=[],O=[];L.push(T.clone()),D.push(M.clone()),O.push(1),l.push(w.clone()),a!==null&&a.push(I);const U=n.isPannable(),$=w.clone(),B=[.5,.33333333333333337,.6666666666666666,.16666666666666669,.8333333333333333];let V=5;u||(m?(B[0]=.5,B[1]=.25,B[2]=.75,V=3):V=1),z(h>0);const H=Y=>{if(Y=Y.clone(),v!==null){const W=[Y.x,Y.y];yo.projToGeog(v,1,W),Y.setCoords(W[0],W[1])}return Y.scale(i),Y};for(;D.length>0;){const Y=L.at(-1).clone();M.assign(D.at(-1));const W=O.at(-1);let ee=!1,ne=Number.NaN;const j=FUe(t,e,v,i,s,I,W,h);let oe=h>=j&&Math.abs(C.y-M.y)<.9*Math.PI;_&&oe&&(oe=Math.abs(C.x-M.x)<.9*Math.PI);const ve=new N,Ye=new N;let de=!1;if(!m&&oe&&oe&&(de=!0),s.calculateSubLength(I,W)<=x&&(de=!0),!de)for(let fe=0;fe<V;fe++){const Ne=es(I,W,B[fe]),je=new N;s.queryCoord2D(Ne,je);const Ee=H(je);if(fe===0&&(ne=Ne,ve.setCoordsPoint2D(je),Ye.setCoordsPoint2D(Ee),!oe)){ee=!0;break}if(z(m),_&&Math.abs(C.x-Ee.x)>=Math.PI){ee=!0;break}let Zt=new N,qt=new N;u?(Zt=N.lerp($,Y,B[fe]),qt=H(Zt)):(Zt=je.clone(),qt=Ee.clone());const Mi=f4e(t,e,C,M,B[fe]),oi=Mi.clone();if(_?(oi.x/=i,oi.y/=i):(oi.x/=i,oi.y/=i,hj(n.getGCSToSRTransform(),[oi],1,[oi],null)),oi.isNAN()){const si=Cr(t,e,Ee),me=Cr(t,e,C),Bi=Cr(t,e,M),{first:pt,second:$e}=ZC(t,e,si,me,Bi,2,null);if($e>f){ee=!0;break}}else{if(U){const pt=n.getPannableExtent().width(),$e=es(s.getStartX(),s.getEndX(),.5);for(;oi.x<$e-.5*pt;)oi.x+=pt;for(;oi.x>=$e+.5*pt;)oi.x-=pt}const si=s.getClosestCoordinateOnInterval(oi,new Me(I,W),-1);let me=s.getCoord2D(si);me=H(me);let Bi=LUe(t,e,me,Mi);if(Bi>f){if(Bi<4*f){const pt=Cr(t,e,me),$e=Cr(t,e,C),wt=Cr(t,e,M),{first:$i,second:Mt}=ZC(t,e,pt,$e,wt,2,null);Bi=Mt}if(Bi>f){ee=!0;break}}else if(u){let pt=Cr(t,e,Ee);const $e=Cr(t,e,C),wt=Cr(t,e,M);let{second:$i}=ZC(t,e,pt,$e,wt,3,null);if($i<=f){pt=Cr(t,e,qt);const{first:Mt,second:le}=ZC(t,e,pt,$e,wt,3,null);$i=le}if($i>f){ee=!0;break}}}}ee?(L.push(ve.clone()),D.push(Ye.clone()),O.push(ne)):(L.pop(),D.pop(),O.pop(),l.push(Y.clone()),A+=j,a!==null&&a.push(A),$.setCoordsPoint2D(Y),C.setCoordsPoint2D(M),I=W)}if(a!==null){const Y=1/A;for(let W=0;W<a.length;W++)a[W]*=Y}}function xB(t,e,i,s){if(s.reverse(),i!==null&&i.reverse(),t){const n=t[0],r=e[0];t[0]=r,e[0]=n}}function pge(t,e,i,s,n){t?(s.setCoordsPoint2D(i),n.setCoordsPoint2D(e)):(s.setCoordsPoint2D(e),n.setCoordsPoint2D(i))}function lte(t,e,i){return t?(i.create(e.getGeometryType()),e.copyTo(i.get()),i.get().reverse(),i.get()):e}function Uv(t,e,i){if(Number.isNaN(e)){for(;i-t>Math.PI;)i-=2*Math.PI;for(;t-i>Math.PI;)i+=2*Math.PI;return i}return i+t-e>Math.PI?i-=2*Math.PI:e-(i+t)>Math.PI&&(i+=2*Math.PI),i}function ute(t,e,i,s){if(t.y>0){const n=new N;n.setCoords(e.x,zi),Ts(t.x,n.x)||Ts(e.y,n.y)||(s.push(n),i!==null&&i.push(0))}else{const n=new N;n.setCoords(e.x,-zi),Ts(t.x,n.x)||Ts(e.y,n.y)||(s.push(n),i!==null&&i.push(0))}}function cte(t,e,i,s){if(e.y>0){const n=new N;n.setCoords(t.x,zi),Ts(e.x,n.x)||Ts(t.y,n.y)||(s.push(n),i!==null&&i.push(1))}else{const n=new N;n.setCoords(t.x,-zi),Ts(e.x,n.x)||Ts(t.y,n.y)||(s.push(n),i!==null&&i.push(1))}}function hte(t,e,i,s,n,r,o){if(LVe(i)){if(zi-t.y>0){const a=new N;a.setCoords(t.x,zi),o.push(a),r!==null&&r.push(s)}if(zi-e.y>0){const a=new N;a.setCoords(e.x,zi),o.push(a),r!==null&&r.push(s)}}else{if(zi+t.y>0){const a=new N;a.setCoords(t.x,-zi),o.push(a),r!==null&&r.push(n)}if(zi+e.y>0){const a=new N;a.setCoords(e.x,-zi),o.push(a),r!==null&&r.push(n)}}}function $Ue(t,e,i){return!(!fge(t,e,i)||Ts(t.y,zi)||Ts(t.y,-zi)||Ts(e.y,zi)||Ts(e.y,-zi))}function fge(t,e,i){return Math.abs(Math.abs(t.x-e.x)-Math.PI)<=i}function UUe(t){if(t.x<-Math.PI)for(;t.x<-Math.PI;)t.x+=2*Math.PI;else if(t.x>Math.PI)for(;t.x>Math.PI;)t.x-=2*Math.PI}function VUe(t,e,i,s){const n={stack:[],error:void 0,hasError:!1};try{const r=[i.x],o=[i.y-s],a=[i.x],l=[i.y+s];_ee(r,o),_ee(a,l);const u=Da(n,new Lo,!1),c=Da(n,new Lo,!1);return zl.greatEllipticDistance(t,e,i.x,i.y,r[0],o[0],u,null,null),zl.greatEllipticDistance(t,e,i.x,i.y,a[0],l[0],c,null,null),Math.min(u.val,c.val)}catch(r){n.error=r,n.hasError=!0}finally{Hf(n)}}function gge(t,e,i,s,n){const r=new J;i.queryEnvelope(r);const o=Fl(null,i,!0).total();if(e.xmin-r.xmin<=o&&r.xmax-e.xmax<=o)return i;const a=e.width();let l=0;for(;e.xmin+l*a<r.xmin;)l++;for(;e.xmin+l*a>r.xmin;)l--;const u=l*a,c=new Gi;c.setShiftCoords(-u,0);const h=i;h.applyTransformation(c);const d=new J;h.queryEnvelope(d);let m=null;if(d.xmax>e.xmax){let f=0;const _=new J;_.setCoords({env2D:e}),_.ymin-=1,_.ymax+=1;let v=h;for(;_.xmin<d.xmax;){d.xmax>_.xmax&&(v=Sge(v,t,2,!0,_.xmax));const x=L7(v,_),w=yr(null,x,!0).total(),T=Is(v,_,w,Number.NaN,n);m===null?m=T===v?T.clone():T:(c.setShiftCoords(-f*a,0),T.applyTransformation(c),m.add(T,!1)),f++,_.xmin=_.xmax,_.xmax=e.xmax+f*a}}else m=h;return m}class _ge{constructor(e,i){this.m_basisX=new gi,this.m_basisY=new gi,this.m_normal=new gi,z(e.getCoordinateSystemType()===1),this.m_gcs=e;const s=H1();e.querySpheroidData(s),this.m_a=s.majorSemiAxis,this.m_e2=s.e2,this.m_rpu=e.getUnit().getUnitToBaseFactor(),this.m_curvCenterRad=i.mul(this.m_rpu);const n=this.m_curvCenterRad.x,r=this.m_curvCenterRad.y,o=Math.cos(n),a=Math.sin(n),l=Math.cos(r),u=Math.sin(r);this.m_cartCenter3D=p4e(this.m_a,this.m_e2,o,a,l,u),this.m_normal.setCoordsPoint3D(this.m_cartCenter3D),this.m_d=this.m_cartCenter3D.length(),this.m_normal.divThis(this.m_d),gi.selectRightHandedBasisFromNormal(this.m_normal,this.m_basisX,this.m_basisY),this.m_northPolePcs=this.projectPoint(N.construct(0,.5*Math.PI/this.m_rpu)),this.m_southPolePcs=this.projectPoint(N.construct(0,.5*-Math.PI/this.m_rpu))}project(e){const i=e.getGeometryType();if(ll(i)){NP(e);const s=e;return this.projectMultiVertex(s)}ce("Gnomonic.project")}unproject(e,i,s){const n=e.getGeometryType();if(ll(n)){NP(e);let r=e;const o=[];if(n===q.enumPolygon){const a=r.getPathCount();for(let l=0;l<a;l++){const u=r.calculateRingArea2D(l);o.push(u)}}return this.unprojectMultiVertex(i,r),Ei(n)?(WUe(this.m_gcs,0,r),zUe(o,this.m_gcs,0,r,s)):r=vS(r,this.m_gcs,0,!0,0,s),r}ce("Gnomonic.unproject")}projectPoint(e){const i=e.mul(this.m_rpu),s=Cr(this.m_a,this.m_e2,i),n=this.m_normal.dotProduct(s);if(n<=0)return N.construct(Number.NaN,Number.NaN);const r=this.m_d/n,o=s.mul(r).sub(this.m_cartCenter3D),a=new N;return a.x=this.m_basisX.dotProduct(o),a.y=this.m_basisY.dotProduct(o),a}unprojectPoint(e){const i=this.m_cartCenter3D.add(this.m_basisX.mul(e.x).add(this.m_basisY.mul(e.y)));return yS(this.m_a,this.m_e2,i).divide(this.m_rpu)}projectMultiVertex(e){const i=e.getImpl();let s=!0;const n=new N,r=new N;for(let o=0,a=i.getPointCount();o<a;o++)i.queryXY(o,n),n.y*this.m_rpu>.5*Math.PI?r.assign(this.m_northPolePcs):n.y*this.m_rpu<.5*-Math.PI?r.assign(this.m_southPolePcs):r.assign(this.projectPoint(n)),i.setXY(o,r),r.isNAN()&&(s=!1);return i.notifyModifiedFlags(2001),s}unprojectMultiVertex(e,i){const s=i.getImpl(),n=e*e,r=!this.m_northPolePcs.isNAN(),o=!this.m_southPolePcs.isNAN();for(let a=0,l=s.getPointCount();a<l;a++){const u=s.getXY(a);let c=new N;r&&N.sqrDistance(u,this.m_northPolePcs)<=n?(c.setCoords(this.m_curvCenterRad.x,.5*Math.PI),c.scale(1/this.m_rpu)):o&&N.sqrDistance(u,this.m_southPolePcs)<=n?(c.setCoords(this.m_curvCenterRad.x,.5*-Math.PI),c.scale(1/this.m_rpu)):c=this.unprojectPoint(u),s.setXY(a,c)}s.notifyModifiedFlags(2001)}}function zUe(t,e,i,s,n){const r=s.getGeometryType(),o=e.getPannableExtent();let a=s,l=!1,u=!1;if(r===q.enumPolygon){const c=new J,h=N.construct(i,0);c.setCoords({env2D:o}),c.centerAt(h),l=GUe(t,e,c,a,n);const d=XUe(e,c,a,n);d!==a&&(u=!0),a=d}else a=new Cd().foldInto360RangeGeodetic(a,e,2);r===q.enumPolygon&&(l||u)&&(a=new Am().execute(a,e,!1,n)),a!==s&&(s.setEmpty(),s.add(a,!1))}function GUe(t,e,i,s,n){const r=BUe(i,s),o=qUe(t,e,i,s,n);return r||o}function BUe(t,e){const i=new J;e.queryEnvelope(i);const s=Ts(t.ymax,i.ymax),n=Ts(t.ymin,i.ymin),r=s||n;return!!r&&(HUe(t,e),r)}function qUe(t,e,i,s,n){const r=[],o=[],a=.5*i.width();for(let h=0;h<s.getPathCount();h++){const d=s.getXY(s.getPathStart(h)),m=s.getXY(s.getPathEnd(h)-1),f=t[h]<0;if(Math.abs(d.x-m.x)>a){const _=jUe(f,e,i,h,s,n);r.push(_),o.push(h)}else if(!f&&s.calculateRingArea2D(h)<0){const _=YUe(e,i,h,s,n);r.push(_),o.push(h)}}if(r.length===0)return!1;const l=new Ci({vd:s.getDescription()});let u=0,c=o[u];for(let h=0;h<s.getPathCount();h++)h===c?(l.add(r[u],!1),u++,u<o.length&&(c=o[u])):l.addPath(s,h,!0);return s.setEmpty(),s.add(l,!1),!0}function HUe(t,e){const i=new Ci,s=new J;for(let n=0;n<e.getPathCount();n++){e.queryPathEnvelope(n,s);let r=Ts(t.ymax,s.ymax),o=Ts(t.ymin,s.ymin);if(!(r||o)){i.addPath(e,n,!0);continue}i.insertPath2D(-1,null,0,0,!0);const a=e.getPathStart(n),l=e.getPathEnd(n),u=l-a;let c=-1;for(c=a;c<l;c++){const f=e.getXY(c);if(r=Ts(t.ymax,f.y),o=Ts(t.ymin,f.y),!r&&!o)break}let h=c,d=!1,m=Number.NaN;do{const f=e.getXY(h);r=Ts(t.ymax,f.y),o=Ts(t.ymin,f.y);const _=a+(h+1-a)%u;if(r||o){let v=N.construct(m,f.y);i.insertPoint2D(n,-1,v);const x=e.getXY(_),w=Ts(t.ymax,x.y),T=Ts(t.ymin,x.y);w||T||(v=N.construct(x.x,f.y),d?i.setXY(i.getPointCount()-1,v):i.insertPoint2D(n,-1,v)),d=!0}else i.insertPoint2D(n,-1,f),m=f.x,d=!1;h=_}while(h!==c)}e.setEmpty(),e.add(i,!1)}function jUe(t,e,i,s,n,r){const o=new Ci,a=new Ci,l=new Gi,u=n.getXY(n.getPathStart(s)),c=n.getXY(n.getPathEnd(s)-1),h=i.width(),d=.5*h,m=new J;n.queryEnvelope(m);const f=Math.ceil(m.width()/h)+1;let _,v;u.x>c.x?(_=-h,v=t?i.ymin:i.ymax):(_=h,v=t?i.ymax:i.ymin),l.setShiftCoords(_,0),o.addPath(n,s,!0),a.add(o,!1);const x=new Jt;for(let V=0;V<f;V++)a.applyTransformation(l),a.getPointByVal(0,x),o.lineToPoint(x),o.addSegmentsFromPath(a,0,0,a.getSegmentCount()-1,!1);const w=o.getXY(0),T=o.getXY(o.getPointCount()-1);w.y=v,T.y=v,o.lineTo(T);const C=new N;for(C.setCoordsPoint2D(T),C.x-=.5*_;Math.abs(C.x-w.x)>d;)o.lineTo(C),C.x-=.5*_;o.lineTo(w);const M=i.getCenter().x,A=new J;o.queryEnvelope(A);let I=0;const L=A.getCenter().x;L-M>d?I=-Math.ceil((L-M-d)/h):M-L>d&&(I=Math.ceil((M-L-d)/h)),I!==0&&(l.setShiftCoords(I*h,0),o.applyTransformation(l));const D=new wn,O=D.addGeometry(o);xS(D,O,e,0,2,!0,i.xmin),xS(D,O,e,0,2,!0,i.xmax);const U=D.getGeometry(O),$=L7(U,i);$.inflateCoords(0,1);const B=yr(null,$,!0);return Is(U,i,B.total(),Number.NaN,r)}function YUe(t,e,i,s,n){const r=e.width(),o=.5*r,a=e.getCenter().x,l=new J;s.queryPathEnvelope(i,l);let u,c=0,h=l.getCenter().x;if(h-a>o?c=-Math.ceil((h-a-o)/r):a-h>o&&(c=Math.ceil((a-h-o)/r)),c!==0){const _=new Gi;_.setShiftCoords(c*r,0),s.getImpl().applyTransformationToPath(_,i),s.queryPathEnvelope(i,l),h=l.getCenter().x}const d=new J;e.containsExclusiveEnvelope(l)?(u=!1,d.setCoords({env2D:e})):(u=!0,d.setCoords({env2D:e}),d.xmin-=r,d.xmax+=r);let m=s.createInstance();m.addPathPoint2D(null,0,!0);const f=new N;if(f.setCoords(d.xmin,d.ymin),m.insertPoint2D(0,-1,f),f.setCoords(d.xmin,d.ymax),m.insertPoint2D(0,-1,f),f.setCoords(.5*(d.xmin+d.xmax),d.ymax),m.insertPoint2D(0,-1,f),f.setCoords(d.xmax,d.ymax),m.insertPoint2D(0,-1,f),f.setCoords(d.xmax,d.ymin),m.insertPoint2D(0,-1,f),f.setCoords(.5*(d.xmin+d.xmax),d.ymin),m.insertPoint2D(0,-1,f),u){m.addPath(s,i,!0);const _=new Gi;h<a?_.setShiftCoords(r,0):_.setShiftCoords(-r,0),s.getImpl().applyTransformationToPath(_,i),m.addPath(s,i,!0);const v=new wn,x=v.addGeometry(m);xS(v,x,t,0,2,!0,e.xmin),xS(v,x,t,0,2,!0,e.xmax),m=v.getGeometry(x);const w=L7(m,e);w.inflateCoords(0,1);const T=yr(null,w,!0).total();m=Is(m,e,T,Number.NaN,n)}else m.addPath(s,i,!0);return m}function XUe(t,e,i,s){const n=new J;i.queryEnvelope(n);const r=Fl(null,i,!0).total();if(e.xmin-n.xmin<=r&&n.xmax-e.xmax<=r)return i;const o=i.createInstance();let a=i.createInstance();const l=new J,u=i.getPathCount();for(let c=0;c<u;c++)i.queryPathEnvelope(c,l),e.xmin-l.xmin<=r&&l.xmax-e.xmax<=r?o.addPath(i,c,!0):(a.setEmpty(),a.addPath(i,c,!0),a=gge(t,e,a,!0,s),o.add(a,!0));return o}function WUe(t,e,i){const s=t.getPannableExtent(),n=N.construct(e,0);s.centerAt(n);const r=s.width(),o=.5*r,a=new N;a.setNAN();let l=Number.NaN;for(let u=0;u<i.getPathCount();u++)for(let c=i.getPathStart(u);c<i.getPathEnd(u);c++){const h=i.getXY(c),d=Ts(h.y,s.ymax)||Ts(s.ymin,h.y);c===i.getPathStart(u)?(a.setNAN(),l=0):a.isNAN()||d||(l=ZUe(h.x,a.x,o,r,l)),h.x+=l,i.setXY(c,h),d||a.setCoordsPoint2D(h)}i.getImpl().notifyModifiedFlags(2001)}function ZUe(t,e,i,s,n){return n+t-e>i?n-=s:e-(n+t)>i&&(n+=s),n}function dte(t,e,i,s,n,r){const o=e.getAttributeStreamRef(0),a=e.getPointCount();let l=!1;const u=new N;for(let C=0;C<a;++C){if(o.queryPoint2D(2*C,u),1&r&&u.y>=i){l=!0;break}if(2&r&&u.y<=-i){l=!0;break}}if(!l)return!1;let c=!1;t&&(c=e.getImpl().isClosedPathInXYPlane(0));const h=new wn,d=h.addGeometry(e),m=h.getFirstPath(d);let f=-1,_=!0;const v=new N,x=new Jt;let w=G;const T=yge*n/360;for(let C=h.getFirstVertex(m);C!==G;C=h.getNextVertex(C)){h.queryXY(C,u);let M=1&r&&u.y>=i?1:0;if(M|=2&r&&u.y<=-i?2:0,f>0&&f!==M){if(v.x!==u.x){const A=h.getPrevVertex(C);h.queryPoint(A,x);const I=h.insertVertex(m,C,x);v.x=u.x,h.setXY(I,v)}if(c){let A=w!==G?h.getNextVertex(w):h.getFirstVertex(m);const I=h.getPrevVertex(C);for(;A!==I;)A=h.removeVertex(A,!1);if(w!==G){const L=h.getXY(w),D=h.getXY(I);if(Math.abs(L.x-D.x)>T){h.queryPoint(w,x);const O=h.insertVertex(m,I,x);L.x=es(L.x,D.x,.5),h.setXY(O,L)}}}w=G}if(M&&(u.y=kf(s,u.y),h.setXY(C,u),!_&&f!==M))if(u.x!==v.x){h.queryPoint(C,x);const A=h.insertVertex(m,C,x);h.setXYCoords(A,v.x,u.y),w=A}else w=C;f=M,v.assign(u),_=!1}if(c){if(w!==G){let L=h.getNextVertex(w);for(;L!==G;)L=h.removeVertex(L,!1)}const C=h.getFirstVertex(m);let M=h.getLastVertex(m);const A=h.getXY(C),I=h.getXY(M);if(!A.equals(I)&&(h.queryPoint(C,x),M=h.insertVertex(m,G,x),Math.abs(A.x-I.x)>T)){const L=h.insertVertex(m,M,x);A.x=es(A.x,I.x,.5),h.setXY(L,A)}}return e.assignCopy(h.getGeometry(d)),!0}function KUe(t,e){let i=new Ci({vd:t});i.addEnvelope(e,!1);const s=e.width()/180;return i=new Tv().execute(i,s,0,0,null),i}function QUe(t,e){const i=t.getPannableExtent();return Number.isNaN(e)||i.centerAtCoords(e,0),i}function JUe(t,e,i){const s=H1();e.querySpheroidData(s);const n=e.getGCS()!==e?e.getSRToGCSTransform():null,r=he(N,100),o=new gi(0,0,0),a=t.getPointCount(),l=e.getGCS().getUnit().getUnitToBaseFactor();for(let d=0,m=a;d<m;){const f=Math.min(100,m-d);t.queryCoordinates(r,f,d,d+f),n&&new Cd().transform(n,r,f,r,!1);for(let _=0;_<f;_++){if(r[_].isNAN())continue;r[_].scale(l);const v=Cr(s.majorSemiAxis,s.e2,r[_]);o.addThis(v)}d+=f}const u=yS(s.majorSemiAxis,s.e2,o);u.scale(1/l);const c=t;if(!new _ge(e.getGCS(),u).project(c))return 0;i.length=t.getPathCount();const h=c.calculateArea2D()<0;for(let d=0,m=t.getPathCount();d<m;d++){const f=c.calculateRingArea2D(d),_=h?f<0:f>0;i[d]=_}return h?-1:1}function e5e(t,e,i,s,n){if(!e.isPannable()||t.isEmpty())return t;const r=t.getGeometryType();r===q.enumGeometryCollection&&_i("not yet impl for geometry collection");const o=e.getPannableExtent();Number.isNaN(i)&&(i=o.getCenterX());const a=o.width(),l=.5*a,u=n>0,c=t.queryInterval(0,0);if(!u&&c.width()<l||!ll(t.getGeometryType())){const h=c.getCenter();if(Math.abs(h-i)<=l)return t;{const d=new Gi,m=g1((i-h)/a)*a;d.setShiftCoords(m,0);const f=t.clone();return f.applyTransformation(d),f}}if(r===q.enumPolygon){let h=new Qi({vd:t.getDescription()});h.addAndExplicitlyOpenAllPaths(t,!1),u&&(h=yB(h,e,2,n,Number.NaN,null,!0));const d=[];if(!s){{let m=t;u&&(m=new Ci,m.add(h,!1));const f=JUe(t,e,d);if(f)f<0&&h.reverseAllPaths();else{const _=m.getPathCount();for(let v=0;v<_;v++)d.push(m.calculateRingArea2D(v)>0)}}s=d}return new bL(null,s,h,null,e,i,3,0,null).geoNormalizePolygonGeometry(!0)}if(r===q.enumPolyline){let h=new Qi({vd:t.getDescription()});return h.addAndExplicitlyOpenAllPaths(t,!1),u&&(h=yB(h,e,2,n,Number.NaN,null,!0)),new bL(null,null,h,null,e,i,3,0,null).geoNormalizePolylineGeometry(!0)}if(r===q.enumMultiPoint){const h=t,d=h.getAttributeStreamRef(0);let m,f=null,_=i,v=0;const x=.1*a;for(let w=0,T=h.getPointCount();w<T;w++){const C=d.read(2*w);let M=C-_;if(Math.abs(M)>l&&(M=g1(M/a)*a,v-=M,Math.abs(v)<x&&(v=0)),v!==0){f||(m=t.clone(),f=m.getAttributeStreamRef(0));const A=C+v;f.write(2*w,A)}_=C}return f?(m.notifyModified(),m):t}We("")}const yge=210;class bL{constructor(e,i,s,n,r,o,a,l,u){this.m_bAdjustedAtPoles=0,this.m_inputPoly=s,this.m_progressTracker=u,this.m_originalGeometry=e,this.m_originalSR=n,this.m_polygonRingFlags=i,this.m_pannableSR=r,this.m_poleSnappingTolerance=l,this.m_poleFlags=a,this.m_bAdjustedAtPoles=0,this.m_pannableExtent=QUe(this.m_pannableSR,o),this.m_centralLongitude=Number.isNaN(o)?this.m_pannableExtent.getCenterX():o,this.m_width360=this.m_pannableExtent.width(),this.m_degree=this.m_width360/360,this.m_GCSLargeDelta=yge*this.m_degree,z(this.m_originalGeometry===null&&this.m_originalSR===null||this.m_originalGeometry!==null&&this.m_originalSR!==null)}geonormalizeRing(e,i,s,n,r,o,a){let l=s;const u=new Qi({vd:this.m_inputPoly.getDescription()});u.addPath(this.m_inputPoly,e,!0),this.m_poleFlags!==0&&(this.m_bAdjustedAtPoles|=dte(!0,u,this.m_pannableExtent.ymax-this.m_poleSnappingTolerance,this.m_pannableExtent.ymax,this.m_pannableExtent.width(),this.m_poleFlags)?1:0,this.m_bAdjustedAtPoles&&(l=!1));let c=-1;l&&(c=this.m_originalGeometry.getPathStart(e));const h=u.getAttributeStreamRef(0),d=u.getPointCount();let m=0,f=h.read(0),_=0;const v=3*this.m_pannableSR.getTolerance(0);let x=!1;const w=new N,T=new N;let C=!1;const M=u.hasNonLinearSegments(),A=new N;for(let D=1;D<d;++D){h.queryPoint2D(2*D,A);const O=A.x;let U=O+m;const $=U-f;if(A.x=U,Math.abs($)>this.m_GCSLargeDelta){if(l){const B=c+D-1,V=c+(D+1<d?D:0),H=o.read(2*B),Y=(o.read(2*V)-H)*n;Math.abs($-Y)>1*this.m_degree&&(l=!1)}l||(m-=kf(this.m_width360,U-f),U=O+m,++_,C=m!==0,A.x=U)}else x||K3e(w,T,A,v)&&(x=!0);C&&(M&&We("error in geonormalize_ring_ for curves"),h.write(2*D,U)),f=U,w.setCoordsPoint2D(T),T.setCoordsPoint2D(A)}_&&u.notifyModified();const I=u.getXY(0),L=u.getXY(d-1);if(N.distance(I,L)<v){const D=this.finalizeGeoNormalizeClosedRing(u,x,r);a.add(D,!1)}else{i<0&&(this.m_originalGeometry!==null?(z(this.m_originalGeometry!==null),i=this.m_originalGeometry.calculateRingArea2D(e)>0?1:0):i=1);const D=this.finalizeGeoNormalizeOpenedRing(i>0,u);a.add(D,!1)}}geoNormalizePolygonGeometry(e){z(this.m_originalSR&&this.m_originalGeometry||!this.m_originalGeometry&&!this.m_originalSR),z(this.m_pannableSR.isPannable());let i=null,s=Number.NaN;const n=!!this.m_originalSR&&this.m_originalSR.isPannable();n&&(i=this.m_originalGeometry.getAttributeStreamRef(0),s=this.m_width360/this.m_originalSR.getPannableExtent().width()),this.m_bAdjustedAtPoles=0;const r=new Ci({vd:this.m_inputPoly.getDescription()});for(let f=0,_=this.m_inputPoly.getPathCount();f<_;++f){const v=this.m_polygonRingFlags?this.m_polygonRingFlags[f]?1:0:-1;this.geonormalizeRing(f,v,n,s,e,i,r)}const o=this.m_pannableSR.getTolerance(0),a=this.m_pannableExtent.width()/180;CL(r,this.m_pannableExtent,.1*o,!1);const l=J.constructEmpty();if(l.setCoords({env2D:this.m_pannableExtent}),e){let f=!0;for(let _=0;_<2;_++){f=!0;const v=J.constructEmpty();for(let x=0,w=r.getPathCount();x<w;x++)if(r.queryPathEnvelope(x,v),!(l.xmin<=v.xmin&&l.xmax>=v.xmax||v.xmin>=l.xmax||v.xmax<=l.xmin)){f=!1;break}if(f)break;l.move(.5*this.m_width360,0)}f||l.setCoords({env2D:this.m_pannableExtent})}let u=Is(r,l,o,a,this.m_progressTracker),c=r!==u;const h=this.m_originalGeometry?this.m_originalGeometry.calculateArea2D():1,d=u.calculateArea2D();let m=0;if(d>0&&h<0)m=1;else if(d<=0&&h>0)if(d===0){if(this.m_originalSR){let f=Number.NaN;this.m_originalSR.getCoordinateSystemType()===2?f=this.m_originalSR.getPCSHorizon().calculateArea2D():this.m_originalSR.getCoordinateSystemType()===1&&(f=this.m_originalSR.getPannableExtent().getArea()),h>.99*f&&(m=-1)}}else m=-1;if(m!==0){const f=KUe(u.getDescription(),l);f.add(u,!1),c=!0,u=f}return c&&(u=new Am().execute(u,this.m_pannableSR,!1,this.m_progressTracker)),u}geoNormalizePolylineGeometry(e){z(this.m_pannableSR.isPannable());let i=null;const s=this.m_originalSR&&this.m_originalSR.isPannable();let n=1;s&&(z(this.m_originalGeometry),n=this.m_width360/this.m_originalSR.getPannableExtent().width(),i=this.m_originalGeometry.getAttributeStreamRef(0));const r=this.m_pannableExtent.width(),o=r*cn()*4;let a=e,l=Number.NaN;const u=Me.constructEmpty();this.m_bAdjustedAtPoles=0;let c=new Qi({vd:this.m_inputPoly.getDescription()});for(let m=0,f=this.m_inputPoly.getPathCount();m<f;++m){let _=s;const v=new Qi({vd:this.m_inputPoly.getDescription()});v.addPath(this.m_inputPoly,m,!0);const x=this.m_inputPoly.isClosedPath(m);this.m_poleFlags!==0&&(this.m_bAdjustedAtPoles|=dte(x,v,this.m_pannableExtent.ymax-this.m_poleSnappingTolerance,this.m_pannableExtent.ymax,r,this.m_poleFlags)?1:0,this.m_bAdjustedAtPoles&&(_=!1));let w=-1;const T=v.getPointCount();let C=!1;_&&(w=this.m_originalGeometry.getPathStart(m),C=this.m_originalGeometry.isClosedPath(m));const M=v.getAttributeStreamRef(0);let A=0,I=M.read(0),L=0;const D=new N,O=new N;let U=!1;const $=v.hasNonLinearSegments(),B=new N;for(let V=1;V<T;++V){M.queryPoint2D(2*V,B);const H=B.x;let Y=H+A;const W=Y-I;if(B.x=Y,Math.abs(W)>this.m_GCSLargeDelta){if(_){const ee=w+V-1;let ne=w;(!C||V+1<T)&&(ne+=V);const j=i.read(2*ee),oe=(i.read(2*ne)-j)*n;Math.abs(W-oe)>1*this.m_degree&&(_=!1)}_||(A-=kf(this.m_width360,Y-I),Y=H+A,++L,U=A!==0,B.x=Y)}U&&($&&We("error in geonormalize_ring_ for curves"),M.write(2*V,Y)),I=Y,D.setCoordsPoint2D(O),O.setCoordsPoint2D(B)}if(L&&v.notifyModified(),a){let V=!1;if(!v.isEmpty()){const H=J.constructEmpty();if(v.queryEnvelope(H),H.width()>=r||H.ymin<=this.m_pannableExtent.ymin||H.ymax>=this.m_pannableExtent.ymax)V=!0;else{if(Number.isNaN(l)){const W=this.m_centralLongitude-.5*r;l=H.xmin,l+=Math.round((W-H.xmin)/r)*r,l>W&&(l-=r),z(l<=W),l<W&&(l+=r),z(l>=W)}let Y=Math.round((l-H.xmin)/r)*r;if(H.xmin+Y>l+o&&(Y-=r),H.xmin+Y<l-o&&(Y+=r),u.mergeCoordinate(H.xmin+Y),u.mergeCoordinate(H.xmax+Y),V=u.width()>=r,!V){const W=new Gi;W.setShiftCoords(Y,0),v.applyTransformation(W)}}}c.add(v,!1),V&&(c=(()=>{const H=new Qi({vd:c.getDescription()});for(let Y=0,W=c.getPathCount();Y<W;++Y){const ee=new Qi({vd:c.getDescription()});ee.addPath(c,Y,!0);const ne=vS(ee,this.m_pannableSR,this.m_centralLongitude,!0,0,this.m_progressTracker);H.add(ne,!1)}return H})(),a=!1)}else{const V=vS(v,this.m_pannableSR,this.m_centralLongitude,!0,0,this.m_progressTracker);c.add(V,!1)}}if(a)return c;const h=this.m_pannableSR.getTolerance(0),d=this.m_pannableExtent.width()/180;return CL(c,this.m_pannableExtent,.1*h,!1),Is(c,this.m_pannableExtent,h,d,this.m_progressTracker)}finalizeGeoNormalizeOpenedRing(e,i){const s=i.getPointCount(),n=i.getXY(0),r=i.getXY(s-1);{const D=Math.abs(r.x-n.x),O=Math.round(D/this.m_width360)*this.m_width360;z(Math.abs(D-O)<this.m_pannableSR.getTolerance(0))}const o=In(r.x-n.x),a=J.constructEmpty();i.queryLooseEnvelope(a);const l=this.m_pannableExtent.getCenterX();let u=0,c=l-this.m_width360,h=l+this.m_width360;if(o>=0){let D=Math.ceil((c-a.xmin)/this.m_width360);for(D*=this.m_width360;c>a.xmin+D;)D+=this.m_width360;for(;c<a.xmax+D;)D-=this.m_width360;for(u=D,a.width()>720&&(h=c+360*Math.ceil(a.width()/360));h<a.xmax;)h+=this.m_width360}else{let D=Math.ceil((h-a.xmax)/this.m_width360);for(D*=this.m_width360;h<a.xmax+D;)D-=this.m_width360;for(;h>a.xmin+D;)D+=this.m_width360;for(u=D,a.width()>720&&(c=h-360*Math.ceil(a.width()/360));c>a.xmin;)c-=this.m_width360}const d=Math.round(Math.abs(r.x-n.x)/this.m_width360)*this.m_width360,m=o*d,f=a.clone();f.move(u,0);const _=new N(0,0),v=new Gi;v.setShiftCoords(u,0),i.applyTransformation(v);const x=new Qi({vd:i.getDescription()});x.add(i,!1),_.assign(i.getXY(s-1));let w=0,T=x.getXY(0).x;for(;o>0?f.xmax<h:f.xmin>c;)f.move(m,0),v.xd=m,i.applyTransformation(v),T+=m,this.m_pannableExtent.xmin<=T&&this.m_pannableExtent.xmax>=T&&(w=x.getPointCount()-1),i.setXY(0,_),_.assign(i.getXY(s-1)),x.addSegmentsFromPath(i,0,0,s-1,!1);const C=new Ci({vd:x.getDescription()});C.add(x,!1);const M=x.getXY(0),A=x.getXY(x.getPointCount()-1),I=o<0?e:!e,L=C.getPointCount()-1;if(I){const D=new N(A.x,this.m_pannableExtent.ymax);C.lineTo(D);const O=new N(this.m_pannableExtent.getCenterX(),this.m_pannableExtent.ymax);C.lineTo(O);const U=new N(M.x,this.m_pannableExtent.ymax);C.lineTo(U)}else{const D=new N(A.x,this.m_pannableExtent.ymin);C.lineTo(D);const O=new N(this.m_pannableExtent.getCenterX(),this.m_pannableExtent.ymin);C.lineTo(O);const U=new N(M.x,this.m_pannableExtent.ymin);C.lineTo(U)}if(C.interpolateAttributesPath(0,L,0),C.getImpl().changeRingStartPoint(w),d>this.m_width360){const D=new Ci({copy:C});v.setShiftCoords(this.m_width360,0),D.applyTransformation(v),C.add(D,!1)}return C}finalizeGeoNormalizeClosedRing(e,i,s){const n=new Ci({vd:e.getDescription()});n.add(e,!1);const r=()=>{const c=n.getPointCount()-2;return n.getSegmentType(c)!==q.enumLine};if(n.hasNonLinearSegments()&&r()){const c=new ii,h=n.getPointCount()-2;n.getSegmentBuffer(h,c,!1),n.removePointFromPath(0,h+1),n.closeLastPathWithSegment(c.get())}else n.removePointFromPath(0,n.getPointCount()-1);const o=J.constructEmpty();n.queryLooseEnvelope(o);let a=Math.ceil((this.m_pannableExtent.xmin-o.xmin)/this.m_width360);for(a*=this.m_width360;this.m_pannableExtent.xmin>o.xmin+a;)a+=this.m_width360;for(;this.m_pannableExtent.xmin<o.xmax+a;)a-=this.m_width360;if(a+=this.m_width360,a!==0){o.move(a,0);const c=new Gi;c.setShiftCoords(a,0),n.applyTransformation(c)}if(this.m_pannableExtent.xmin<=o.xmin&&this.m_pannableExtent.xmax>=o.xmax){if(i){const h=n.calculateArea2D(),d=new Am().execute(n,this.m_pannableSR,!0,this.m_progressTracker);if(d!==n){const m=d.calculateArea2D();In(h)!==In(m)&&d.reverseAllPaths(),n.assignMove(d)}}let c;if(c=new Ci(s?{copy:n}:{move:n}),s)for(;o.xmin<this.m_pannableExtent.xmax;){o.move(this.m_width360,0);const h=new Gi;h.setShiftCoords(this.m_width360,0),n.applyTransformation(h),c.add(n,!1)}return c}let l=new Ci({vd:e.getDescription()});l.add(n,!1);const u=i||o.width()>this.m_width360-10*this.m_pannableSR.getTolerance(0);for(;o.xmin<this.m_pannableExtent.xmax;){o.move(this.m_width360,0);const c=new Gi;c.setShiftCoords(this.m_width360,0),n.applyTransformation(c),l.add(n,!1)}if(u){const c=l.calculateArea2D();l.setFillRule(1),l=new Am().execute(l,this.m_pannableSR,!0,this.m_progressTracker);const h=l.calculateArea2D();In(c)!==In(h)&&l.reverseAllPaths()}return l}geonormalize_ring_(e,i,s,n,r,o,a){z(0)}}function mte(t){z(0);const e=gVe(t),i=new i5e;return i.setVertProj_(e),i}function t5e(t,e=!0){return z(0),{}}function bB(t){return TVe()}class i5e{constructor(){this.m_hashCode=0,this.m_peVertSysVal=null,this.m_verticalUnit=new $f,this.m_verticalShift=0,this.m_userVerticalWKID=0,this.m_bIsDepth=!1}getType(){return z(0),0}getID(){return z(0),0}getLatestID(){return this.m_peVertSysVal?this.m_peVertSysVal.getLatestID():0}getOldID(){return this.m_peVertSysVal?this.m_peVertSysVal.getOldID():0}getText(){return z(0),""}getTextExtended(e){return z(0),""}getText2(e){return z(0),""}getUnit(){return z(0),{}}equals(e){return z(0),!1}equalForProjection(e){return z(0),!1}getPeVertcsCopy(){return z(0),{}}getOneMeter(){return 1/this.m_verticalUnit.getUnitToBaseFactor()}getUnitToBaseFactor(){return z(0),0}isDepth(){return z(0),!1}getVerticalShift(){return z(0),0}isCustomWkid(){return!!this.m_peVertSysVal&&this.m_peVertSysVal.isCustomWkid()}getHashCode(){return this.m_hashCode}setVertProj_(e){this.m_peVertSysVal=e}getPEVerticalCoordSys(){return this.m_peVertSysVal?this.m_peVertSysVal.m_peVertcs:null}}function p4(t,e,i,s,n){if(t.equals(e))return!1;if(s){let a=1,l=0,u=1,c=1,h=0,d=1;Number.isNaN(t.m_heightMetersPerUnit)||(a=t.m_heightMetersPerUnit,l=t.m_heightZ0,u=t.m_heightSign,c=e.m_heightMetersPerUnit,h=e.m_heightZ0,d=e.m_heightSign);const m=u*d*a/c;for(let f=0;f<n;f++)s[f]=(s[f]-l)*m+h}let r=1,o=0;if(Number.isNaN(t.m_XYToRadians)||(r=t.m_XYToRadians/e.m_XYToRadians,o=t.m_PrimeMeridianDegrees-e.m_PrimeMeridianDegrees,o!==0&&(o=ofe(o),o/=e.m_XYToRadians)),Array.isArray(i)){const a=i;for(let l=0;l<n;l++)a[l][0]=a[l][0]*r+o,a[l][1]=a[l][1]*r}else{const a=i;for(let l=0;l<n;l++){const u=l<<1;a[u]=a[u]*r+o,a[u+1]=a[u+1]*r}}return!0}function Td(){return{m_heightMetersPerUnit:0,m_heightSign:0,m_heightZ0:0,m_XYToRadians:0,m_PrimeMeridianDegrees:0,assign(t){this.m_heightMetersPerUnit=t.m_heightMetersPerUnit,this.m_heightSign=t.m_heightSign,this.m_heightZ0=t.m_heightZ0,this.m_XYToRadians=t.m_XYToRadians,this.m_PrimeMeridianDegrees=t.m_PrimeMeridianDegrees},equals(t){return Ma(this.m_heightSign,t.m_heightSign)&&Ma(this.m_heightMetersPerUnit,t.m_heightMetersPerUnit)&&Ma(this.m_heightZ0,t.m_heightZ0)&&Ma(this.m_XYToRadians,t.m_XYToRadians)&&Ma(this.m_PrimeMeridianDegrees,t.m_PrimeMeridianDegrees)},initFromGcsAndVcsPe(t,e){this.m_heightSign=1,this.m_heightMetersPerUnit=Number.NaN,this.m_heightZ0=0,this.m_XYToRadians=Number.NaN,this.m_PrimeMeridianDegrees=Number.NaN,e&&z(0),t&&(this.m_XYToRadians=t.getUnit().getUnitFactor(),this.m_PrimeMeridianDegrees=t.getPrimem().getLongitude())},initFromGcsAndVcs(t,e){const i=t?t.getPECoordSys():null,s=e?e.getPEVerticalCoordSys():null;this.initFromGcsAndVcsPe(i,s)},processUnitParams(t){Number.isNaN(this.m_heightMetersPerUnit)&&(this.m_heightMetersPerUnit=t.m_heightMetersPerUnit,this.m_heightSign=t.m_heightSign,this.m_heightZ0=t.m_heightZ0),Number.isNaN(this.m_XYToRadians)&&(this.m_XYToRadians=t.m_XYToRadians,this.m_PrimeMeridianDegrees=t.m_PrimeMeridianDegrees)}}}class s5e{constructor(e){this.m_constantsLoaded=-1,this.m_isUsable=-1,this.m_inputSR=null,this.m_outputSR=null,this.m_inputSRHorz=null,this.m_outputSRHorz=null,this.m_inputVCS=null,this.m_outputVCS=null,this.m_hashCode=0,this.m_areaOfUse=new Fo,this.m_inputUnitParams=Td(),this.m_outputUnitParams=Td(),z(e),this.m_geogTran=e,this.m_vertTran=null,this.m_latestID=xr.getCode(this.m_geogTran),this.m_latestID<0&&(this.m_latestID=0);const i=this.m_geogTran.getGeogcs1();xr.getCode(i);const s=this.m_geogTran.getGeogcs2();xr.getCode(s),this.initUnitParams()}getLatestId(){return this.m_latestID}getText(){return this.m_geogTran?this.m_geogTran.toString():(z(0),"")}getGeogtran(){return this.m_geogTran}getVerttran(){return null}loadConstants(e){let i=this.m_constantsLoaded;if(i===-1){if(!e){this.m_geogTran||We("vcs not impl");const s=this.m_geogTran.getParameters();s[$t.PE_PARM_ND]!==null&&(e=s[$t.PE_PARM_ND].getValue()===0)}i=this.m_geogTran.loadConstants()?1:0,this.m_constantsLoaded=i}return i!==0}isUsable(){let e=this.m_isUsable;return e===-1&&(this.m_geogTran?this.m_isUsable=e=this.m_geogTran?1:0:this.m_isUsable=e=this.m_vertTran?1:0),e===1}getInputSr(e){return this.updateSrs(),e?this.m_inputSR:this.m_inputSRHorz}getOutputSr(e){return this.updateSrs(),e?this.m_outputSR:this.m_outputSRHorz}getHashCode(){let e=this.m_hashCode;return e===0&&(e=this.m_latestID>0?nd(this.m_latestID):npe(this.getText()),e===0&&(e=345),this.m_hashCode=e),e}isGeogtran(){return this.m_geogTran!==null}prepareOrThrow(){}getName(){return this.isGeogtran()?this.getGeogtran().getName():(_i("vcs not impl"),"")}updateSrs(){if(this.m_inputSR||this.m_inputVCS)return;let e,i,s,n,r,o;if(this.m_geogTran){const a=this.m_geogTran.getGeogcs1(),l=TL(a),u=this.m_geogTran.getGeogcs2(),c=TL(u);let h=-1,d=-1;h=l.getVcsCode(),d=c.getVcsCode(),s=aM(a,null,null,1),n=aM(u,null,null,1),h>0&&d>0?(r=mte(h),o=mte(d),e=IB(),i=IB()):(e=s,i=n)}else z(0);this.m_inputSR||this.m_inputVCS||(this.m_inputSR=e,this.m_outputSR=i,this.m_inputSRHorz=s,this.m_outputSRHorz=n,this.m_inputVCS=r,this.m_outputVCS=o)}initUnitParams(){if(this.m_inputUnitParams.m_heightSign=1,this.m_inputUnitParams.m_heightMetersPerUnit=Number.NaN,this.m_inputUnitParams.m_heightZ0=0,this.m_outputUnitParams.m_heightSign=1,this.m_outputUnitParams.m_heightMetersPerUnit=Number.NaN,this.m_outputUnitParams.m_heightZ0=0,this.m_inputUnitParams.m_XYToRadians=Number.NaN,this.m_inputUnitParams.m_PrimeMeridianDegrees=Number.NaN,this.m_outputUnitParams.m_XYToRadians=Number.NaN,this.m_outputUnitParams.m_PrimeMeridianDegrees=Number.NaN,this.m_vertTran)z(0);else if(this.m_geogTran){const e=this.m_geogTran;let i=e.getGeogcs1();this.m_inputUnitParams.m_XYToRadians=i.getUnit().getUnitFactor(),this.m_inputUnitParams.m_PrimeMeridianDegrees=i.getPrimem().getLongitude(),i=e.getGeogcs2(),this.m_outputUnitParams.m_XYToRadians=i.getUnit().getUnitFactor(),this.m_outputUnitParams.m_PrimeMeridianDegrees=i.getPrimem().getLongitude()}}}function vge(t,e,i,s,n,r,o){let a=null;e&&(a=e.getPEVerticalCoordSys());let l=null;t&&(l=t.getPECoordSys());let u=null;s&&(u=s.getPEVerticalCoordSys());let c=null;if(i&&(c=i.getPECoordSys()),!(l||a||c||u))return!1;const h=Td();h.initFromGcsAndVcsPe(l,a);const d=Td();return d.initFromGcsAndVcsPe(c,u),p4(h,d,n,r,o)}function n5e(t,e,i,s,n,r,o,a){const l=e,u=t,c=Td();c.initFromGcsAndVcsPe(u,l),a.assign(s?i.m_outputUnitParams:i.m_inputUnitParams),a.processUnitParams(c),c.processUnitParams(a),o>0&&p4(c,a,n,r,o)}function r5e(t,e,i,s,n,r,o,a){const l=Td();l.assign(i?e.m_inputUnitParams:e.m_outputUnitParams),l.processUnitParams(t);let u=null,c=null;s&&(c=s.getPECoordSys());const h=Td();h.initFromGcsAndVcsPe(c,u),h.processUnitParams(l),l.processUnitParams(h),a>0&&p4(l,h,r,o,a)}function o5e(t,e,i,s,n,r,o,a,l){const u=Td(),c=Td();u.assign(i?e.m_inputUnitParams:e.m_outputUnitParams),c.assign(n?s.m_outputUnitParams:s.m_inputUnitParams),u.processUnitParams(t),c.processUnitParams(u),u.processUnitParams(c),a>0&&p4(u,c,r,o,a),l.assign(c)}function a5e(t,e,i,s,n,r,o){const a=e.getVerttran(),l=e.getGeogtran();if(o.assign(i?e.m_inputUnitParams:e.m_outputUnitParams),o.processUnitParams(t),r>0){e.prepareOrThrow();const u=i?$t.PE_TRANSFORM_2_TO_1:$t.PE_TRANSFORM_1_TO_2;a?Age():Ige(l,r,s,n,u)}}function l5e(t,e,i,s,n){const r=t.getVerttran(),o=t.getGeogtran();if(n>0){t.prepareOrThrow();const a=e?$t.PE_TRANSFORM_2_TO_1:$t.PE_TRANSFORM_1_TO_2;r?Age():Ige(o,n,i,s,a)}}class dj{supportsCurves(){return!0}accelerateGeometry(e,i,s){return xge(e,i,s)}canAccelerateGeometry(e){return mj(e)}}function xge(t,e,i){if(!mj(t))return!1;$P(e,t,!1);let s=0;const n=t.getGeometryType();return Ei(n)&&nL(t)&&i!==0&&(s|=t.getImpl().buildQuadTreeAccelerator(i)?1:0),Ei(n)&&wpe(t)&&i!==0&&(s|=t.getImpl().buildQuadTreeForPathsAccelerator(i)?1:0),s>0}function mj(t){return nL(t)||wpe(t)}class bge extends dj{getOperatorType(){return 8}execute(e,i,s,n){return _f(e,i,s,1,n)}}function u5e(t,e,i,s){if(t.isEmpty()||e.isEmpty())return t;const n=t.getDimension(),r=e.getDimension();if(n>r)return t;const o=t.getGeometryType(),a=e.getGeometryType(),l=new J,u=new J,c=new J;t.queryEnvelope(l),e.queryEnvelope(u),c.setCoords({env2D:l}),c.mergeEnvelope2D(u);const h=yr(i,c,!0),d=Pu(h),m=new J;if(m.setCoords({env2D:l}),m.inflateCoords(d,d),!m.isIntersecting(u))return t;if(n===1&&r===2){const _=v5e(t,e,a,i,s);if(_)return _}if(o===q.enumPoint){let _;switch(nr(a)?(_=new Qi({vd:e.getDescription()}),_.addSegment(e,!0)):_=e,a){case q.enumPolygon:return h5e(t,_,h);case q.enumPolyline:return d5e(t,_,h);case q.enumMultiPoint:return m5e(t,_,h);case q.enumEnvelope:return p5e(t,_,h);case q.enumPoint:return f5e(t,_,h);default:ce("invalid shape type")}}else if(o===q.enumMultiPoint)switch(a){case q.enumPolygon:return g5e(t,e,h);case q.enumEnvelope:return _5e(t,e,h);case q.enumPoint:return y5e(t,e,h)}const f=new J(l);return f.inflate(100*h.total()),sUe(t,Is(e,f,0,0,s),i,s)}class f4{getOperatorType(){return 10002}supportsCurves(){return!0}accelerateGeometry(e,i,s){return!1}canAccelerateGeometry(e){return!1}executeMany(e,i,s,n){return new c5e(e,i,s,n)}execute(e,i,s,n){return this.executeMany(new zm([e]),new zm([i]),s,n).next()}}class c5e extends Pd{constructor(e,i,s,n){super(),this.m_progressTracker=n,this.m_index=-1,this.m_inputGeoms=e,this.m_spatialReference=s;const r=i.next();this.m_geomSubtractor=r||new Ci}next(){const e=this.m_inputGeoms.next();return e?(Um(e),NRe(e),this.m_index=this.m_inputGeoms.getGeometryID(),u5e(e,this.m_geomSubtractor,this.m_spatialReference,this.m_progressTracker)):null}getGeometryID(){return this.m_index}tock(){return!0}getRank(){return 1}}function h5e(t,e,i,s){return tge(e,t,i.total())===0?t:t.createInstance()}function d5e(t,e,i,s){const n=t.getXY(),r=e.querySegmentIterator(),o=Pu(i),a=o*o;for(;r.nextPath();)for(;r.hasNextSegment();){const l=r.nextSegment(),u=new J;if(l.queryEnvelope(u),u.inflateCoords(o,o),!u.contains(n))continue;if(l.isIntersectingPoint(n,i.total()))return t.createInstance();let c=l.getStartXY();if(N.sqrDistance(n,c)<=a||(c=l.getEndXY(),N.sqrDistance(n,c)<=a))return t.createInstance()}return t}function m5e(t,e,i,s){const n=e.getImpl().getAttributeStreamRef(0),r=e.getPointCount(),o=t.getXY(),a=Pu(i),l=a*a,u=new N;for(let c=0;c<r;c++)if(n.queryPoint2D(2*c,u),N.sqrDistance(u,o)<=l)return t.createInstance();return t}function p5e(t,e,i,s){const n=new J;e.queryEnvelope(n),n.inflate(i.total());const r=t.getXY();return n.contains(r)?t.createInstance():t}function f5e(t,e,i,s){const n=Pu(i),r=n*n,o=t.getXY(),a=e.getXY();return N.sqrDistance(o,a)<=r?t.createInstance():t}function g5e(t,e,i,s){const n=new J;e.queryEnvelope(n),n.inflate(i.total());const r=t.getPointCount();let o=!1;const a=st(r,!1),l=new N;for(let c=0;c<r;c++)t.queryXY(c,l),n.contains(l)&&ul(e,l,i.total())!==0&&(o=!0,a[c]=!0);if(!o)return t;const u=t.createInstance();for(let c=0;c<r;c++)a[c]||u.addPoints(t,c,c+1);return u}function _5e(t,e,i,s){const n=new J;e.queryEnvelope(n),n.inflate(i.total());const r=t.getPointCount();let o=!1;const a=st(r,!1),l=new N;for(let c=0;c<r;c++)t.queryXY(c,l),n.contains(l)&&(o=!0,a[c]=!0);if(!o)return t;const u=t.createInstance();for(let c=0;c<r;c++)a[c]||u.addPoints(t,c,c+1);return u}function y5e(t,e,i,s){const n=t.getImpl().getAttributeStreamRef(0),r=t.getPointCount(),o=e.getXY();let a=!1;const l=st(r,!1),u=Pu(i),c=u*u,h=new N;for(let m=0;m<r;m++)n.queryPoint2D(2*m,h),N.sqrDistance(h,o)<=c&&(a=!0,l[m]=!0);if(!a)return t;const d=t.createInstance();for(let m=0;m<r;m++)l[m]||d.addPoints(t,m,m+1);return d}function v5e(t,e,i,s,n){const r=new Fo;t.queryEnvelope(r);const o=new J;e.queryEnvelope(o),r.merge(o);const a=.1*r.width(),l=.1*r.height();r.inflateCoords(a,l);const u=new Ci;u.addEnvelope(r,!1);const c=u.getImpl();if(i===q.enumPolygon){const h=e.getImpl();c.add(h,!0)}else c.addEnvelope(e,!0);return new Kv(u,s,-1,n).tryFastImplementation(t)}class wL{getOperatorType(){return 10001}supportsCurves(){return!0}accelerateGeometry(e,i,s){return!1}canAccelerateGeometry(e){return!1}executeMany(e,i,s,n=0){return new SL(e,i,s,n)}execute(e,i,s,n){const r=new zm([e,i]),o=new SL(r,s,n,0).next();return o||We("null output"),o}}function x5e(){return{geom:null,vertexCount:-1,bUnioned:!1,location:new N}}function b5e(t,e){return N.compareZorder(t.location,e.location)?-1:t.location.equals(e.location)?0:1}class w5e{constructor(){this.binVertexCount=0,this.geometries=[]}addPair(e){this.binVertexCount+=e.vertexCount,this.geometries.push(e)}sort(){this.geometries.sort((e,i)=>b5e(e,i))}geomCount(){return this.geometries.length}geomPairs(){return this.geometries}clear(){this.binVertexCount=0,this.geometries.length=0}getBinVertexCount(){return this.binVertexCount}}class SL extends Pd{constructor(e,i,s,n,r=!1){super(),this.m_index=-1,this.m_currentDim=-1,this.m_bDone=!1,this.m_unionBins=[],this.m_readyGeoms=XT(4),this.m_dimGeomCounts=st(4,0),this.m_addedGeoms=0,this.m_maxDimension=-1,this.m_bHadGeometry=st(4,!1),this.m_complexUnionGeoms=XT(4),this.m_totalNonEmptyGeomCounters=st(4,0),this.m_progressTracker=s,this.m_bUnionAllDimensions=!!(4&n),this.m_bPreserveAllPathEnds=!!(8&n),this.m_inputGeoms=e,this.m_spatialReference=i,this.m_options=n,this.m_bIs3D=r}next(){if(this.m_bDone&&this.m_currentDim===this.m_maxDimension)return null;for(;!this.step_(););if(this.m_maxDimension===-1)return null;if(this.m_bUnionAllDimensions){if(this.m_currentDim===-1){for(let e=0;e<=this.m_maxDimension;e++)if(this.m_bHadGeometry[e]){this.m_complexUnionGeoms[e]=this.getResultGeometry(e);for(let i=e+1;i<=this.m_maxDimension;i++)this.m_complexUnionGeoms[i]=this.getResultGeometry(i),this.m_bHadGeometry[i]&&!this.m_complexUnionGeoms[i].isEmpty()&&(this.m_bIs3D?z(0):this.m_complexUnionGeoms[e]=new f4().execute(this.m_complexUnionGeoms[e],this.m_complexUnionGeoms[i],this.m_spatialReference,this.m_progressTracker))}}for(;this.m_currentDim++,(this.m_currentDim>this.m_maxDimension||this.m_currentDim<0)&&We(""),!this.m_bHadGeometry[this.m_currentDim];);if(this.m_index++,this.m_currentDim===0&&this.m_complexUnionGeoms[this.m_currentDim].getGeometryType()===q.enumPoint){const e=new Dn({vd:this.m_complexUnionGeoms[this.m_currentDim].getDescription()});return this.m_complexUnionGeoms[this.m_currentDim].isEmpty()||e.add(this.m_complexUnionGeoms[this.m_currentDim]),e}return this.m_complexUnionGeoms[this.m_currentDim]}return this.m_index=0,this.m_currentDim=this.m_maxDimension,this.getResultGeometry(this.m_maxDimension)}getGeometryID(){return this.m_index}getRank(){return 1}tock(){return this.step_()}getResultGeometry(e){return this.m_readyGeoms[e]}finishDim(e,i,s){let n=i;if(!s)return 16&this.m_options&&(n=YU([n],1,this.m_spatialReference,this.m_progressTracker,this.m_options,this.m_bIs3D)),n;if(1&this.m_options)return n;if(e===1)if(!(8&this.m_options)&&(16&this.m_options||this.m_totalNonEmptyGeomCounters[e]>1)){n=YU([n],1,this.m_spatialReference,this.m_progressTracker,16|this.m_options,this.m_bIs3D);const r=[0],o=n.getImpl().getIsSimple(0,r);z(this.m_bIs3D||ry(o))}else this.m_totalNonEmptyGeomCounters[e]===1&&(this.m_bIs3D?z(0):n=new Am().execute(n,this.m_spatialReference,!1,this.m_progressTracker));else this.m_bIs3D?z(0):n=new Am().execute(n,this.m_spatialReference,!1,this.m_progressTracker);if(e===0&&n.getGeometryType()===q.enumPoint){const r=new Dn({vd:n.getDescription()});n.isEmpty()||r.add(n),n=r}return n}static getLevel(e){const s=DP(e);let n=s>0?(Math.log(s)-Math.log(32))/Math.log(4):0;return n<0&&(n=0),Math.floor(n)}step_(){if(this.m_bDone)return!0;let e;if(this.m_inputGeoms?(e=this.m_inputGeoms.next(),e===null?(this.m_bDone=!0,this.m_inputGeoms=null):(this.checkAndThrow(e),e.isEmpty()||this.m_totalNonEmptyGeomCounters[e.getDimension()]++)):e=null,e!==null){const i=e.getDimension();this.m_bHadGeometry[i]=!0,(i>=this.m_maxDimension||this.m_bUnionAllDimensions)&&(this.addGeom(i,!1,e),i>this.m_maxDimension&&!this.m_bUnionAllDimensions&&this.removeAllBinsWithLowerDimension(i))}if(this.m_addedGeoms>0)for(let i=0;i<=this.m_maxDimension;i++){for(;this.m_dimGeomCounts[i]>1;){const s=this.collectGeometriesToUnion(i);if(s===null)break;{let n;n=1&this.m_options?YU(s,s.length,this.m_spatialReference,this.m_progressTracker,this.m_options,this.m_bIs3D):lUe(s,s.length,this.m_spatialReference,this.m_progressTracker,8|this.m_options,this.m_bIs3D),this.addGeom(i,!0,n)}}if(this.m_bDone&&(z(this.m_dimGeomCounts[i]<=1),this.m_dimGeomCounts[i]!==0)){const s=this.m_unionBins[i].entries().next().value,n=s[1].geomPairs()[0].geom,r=s[1].geomPairs()[0].bUnioned;this.m_unionBins[i].clear(),this.m_readyGeoms[i]=this.finishDim(i,n,r)}}return this.m_bDone}addGeom(e,i,s){const n=x5e();n.geom=s;const r=DP(s);n.vertexCount=r;const o=J.constructEmpty();s.queryEnvelope(o),n.location=r>0?o.getCenter():new N(0,0);const a=SL.getLevel(s);if(e+1>this.m_unionBins.length)for(;this.m_unionBins.length<Math.max(2,e+1);)this.m_unionBins.push(new Map);let l=null;const u=this.m_unionBins[e].get(a);u&&(l=u),l===null&&(l=new w5e,this.m_unionBins[e].set(a,l)),n.bUnioned=i,l.addPair(n),this.m_dimGeomCounts[e]++,this.m_addedGeoms++,this.m_maxDimension=Math.max(this.m_maxDimension,e)}removeAllBinsWithLowerDimension(e){for(let i=0;i<e;i++)this.m_unionBins[i].clear(),this.m_addedGeoms-=this.m_dimGeomCounts[i],this.m_dimGeomCounts[i]=0}collectGeometriesToUnion(e){if(1&this.m_options&&!this.m_bDone)return null;let i=null;const s=[];for(const n of this.m_unionBins[e].keys())s.push(n);KS(s);for(let n=0;n<s.length;n++){if(s[n]===-1)continue;const r=this.m_unionBins[e].get(s[n]);{const l=r.getBinVertexCount()>5e3&&r.geomCount()>=4;if(this.m_bDone||l){for(let u=0;u<n;u++){if(s[u]===-1)continue;const c=this.m_unionBins[e].get(s[u]);c.sort(),this.m_dimGeomCounts[e]-=c.geomCount(),this.m_addedGeoms-=c.geomCount();for(const h of c.geomPairs())i||(i=new Array),i.push(h.geom);c.clear(),this.m_unionBins[e].delete(s[u]),s[u]=-1}r.sort(),this.m_dimGeomCounts[e]-=r.geomCount(),this.m_addedGeoms-=r.geomCount();for(const u of r.geomPairs())i||(i=new Array),i.push(u.geom);if(r.clear(),this.m_unionBins[e].delete(s[n]),s[n]=-1,!this.m_bDone)break}}}return i}checkAndThrow(e){this.m_bIs3D&&(e.getDimension()>1&&ARe(),e.hasAttribute(1)||ce("Geometry must have Zs")),Um(e)}}class pj extends dj{getOperatorType(){return 3}execute(e,i,s,n=null){return _f(e,i,s,4,n)}}function wB(t,e,i){const s=e.getGCSSplitLines();if(s===null)return t;const n=e.getGCS(),r=n.getPannableExtent().width(),o=J.constructEmpty();t.queryLooseEnvelope(o);const a=Me.constructEmpty();o.queryIntervalX(a);const l=s.querySegmentIterator();let u=null;const c=new Gi;for(;l.nextPath();)for(;l.hasNextSegment();){const h=l.nextSegment(),d=h.queryInterval(0,0),m=Me.constructEmpty();m.setCoordsFromEnvelope(d);let f=0;for(;m.vmax>a.vmin;)m.move(-r),f--;for(;m.vmin<=a.vmax;){if(m.isIntersecting(a)){u===null&&(u=new Qi);const _=new mi({start:h.getStartXY(),end:h.getEndXY()});f!==0&&(c.setShiftCoords(f*r,0),_.applyTransformation(c)),u.addSegment(_,!0)}m.move(r),++f}}if(u!==null){const h=Fl(n,u,!0);return Y4e(t,u,Pu(h),i)}return t}function fj(t,e,i){let s=t.getName();return Vge(s)||(i||e>0?(s=t.toString($t.PE_STR_NAME_CANON|$t.PE_STR_AUTH_NONE),s=T5e(s)):s=t.toString($t.PE_STR_AUTH_TOP)),s}function S5e(t,e,i,s){return z(0),""}function pte(t,e=-1){if((e>1||e<-1)&&ce("verbosity"),e===-1)return t.toString();{const i=e===0?$t.PE_STR_AUTH_TOP:$t.PE_STR_AUTH_ALL;return t.toString(i)}}function E5e(t,e){(e>1||e<-1)&&ce("verbosity");let i=$t.PE_STR_FMT_WKT2;return e!==-1&&(i|=e===0?$t.PE_STR_AUTH_TOP:$t.PE_STR_AUTH_ALL),t.toString(i)}function C5e(t){return z(0),""}function T5e(t){return t.toLocaleUpperCase("en-US")}function P5e(t,e,i){const s=t.getPCSHorizon();if(s.getGeometryType()!==q.enumPolygon)if(s.getGeometryType()!==q.enumEnvelope)ce("");else{const n=s;for(let r=0;r<i;r++)n.contains(e[r])||e[r].setNAN()}else{const n=t.getDefaultPrecisionSR().getTolerance(0),r=s;for(let o=0;o<i;o++)ul(r,e[o],n)!==1&&e[o].setNAN()}}function M5e(t,e,i,s){for(let n=0;n<e;n++){if(t[n].y<i.ymin||t[n].y>i.ymax){t[n].setNAN();continue}const r=t[n].x;t[n].x=Pv(r,i,s)}}function WU(t,e,i,s){if(t.isEmpty()||i===1)return t;const n=t.getGeometryType();if(n===q.enumPoint){const C=t,M=C.getXY();return EB([M],1,e,i)===0||M.isNAN()?C.setEmpty():C.setXY(M),t}if(n===q.enumMultiPoint){const C=t,M=t.createInstance(),A=C.getPointCount();M.reserve(A);const I=C.getAttributeStreamRef(0),L=C.getDescription().getAttributeCount()>1,D=new Jt,O=Float64Array.from(I.getArray());if(EB(O,A,e,i)>0)for(let U=0,$=2*A;U<$;U+=2)Number.isNaN(O[U])||(L?(C.getPointByVal(U>>1,D),D.setXYCoords(O[U],O[U+1]),M.add(D)):M.addXY(O[U],O[U+1]));return M}let r=t;const o=e.getOneDegreeGCSUnit(),a=90*o,l=180*o,u=360*o,c=e.getCentralMeridian(),h=.5*o,d=J.constructEmpty();r.queryEnvelope(d);const m=e.getGCSHorizon(),f=e.getGCSHorisonIsInclusive(),_=m.getGeometryType()===q.enumEnvelope,v=J.constructEmpty();m.queryEnvelope(v);const x=e.getGCS();if(i!==2&&i!==4||(v.xmin=c-l,v.xmax=v.xmin+u),i===4){if(!(d.width()>u-o)){const C=J.constructEmpty();C.setCoords({xmin:d.xmin-o,ymin:v.ymin,xmax:d.xmax+o,ymax:v.ymax}),r=new _S().execute(r,C,x,s);let M=Math.floor((c-d.getCenterX())/u);for(d.move(M*u,0);d.xmin>v.xmax;)M-=1,d.move(-u,0);for(;d.xmin<v.xmin;)M+=1,d.move(u,0);if(M!==0){const A=new Gi;A.setShiftCoords(M*u,0),r.applyTransformation(A)}return r}i=2}if(i===2&&(v.xmin=c-l,v.xmax=v.xmin+u),d.ymin<-a||d.ymax>a){const C=J.constructEmpty();if(C.setCoords({xmin:d.xmin-o,ymin:-a,xmax:d.xmax+o,ymax:a}),r=new _S().execute(r,C,x,s),r.isEmpty())return r;r.queryEnvelope(d)}if(f&&(v.ymax<d.ymin||v.ymin>d.ymax))return r.createInstance();d.width()>u&&(r=rM(r,c-l,u,x,!0,0,!0,s),r.queryEnvelope(d));let w=R5e(d.xmin,d.xmax,v.xmin,v.xmax,u);if(w!==0&&d.move(w,0),d.xmax>v.xmax||d.xmin<v.xmin){if(d.xmax>v.xmax)for(;d.xmin>=v.xmax;)d.move(-u,0),w-=u;for(;d.xmin<v.xmax-u;)d.move(u,0),w+=u}const T=$P(x,m,!1);if(w!==0){const C=new Gi;C.setShiftCoords(w,0),r.applyTransformation(C),w=0}if(f){if(_&&v.containsEnvelope(d))return r;const C=new Array(2);for(let M=0;M<2;M++){let A;if(_?A=Ei(n)?Is(r,v,T,h,s):Is(r,v,T,0,s):(A=new P1().execute(r,m,x,s),A===m&&(A=A.clone())),v.xmin<=d.xmin&&v.xmax>=d.xmax||v.xmin>=d.xmin&&v.xmax<=d.xmax)return A;if(C[M]=A,M===0){d.move(-u,0);const I=new Gi;I.setShiftCoords(-u,0),r.applyTransformation(I)}}return Ei(n)?C[0].add(C[1],!1):We("intersect_with_GCS_horizon: unexpected geometry type"),C[0]}{if(v.ymax<d.ymin||v.ymin>d.ymax)return r;let C=0;for(;!r.isEmpty()&&d.xmax>v.xmin;){if(C!==0){const M=new Gi;M.setShiftCoords(C,0),r.applyTransformation(M)}if(new pj().execute(r,m,x,s)||(r=new f4().execute(r,m,x,s),m===r&&(r=r.clone())),C!==0){const M=new Gi;M.setShiftCoords(-C,0),r.applyTransformation(M)}C-=u,d.move(-u,0)}return r}}function A5e(t,e,i,s,n,r){const o={stack:[],error:void 0,hasError:!1};try{if(r===2)return b4e(t,e,i,s,n);if(Math.abs(i.x-s.x)>=Math.PI||!ZU(i.x,s.x,n))return Number.NaN;i.x>s.x&&(s=Ge(i,i=s));const a=Da(o,new Lo,!1),l=Da(o,new Lo,!1),u=Da(o,new Lo,!1),c=i.clone();zl.geodeticDistance(t,e,i.x,i.y,s.x,s.y,l,a,null,r);const h=l.val;let d=0,m=1;for(;h*(m-d)>1e-12*t;){const f=.5*(d+m);if(zl.geodeticCoordinate(t,e,i.x,i.y,h*f,a.val,l,u,r),c.x=l.val,c.y=u.val,c.x===n)return c.y;if(ZU(i.x,c.x,n))m=f;else{if(!ZU(s.x,c.x,n))return Number.NaN;d=f}}return c.y}catch(a){o.error=a,o.hasError=!0}finally{Hf(o)}}function I5e(t,e){let i;if(Array.isArray(t)){const s=t;i=new Float64Array(2*e);for(let n=0,r=0;n<e;n++,r+=2)i[r]=s[n].x,i[r+1]=s[n].y}else i=t;return i}function SB(t,e,i,s){for(let n=0,r=0;n<s;n++,r+=2)e[i+n].x=t[r],e[i+n].y=t[r+1]}function EB(t,e,i,s){if(e===0||s===1)return e;const n=I5e(t,e);if(s===2){const _=i.getPannableExtentInGCS();let v=e;for(let x=0,w=2*e;x<w;x+=2)(n[x+1]>_.ymax||n[x+1]<_.ymin)&&(n[x]=Number.NaN,v--);return v?(l3(n,e,_.xmin,_.width(),!0),t!==n&&SB(n,t,0,e),v):0}const r=i.getOneDegreeGCSUnit(),o=90*r,a=180*r,l=360*r;let u=e;for(let _=0,v=2*e;_<v;_+=2)(n[_+1]>o||n[_+1]<-o)&&(n[_]=Number.NaN,u--);if(!u)return 0;const c=J.constructEmpty();c.setFromPoints(n,e);const h=i.getGCSHorizon(),d=i.getGCSHorisonIsInclusive(),m=h.getGeometryType()===q.enumEnvelope,f=J.constructEmpty();if(h.queryEnvelope(f),d&&(f.ymax<c.ymin||f.ymin>c.ymax))return 0;if(d)if(l3(n,e,f.getCenterX()-a,l,!0),u=e,m)for(let _=0,v=2*e;_<v;_+=2)f.containsCoords(n[_],n[_+1])||(n[_]=Number.NaN,u--);else{const _=$P(i.getGCS(),h,!1),v=new N;for(let x=0,w=2*e;x<w;x+=2)v.setCoords(n[x],n[x+1]),ul(h,v,_)!==0||(n[x]=Number.NaN,u--)}else{l3(n,e,-a,l,!0),u=e;const _=$P(i.getGCS(),h,!1),v=new N;for(let x=0,w=2*e;x<w;x+=2){v.setCoords(n[x],n[x+1]),v.isNAN()&&u--;const T=Ege(v.x,f.xmin,f.xmax,l);v.x+=T,ul(h,v,_)!==0&&(n[x]=Number.NaN,u--)}}return u>0&&Array.isArray(t)&&SB(n,t,0,e),u}function vS(t,e,i,s,n,r){if(e.isPannable()||ce("fold_into_360_degree_range"),t.isEmpty())return t;let o,a;if(e.getCoordinateSystemType()===2){const l=e.getPannableExtent();a=l.xmin,o=l.width()}else{const l=e.getOneDegreeGCSUnit();o=360*l,a=i-180*l}return rM(t,a,o,e,s,n,!0,r)}function wge(t,e,i,s){let n,r;if(i.getCoordinateSystemType()===2){const o=i.getPannableExtent();n=o.xmin,r=o.width()}else{const o=i.getOneDegreeGCSUnit();r=360*o,n=s-180*o}l3(t,e,n,r)}function a3(t,e){const i=e.width();let s=xy(t-e.vmin,i);return s<0&&(s+=i),e.snapClip(s+e.vmin)}function Pv(t,e,i){return t>e.xmax&&t-e.xmax<i?e.xmax:t<e.xmin&&e.xmin-t<i?e.xmin:t}function EL(t,e,i){if(t[0]<e.vmin||t[0]>e.vmax||i&&t[0]===e.vmax){const s=e.width();return t[0]+=Math.ceil((e.vmin-t[0])/s)*s,t[0]=e.snapClip(t[0]),!0}return!1}function D5e(t,e,i,s,n,r,o,a,l){return new bL(t,null,i,e,s,n,o,a,r).geoNormalizePolygonGeometry(l)}function N5e(t,e,i,s,n,r,o,a,l){return new bL(t,null,i,e,s,n,o,a,r).geoNormalizePolylineGeometry(l)}function Sge(t,e,i,s,n){const r=new wn,o=r.addGeometry(t);return xS(r,o,e,$P(e,t,!1),i,s,n),r.getGeometry(o)}function xS(t,e,i,s,n,r,o){const a={stack:[],error:void 0,hasError:!1};try{z(gc()),i.isPannable()||un("insert_geodetic_points");const l=i.getPannableExtent(),u=i.getGCS(),c=H1();u.querySpheroidData(c);const h=u.getUnit().getUnitToBaseFactor(),d=c.majorSemiAxis,m=c.e2;let f=0;const _=new Me;l.queryIntervalX(_);let v=null;const x=st(4,Number.NaN);i.getCoordinateSystemType()===2?(v=i.getPECoordSys(),r?(x[0]=a3(o,_),x[1]=l.getCenterY(),yo.projToGeog(v,1,x),f=x[0]*h):(x[0]=l.getCenterX(),x[1]=o,yo.projToGeog(v,1,x),f=x[1]*h)):f=o*h,r||f===0||n===2||un("insert_geodetic_points: 1");const w=Da(a,new Lo,!1),T=new N,C=new N,M=new N,A=new N,I=new N,L=new N;for(let D=t.getFirstPath(e);D!==G;D=t.getNextPath(D)){const O=t.getFirstVertex(D);t.queryXY(O,M);let U=!1;const $=t.getNextVertex(O);for(let B=$;B!==G;B=t.getNextVertex(B)){if(B===$){if(U)break;U=!0}if(t.queryXY(B,A),r&&(s<o-M.x&&A.x-o>s||s<o-A.x&&M.x-o>s)||!r&&(o!==0||s<-M.y&&A.y>s||s<-A.y&&M.y>s))do{if(Math.abs(M.x-A.x)>=.5*_.width())break;i.getCoordinateSystemType()===2?(x[0]=a3(M.x,_),x[1]=M.y,x[2]=a3(A.x,_),x[3]=A.y,_4(v,2,x,0),I.x=x[0]*h,I.y=x[1]*h,L.y=x[3]*h):(I.x=M.x*h,I.y=M.y*h,L.y=A.y*h),L.x=(A.x-M.x)*Math.PI*2/_.width()+I.x;let V=0;const H=he(N,2);if(r){if(C.x=f,C.y=A5e(d,m,I,L,f,n),Number.isNaN(C.y))break;H[0]=C,V=1}else if(n===2){const W=[0,0];if(V=wfe(d,m,I,L,f,W),!V)break;H[0].x=W[0],H[0].y=f,V===2&&(H[1].x=W[1],H[1].y=f)}else{if(C.x=aVe(d,m,I,L,n),Number.isNaN(C.x))break;C.y=0,H[0]=C,V=1}let Y=-1;for(let W=0;W<V;W++){zl.geodeticDistance(d,m,I.x,I.y,L.x,L.y,w,null,null,n);const ee=w.val;zl.geodeticDistance(d,m,I.x,I.y,H[W].x,H[W].y,w,null,null,n);const ne=w.val;i.getCoordinateSystemType()===2?(x[0]=H[W].x/h,x[1]=H[W].y/h,yo.geogToProj(v,1,x),r?(T.y=x[1],T.x=o):(T.x=_te(x[0],M.x,A.x,_),T.y=o)):r?(T.x=o,T.y=H[W].y/h):(T.x=_te(H[W].x/h,M.x,A.x,_),T.y=o);const j=ee>0?Os(ne/ee,0,1):.5;if(j===0||j===1||Y>j)continue;const oe=t.getPrevVertex(B);t.splitSegment(oe,[j],1);const ve=t.getNextVertex(oe);t.setXYCoords(ve,T.x,T.y),Y=j}}while(!1);M.setCoordsPoint2D(A)}}}catch(l){a.error=l,a.hasError=!0}finally{Hf(a)}}function nE(t,e){z(e.isPannable());const i=e.getPannableExtent();if(t.getGeometryType()===q.enumPoint){const a=t.getY();return i.ymin<=a&&a<=i.ymax?t:t.createInstance()}const s=J.constructEmpty();t.queryEnvelope(s);const n=J.constructEmpty();n.setCoords({env2D:i}),n.xmin=s.xmin,n.xmax=s.xmax,n.inflateCoords(.01*n.height(),0);const r=Vy(e,s,!1);let o;return o=n.containsEnvelope(s)?t:Is(t,n,r,0,null),o}function Ege(t,e,i,s){return g1((.5*(i+e)-t)/s)*s}function R5e(t,e,i,s,n){return t>=i&&e<=s?0:Ege(.5*(e+t),i,s,n)}function rM(t,e,i,s,n,r,o,a){const l=t.getGeometryType(),u=Me.constructEmpty();u.setCoords(e,e+i);const c=[0];if(l===q.enumPoint){const I=t;if(c[0]=I.getX(),EL(c,u,o)){const L=n?t:t.clone();return L.setX(c[0]),L}return t}const h=J.constructEmpty();if(t.queryEnvelope(h),h.isEmpty())return t;if(l===q.enumMultiPoint){const I=n?t:t.clone(),L=I.getImpl(),D=L.getAttributeStreamRef(0),O=2*L.getPointCount();let U=!1;for(let $=0;$<O;$+=2)c[0]=D.read($),EL(c,u,o)&&(D.write($,c[0]),U=!0);return U&&L.notifyModifiedFlags(2001),I}const d=Me.constructEmpty();if(h.queryIntervalX(d),u.contains(d))return u.vmax,d.vmax,t;const m=J.constructEmpty();if(m.setCoords({env2D:h}),d.width()===0){let I=d.vmin;I+=Math.ceil((u.vmin-I)/i)*i,I=u.snapClip(I);const L=n?t:t.clone();return L.setAttributeBasic(0,0,I),L}if(l===q.enumEnvelope){const I=n?t:t.clone();return h.intersect(m),I.setEnvelope(h),I}const f=.1*Math.max(h.height(),h.width())*1;m.inflateCoords(0,f);let _=t;const v=s.getTolerance(0),x=new Gi;for(;;){const I=Math.floor((d.vmin-e)/i),L=Math.ceil((d.vmax-e)/i);if(!(L-I>3))break;{const D=Math.floor(.5*(L+I));m.xmin=h.xmin-f,m.xmax=e+i*D;const O=Is(_,m,v,r,a);m.xmin=m.xmax,m.xmax=h.xmax+f;const U=Is(_,m,v,r,a);x.setShiftCoords((D-L)*i,0),U.applyTransformation(x),l===q.enumPolygon?_=new wL().execute(O,U,s,a):(_=O,_.add(U,!1)),_.queryEnvelope(h),h.queryIntervalX(d)}}m.xmin=e,m.xmax=e+i;const w=J.constructEmpty();w.setCoords({env2D:m}),w.inflateCoords(v,0);const T=Math.floor((h.xmin-m.xmin)/i)*i;let C;T?(m.move(T,0),x.setShiftCoords(-T,0)):x.setIdentity(),C=l===q.enumPolyline?new Qi({vd:_.getDescription()}):new Ci({vd:_.getDescription()});const M=J.constructEmpty(),A=J.constructEmpty();for(;h.xmax>m.xmin;){const I=Is(_,m,v,0,a);I.queryEnvelope(A);let L=!1;L=l===q.enumPolyline?!I.isEmpty()&&(A.width()>v||A.height()>v):!I.isEmpty()&&(l!==q.enumPolygon||A.width()>v),L&&(I.applyTransformation(x),I.queryEnvelope(A),C.queryEnvelope(M),M.inflateCoords(v,v),M.isIntersecting(A)&&l===q.enumPolygon?C=new wL().execute(C,I,s,a):C.add(I,!1)),m.move(i,0),x.shiftCoords(-i,0)}return C}function l3(t,e,i,s,n=!0){const r=new Me;r.setCoords(i,i+s);const o=[0];if(Array.isArray(t)){const a=t;for(let l=0;l<e;l++)r.containsRightExclusive(a[l].x)||(o[0]=a[l].x,EL(o,r,n),a[l].x=o[0])}else{const a=t;for(let l=0;l<e;l++){const u=l<<1;r.containsRightExclusive(a[u])||(o[0]=a[u],EL(o,r,n),a[u]=o[0])}}}function CL(t,e,i,s=!0){if(t.isEmpty())return;const n=t.getGeometryType();if(!s||n!==q.enumPolygon)if(ll(n)){let r=!1;if(Ei(n)&&t.hasNonLinearSegments()){const o=t.getImpl(),a=o.getAttributeStreamRef(0),l=o.getSegmentFlagsStreamRef();z(l!==null);for(let u=0,c=o.getPathCount();u<c;u++){let h=!0;const d=o.isClosedPath(u),m=o.getPathEnd(u);d&&o.getPathSize(u)>0&&(h=(31&l.read(m-1))===1);for(let f=o.getPathStart(u);f<m;f++)if((31&l.read(f))===1){if(h){const _=a.read(2*f),v=Pv(_,e,i);v!==_&&(r=!0,a.write(2*f,v))}h=!0}else h=!1}}else{const o=t.getImpl(),a=o.getAttributeStreamRef(0);for(let l=0,u=o.getPointCount();l<u;l++){const c=a.read(2*l),h=Pv(c,e,i);h!==c&&(r=!0,a.write(2*l,h))}}r&&t.getImpl().notifyModifiedFlags(2001)}else if(n===q.enumEnvelope){const r=t,o=J.constructEmpty();r.queryEnvelope(o),o.xmin=Pv(o.xmin,e,i),o.xmax=Pv(o.xmax,e,i),r.setEnvelope(o)}else if(n===q.enumPoint){const r=t;r.setX(Pv(r.getX(),e,i))}else We("")}function O5e(t,e,i){const s=new N;return s.x=Pv(t.x,e,i),s.y=t.y,s}function L5e(t,e){if(e.isEmpty())return 0;const i=t.getPECoordSys();if(i.getProjection().getCode()===$t.PE_PRJ_AZIMUTHAL_EQUIDISTANT){const s=H1();t.querySpheroidData(s);const n=i.getParameters();if(n[$t.PE_PARM_LAM0]===null||n[$t.PE_PARM_PHI0]===null)return 0;const r=[n[$t.PE_PARM_LAM0].getValue(),n[$t.PE_PARM_PHI0].getValue()];yo.geogToProj(i,1,r);const o=new N(r[0],r[1]),a=J.constructEmpty();e.queryEnvelope(a);const l=he(N,4);a.queryCorners(l);let u=0;const c=t.getOneMeter();let h=Math.max(s.majorSemiAxis,s.minorSemiAxis)*Math.PI,d=Math.min(s.majorSemiAxis,s.minorSemiAxis)*Math.PI;d-=h/180,h*=c,d*=c;for(let m=0;m<4;m++){const f=N.distance(l[m],o);if(f>h)u++;else if(f>d)return-1}if(u===0)return 1;if(u===4){const m=J.constructEmpty();return m.setCoords({center:o,width:h,height:h}),a.isIntersectingNe(m)?-1:0}return-1}return-1}function u3(t,e,i,s){const n=t.getGeometryType();z(n===q.enumPolygon||n===q.enumPolyline||n===q.enumMultiPoint);const r=e.getCoordinateSystemType();if(r===2){let o=t;if(i===0){const a=L5e(e,t);if(a===0)return t.createInstance();if(a===1)return t;const l=e.getPCSHorizon(),u=l.getGeometryType(),c=e.getDefaultPrecisionSR();if(u===q.enumEnvelope){const h=J.constructEmpty();l.queryEnvelope(h);const d=Vy(c,h,!1);o=Is(t,h,d,5e4*e.getOneMeterPCSUnit(),s)}else new bge().execute(l,t,c,s)||(o=new P1().execute(o,l,c,s),o===l&&(o=o.clone()))}else if(e.isPannable()){const a=J.constructEmpty();o.queryEnvelope(a);const l=e.getPannableExtent();l.containsEnvelope(a)||(CL(o,l,e.getTolerance(0)),i!==2&&i!==4||(o=nE(o,e)),i!==4?o=vS(o,e,0,!0,1e5*e.getOneMeterPCSUnit(),s):n===q.enumPolygon&&a.width()>2*l.width()&&(o=rM(o,-2*l.width(),2*l.width(),e,!0,0,!0,s)))}return o}if(z(r===1),n===q.enumMultiPoint)return CL(t,e.getPannableExtent(),e.getTolerance(0)),t;{const o=J.constructEmpty();t.queryEnvelope(o);let a=t;const l=e.getPannableExtent();if(o.ymin<l.ymin||o.ymax>l.ymax){const u=Math.max(1,o.calculateToleranceFromEnvelope()),c=new J(o.xmin-u,l.ymin,o.xmax+u,l.ymax);if(a=new _S().execute(a,c,e,s),a.isEmpty())return a}return n===q.enumPolygon&&o.width()>2*l.width()&&(a=rM(a,-2*l.width(),2*l.width(),e,!0,0,!0,s)),a}}function F5e(t,e,i,s,n,r){const o=s.getCoordinateSystemType();if(o===2){if(n===0)i!==t&&JO(i,t,e),P5e(s,i,e);else if(i!==t&&JO(i,t,e),s.isPannable()){const a=s.getTolerance(0);M5e(i,e,s.getPannableExtent(),a),wge(i,e,s,0)}}else{z(o===1);const a=s.getTolerance(0),l=s.getPannableExtent();for(let u=0;u<e;u++)i[u].assign(O5e(t[u],l,a))}}function k5e(t,e){const i=e.getPointCount();if(!i)return;const s=e.getImpl(),n=s.getAttributeStreamRef(0),r=t;yo.geogToProj(r,i,n.getArray()),s.notifyModifiedFlags(2001)}function g4(t,e,i,s){if(!i)return;const n=t.getPECoordSys();if(i===1){const h=[e[0].x,e[0].y];if(yo.geogToProj(n,1,h),s){const{first:d,second:m}=t.m_peCoordSysVal.getGeogToProjFactors();h[0]=d*(e[0].x-t.getCentralMeridian())+m}return void e[0].setCoords(h[0],h[1])}const r=t.isPannable(),o=r?t.getPannableExtent().width():0,a=179*o/360;let l=0;r&&(l=t.getCentralMeridian());const u=256,c=new Float64Array(2*u);for(let h=0;h<i;){for(let m=h;m<i&&e[m].isNAN();++m)h++;let d=Math.min(u,i-h);if(d>0){for(let m=1,f=h+1;m<d;++m,++f)if(e[f].isNAN()){d=m;break}for(let m=0;m<d;++m){const f=m<<1;c[f]=e[h+m].x,c[f+1]=e[h+m].y}if(yo.geogToProj(n,d,c),s){const{first:m,second:f}=t.m_peCoordSysVal.getGeogToProjFactors();for(let _=0;_<d;++_)c[_<<1]=m*(e[h+_].x-l)+f}if(r)for(let m=0,f=h;m<d;m++,f++){const _=m<<1,v=c[_],x=In(v),w=e[f].x-l;x*In(w)<0&&Math.abs(v)>a&&(c[_]-=x*o)}SB(c,e,h,d),h+=d}}}function $5e(t,e,i,s){const n=t.getSRToGCSTransform();return new Cd().transform(n,e,i,s,!1)}function U5e(t,e,i,s){const n=new Dn({vd:e.getDescription()});let r;n.addPoints(e,0,-1),r=new Cd().execute(n,t,s);const o=e.getPointCount();if(i.setEmpty(),t.getInputSR().isPannable()){if(o!==r.getPointCount())return!1;const a=new J;e.queryEnvelope(a);const l=new J;r.queryEnvelope(l);const u=a.width(),c=l.width();if(u!==0&&c!==0){const h=c/u,d=t.getOutputSR().getPannableExtent().width()/t.getInputSR().getPannableExtent().width();if(Math.abs(h/d-1)>1e-10)return!1}else if(u!==0||c!==0)return!1;i.add(e,!1);for(let h=0;h<o;h++){const d=r.getXY(h);i.setXY(h,d)}return!0}return!1}function Cge(t,e,i){z(!i||t.isPannable());const s=e.getPointCount();if(!s)return;const n=e.getImpl(),r=n.getAttributeStreamRef(0),o=t.getPECoordSys();let a=0;const l=r.readRange(0,2*s);let u=()=>{yo.geogToProj(o,s,l)};const c=t.isPannable()&&!i,h=c?t.getPannableExtent().width():0,d=179*h/360;if(t.isPannable()&&(a=t.getCentralMeridian(),i)){const m=t.m_peCoordSysVal.getGeogToProjFactors(),f=m.first,_=m.second;u=()=>{yo.geogToProj(o,s,l);for(let v=0;v<s;v++){const x=v<<1,w=r.read(x),T=f*(w-a)+_;l[x]=T}}}if(u(),c)for(let m=0;m<s;m++){const f=m<<1,_=l[f],v=In(_),x=r.read(f)-a;v*In(x)<0&&Math.abs(_)>d&&(l[f]+=-v*h)}r.writeRangeFromArray(0,2*s,l,!0,1),n.notifyModifiedFlags(2001)}function V5e(t,e,i){switch(e.getGeometryType()){case q.enumLine:return void tVe(t,e,i);case q.enumBezier:return void nVe(t,e,i);case q.enumEllipticArc:return void iVe(t,e,i);case q.enumBezier2:return void rVe();case q.enumRationalBezier2:return void oVe();default:We("")}}function fte(t,e,i){if(!e.hasNonLinearSegments())return void Cge(t,e,i);if(z(!i||t.isPannable()),e.isEmpty())return;const s=0,n=t.getPECoordSys(),r=t.isPannable(),o=r?t.getPannableExtent().width():0,a=179*o/360;let l=0;r&&(l=t.getCentralMeridian());const u=e.createInstance();u.reserveParts(e.getPointCount(),e.getPathCount());const c=e.getImpl(),h=new ii;for(let d=0,m=e.getPathCount();d<m;++d)if(c.hasNonLinearSegmentsPath(d)){let f=!0,_=-1;const v=c.getPathStart(d),x=v+c.getSegmentCountPath(d);c.isClosedPath(d)&&(_=x-1);const w=new N;for(let T=v;T<x;++T){if(c.getSegmentBuffer(T,h,!1),V5e(t,h.get(),i),!f&&(h.get().getStartXY().equals(w)||h.get().moveTo(w)),T!==_)u.addSegment(h.get(),f);else{if(f){const C=new Jt;h.get().queryStart(C),u.startPathPoint(C)}u.closeLastPathWithSegment(h.get())}w.assign(h.get().getEndXY()),f=!1}}else{let _,v=c.getPathSize(d),x=Math.min(v,1024);u.insertPath(-1,e,d,!0);const w=c.getAttributeStreamRef(0),T=u.getAttributeStreamRef(0);for(let C=c.getPathStart(d),M=c.getPathEnd(d);C<M;){if(_=w.readRange(C,x),yo.geogToProj(n,x,_),r)for(let A=0;A<x;A++){const I=A<<1,L=_[I],D=In(L),O=w.read(2*(s+A))-l;D*In(O)<0&&Math.abs(L)>a&&(_[I]+=-D*o)}T.writeRangeFromArray(C,x,_,!0,1),C+=x,v-=x,x=Math.min(v,1024)}}e.assignMove(u)}function Tge(t,e,i){let n=i.getPointCount();if(!n)return;const r=i.getImpl(),o=r.getAttributeStreamRef(0);let a=Math.min(n,1e3),l=0;const u=t.getPECoordSys();Number.isNaN(e)&&(e=0);const c=t.isPannable(),h=t.getOneDegreeGCSUnit(),d=360*h,m=179*h;let f;for(;n;){if(f=o.readRange(2*l,2*a),_4(u,a,f,e),c)for(let _=0;_<a;_++){const v=_<<1,x=f[v]-e,w=In(x),T=o.read(2*(l+_));w*In(T)<0&&Math.abs(x)>m&&(f[v]+=-w*d)}o.writeRangeFromArray(2*l,2*a,f,!0,1),l+=a,n-=a,a=Math.min(n,1e3)}r.notifyModifiedFlags(2001)}function z5e(t,e,i){switch(i.getGeometryType()){case q.enumLine:return void G5e(t,e,i);case q.enumBezier:return void H5e(t,e,i);case q.enumEllipticArc:return void B5e(t,e,i);case q.enumBezier2:return void j5e();case q.enumRationalBezier2:return void Y5e();default:We("")}}function G5e(t,e,i){const s=[i.getStartXY(),i.getEndXY()];y4(t,e,s,2),i.setStartXY(s[0]),i.setEndXY(s[1]),i.normalizeAfterEndpointChange()}function B5e(t,e,i){if(i.projectionBehavior()===0)q5e(t,e,i);else{const s=i.isClosed()&&i.isMajor(),n=[i.getStartXY(),s?i.getCenter():i.getEndXY()],r=[n[0].clone(),n[1].clone()];_j(t,e,r,2);const o=new Gi;o.initializeFromTwoPointsArray(n,r),i.applyTransformation(o);const a=s?0:1;i.setCoordsForIntersector(r[0],r[a],!1)}}function q5e(t,e,i){Dge(!1,t,e,i,!1)}function H5e(t,e,i){const s=he(N,4);i.queryControlPoints(s),_j(t,e,s,4),i.setControlPoints(s)}function j5e(t,e,i){z(0)}function Y5e(t,e,i){z(0)}function _4(t,e,i,s){const n=yo.projToGeogCenter(t,e,i,s);for(let r=0;r<e;++r){const o=r<<1;z(Number.isFinite(i[o]+i[o+1]))}return n}function XD(t,e,i){if(!i.hasNonLinearSegments())return void Tge(t,e,i);if(i.isEmpty())return;const s=t.getPECoordSys();Number.isNaN(e)&&(e=0);const n=t.isPannable(),r=t.getOneDegreeGCSUnit(),o=360*r,a=179*r,l=i.createInstance();l.reserveParts(i.getPointCount(),i.getPathCount());const u=i.getImpl(),c=new ii;for(let h=0,d=i.getPathCount();h<d;++h)if(u.hasNonLinearSegmentsPath(h)){let m=!0,f=-1;const _=u.getPathStart(h),v=_+u.getSegmentCountPath(h);u.isClosedPath(h)&&(f=v-1);const x=new N;for(let w=_;w<v;++w){if(u.getSegmentBuffer(w,c,!1),z5e(t,e,c.get()),!m&&(c.get().getStartXY().equals(x)||c.get().moveTo(x)),w!==f)l.addSegment(c.get(),m);else{if(m){const T=new Jt;c.get().queryStart(T),l.startPathPoint(T)}l.closeLastPathWithSegment(c.get())}x.assign(c.get().getEndXY()),m=!1}}else{let f,_=u.getPathSize(h),v=Math.min(_,1e3);l.insertPath(-1,i,h,!0);const x=u.getAttributeStreamRef(0),w=l.getAttributeStreamRef(0);for(let T=u.getPathStart(h),C=u.getPathEnd(h);T<C;){if(f=x.readRange(2*T,2*v),_4(s,v,f,e),n)for(let M=0;M<v;M++){const A=M<<1,I=f[A]-e,L=In(I),D=x.read(2*T);L*In(D)<0&&Math.abs(I)>a&&(f[A]+=-L*o)}w.writeRangeFromArray(2*T,2*v,f,!0,1),T+=v,_-=v,v=Math.min(_,1e3)}}i.assignMove(l)}function y4(t,e,i,s){const n=t.getPECoordSys();Number.isNaN(e)&&(e=0);const r=t.isPannable(),o=t.getOneDegreeGCSUnit(),a=360*o,l=179*o,u=256,c=new Float64Array(2*u);for(let h=0;h<s;){for(let m=h;m<s&&i[m].isNAN();++m)h++;let d=Math.min(u,s-h);if(d>0){for(let m=1,f=h+1;m<d;++m,++f)if(i[f].isNAN()){d=m;break}for(let m=0;m<d;m++){const f=m<<1;c[f]=i[h+m].x,c[f+1]=i[h+m].y}if(_4(n,d,c,e),r)for(let m=0,f=h;m<d;++m,++f){const _=m<<1,v=i[f].x,x=c[_]-e,w=In(x);w*In(v)<0&&Math.abs(x)>l&&(c[_]-=w*a)}for(let m=0;m<d;m++){const f=m<<1;i[h+m].x=c[f],i[h+m].y=c[f+1]}h+=d}}}function Pge(t,e,i,s){z(0)}function Mge(t,e,i){let s=e.getPointCount();if(!s)return!1;const n=e.getImpl(),r=n.getAttributeStreamRef(0);let o=null;const a=t.getInputSR(),l=t.getOutputSR();a.getVCS(),l.getVCS();const u=a.getOneDegreeGCSUnit(),c=l.getOneDegreeGCSUnit(),h=t.isVertical();h&&e.hasAttribute(1)&&(o=n.getAttributeStreamRef(1));const d=t.getDatumTransformation(),m=!!d&&d.getType()===1;if(m||o===null||(Pge(o.getArray()),o=null),!d||d.count()===0){const O=a.getGcsUnitFactor()/l.getGcsUnitFactor(),U=(a.getPrimeMeridian()-l.getPrimeMeridian())*c,$=-90*u,B=90*u;let V=0;const H=r.getArray(),Y=[0];for(let W=1,ee=2*s;W<ee;)Y[0]=H[W],V|=yG(Y,$,B)?1:0,H[W]=Y[0],W+=2;if(U!==0||O!==1){V=1;const W=r.getArray();for(let ee=0,ne=2*s;ee<ne;){let j=W[ee];j*=O,j+=U,W[ee]=j,W[ee+1]*=O,ee+=2}}return V!==0&&n.notifyModifiedFlags(2001),!!V}const f=1e3;let _=Math.min(s,f);const v=st(_,Number.NaN),x=st(_,Number.NaN);let w=null;o!==null&&(w=new Float64Array(_));let T=0,C=Number.NaN,M=Number.NaN;const A=360*c,I=c/u;i&&(M=90*c,C=89.9*u,x.fill(0));let L=!0,D=0;for(;s;){let O=!1;const U=r.readRange(2*T,2*_);for(let B=0;B<_;B++)v[B]=U[B<<1];if(i)for(let B=0;B<_;B++){const V=1+(B<<1),H=Math.abs(U[V])-C;if(H>0){const Y=U[V];U[V]=kf(C,Y),x[B]=kf(H,Y),O=!0}}const $=U[0];if(m){const B=d;w&&o.queryRange(T,_,w,!0,1),B.transform(!1,U,w,_),w&&o.writeRangeFromArray(T,_,w,!0,1)}else d.transform(!1,U,_);L&&(D=U[0]-I*$,L=!1);for(let B=0;B<_;B++){const V=B<<1,H=U[V]-v[B]*I-D;Math.abs(H)>200&&(U[V]+=H>0?-A:A)}if(O){for(let B=0;B<_;B++)if(x[B]){const V=1+(B<<1);U[V]+=I*x[B],U[V]>M?U[V]=M:U[V]<-M&&(U[V]=-M)}x.fill(0)}r.writeRangeFromArray(2*T,2*_,U,!0,1),h&&o&&o.writeRangeFromArray(T,_,w,!0,1),T+=_,s-=_,_=Math.min(s,f)}return n.notifyModifiedFlags(2001),!0}function X5e(t,e,i){switch(e.getGeometryType()){case q.enumLine:return W5e(t,e,i);case q.enumBezier:return Q5e(t,e,i);case q.enumEllipticArc:return Z5e(t,e,i);case q.enumBezier2:return J5e();case q.enumRationalBezier2:return eVe();default:We("")}}function WD(t,e,i){if(!e.hasNonLinearSegments())return Mge(t,e,i);if(e.isEmpty())return!1;const s=e.createInstance();s.reserveParts(e.getPointCount(),e.getPathCount());const n=e.getImpl(),r=new ii;for(let o=0,a=e.getPathCount();o<a;++o){let l=!0,u=-1;const c=n.getPathStart(o),h=c+n.getSegmentCountPath(o);n.isClosedPath(o)&&(u=h-1);const d=new N;for(let m=c;m<h;++m){if(n.getSegmentBuffer(m,r,!1),X5e(t,r.get(),i),!l&&(r.get().getStartXY().equals(d)||r.get().moveTo(d)),m!==u)s.addSegment(r.get(),l);else{if(l){const f=new Jt;r.get().queryStart(f),s.startPathPoint(f)}s.closeLastPathWithSegment(r.get())}d.assign(r.get().getEndXY()),l=!1}}return e.assignMove(s),!0}function gte(t,e,i,s,n,r){if(t.isIdentityGeogToGeog()){const $=90*t.getInputSR().getOneDegreeGCSUnit();let B=0;const V=[0];for(let H=0;H<s;H++)V[0]=e[H].y,B|=yG(V,-$,$)?1:0,e[H].y=V[0];return B}const o=t.getInputSR(),a=t.getOutputSR(),l=o.getVCS(),u=a.getVCS(),c=o.getOneDegreeGCSUnit(),h=90*c,d=a.getOneDegreeGCSUnit(),m=t.isVertical(),f=t.getDatumTransformation(),_=!!f&&f.getType()===1;if(m||(i=null),!f||f.count()===0){let $=0;const B=[0];for(let V=0;V<s;V++)B[0]=e[V].y,$|=yG(B,-h,h)?1:0,e[V].y=B[0];return $|=vge(o.getGCS(),l,a.getGCS(),u,e,i,s)?1:0,$}_||i===null||Pge();const v=1024;let x=Math.min(s,v);const w=st(x,Number.NaN),T=st(x,Number.NaN);let C=0,M=Number.NaN,A=Number.NaN;const I=360*d,L=d/c;n&&(A=90*d,M=89.9*c);let D=!0,O=0,U=s;for(;U;){let $=!1;for(let V=0;V<x;V++)w[V]=e[V+C].x;if(n)for(let V=0;V<x;V++){const H=Math.abs(e[V+C].y)-M;if(H>0){const Y=e[V+C].y;e[V+C].y=kf(M,Y),T[V]=kf(H,Y),$=!0}}const B=e[0].x;_?f.transform(!1,e,i,x):f.transform(!1,e,x),D&&(O=e[0].x-L*B,D=!1);for(let V=0;V<x;V++){const H=e[C+V].x-w[V]*L-O;Math.abs(H)>200&&(H>0?e[C+V].x-=I:e[C+V].x+=I)}if($){for(let V=0;V<x;V++)T[V]&&(e[C+V].y+=L*T[V],e[C+V].y>A?e[C+V].y=A:e[C+V].y<-A&&(e[C+V].y=-A));T.fill(0,0,x)}C+=x,U-=x,x=Math.min(U,v)}return 1}function Age(t,e,i,s,n){return z(0),0}function Ige(t,e,i,s,n){z(s===null),z(e<2147483647);const r=Array.isArray(i);let o;o=r?I3e(i):i;const a=DB.geogToGeog(t,e,o,null,n);return r&&A3e(o,i),a}function M1(t,e,i,s,n,r){let o=0,a=!0,l=0;for(let u=0;u<s;++u)e[u].isNAN()?a||(o|=gte(t,e.slice(l,u-l),i?i.slice(l,u-l):null,u-l,n),l=u,a=!0):a&&(l=u,a=!1);return a||(o|=gte(t,l===0?e:e.slice(l),i?l===0?i:i.slice(l):null,s-l,n)),o!==0}function W5e(t,e,i){const s=[e.getStartXY(),e.getEndXY()],n=[0,0];let r=null;e.hasAttribute(1)&&(r=n,r[0]=e.getAttributeAsDbl(0,1,0),r[1]=e.getAttributeAsDbl(1,1,0));const o=M1(t,s,r,2,i);return e.setStartXY(s[0]),e.setEndXY(s[1]),r&&(e.setStartAttribute(1,0,r[0]),e.setEndAttribute(1,0,r[1])),e.normalizeAfterEndpointChange(),o}function Z5e(t,e,i){if(e.projectionBehavior()===0)return K5e(t,e,i);const s=e.getStartXY().equals(e.getEndXY()),n=he(N,3),r=he(N,3),o=[0,0,0];let a=null;n[0].assign(e.getStartXY()),n[1].assign(s?e.getCenter():e.getEndXY());let l=!1;e.hasAttribute(1)&&(a=o,a[0]=e.getAttributeAsDbl(0,1,0),a[1]=e.getAttributeAsDbl(1,1,0),a[2]=es(a[0],a[1],.5),s&&(a[1]=a[2])),r[0].setCoordsPoint2D(n[0]),r[1].setCoordsPoint2D(n[1]);const u=new Gi;if(s||e.isDegenerateToLine())l=M1(t,r,a,2,i),u.initializeFromTwoPoints(n[0],n[1],r[0],r[1]);else{const c=new N;e.queryCoord2D(.5,c),n[2].setCoordsPoint2D(c),r[2].setCoordsPoint2D(c),l=M1(t,r,a,3,i),u.setFromTwoTriangles(n,r)}return u.isIdentity()||(e.applyTransformation(u),e.setStartXY(r[0]),e.setEndXY(s?r[0]:r[1]),e.normalizeAfterEndpointChange()),a&&(e.setStartAttribute(1,0,a[0]),e.setEndAttribute(1,0,s?a[0]:a[1])),l}function K5e(t,e,i){const s=[e.getStartXY(),e.getEndXY(),e.getInteriorPoint(),e.getCenter()];let n=4;e.isDegenerateToLine()&&(n=2);const r=[0,0,0,0];let o=null;if(e.hasAttribute(1)){o=r,o[0]=e.getAttributeAsDbl(0,1,0),o[1]=e.getAttributeAsDbl(1,1,0);const u=es(o[0],o[1],.5);o[2]=u,o[3]=u}const a=e.getStartXY().equals(e.getEndXY())&&!e.isDegenerateToLine(),l=M1(t,s,o,n,i);return a?e.constructCircleCenterAndPoint(s[3],s[0],!e.isClockwise()):e.isDegenerateToLine()?e.constructLineCircularArc(s[0],s[1]):e.constructCircularArcThreePoint(s[0],s[1],s[2]),o&&(e.setStartAttribute(1,0,o[0]),e.setEndAttribute(1,0,o[1])),l}function Q5e(t,e,i){const s=he(N,4);e.queryControlPoints(s);const n=[0,0,0,0];let r=null;e.hasAttribute(1)&&(r=n,r[0]=e.getAttributeAsDbl(0,1,0),r[3]=e.getAttributeAsDbl(1,1,0),r[1]=es(r[0],r[3],.5),r[2]=r[1]);const o=M1(t,s,r||null,s.length,i);return e.setControlPoints(s),r&&(e.setStartAttribute(1,0,r[0]),e.setEndAttribute(1,0,r[3])),e.normalizeAfterEndpointChange(),o}function J5e(t,e,i){return z(0),!1}function eVe(t,e,i){return z(0),!1}function tVe(t,e,i){const s=[e.getStartXY(),e.getEndXY()];g4(t,s,2,i),e.setStartXY(s[0]),e.setEndXY(s[1]),e.normalizeAfterEndpointChange()}function gj(t,e,i,s){g4(t,e,i,s)}function iVe(t,e,i){if(e.projectionBehavior()===0)sVe(t,e,i);else{const s=e.isClosed()&&e.isMajor(),n=[e.getStartXY(),s?e.getCenter():e.getEndXY()],r=[n[0].clone(),n[1].clone()];gj(t,r,2,i);const o=new Gi;o.initializeFromTwoPointsArray(n,r),e.applyTransformation(o);const a=s?0:1;e.setCoordsForIntersector(r[0],r[a],!1)}}function _j(t,e,i,s){y4(t,e,i,s);const n=new J;n.setFromPoints(i,s);const r=t.getOneDegreeGCSUnit(),o=360*r,a=180*r;if(n.width()>a){for(let l=0;l<s;l++)for(;i[l].x<e;)i[l].x+=o;if(n.setFromPoints(i,s),n.xmax>a+e)for(let l=0;l<s;l++)i[l].x-=o}}function Dge(t,e,i,s,n){const r=he(N,3);let o=0,a=!1,l=!1;const u=s.isDegenerateToLine();u?(r[0].assign(s.getStartXY()),r[1].assign(s.getEndXY()),r[2].setCoords(0,0),o=2):s.isClosed()&&s.isMajor()?(a=!0,l=!s.isClockwise(),r[0].assign(s.getStartXY()),r[1].assign(s.getCenter()),r[2].setCoords(0,0),o=2):(r[0].assign(s.getStartXY()),r[1].assign(s.getEndXY()),r[2].assign(s.getInteriorPoint()),o=3),t?gj(e,r,o,n):_j(e,i,r,o),u?s.constructLineCircularArc(r[0],r[1]):a?s.constructCircleCenterAndPoint(r[1],r[0],l):s.constructCircularArcThreePoint(r[0],r[1],r[2])}function sVe(t,e,i){Dge(!0,t,0,e,i)}function nVe(t,e,i){const s=he(N,4);e.queryControlPoints(s),gj(t,s,4,i),e.setControlPoints(s)}function rVe(t,e,i){z(0)}function oVe(t,e,i){z(0)}function ZU(t,e,i){const s=s3(t),n=s3(e),r=eee(s,n),o=eee(s,s3(i));return o===0||r>0&&o>0&&o<=r||r<0&&o<0&&o>=r}function aVe(t,e,i,s,n){const r={stack:[],error:void 0,hasError:!1};try{const o=i.clone(),a=s.clone();if(n===2){const v=[0,0];return wfe(t,e,o,a,0,v),v[0]}if(o.y>a.y){const v=new N;v.assign(o),o.assign(a),a.assign(v)}const l=Da(r,new Lo,!1),u=Da(r,new Lo,!1),c=Da(r,new Lo,!1),h=new Me;if(h.setCoords(o.y,a.y),!h.containsCoordinate(0)||Math.abs(o.x-a.x)>=Math.PI)return Number.NaN;if(o.x===a.x)return o.x;zl.geodeticDistance(t,e,o.x,o.y,a.x,a.y,u,l,null,n);const d=u.val;let m=0,f=1;const _=o.clone();for(;d*(f-m)>1e-12*t;){const v=.5*(m+f);if(zl.geodeticCoordinate(t,e,o.x,o.y,d*v,l.val,u,c,n),_.x=u.val,_.y=c.val,h.setCoords(o.y,_.y),_.y===0)return _.x;if(h.containsCoordinate(0))f=v;else{if(h.setCoords(a.y,_.y),!h.containsCoordinate(0))return z(!1),Number.NaN;m=v}}return _.x}catch(o){r.error=o,r.hasError=!0}finally{Hf(r)}}function _te(t,e,i,s){const n=new Me;n.setCoords(e,i);const r=s.width();let o=Math.floor((t-e)/r)*r+t;const a=n.getCenter();for(;Math.abs(o-a)>Math.abs(o+r-a);)o+=r;return o}class Nge extends Pd{constructor(){super(),this.m_geometryDeque=[],this.m_index=-1}next(){if(this.m_geometryDeque.length>0){this.m_index++;const e=this.m_geometryDeque[0];return this.m_geometryDeque.shift(),e}return null}getGeometryID(){return this.m_index}tick(e){this.m_geometryDeque.push(e)}tock(){return!0}getRank(){return 1}}function lVe(t,e){return t===e||t!==null&&e!==null&&t.m_csType===e.m_csType&&(t.m_WKID===0&&e.m_WKID===0?t.m_hashCode===e.m_hashCode&&t.m_canonicalWkt===e.m_canonicalWkt:t.m_WKID===e.m_WKID)}function uVe(t,e){return t===e||t!==null&&e!==null&&t.m_csType===e.m_csType&&(t.m_WKID===0&&e.m_WKID===0?t.m_csType===1?t.m_peCoordSys.isEqual(e.m_peCoordSys):t.m_peCoordSys===e.m_peCoordSys:t.m_WKID===e.m_WKID)}class yj{constructor(e,i=!0){this.m_PCSHorizon=null,this.m_GCSHorizon=null,this.m_GCSSplitLines=null,this.m_bGCSHorisonIsInclusive=!1,this.m_oneMeterPCS=0,this.m_oneDegreeGCS=0,this.m_gcsUnitFactor=0,this.m_northPole=N.getNAN(),this.m_southPole=N.getNAN(),this.m_polesUpdated=0,this.m_domain=J.constructEmpty(),this.m_primeMeridian=Number.NaN,this.m_geogToProjFactor=1,this.m_geogToProjOffset=0,this.m_geogToProjFactorsUpdated=0,this.m_oneMillimeter=0,this.m_centralMeridian=0,this.m_pPCSInfoNoDomain=null,this.m_oldWKID=-1973,this.m_vcsWKID=-1,this.m_bIsPannable=!1,this.m_bCached=!1,this.m_pannableExtent=J.constructEmpty(),this.m_pannableExtentGCS=J.constructEmpty(),this.m_areaOfUse=null,this.m_canonicalWkt="",this.m_peCoordSys=e,this.m_WKID=xr.getCode(e),this.m_WKID<=0?(this.m_WKID=0,this.m_canonicalWkt=fj(e,0,!0),this.m_hashCode=npe(this.m_canonicalWkt)):this.m_hashCode=Tw(this.m_WKID);const s=this.m_peCoordSys.getType();this.m_csType=s===$t.PE_TYPE_PROJCS?2:1,z(s===$t.PE_TYPE_PROJCS||s===$t.PE_TYPE_GEOGCS),s===$t.PE_TYPE_PROJCS&&(e.loadConstants()||ce("PeProjcs.loadConstants failed"));const n=s===$t.PE_TYPE_GEOGCS?this.m_peCoordSys:this.m_peCoordSys.getGeogcs();s!==$t.PE_TYPE_GEOGCS&&xr.getCode(n),this.m_unit=c4e(e),this.m_primeMeridian=n.getPrimem().getLongitude();{const r=n.getUnit().getUnitFactor();this.m_gcsUnitFactor=r;let o=Math.PI/(180*r);Math.abs(o-1)<1e-10&&(o=1),this.m_oneDegreeGCS=o}if(s===$t.PE_TYPE_PROJCS){const r=this.m_peCoordSys,o=r.getUnit().getUnitFactor();this.m_oneMeterPCS=1/o,this.m_oneMillimeter=.001/o,this.m_pPCSInfoNoDomain=_o.generate(r,_o.PE_PCSINFO_OPTION_NONE),this.m_pPCSInfoNoDomain||We("cannot create pcs info"),this.m_bIsPannable=this.m_pPCSInfoNoDomain.isPannableRectangle(),this.m_centralMeridian=this.m_pPCSInfoNoDomain.getCentralMeridian()}else{this.m_bIsPannable=!0,this.m_polesUpdated=1,this.m_oneMeterPCS=0;const r=1/n.getUnit().getUnitFactor(),o=n.getDatum().getSpheroid().getAxis();this.m_oneMillimeter=.001/o*r,this.m_centralMeridian=0}this.m_bIsPannable&&(this.updateGCSHorizon(),this.updatePCSHorizon(),this.updatePoles(),this.updateDomain(),this.updatePannableExtent(),this.updatePannableExtentGCS())}[Symbol.dispose](){}getHashCode(){return this.m_hashCode}getPCSHorizonPannable(){return this.m_PCSHorizon}getGCSHorizonPannable(){return this.m_GCSHorizon}getPCSInfo(){return z(this.m_pPCSInfoNoDomain),this.m_pPCSInfoNoDomain}getCentralMeridian(){return this.m_centralMeridian}updateGCSHorizon(){if(this.m_peCoordSys.getType()!==$t.PE_TYPE_PROJCS)return;let e=!0;const i=this.m_peCoordSys,s=i.getGeogcs(),n=i.horizonGcsGenerate();if(!n)return;z(n.length>0);const r=n[0].getNump(),o=n[0].getKind();let a,l;e=n[0].getInclusive()>0;const u=this.getOneDegreeGCSUnit(),c=90*u,h=360*u,d=370*u,m=180*u*$t.PE_HORIZON_DELTA/Math.PI,f=J.constructEmpty();let _=null;if(r>1){for(let v=1;v<r;v++)if(n[v].getKind()===$t.PE_HORIZON_LINE){_||(_=new Qi);const x=n[v].getCoord();_.startPathCoords(x[0][0],x[0][1]),_.lineToCoords(x[1][0],x[1][1])}}if(o===$t.PE_HORIZON_RECT){const v=n[0].getCoord();if(f.setFromPoints([new N(v[0][0],v[0][1]),new N(v[1][0],v[1][1])],2),Math.abs(f.ymax-c)<1e-7*m&&(f.ymax=c),Math.abs(f.ymin+c)<1e-7*m&&(f.ymin=-c),f.width()>d){const w=-400*u,T=w+5*h;f.setCoords({xmin:w,ymin:f.ymin,xmax:T,ymax:f.ymax})}const x=new Fo({env2D:f});this.m_GCSHorizon||(this.m_GCSHorizon=x,this.m_bGCSHorisonIsInclusive=e)}else{let v=this.getPCSInfo().isGcsHorizonMultiOverlap();const x=aM(s,null,null,1),w=[],T=new Me;for(let L=0;L<r;L++){if(n[L].getKind()!==$t.PE_HORIZON_POLY)continue;a=n[L].getSize();const D=n[L].getCoord(),O=J.constructEmpty();O.setFromPoints($x(D),a),w.push(new Me(O.xmin,O.xmax)),O.width(),T.merge(w.at(-1))}let C=!1;const M=new Me;T.width()>h&&w.length>1?(M.vmin=this.getCentralMeridian()-h,M.vmax=M.vmin+2*h,C=!0,v=!0):(M.vmin=T.vmin,M.vmax=M.vmin+h);const A=L=>{let D=0;for(;w[L].vmin+D<M.vmin;)D+=h;for(;w[L].vmax+D-h>M.vmin;)D-=h;return D};let I=new Ci;if(v){const L=new Nge,D=new wL().executeMany(L,x,null);for(let O=0;O<r;O++){if(n[O].getKind()!==$t.PE_HORIZON_POLY)continue;a=n[O].getSize();const U=n[O].getCoord();l=n[O].getInclusive()>0;const $=new Ci;if($.addPathPoint2D($x(U),a-1,!0),C){const B=A(O),V=w[O].clone();V.move(B);let H=B;const Y=new Gi;do{Y.setShiftCoords(H,0);const W=$.clone();W.applyTransformation(Y),L.tick(W),L.tock(),H+=h,V.move(h)}while(V.vmin<M.vmax)}else L.tick($),D.tock()}I=D.next()}else{I=new Ci;for(let L=0;L<r;L++){if(n[L].getKind()!==$t.PE_HORIZON_POLY)continue;a=n[L].getSize();const D=n[L].getCoord();if(l=n[L].getInclusive()>0,z(l===e),C){const O=new Ci;O.addPathPoint2D($x(D),a-1,!0);const U=A(L),$=w[L].clone();$.move(U);let B=U;const V=new Gi;do{if(B!==0){V.setShiftCoords(B,0);const H=new Ci({copy:O});H.applyTransformation(V),I.addPath(H,0,!0)}else I.addPath(O,0,!0);B+=h,$.move(h)}while($.vmin<M.vmax)}else I.addPathPoint2D($x(D),a-1,!0)}}C&&(I=new _S().execute(I,new J(M.vmin,-c-u,M.vmax,c+u),x,null)),e?new P1().accelerateGeometry(I,x,1):new f4().accelerateGeometry(I,x,1),new pj().accelerateGeometry(I,x,1),this.m_GCSHorizon===null&&(this.m_GCSHorizon=I,this.m_bGCSHorisonIsInclusive=e,this.m_GCSSplitLines=_)}}updateAreaOfUse(){return null}updatePCSHorizon(){if(this.m_peCoordSys.getType()!==$t.PE_TYPE_PROJCS)return;const e=this.m_peCoordSys.horizonPcsGenerate();if(!e)return;let i;this.getPCSInfo();const s=e[0].getKind();e[0].getInclusive();const n=J.constructEmpty(),r=e[0].getNump();let o=!1;if(s===$t.PE_HORIZON_RECT){const a=e[0].getCoord();n.setFromPoints($x(a),2),i=new Fo({env2D:n})}else{let a=-1;for(let h=0;h<r;h++)e[h].getKind()===$t.PE_HORIZON_POLY&&(a=h);z(a>=0);const l=e[a].getSize()-1,u=e[a].getCoord(),c=new Ci;i=c,c.addPathPoint2D($x(u),l,!0),o=!0}if(this.getPCSInfo().isDensificationNeeded()){z(s!==$t.PE_HORIZON_RECT);const a=1e5*this.getOneMeterPCSUnit();i=new Tv().execute(i,a,0,0,null)}if(o){{const a=new Fo;i.queryEnvelope(a),i.calculateArea2D(),i.calculateLength2D(),i.getExteriorRingCount()}new P1().accelerateGeometry(i,null,1)}this.m_PCSHorizon===null&&(this.m_PCSHorizon=i)}updatePannableExtent(){const e=this.m_peCoordSys.getType();if(e===$t.PE_TYPE_PROJCS){const i=this.m_peCoordSys,s=this.getPCSInfo().getCentralMeridian(),n=i.getGeogcs();n||We("");const r=[s+1/n.getUnit().getUnitFactor()*Math.PI,0];yo.geogToProj(i,1,r);const o=r[0],a=i.getParameters()[$t.PE_PARM_X0].getValue(),l=this.getPCSHorizon(),u=J.constructEmpty();l.queryEnvelope(u);const c=Math.abs(o-a),h=c+a,d=-1*c+a,m=u.ymax,f=u.ymin;this.m_pannableExtent.setCoords({xmin:d,ymin:f,xmax:h,ymax:m})}else if(e===$t.PE_TYPE_GEOGCS){const i=1/this.m_peCoordSys.getUnit().getUnitFactor()*Math.PI;this.m_pannableExtent.setCoords({xmin:-i,ymin:-i/2,xmax:i,ymax:i/2})}else We("")}updatePannableExtentGCS(){const e=this.m_peCoordSys.getType();if(e===$t.PE_TYPE_PROJCS){const i=this.m_peCoordSys,s=this.m_centralMeridian,n=i.getGeogcs();n||We("");const r=1/n.getUnit().getUnitFactor()*Math.PI,o=this.getGCSHorizon(),a=J.constructEmpty();o.queryEnvelope(a),this.m_pannableExtentGCS.setCoords({xmin:s-r,ymin:a.ymin,xmax:s+r,ymax:a.ymax})}else if(e===$t.PE_TYPE_GEOGCS){const i=1/this.m_peCoordSys.getUnit().getUnitFactor()*Math.PI;this.m_pannableExtentGCS.setCoords({xmin:-i,ymin:-i/2,xmax:i,ymax:i/2})}else We("")}updateDomain(){if(this.m_csType===1){const e=400*this.getOneDegreeGCSUnit();this.m_domain=J.construct(-e,-e,e,e)}else{z(this.m_csType===2);const e=_o.generate(this.m_peCoordSys,_o.PE_PCSINFO_OPTION_DOMAIN);e||We("generate pcs info failed");const i=new J(e.getDomainMinx(),e.getDomainMiny(),e.getDomainMaxx(),e.getDomainMaxy());this.m_domain.isEmpty()&&this.m_domain.setCoords({env2D:i})}}updatePoles(){if(this.m_peCoordSys.getType()===$t.PE_TYPE_PROJCS){const e=90*this.getOneDegreeGCSUnit(),i=[[0,e],[0,-e]];yo.geogToProj(this.m_peCoordSys,2,i);const s=this.getPCSInfo().getNorthPoleLocation()!==_o.PE_POLE_OUTSIDE_BOUNDARY,n=this.getPCSInfo().getSouthPoleLocation()!==_o.PE_POLE_OUTSIDE_BOUNDARY;this.m_polesUpdated||(s&&this.m_northPole.setCoords(i[0][0],i[0][1]),n&&this.m_southPole.setCoords(i[1][0],i[1][1]),this.m_polesUpdated=1)}else this.m_polesUpdated=1}updateGeogToProjFactors(){if(this.m_peCoordSys.getType()===$t.PE_TYPE_PROJCS){const e=this.getOneDegreeGCSUnit(),i=this.m_pPCSInfoNoDomain.getCentralMeridian(),s=[0,0,0,0];s[0]=i,s[1]=0,s[2]=i+e,s[3]=0;const n=yo.geogToProj(this.m_peCoordSys,2,s);z(n===2);const r=(s[2]-s[0])/e,o=s[0];this.m_geogToProjFactorsUpdated===0&&(this.m_geogToProjFactor=r,this.m_geogToProjOffset=o,this.m_geogToProjFactorsUpdated=1)}else this.m_geogToProjFactorsUpdated=1}getOneMeterPCSUnit(){return this.m_oneMeterPCS}getOneDegreeGCSUnit(){return this.m_oneDegreeGCS}getGcsUnitFactor(){return this.m_gcsUnitFactor}getUnitsPerMillimeter(){return this.m_oneMillimeter}getGCSSplitLines(){return this.m_bIsPannable?null:(this.m_GCSHorizon||this.updateGCSHorizon(),this.m_GCSSplitLines)}getGCSHorizon(){return this.m_bIsPannable?this.getGCSHorizonPannable():(this.m_GCSHorizon!==null||this.updateGCSHorizon(),this.m_GCSHorizon)}getGCSHorisonIsInclusive(){return this.m_bIsPannable||this.getGCSHorizon(),this.m_bGCSHorisonIsInclusive}getPCSHorizon(){return this.m_bIsPannable?this.getPCSHorizonPannable():(this.m_PCSHorizon!==null||this.updatePCSHorizon(),this.m_PCSHorizon)}getPole(e){return this.m_bIsPannable||this.m_polesUpdated!==0||this.updatePoles(),e?this.m_southPole:this.m_northPole}getGeogToProjFactors(){return this.m_geogToProjFactorsUpdated===0&&this.updateGeogToProjFactors(),gr(this.m_geogToProjFactor,this.m_geogToProjOffset)}getDomainXY(){if(this.m_bIsPannable)return this.m_domain.clone();let e=!1;return e=this.m_domain.isEmpty(),e&&this.updateDomain(),this.m_domain.clone()}getPrimeMeridian(){return this.m_primeMeridian}getLatestID(){return this.m_WKID}getOldID(){let e=this.m_oldWKID;if(e<0){if(e=0,this.m_WKID>0){const i=[0],s=[0];$Ve(this.m_peCoordSys.getType(),this.m_WKID,i,s)||We("query_code_change"),e=i[0]}this.m_oldWKID=e}return e}isCustomWkid(){return!1}isPannable(){return this.m_bIsPannable}getPannableExtent(){return this.m_pannableExtent.clone()}getPannableExtentGCS(){return this.m_pannableExtentGCS.clone()}getAreaOfUse(){return this.m_areaOfUse!==null?this.m_areaOfUse:this.updateAreaOfUse()}getVcsCode(){return 0}saveMemory(){}getCSType(){return this.m_csType}getUnit(){return this.m_unit}setCached(){this.m_bCached=!0}getCached(){return this.m_bCached}static equal(e,i){return!1}static equal_for_projection(e,i){return!1}}class cVe{constructor(e,i=!0){this.m_oneMeter=0,this.m_WKID=-1,this.m_oldWKID=-1,this.m_canonicalWkt="not yet implemented",this.m_model=0,this.m_unit=new $f,this.m_cached=!1}setCached(e=!0){this.m_cached=e}getCached(){return this.m_cached}getOneMeterUnit(){return 0}getLatestID(){return this.m_WKID}getOldID(){let e=this.m_oldWKID;return e<0&&(e=0,this.m_WKID>0&&(e=this.m_WKID),this.m_oldWKID=e),e}getModel(){return 0}isCustomWkid(){return!1}getVerticalUnit(){return this.m_unit}static equal(e,i){return!1}static equal_for_projection(e,i){return!1}}function hVe(t,e,i){return Rge(t,e,J.constructEmpty(),i)}function Rge(t,e,i,s){return dVe(!0,t,e,i,s)}function Qv(t,e,i,s){return vj(!0,t,e,i,s)}function dVe(t,e,i,s,n){return gc()||XF("cannot create projection transformation"),e.hasVCS()&&i.hasVCS()?mVe():pVe(e,i,s,n)}function vj(t,e,i,s,n,r){return gc()||XF("cannot create projection transformation"),new wj(t?2:1,e,i,s,n,r)}function Oge(t,e,i,s,n,r=!1){if(e&&i||ce(""),gc()||XF("cannot obtain geotransformation list"),t===1&&e.hasVCS()&&i.hasVCS())return _i("hv xform not impl"),[];{const o=jge(e,i,s,n,r),a=[];for(const l of o)a.push(l);return a}}function xj(){return{centralMeridianOfOutputGCS:Number.NaN,densificationStep:Number.NaN,clipWithInputHorizon:!0,clipWithOutputHorizon:!0,legacyHorizonClipping:!1,normalizeResultGeometry:!1,equals(t){return Ma(this.centralMeridianOfOutputGCS,t.centralMeridianOfOutputGCS)&&Ma(this.densificationStep,t.densificationStep)&&this.clipWithInputHorizon===t.clipWithInputHorizon&&this.clipWithOutputHorizon===t.clipWithOutputHorizon&&this.legacyHorizonClipping===t.legacyHorizonClipping&&this.normalizeResultGeometry===t.normalizeResultGeometry}}}function mVe(t,e,i,s){return z(0),{}}function pVe(t,e,i,s){t&&e||ce("!inputSR || !outputSR");const n=t.getLatestID(),r=e.getLatestID();if(n===3857&&r===4326){if(t.m_bDefaultDescriptor&&e.m_bDefaultDescriptor)return Fge()}else if(n===4326&&r===3857&&t.m_bDefaultDescriptor&&e.m_bDefaultDescriptor)return wVe();const o=J.constructEmpty();o.setCoords({env2D:i});const a=t.getCoordinateSystemType(),l=e.getCoordinateSystemType();if(a===0||l===0)return ZD(t,e);if(s){const m=s.find(0,t.getGCS(),e.getGCS());if(m)return ZD(t,e,m)}const u=t.getGCS().getLatestID(),c=e.getGCS().getLatestID();if(u>0&&u===c)return ZD(t,e);const h=new vVe(t,e,i);{const m=xVe(h);if(m)return m}const d=Oge(0,t,e,o,1,!0);return bVe(h,ZD(t,e,d.length?d[0]:void 0))}function ZD(t,e,i,s,n){return new wj(1,t,e,i,s,n)}function bj(){return{flagsMask:0,setFlag(t,e){e?this.flagsMask|=t:this.flagsMask&=~t},hasFlag(t){return!!(this.flagsMask&t)}}}function CB(){return{m_extendedParams:xj(),m_extendedParamsInternal:bj()}}function KU(){return CB()}let wj=class Lge{constructor(e,i,s,n,r,o){let a,l;this.m_datumTran=null,this.m_bIdentity=!0,this.m_bIdentityGeogToGeog=!0,this.m_bVertical=!1,this.m_bNormalize=!1,i&&s||ce("!inputSR || !outputSR"),n&&n.getType()===0&&(n.m_bReadOnly=!0),this.m_bNormalize=!1,e!==1&&(a=i.getVCS(),l=s.getVCS(),this.m_bVertical=a!=null&&l!=null),this.m_inputSR=i,this.m_outputSR=s,this.m_bIdentity=!1,this.m_bIdentityGeogToGeog=!1,z(!this.m_params),r&&(this.m_params=CB(),this.m_params.m_extendedParams=r),o&&(this.m_params||(this.m_params=CB()),this.m_params.m_extendedParamsInternal=o);let u=!1;const c=n!=null,h=i.getCoordinateSystemType(),d=s.getCoordinateSystemType();if(s.isPannable()&&h!==0&&r){const _=r.centralMeridianOfOutputGCS;if(!Number.isNaN(_)&&s.isPannable()){const v=s.getPannableExtent(),x=v.getCenterX();if(x!==_){const w=Math.ceil(v.width());_+w!==x+w&&(u=!0)}}}const m=r&&r.normalizeResultGeometry;if(i.equals(s))return this.m_bIdentity=!u,this.m_bIdentityGeogToGeog=!0,void this.updateProjector();const f=!c&&i.equalForProjection(s,this.m_bVertical);this.m_bIdentity=f&&!u,this.m_bIdentity?this.m_bIdentityGeogToGeog=!0:h!==0&&d!==0&&(m&&this.m_outputSR.isPannable()&&(this.m_bNormalize=m),this.m_datumTran=n||null,this.m_bIdentityGeogToGeog=(!this.m_datumTran||this.m_datumTran.count()===0)&&this.m_inputSR.getGCS().equalForProjection(this.m_outputSR.getGCS(),this.m_bVertical)),this.updateProjector()}getInputSR(){return this.m_inputSR}getOutputSR(){return this.m_outputSR}getDatumTransformation(){return this.m_datumTran}getInverse(){var i;const e=new Lge(1,this.m_outputSR,this.m_inputSR,(i=this.m_datumTran)==null?void 0:i.createInverse());return e.m_bIdentity=this.m_bIdentity,e.m_bVertical=this.m_bVertical,e.m_bIdentityGeogToGeog=this.m_bIdentityGeogToGeog,e.updateProjector(),e}isIdentity(){return this.m_bIdentity}getExtendedParams(){return this.m_params?this.m_params.m_extendedParams:KU().m_extendedParams}equals(e){return z(0),!1}isVertical(){return this.m_bVertical}isMatchingTransformation(e,i){return z(0),!1}getGeographicTransformations(){return this.m_datumTran}getExtendedParamsImpl(){return this.m_params?this.m_params.m_extendedParams:KU().m_extendedParams}getExtendedParamsInternal(){return this.m_params?this.m_params.m_extendedParamsInternal:KU().m_extendedParamsInternal}isIdentityGeogToGeog(){return this.m_bIdentityGeogToGeog}normalizeOutput(){return this.m_bNormalize}updateProjector(){this.m_projector=new IUe(this)}};const Sj=new Map,oM=new Map,TB=new Map;function TL(t){let e=t.getCode();if(e>0)return Ej(e)||MB(xr.coordsys(e));const i=t.getName();if(oM.has(i)){const s=oM.get(i);if(s&&s.deref()){const n=s.deref();if(n.m_peCoordSys.isEqual(t))return n}}return e=xr.getCode(t),MB(e>0?xr.coordsys(e):t)}function fVe(t){t<=0&&mG(t);{const s=Ej(t);if(s)return s}const e=rE(xr.coordsys(t));e.get()||mG(t);const i=MB(e.release());return i.getLatestID()!==t&&Sj.set(t,new WeakRef(i)),i}function gVe(t){const e=new cVe({},!0);return e.m_WKID=t,e}function _Ve(t){const e=rE(xr.fromString($t.PE_TYPE_COORDSYS,t));return e.get()||Yme(t),TL(e.release())}function yVe(t){oM.delete(t.m_peCoordSys.getName()),TB.delete(fj(t.m_peCoordSys,0,!1))}class vVe{constructor(e,i,s){this.m_hashCode=-1,e&&(this.m_inputSR=e,this.m_outputSR=i,this.m_env=s.clone(),this.m_hashCode=this.m_inputSR.getHashCode(),this.m_hashCode=fr(this.m_hashCode,this.m_outputSR.getHashCode()),this.m_env.isEmpty()||(this.m_hashCode=fr(this.m_hashCode,MD(this.m_env.xmin)),this.m_hashCode=fr(this.m_hashCode,MD(this.m_env.xmax)),this.m_hashCode=fr(this.m_hashCode,MD(this.m_env.ymin)),this.m_hashCode=fr(this.m_hashCode,MD(this.m_env.ymax))))}getHashCode(){return this.m_hashCode}equals(e){return!(this.m_inputSR&&!e.m_inputSR||!this.m_inputSR&&e.m_inputSR)&&this.m_env.equals(e.m_env)&&this.m_inputSR.equals(e.m_inputSR)&&this.m_outputSR.equals(e.m_outputSR)}clear(){this.m_inputSR=void 0,this.m_outputSR=void 0,this.m_hashCode=-1,this.m_env=void 0}}const PB=new Map;function xVe(t){if(PB.has(t.getHashCode()))return PB.get(t.getHashCode())}function bVe(t,e){return PB.set(t.getHashCode(),e),e}let QU,JU,e5;function Fge(){return QU||(QU=Qv(b4(),w4())),QU}function wVe(){return JU||(JU=Fge().getInverse()),JU}function SVe(){return e5||(e5=xr.unit(9001)),e5}function EVe(t){return rE(xr.coordsys(t)).get()!==null}const t5=new Map;function CVe(t){if(t5.has(t))return t5.get(t);{const e=EVe(t);return t5.set(t,e),e}}function TVe(t){return!1}function MB(t){const e=rE(t),i=t.getCode();if(i>0){const a=Ej(i);if(a)return a}const s=t.getName();let n=oM.get(s);if(n){const a=n.deref();if(a&&a.m_peCoordSys.isEqual(t))return a}const r=new yj(e.release());if(i>0)return r.setCached(),Sj.set(i,new WeakRef(r)),oM.set(s,new WeakRef(r)),r;const o=fj(t,0,!1);if(n=TB.get(o),n){const a=n.deref();if(a)return a}return r.setCached(),TB.set(o,new WeakRef(r)),r}function Ej(t){const e=Sj.get(t);if(e)return e.deref()}class $f extends xfe{constructor(e){return e===void 0?(super(),this.m_wkid=9001,void(this.m_peUnit=null)):typeof e=="number"?(super(),this.m_factor=e,void(this.m_wkid=0)):(super(e),void(e||(this.m_factor=1,this.m_wkid=9001,this.m_peUnit=SVe())))}getUnitType(){return 0}convertFromMeters(e){return e/this.getUnitToBaseFactor()}convertToMeters(e){return e*this.getUnitToBaseFactor()}}const PVe=["0","1","2","3","4","5","6","7","8","9","b","c","d","e","f","g","h","j","k","m","n","p","q","r","s","t","u","v","w","x","y","z"];function MVe(t,e,i){const s=st(e,"R");let n=0,r=0;for(let o=0;o<e;o++){let a=t[n]>>r&31;if(r+=5,r>31){const u=37-r;a&=(1<<u)-1,r-=32,n++,a|=(t[n]&(1<<r)-1)<<u}const l=PVe[a];s[e-1-o]=l}return i>e?s.push(..."0".repeat(i-e)):i<e&&(s.length=i),s.join("")}function yte(t,e,i,s,n){z(s>>5<n.length);let r=e,o=i;for(let a=s;a>=0;a-=2){const l=31&a,u=.5*(o+r);t>=u?(n[a>>5]|=1<<l,r=u):o=u}}let PL=new Set;const AB=2147483645n,c3=9007199254740990n,i5="operation is not supported for unknown coordinate systems";var vte;function H1(){return{majorSemiAxis:0,e2:0,minorSemiAxis:0,flattening:0,isSphere(){return this.e2===0}}}function AVe(t,e,i){t.majorSemiAxis=e,t.minorSemiAxis=e*(1-i),t.e2=i*(2-i),t.flattening=i}function IVe(t){if(xr)return;kVe(t);const e=PL;PL=null,e.forEach(i=>{const s=i.deref();s&&s.attachToPe()})}function Cj(t){FVe(t)}function gc(){return!!xr}function Tj(){return!!Ey}function v4(){return!!xr||!!Ey}function A1(t,e,i){return z(v4()),E4(t,e===void 0?0:e,null,!1)}function bS(t,e){z(v4());const i=new Wf;let s;return gc()?(s=_Ve(t),i.setHorzProj_(s),i.m_vertcs=null,i.m_userWKID=s.getLatestID()):(s=C4(t),i.m_unit=s.isPCS?new $f(s.metersOrRadiansPerUnit):new sM(s.metersOrRadiansPerUnit)),S4(i.m_precisionDescriptor,s,null,1),i.m_bDefaultDescriptor=!0,i.m_userWKT=t,i.calculateHashCode(),i.initDbgName(),i}function aM(t,e,i,s,n=!0){let r=null;return e&&(r=t5e(e,n)),DVe(t,r,i,s,n)}function DVe(t,e,i,s,n){t||ce("!PE_coord_sys");const r=new Wf;let o;return o=n?TL(t):new yj(t,!1),S4(r.m_precisionDescriptor,o,e,s),r.m_bDefaultDescriptor=!0,r.setHorzProj_(o),r.m_vertcs=e,r.m_userWKID=o.getLatestID(),r.calculateHashCode(),r.initDbgName(),r}function x4(t,e,i=!1){t.getCoordinateSystemType()===3&&ce("image spatial reference cannot be altered");const s=new Wf,n=t;return s.m_peCoordSysVal=n.m_peCoordSysVal,s.m_vertcs=n.m_vertcs,s.m_unit=n.m_unit,s.m_precisionDescriptor.assign(e),s.m_localZToXYFactor=n.m_localZToXYFactor,(Number.isNaN(s.m_precisionDescriptor.m_falseX)||Number.isNaN(s.m_precisionDescriptor.m_falseY))&&(s.m_precisionDescriptor.m_falseX=n.m_precisionDescriptor.m_falseX,s.m_precisionDescriptor.m_falseY=n.m_precisionDescriptor.m_falseY),s.m_precisionDescriptor.snapPrecision(),s.m_precisionDescriptor.fixTolerance(),s.m_userWKID=n.m_userWKID,s.m_precisionDescriptor.equals(n.m_precisionDescriptor)?s.m_bDefaultDescriptor=n.m_bDefaultDescriptor:s.m_bDefaultDescriptor=!1,i&&(s.m_bDefaultDescriptor=!0),s.calculateHashCode(),s.initDbgName(),s}function IB(t,e,i){return{}}function Pj(t,e,i){e===void 0&&(e=1),(e<=0||!Number.isFinite(e))&&ce(""),t||e===1||ce("null Unit has to have z_to_xy_factor equal to 1");const s=new Wf;s.m_unit=t;const n=t||new $f(9001);return Gge(s.m_precisionDescriptor,n,null,1),s.m_bDefaultDescriptor=!0,Number.isNaN(s.m_precisionDescriptor.m_falseX)&&ce("NAN false X/Y are not allowed here"),s.m_localZToXYFactor=e,s.calculateHashCode(),s.initDbgName(),s}function kge(t,e){return t.snapGeometry(e)}function h3(t){const e=t.getCoordinateSystemType();return e===1?t:(e===3&&z(0),t.getGCS())}function ML(t){return z(v4()),Tj()?UVe(t):CVe(t)}function AL(t){if(gc())return rE(xr.fromString($t.PE_TYPE_COORDSYS,t)).get()!==null;try{return C4(t),!0}catch{}return!1}let s5;function $ge(){return s5||(s5=(()=>{const t=Math.trunc(Math.random()*fo()),e=Date.now();return`|abba_000|${t.toString(16)}|${e.toString(16)}|`})()),s5}(function(t){t[t.utmDefault=0]="utmDefault",t[t.utmNorthSouth=1]="utmNorthSouth"})(vte||(vte={}));let NVe=0;function Uge(t=""){let e=`${$ge()}${NVe++}`;return t!==""&&(e+=`|${t}`),e}function Vge(t){return t.startsWith($ge())}let KD,QD,JD,Wf=class KC{destroy(){yVe(this.m_peCoordSysVal),this.getCoordinateSystemType()===1||this.getCoordinateSystemType()===2?this.getPECoordSys().destroy():We("SpatialReference.destroy")}constructor(){this.m_vertcs=null,this.m_peCoordSysVal=null,this.m_userWKID=0,this.m_userWKT=null,this.m_geogSpatialReference=null,this.m_srToGcs=null,this.m_gcsToSr=null,this.m_defaultPrecisionSR=null,this.m_localZToXYFactor=-1,this.m_precisionDescriptor=new ta,this.m_hashCode=0,this.m_bDefaultDescriptor=!1,Aj(this.m_precisionDescriptor),PL&&PL.add(new WeakRef(this))}attachToPe(){(this.m_userWKID>0?A1(this.m_userWKID):bS(this.m_userWKT)).copyTo(this,!1)}copyTo(e,i=!0){(i||e.m_bDefaultDescriptor)&&(e.m_bDefaultDescriptor=this.m_bDefaultDescriptor,e.m_precisionDescriptor.assign(this.m_precisionDescriptor)),e.m_defaultPrecisionSR=null,e.m_gcsToSr=this.m_gcsToSr,e.m_geogSpatialReference=this.m_geogSpatialReference,e.m_hashCode=this.m_hashCode,e.m_localZToXYFactor=this.m_localZToXYFactor,e.m_peCoordSysVal=this.m_peCoordSysVal,e.m_srToGcs=this.m_srToGcs,e.m_userWKID=this.m_userWKID,e.m_userWKT=this.m_userWKT,e.m_vertcs=this.m_vertcs,e.m_unit=this.m_unit}getHashCode(){return this.m_hashCode}getHashCodeHorizontal(){let e=0;return e=this.m_peCoordSysVal?this.m_peCoordSysVal.getHashCode():this.m_unit?this.m_unit.getHashCode():305419891,e}updateTransform(e){if(this.getCoordinateSystemType()===1)return Qv(this,this,null);let i=e?this.m_srToGcs:this.m_gcsToSr;if(i)return i;const s=this.getGCS(),n=this;i=e?Qv(n,s,null):Qv(s,n,null);const r=i;return(e?this.m_srToGcs:this.m_gcsToSr)||(e?this.m_srToGcs=r:this.m_gcsToSr=r,i)}getHashCodeVertical(){return this.m_vertcs?this.m_vertcs.getHashCode():0}calculateHashCode(){let e=this.getHashCodeHorizontal();const i=this.getHashCodeVertical(),s=this.m_precisionDescriptor.getHashCode();e=fr(e,i),this.m_hashCode=fr(e,s)}initDbgName(){}setHorzProj_(e){this.m_peCoordSysVal=e,this.m_unit=this.m_peCoordSysVal.getUnit()}getTolerance(e=0){return this.m_precisionDescriptor.getTolerance(e)}getResolution(e=0){return this.m_precisionDescriptor.getResolution(e)}getPECoordSys(){return this.m_peCoordSysVal?this.m_peCoordSysVal.m_peCoordSys:null}getPCSInfo(){return this.throwIfNotGCSOrPCS(),z(this.m_peCoordSysVal),this.m_peCoordSysVal.getPCSInfo()}getCentralMeridian(){return this.throwIfNotGCSOrPCS(),this.getCoordinateSystemType()===1?0:this.getPCSInfo().getCentralMeridian()}getCoordinateSystemType(){const e=this.getPECoordSys();if(e)switch(e.getType()){case $t.PE_TYPE_GEOGCS:return 1;case $t.PE_TYPE_PROJCS:return 2;default:return 0}else{if((this.m_userWKID>0||this.m_userWKT)&&this.m_unit instanceof $f)return 2;if(this.m_unit instanceof sM)return 1}return 0}getID(){return this.m_userWKID}getLatestID(){return this.m_peCoordSysVal?this.m_peCoordSysVal.getLatestID():this.m_userWKID}getOldID(){return this.m_peCoordSysVal?this.m_peCoordSysVal.getOldID():this.m_userWKID}getVerticalID(){return _i("vcs not implemented"),0}getLatestVerticalID(){return this.m_vertcs?this.m_vertcs.getLatestID():0}getOldVerticalID(){return _i("vcs not implemented"),0}getPEVerticalCoordSys(){return null}getPole(e){return this.throwIfNotGCSOrPCS(),z(this.m_peCoordSysVal),this.m_peCoordSysVal.getPole(e)}getText(){const e=this.getPECoordSys();return e?pte(e):this.m_userWKT??""}getTextExtended(e){const i=this.getPECoordSys();return i?this.getPEVerticalCoordSys()?S5e(null,i,this.getPEVerticalCoordSys()):pte(i,e):this.m_userWKT??""}getText2(e=-1){const i=this.getPECoordSys();return i?E5e(i,e):this.m_userWKT??""}getUnit(){return this.m_unit}getUnitsPerMillimeter(){return this.m_peCoordSysVal?this.m_peCoordSysVal.getUnitsPerMillimeter():this.m_unit instanceof $f?.001/this.m_unit.getUnitToBaseFactor():this.m_unit instanceof sM?.001/(C4(this.m_userWKT??this.m_userWKID).semiMajor*this.m_unit.getUnitToBaseFactor()):(un("sr object not in valid state"),0)}getAuthorityName(){return this.getPECoordSys()?C5e():""}getVerticalUnit(){return _i("vcs not implemented"),{}}getVCS(){return this.m_vertcs}hasVCS(){return!1}getGCSHorisonIsInclusive(){return this.throwIfNotGCSOrPCS(),z(this.m_peCoordSysVal),this.m_peCoordSysVal.getGCSHorisonIsInclusive()}getGCSHorizon(){return this.throwIfNotGCSOrPCS(),z(this.m_peCoordSysVal),this.m_peCoordSysVal.getGCSHorizon()}getGCS(){const e=this.getCoordinateSystemType();if(e===0)un(i5);else{if(e===1)return this;e===3&&un("image cs not supported")}if(this.m_geogSpatialReference)return this.m_geogSpatialReference;let i;if(this===b4()||this===Mj())i=w4();else{z(this.m_peCoordSysVal);const s=this.m_peCoordSysVal.m_peCoordSys.getGeogcs();s||We(""),i=aM(s,this.m_vertcs,null,this.m_precisionDescriptor.getPrecision(),this.m_peCoordSysVal.getCached())}return this.m_geogSpatialReference?i=this.m_geogSpatialReference:this.m_geogSpatialReference=i,i}getGCSSplitLines(){return this.throwIfNotGCSOrPCS(),z(this.m_peCoordSysVal),this.m_peCoordSysVal.getGCSSplitLines()}toGCS(e,i){if(e.length===0)return 0;e.length>i.length&&ce("coordsSrc.size() > coordsDst.size()");const s=this.getCoordinateSystemType();if(s===0&&un(i5),s===1)return JO(i,e,e.length),e.length;z(this.m_peCoordSysVal);const n=this.getSRToGCSTransform();return new Cd().transform(n,e,e.length,i)}toGeohash(e,i=8){const s=e.clone();s.scale(this.getGCS().getUnit().getID()===9102?1:this.getGCS().getUnit().getUnitToBaseFactor()/Math.PI*180),s.x<-180?(s.x=xy(s.x,360),s.x<-180&&(s.x+=360)):s.x>180&&(s.x=xy(s.x,360),s.x>180&&(s.x-=360)),s.y>90&&(s.y=90),s.y<-90&&(s.y=-90);const n=5*i,r=new Uint32Array(4);return yte(s.x,-180,180,n-1,r),yte(s.y,-90,90,n-2,r),MVe(r,i,i)}isPannable(){const e=this.getCoordinateSystemType();return e!==0&&e!==3&&(z(this.m_peCoordSysVal),this.m_peCoordSysVal.isPannable())}getPannableExtent(){return this.isPannable()||ce("!is_pannable"),z(this.m_peCoordSysVal),this.m_peCoordSysVal.getPannableExtent()}getPannableExtentInGCS(){return this.isPannable()||ce("!is_pannable"),z(this.m_peCoordSysVal),this.m_peCoordSysVal.getPannableExtentGCS()}throwIfNotGCSOrPCS(){const e=this.getCoordinateSystemType();e!==1&&e!==2&&ce("Not a GCS or PCS")}getDomainXY(){return this.throwIfNotGCSOrPCS(),z(this.m_peCoordSysVal),this.m_peCoordSysVal.getDomainXY()}getFullWorldExtent(){return this.throwIfNotGCSOrPCS(),this.isPannable()?this.getPannableExtent():this.getDomainXY()}queryPrecisionDescriptor(e){if(e.assign(this.m_precisionDescriptor),Number.isNaN(e.m_falseX))if(gc()||XF("cannot query precision descriptor"),z(this.m_peCoordSysVal!==null),this.m_precisionDescriptor.m_precision!==2){const i=this.m_peCoordSysVal.getDomainXY();e.m_falseX=i.xmin,e.m_falseY=i.ymin}else e.m_falseX=-Number.MAX_VALUE,e.m_falseY=-Number.MAX_VALUE}queryPrecisionDescriptorWithoutFalseXY(e){e.assign(this.m_precisionDescriptor),e.m_falseX=Number.NaN,e.m_falseY=Number.NaN}queryDefaultPrecisionDescriptorWithoutFalseXY(e){if(this.m_bDefaultDescriptor)e.assign(this.m_precisionDescriptor);else{const i=this.getCoordinateSystemType();i===0?Gge(e,this.m_unit,this.m_vertcs,this.m_precisionDescriptor.getPrecision()):i===3?_i("image cs"):S4(e,this.m_peCoordSysVal,this.m_vertcs,this.m_precisionDescriptor.getPrecision())}e.m_falseX=Number.NaN,e.m_falseY=Number.NaN}horizontalEqual(e){return lVe(this.m_peCoordSysVal,e.m_peCoordSysVal)}verticalEqual(e){return this.m_vertcs!==null==(e.m_vertcs!==null)&&(!this.m_vertcs||this.m_vertcs.equals(e.m_vertcs))}equals(e){const i=e;if(this===i)return!0;if(!this.horizontalEqual(i)||!this.verticalEqual(i)||!i.m_peCoordSysVal&&(z(!this.m_peCoordSysVal),this.m_unit!==null!=(i.m_unit!==null)||this.m_unit&&!this.m_unit.equals(i.m_unit)||this.m_localZToXYFactor!==i.m_localZToXYFactor))return!1;if(!this.m_bDefaultDescriptor||!i.m_bDefaultDescriptor){if(this.m_peCoordSysVal){if(!this.m_precisionDescriptor.equalsWithoutFalseXY(i.m_precisionDescriptor))return!1;z(i.m_peCoordSysVal);let s=this.m_precisionDescriptor.m_falseX,n=this.m_precisionDescriptor.m_falseY;if(Number.isNaN(s)){const a=this.m_peCoordSysVal.getDomainXY();s=a.xmin,n=a.ymin}let r=i.m_precisionDescriptor.m_falseX,o=i.m_precisionDescriptor.m_falseY;if(Number.isNaN(r)){const a=i.m_peCoordSysVal.getDomainXY();r=a.xmin,o=a.ymin}return s===r&&n===o}return this.m_precisionDescriptor.equals(i.m_precisionDescriptor)}return!0}equalForProjection(e,i){if(this===e)return!0;const s=this.getCoordinateSystemType(),n=e.getCoordinateSystemType();if(s===0||n===0)return s===0&&n===0?(!i||this.getZToXYFactor()===e.getZToXYFactor())&&(!this.getUnit()||!e.getUnit()||this.getUnit().equals(e.getUnit())):s!==3&&n!==3&&(this.getUnit()===null||e.getUnit()===null||(!i||this.getZToXYFactor()===e.getZToXYFactor())&&this.getUnit().equals(e.getUnit()));if(s!==n)return!1;if(s===3)return this.equals(e);if(uVe(this.m_peCoordSysVal,e.m_peCoordSysVal)){if(!i)return!0;if(this.m_vertcs!==null==(e.m_vertcs!==null))return!this.m_vertcs||this.m_vertcs.equalForProjection(e.m_vertcs)}return!1}equalHorizontal(e){return this.horizontalEqual(e)}equalVertical(e){return z(0),!1}equalVerticalVCS(e){return z(0),!1}convergenceAngle(e){return z(0),0}getPeCoordsysCopy(){if(this.m_peCoordSysVal){const e=this.m_peCoordSysVal.m_peCoordSys;return e||We("cannot clone coord sys"),e}return null}getPeVertcsCopy(){return z(0),0}throwIfLocal(){this.getCoordinateSystemType()===0&&ce(i5)}getPrimeMeridian(){return this.throwIfLocal(),z(this.m_peCoordSysVal),this.m_peCoordSysVal.getPrimeMeridian()}getSRToGCSTransform(){return this.updateTransform(!0)}getGCSToSRTransform(){return this.updateTransform(!1)}getOneMeter(){return 1e3*this.getUnitsPerMillimeter()}getOneMeterPCSUnit(){return this.throwIfNotGCSOrPCS(),z(this.m_peCoordSysVal),this.m_peCoordSysVal.getOneMeterPCSUnit()}getDefaultPrecisionSR(){if(this.m_bDefaultDescriptor)return this;if(this.m_defaultPrecisionSR===null){const e=new ta;this.queryDefaultPrecisionDescriptorWithoutFalseXY(e),this.m_defaultPrecisionSR=x4(this,e,!0)}return this.m_defaultPrecisionSR}getPCSHorizon(){return this.throwIfNotGCSOrPCS(),z(this.m_peCoordSysVal),this.m_peCoordSysVal.getPCSHorizon()}getHorzUnitFactor(){return this.m_unit?this.m_unit.getUnitToBaseFactor():1}querySpheroidData(e){this.throwIfNotGCSOrPCS(),z(this.m_peCoordSysVal);const i=this.getGCS().getPECoordSys().getDatum().getSpheroid(),s=i.getFlattening();AVe(e,i.getAxis(),s)}getAreaOfUse(){this.getCoordinateSystemType()===0&&un(""),z(this.m_peCoordSysVal);const e=this.m_peCoordSysVal.getAreaOfUse();return e===null?new E1:new E1({geom:e.clone(),sr:A1(4326)})}getZToXYFactor(){return 1}isCustomWkid(){return!1}getOneDegreeGCSUnit(){return this.throwIfNotGCSOrPCS(),z(this.m_peCoordSysVal),this.m_peCoordSysVal.getOneDegreeGCSUnit()}getGcsUnitFactor(){return this.throwIfNotGCSOrPCS(),z(this.m_peCoordSysVal),this.m_peCoordSysVal.getGcsUnitFactor()}snapGeometry(e){if(e.isEmpty()||this.m_precisionDescriptor.getPrecision()===2)return!1;const i=e.getGeometryType();if(ll(i))return this.snapMultiVertex_(e);if(i===q.enumPoint)return this.snapPoint_(e);if(i===q.enumEnvelope)return this.snapEnvelope_(e);if(nr(i))return this.snapSegment_(e);if(i===q.enumGeometryCollection){const s=e;let n=!1;for(let r=0,o=s.getGeometryCount();r<o;++r)n=this.snapGeometry(s.getGeometry(r))||n;return n}We("what else?")}snapMultiVertex_(e){if(z(!e.isEmpty()),z(this.m_precisionDescriptor.getPrecision()!==2),Ei(e.getGeometryType())){const r=e;if(r.hasNonLinearSegments())return this.snapGeometryWithCurves_(r)}const i=e.getImpl(),s=i.getDescription();let n=!1;for(let r=0,o=s.getAttributeCount();r<o;r++){const a=s.getSemantics(r),l=i.getAttributeStreamRef(a);n=this.snapAttributes(a,l,0,i.getPointCount())||n}return n&&i.notifyModifiedFlags(2001),n}snapPoint_(e){return!1}snapEnvelope_(e){return!1}snapSegment_(e){z(!e.isEmpty()),z(this.m_precisionDescriptor.getPrecision()!==2);const i=new ta;this.queryPrecisionDescriptor(i);const s=e.getStartXY(),n=new N;n.x=Gx(s.x,i.getFalseX(),i.getGridUnitsXY()),n.y=Gx(s.y,i.getFalseY(),i.getGridUnitsXY());let r=!n.equals(s);const o=e.getEndXY(),a=new N;a.x=Gx(o.x,i.getFalseX(),i.getGridUnitsXY()),a.y=Gx(o.y,i.getFalseY(),i.getGridUnitsXY()),r||(r=!a.equals(o)),r&&e.changeEndPoints2D(n,a);const l=(c,h,d)=>{let m=!1;{const f=e.getStartAttributeAsDbl(c,0),_=Gx(f,h,d),v=!Ma(_,f);m||(m=v),v&&e.setStartAttribute(c,0,_)}{const f=e.getEndAttributeAsDbl(c,0),_=Gx(f,h,d),v=!Ma(_,f);m||(m=v),v&&e.setEndAttribute(c,0,_)}return m};let u=r?1:0;return e.hasAttribute(1)&&(u|=l(1,i.getFalseZ(),i.getGridUnitsZ())?1:0),e.hasAttribute(2)&&(u|=l(2,i.getFalseM(),i.getGridUnitsM())?1:0),!!u}snapGeometryWithCurves_(e){z(!e.isEmpty()),z(this.m_precisionDescriptor.getPrecision()!==2);const i=e.createInstance(),s=new ii;let n=0;for(let r=0,o=e.getPathCount();r<o;++r){const a=e.getSegmentCountPath(r);if(a===0){if(i.addPath(e,r,!0),i.getPathSize(r)===1){const u=new Jt;i.getPointByVal(i.getPointCount()-1,u),n|=this.snapGeometry(u)?1:0,i.setPointByVal(i.getPointCount()-1,u)}continue}const l=e.isClosedPath(r);for(let u=0,c=l?a-1:a;u<c;++u)e.getSegmentFromPath(r,u,s,!1),n|=this.snapGeometry(s.get())?1:0,i.addSegment(s.get(),u===0);l&&(e.getSegmentFromPath(r,a-1,s,!1),n|=this.snapGeometry(s.get())?1:0,a===1?i.addPathFromClosedSegment(s.get(),!1):i.closeLastPathWithSegment(s.get()))}return n&&i.copyTo(e),!!n}snapAttributes(e,i,s,n){let r=!1;const o=new ta;if(this.queryPrecisionDescriptor(o),e===0){const a=i;for(let l=s;l<n;l++){const u=a.read(2*l),c=KC.s_SnapValue(u,o.getFalseX(),o.getGridUnitsXY()),h=a.read(2*l+1),d=KC.s_SnapValue(h,o.getFalseY(),o.getGridUnitsXY());r=r||c!==u||d!==h,r&&(a.write(2*l,c),a.write(2*l+1,d))}}else if(e===1){const a=i;for(let l=s;l<n;l++){const u=a.read(l),c=KC.s_SnapValue(u,o.getFalseZ(),o.getGridUnitsZ());r=r||!Ma(c,u),r&&a.write(l,c)}}else if(e===2){const a=i;for(let l=s;l<n;l++){const u=a.read(l),c=KC.s_SnapValue(u,o.getFalseM(),o.getGridUnitsM());r=r||!Ma(c,u),r&&a.write(l,c)}}return r}static s_SnapValue(e,i,s){return g1((e-i)*s)/s+i}};class ta{constructor(){const e=c3,i=1e-4,s=.001,n=i*Number(e)*.5;this.m_precision=1,this.m_falseX=-n,this.m_falseY=-n,this.m_unitsXY=Number(e)/(2*n),this.m_falseM=-1e5,this.m_unitsM=1/i,this.m_falseZ=-1e5,this.m_unitsZ=1/i,this.m_toleranceXY=s,this.m_toleranceM=s,this.m_toleranceZ=s}getHashCode(){let e=7777,i=7777;return i=fr(i,this.m_falseM),i=fr(i,this.m_unitsM),e=fr(e,this.m_unitsXY),i=fr(i,this.m_toleranceXY),e=fr(e,this.m_falseZ),i=fr(i,this.m_toleranceZ),e=fr(e,this.m_unitsZ),i=fr(i,this.m_toleranceM),e=fr(e,this.m_precision),fr(e,i)}clone(){const e=new ta;return e.m_falseX=this.m_falseX,e.m_falseY=this.m_falseY,e.m_unitsXY=this.m_unitsXY,e.m_falseZ=this.m_falseZ,e.m_unitsZ=this.m_unitsZ,e.m_falseM=this.m_falseM,e.m_unitsM=this.m_unitsM,e.m_toleranceXY=this.m_toleranceXY,e.m_toleranceZ=this.m_toleranceZ,e.m_toleranceM=this.m_toleranceM,e.m_precision=this.m_precision,e}assign(e){return this.m_falseX=e.m_falseX,this.m_falseY=e.m_falseY,this.m_unitsXY=e.m_unitsXY,this.m_falseZ=e.m_falseZ,this.m_unitsZ=e.m_unitsZ,this.m_falseM=e.m_falseM,this.m_unitsM=e.m_unitsM,this.m_toleranceXY=e.m_toleranceXY,this.m_toleranceZ=e.m_toleranceZ,this.m_toleranceM=e.m_toleranceM,this.m_precision=e.m_precision,this}initialize2D(e,i){}getTolerance(e){switch(e){case 0:return this.m_toleranceXY;case 1:return this.m_toleranceZ;case 2:return this.m_toleranceM;default:return 0}}getResolution(e){if(this.m_precision===2)return 0;switch(e){case 0:return 1/this.m_unitsXY;case 1:return 1/this.m_unitsZ;case 2:return 1/this.m_unitsM;default:return 0}}getFalseX(){return this.m_falseX}getFalseY(){return this.m_falseY}getFalseZ(){return this.m_falseZ}getFalseM(){return this.m_falseM}getGridUnitsXY(){return this.m_unitsXY}getGridUnitsZ(){return this.m_unitsZ}getGridUnitsM(){return this.m_unitsM}getPrecision(){return this.m_precision}static getLimit32(){return 2147483645}static getLimit64(){return 9007199254740990n}static getLimitFloat(){return 0}getXYGridRange(){const e=new J;switch(this.m_precision){case 0:{const i=ta.getLimit32()/this.getGridUnitsXY();e.setCoords({xmin:this.getFalseX(),ymin:this.getFalseY(),xmax:this.getFalseX()+i,ymax:this.getFalseY()+i})}break;case 1:{const i=Number(ta.getLimit64())/this.getGridUnitsXY();e.setCoords({xmin:this.getFalseX(),ymin:this.getFalseY(),xmax:this.getFalseX()+i,ymax:this.getFalseY()+i})}break;case 2:e.setCoords({xmin:-Number.MAX_VALUE,ymin:-Number.MAX_VALUE,xmax:Number.MAX_VALUE,ymax:Number.MAX_VALUE});break;default:e.setEmpty(),We("")}return e}getZGridRange(){const e=new Me;switch(this.m_precision){case 0:{const i=ta.getLimit32()/this.getGridUnitsZ();e.setCoords(this.getFalseZ(),this.getFalseZ()+i)}break;case 1:{const i=Number(ta.getLimit64())/this.getGridUnitsZ();e.setCoords(this.getFalseZ(),this.getFalseZ()+i)}break;case 2:e.setCoords(-Number.MAX_VALUE,Number.MAX_VALUE);break;default:e.setEmpty(),We("")}return e}getMGridRange(){const e=new Me;switch(this.m_precision){case 0:{const i=ta.getLimit32()/this.getGridUnitsM();e.setCoords(this.getFalseM(),this.getFalseM()+i)}break;case 1:{const i=Number(ta.getLimit64())/this.getGridUnitsM();e.setCoords(this.getFalseM(),this.getFalseM()+i)}break;case 2:e.setCoords(-Number.MAX_VALUE,Number.MAX_VALUE);break;default:e.setEmpty(),We("")}return e}setTolerance(e,i){switch(i<0&&ce("tol < 0"),Number.isFinite(i)||ce("tol is not finite"),e){case 0:this.m_toleranceXY=i;break;case 1:this.m_toleranceZ=i;break;case 2:this.m_toleranceM=i;break;default:ce("cannot set tolerance for this attribute")}}setGridParams(e,i,s){Number.isFinite(e)&&Number.isFinite(i)&&Number.isFinite(s)||ce("grid params are not finite"),s<1&&ce("grid units cannot be smaller than 1.0"),this.m_falseX=e,this.m_falseY=i,this.m_unitsXY=s}setZParams(e,i){Number.isFinite(e)&&Number.isFinite(i)||ce("grid params are not finite"),i<1&&ce("grid units cannot be smaller than 1.0"),this.m_falseZ=e,this.m_unitsZ=i}setMParams(e,i){Number.isFinite(e)&&Number.isFinite(i)||ce("grid params are not finite"),i<1&&ce("grid units cannot be smaller than 1.0"),this.m_falseM=e,this.m_unitsM=i}setPrecision(e){}equals(e){return this===e||Ma(this.m_falseX,e.m_falseX)&&Ma(this.m_falseY,e.m_falseY)&&this.equalsWithoutFalseXY(e)}snapPrecision(){if(this.m_precision===2)return;const e=(s,n,r,o)=>{if(!Number.isFinite(n)||!Number.isFinite(r))return r;if(r<1)return 1;if(!o)return r;const a=Number(s)/r;return Math.trunc((n+a-n)*r)>s&&(r=s/(n+a-n)),Math.max(1,r)},i=Number(this.m_precision===0?AB:c3);this.m_unitsXY=e(i,this.m_falseX,this.m_unitsXY,!0),this.m_unitsXY=e(i,this.m_falseY,this.m_unitsXY,!0),this.m_unitsZ=e(i,this.m_falseZ,this.m_unitsZ,!1),this.m_unitsM=e(i,this.m_falseM,this.m_unitsM,!1)}verifyPrecision(){if(this.m_precision===2)return!0;const e=(s,n,r,o)=>{if(r<1||!Number.isFinite(n)||!Number.isFinite(r))return!1;if(!o)return!0;const a=Number(s)/r;return!(BigInt((n+a-n)*r)>s)},i=this.m_precision===0?AB:c3;return!!e(i,this.m_falseX,this.m_unitsXY,!0)&&!!e(i,this.m_falseY,this.m_unitsXY,!0)&&!!e(i,this.m_falseZ,this.m_unitsZ,!1)&&!!e(i,this.m_falseM,this.m_unitsM,!1)}fixTolerance(){this.m_precision!==2&&(this.m_toleranceXY=Math.max(2/this.m_unitsXY,this.m_toleranceXY),this.m_toleranceZ=Math.max(2/this.m_unitsZ,this.m_toleranceZ),this.m_toleranceM=Math.max(2/this.m_unitsM,this.m_toleranceM),(Number.isNaN(this.m_falseX)||Number.isNaN(this.m_falseY))&&(this.m_falseX=this.m_falseY=Number.NaN))}equalsWithoutFalseXY(e){return this===e||this.m_unitsXY===e.m_unitsXY&&this.m_falseZ===e.m_falseZ&&this.m_unitsZ===e.m_unitsZ&&this.m_falseM===e.m_falseM&&this.m_unitsM===e.m_unitsM&&this.m_toleranceXY===e.m_toleranceXY&&this.m_toleranceZ===e.m_toleranceZ&&this.m_toleranceM===e.m_toleranceM&&this.m_precision===e.m_precision}setBestXyDomainFromEnvelope(e,i){}setBestZDomainFromZRange(e,i,s){}setBestMDomainFromMRange(e,i,s){}}function b4(){return(!KD||gc()&&KD.getPECoordSys()===null)&&(KD=E4(3857,0,null,!0)),KD}function Mj(){return(!QD||gc()&&QD.getPECoordSys()===null)&&(QD=E4(102100,0,null,!0)),QD}function w4(){return(!JD||gc()&&JD.getPECoordSys()===null)&&(JD=E4(4326,0,null,!0)),JD}function Aj(t){t.m_falseX=0,t.m_falseY=0,t.m_unitsXY=1,t.m_falseZ=0,t.m_unitsZ=1,t.m_falseM=0,t.m_unitsM=1,t.m_toleranceXY=100*cn(),t.m_toleranceZ=100*cn(),t.m_toleranceM=100*cn(),t.m_precision=2}function S4(t,e,i,s){const n=e instanceof yj;Aj(t),t.m_precision=s,t.m_falseX=Number.NaN,t.m_falseY=Number.NaN;const r=1e-4,o=.001,a=n?e.m_csType:e.isPCS?2:1;if(a===1){const c=(s===0?5555555555555555e-22:1e-9)*(n?e.getOneDegreeGCSUnit():Math.PI/e.metersOrRadiansPerUnit/180);t.m_unitsXY=1/c}else if(a===2){const c=(s===0?o:r)*(n?e.getOneMeterPCSUnit():1/e.metersOrRadiansPerUnit);t.m_unitsXY=1/c}else ce("unrecognized cs type");t.m_falseM=-1e5,t.m_unitsM=1/(s===0?o:r),t.m_unitsM=Math.max(1,t.m_unitsM),t.m_unitsXY=Math.max(1,t.m_unitsXY);let l=0,u=0;s!==0&&s!==1||(l=2/t.m_unitsXY,u=2/t.m_unitsM),t.m_toleranceXY=Math.max(l,n?e.getUnitsPerMillimeter():a===2?.001/e.metersOrRadiansPerUnit:.001/(e.semiMajor*e.metersOrRadiansPerUnit)),t.m_toleranceM=Math.max(o,u),zge(t,i)}function zge(t,e){if(t.m_falseZ=-1e5,e){const r=(t.m_precision===0?.001:1e-4)*e.getOneMeter();t.m_unitsZ=1/r}else t.m_unitsZ=1/(t.m_precision===0?.001:1e-4);t.m_unitsZ=Math.max(1,t.m_unitsZ);let n=0;t.m_precision!==0&&t.m_precision!==1||(n=2/t.m_unitsZ),t.m_toleranceZ=Math.max(e?e.getOneMeter()*.001:.001,n)}function Gge(t,e,i,s){Aj(t),t.m_precision=s;const n=s===0?AB:c3,r=1e-4,o=.001;let a=1,l=1,u=.001;e&&(l=e.getUnitToBaseFactor()),e&&e.getUnitType()===1?(a=400*Math.PI/180,u=8983152841195215e-24*Math.PI/180/l):(a=(s===0?o:r)*Number(n)*.5,u=o/l),a/=l,t.m_falseX=-a,t.m_falseY=-a,t.m_unitsXY=Number(n)/(2*a),t.m_falseM=-1e5,t.m_unitsM=1/(s===0?o:r),t.m_unitsM=Math.max(1,t.m_unitsM),t.snapPrecision();let c=0,h=0;t.m_precision!==0&&t.m_precision!==1||(h=2/t.m_unitsM,c=2/t.m_unitsXY),t.m_toleranceXY=Math.max(c,u),t.m_toleranceM=Math.max(o,h),zge(t,i)}function E4(t,e,i,s){if(!s&&e<=0){if(t===3857)return b4();if(t===102100)return Mj();if(t===4326)return w4()}const n=new Wf;let r,o=null;return gc()?(r=fVe(t),e>0?o=null:e=0,n.setHorzProj_(r),n.m_vertcs=o):(r=C4(t),n.m_unit=r.isPCS?new $f(r.metersOrRadiansPerUnit):new sM(r.metersOrRadiansPerUnit)),S4(n.m_precisionDescriptor,r,o,1),n.m_bDefaultDescriptor=!0,n.m_userWKID=t,n.calculateHashCode(),n.initDbgName(),n}function Gx(t,e,i){return g1((t-e)*i)/i+e}let oy=null;const Bge=3552713678800501e-30;function RVe(t,e,i){return t===e||Math.abs(t-e)<=i*(1+(Math.abs(t)+Math.abs(e))/2)}function Ts(t,e){return RVe(t,e,Bge)}function OVe(t,e){return t===0||Math.abs(t)<=e}function LVe(t){return OVe(t,Bge)}let Lo,xr,$t,yo,DB,_o,Mw,xte,zl,lM,NB;function rE(t){return{_this:t,get(){return this._this},reset(e){this._this=e},release(){const e=this._this;return this._this=null,e}}}let Ey=null;function C4(t){z(Ey);const e=Ey(t);return e.semiMajor=e.isPCS?Number.NaN:GVe(t),e}function FVe(t){Ey=t,z(Ey)}function kVe(t){const e=t;xr=e.PeFactory,z(xr),NB=e.PeGCSExtent,z(NB),zl=e.PeLineType,z(zl),lM=e.PeMath,z(lM),Lo=e.PeDouble,z(Lo),$t=e.PeDefs,z($t),yo=e.PeCSTransformations,z(yo),DB=e.PeGTTransformations,z(DB),_o=e.PePCSInfo,z(_o),Mw=e.PeGTlistExtended,z(Mw),xr.initialize(),xte=e.PeGTlistExtendedEntry,z(xte),$t.PE_TYPE_ANGUNIT=512,$t.PE_STR_AUTH_ALL=2,_o.PE_POLE_LINE_STRAIGHT=2,_o.PE_POLE_LINE_CURVED=3,$t.PE_PARM_LAM0=2,$t.PE_PARM_PHI0=6,$t.PE_PRJ_AZIMUTHAL_EQUIDISTANT=43032,$t.PE_PRJ_LAMBERT_AZIMUTHAL_EQAREA=43033,$t.PE_PRJ_ALBERS=43007,$t.PE_PRJ_CYLINDRICAL_EQAREA=43034,$t.PE_TYPE_VERTCS=8,$t.PE_LINETYPE_GEODESIC=0,$t.PE_LINETYPE_LOXODROME=1,$t.PE_LINETYPE_GREAT_ELLIPTIC=2,$t.PE_LINETYPE_NORMAL_SECTION=3,Mw.PE_GTLIST_OPTS_USABLE=1,Ey=null}function $Ve(t,e,i,s){return e<=0?(i[0]=0,s[0]=0,!1):(i[0]=e,s[0]=e,!0)}function UVe(t){return z(Tj()),!!Ey(t).isPCS||VVe(t)}function VVe(t){return xr&&un("pe has been loaded. no-pe methods should not be used at this point."),oy||qge(),oy.has(t)}const zVe=/(?:ELLIPSOID|SPHEROID)\["(?:\w|[-()])+",(\d+\.\d+)/;function GVe(t){if(xr&&un("pe has been loaded. no-pe methods should not be used at this point."),typeof t=="string"){const e=t.match(zVe);e&&e.length===2||ce("bad gcs wkt");const i=Number.parseFloat(e[1]);return Number.isFinite(i)||ce("bad gcs wkt"),i}return oy||qge(),oy.has(t)||un("gcs wkid not found"),oy.get(t)}function qge(){oy=new Map;for(const t in mL){const e=Number.parseFloat(t),i=mL[t];if(Array.isArray(i))for(const s of i)oy.set(s,e);else oy.set(i,e)}a4e()}function BVe(t,e){const i=xr.geogtran(t);return i||mG(t),new T4(i,e)}function qVe(t,e){const i=xr.fromString($t.PE_TYPE_GEOGTRAN,t);return i||Yme(t),new T4(i,e)}function Hge(t,e){return new T4(t,e)}const bte=nd(0),wte=nd(1);let T4=class RB{constructor(e,i){if(e instanceof RB)return this.m_geogTranWrapper=e.m_geogTranWrapper,this.m_bInverted=i?!e.m_bInverted:e.m_bInverted,void(this.m_hashCode=fr(this.m_geogTranWrapper.getHashCode(),this.m_bInverted?wte:bte));this.m_geogTranWrapper=new s5e(e),this.m_bInverted=i,this.m_hashCode=fr(this.m_geogTranWrapper.getHashCode(),this.m_bInverted?wte:bte)}getID(){return this.m_geogTranWrapper.getLatestId()}getLatestID(){return this.m_geogTranWrapper.getLatestId()}getText(){return this.m_geogTranWrapper.getText()}getTextExtended(e){if(!this.m_geogTranWrapper.getGeogtran())return"";if(e===-1)return this.m_geogTranWrapper.getGeogtran().toString();{const i=e===0?$t.PE_STR_AUTH_TOP:$t.PE_STR_AUTH_ALL;return this.m_geogTranWrapper.getGeogtran().toString(i)}}getText2(e=-1){let i=$t.PE_STR_FMT_WKT2;return e!==-1&&(i|=e===0?$t.PE_STR_AUTH_TOP:$t.PE_STR_AUTH_ALL),this.m_geogTranWrapper.getGeogtran().toString(i)}getName(){return this.m_geogTranWrapper&&this.m_geogTranWrapper.getGeogtran()?this.m_geogTranWrapper.getGeogtran().getName():""}getInputSpatialReference(){return this.m_bInverted?this.m_geogTranWrapper.getOutputSr(!1):this.m_geogTranWrapper.getInputSr(!1)}getOutputSpatialReference(){return this.m_bInverted?this.m_geogTranWrapper.getInputSr(!1):this.m_geogTranWrapper.getOutputSr(!1)}getInverse(){return new RB(this,!0)}isInverted(){return this.m_bInverted}getHashCode(){return this.m_hashCode}GetPeGeogtran(){return this.m_geogTranWrapper.getGeogtran()}equals(e){const i=e;return i===this||this.m_bInverted===i.m_bInverted&&(this.GetPeGeogtran()===i.GetPeGeogtran()||this.getID()===i.getID()&&!(this.getID()===0&&!this.GetPeGeogtran().isEqual(i.GetPeGeogtran())))}referencesMissingData(){return!!this.m_geogTranWrapper&&!this.m_geogTranWrapper.isUsable()}getWrapper(){return this.m_geogTranWrapper}};function jge(t,e,i,s,n){const r=t.getGCS(),o=e.getGCS(),a=r.getPECoordSys(),l=o.getPECoordSys();let u=null;if(!i.isEmpty()){const m=i.clone();if(!m.isEmpty()&&t.getCoordinateSystemType()===2){let f=new Fo({env2D:m});const _=Qv(t,r,null);f=new Cd().execute(f,_,null),f.queryEnvelope(m)}if(!m.isEmpty()){const f=a.getPrimem().getLongitude(),_=a.getUnit().getUnitFactor();u=new NB(m.xmin,m.ymin,m.xmax,m.ymax,f,_)}}let c=s;c>=fo()&&(c=0);const h=[];let d=Mw.PE_GTLIST_OPTS_COMMON;n||(d&=~Mw.PE_GTLIST_OPTS_USABLE);for(let m=0;m<2;m++){h.length=0;const f=c,_=Mw.getGTlist(a,l,2,d,u,f);let v=!1;if(_&&_.length>0)for(let x=0,w=_.length;x<w;x++){const T=Yge([_[x]]);if(z(T),n&&T.referencesMissingData())v=!0;else if(h.push(T),s>0&&h.length===s)break}if(!v)break;c===0||(c=0)}return u&&u.destroy(),h}function Yge(t){z(t!==null);const e=new Ij,i=t[0].getSteps();if(i){const s=t[0].getEntries();for(let n=0;n<i;n++){const r=s[n].getDirection()!==0,o=Hge(s[n].getGeogtran(),r);e.add(o)}return e.create()}return null}let Xge=class{constructor(t,e,i,s){this.m_bReadOnly=!0,this.m_name="",this.m_fastTrack=-1,this.m_bNameIsSet=!1,this.m_transforms=t,e&&(this.m_name=e,this.m_bNameIsSet=!0),this.m_inputSr=i,this.m_outputSr=s}getType(){return 0}getName(){if(this.m_bNameIsSet)return this.m_name;if(this.m_transforms.length===0)return"";let t="";for(const e of this.m_transforms)t.length>0&&(t+=" + "),e.isInverted()&&(t+="~"),t+=e.getName();return t}count(){return this.m_transforms.length}createInverse(){return this.getInverse()}getHashCode(){let t=1973;for(let e=0;e<this.m_transforms.length;e++)t=fr(t,this.m_transforms[e].getHashCode());return t}equals(t){return z(0),!1}referencesMissingData(){if(this.m_transforms.length===0)return!1;for(const t of this.m_transforms)if(t.referencesMissingData())return!0;return!1}isMatchingTransformation(t,e){return z(0),!1}validateTransformation(t,e){return z(0),!1}nameIsSet(){return z(0),!1}getInputSpatialReference(){return this.m_inputSr}getOutputSpatialReference(){return this.m_outputSr}getStep(t){return(t<0||t>this.count())&&bi(""),this.m_transforms[t]}getInverse(){const t=new Ij;return t.addSteps(this,!0),t.setInputSpatialReference(this.m_outputSr),t.setOutputSpatialReference(this.m_inputSr),t.create()}transform(t,e,i){if(this.count()===0)return;let s=this.m_inputSr,n=this.m_outputSr;if(t&&(n=Ge(s,s=n)),this.m_transforms.length===0)return void vge(s,null,n,null,e,null,i);let r=this.m_fastTrack;if(r===1)return void lOe(t,this.m_transforms,h=>{l5e(h.getWrapper(),t!==h.isInverted(),e,null,i)});const o=Td();r===-1&&o.initFromGcsAndVcs(s,null);const a=Td();let l=t?this.m_transforms.length-1:0;const u=t?-1:1;for(let h=0,d=this.m_transforms.length;h<d;h++,l+=u){if(h===0){const f=this.m_transforms[l];n5e(s.getPECoordSys(),null,f.getWrapper(),t!==f.isInverted(),e,null,i,a),r===-1&&(o.equals(a)||(r=0)),o.assign(a)}else{const f=this.m_transforms[l-u],_=this.m_transforms[l];o5e(o,f.getWrapper(),t!==f.isInverted(),_.getWrapper(),t!==_.isInverted(),e,null,i,a),r===-1&&(o.equals(a)||(r=0)),o.assign(a)}const m=this.m_transforms[l];a5e(o,m.getWrapper(),t!==m.isInverted(),e,null,i,a),o.assign(a)}const c=this.m_transforms[l-u];r5e(o,c.getWrapper(),t!==c.isInverted(),n,null,e,null,i),r===-1&&(a.initFromGcsAndVcs(n,null),o.equals(a)||(r=0)),this.m_fastTrack=r===0?0:1}};class Ij{constructor(){this.m_transforms=[],this.m_inputGCS=null,this.m_outputGCS=null,this.m_name="",this.m_bNameIsSet=!1}getInputSpatialReference(){return this.m_inputGCS!==null?this.m_inputGCS:this.count()>0?this.m_transforms[0].getInputSpatialReference():null}setInputSpatialReference(e){this.m_inputGCS=e?e.getGCS():null}getOutputSpatialReference(){return this.m_outputGCS!==null?this.m_outputGCS:this.count()>0?this.m_transforms.at(-1).getOutputSpatialReference():null}setOutputSpatialReference(e){this.m_outputGCS=e?e.getGCS():null}getName(){if(this.m_bNameIsSet)return this.m_name;if(this.m_transforms.length===0)return"";let e="";for(const i of this.m_transforms)e.length>0&&(e+=" + "),i.isInverted()&&(e+="~"),e+=i.getName();return e}count(){return this.m_transforms.length}getStep(e){return(e<0||e>this.count())&&bi(""),this.m_transforms[e]}setStep(e,i){z(0)}add(e){this.m_transforms.push(e)}addSteps(e,i){if(i)for(let s=e.count()-1;s>=0;--s)this.add(e.getStep(s).getInverse());else for(let s=0;s<e.count();++s)this.add(e.getStep(s))}clear(){this.m_transforms=[],this.m_name="",this.m_bNameIsSet=!1,this.m_inputGCS=null,this.m_outputGCS=null}remove(e){z(0)}create(){const e=this.getInputSpatialReference(),i=this.getOutputSpatialReference(),s=new Xge(this.m_transforms,this.m_bNameIsSet?this.m_name:null,e,i);return s.m_bReadOnly=!0,this.clear(),s}}const HVe=Object.freeze(Object.defineProperty({__proto__:null,SpatialReference:Wf,SpatialReferencePrecisionDescriptor:ta,create:A1,createFromWKT:bS,createImplFromPe:aM,createLocal:Pj,createWithNewPrecision:x4,createWithNewVCS:IB,getGCS:h3,getTempName:Uge,hasNoPe:Tj,hasPe:gc,injectNoPe:Cj,injectPe:IVe,isInitialized:v4,isTempName:Vge,isValidWkid:ML,isValidWkt:AL,makeSpheroidData:H1,snapGeometry:kge,webMercator:b4,webMercator102100:Mj,wgs84:w4},Symbol.toStringTag,{value:"Module"})),jVe=Object.freeze(Object.defineProperty({__proto__:null,OperatorProject:Cd},Symbol.toStringTag,{value:"Module"})),YVe=Object.freeze(Object.defineProperty({__proto__:null,CompositeGeographicTransformation:Xge,CompositeGeographicTransformationEditor:Ij,createImpl:Yge,queryGtListImpl:jge},Symbol.toStringTag,{value:"Module"})),XVe=Object.freeze(Object.defineProperty({__proto__:null,GeographicTransformation:T4,create:BVe,createFromPe:Hge,createFromWKT:qVe},Symbol.toStringTag,{value:"Module"})),WVe=Object.freeze(Object.defineProperty({__proto__:null,ProjectionTransformation:wj,create:hVe,createEx:Qv,createFromAoi:Rge,createImplEx:vj,makeExtendedParams:xj,makeExtendedParamsInternal:bj,queryTransformationList:Oge},Symbol.toStringTag,{value:"Module"})),ZT=Object.freeze(Object.defineProperty({__proto__:null,$:U5e,A:l4e,B:gge,C:pu,D:xS,get E(){return Lo},get F(){return zl},G:H1,H:_ge,I:VUe,J:hge,K:dge,L:Nge,M:NUe,N:vB,O:bge,P:Ts,Q:Cr,R:g4,S:y4,T:Vl,U:nj,V:u3,W:rM,X:uj,Y:yS,get Z(){return yo},_:a3,a:pj,a0:Sfe,a1:g4e,a2:ZC,a3:$5e,get a4(){return $t},a5:hj,a6:T4e,a7:pB,a8:vj,a9:wB,aA:AL,aB:ML,aC:bB,aD:x4,aE:ta,aF:E1,aG:HVe,aH:jVe,aI:YVe,aJ:XVe,aK:WVe,aa:bj,ab:xj,ac:M1,ad:fc,ae:Lfe,af:xge,ag:mj,ah:V$e,ai:nUe,aj:oge,ak:lge,al:J$e,am:gc,an:bf,ao:kge,ap:j$e,aq:Qh,ar:ud,as:dUe,at:sc,au:As,av:pA,aw:Uge,get ax(){return xr},ay:k5e,az:E4e,b:bS,c:A1,d:dj,e:f4,f:P1,g:Am,h:wL,i:ul,j:Cj,k:mu,l:nc,m:Q$e,n:sge,o:J4e,p:Qv,q:D$e,r:_f,s:od,get t(){return lM},u:yB,v:Cd,w:nE,x:cge,y:vL,z:Pj},Symbol.toStringTag,{value:"Module"}));Cj(t=>{let e,i;typeof t=="number"?e=t:i=t;const s={wkid:e,wkt:i};let n,r;if(i){n=IF(i);const o=Rf(s);if(!n&&!o)throw new Error(`Unsupported WKT type: ${i}`)}else n=!Rf(s);return r=e&&Nce.has(e)?Math.PI/200:n?OH(s):Math.PI/180,{isPCS:n,metersOrRadiansPerUnit:r,semiMajor:0,wkidOrWkt:t}});function ZVe(){if(this.m_i===-1)return this.m_i=0,{value:{m_token:1,m_value:null},done:!1};if(this.m_i<this.m_keys.length){const t=this.m_bReturnKey,e=Math.trunc(this.m_i);return this.m_bReturnKey=!this.m_bReturnKey,this.m_i+=.5,t?{value:{m_token:5,m_value:this.m_keys[e]},done:!1}:{value:{m_token:6,m_value:this.m_o[this.m_keys[e]]},done:!1}}return{value:{m_token:3,m_value:null},done:!0}}function KVe(){if(this.m_i===-1)return this.m_i=0,{value:{m_token:2,m_value:null},done:!1};if(this.m_i<this.m_a.length){const t={value:{m_token:6,m_value:this.m_a[this.m_i++]},done:!1};return this.m_strict||t.value.m_value===void 0&&(t.value.m_value=Number.NaN),t}return{value:{m_token:4,m_value:null},done:!0}}let QVe=class{createJSONObjectIterator(e){return{m_iteratorType:"object",m_o:e,m_keys:this.m_options.strict?Object.keys(e):Object.keys(e).filter(i=>e[i]!==void 0),m_i:-1,m_bReturnKey:!0,next:ZVe}}createJSONArrayIterator(e){return{m_iteratorType:"array",m_strict:this.m_options.strict,m_i:-1,m_a:e,next:KVe}}constructor(e,i){this.m_currentToken=0,this.m_options=i?{...i}:{strict:!0};const s=e;this.m_iteratorStack=[s instanceof Array?this.createJSONArrayIterator(s):this.createJSONObjectIterator(s)],this.m_nextFlatToken={m_value:null,m_token:0}}nextToken(){if(this.m_iteratorStack.length===0)return this.m_currentToken=0;switch(this.m_nextFlatToken=this.m_iteratorStack.at(-1).next().value,this.m_currentValue=void 0,this.m_nextFlatToken.m_token){case 1:return this.m_currentToken=1;case 3:return this.m_iteratorStack.pop(),this.m_currentToken=3;case 2:return this.m_currentToken=2;case 4:return this.m_iteratorStack.pop(),this.m_currentToken=4;case 5:return this.m_currentValue=this.m_nextFlatToken.m_value,this.m_currentToken=5;case 6:if(this.m_nextFlatToken.m_value instanceof Array)return this.m_iteratorStack.push(this.createJSONArrayIterator(this.m_nextFlatToken.m_value)),this.nextToken();if(this.m_nextFlatToken.m_value instanceof Object)return this.m_iteratorStack.push(this.createJSONObjectIterator(this.m_nextFlatToken.m_value)),this.nextToken();if(typeof this.m_nextFlatToken.m_value=="number")return this.m_currentValue=this.m_nextFlatToken.m_value,Number.isSafeInteger(this.m_currentValue)&&this.m_currentValue>=d3e()&&this.m_currentValue<=fo()?this.m_currentToken=8:this.m_currentToken=7;if(typeof this.m_nextFlatToken.m_value=="string")return this.m_currentValue=this.m_nextFlatToken.m_value,this.m_currentToken=6;if(typeof this.m_nextFlatToken.m_value=="boolean")return this.m_currentValue=this.m_nextFlatToken.m_value,this.m_currentToken=this.m_nextFlatToken.m_value?11:12;if(typeof this.m_nextFlatToken.m_value=="object")return this.m_currentValue=null,this.m_currentToken=10;We("unrecognized json element type")}return We("unrecognized json element type"),0}currentToken(){return this.m_currentToken}skipChildren(){if(this.m_iteratorStack.length!==0)switch(this.m_currentValue=void 0,this.m_nextFlatToken.m_token){case 1:return this.m_iteratorStack.pop(),this.m_nextFlatToken.m_token=3,void(this.m_currentToken=3);case 2:return this.m_iteratorStack.pop(),this.m_nextFlatToken.m_token=4,void(this.m_currentToken=4)}}currentString(){return this.m_currentToken!==6&&this.m_currentToken!==5&&ce("invalid token"),this.m_currentValue}currentDoubleValue(){return this.m_currentToken!==7&&this.m_currentToken!==8&&ce("invalid token"),this.m_currentValue}currentInt32Value(){return this.m_currentToken!==8&&ce("invalid token"),this.m_currentValue}currentInt64Value(){return z(0),0n}currentBoolValue(){return this.m_currentToken!==12&&this.m_currentToken!==11&&ce("invalid token"),this.m_currentValue}isError(){return 0}},JVe=class{constructor(){this.m_pendingKey=null,this.m_acceptedObject=null,this.m_currentObject=[]}reset(){this.m_pendingKey=null,this.m_acceptedObject=null,this.m_currentObject.length=0}startObject(){const e={};this.m_pendingKey?(this.m_currentObject.at(-1)[this.m_pendingKey]=e,this.m_pendingKey=null):Array.isArray(this.m_currentObject.at(-1))&&this.m_currentObject.at(-1).push(e),this.m_currentObject.push(e)}startArray(){const e=[];this.m_pendingKey?(this.m_currentObject.at(-1)[this.m_pendingKey]=e,this.m_pendingKey=null):Array.isArray(this.m_currentObject.at(-1))&&this.m_currentObject.at(-1).push(e),this.m_currentObject.push(e)}endObject(){this.m_acceptedObject=this.m_currentObject.at(-1),this.m_currentObject.pop()}endArray(){this.m_currentObject.pop()}addFieldName(e){this.m_pendingKey=e}addValue_(e){this.m_pendingKey?(this.m_currentObject.at(-1)[this.m_pendingKey]=e,this.m_pendingKey=null):this.m_currentObject.at(-1).push(e)}addString(e){this.addValue_(e)}addDouble(e,i){this.addValue_(e)}addInt64(e){z(0)}addInt32(e){this.addValue_(e)}addBool(e){this.addValue_(e)}addNull(){this.addValue_(null)}getObject(){return this.m_acceptedObject}},P4=class OB{constructor(e){return this.m_buffer=null,this.m_view=null,this.m_sz=0,this.m_offset=0,this.m_bOwnsBuffer=!0,this.m_bLittleEndian=!0,this.m_element=new ArrayBuffer(8),this.m_elementBytes=new Uint8Array(this.m_element),this.m_elementView=new DataView(this.m_element),this.m_elementDouble=new Float64Array(this.m_element),this.m_elementFloat=new Float32Array(this.m_element),this.m_elementInt64=new BigInt64Array(this.m_element),this.m_elementInt32=new Int32Array(this.m_element),this.m_elementInt16=new Int16Array(this.m_element),e.sz!==void 0?(this.m_sz=e.sz,e.buffer?(this.m_sz<0&&bi("size out of range"),this.m_buffer=e.buffer,this.m_offset=e.offset!==void 0?e.offset:0,this.m_view=e.offset!==void 0?new DataView(e.buffer,e.offset,e.sz):new DataView(this.m_buffer),this.m_bOwnsBuffer=!1,void(this.m_bLittleEndian=!0)):(this.m_sz<0&&bi("size out of range"),void(this.m_sz>0&&(this.m_buffer=new ArrayBuffer(this.m_sz),this.m_view=new DataView(this.m_buffer))))):e.move?(this.m_sz=e.move.m_sz,this.m_buffer=e.move.m_buffer,this.m_view=e.move.m_view,this.m_bOwnsBuffer=e.move.m_bOwnsBuffer,this.m_bLittleEndian=e.move.m_bLittleEndian,e.move.m_buffer=null,e.move.m_view=null,e.move.m_sz=0,void(e.move.m_bOwnsBuffer=!0)):void We("unrecognized constructor options")}swapBytesDouble(){this.doSwap()&&(this.m_elementDouble[0]=this.m_elementBytes[0]<<56|this.m_elementBytes[1]<<48|this.m_elementBytes[2]<<40|this.m_elementBytes[3]<<32|this.m_elementBytes[4]<<24|this.m_elementBytes[5]<<16|this.m_elementBytes[6]<<8|this.m_elementBytes[7])}swapBytesInt32(){this.doSwap()&&(this.m_elementInt32[0]=this.m_elementBytes[0]<<24|this.m_elementBytes[1]<<16|this.m_elementBytes[2]<<8|this.m_elementBytes[3])}getOffset(){return this.m_offset}assignMove(e){return this===e||(this.clear(),this.m_sz=e.m_sz,this.m_buffer=e.m_buffer,this.m_view=e.m_view,this.m_bOwnsBuffer=e.m_bOwnsBuffer,this.m_bLittleEndian=e.m_bLittleEndian,e.m_buffer=null,e.m_sz=0,e.m_bOwnsBuffer=!0),this}doSwap(){return this.m_bLittleEndian!==(OB.getNativeByteOrder()===1)}setNativeByteOrder(){this.m_bLittleEndian=OB.getNativeByteOrder()===1}setOrder(e){this.m_bLittleEndian=e===1}getOrder(){return this.m_bLittleEndian?1:0}getView(){return this.m_view||un("buffer not defined"),this.m_view}static getNativeByteOrder(){return 1}clear(){this.m_buffer=null,this.m_sz=0,this.m_bOwnsBuffer=!0}size(){return this.m_sz}readDouble(e){return this.doSwap()?(this.m_elementDouble[0]=this.m_view.getFloat64(e,this.m_bLittleEndian),this.swapBytesDouble(),this.m_elementDouble[0]):this.m_view.getFloat64(e,this.m_bLittleEndian)}writeDouble(e,i){this.m_elementDouble[0]=i,this.swapBytesDouble(),this.m_view.setFloat64(e,this.m_elementDouble[0],this.m_bLittleEndian)}readInt32(e){return this.doSwap()?(this.m_elementInt32[0]=this.m_view.getInt32(e,this.m_bLittleEndian),this.swapBytesInt32(),this.m_elementInt32[0]):this.m_view.getInt32(e,this.m_bLittleEndian)}writeInt32(e,i){this.m_elementInt32[0]=i,this.swapBytesInt32(),this.m_view.setInt32(e,this.m_elementInt32[0],this.m_bLittleEndian)}getPtr(){return this.m_buffer}setSizeNoRealloc(e){z(e>=0&&e<=this.m_sz),this.m_sz=e}};function eze(t,e,i,s,n,r){let o=!1,a=!1,l=!1,u=!1,c=!1,h=!1,d=!1,m=!1,f=!1,_=!1,v=!1,x=!1,w=!1,T=!1,C=!1,M=!1,A=!1,I=!1,L=!1,D=!1,O=!1,U=!1,$=!1,B=!1,V=Number.NaN,H=Number.NaN,Y=Number.NaN,W=Number.NaN,ee=0,ne=Number.NaN,j=Number.NaN,oe=Number.NaN,ve=Number.NaN,Ye=Number.NaN,de=Number.NaN,fe=Number.NaN,Ne=Number.NaN,je=0,Ee=0,Zt=!1,qt=!1,Mi=null,oi=null,si=null,me=null,Bi=null;for(;i.nextToken()!==3;){const pt=i.currentString();if(i.nextToken(),pt==="spatialReference"){if(n&&!o){o=!0,i.currentToken()===1?me=ize(i):i.currentToken()!==10&&ce("failed to parse spatial reference: object or null is expected");continue}}else if(s)if(pt==="hasZ"){if(!a){a=!0,Zt=i.currentToken()===11;continue}}else if(pt==="hasM"){if(!l){l=!0,qt=i.currentToken()===11;continue}}else if(pt==="rings"){if(!(c||h||t!==q.enumUnknown&&t!==q.enumPolygon)){c=!0,{geometry:Bi,as:Mi,bs:oi}=eN(!0,!1,e,i);continue}}else if(pt==="curveRings"){if(!h&&(t===q.enumUnknown||t===q.enumPolygon)){h=!0,{geometry:Bi,as:Mi,bs:oi}=eN(!0,!0,e,i);continue}}else if(pt==="paths"){if(!(d||m||t!==q.enumUnknown&&t!==q.enumPolyline)){d=!0,{geometry:Bi,as:Mi,bs:oi}=eN(!1,!1,e,i);continue}}else if(pt==="curvePaths"){if(!m&&(t===q.enumUnknown||t===q.enumPolyline)){m=!0,{geometry:Bi,as:Mi,bs:oi}=eN(!1,!0,e,i);continue}}else if(pt==="points"){if(!f&&(t===q.enumUnknown||t===q.enumMultiPoint)){f=!0,{geometry:Bi,as:Mi,bs:oi}=sze(e,i);continue}}else if(pt==="ids"){if(!u){u=!0,si=nze(e,i);continue}}else if(pt==="x"){if(!_&&(t===q.enumUnknown||t===q.enumPoint)){_=!0,V=rn(i);continue}}else if(pt==="y"){if(!v&&(t===q.enumUnknown||t===q.enumPoint)){v=!0,H=rn(i);continue}}else if(pt==="z"){if(!x&&(t===q.enumUnknown||t===q.enumPoint)){x=!0,Y=rn(i);continue}}else if(pt==="m"){if(!w&&(t===q.enumUnknown||t===q.enumPoint)){w=!0,W=rn(i);continue}}else if(pt==="id"){if(!T&&(t===q.enumUnknown||t===q.enumPoint)){T=!0,ee=KT(i);continue}}else if(pt==="xmin"){if(!C&&(t===q.enumUnknown||t===q.enumEnvelope)){C=!0,ne=rn(i);continue}}else if(pt==="ymin"){if(!M&&(t===q.enumUnknown||t===q.enumEnvelope)){M=!0,j=rn(i);continue}}else if(pt==="mmin"){if(!O&&(t===q.enumUnknown||t===q.enumEnvelope)){O=!0,fe=rn(i);continue}}else if(pt==="zmin"){if(!L&&(t===q.enumUnknown||t===q.enumEnvelope)){L=!0,Ye=rn(i);continue}}else if(pt==="idmin"){if(!$&&(t===q.enumUnknown||t===q.enumEnvelope)){$=!0,je=KT(i);continue}}else if(pt==="xmax"){if(!A&&(t===q.enumUnknown||t===q.enumEnvelope)){A=!0,oe=rn(i);continue}}else if(pt==="ymax"){if(!I&&(t===q.enumUnknown||t===q.enumEnvelope)){I=!0,ve=rn(i);continue}}else if(pt==="mmax"){if(!U&&(t===q.enumUnknown||t===q.enumEnvelope)){U=!0,Ne=rn(i);continue}}else if(pt==="zmax"){if(!D&&(t===q.enumUnknown||t===q.enumEnvelope)){D=!0,de=rn(i);continue}}else if(pt==="idmax"){if(!B&&(t===q.enumUnknown||t===q.enumEnvelope)){B=!0,Ee=KT(i);continue}}else pt==="materials"&&z(0);i.skipChildren()}if(c||h||d||m||f){let pt=null,$e=null;const wt=Bi;Zt&&(Bi.addAttribute(1),pt=Mi,pt||(pt=Nl(wt.getPointCount(),Number.NaN))),qt&&(Bi.addAttribute(2),$e=Zt?oi:Mi),si!=null&&Bi.addAttribute(3),Zt&&pt!=null&&wt.setAttributeStreamRef(1,pt),qt&&$e!=null&&wt.setAttributeStreamRef(2,$e),si!=null&&rze(wt,si)}else if(_||v||w||x||T){Q3e(V,H)||ce("failed to parse point: x and y must be finite or nan"),(Number.isNaN(H)||Number.isNaN(V))&&(V=Number.NaN,H=Number.NaN);const pt=new Jt({x:V,y:H});x&&pt.setZ(Y),w&&pt.setM(W),T&&pt.setID(ee),Bi=pt}else if(C||M||A||I||L||D||O||U||$||B){(Number.isNaN(j)||Number.isNaN(oe)||Number.isNaN(ve))&&(ne=Number.NaN);const pt=new Fo({xmin:ne,ymin:j,xmax:oe,ymax:ve});L&&D&&pt.setInterval(1,0,Ye,de),O&&U&&pt.setInterval(2,0,fe,Ne),$&&B&&pt.setInterval(3,0,je,Ee),Bi=pt}return{...Bi?{geom:Bi}:{},...me?{sr:me}:{}}}function tze(t){let e=!1;for(;t.nextToken()!==3;){const i=t.currentString();t.nextToken(),i==="uwkid"?e||(e=!0,t.currentToken()===8&&t.currentInt32Value()):t.skipChildren()}return null}function ize(t){let e=!1,i=!1,s=!1,n=!1,r=!1,o=!1,a=!1,l=!1,u=!1,c=!1,h=!1,d=!1,m=!1,f=!1,_=!1,v=!1,x=!1,w=-1,T=-1,C=-1,M=-1,A=0,I=0,L=0,D=0,O=0,U=0,$=0,B=0,V=0,H=0,Y="",W="",ee=null;for(;t.nextToken()!==3;){const oe=t.currentString();t.nextToken(),oe==="wkid"?e||(e=!0,t.currentToken()===8&&(w=t.currentInt32Value())):oe==="latestWkid"?i||(i=!0,t.currentToken()===8&&(T=t.currentInt32Value())):oe==="wkt"?r||(r=!0,t.currentToken()===6&&(Y=t.currentString())):oe==="wkt2"?r||t.currentToken()===6&&(W=t.currentString()):oe==="vcsWkid"?s||(s=!0,t.currentToken()===8&&(C=t.currentInt32Value())):oe==="latestVcsWkid"?n||(n=!0,t.currentToken()===8&&(M=t.currentInt32Value())):oe==="xyTolerance"?a||(a=!0,o=!0,A=t.currentDoubleValue()):oe==="zTolerance"?l||(l=!0,o=!0,I=t.currentDoubleValue()):oe==="mTolerance"?u||(u=!0,o=!0,L=t.currentDoubleValue()):oe==="falseX"?c||(c=!0,o=!0,$=t.currentDoubleValue()):oe==="falseY"?h||(h=!0,o=!0,B=t.currentDoubleValue()):oe==="falseZ"?d||(d=!0,o=!0,V=t.currentDoubleValue()):oe==="falseM"?m||(m=!0,o=!0,H=t.currentDoubleValue()):oe==="xyUnits"?f||(f=!0,o=!0,D=t.currentDoubleValue()):oe==="zUnits"?_||(_=!0,o=!0,O=t.currentDoubleValue()):oe==="mUnits"?v||(v=!0,o=!0,U=t.currentDoubleValue()):oe==="unit"?x||(x=!0,ee=tze(t)):t.skipChildren()}M<=0&&C>0&&(M=C),C<=0&&M>0&&(C=M);let ne=null,j=!0;if(Y.length!==0&&(j=!1,AL(Y)&&(ne=bS(Y))),ne||W.length===0||(j=!1,AL(W)&&(ne=bS(W))),!ne&&T>0&&(j=!1,ML(T)&&(M<=0||bB())&&(ne=A1(T,M))),!ne&&w>0&&(j=!1,ML(w)&&(C<=0||bB())&&(ne=A1(w,C))),j&&(ne=Pj(ee)),o&&ne){const oe=new ta;ne.queryPrecisionDescriptorWithoutFalseXY(oe),a&&oe.setTolerance(0,A),l&&oe.setTolerance(1,I),u&&oe.setTolerance(2,L),f&&c&&h&&oe.setGridParams($,B,D),_&&d&&oe.setZParams(V,O),v&&m&&oe.setMParams(H,U),ne=x4(ne,oe)}return ne}function eN(t,e,i,s){s.currentToken()!==2&&ce("failed to parse multipath: array of array of vertices is expected");const n=t?new Ci:new Qi,r=n,o=Do(0),a=Nl(2,0),l=_m(0);let u=null,c=null,h=null,d=null,m=null,f=0,_=0,v=0;const x=new ii,w=N.getNAN();let T=0,C=0;const M=t?1:0;for(;s.nextToken()!==4;){s.currentToken()!==2&&ce("failed to parse multipath: ring/path array is expected");let A=2,I=0,L=!0;const D=4;let O=0,U=0;const $=N.getNAN(),B=st(D,Number.NaN),V=st(D,Number.NaN);let H=!1;for(s.nextToken();s.currentToken()!==4;){if(e&&s.currentToken()===1)L&&ce("failed to parse multipath: starting vertex array is expected"),h||(h=_m(T-1,1),d=Do(T-1,-1),m=Nl(0)),H=!0,A=1,{segFlag:v,toPointSz:O}=cze(x,B,w,s);else{for(H=!1,s.currentToken()!==2&&ce("failed to parse multipath: array is expected, rings/paths vertices consist of arrays of coordinates"),O=0;s.nextToken()!==4;)O===D&&ce("failed to parse multipath: each vertex array has to have at most 4 elements"),B[O++]=rn(s);O<2&&ce("failed to parse multipath: each vertex array has to have at least 2 elements"),hpe(B[0],B[1])||ce("failed to parse multipath: x and y must be finite")}s.nextToken();do{if(a.size()===2*T&&a.resize(Wge(T)),a.writePoint2D(2*T,$.setCoords(B[0],B[1])),u&&u.size()===T&&u.resize(Jv(T)),O>2?(u||(u=Nl(T+1,Number.NaN)),u.write(T,B[2])):u&&u.write(T,Number.NaN),c&&c.size()===T&&c.resize(Jv(T)),O>3?(c||(c=Nl(T+1,Number.NaN)),c.write(T,B[3])):c&&c.write(T,Number.NaN),L)C++,o.add(T),l.add(M),L=!1,U=O,Qs(V,B,0,0,U);else if(h!==null)if(H){const Y=qu(v),W=m.size();m.resize(W+Y),h.add(v),d.add(f),x.get().writeInBufferStream(m,f),f+=Y,r.incCurveType(v,1),_++}else h.add(1),d.add(-1);T++,I++,w.setCoords(B[0],B[1])}while(I<A&&s.currentToken()===4)}I!==0&&(t&&I>A&&O===U&&i3e(B,V,O)===0?(T--,I--):h!==null&&(h.add(1),d.add(-1)))}return T&&(o.resize(C),l.resize(C),T>0&&(o.add(T),l.add(0)),r.setAttributeStreamRef(0,a),r.setPathFlagsStreamRef(l),r.setPathStreamRef(o),h!==null&&(r.updateCurveCounter(_),r.setSegmentData(d,m,h,f)),r.notifyModifiedFlags(65535)),{geometry:n,as:u,bs:c}}function sze(t,e){e.currentToken()!==2&&ce("failed to parse multipoint: array of vertices is expected");let i=0;const s=new Dn,n=Nl(2,0);let r=0;const o=4,a=st(o,Number.NaN),l=new N;let u=null,c=null;for(;e.nextToken()!==4;){for(e.currentToken()!==2&&ce("failed to parse multipoint: array is expected, multipoint vertices consist of arrays of cooridinates"),r=0;e.nextToken()!==4;)r===o&&ce("failed to parse multipoint: each vertex array has to have at most 4 elements"),a[r++]=rn(e);r<2&&ce("failed to parse multipoint: each vertex array has to have at least 2 elements"),hpe(a[0],a[1])||ce("failed to parse multipoint: x and y must be finite"),n.size()===2*i&&n.resize(Wge(i)),n.writePoint2D(2*i,l.setCoords(a[0],a[1])),u&&u.size()===i&&u.resize(Jv(i)),r>2?(u||(u=Nl(i+1,Number.NaN)),u.write(i,a[2])):u&&u.write(i,Number.NaN),c&&c.size()===i&&c.resize(Jv(i)),r>3?(c||(c=Nl(i+1,Number.NaN)),c.write(i,a[3])):c&&c.write(i,Number.NaN),i++}if(i){const h=s.getImpl();h.setAttributeStreamRef(0,n),h.resizeNoInit(i),h.notifyModifiedFlags(65535)}return{geometry:s,as:u,bs:c}}function nze(t,e){e.currentToken()!==2&&ce("failed to parse array of IDs: array of array of integers is expected");const i=t4(2,0);let s=0,n=-1;for(;e.nextToken()!==4;){const r=s;i.size()===s&&i.resize(Jv(s)),s++;let o=0;for(n===-1?n=e.currentToken()===2?1:0:n===1&&e.currentToken()!==2&&ce("failed to parse array of IDs: array of array of integers is expected"),n===0&&(i.size()===s&&i.resize(Jv(s)),i.write(s,KT(e)),o++,s++);e.nextToken()!==4;)i.size()===s&&i.resize(Jv(s)),i.write(s,KT(e)),o++,s++;if(i.write(r,o),n===0)break}return i.resize(s),i}function rn(t){const e=t.currentToken();if(e===10||e===6&&t.currentString()==="NaN")return Number.NaN;{const i=t.currentDoubleValue();return Number.isNaN(i)?Number.NaN:i}}function KT(t){return t.currentInt32Value()}function rze(t,e){if(t.isEmpty())return;const i=t4(2,0),s=t.getGeometryType();let n=0;s===Dn.type?n=1:s===Qi.type||s===Ci.type?n=t.getPathCount():We("not implemented"),i.resize(t.getPointCount(),0);let r=0;for(let o=0;o<n;++o){const a=e.read(r);r++;const l=r+a;let u=0,c=0;s===Dn.type?u=t.getPointCount():s===Qi.type||s===Ci.type?(u=t.getPathSize(o),c=t.getPathStart(o)):We("not implemented");for(let h=0,d=Math.min(a,u);h<d;++h)i.write(c,e.read(r)),r++,c++;r=l}t.getImpl().setAttributeStreamRef(3,i)}function Wge(t){let e=2*Math.trunc(3*(t+1)/2);return e<8?e=8:e<32&&(e=32),e}function Jv(t){let e=Math.trunc(3*(t+1)/2);return e<4?e=4:e<16&&(e=16),e}function oze(t,e,i,s,n){n>=s.size()&&bi("Byte_buffer out of range access"),t.m_bits=0,t.m_rotation=0,t.m_cosr=1,t.m_sinr=0,t.setStartXY(e),t.setEndXY(i);const r=N.getNAN();r.x=s.readDouble(n),r.y=s.readDouble(n+8);const o=s.readInt32(n+16);if(1&o)return t.m_semiMajorAxis=0,t.m_minorMajorRatio=1,t.m_interior.assign(r),t.m_center.setNAN(),t.m_sweepAngle=0,t.m_startAngle=0,Cf(t),!1;let a=!!(64&o);const l=!!(128&o);let u=!!(32&o);const c=!!(8&o),h=!!(16&o),d=e.equals(i);return a&&!d&&(a=!1,u=!0),u&&d&&(a=!0,u=!1,r.setCoords(0,0)),a||(l?u?(t.m_semiMajorAxis=1,t.m_minorMajorRatio=0,t.m_interior.assign(r),t.m_center.setNAN(),t.m_sweepAngle=0,t.m_startAngle=0):(t.constructCircularArcThreePoint(e,i,r),d&&c===t.isClockwise()&&t.reverse()):u?(t.m_semiMajorAxis=1,t.m_minorMajorRatio=0,t.m_center.setNAN(),t.m_sweepAngle=0,t.m_startAngle=0,Cf(t),t.queryCoord2D(.5,t.m_interior)):hfe(t,e,i,r,c,h)),a&&(t.m_center.assign(e),t.m_startAngle=r.x,t.m_sweepAngle=r.y,Q7(t,Number.NaN,c,h),t.m_semiMajorAxis=0,t.m_minorMajorRatio=1,t.m_interior.setCoordsPoint2D(e)),t.setProjectionBehavior(0),Cf(t),!0}function aze(t,e,i,s,n){t.m_bits=0,t.m_center.x=s.readDouble(n),t.m_center.y=s.readDouble(n+8),t.m_rotation=s.readDouble(n+16),t.m_semiMajorAxis=s.readDouble(n+24),t.m_minorMajorRatio=s.readDouble(n+32),t.m_XStart=e.x,t.m_YStart=e.y,t.m_XEnd=i.x,t.m_YEnd=i.y;const r=s.readInt32(n+40);if(1&r)return!1;let o=!!(64&r),a=!!(128&r);const l=!!(2048&r),u=!!(4096&r);return!(512&r)&&!(1024&r)||a||(o=!0),a&&!e.equals(i)?(a=!1,o=!0):o&&e.equals(i)&&(a=!0,o=!1),a?(t.m_center.assign(e),t.m_startAngle=t.m_center.x,t.m_sweepAngle=t.m_center.y,Q7(t,Number.NaN,l,u),t.m_semiMajorAxis=0,t.m_interior.setCoordsPoint2D(e)):o?(t.m_center.setNAN(),t.m_semiMajorAxis=1,t.m_minorMajorRatio=0,t.m_center.setNAN(),t.m_sweepAngle=0,t.m_startAngle=0,Cf(t),t.queryCoord2D(.5,t.m_interior)):t.constructEllipticArcEndPointsCenter(e,i,t.m_semiMajorAxis,t.m_minorMajorRatio,t.m_rotation,!u,l,t.m_center),t.setProjectionBehavior(1),Cf(t),!0}function lze(t,e,i,s,n){return z(n+32<=s.size()),t.m_cp=he(N,2),t.m_cp[0].x=s.readDouble(n),t.m_cp[0].y=s.readDouble(n+8),t.m_cp[1].x=s.readDouble(n+16),t.m_cp[1].y=s.readDouble(n+24),t.m_XStart=e.x,t.m_YStart=e.y,t.m_XEnd=i.x,t.m_YEnd=i.y,!0}function uze(t,e,i,s,n){return t.m_cp.x=s.readDouble(n),t.m_cp.y=s.readDouble(n+8),t.m_weights[0]=s.readDouble(n+16),t.m_weights[1]=s.readDouble(n+24),t.m_weights[2]=s.readDouble(n+32),t.m_XStart=e.x,t.m_YStart=e.y,t.m_XEnd=i.x,t.m_YEnd=i.y,!0}function cze(t,e,i,s,n){const r={segFlag:0,toPointSz:0};let o=s.currentToken();o=s.nextToken();const a=s.currentString(),l=a[0];for((a.length!==1||l!=="a"&&l!=="b"&&l!=="c"&&l!=="n"&&l!=="q")&&ce('failed to parse curve: expecting "a", "b", "n", "q", or "c"'),o=s.nextToken(),o!==2&&ce("failed to parse curve: start array is expected for curve parameters"),o=s.nextToken(),o!==2&&ce("failed to parse curve: start array is expected for to point"),r.toPointSz=0;s.nextToken()!==4;)r.toPointSz===4&&ce("failed to parse curve: vertex array cannot have more than 4 elements"),e[r.toPointSz++]=rn(s);r.toPointSz<2&&ce("failed to parse curve: vertex array must have at least 2 elements");const u=N.construct(e[0],e[1]),c=N.getNAN();let h=-1,d=-1,m=!1,f=Number.NaN,_=Number.NaN,v=Number.NaN;const x=[N.getNAN(),N.getNAN(),N.getNAN()],w=N.getNAN();if(l==="a"){o=s.nextToken(),o!==2&&ce("failed to parse curve: start array is expected for center point"),o=s.nextToken();const T=rn(s);o=s.nextToken();const C=rn(s);o=s.nextToken(),o!==4&&ce("failed to parse curve: end array is expected for center point"),c.setCoords(T,C),o=s.nextToken(),h=s.currentInt32Value(),o=s.nextToken(),d=s.currentInt32Value(),o=s.nextToken(),o!==4?(m=!1,f=rn(s),o=s.nextToken(),_=rn(s),o=s.nextToken(),v=rn(s),o=s.nextToken(),o!==4&&ce("failed to parse curve: end array is expected for curve parameters")):m=!0,r.segFlag=4}else if(l==="b"){for(let T=0;T<2;T++){o=s.nextToken(),o!==2&&ce("failed to parse curve: start array is expected for control point"),o=s.nextToken();const C=rn(s);o=s.nextToken();const M=rn(s);o=s.nextToken(),o!==4&&ce("failed to parse curve: end array is expected for control point"),x[T].setCoords(C,M)}o=s.nextToken(),o!==4&&ce("failed to parse curve: end array is expected for curve parameters"),r.segFlag=2}else if(l==="n"){{o=s.nextToken(),o!==2&&ce("failed to parse curve: start array is expected for control point"),o=s.nextToken();const A=rn(s);o=s.nextToken();const I=rn(s);o=s.nextToken(),o!==4&&ce("failed to parse curve: end array is expected for control point"),x[0].setCoords(A,I)}o=s.nextToken();const T=rn(s);o=s.nextToken();const C=rn(s);o=s.nextToken();const M=rn(s);x[1].setCoords(T,C),x[2].setCoords(M,M),o=s.nextToken(),o!==4&&ce("failed to parse curve: end array is expected for curve parameters"),r.segFlag=8}else if(l==="q"){for(let T=0;T<1;T++){o=s.nextToken(),o!==2&&ce("failed to parse curve: start array is expected for control point"),o=s.nextToken();const C=rn(s);o=s.nextToken();const M=rn(s);o=s.nextToken(),o!==4&&ce("failed to parse curve: end array is expected for control point"),x[T].setCoords(C,M)}o=s.nextToken(),o!==4&&ce("failed to parse curve: end array is expected for curve parameters"),r.segFlag=16}else{o=s.nextToken(),o!==2&&ce("failed to parse curve: start array is expected for interior point"),o=s.nextToken();const T=rn(s);o=s.nextToken();const C=rn(s);o=s.nextToken(),o!==4&&ce("failed to parse curve: end array is expected for interior point"),w.setCoords(T,C),o=s.nextToken(),o!==4&&ce("failed to parse curve: end array is expected for curve parameters"),r.segFlag=4}return o=s.nextToken(),o!==3&&ce("failed to parse curve: end object is expected for curve"),l==="a"?(t.createEllipticArc(),m?Ste(t.get(),i,u,c,!0,h,d):hze(t.get(),i,u,c,h,d,f,_,v)):l==="b"?(t.createCubicBezier(),dze(t.get(),i,u,x)):l==="n"?(t.createQuadraticRationalBezier(),mze(t.get(),i,u,x[0],x[1].x,x[1].y,x[2].x)):l==="q"?(t.createQuadraticBezier(),t.get().construct(i,x[0],u)):(t.createEllipticArc(),Ste(t.get(),i,u,w,!1,-1,-1)),r}function Ste(t,e,i,s,n,r,o){t.dropAllAttributes();const a=20,l=new ArrayBuffer(a),u=new P4({sz:a,buffer:l});let c=0;u.writeDouble(c,s.x),c+=8,u.writeDouble(c,s.y),c+=8;let h=0;n?(o||(h|=8),r&&(h|=16)):h|=128,u.writeInt32(c,h),c+=4,oze(t,e,i,u,0)}function hze(t,e,i,s,n,r,o,a,l){t.dropAllAttributes();const u=44,c=new ArrayBuffer(u),h=new P4({sz:u,buffer:c});let d=0;h.writeDouble(d,s.x),d+=8,h.writeDouble(d,s.y),d+=8,h.writeDouble(d,o),d+=8,h.writeDouble(d,a),d+=8,h.writeDouble(d,l),d+=8;let m=0;r||(m|=2048),n&&(m|=4096),h.writeInt32(d,m),d+=4,aze(t,e,i,h,0)}function dze(t,e,i,s){t.dropAllAttributes();const n=32,r=new ArrayBuffer(n),o=new P4({sz:n,buffer:r});let a=0;o.writeDouble(a,s[0].x),a+=8,o.writeDouble(a,s[0].y),a+=8,o.writeDouble(a,s[1].x),a+=8,o.writeDouble(a,s[1].y),a+=8,lze(t,e,i,o,0)}function mze(t,e,i,s,n,r,o){t.dropAllAttributes();const a=40,l=new ArrayBuffer(a),u=new P4({sz:a,buffer:l});let c=0;u.writeDouble(c,s.x),c+=8,u.writeDouble(c,s.y),c+=8,u.writeDouble(c,n),c+=8,u.writeDouble(c,r),c+=8,u.writeDouble(c,o),c+=8,uze(t,e,i,u,0)}function pze(t,e,i,s,n){const r=t.getGeometryType();if(r===q.enumEllipticArc)return fze(t,e,i,s,n);if(r===q.enumBezier)return Ete(t,e,i,s,n);if(r===q.enumRationalBezier2)return gze(t,e,i,s,n);if(r===q.enumBezier2){const o=new hc;return o.constructFromQuadraticSegment(t),Ete(o,e,i,s,n)}_i("")}function fze(t,e,i,s,n){z(!ij(t));const r=t.getEndXY(),o=t.hasAttribute(1)&&!e,a=t.hasAttribute(2)&&!i;let l=Number.NaN,u=Number.NaN;if(o&&(l=t.getEndAttributeAsDbl(1,0)),a&&(u=t.getEndAttributeAsDbl(2,0)),t.isDegenerateToLine()||t.isDegenerate(0))return dw(o,a,r.x,r.y,l,u,s,n),!0;const c=t.projectionBehavior()===0,h=!!c&&t.isClosed();if(c&&!h)n.startObject(),n.addFieldName("c"),n.startArray(),dw(o,a,r.x,r.y,l,u,s,n),Aw(t.m_interior.x,t.m_interior.y,17,n),n.endArray(),n.endObject();else if(c){n.startObject(),n.addFieldName("a"),n.startArray(),dw(o,a,r.x,r.y,l,u,s,n),Aw(t.m_center.x+0,t.m_center.y+0,17,n);const f=!t.isMajor();n.addInt32(f?1:0);const _=t.isClockwise();n.addInt32(_?1:0),n.endArray(),n.endObject()}else{n.startObject(),n.addFieldName("a"),n.startArray(),dw(o,a,r.x,r.y,l,u,s,n);const d=t;Aw(d.m_center.x,d.m_center.y,17,n);const m=!d.isMajor();n.addInt32(m?1:0);const f=d.isClockwise();n.addInt32(f?1:0),n.addDouble(d.m_rotation,17),n.addDouble(d.m_semiMajorAxis,17),n.addDouble(d.m_minorMajorRatio,17),n.endArray(),n.endObject()}return!1}function Ete(t,e,i,s,n){const r=t.getEndXY(),o=t.hasAttribute(1)&&!e,a=t.hasAttribute(2)&&!i;let l=Number.NaN,u=Number.NaN;return o&&(l=t.getEndAttributeAsDbl(1,0)),a&&(u=t.getEndAttributeAsDbl(2,0)),n.startObject(),n.addFieldName("b"),n.startArray(),dw(o,a,r.x,r.y,l,u,s,n),Aw(t.m_cp[0].x,t.m_cp[0].y,s,n),Aw(t.m_cp[1].x,t.m_cp[1].y,s,n),n.endArray(),n.endObject(),!1}function gze(t,e,i,s,n){const r=t.getEndXY(),o=t.hasAttribute(1)&&!e,a=t.hasAttribute(2)&&!i;let l=Number.NaN,u=Number.NaN;o&&(l=t.getEndAttributeAsDbl(1,0)),a&&(u=t.getEndAttributeAsDbl(2,0)),n.startObject(),n.addFieldName("n"),n.startArray(),dw(o,a,r.x,r.y,l,u,s,n),Aw(t.m_cp.x,t.m_cp.y,s,n);const c=s;return n.addDouble(t.m_weights[0],c),n.addDouble(t.m_weights[1],c),n.addDouble(t.m_weights[2],c),n.endArray(),n.endObject(),!1}function dw(t,e,i,s,n,r,o,a){a.startArray(),a.addDouble(i,o),a.addDouble(s,o),t&&a.addDouble(n,o),e&&a.addDouble(r,o),a.endArray()}function Aw(t,e,i,s){s.startArray(),s.addDouble(t,i),s.addDouble(e,i),s.endArray()}class _ze{getOperatorType(){return 10405}accelerateGeometry(e,i,s){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}execute(e,i,s,n,r,o){yze(e,i,s,n)}exportSpatialReference(e,i,s,n){z(0)}exportProjectionTransformation(e,i,s,n){z(0)}exportDatumTransformation(e,i,s,n){z(0)}static geometryTypeToString(e){return z(0),""}}function yze(t,e,i,s,n){if(e||i){if(s.startObject(),e!==null)switch(e.getGeometryType()){case q.enumPolygon:Cte(!0,t,e,s);break;case q.enumPolyline:Cte(!1,t,e,s);break;case q.enumMultiPoint:vze(t,e,s);break;case q.enumPoint:xze(t,e,s);break;case q.enumEnvelope:bze(t,e,s);break;case q.enumMultipatch:z(0);break;default:We("exportToJSON")}i!==null&&(s.addFieldName("spatialReference"),Sze(t,i,s)),s.endObject()}}function Cte(t,e,i,s){const n=i.getImpl(),r=!!(2&e),o=!!(4&e),a=!!(8&e),l=n.hasAttribute(1)&&!r,u=n.hasAttribute(2)&&!o,c=n.hasAttribute(3)&&!a,h=n.hasNonLinearSegments();l&&(s.addFieldName("hasZ"),s.addBool(!0)),u&&(s.addFieldName("hasM"),s.addBool(!0)),t?h?s.addFieldName("curveRings"):s.addFieldName("rings"):h?s.addFieldName("curvePaths"):s.addFieldName("paths");let d=null;const m=[];if(i.isEmpty())s.startArray(),s.endArray();else{const f=17-(31&e>>13);s.startArray();const _=i.getPathCount();let v=0;const x=n.getAttributeStreamRef(0);let w=null,T=null,C=null;const M=new ii;let A=null,I=null,L=null;h&&(A=n.getSegmentFlagsStreamRef(),I=n.getSegmentIndexStreamRef(),L=n.getSegmentDataStreamRef()),l&&(w=n.getAttributeStreamRef(1)),u&&(T=n.getAttributeStreamRef(2)),c&&(C=n.getAttributeStreamRef(3),d=R7(3,0));for(let D=0;D<_;D++){s.startArray(),c&&m.push(0);const O=i.getPathEnd(D);if(v===O){s.endArray();continue}const U=i.isClosedPath(D);let $=x.read(2*v),B=x.read(2*v+1),V=l?w.read(v):Number.NaN,H=u?T.read(v):Number.NaN,Y=c?C.read(v):0;QC(l,u,$,B,V,H,f,s);let W=1;c&&(d.add(Y),m[m.length-1]++);const ee=$,ne=B,j=V,oe=H,ve=Y;let Ye=!1,de=0,fe=Number.NaN,Ne=Number.NaN,je=0;for(let Ee=v+1,Zt=v,qt=U?O+1:O;Ee<qt;Ee++,Zt++){const Mi=A!==null?31&A.read(Zt):1;let oi,si;if(Ee<O?(oi=x.read(2*Ee),si=x.read(2*Ee+1),l&&(fe=w.read(Ee)),u&&(Ne=T.read(Ee)),c&&(je=C.read(Ee))):(oi=ee,si=ne,fe=j,Ne=oe,je=ve),Mi!==1){Ye=!0,Mi===4?M.createEllipticArc():Mi===2?M.createCubicBezier():Mi===16?M.createQuadraticBezier():Mi===8?M.createQuadraticRationalBezier():_i("JSON export.unsupported curve");const me=M.get(),Bi=I.read(Zt);me.setStartXYCoords($,B),me.setEndXYCoords(oi,si),l&&(me.setStartAttribute(1,0,V),me.setEndAttribute(1,0,fe)),u&&(me.setStartAttribute(2,0,H),me.setEndAttribute(2,0,Ne)),me.readFromBufferStream(L,Bi),pze(M.get(),r,o,f,s)&&de++}else QC(l,u,oi,si,fe,Ne,f,s);c&&(d.add(je),m[m.length-1]++),W++,$=oi,B=si,V=fe,H=Ne,Y=je}Ye&&de===0||(W<2&&de<1&&(QC(l,u,$,B,V,H,f,s),W++,c&&(d.add(Y),m[m.length-1]++)),U&&W<3&&de<2&&(QC(l,u,ee,ne,j,oe,f,s),W++,$=ee,B=ne,V=j,H=oe,Y=ve,c&&(d.add(ve),m[m.length-1]++))),s.endArray(),v=O}s.endArray()}if(c){s.addFieldName("ids"),s.startArray();let f=0;for(let _=0,v=m.length;_<v;++_){const x=m[_];z(x===0||d!==null&&f+x<=d.size()),s.startArray();for(let w=0;w<x;++w)s.addInt32(d.read(f)),f++;s.endArray()}s.endArray()}}function vze(t,e,i){const s=e.getImpl(),n=s.hasAttribute(1)&&!(2&t),r=s.hasAttribute(2)&&!(4&t),o=s.hasAttribute(3)&&!(8&t);n&&(i.addFieldName("hasZ"),i.addBool(!0)),r&&(i.addFieldName("hasM"),i.addBool(!0)),i.addFieldName("points");const a=e.getPointCount();if(e.isEmpty())i.startArray(),i.endArray();else{const l=17-(31&t>>13);i.startArray();const u=s.getAttributeStreamRef(0);let c=null,h=null;n&&(c=s.getAttributeStreamRef(1)),r&&(h=s.getAttributeStreamRef(2));for(let d=0;d<a;d++){const m=u.read(2*d),f=u.read(2*d+1);let _=Number.NaN,v=Number.NaN;n&&(_=c.read(d)),r&&(v=h.read(d)),QC(n,r,m,f,_,v,l,i)}i.endArray()}if(o){let l=null;s.isEmpty()||(l=s.getAttributeStreamRef(3)),z(a===0||l!==null&&l.size()>=a),i.addFieldName("ids"),i.startArray();for(let u=0;u<a;u++)i.addInt32(l.read(u));i.endArray()}}function xze(t,e,i){const s=e.hasAttribute(1)&&!(2&t),n=e.hasAttribute(2)&&!(4&t),r=e.hasAttribute(3)&&!(8&t);if(e.isEmpty())return i.addFieldName("x"),i.addNull(),i.addFieldName("y"),i.addNull(),s&&(i.addFieldName("z"),i.addNull()),n&&(i.addFieldName("m"),i.addNull()),void(r&&(i.addFieldName("id"),i.addInt32(0)));const o=17-(31&t>>13);i.addFieldName("x"),i.addDouble(e.getX(),o),i.addFieldName("y"),i.addDouble(e.getY(),o),s&&(i.addFieldName("z"),i.addDouble(e.getZ(),o)),n&&(i.addFieldName("m"),i.addDouble(e.getM(),o)),r&&(i.addFieldName("id"),i.addInt32(e.getID()))}function bze(t,e,i){const s=e.hasAttribute(1)&&!(2&t),n=e.hasAttribute(2)&&!(4&t),r=e.hasAttribute(3)&&!(8&t);if(e.isEmpty())return i.addFieldName("xmin"),i.addNull(),i.addFieldName("ymin"),i.addNull(),i.addFieldName("xmax"),i.addNull(),i.addFieldName("ymax"),i.addNull(),s&&(i.addFieldName("zmin"),i.addNull(),i.addFieldName("zmax"),i.addNull()),n&&(i.addFieldName("mmin"),i.addNull(),i.addFieldName("mmax"),i.addNull()),void(r&&(i.addFieldName("idmin"),i.addInt32(0),i.addFieldName("idmax"),i.addInt32(0)));const o=17-(31&t>>13);if(i.addFieldName("xmin"),i.addDouble(e.getXMin(),o),i.addFieldName("ymin"),i.addDouble(e.getYMin(),o),i.addFieldName("xmax"),i.addDouble(e.getXMax(),o),i.addFieldName("ymax"),i.addDouble(e.getYMax(),o),s){const a=e.queryInterval(1,0);i.addFieldName("zmin"),i.addDouble(a.vmin,o),i.addFieldName("zmax"),i.addDouble(a.vmax,o)}if(n){const a=e.queryInterval(2,0);i.addFieldName("mmin"),i.addDouble(a.vmin,o),i.addFieldName("mmax"),i.addDouble(a.vmax,o)}if(r){const a=e.queryInterval(3,0);i.addFieldName("idmin"),i.addInt32(a.vmin),i.addFieldName("idmax"),i.addInt32(a.vmax)}}function wze(t,e,i){i.startObject();const s=e.getID();s<=0&&ce("cannot export unit that has no valid WKID"),i.addFieldName("uwkid"),i.addInt32(s),i.endObject()}function Sze(t,e,i){i.startObject();let s=0;e.isCustomWkid()||(s=e.getOldID());let n=0;const r=e.getVCS();if(r!==null&&(r.isCustomWkid()||(n=r.getOldID()),n<=0&&(s=0)),s>0){i.addFieldName("wkid"),i.addInt32(s);const o=e.getLatestID();if(o>0&&o!==s&&(i.addFieldName("latestWkid"),i.addInt32(o)),n>0){i.addFieldName("vcsWkid"),i.addInt32(n);const a=e.getLatestVerticalID();a!==n&&(i.addFieldName("latestVcsWkid"),i.addInt32(a))}}if(e.getCoordinateSystemType()===0)i.addFieldName("wkid"),i.addNull(),e.getUnit()!==null&&(i.addFieldName("unit"),wze(t,e.getUnit(),i));else if(s<=0||1&t){let o="";64&t&&(o=e.getText2(),i.addFieldName("wkt2"),i.addString(o));const a=e.getText();a!==o&&(i.addFieldName("wkt"),i.addString(a))}if(16&t){const o=new ta;e.queryPrecisionDescriptor(o),i.addFieldName("xyTolerance"),i.addDouble(o.getTolerance(0)),i.addFieldName("zTolerance"),i.addDouble(o.getTolerance(1)),i.addFieldName("mTolerance"),i.addDouble(o.getTolerance(2)),i.addFieldName("falseX"),i.addDouble(o.getFalseX()),i.addFieldName("falseY"),i.addDouble(o.getFalseY()),i.addFieldName("xyUnits"),i.addDouble(o.getGridUnitsXY()),i.addFieldName("falseZ"),i.addDouble(o.getFalseZ()),i.addFieldName("zUnits"),i.addDouble(o.getGridUnitsZ()),i.addFieldName("falseM"),i.addDouble(o.getFalseM()),i.addFieldName("mUnits"),i.addDouble(o.getGridUnitsM())}i.endObject()}function QC(t,e,i,s,n,r,o,a){a.startArray(),a.addDouble(i,o),a.addDouble(s,o),t&&a.addDouble(n,o),e&&a.addDouble(r,o),a.endArray()}const Kt={s_a:97,s_A:65,s_asterisk:42,s_b:98,s_backslash:92,s_beginArray:91,s_beginObject:123,s_colon:58,s_period:46,s_comma:44,s_doubleQuote:34,s_endArray:93,s_endObject:125,s_e:101,s_E:69,s_f:102,s_F:70,s_forwardslash:47,s_minus:45,s_plus:43,s_n:110,s_N:78,s_r:114,s_t:116,s_u:117,s_zero:48,s_nine:57};class Eze{constructor(e){this.m_functionStack=[],this.m_pushPositions=[],this.m_utf8Decoder=new TextDecoder("utf-8",{fatal:!0}),e===void 0?(this.m_startToken=Number.MAX_SAFE_INTEGER,this.m_endToken=0,this.m_currentTokenType=0,this.m_functionStack.push(()=>this.accept_()),this.m_jsonString=null,this.m_bHasEscapes=!1):e.jsonString?this.resetParserFromString(e.jsonString):e.jsonStream?_i("streaming json parsing not yet impl"):We("invalid constructor parameter")}prepSubstrString_(){}getCurrentSubstrString_(){return this.m_jsonString.slice(this.m_startToken,this.m_endToken)}stepOverCharString_(){this.m_endToken++}peekCharString_(){return this.m_jsonString.charCodeAt(this.m_endToken)}getString_(e){var s;const i=(s=this.m_jsonString)==null?void 0:s.slice(this.m_startToken,this.m_startToken+e-1);return this.m_endToken+=e-1,{s:i,bDone:this.m_endToken>=this.m_jsonString.length}}incrementString_(){this.m_endToken++}eofString_(){return this.m_endToken>=this.m_jsonString.length}setStringFunctions_(){this.m_prepSubstr=this.prepSubstrString_,this.m_getCurrentSubstr=this.getCurrentSubstrString_,this.m_stepOverChar=this.stepOverCharString_,this.m_peekChar=this.peekCharString_,this.m_get=this.getString_,this.m_increment=this.incrementString_,this.m_eof=this.eofString_}setStreamFunctions_(){_i("streaming json parsing not yet impl")}reset_(){this.m_jsonString=null,this.m_endToken=0,this.m_startToken=Number.MAX_SAFE_INTEGER,this.m_currentTokenType=0,this.m_bHasEscapes=!1,this.m_functionStack.length=0,this.m_functionStack.push(()=>this.start_()),this.m_pushPositions.length=0}resetParserFromString(e){this.reset_(),this.setStringFunctions_(),this.m_jsonString=e}resetParserFromStream(e){_i("streaming json parsing not yet impl")}resetToPosition(e){return z(0),!1}nextToken(){return this.m_functionStack.at(-1)(),this.m_currentTokenType}currentToken(){return this.m_currentTokenType}currentTokenStartIndex(){return this.m_startToken}currentTokenEndIndex(){return this.m_endToken}currentText(){return z(0),""}childrenAsString(){return z(0),""}skipChildren(){this.skipChildren_()}skipChildren_(){if(this.m_currentTokenType!==1){if(this.m_currentTokenType===2){let e=1;do this.m_currentTokenType=this.nextToken(),this.m_currentTokenType===2?e++:this.m_currentTokenType===4&&e--;while(this.m_currentTokenType!==4||e!==0)}}else{let e=1;do this.m_currentTokenType=this.nextToken(),this.m_currentTokenType===1?e++:this.m_currentTokenType===3&&e--;while(this.m_currentTokenType!==3||e!==0)}}currentTerminalAsString_(){switch(this.m_currentTokenType){case 7:case 8:case 9:return this.m_getCurrentSubstr().slice(0,this.m_endToken-this.m_startToken);case 10:return"null";case 11:return"true";case 12:return"false"}ce("invalid token")}toUTF8_(e,i){let s=0,n=e;for(;i.charCodeAt(n)===Kt.s_backslash&&i.charCodeAt(n+1)===Kt.s_u;)s++,n+=6;n=e;const r=new Uint8Array(s);let o=0;for(;i.charCodeAt(n)===Kt.s_backslash&&i.charCodeAt(n+1)===Kt.s_u;)r[o++]=Number.parseInt(i.slice(n+2,n+6),16),n+=6;return{u8s:this.m_utf8Decoder.decode(r),end:n}}unquoteCurrentString_(){let e="",i=1;const s=this.m_endToken-this.m_startToken-1;let n=0;const r=this.m_getCurrentSubstr();for(let o=i;o<s;o++)if(r.charCodeAt(o)!==Kt.s_backslash)n++;else{switch(n>0&&(e+=r.slice(i,i+n)),r.charCodeAt(++o)){case Kt.s_doubleQuote:e+='"';break;case Kt.s_u:{const{u8s:a,end:l}=this.toUTF8_(o-1,r);o=l-1,e+=a;break}case Kt.s_backslash:e+="\\";break;case Kt.s_forwardslash:e+="/";break;case Kt.s_b:e+="\b";break;case Kt.s_f:e+="\f";break;case Kt.s_n:e+=`
`;break;case Kt.s_r:e+="\r";break;case Kt.s_t:e+="	"}i=o+1,n=0}return n>0&&(e+=r.slice(i,i+n)),e}currentString(){return this.m_currentTokenType!==5&&this.m_currentTokenType!==6?this.currentTerminalAsString_():this.m_bHasEscapes?this.unquoteCurrentString_():this.m_getCurrentSubstr().slice(1,this.m_endToken-this.m_startToken-2+1)}currentDoubleValue(){if(this.m_currentTokenType!==7&&this.m_currentTokenType!==8&&this.m_currentTokenType!==9&&this.m_currentTokenType!==6&&this.m_currentTokenType!==10&&ce("invalid token"),this.m_currentTokenType===10)return Number.NaN;let e=this.m_getCurrentSubstr(),i=this.m_endToken-this.m_startToken;if(this.m_currentTokenType===6){if(this.currentString()==="NaN")return Number.NaN;e=e.slice(1),i-=2,i===0&&ce("invalid token")}const s=Number.parseFloat(e);if(this.m_currentTokenType===6)Number.isNaN(s)&&ce("invalid token");else if(Number.isNaN(s))return Number.NaN;return s}currentInt32Value(){this.m_currentTokenType!==8&&this.m_currentTokenType!==6&&ce("invalid token");let e=this.m_getCurrentSubstr(),i=this.m_endToken-this.m_startToken;this.m_currentTokenType===6&&(e=e.slice(1),i-=2,i===0&&ce("invalid token"));const s=parseInt(e);return Number.isNaN(s)&&ce("invalid token"),s}currentInt64Value(){return z(0),0n}currentBoolValue(){return z(0),!1}isError(){return 0}JSONString(){return z(0),""}pushPosition(){return z(0),!1}popPosition(){return z(0),!1}skipCStyleComments_(){z(0)}skipCppStyleComments_(){z(0)}skipComments_(){this.m_prepSubstr();let e=this.m_peekChar();this.m_stepOverChar(),this.m_eof()&&ce("invalid token"),e=this.m_peekChar(),e===Kt.s_asterisk?this.skipCStyleComments_():e===Kt.s_forwardslash?this.skipCppStyleComments_():ce("invalid token")}skipWhiteSpace_(){let e;do{this.m_eof()&&ce("invalid token");let i=this.m_peekChar();for(;i>=9&&i<=13||i===32;)this.m_increment(),this.m_eof()&&ce("invalid token"),i=this.m_peekChar();i===Kt.s_forwardslash?(this.m_startToken=this.m_endToken,e=!0,this.skipComments_()):e=!1}while(e)}rightBracket_(){return this.m_peekChar()===Kt.s_endArray&&(this.m_startToken=this.m_endToken,this.m_increment(),this.m_currentTokenType=4,!0)}rightBrace_(){return this.m_peekChar()===Kt.s_endObject&&(this.m_startToken=this.m_endToken,this.m_increment(),this.m_currentTokenType=3,!0)}string_(){this.m_prepSubstr(),this.m_bHasEscapes=!1,this.m_stepOverChar(),this.m_eof()&&ce("invalid token");let e=this.m_peekChar();for(;e!==Kt.s_doubleQuote;){const i=e===Kt.s_backslash;if(this.m_stepOverChar(),this.m_eof()&&ce("invalid token"),e=this.m_peekChar(),i)if(this.m_bHasEscapes=!0,e===Kt.s_doubleQuote||e===Kt.s_backslash||e===Kt.s_forwardslash||e===Kt.s_b||e===Kt.s_f||e===Kt.s_n||e===Kt.s_r||e===Kt.s_t)this.m_stepOverChar(),this.m_eof()&&ce("invalid token"),e=this.m_peekChar();else if(e===Kt.s_u)for(let s=0;s<4;s++)this.m_stepOverChar(),this.m_eof()&&ce("invalid token"),e=this.m_peekChar(),e>=Kt.s_zero&&e<=Kt.s_nine||e>=Kt.s_a&&e<=Kt.s_f||e>=Kt.s_A&&e<=Kt.s_F||ce("invalid token");else ce("invalid token")}this.m_stepOverChar()}comma_(){return this.m_peekChar()===Kt.s_comma&&(this.m_increment(),!0)}colon_(){return this.m_peekChar()===Kt.s_colon&&(this.m_increment(),!0)}fieldNameEnd_(){this.skipWhiteSpace_(),this.m_functionStack.pop(),this.colon_()?(this.skipWhiteSpace_(),this.value_()):ce("invalid token")}fieldNameStart_(){this.m_startToken=this.m_endToken,this.m_peekChar()!==Kt.s_doubleQuote&&ce("invalid token"),this.string_(),this.m_currentTokenType=5,this.m_functionStack.push(()=>this.fieldNameEnd_())}pairEnd_(){this.skipWhiteSpace_(),this.comma_()?(this.skipWhiteSpace_(),this.fieldNameStart_()):this.rightBrace_()?this.m_functionStack.pop():ce("invalid token")}arrayStart_(){this.skipWhiteSpace_(),this.m_functionStack.pop(),this.rightBracket_()||(this.m_functionStack.push(()=>this.elementEnd_()),this.value_())}elementEnd_(){this.skipWhiteSpace_(),this.comma_()?(this.skipWhiteSpace_(),this.value_()):this.rightBracket_()?this.m_functionStack.pop():ce("invalid token")}objectStart_(){this.skipWhiteSpace_(),this.m_functionStack.pop(),this.rightBrace_()||(this.m_functionStack.push(()=>this.pairEnd_()),this.fieldNameStart_())}valueStartObject_(){this.m_increment(),this.m_currentTokenType=1,this.m_functionStack.push(()=>this.objectStart_())}valueStartArray_(){this.m_increment(),this.m_currentTokenType=2,this.m_functionStack.push(()=>this.arrayStart_())}valueString_(){this.string_(),this.m_currentTokenType=6}int_(){this.m_peekChar()!==Kt.s_zero?this.digits_():this.m_stepOverChar()}digits_(){let e=this.m_peekChar();do this.m_stepOverChar(),this.m_eof()&&ce("invalid token"),e=this.m_peekChar();while(e>=Kt.s_zero&&e<=Kt.s_nine)}frac_(){let e=this.m_peekChar();this.m_stepOverChar(),this.m_eof()&&ce("invalid token"),e=this.m_peekChar(),e>=Kt.s_zero&&e<=Kt.s_nine||ce("invalid token"),this.digits_()}exp_(){let e=this.m_peekChar();this.m_stepOverChar(),this.m_eof()&&ce("invalid token"),e=this.m_peekChar(),e!==Kt.s_plus&&e!==Kt.s_minus||(this.m_stepOverChar(),this.m_eof()&&ce("invalid token"),e=this.m_peekChar()),e>=Kt.s_zero&&e<=Kt.s_nine||ce("invalid token"),this.digits_()}valueNumber_(){this.m_prepSubstr();let e=!1,i=this.m_peekChar();if(i===Kt.s_minus?(this.m_stepOverChar(),this.m_eof()&&ce("invalid token"),i=this.m_peekChar(),e=!0,i>=Kt.s_zero&&i<=Kt.s_nine||ce("invalid token"),this.int_()):this.int_(),i=this.m_peekChar(),i===Kt.s_period)this.m_currentTokenType=7,this.frac_(),i=this.m_peekChar(),i!==Kt.s_e&&i!==Kt.s_E||this.exp_();else if(i===Kt.s_e||i===Kt.s_E)this.m_currentTokenType=7,this.exp_();else{let s=0;e&&s++;const n=this.m_endToken-this.m_startToken-s;if(n<10)this.m_currentTokenType=8;else if(n===10){const r=this.m_getCurrentSubstr();e?r.slice(s)<="2147483648"?this.m_currentTokenType=8:this.m_currentTokenType=9:r.slice(s)<="2147483647"?this.m_currentTokenType=8:this.m_currentTokenType=9}else if(n<19)this.m_currentTokenType=9;else if(n===19){const r=this.m_getCurrentSubstr();e?r.slice(s)<="9223372036854775808"?this.m_currentTokenType=9:this.m_currentTokenType=7:r.slice(s)<="9223372036854775807"?this.m_currentTokenType=9:this.m_currentTokenType=7}else this.m_currentTokenType=7}}valueNull_(){const{s:e,bDone:i}=this.m_get(5);i&&ce("invalid token"),e!=="null"&&ce("invalid token"),this.m_currentTokenType=10}valueTrue_(){const{s:e,bDone:i}=this.m_get(5);i&&ce("invalid token"),e!=="true"&&ce("invalid token"),this.m_currentTokenType=11}valueFalse_(){const{s:e,bDone:i}=this.m_get(6);i&&ce("invalid token"),e!=="false"&&ce("invalid token"),this.m_currentTokenType=12}valueNan_(){const{s:e,bDone:i}=this.m_get(4);i&&ce("invalid token"),e!=="NaN"&&ce("invalid token"),this.m_currentTokenType=7}value_(){this.m_startToken=this.m_endToken;const e=this.m_peekChar();e===Kt.s_beginObject?this.valueStartObject_():e===Kt.s_beginArray?this.valueStartArray_():e===Kt.s_doubleQuote?this.valueString_():e===Kt.s_minus||e>=Kt.s_zero&&e<=Kt.s_zero+9?this.valueNumber_():e===Kt.s_n?this.valueNull_():e===Kt.s_t?this.valueTrue_():e===Kt.s_f?this.valueFalse_():e===Kt.s_N?this.valueNan_():ce("invalid token")}start_(){this.skipWhiteSpace_(),this.m_functionStack.pop(),this.m_functionStack.push(()=>this.accept_());const e=this.m_peekChar();e!==Kt.s_beginObject&&e!==Kt.s_beginArray&&ce("invalid token"),this.value_()}accept_(){this.m_startToken=this.m_endToken,this.m_currentTokenType=0}}class Cze{getOperatorType(){return 10404}accelerateGeometry(e,i,s){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}execute(e,i,s,n,r,o,a){let l;typeof s=="string"?(l=new Eze({jsonString:s}),l.nextToken()):l=s,l.currentToken()!==1&&ce("failed to import map geometry: start of object is expected");const u=eze(i,e,l,n,r);return new E1(u)}importProjectionTransformation(e,i){return z(0),{}}importDatumTransformation(e,i){return z(0),{}}static stringToGeometryType(e){return(e=e.toLowerCase()).startsWith("esrigeometry")||ce("string_to_geometry_type"),e.endsWith("point")?q.enumPoint:e.endsWith("envelope")?q.enumEnvelope:e.endsWith("multipoint")?q.enumMultiPoint:e.endsWith("polyline")?q.enumPolyline:e.endsWith("polygon")?q.enumPolygon:void ce("string_to_geometry_type")}}const n5=new JVe,Tze=new _ze,Pze=new Cze;function Mze(t){return Array.isArray(t)?t[0].spatialReference:t.spatialReference}function Zge(t,e){const i=new QVe(t,{strict:!1});return i.nextToken(),Pze.execute(0,q.enumUnknown,i,!0,e)}function Aze(t){let e=null;return[t.map(i=>{if(e==null){const s=Kge(i);return e=s.getSpatialReference(),s.getGeometry()}return M4(i)}),e]}function Kge(t){return Zge(t,!0)}function M4(t){return Zge(t,!1).getGeometry()}function Dj(t,e){return t instanceof E1&&(e=t.getSpatialReference(),t=t.getGeometry()),t!=null&&t.isEmpty()?null:(n5.reset(),Tze.execute(0,t,e,n5),n5.getObject())}const A0t=Object.freeze(Object.defineProperty({__proto__:null,fromGeometries:Aze,fromGeometry:Kge,fromGeometryToGXGeometry:M4,getSpatialReference:Mze,toGeometry:Dj},Symbol.toStringTag,{value:"Module"})),vo="_gxVersion",Qge=2,Jge=1;function Nj(t){return Array.isArray(t)?t[0].spatialReference:t.spatialReference}function Rj(t){switch(t.type){case"point":return i_e(t);case"multipoint":return t_e(t);case"polyline":return n_e(t);case"polygon":return s_e(t);case"extent":return e_e(t);default:throw new Error(`Unsupported geometry type: ${t.type}`)}}function e_e(t){if(!t.getCacheValue(vo)){const e=new Fo;e.setCoords(t.xmin,t.ymin,t.xmax,t.ymax),t.hasM&&e.setInterval(Qge,0,t.mmin,t.mmax),t.hasZ&&e.setInterval(Jge,0,t.zmin,t.zmax),t.setCacheValue(vo,e)}return t.getCacheValue(vo)}function t_e(t){if(!t.getCacheValue(vo)){const e=new Dn,i=new Jt,s=t.points,n=t.hasM,r=t.hasZ,o=r?3:2;for(let a=0,l=s.length;a<l;a++){const u=s[a];i.setXYCoords(u[0],u[1]),r&&i.setZ(u[2]??0),n&&i.setM(u[o]??NaN),e.add(i)}t.setCacheValue(vo,e)}return t.getCacheValue(vo)}function i_e(t){if(!t.getCacheValue(vo)){const e=new Jt;e.setXYCoords(t.x,t.y),t.hasM&&e.setM(t.m),t.hasZ&&e.setZ(t.z),t.setCacheValue(vo,e)}return t.getCacheValue(vo)}function s_e(t){if(!t.getCacheValue(vo)){const{curveRings:e,hasM:i,hasZ:s,rings:n}=t,r=M4({curveRings:e,hasM:i,hasZ:s,rings:n});t.setCacheValue(vo,r)}return t.getCacheValue(vo)}function n_e(t){if(!t.getCacheValue(vo)){const{curvePaths:e,hasM:i,hasZ:s,paths:n}=t,r=M4({curvePaths:e,hasM:i,hasZ:s,paths:n});t.setCacheValue(vo,r)}return t.getCacheValue(vo)}function Ize(t){if(t.wkid)return A1(t.wkid);const e=t.wkt2||t.wkt;return e?bS(e):null}function Oj(t,e){if(t)switch(t.getGeometryType()){case q.enumPoint:return a_e(t,e);case q.enumEnvelope:return r_e(t,e);case q.enumMultiPoint:return o_e(t,e);case q.enumPolyline:return u_e(t,e);case q.enumPolygon:return l_e(t,e)}return null}function r_e(t,e){if(t.isEmpty())return null;const i=new Nn({xmin:t.getXMin(),ymin:t.getYMin(),xmax:t.getXMax(),ymax:t.getYMax(),spatialReference:e}),s=t.getDescription();if(s.hasM()){const n=t.queryInterval(Qge,0);i.mmin=n.vmin,i.mmax=n.vmax}if(s.hasZ()){const n=t.queryInterval(Jge,0);i.zmin=n.vmin,i.zmax=n.vmax}return i.setCacheValue(vo,t),i}function o_e(t,e){if(t.isEmpty())return null;const i=t.getDescription(),s=i.hasM(),n=i.hasZ(),r=[],o=new Jt;for(let l=0,u=t.getPointCount();l<u;l++){t.getPointByVal(l,o);const c=[o.getX(),o.getY()];n&&c.push(o.getZ()),s&&c.push(o.getM()),r.push(c)}const a=new BM({hasM:s,hasZ:n,points:r,spatialReference:e});return a.setCacheValue(vo,t),a}function a_e(t,e){if(t instanceof N)return new ki({x:t.x,y:t.y,spatialReference:e});if(t.isEmpty())return null;const i=new ki({x:t.getX(),y:t.getY(),spatialReference:e}),s=t.getDescription();return s.hasM()&&(i.m=t.getM()),s.hasZ()&&(i.z=t.getZ()),i.setCacheValue(vo,t),i}function l_e(t,e){if(t.isEmpty())return null;const i=Na.fromJSON({spatialReference:e,...Dj(t,null)});return i.setCacheValue(vo,t),i}function u_e(t,e){if(t.isEmpty())return null;const i=gu.fromJSON({spatialReference:e,...Dj(t,null)});return i.setCacheValue(vo,t),i}const Dze=Object.freeze(Object.defineProperty({__proto__:null,fromExtent:e_e,fromGeometry:Rj,fromMultipoint:t_e,fromPoint:i_e,fromPolygon:s_e,fromPolyline:n_e,fromSpatialReference:Ize,getSpatialReference:Nj,toExtent:r_e,toGeometry:Oj,toMultipoint:o_e,toPoint:a_e,toPolygon:l_e,toPolyline:u_e},Symbol.toStringTag,{value:"Module"}));function mw(t,e){const i=Nj(t);return Oj(U3e(Rj(t),e.transform),i)}function Nze(t,e){const i=t.map(Rj),s=Nj(t);return V3e(i,e.transform).map(n=>Oj(n,s)).filter(Df)}const Rze=z3e(),I0t=Object.freeze(Object.defineProperty({__proto__:null,execute:mw,executeMany:Nze,supportsCurves:Rze},Symbol.toStringTag,{value:"Module"}));class gn{static degrees(e,i){return gn.convertPathToDegrees([[e.x,e.y],[i.x,i.y]])}static convertPathToDegrees(e){const i=e[1][1]-e[0][1],s=e[1][0]-e[0][0];return Math.atan2(i,s)*180/Math.PI}static azimuth(e,i){return gn.azimuthFromDegrees(gn.degrees(e,i))}static convertPathToAzimuth(e){return gn.azimuthFromDegrees(gn.convertPathToDegrees(e))}static azimuthFromDegrees(e){let i=e-90;for(;i<-180;)i+=360;return-Math.round(i*1e3)/1e3}static azimuthToRadians(e){let i=90-e;for(;i<-180;)i+=360;return-Math.round(i/180*Math.PI*1e3)/1e3}static radians(e,i){return gn.convertPathToRadians([[e.x,e.y],[i.x,i.y]])}static convertPathToRadians(e){const i=e[1][1]-e[0][1],s=e[1][0]-e[0][0];return Math.atan2(i,s)}static radians2(e,i){return Math.atan2(i[1]-e[1],i[0]-e[0])}static distance(e,i){return Math.sqrt((e[0]-i[0])**2+(e[1]-i[1])**2)}static rotate(e,i,s){const n=new iL;return n.rotate(s,i.x,i.y),mw(e,n)}static pointsToPolygon(e){return new fy({rings:[e.map(i=>[i.x,i.y])],spatialReference:e[0].spatialReference})}static offsetPoint(e,i,s){return new Mm({x:e.x+i,y:e.y-s,spatialReference:e.spatialReference})}static offsetByAzimuth(e,i,s){const n=gn.azimuthToRadians(i),r=Math.cos(n)*s,o=Math.sin(n)*s;return new Mm({x:e.x+r,y:e.y-o,spatialReference:e.spatialReference})}static offsetByRadians(e,i,s){const n=Math.cos(i)*s,r=Math.sin(i)*s;return new Mm({x:e.x+n,y:e.y-r,spatialReference:e.spatialReference})}}class Oze{constructor(e){Lt(this,"anchorPoint");Lt(this,"endPoint");Lt(this,"modelId",Date.now());Lt(this,"modelType",Lv.Line);this.anchorPoint=e,this.endPoint=gn.offsetPoint(this.anchorPoint,5,5)}}class Iw{constructor(){Lt(this,"modelId",0);Lt(this,"modelType",Lv.Empty)}}class xu{constructor(e,i,s){Lt(this,"model");Lt(this,"role");Lt(this,"index");this.model=e,this.role=i,this.index=s}static empty(){return new xu(new Iw,Zr.None,0)}}class Lj{constructor(e,i){Lt(this,"builderType",Pa.LineBuilder);Lt(this,"graphics");Lt(this,"model");Lt(this,"lineGraphic");Lt(this,"anchorGraphic");Lt(this,"endPointGraphic");Lt(this,"finishCallback");this.model=new Oze(e),this.graphics=i,this.lineGraphic=new Kr({geometry:new CP({paths:[[[this.model.anchorPoint.x,this.model.anchorPoint.y],[this.model.endPoint.x,this.model.endPoint.y]]],spatialReference:this.model.anchorPoint.spatialReference}),symbol:sy.lineSymbol(),attributes:{modelAttributes:new xu(this.model,Zr.Line,0)}}),this.anchorGraphic=new Kr({geometry:this.model.anchorPoint,symbol:W_.redX(),attributes:{modelAttributes:new xu(this.model,Zr.AnchorPoint,0)}}),this.endPointGraphic=new Kr({geometry:this.model.endPoint,symbol:W_.redCircle(),attributes:{modelAttributes:new xu(this.model,Zr.EndPoint,0)}}),this.graphics.addMany([this.lineGraphic,this.anchorGraphic,this.endPointGraphic])}move(e){this.model.endPoint=e.projectedPoint,this.lineGraphic.geometry=new CP({paths:[[[this.model.anchorPoint.x,this.model.anchorPoint.y],[this.model.endPoint.x,this.model.endPoint.y]]],spatialReference:this.model.anchorPoint.spatialReference}),this.endPointGraphic.geometry=this.model.endPoint}click(e){this.move(e),this.finishCallback&&(this.lineGraphic.symbol=cG.blackSolid(),this.endPointGraphic.symbol=W_.blackCircle(),this.finishCallback(this.model))}dblclick(e){this.click(e)}activate(){}deactivate(){}destroy(){this.graphics.removeMany([this.lineGraphic,this.anchorGraphic,this.endPointGraphic])}onFinish(e){this.finishCallback=e}}class r5{static click(e,i){e.currentBuilder?e.currentBuilder.click(i):(e.currentBuilder=new Lj(i.projectedPoint,e.graphicsLayer.graphics),e.currentModel=e.currentBuilder.model,e.currentBuilder.activate(),e.currentBuilder.onFinish(()=>{var s;(s=e.currentBuilder)==null||s.deactivate(),e.currentBuilder=void 0}))}static move(e,i){const s=e.currentBuilder;return s&&(s.move(i),e.compassHandler.updateFromVertices([s.model.anchorPoint,s.model.endPoint])),s!==void 0}}class wS{static red(){return new bd({color:new Gt("#ff000022"),outline:cG.redSolid()})}static green(){return new bd({color:new Gt("#ff002200"),outline:cG.greenDashes()})}}class Fj{constructor(e){Lt(this,"vertices");Lt(this,"modelId",Date.now());Lt(this,"modelType",Lv.Rect);this.vertices=e}}class kj{constructor(e,i){Lt(this,"builderType",Pa.RectBuilder);Lt(this,"graphics");Lt(this,"model");Lt(this,"rectGraphic");Lt(this,"symbol");Lt(this,"finishCallback");this.model=new Fj(e),this.graphics=i,this.symbol=sy.fillSymbol(),this.rectGraphic=new Kr({geometry:new fy({rings:[this.model.vertices.map(s=>[s.x,s.y])],spatialReference:this.model.vertices[0].spatialReference}),symbol:this.symbol,attributes:{modelAttributes:new xu(this.model,Zr.Polygon,0)}}),i.add(this.rectGraphic)}static fromBasePoints(e,i){const s=e,n=[s.anchorPoint,s.endPoint,gn.offsetPoint(s.endPoint,5,0),gn.offsetPoint(s.anchorPoint,5,0)];return new kj(n,i)}move(e){const i=e.projectedPoint,s=gn.radians(this.model.vertices[1],this.model.vertices[0]),n=gn.radians(this.model.vertices[1],i);let r=(s-n)%(Math.PI*2);r>Math.PI&&(r-=Math.PI*2);const o=r>=Math.PI?s+Math.PI/2:s-Math.PI/2,a=this.model.vertices[1].distance(i)*(r<0?1:-1);this.model.vertices[2]=new Mm({x:this.model.vertices[1].x-Math.cos(o)*a,y:this.model.vertices[1].y-Math.sin(o)*a,spatialReference:this.model.vertices[0].spatialReference}),this.model.vertices[3]=new Mm({x:this.model.vertices[0].x-Math.cos(o)*a,y:this.model.vertices[0].y-Math.sin(o)*a,spatialReference:this.model.vertices[0].spatialReference}),this.rectGraphic.geometry=new fy({rings:[this.model.vertices.map(l=>[l.x,l.y])],spatialReference:this.model.vertices[0].spatialReference})}click(e){this.rectGraphic.symbol=wS.red(),this.move(e),this.finishCallback&&this.finishCallback(this.model)}dblclick(e){this.click(e)}activate(){this.rectGraphic.symbol=wS.red()}deactivate(){}destroy(){this.graphics.remove(this.rectGraphic)}onFinish(e){this.finishCallback=e}}class o5{static click(e,i){e.currentBuilder?e.currentBuilder.builderType===Pa.LineBuilder||e.currentBuilder.builderType===Pa.RectBuilder&&e.currentBuilder.model.modelId===e.currentModel.modelId?e.currentBuilder.click(i):e.currentBuilder=void 0:(e.currentBuilder=new Lj(i.projectedPoint,e.graphicsLayer.graphics),e.currentModel=e.currentBuilder.model,e.currentBuilder.onFinish(s=>{var n;(n=e.currentBuilder)==null||n.destroy(),e.currentBuilder=kj.fromBasePoints(s,e.graphicsLayer.graphics),e.currentModel=e.currentBuilder.model,e.currentBuilder.onFinish(()=>{e.compassHandler.updateFromVertices(e.currentModel.vertices),e.currentBuilder=void 0}),e.currentBuilder.activate()}),e.currentBuilder.activate())}static move(e,i){if(e.currentBuilder){e.currentBuilder.move(i);const s=e.currentBuilder;s.builderType===Pa.LineBuilder?e.compassHandler.updateFromVertices([s.model.anchorPoint,s.model.endPoint]):s.builderType===Pa.RectBuilder&&e.compassHandler.updateFromVertices(s.model.vertices)}return e.currentMode!==void 0}}class Im{static getModelAttributes(e){return e&&e.attributes&&e.attributes.modelAttributes?e.attributes.modelAttributes:xu.empty()}static getRole(e){const i=Im.getModelAttributes(e);if(i)return i.role}static getModelId(e){const i=Im.getModelAttributes(e);if(i)return i.model.modelId}}class c_e{constructor(e,i){Lt(this,"builderType",Pa.RectTransformer);Lt(this,"graphics");Lt(this,"attr");Lt(this,"model");Lt(this,"rectGraphic");Lt(this,"vertexGraphics",[]);Lt(this,"edgeGraphics",[]);Lt(this,"finishCallback");Lt(this,"anchorIndex",0);Lt(this,"rotatorIndex",-1);Lt(this,"shifting",!1);Lt(this,"resizerIndex",-1);this.graphics=i,this.attr=Im.getModelAttributes(e),this.model=this.attr.model,this.rectGraphic=e,this.rectGraphic.symbol=sy.fillSymbol(),this.model.vertices.forEach((s,n)=>{this.vertexGraphics.push(new Kr({geometry:s,symbol:n===this.anchorIndex?W_.redCircle(10):W_.redSquare(6),attributes:{modelAttributes:new xu(this.model,Zr.Vertex,n)}})),this.edgeGraphics.push(new Kr({geometry:this.createEdgeGeometry(s,this.model.vertices[(n+1)%4]),symbol:sy.thickLineSymbol(),attributes:{modelAttributes:new xu(this.model,Zr.Edge,n)}}))})}createEdgeGeometry(e,i){const s=[e.x+.6*(i.x-e.x),e.y+.6*(i.y-e.y)],n=[(e.x+i.x)/2,(e.y+i.y)/2],r=[e.x+.4*(i.x-e.x),e.y+.4*(i.y-e.y)];return new CP({paths:[[s,n,r]],spatialReference:e.spatialReference})}resize(e){const i=this.model.vertices[this.resizerIndex],s=this.model.vertices[(this.resizerIndex+1)%4],n=new Mm({x:(i.x+s.x)/2,y:(i.y+s.y)/2,spatialReference:e.spatialReference}),r=this.model.vertices[(this.resizerIndex+2)%4],o=this.model.vertices[(this.resizerIndex+3)%4],a=new Mm({x:(r.x+o.x)/2,y:(r.y+o.y)/2,spatialReference:e.spatialReference}),l=gn.radians(a,n),u=gn.radians(a,e);let c=(l-u)%(Math.PI*2);c>Math.PI&&(c-=Math.PI*2);const h=e.distance(a)-n.distance(a),d=c>=Math.PI?-l:l,m=new iL;m.shift(Math.cos(d)*h,Math.sin(d)*h),[this.resizerIndex,(this.resizerIndex+1)%4].forEach(f=>{this.model.vertices[f]=mw(this.model.vertices[f],m),this.vertexGraphics[f].geometry=new Mm({x:this.model.vertices[f].x,y:this.model.vertices[f].y,spatialReference:e.spatialReference})}),this.model.vertices.forEach((f,_)=>{this.edgeGraphics[_].geometry=this.createEdgeGeometry(f,this.model.vertices[(_+1)%4])}),this.rectGraphic.geometry=new fy({rings:[this.model.vertices.map(f=>[f.x,f.y])],spatialReference:e.spatialReference})}transform(e){let i=0,s=0,n=0;const r=new iL;if(this.rotatorIndex>-1){const o=gn.radians(this.model.vertices[this.rotatorIndex],this.model.vertices[this.anchorIndex]);i=(gn.radians(e,this.model.vertices[this.anchorIndex])-o)/Math.PI*180,r.rotate(i,this.model.vertices[this.anchorIndex].x,this.model.vertices[this.anchorIndex].y)}this.shifting&&(s=e.x-this.model.vertices[this.anchorIndex].x,n=e.y-this.model.vertices[this.anchorIndex].y,r.shift(s,n)),this.rectGraphic.geometry&&(this.rectGraphic.geometry=mw(this.rectGraphic.geometry,r),this.vertexGraphics.forEach((o,a)=>{o.geometry=mw(o.geometry,r),this.model.vertices[a]=o.geometry}),this.edgeGraphics.forEach((o,a)=>{o.geometry=mw(o.geometry,r)}))}click(e){}dblclick(e){this.click(e)}move(e){}activate(){this.graphics.addMany([...this.vertexGraphics,...this.edgeGraphics]),this.rectGraphic.symbol=sy.fillSymbol()}deactivate(){this.rectGraphic.symbol=wS.red(),this.graphics.removeMany([...this.vertexGraphics,...this.edgeGraphics]),this.finishCallback&&this.finishCallback(this.model)}destroy(){}onFinish(e){this.finishCallback=e}setAnchorIndex(e){this.vertexGraphics[this.anchorIndex].symbol=W_.redCircle(6),this.anchorIndex=e,this.vertexGraphics[this.anchorIndex].symbol=W_.redCircle(10)}setRotatorIndex(e){this.rotatorIndex=e}}class tN{static click(e,i,s){const n=Im.getModelAttributes(s);n.role===Zr.Polygon&&e.currentModel.modelId!==n.model.modelId&&(e.currentBuilder&&e.currentBuilder&&e.currentBuilder.deactivate(),e.currentModel=n.model,e.currentBuilder=new c_e(s,e.graphicsLayer.graphics),e.currentModel=e.currentBuilder.model,e.currentBuilder.activate())}static dblclick(e,i,s){const n=Im.getModelAttributes(s);n&&n.role===Zr.Vertex&&e.currentBuilder.setAnchorIndex(n.index)}static drag(e,i,s){const n=e.currentBuilder;if(i.action==="start"){const r=Im.getModelAttributes(s);r.role===Zr.Vertex?r.index!==n.anchorIndex?n.setRotatorIndex(r.index):n.shifting=!0:r.role===Zr.Edge&&(n.resizerIndex=r.index)}else i.action==="end"?(n.setRotatorIndex(-1),n.shifting=!1,n.resizerIndex=-1):n.resizerIndex>-1?n.resize(i.projectedPoint):n.transform(i.projectedPoint);e.compassHandler.updateFromVertices(e.currentBuilder.model.vertices)}static move(e,i){return document.body.style.cursor="default",!1}}let QT=class extends Nt{constructor(e){super(e),this.addHandles([this.on("before-add",i=>{i.item==null&&i.preventDefault()}),this.on("after-add",i=>this._own(i.item)),this.on("after-remove",i=>this._release(i.item))])}get owner(){return this._get("owner")}set owner(e){e!==this._get("owner")&&(this._releaseAll(),this._set("owner",e),this._ownAll())}_ownAll(){for(const e of this.items)this._own(e)}_releaseAll(){for(const e of this.items)this._release(e)}_createNewInstance(e){return this.itemType?new(Nt.ofType(this.itemType.Type))(e):new Nt(e)}};function LB(t,e){return{type:t,cast:sme,set(i){const s=Of(i,this._get(e),t);s.owner=this,this._set(e,s)}}}y([S()],QT.prototype,"owner",null),QT=y([se("esri.core.support.OwningCollection")],QT);async function Lze(t){var s;const e="portalItem"in t?t:{portalItem:t},{fromItem:i}=await _e(async()=>{const{fromItem:n}=await import("./portalLayers-B-VUsDwp.js");return{fromItem:n}},__vite__mapDeps([26,27,28,29,30]));try{return await i(e)}catch(n){const r=e==null?void 0:e.portalItem,o=(r==null?void 0:r.id)||"unset",a=((s=r==null?void 0:r.portal)==null?void 0:s.url)||Ks.portalUrl;throw ht.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+a+"', id: '"+o+"')",n),n}}const Tte={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8};function a5(t,e,i,s=Fm){const n=new Eu(t7(s)),r=ui.fromJSDate(t,{zone:n}),o=i==="decades"||i==="centuries"?"year":d_e(i);return i==="decades"&&(e*=10),i==="centuries"&&(e*=100),r.plus({[o]:e}).toJSDate()}function N0t(t,e,i="milliseconds"){const s=t.getTime(),n=h_e(e,i,"milliseconds");return new Date(s+n)}function Pte(t,e,i=Fm){const s=new Eu(t7(i)),n=ui.fromJSDate(t,{zone:s});if(e==="decades"||e==="centuries"){const o=n.startOf("year"),{year:a}=o,l=a-a%(e==="decades"?10:100);return o.set({year:l}).toJSDate()}const r=d_e(e);return n.startOf(r).toJSDate()}function h_e(t,e,i){return t===0?0:t*Tte[e]/Tte[i]}function R0t(t,e){return t&&e?t.intersection(e):t||e}function d_e(t){switch(t){case"milliseconds":return"millisecond";case"seconds":return"second";case"minutes":return"minute";case"hours":return"hour";case"days":return"day";case"weeks":return"week";case"months":return"month";case"years":return"year"}}var Rc;let Ju=Rc=class extends it{static get allTime(){return Mte}static get empty(){return Fze}static fromArray(t){return new Rc({start:t[0]!=null?new Date(t[0]):t[0],end:t[1]!=null?new Date(t[1]):t[1]})}constructor(t){super(t),this.end=null,this.start=null}readEnd(t,e){return e.end!=null?new Date(e.end):null}writeEnd(t,e){e.end=(t==null?void 0:t.getTime())??null}get isAllTime(){return this.equals(Rc.allTime)}get isEmpty(){return this.equals(Rc.empty)}readStart(t,e){return e.start!=null?new Date(e.start):null}writeStart(t,e){e.start=(t==null?void 0:t.getTime())??null}clone(){return new Rc({end:this.end,start:this.start})}equals(t){var r,o,a,l;if(!t)return!1;const e=((r=this.start)==null?void 0:r.getTime())??this.start,i=((o=this.end)==null?void 0:o.getTime())??this.end,s=((a=t.start)==null?void 0:a.getTime())??t.start,n=((l=t.end)==null?void 0:l.getTime())??t.end;return e===s&&i===n}expandTo(t,e=Fm){if(this.isEmpty||this.isAllTime)return this.clone();let i=this.start;i&&(i=Pte(i,t,e));let s=this.end;if(s){const n=Pte(s,t,e);s=s.getTime()===n.getTime()?n:a5(n,1,t,e)}return new Rc({start:i,end:s})}intersection(t){var a,l,u,c;if(!t)return this.clone();if(this.isEmpty||t.isEmpty)return Rc.empty;if(this.isAllTime)return t.clone();if(t.isAllTime)return this.clone();const e=((a=this.start)==null?void 0:a.getTime())??-1/0,i=((l=this.end)==null?void 0:l.getTime())??1/0,s=((u=t.start)==null?void 0:u.getTime())??-1/0,n=((c=t.end)==null?void 0:c.getTime())??1/0;let r,o;return s>=e&&s<=i?r=s:e>=s&&e<=n&&(r=e),i>=s&&i<=n?o=i:n>=e&&n<=i&&(o=n),r==null||o==null||isNaN(r)||isNaN(o)?Rc.empty:new Rc({start:r===-1/0?null:new Date(r),end:o===1/0?null:new Date(o)})}offset(t,e,i=Fm){if(this.isEmpty||this.isAllTime)return this.clone();const s=new Rc,{start:n,end:r}=this;return n!=null&&(s.start=a5(n,t,e,i)),r!=null&&(s.end=a5(r,t,e,i)),s}toArray(){var t,e;return this.isEmpty?[void 0,void 0]:[((t=this.start)==null?void 0:t.getTime())??null,((e=this.end)==null?void 0:e.getTime())??null]}union(t){if(!t||t.isEmpty)return this.clone();if(this.isEmpty)return t.clone();if(this.isAllTime||t.isAllTime)return Mte.clone();const e=this.start!=null&&t.start!=null?new Date(Math.min(this.start.getTime(),t.start.getTime())):null,i=this.end!=null&&t.end!=null?new Date(Math.max(this.end.getTime(),t.end.getTime())):null;return new Rc({start:e,end:i})}};y([S({type:Date,json:{write:{allowNull:!0}}})],Ju.prototype,"end",void 0),y([mt("end")],Ju.prototype,"readEnd",null),y([yt("end")],Ju.prototype,"writeEnd",null),y([S({readOnly:!0,json:{read:!1}})],Ju.prototype,"isAllTime",null),y([S({readOnly:!0,json:{read:!1}})],Ju.prototype,"isEmpty",null),y([S({type:Date,json:{write:{allowNull:!0}}})],Ju.prototype,"start",void 0),y([mt("start")],Ju.prototype,"readStart",null),y([yt("start")],Ju.prototype,"writeStart",null),Ju=Rc=y([se("esri.time.TimeExtent")],Ju);const Uf=Ju,Mte=new Ju,Fze=new Ju({start:void 0,end:void 0});let kze=0,Lr=class extends vd.EventedMixin(ZM.IdentifiableMixin(Lf)){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new Nn(-180,-90,180,90,Ri.WGS84),this.id=Date.now().toString(16)+"-layer-"+kze++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.persistenceEnabled=!1,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=Ri.WGS84,this.title=null,this.type=null,this.url=null,this.visibilityTimeExtent=null,this.visible=!0}static async fromArcGISServerUrl(e){const i=typeof e=="string"?{url:e}:e;return(await _e(async()=>{const{fromUrl:s}=await import("./arcgisLayers-CFljMN4J.js");return{fromUrl:s}},__vite__mapDeps([31,27,28,30]))).fromUrl(i)}static fromPortalItem(e){return Lze(e)}initialize(){this.when().catch(e=>{cl(e)||ht.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})})}destroy(){const e=this.parent;if(e){const i=this;"layers"in e&&e.layers.includes(i)?e.layers.remove(i):"tables"in e&&e.tables.includes(i)?e.tables.remove(i):"baseLayers"in e&&e.baseLayers.includes(i)?e.baseLayers.remove(i):"referenceLayers"in e&&e.referenceLayers.includes(i)&&e.referenceLayers.remove(i),this._set("parent",null)}}get effectiveVisible(){let e=this.visible;const i=this.parent;return e&&i&&"effectiveVisible"in i&&e&&(e=i.effectiveVisible),e}get hasAttributionData(){return this.attributionDataUrl!=null}get parsedUrl(){return ol(this.url)}createLayerView(e,i){return Promise.reject(new Se("layer:create-layer-view","Layer does not support creating a layer view"))}async fetchAttributionData(){const e=this.attributionDataUrl;if(this.hasAttributionData&&e)return(await $n(e,{query:{f:"json"},responseType:"json"})).data;throw new Se("layer:no-attribution-data","Layer does not have attribution data")}};y([S({type:String})],Lr.prototype,"attributionDataUrl",void 0),y([S({readOnly:!0})],Lr.prototype,"effectiveVisible",null),y([S({type:Nn})],Lr.prototype,"fullExtent",void 0),y([S({readOnly:!0})],Lr.prototype,"hasAttributionData",null),y([S({type:String,clonable:!1})],Lr.prototype,"id",void 0),y([S({type:Boolean,nonNullable:!0})],Lr.prototype,"legendEnabled",void 0),y([S({type:["show","hide","hide-children"]})],Lr.prototype,"listMode",void 0),y([S({type:Number,range:{min:0,max:1},nonNullable:!0})],Lr.prototype,"opacity",void 0),y([S({clonable:!1})],Lr.prototype,"parent",void 0),y([S({readOnly:!0})],Lr.prototype,"parsedUrl",null),y([S({type:Boolean,readOnly:!0})],Lr.prototype,"persistenceEnabled",void 0),y([S({type:Boolean})],Lr.prototype,"popupEnabled",void 0),y([S({type:Boolean})],Lr.prototype,"attributionVisible",void 0),y([S({type:Ri})],Lr.prototype,"spatialReference",void 0),y([S({type:String})],Lr.prototype,"title",void 0),y([S({readOnly:!0,json:{read:!1}})],Lr.prototype,"type",void 0),y([S()],Lr.prototype,"url",void 0),y([S({type:Uf})],Lr.prototype,"visibilityTimeExtent",void 0),y([S({type:Boolean,nonNullable:!0})],Lr.prototype,"visible",void 0),Lr=y([se("esri.layers.Layer")],Lr);const A4=Lr,rr=(t=>t)(["operational-layers","basemap","ground"]);function I4(){const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function $ze(t){const e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Uze(t,e,i,s,n,r,o,a,l,u,c,h,d,m,f,_){const v=new Float32Array(16);return v[0]=t,v[1]=e,v[2]=i,v[3]=s,v[4]=n,v[5]=r,v[6]=o,v[7]=a,v[8]=l,v[9]=u,v[10]=c,v[11]=h,v[12]=d,v[13]=m,v[14]=f,v[15]=_,v}function Vze(t,e){return new Float32Array(t,e,16)}const zze=I4();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:zze,clone:$ze,create:I4,createView:Vze,fromValues:Uze},Symbol.toStringTag,{value:"Module"}));let $j=1e-6;function kl(){return $j}function Gze(t){$j=t}const D4=Math.random,Bze=Math.PI/180,qze=180/Math.PI;function Uj(t){return t*Bze}function Hze(t){return t*qze}function jze(t,e){return Math.abs(t-e)<=$j*Math.max(1,Math.abs(t),Math.abs(e))}Object.freeze(Object.defineProperty({__proto__:null,RANDOM:D4,equals:jze,getEpsilon:kl,setEpsilon:Gze,toDegree:Hze,toRadian:Uj},Symbol.toStringTag,{value:"Module"}));function m_e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Gy(t,e,i,s,n,r,o,a,l,u,c,h,d,m,f,_,v){return t[0]=e,t[1]=i,t[2]=s,t[3]=n,t[4]=r,t[5]=o,t[6]=a,t[7]=l,t[8]=u,t[9]=c,t[10]=h,t[11]=d,t[12]=m,t[13]=f,t[14]=_,t[15]=v,t}function N4(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function By(t,e){if(t===e){const i=e[1],s=e[2],n=e[3],r=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=s,t[9]=r,t[11]=e[14],t[12]=n,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Yze(t,e){return p_e(t,e)||N4(t),t}function p_e(t,e){const i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],m=e[11],f=e[12],_=e[13],v=e[14],x=e[15],w=i*a-s*o,T=i*l-n*o,C=i*u-r*o,M=s*l-n*a,A=s*u-r*a,I=n*u-r*l,L=c*_-h*f,D=c*v-d*f,O=c*x-m*f,U=h*v-d*_,$=h*x-m*_,B=d*x-m*v;let V=w*B-T*$+C*U+M*O-A*D+I*L;return V?(V=1/V,t[0]=(a*B-l*$+u*U)*V,t[1]=(n*$-s*B-r*U)*V,t[2]=(_*I-v*A+x*M)*V,t[3]=(d*A-h*I-m*M)*V,t[4]=(l*O-o*B-u*D)*V,t[5]=(i*B-n*O+r*D)*V,t[6]=(v*C-f*I-x*T)*V,t[7]=(c*I-d*C+m*T)*V,t[8]=(o*$-a*O+u*L)*V,t[9]=(s*O-i*$-r*L)*V,t[10]=(f*A-_*C+x*w)*V,t[11]=(h*C-c*A-m*w)*V,t[12]=(a*D-o*U-l*L)*V,t[13]=(i*U-s*D+n*L)*V,t[14]=(_*T-f*M-v*w)*V,t[15]=(c*M-h*T+d*w)*V,t):null}function Xze(t,e){const i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],m=e[11],f=e[12],_=e[13],v=e[14],x=e[15];return t[0]=a*(d*x-m*v)-h*(l*x-u*v)+_*(l*m-u*d),t[1]=-(s*(d*x-m*v)-h*(n*x-r*v)+_*(n*m-r*d)),t[2]=s*(l*x-u*v)-a*(n*x-r*v)+_*(n*u-r*l),t[3]=-(s*(l*m-u*d)-a*(n*m-r*d)+h*(n*u-r*l)),t[4]=-(o*(d*x-m*v)-c*(l*x-u*v)+f*(l*m-u*d)),t[5]=i*(d*x-m*v)-c*(n*x-r*v)+f*(n*m-r*d),t[6]=-(i*(l*x-u*v)-o*(n*x-r*v)+f*(n*u-r*l)),t[7]=i*(l*m-u*d)-o*(n*m-r*d)+c*(n*u-r*l),t[8]=o*(h*x-m*_)-c*(a*x-u*_)+f*(a*m-u*h),t[9]=-(i*(h*x-m*_)-c*(s*x-r*_)+f*(s*m-r*h)),t[10]=i*(a*x-u*_)-o*(s*x-r*_)+f*(s*u-r*a),t[11]=-(i*(a*m-u*h)-o*(s*m-r*h)+c*(s*u-r*a)),t[12]=-(o*(h*v-d*_)-c*(a*v-l*_)+f*(a*d-l*h)),t[13]=i*(h*v-d*_)-c*(s*v-n*_)+f*(s*d-n*h),t[14]=-(i*(a*v-l*_)-o*(s*v-n*_)+f*(s*l-n*a)),t[15]=i*(a*d-l*h)-o*(s*d-n*h)+c*(s*l-n*a),t}function Wze(t){const e=t[0],i=t[1],s=t[2],n=t[3],r=t[4],o=t[5],a=t[6],l=t[7],u=t[8],c=t[9],h=t[10],d=t[11],m=t[12],f=t[13],_=t[14],v=t[15];return(e*o-i*r)*(h*v-d*_)-(e*a-s*r)*(c*v-d*f)+(e*l-n*r)*(c*_-h*f)+(i*a-s*o)*(u*v-d*m)-(i*l-n*o)*(u*_-h*m)+(s*l-n*a)*(u*f-c*m)}function f_e(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],m=e[10],f=e[11],_=e[12],v=e[13],x=e[14],w=e[15];let T=i[0],C=i[1],M=i[2],A=i[3];return t[0]=T*s+C*a+M*h+A*_,t[1]=T*n+C*l+M*d+A*v,t[2]=T*r+C*u+M*m+A*x,t[3]=T*o+C*c+M*f+A*w,T=i[4],C=i[5],M=i[6],A=i[7],t[4]=T*s+C*a+M*h+A*_,t[5]=T*n+C*l+M*d+A*v,t[6]=T*r+C*u+M*m+A*x,t[7]=T*o+C*c+M*f+A*w,T=i[8],C=i[9],M=i[10],A=i[11],t[8]=T*s+C*a+M*h+A*_,t[9]=T*n+C*l+M*d+A*v,t[10]=T*r+C*u+M*m+A*x,t[11]=T*o+C*c+M*f+A*w,T=i[12],C=i[13],M=i[14],A=i[15],t[12]=T*s+C*a+M*h+A*_,t[13]=T*n+C*l+M*d+A*v,t[14]=T*r+C*u+M*m+A*x,t[15]=T*o+C*c+M*f+A*w,t}function Zze(t,e,i){const s=i[0],n=i[1],r=i[2];if(e===t)t[12]=e[0]*s+e[4]*n+e[8]*r+e[12],t[13]=e[1]*s+e[5]*n+e[9]*r+e[13],t[14]=e[2]*s+e[6]*n+e[10]*r+e[14],t[15]=e[3]*s+e[7]*n+e[11]*r+e[15];else{const o=e[0],a=e[1],l=e[2],u=e[3],c=e[4],h=e[5],d=e[6],m=e[7],f=e[8],_=e[9],v=e[10],x=e[11];t[0]=o,t[1]=a,t[2]=l,t[3]=u,t[4]=c,t[5]=h,t[6]=d,t[7]=m,t[8]=f,t[9]=_,t[10]=v,t[11]=x,t[12]=o*s+c*n+f*r+e[12],t[13]=a*s+h*n+_*r+e[13],t[14]=l*s+d*n+v*r+e[14],t[15]=u*s+m*n+x*r+e[15]}return t}function Kze(t,e,i){const s=i[0],n=i[1],r=i[2];return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Qze(t,e,i,s){let n=s[0],r=s[1],o=s[2],a=Math.sqrt(n*n+r*r+o*o);if(a<=kl())return void m_e(t,e);a=1/a,n*=a,r*=a,o*=a;const l=Math.sin(i),u=Math.cos(i),c=1-u,h=e[0],d=e[1],m=e[2],f=e[3],_=e[4],v=e[5],x=e[6],w=e[7],T=e[8],C=e[9],M=e[10],A=e[11],I=n*n*c+u,L=r*n*c+o*l,D=o*n*c-r*l,O=n*r*c-o*l,U=r*r*c+u,$=o*r*c+n*l,B=n*o*c+r*l,V=r*o*c-n*l,H=o*o*c+u;t[0]=h*I+_*L+T*D,t[1]=d*I+v*L+C*D,t[2]=m*I+x*L+M*D,t[3]=f*I+w*L+A*D,t[4]=h*O+_*U+T*$,t[5]=d*O+v*U+C*$,t[6]=m*O+x*U+M*$,t[7]=f*O+w*U+A*$,t[8]=h*B+_*V+T*H,t[9]=d*B+v*V+C*H,t[10]=m*B+x*V+M*H,t[11]=f*B+w*V+A*H,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15])}function Jze(t,e,i){const s=Math.sin(i),n=Math.cos(i),r=e[4],o=e[5],a=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=r*n+u*s,t[5]=o*n+c*s,t[6]=a*n+h*s,t[7]=l*n+d*s,t[8]=u*n-r*s,t[9]=c*n-o*s,t[10]=h*n-a*s,t[11]=d*n-l*s,t}function e6e(t,e,i){const s=Math.sin(i),n=Math.cos(i),r=e[0],o=e[1],a=e[2],l=e[3],u=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=r*n-u*s,t[1]=o*n-c*s,t[2]=a*n-h*s,t[3]=l*n-d*s,t[8]=r*s+u*n,t[9]=o*s+c*n,t[10]=a*s+h*n,t[11]=l*s+d*n,t}function t6e(t,e,i){const s=Math.sin(i),n=Math.cos(i),r=e[0],o=e[1],a=e[2],l=e[3],u=e[4],c=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=r*n+u*s,t[1]=o*n+c*s,t[2]=a*n+h*s,t[3]=l*n+d*s,t[4]=u*n-r*s,t[5]=c*n-o*s,t[6]=h*n-a*s,t[7]=d*n-l*s,t}function i6e(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function s6e(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function n6e(t,e,i){if(e===0)return N4(t);let s=i[0],n=i[1],r=i[2],o=Math.sqrt(s*s+n*n+r*r);if(o<=kl())return null;o=1/o,s*=o,n*=o,r*=o;const a=Math.sin(e),l=Math.cos(e),u=1-l;return t[0]=s*s*u+l,t[1]=n*s*u+r*a,t[2]=r*s*u-n*a,t[3]=0,t[4]=s*n*u-r*a,t[5]=n*n*u+l,t[6]=r*n*u+s*a,t[7]=0,t[8]=s*r*u+n*a,t[9]=n*r*u-s*a,t[10]=r*r*u+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function r6e(t,e){const i=Math.sin(e),s=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=i,t[7]=0,t[8]=0,t[9]=-i,t[10]=s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function o6e(t,e){const i=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=0,t[2]=-i,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=i,t[9]=0,t[10]=s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function a6e(t,e){const i=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=i,t[2]=0,t[3]=0,t[4]=-i,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function g_e(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=s+s,l=n+n,u=r+r,c=s*a,h=s*l,d=s*u,m=n*l,f=n*u,_=r*u,v=o*a,x=o*l,w=o*u;return t[0]=1-(m+_),t[1]=h+w,t[2]=d-x,t[3]=0,t[4]=h-w,t[5]=1-(c+_),t[6]=f+v,t[7]=0,t[8]=d+x,t[9]=f-v,t[10]=1-(c+m),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function l6e(t,e){const i=u6e,s=-e[0],n=-e[1],r=-e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=s*s+n*n+r*r+o*o;return h>0?(i[0]=2*(a*o+c*s+l*r-u*n)/h,i[1]=2*(l*o+c*n+u*s-a*r)/h,i[2]=2*(u*o+c*r+a*n-l*s)/h):(i[0]=2*(a*o+c*s+l*r-u*n),i[1]=2*(l*o+c*n+u*s-a*r),i[2]=2*(u*o+c*r+a*n-l*s)),g_e(t,e,i),t}const u6e=Fy();function c6e(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function h6e(t,e){const i=e[0],s=e[1],n=e[2],r=e[4],o=e[5],a=e[6],l=e[8],u=e[9],c=e[10];return t[0]=Math.sqrt(i*i+s*s+n*n),t[1]=Math.sqrt(r*r+o*o+a*a),t[2]=Math.sqrt(l*l+u*u+c*c),t}function d6e(t,e){const i=e[0]+e[5]+e[10];let s=0;return i>0?(s=2*Math.sqrt(i+1),t[3]=.25*s,t[0]=(e[6]-e[9])/s,t[1]=(e[8]-e[2])/s,t[2]=(e[1]-e[4])/s):e[0]>e[5]&&e[0]>e[10]?(s=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/s,t[0]=.25*s,t[1]=(e[1]+e[4])/s,t[2]=(e[8]+e[2])/s):e[5]>e[10]?(s=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/s,t[0]=(e[1]+e[4])/s,t[1]=.25*s,t[2]=(e[6]+e[9])/s):(s=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/s,t[0]=(e[8]+e[2])/s,t[1]=(e[6]+e[9])/s,t[2]=.25*s),t}function m6e(t,e,i,s){const n=e[0],r=e[1],o=e[2],a=e[3],l=n+n,u=r+r,c=o+o,h=n*l,d=n*u,m=n*c,f=r*u,_=r*c,v=o*c,x=a*l,w=a*u,T=a*c,C=s[0],M=s[1],A=s[2];return t[0]=(1-(f+v))*C,t[1]=(d+T)*C,t[2]=(m-w)*C,t[3]=0,t[4]=(d-T)*M,t[5]=(1-(h+v))*M,t[6]=(_+x)*M,t[7]=0,t[8]=(m+w)*A,t[9]=(_-x)*A,t[10]=(1-(h+f))*A,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function p6e(t,e,i,s,n){const r=e[0],o=e[1],a=e[2],l=e[3],u=r+r,c=o+o,h=a+a,d=r*u,m=r*c,f=r*h,_=o*c,v=o*h,x=a*h,w=l*u,T=l*c,C=l*h,M=s[0],A=s[1],I=s[2],L=n[0],D=n[1],O=n[2],U=(1-(_+x))*M,$=(m+C)*M,B=(f-T)*M,V=(m-C)*A,H=(1-(d+x))*A,Y=(v+w)*A,W=(f+T)*I,ee=(v-w)*I,ne=(1-(d+_))*I;return t[0]=U,t[1]=$,t[2]=B,t[3]=0,t[4]=V,t[5]=H,t[6]=Y,t[7]=0,t[8]=W,t[9]=ee,t[10]=ne,t[11]=0,t[12]=i[0]+L-(U*L+V*D+W*O),t[13]=i[1]+D-($*L+H*D+ee*O),t[14]=i[2]+O-(B*L+Y*D+ne*O),t[15]=1,t}function f6e(t,e){const i=e[0],s=e[1],n=e[2],r=e[3],o=i+i,a=s+s,l=n+n,u=i*o,c=s*o,h=s*a,d=n*o,m=n*a,f=n*l,_=r*o,v=r*a,x=r*l;return t[0]=1-h-f,t[1]=c+x,t[2]=d-v,t[3]=0,t[4]=c-x,t[5]=1-u-f,t[6]=m+_,t[7]=0,t[8]=d+v,t[9]=m-_,t[10]=1-u-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function g6e(t,e,i,s,n,r,o){const a=1/(i-e),l=1/(n-s),u=1/(r-o);return t[0]=2*r*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*r*l,t[6]=0,t[7]=0,t[8]=(i+e)*a,t[9]=(n+s)*l,t[10]=(o+r)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*r*2*u,t[15]=0,t}function _6e(t,e,i,s,n){const r=1/Math.tan(e/2);let o;return t[0]=r/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,n!=null&&n!==1/0?(o=1/(s-n),t[10]=(n+s)*o,t[14]=2*n*s*o):(t[10]=-1,t[14]=-2*s),t}function y6e(t,e,i,s){const n=Math.tan(e.upDegrees*Math.PI/180),r=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+a),u=2/(n+r);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-(o-a)*l*.5,t[9]=(n-r)*u*.5,t[10]=s/(i-s),t[11]=-1,t[12]=0,t[13]=0,t[14]=s*i/(i-s),t[15]=0,t}function v6e(t,e,i,s,n,r,o){const a=1/(e-i),l=1/(s-n),u=1/(r-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+i)*a,t[13]=(n+s)*l,t[14]=(o+r)*u,t[15]=1,t}function x6e(t,e,i,s){const n=e[0],r=e[1],o=e[2];let a=n-i[0],l=r-i[1],u=o-i[2];const c=kl();if(Math.abs(a)<c&&Math.abs(l)<c&&Math.abs(u)<c)return void N4(t);let h=1/Math.sqrt(a*a+l*l+u*u);a*=h,l*=h,u*=h;const d=s[0],m=s[1],f=s[2];let _=m*u-f*l,v=f*a-d*u,x=d*l-m*a;h=Math.sqrt(_*_+v*v+x*x),h?(h=1/h,_*=h,v*=h,x*=h):(_=0,v=0,x=0);let w=l*x-u*v,T=u*_-a*x,C=a*v-l*_;h=Math.sqrt(w*w+T*T+C*C),h?(h=1/h,w*=h,T*=h,C*=h):(w=0,T=0,C=0),t[0]=_,t[1]=w,t[2]=a,t[3]=0,t[4]=v,t[5]=T,t[6]=l,t[7]=0,t[8]=x,t[9]=C,t[10]=u,t[11]=0,t[12]=-(_*n+v*r+x*o),t[13]=-(w*n+T*r+C*o),t[14]=-(a*n+l*r+u*o),t[15]=1}function b6e(t,e,i,s){const n=e[0],r=e[1],o=e[2],a=s[0],l=s[1],u=s[2];let c=n-i[0],h=r-i[1],d=o-i[2],m=c*c+h*h+d*d;m>0&&(m=1/Math.sqrt(m),c*=m,h*=m,d*=m);let f=l*d-u*h,_=u*c-a*d,v=a*h-l*c;return m=f*f+_*_+v*v,m>0&&(m=1/Math.sqrt(m),f*=m,_*=m,v*=m),t[0]=f,t[1]=_,t[2]=v,t[3]=0,t[4]=h*v-d*_,t[5]=d*f-c*v,t[6]=c*_-h*f,t[7]=0,t[8]=c,t[9]=h,t[10]=d,t[11]=0,t[12]=n,t[13]=r,t[14]=o,t[15]=1,t}function w6e(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function S6e(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2+t[9]**2+t[10]**2+t[11]**2+t[12]**2+t[13]**2+t[14]**2+t[15]**2)}function E6e(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t[9]=e[9]+i[9],t[10]=e[10]+i[10],t[11]=e[11]+i[11],t[12]=e[12]+i[12],t[13]=e[13]+i[13],t[14]=e[14]+i[14],t[15]=e[15]+i[15],t}function __e(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t[9]=e[9]-i[9],t[10]=e[10]-i[10],t[11]=e[11]-i[11],t[12]=e[12]-i[12],t[13]=e[13]-i[13],t[14]=e[14]-i[14],t[15]=e[15]-i[15],t}function C6e(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12]*i,t[13]=e[13]*i,t[14]=e[14]*i,t[15]=e[15]*i,t}function T6e(t,e,i,s){return t[0]=e[0]+i[0]*s,t[1]=e[1]+i[1]*s,t[2]=e[2]+i[2]*s,t[3]=e[3]+i[3]*s,t[4]=e[4]+i[4]*s,t[5]=e[5]+i[5]*s,t[6]=e[6]+i[6]*s,t[7]=e[7]+i[7]*s,t[8]=e[8]+i[8]*s,t[9]=e[9]+i[9]*s,t[10]=e[10]+i[10]*s,t[11]=e[11]+i[11]*s,t[12]=e[12]+i[12]*s,t[13]=e[13]+i[13]*s,t[14]=e[14]+i[14]*s,t[15]=e[15]+i[15]*s,t}function P6e(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function M6e(t,e){if(t===e)return!0;const i=t[0],s=t[1],n=t[2],r=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],m=t[11],f=t[12],_=t[13],v=t[14],x=t[15],w=e[0],T=e[1],C=e[2],M=e[3],A=e[4],I=e[5],L=e[6],D=e[7],O=e[8],U=e[9],$=e[10],B=e[11],V=e[12],H=e[13],Y=e[14],W=e[15],ee=kl();return Math.abs(i-w)<=ee*Math.max(1,Math.abs(i),Math.abs(w))&&Math.abs(s-T)<=ee*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(n-C)<=ee*Math.max(1,Math.abs(n),Math.abs(C))&&Math.abs(r-M)<=ee*Math.max(1,Math.abs(r),Math.abs(M))&&Math.abs(o-A)<=ee*Math.max(1,Math.abs(o),Math.abs(A))&&Math.abs(a-I)<=ee*Math.max(1,Math.abs(a),Math.abs(I))&&Math.abs(l-L)<=ee*Math.max(1,Math.abs(l),Math.abs(L))&&Math.abs(u-D)<=ee*Math.max(1,Math.abs(u),Math.abs(D))&&Math.abs(c-O)<=ee*Math.max(1,Math.abs(c),Math.abs(O))&&Math.abs(h-U)<=ee*Math.max(1,Math.abs(h),Math.abs(U))&&Math.abs(d-$)<=ee*Math.max(1,Math.abs(d),Math.abs($))&&Math.abs(m-B)<=ee*Math.max(1,Math.abs(m),Math.abs(B))&&Math.abs(f-V)<=ee*Math.max(1,Math.abs(f),Math.abs(V))&&Math.abs(_-H)<=ee*Math.max(1,Math.abs(_),Math.abs(H))&&Math.abs(v-Y)<=ee*Math.max(1,Math.abs(v),Math.abs(Y))&&Math.abs(x-W)<=ee*Math.max(1,Math.abs(x),Math.abs(W))}function A6e(t){const e=kl(),i=t[0],s=t[1],n=t[2],r=t[4],o=t[5],a=t[6],l=t[8],u=t[9],c=t[10];return Math.abs(1-(i*i+r*r+l*l))<=e&&Math.abs(1-(s*s+o*o+u*u))<=e&&Math.abs(1-(n*n+a*a+c*c))<=e}function I6e(t){return t[0]===1&&t[1]===0&&t[2]===0&&t[4]===0&&t[5]===1&&t[6]===0&&t[8]===0&&t[9]===0&&t[10]===1}const D6e=f_e,N6e=__e;Object.freeze(Object.defineProperty({__proto__:null,add:E6e,adjoint:Xze,copy:m_e,determinant:Wze,equals:M6e,exactEquals:P6e,frob:S6e,fromQuat:f6e,fromQuat2:l6e,fromRotation:n6e,fromRotationTranslation:g_e,fromRotationTranslationScale:m6e,fromRotationTranslationScaleOrigin:p6e,fromScaling:s6e,fromTranslation:i6e,fromXRotation:r6e,fromYRotation:o6e,fromZRotation:a6e,frustum:g6e,getRotation:d6e,getScaling:h6e,getTranslation:c6e,hasIdentityRotation:I6e,identity:N4,invert:p_e,invertOrIdentity:Yze,isOrthoNormal:A6e,lookAt:x6e,mul:D6e,multiply:f_e,multiplyScalar:C6e,multiplyScalarAndAdd:T6e,ortho:v6e,perspective:_6e,perspectiveFromFieldOfView:y6e,rotate:Qze,rotateX:Jze,rotateY:e6e,rotateZ:t6e,scale:Kze,set:Gy,str:w6e,sub:N6e,subtract:__e,targetTo:b6e,translate:Zze,transpose:By},Symbol.toStringTag,{value:"Module"}));const R6e=(t,e)=>{const i=Gy(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1);return By(i,i)},O6e=(t,e)=>{const i=Gy(t,e,0,0,.5-.5*e,0,e,0,.5-.5*e,0,0,e,.5-.5*e,0,0,0,1);return By(i,i)},L6e=(t,e)=>{const i=1-e,s=Gy(t,.2126+.7874*i,.7152-.7152*i,.0722-.0722*i,0,.2126-.2126*i,.7152+.2848*i,.0722-.0722*i,0,.2126-.2126*i,.7152-.7152*i,.0722+.9278*i,0,0,0,0,1);return By(s,s)},F6e=(t,e)=>{const i=Math.sin(e*Math.PI/180),s=Math.cos(e*Math.PI/180),n=Gy(t,.213+.787*s-.213*i,.715-.715*s-.715*i,.072-.072*s+.928*i,0,.213-.213*s+.143*i,.715+.285*s+.14*i,.072-.072*s-.283*i,0,.213-.213*s-.787*i,.715-.715*s+.715*i,.072+.928*s+.072*i,0,0,0,0,1);return By(n,n)},k6e=(t,e)=>{const i=1-2*e,s=Gy(t,i,0,0,e,0,i,0,e,0,0,i,e,0,0,0,1);return By(s,s)},$6e=(t,e)=>{const i=Gy(t,.213+.787*e,.715-.715*e,.072-.072*e,0,.213-.213*e,.715+.285*e,.072-.072*e,0,.213-.213*e,.715-.715*e,.072+.928*e,0,0,0,0,1);return By(i,i)},U6e=(t,e)=>{const i=1-e,s=Gy(t,.393+.607*i,.769-.769*i,.189-.189*i,0,.349-.349*i,.686+.314*i,.168-.168*i,0,.272-.272*i,.534-.534*i,.131+.869*i,0,0,0,0,1);return By(s,s)};let y_e=class v_e{constructor(e,i,s){this.strength=e,this.radius=i,this.threshold=s,this.type="bloom"}interpolate(e,i,s){this.strength=cu(e.strength,i.strength,s),this.radius=cu(e.radius,i.radius,s),this.threshold=cu(e.threshold,i.threshold,s)}clone(){return new v_e(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:JT(this.radius),strength:this.strength,threshold:this.threshold}}},x_e=class b_e{constructor(e){this.radius=e,this.type="blur"}interpolate(e,i,s){this.radius=Math.round(cu(e.radius,i.radius,s))}clone(){return new b_e(this.radius)}toJSON(){return{type:"blur",radius:JT(this.radius)}}},FB=class w_e{constructor(e,i){this.type=e,this.amount=i,this.type!=="invert"&&this.type!=="grayscale"&&this.type!=="sepia"||(this.amount=Math.min(this.amount,1))}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(e,i,s){this.amount=cu(e.amount,i.amount,s),this._updateMatrix()}clone(){return new w_e(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const e=this._colorMatrix||I4();switch(this.type){case"brightness":this._colorMatrix=R6e(e,this.amount);break;case"contrast":this._colorMatrix=O6e(e,this.amount);break;case"grayscale":this._colorMatrix=L6e(e,this.amount);break;case"invert":this._colorMatrix=k6e(e,this.amount);break;case"saturate":this._colorMatrix=$6e(e,this.amount);break;case"sepia":this._colorMatrix=U6e(e,this.amount)}}},S_e=class E_e{constructor(e,i,s,n){this.offsetX=e,this.offsetY=i,this.blurRadius=s,this.color=n,this.type="drop-shadow"}interpolate(e,i,s){this.offsetX=cu(e.offsetX,i.offsetX,s),this.offsetY=cu(e.offsetY,i.offsetY,s),this.blurRadius=cu(e.blurRadius,i.blurRadius,s),this.color[0]=Math.round(cu(e.color[0],i.color[0],s)),this.color[1]=Math.round(cu(e.color[1],i.color[1],s)),this.color[2]=Math.round(cu(e.color[2],i.color[2],s)),this.color[3]=cu(e.color[3],i.color[3],s)}clone(){return new E_e(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const e=[...this.color];return e[3]*=255,{type:"drop-shadow",xoffset:JT(this.offsetX),yoffset:JT(this.offsetY),blurRadius:JT(this.blurRadius),color:e}}},C_e=class T_e{constructor(e){this.angle=e,this.type="hue-rotate"}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(e,i,s){this.angle=cu(e.angle,i.angle,s),this._updateMatrix()}clone(){return new T_e(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const e=this._colorMatrix||I4();this._colorMatrix=F6e(e,this.angle)}},P_e=class M_e{constructor(e){this.amount=e,this.type="opacity",this.amount=Math.min(this.amount,1)}interpolate(e,i,s){this.amount=cu(e.amount,i.amount,s)}clone(){return new M_e(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}};function cu(t,e,i){return t+(e-t)*i}function JT(t){return Math.round(1e3*rh(t))/1e3}function V6e(t){switch(t.type){case"grayscale":case"sepia":case"invert":return new FB(t.type,0);case"saturate":case"brightness":case"contrast":return new FB(t.type,1);case"opacity":return new P_e(1);case"hue-rotate":return new C_e(0);case"blur":return new x_e(0);case"drop-shadow":return new S_e(0,0,0,[...n7("transparent")]);case"bloom":return new y_e(0,0,1)}}function z6e(t,e){const i=t.length>e.length?t:e;return(t.length>e.length?e:t).every((s,n)=>s.type===i[n].type)}function G6e(t,e){const i=t.length>e.length?t:e,s=t.length>e.length?e:t;for(let n=s.length;n<i.length;n++)s.push(V6e(i[n]))}function B6e(t){const e=t[0];return!!e&&"type"in e}function q6e(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i}function Dw(t,e,i,s){var n=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(n,Dw.prototype),n.expected=e,n.found=i,n.location=s,n.name="SyntaxError",n}function l5(t,e,i){return i=i||" ",t.length>e?t:(e-=t.length,t+(i+=i.repeat(e)).slice(0,e))}function H6e(t,e){var i,s={},n=(e=e!==void 0?e:{}).grammarSource,r={start:ys},o=ys,a="none",l=")",u=",",c="(",h="%",d="px",m="cm",f="mm",_="in",v="pt",x="pc",w="deg",T="rad",C="grad",M="turn",A="#",I=".",L="e",D=/^[ \t\n\r]/,O=/^[a-z\-]/,U=/^[0-9a-fA-F]/,$=/^[+\-]/,B=/^[0-9]/,V=Jr("none"),H=Rn("none",!1),Y=Rn(")",!1),W=Rn(",",!1),ee=Jr("whitespace"),ne=Qr([" ","	",`
`,"\r"],!1,!1),j=Jr("function"),oe=Rn("(",!1),ve=Jr("identifier"),Ye=Qr([["a","z"],"-"],!1,!1),de=Jr("percentage"),fe=Rn("%",!1),Ne=Jr("length"),je=Rn("px",!1),Ee=Rn("cm",!1),Zt=Rn("mm",!1),qt=Rn("in",!1),Mi=Rn("pt",!1),oi=Rn("pc",!1),si=Jr("angle"),me=Rn("deg",!1),Bi=Rn("rad",!1),pt=Rn("grad",!1),$e=Rn("turn",!1),wt=Jr("number"),$i=Jr("color"),Mt=Rn("#",!1),le=Qr([["0","9"],["a","f"],["A","F"]],!1,!1),te=Qr(["+","-"],!1,!1),De=Qr([["0","9"]],!1,!1),et=Rn(".",!1),tt=Rn("e",!1),Ze=function(){return[]},Ct=function(ue,He){return{type:"function",name:ue,parameters:He||[]}},gt=function(ue,He){return He.length>0?os(ue,He,3):[ue]},dt=function(ue){return{type:"quantity",value:ue.value,unit:ue.unit}},hi=function(ue){return{type:"color",colorType:ue.type,value:ue.value}},ct=function(ue){return ue},xt=function(){return ch()},li=function(ue){return{value:ue,unit:"%"}},jt=function(ue){return{value:ue,unit:"px"}},Tt=function(ue){return{value:ue,unit:"cm"}},Ii=function(ue){return{value:ue,unit:"mm"}},di=function(ue){return{value:ue,unit:"in"}},ms=function(ue){return{value:ue,unit:"pt"}},we=function(ue){return{value:ue,unit:"pc"}},Dt=function(ue){return{value:ue,unit:"deg"}},Qe=function(ue){return{value:ue,unit:"rad"}},ot=function(ue){return{value:ue,unit:"grad"}},Rt=function(ue){return{value:ue,unit:"turn"}},It=function(ue){return{value:ue,unit:null}},qi=function(){return{type:"hex",value:ch()}},hn=function(ue){return{type:"function",value:ue}},or=function(){return{type:"named",value:ch()}},Ms=function(){return parseFloat(ch())},Le=0|e.peg$currPos,Ui=Le,Sn=[{line:1,column:1}],Js=Le,Br=e.peg$maxFailExpected||[],Bt=0|e.peg$silentFails;if(e.startRule){if(!(e.startRule in r))throw new Error(`Can't start parsing from rule "`+e.startRule+'".');o=r[e.startRule]}function ch(){return t.substring(Ui,Le)}function Rn(ue,He){return{type:"literal",text:ue,ignoreCase:He}}function Qr(ue,He,Je){return{type:"class",parts:ue,inverted:He,ignoreCase:Je}}function dl(){return{type:"end"}}function Jr(ue){return{type:"other",description:ue}}function La(ue){var He,Je=Sn[ue];if(Je)return Je;if(ue>=Sn.length)He=Sn.length-1;else for(He=ue;!Sn[--He];);for(Je={line:(Je=Sn[He]).line,column:Je.column};He<ue;)t.charCodeAt(He)===10?(Je.line++,Je.column=1):Je.column++,He++;return Sn[ue]=Je,Je}function Bl(ue,He,Je){var bt=La(ue),Pt=La(He);return{source:n,start:{offset:ue,line:bt.line,column:bt.column},end:{offset:He,line:Pt.line,column:Pt.column}}}function wi(ue){Le<Js||(Le>Js&&(Js=Le,Br=[]),Br.push(ue))}function ha(ue,He,Je){return new Dw(Dw.buildMessage(ue,He),ue,He,Je)}function ys(){var ue;return(ue=eo())===s&&(ue=to()),ue}function eo(){var ue,He;return Bt++,ue=Le,Oe(),t.substr(Le,4)===a?(He=a,Le+=4):(He=s,Bt===0&&wi(H)),He!==s?(Oe(),Ui=ue,ue=Ze()):(Le=ue,ue=s),Bt--,ue===s&&Bt===0&&wi(V),ue}function to(){var ue,He;if(ue=[],(He=_n())!==s)for(;He!==s;)ue.push(He),He=_n();else ue=s;return ue}function _n(){var ue,He,Je,bt;return ue=Le,Oe(),(He=Be())!==s?(Oe(),(Je=re())===s&&(Je=null),Oe(),t.charCodeAt(Le)===41?(bt=l,Le++):(bt=s,Bt===0&&wi(Y)),bt!==s?(Oe(),Ui=ue,ue=Ct(He,Je)):(Le=ue,ue=s)):(Le=ue,ue=s),ue}function re(){var ue,He,Je,bt,Pt,Hi,xi,as;if(ue=Le,(He=Ce())!==s){for(Je=[],bt=Le,Pt=Oe(),t.charCodeAt(Le)===44?(Hi=u,Le++):(Hi=s,Bt===0&&wi(W)),Hi===s&&(Hi=null),xi=Oe(),(as=Ce())!==s?bt=Pt=[Pt,Hi,xi,as]:(Le=bt,bt=s);bt!==s;)Je.push(bt),bt=Le,Pt=Oe(),t.charCodeAt(Le)===44?(Hi=u,Le++):(Hi=s,Bt===0&&wi(W)),Hi===s&&(Hi=null),xi=Oe(),(as=Ce())!==s?bt=Pt=[Pt,Hi,xi,as]:(Le=bt,bt=s);Ui=ue,ue=gt(He,Je)}else Le=ue,ue=s;return ue}function Ce(){var ue,He;return ue=Le,(He=ft())===s&&(He=St())===s&&(He=At())===s&&(He=zt()),He!==s&&(Ui=ue,He=dt(He)),(ue=He)===s&&(ue=Le,(He=Ti())!==s&&(Ui=ue,He=hi(He)),ue=He),ue}function Oe(){var ue,He;for(Bt++,ue=[],He=t.charAt(Le),D.test(He)?Le++:(He=s,Bt===0&&wi(ne));He!==s;)ue.push(He),He=t.charAt(Le),D.test(He)?Le++:(He=s,Bt===0&&wi(ne));return Bt--,He=s,Bt===0&&wi(ee),ue}function Be(){var ue,He,Je;return Bt++,ue=Le,(He=Ae())!==s?(t.charCodeAt(Le)===40?(Je=c,Le++):(Je=s,Bt===0&&wi(oe)),Je!==s?(Ui=ue,ue=ct(He)):(Le=ue,ue=s)):(Le=ue,ue=s),Bt--,ue===s&&(He=s,Bt===0&&wi(j)),ue}function Ae(){var ue,He,Je;if(Bt++,ue=Le,He=[],Je=t.charAt(Le),O.test(Je)?Le++:(Je=s,Bt===0&&wi(Ye)),Je!==s)for(;Je!==s;)He.push(Je),Je=t.charAt(Le),O.test(Je)?Le++:(Je=s,Bt===0&&wi(Ye));else He=s;return He!==s&&(Ui=ue,He=xt()),Bt--,(ue=He)===s&&(He=s,Bt===0&&wi(ve)),ue}function ft(){var ue,He,Je;return Bt++,ue=Le,Oe(),(He=Yt())!==s?(t.charCodeAt(Le)===37?(Je=h,Le++):(Je=s,Bt===0&&wi(fe)),Je!==s?(Ui=ue,ue=li(He)):(Le=ue,ue=s)):(Le=ue,ue=s),Bt--,ue===s&&Bt===0&&wi(de),ue}function St(){var ue,He,Je;return Bt++,ue=Le,Oe(),(He=Yt())!==s?(t.substr(Le,2)===d?(Je=d,Le+=2):(Je=s,Bt===0&&wi(je)),Je!==s?(Ui=ue,ue=jt(He)):(Le=ue,ue=s)):(Le=ue,ue=s),ue===s&&(ue=Le,Oe(),(He=Yt())!==s?(t.substr(Le,2)===m?(Je=m,Le+=2):(Je=s,Bt===0&&wi(Ee)),Je!==s?(Ui=ue,ue=Tt(He)):(Le=ue,ue=s)):(Le=ue,ue=s),ue===s&&(ue=Le,Oe(),(He=Yt())!==s?(t.substr(Le,2)===f?(Je=f,Le+=2):(Je=s,Bt===0&&wi(Zt)),Je!==s?(Ui=ue,ue=Ii(He)):(Le=ue,ue=s)):(Le=ue,ue=s),ue===s&&(ue=Le,Oe(),(He=Yt())!==s?(t.substr(Le,2)===_?(Je=_,Le+=2):(Je=s,Bt===0&&wi(qt)),Je!==s?(Ui=ue,ue=di(He)):(Le=ue,ue=s)):(Le=ue,ue=s),ue===s&&(ue=Le,Oe(),(He=Yt())!==s?(t.substr(Le,2)===v?(Je=v,Le+=2):(Je=s,Bt===0&&wi(Mi)),Je!==s?(Ui=ue,ue=ms(He)):(Le=ue,ue=s)):(Le=ue,ue=s),ue===s&&(ue=Le,Oe(),(He=Yt())!==s?(t.substr(Le,2)===x?(Je=x,Le+=2):(Je=s,Bt===0&&wi(oi)),Je!==s?(Ui=ue,ue=we(He)):(Le=ue,ue=s)):(Le=ue,ue=s)))))),Bt--,ue===s&&Bt===0&&wi(Ne),ue}function At(){var ue,He,Je;return Bt++,ue=Le,(He=Yt())!==s?(t.substr(Le,3)===w?(Je=w,Le+=3):(Je=s,Bt===0&&wi(me)),Je!==s?(Ui=ue,ue=Dt(He)):(Le=ue,ue=s)):(Le=ue,ue=s),ue===s&&(ue=Le,(He=Yt())!==s?(t.substr(Le,3)===T?(Je=T,Le+=3):(Je=s,Bt===0&&wi(Bi)),Je!==s?(Ui=ue,ue=Qe(He)):(Le=ue,ue=s)):(Le=ue,ue=s),ue===s&&(ue=Le,(He=Yt())!==s?(t.substr(Le,4)===C?(Je=C,Le+=4):(Je=s,Bt===0&&wi(pt)),Je!==s?(Ui=ue,ue=ot(He)):(Le=ue,ue=s)):(Le=ue,ue=s),ue===s&&(ue=Le,(He=Yt())!==s?(t.substr(Le,4)===M?(Je=M,Le+=4):(Je=s,Bt===0&&wi($e)),Je!==s?(Ui=ue,ue=Rt(He)):(Le=ue,ue=s)):(Le=ue,ue=s)))),Bt--,ue===s&&(He=s,Bt===0&&wi(si)),ue}function zt(){var ue,He;return Bt++,ue=Le,Oe(),(He=Yt())!==s?(Ui=ue,ue=It(He)):(Le=ue,ue=s),Bt--,ue===s&&Bt===0&&wi(wt),ue}function Ti(){var ue,He,Je,bt;if(Bt++,ue=Le,t.charCodeAt(Le)===35?(He=A,Le++):(He=s,Bt===0&&wi(Mt)),He!==s){if(Je=[],bt=t.charAt(Le),U.test(bt)?Le++:(bt=s,Bt===0&&wi(le)),bt!==s)for(;bt!==s;)Je.push(bt),bt=t.charAt(Le),U.test(bt)?Le++:(bt=s,Bt===0&&wi(le));else Je=s;Je!==s?(Ui=ue,ue=qi()):(Le=ue,ue=s)}else Le=ue,ue=s;return ue===s&&(ue=Le,(He=_n())!==s&&(Ui=ue,He=hn(He)),(ue=He)===s&&(ue=Le,(He=Ae())!==s&&(Ui=ue,He=or()),ue=He)),Bt--,ue===s&&(He=s,Bt===0&&wi($i)),ue}function Yt(){var ue,He,Je,bt,Pt,Hi,xi,as;for(ue=Le,He=t.charAt(Le),$.test(He)?Le++:(He=s,Bt===0&&wi(te)),He===s&&(He=null),Je=Le,bt=[],Pt=t.charAt(Le),B.test(Pt)?Le++:(Pt=s,Bt===0&&wi(De));Pt!==s;)bt.push(Pt),Pt=t.charAt(Le),B.test(Pt)?Le++:(Pt=s,Bt===0&&wi(De));if(t.charCodeAt(Le)===46?(Pt=I,Le++):(Pt=s,Bt===0&&wi(et)),Pt!==s){if(Hi=[],xi=t.charAt(Le),B.test(xi)?Le++:(xi=s,Bt===0&&wi(De)),xi!==s)for(;xi!==s;)Hi.push(xi),xi=t.charAt(Le),B.test(xi)?Le++:(xi=s,Bt===0&&wi(De));else Hi=s;Hi!==s?Je=bt=[bt,Pt,Hi]:(Le=Je,Je=s)}else Le=Je,Je=s;if(Je===s)if(Je=[],bt=t.charAt(Le),B.test(bt)?Le++:(bt=s,Bt===0&&wi(De)),bt!==s)for(;bt!==s;)Je.push(bt),bt=t.charAt(Le),B.test(bt)?Le++:(bt=s,Bt===0&&wi(De));else Je=s;if(Je!==s){if(bt=Le,t.charCodeAt(Le)===101?(Pt=L,Le++):(Pt=s,Bt===0&&wi(tt)),Pt!==s){if(Hi=t.charAt(Le),$.test(Hi)?Le++:(Hi=s,Bt===0&&wi(te)),Hi===s&&(Hi=null),xi=[],as=t.charAt(Le),B.test(as)?Le++:(as=s,Bt===0&&wi(De)),as!==s)for(;as!==s;)xi.push(as),as=t.charAt(Le),B.test(as)?Le++:(as=s,Bt===0&&wi(De));else xi=s;xi!==s?bt=Pt=[Pt,Hi,xi]:(Le=bt,bt=s)}else Le=bt,bt=s;bt===s&&(bt=null),Ui=ue,ue=Ms()}else Le=ue,ue=s;return ue}function ci(ue,He){return ue.map(function(Je){return Je[He]})}function os(ue,He,Je){return[ue].concat(ci(He,Je))}if(i=o(),e.peg$library)return{peg$result:i,peg$currPos:Le,peg$FAILED:s,peg$maxFailExpected:Br,peg$maxFailPos:Js};if(i!==s&&Le===t.length)return i;throw i!==s&&Le<t.length&&wi(dl()),ha(Br,Js<t.length?t.charAt(Js):null,Js<t.length?Bl(Js,Js+1):Bl(Js,Js))}function A_e(t){if(!t||t.length===0)return null;if(typeof t=="string"){const i=Ate(t);return i&&i.length!==0?i:null}const e=t.map(i=>{if(!Number.isFinite(i.scale)||i.scale<=0)throw new Se("effect:invalid-scale","scale must be finite and greater than 0",{stop:i});return{scale:i.scale,effects:Ate(i.value)}});e.sort((i,s)=>s.effects.length-i.effects.length);for(let i=0;i<e.length-1;i++){if(!z6e(e[i].effects,e[i+1].effects))throw new Se("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:e[i].effects,b:e[i+1].effects});G6e(e[i].effects,e[i+1].effects)}return e.sort((i,s)=>s.scale-i.scale),e}function Ate(t){let e;if(!t)return[];try{e=H6e(t)}catch(i){throw new Se("effect:invalid-syntax","Invalid effect syntax",{value:t,error:i})}return e.map(i=>j6e(i))}function j6e(t){try{switch(t.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return Y6e(t);case"opacity":return X6e(t);case"hue-rotate":return W6e(t);case"blur":return Z6e(t);case"drop-shadow":return K6e(t);case"bloom":return Q6e(t)}}catch(e){throw e.details.filter=t,e}throw new Se("effect:unknown-effect",`Effect '${t.name}' is not supported`,{effect:t})}function Y6e(t){let e=1;return oE(t.parameters,1),t.parameters.length===1&&(e=Jh(t.parameters[0])),new FB(t.name,e)}function X6e(t){let e=1;return oE(t.parameters,1),t.parameters.length===1&&(e=Jh(t.parameters[0])),new P_e(e)}function W6e(t){let e=0;return oE(t.parameters,1),t.parameters.length===1&&(e=nGe(t.parameters[0])),new C_e(e)}function Z6e(t){let e=0;return oE(t.parameters,1),t.parameters.length===1&&(e=Gj(t.parameters[0]),_A(e,t.parameters[0])),new x_e(e)}function K6e(t){const e=[];let i=null;for(const s of t.parameters)if(s.type==="color"){if(e.length&&Object.freeze(e),i)throw new Se("effect:type-error","Accepts only one color",{});i=rGe(s)}else{const n=Gj(s);if(Object.isFrozen(e))throw new Se("effect:type-error","<length> parameters not consecutive",{lengths:e});e.push(n),e.length===3&&_A(n,s)}if(e.length<2||e.length>3)throw new Se("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${e.length}}`,{lengths:e});return new S_e(e[0],e[1],e[2]||0,i||I_e("black"))}function Q6e(t){let e=1,i=0,s=0;return oE(t.parameters,3),t.parameters[0]&&(e=Jh(t.parameters[0])),t.parameters[1]&&(i=Gj(t.parameters[1]),_A(i,t.parameters[1])),t.parameters[2]&&(s=Jh(t.parameters[2])),new y_e(e,i,s)}function oE(t,e){if(t.length>e)throw new Se("effect:type-error",`Function supports up to ${e} parameters, Actual: ${t.length}`,{parameters:t})}function R4(t){if(t.type==="color")return"<color>";if(t.unit){if(t.unit in zj)return"<length>";if(t.unit in Vj)return"<angle>";if(t.unit==="%")return"<percentage>"}return"<double>"}function _A(t,e){if(t<0)throw new Se("effect:type-error",`Negative values are not allowed, Actual: ${t}`,{term:e})}function J6e(t){if(t.type!=="quantity"||t.unit!==null)throw new Se("effect:type-error",`Expected <double>, Actual: ${R4(t)}`,{term:t})}function eGe(t){if(t.type!=="quantity"||t.unit!==null&&t.unit!=="%")throw new Se("effect:type-error",`Expected <double> or <percentage>, Actual: ${R4(t)}`,{term:t})}q6e(Dw,Error),Dw.prototype.format=function(t){var e="Error: "+this.message;if(this.location){var i,s=null;for(i=0;i<t.length;i++)if(t[i].source===this.location.source){s=t[i].text.split(/\r\n|\n|\r/g);break}var n=this.location.start,r=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(n):n,o=this.location.source+":"+r.line+":"+r.column;if(s){var a=this.location.end,l=l5("",r.line.toString().length," "),u=s[n.line-1],c=(n.line===a.line?a.column:u.length+1)-n.column||1;e+=`
 --> `+o+`
`+l+` |
`+r.line+" | "+u+`
`+l+" | "+l5("",n.column-1," ")+l5("",c,"^")}else e+=`
 at `+o}return e},Dw.buildMessage=function(t,e){var i={literal:function(u){return'"'+n(u.text)+'"'},class:function(u){var c=u.parts.map(function(h){return Array.isArray(h)?r(h[0])+"-"+r(h[1]):r(h)});return"["+(u.inverted?"^":"")+c.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(u){return u.description}};function s(u){return u.charCodeAt(0).toString(16).toUpperCase()}function n(u){return u.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(c){return"\\x0"+s(c)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(c){return"\\x"+s(c)})}function r(u){return u.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(c){return"\\x0"+s(c)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(c){return"\\x"+s(c)})}function o(u){return i[u.type](u)}function a(u){var c,h,d=u.map(o);if(d.sort(),d.length>0){for(c=1,h=1;c<d.length;c++)d[c-1]!==d[c]&&(d[h]=d[c],h++);d.length=h}switch(d.length){case 1:return d[0];case 2:return d[0]+" or "+d[1];default:return d.slice(0,-1).join(", ")+", or "+d[d.length-1]}}function l(u){return u?'"'+n(u)+'"':"end of input"}return"Expected "+a(t)+" but "+l(e)+" found."};const Vj={deg:1,grad:.9,rad:180/Math.PI,turn:360};function tGe(t){if(t.type!=="quantity"||!(t.value===0&&t.unit===null||t.unit&&Vj[t.unit]!=null))throw new Se("effect:type-error",`Expected <angle>, Actual: ${R4(t)}`,{term:t})}const zj={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function iGe(t){if(t.type!=="quantity"||!(t.value===0&&t.unit===null||t.unit&&zj[t.unit]!=null))throw new Se("effect:type-error",`Expected <length>, Actual: ${R4(t)}`,{term:t})}function Jh(t){eGe(t);const e=t.value;return _A(e,t),t.unit==="%"?.01*e:e}function sGe(t){return J6e(t),_A(t.value,t),t.value}function nGe(t){return tGe(t),t.value*Vj[t.unit]||0}function Gj(t){return iGe(t),t.value*zj[t.unit]||0}function rGe(t){switch(t.colorType){case"hex":return zDe(t.value);case"named":return I_e(t.value);case"function":return lGe(t.value)}}function I_e(t){if(!zde(t))throw new Se("effect:unknown-color",`color '${t}' isn't valid`,{namedColor:t});return VDe(t)}const oGe=/^rgba?/i,aGe=/^hsla?/i;function lGe(t){if(oE(t.parameters,4),oGe.test(t.name))return[Jh(t.parameters[0]),Jh(t.parameters[1]),Jh(t.parameters[2]),t.parameters[3]?Jh(t.parameters[3]):1];if(aGe.test(t.name))return Gde(sGe(t.parameters[0]),Jh(t.parameters[1]),Jh(t.parameters[2]),t.parameters[3]?Jh(t.parameters[3]):1);throw new Se("effect:syntax-error",`Invalid color function '${t.name}'`,{colorFunction:t})}function uM(t,e,i){var s;try{return cGe(t)}catch(n){(s=i==null?void 0:i.messages)==null||s.push(n)}return null}function cM(t,e,i,s){try{const n=uGe(t);la(i,n,e)}catch(n){s.messages&&s.messages.push(n)}}function uGe(t){const e=A_e(t);return e?B6e(e)?e.map(i=>i.toJSON()):e.map(({scale:i,effects:s})=>({scale:i,value:s.map(n=>n.toJSON())})):null}function cGe(t){if(!t||t.length===0)return null;if(hGe(t)){const e=[];for(const i of t)e.push({scale:i.scale,value:Ite(i.value)});return e}return Ite(t)}function hGe(t){const e=t[0];return!!e&&"scale"in e}function Ite(t){if(!(t!=null&&t.length))return"";const e=[];for(const i of t){let s=[];switch(i.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":s=[Sp(i,"amount")];break;case"blur":s=[Sp(i,"radius","pt")];break;case"hue-rotate":s=[Sp(i,"angle","deg")];break;case"drop-shadow":s=[Sp(i,"xoffset","pt"),Sp(i,"yoffset","pt"),Sp(i,"blurRadius","pt"),dGe(i,"color")];break;case"bloom":s=[Sp(i,"strength"),Sp(i,"radius","pt"),Sp(i,"threshold")]}const n=`${i.type}(${s.filter(Boolean).join(" ")})`;A_e(n),e.push(n)}return e.join(" ")}function Sp(t,e,i){if(t[e]==null)throw new Se("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});return i?t[e]+i:""+t[e]}function dGe(t,e){if(t[e]==null)throw new Se("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});const i=t[e];return`rgba(${i[0]||0}, ${i[1]||0}, ${i[2]||0}, ${i[3]/255||0})`}const mGe={type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:{layerContainerTypes:rr}},"portal-item":{read:!0,write:{layerContainerTypes:rr}}}}},Dte={read:{reader:uM},write:{allowNull:!0,writer:cM,layerContainerTypes:rr}},pGe={json:{read:!1,write:!1,origins:{"web-map":Dte,"portal-item":Dte}}},D_e=t=>{let e=class extends t{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return y([S(mGe)],e.prototype,"blendMode",void 0),y([S(pGe)],e.prototype,"effect",void 0),e=y([se("esri.layers.mixins.BlendLayer")],e),e},N_e=t=>{let e=class extends t{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const i={minScale:this.minScale,maxScale:this.maxScale},s=this.parent;s&&"effectiveScaleRange"in s&&fGe(i,s.effectiveScaleRange);const n=this._get("effectiveScaleRange");return n&&n.minScale===i.minScale&&n.maxScale===i.maxScale?n:i}};return y([S({type:Number,nonNullable:!0,json:{write:!0}})],e.prototype,"minScale",void 0),y([S({type:Number,nonNullable:!0,json:{write:!0}})],e.prototype,"maxScale",void 0),y([S({readOnly:!0})],e.prototype,"effectiveScaleRange",null),e=y([se("esri.layers.mixins.ScaleRangeLayer")],e),e};function fGe(t,e){return t.minScale=t.minScale>0?e.minScale>0?Math.min(t.minScale,e.minScale):t.minScale:e.minScale,t.maxScale=t.maxScale>0?e.maxScale>0?Math.max(t.maxScale,e.maxScale):t.maxScale:e.maxScale,t}let e1=class extends QT{_own(e){e.layer&&"remove"in e.layer&&e.layer!==this.owner&&e.layer.remove(e),e.layer=this.owner}_release(e){e.layer===this.owner&&(e.layer=null)}};y([GH({Type:Kr,ensureType:xo(Kr)})],e1.prototype,"itemType",void 0),e1=y([se("esri.support.GraphicsCollection")],e1);var kB;let JC=kB=class extends it{constructor(t){super(t)}async collectRequiredFields(t,e){return al(t,e,this.expression)}clone(){return new kB({expression:this.expression,title:this.title})}equals(t){return this.expression===t.expression&&this.title===t.title}};y([S({type:String,json:{write:{isRequired:!0}}})],JC.prototype,"expression",void 0),y([S({type:String,json:{write:!0}})],JC.prototype,"title",void 0),JC=kB=y([se("esri.symbols.support.FeatureExpressionInfo")],JC);const Nte=JC,O4={unknown:1,inches:Qn(1,"meters","inches"),feet:Qn(1,"meters","feet"),"us-feet":Qn(1,"meters","us-feet"),yards:Qn(1,"meters","yards"),miles:Qn(1,"meters","miles"),"nautical-miles":Qn(1,"meters","nautical-miles"),millimeters:Qn(1,"meters","millimeters"),centimeters:Qn(1,"meters","centimeters"),decimeters:Qn(1,"meters","decimeters"),meters:Qn(1,"meters","meters"),kilometers:Qn(1,"meters","kilometers"),"decimal-degrees":1/Oce(1,"meters",Pr.radius)};function F0t(t){return!!t&&O4[t]!=null}function k0t(t){return 1/(O4[t]||1)}function gGe(){const t=Object.keys(O4);return $le(t,"decimal-degrees"),t.sort(),t}const _Ge=gGe();var $B;const iN=ca()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),Rte=new gs({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});let zp=$B=class extends it{constructor(t){super(t),this.featureExpressionInfo=void 0,this.offset=null}readFeatureExpressionInfo(t,e){return t??(e.featureExpression&&e.featureExpression.value===0?{expression:"0"}:void 0)}writeFeatureExpressionInfo(t,e,i,s){e[i]=t.write({},s),t.expression==="0"&&(e.featureExpression={value:0})}get mode(){const{offset:t,featureExpressionInfo:e}=this;return this._isOverridden("mode")?this._get("mode"):t!=null||e?"relative-to-ground":"on-the-ground"}set mode(t){this._override("mode",t)}set unit(t){this._set("unit",t)}write(t,e){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(t,e):null}clone(){return new $B({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}equals(t){return this.mode===t.mode&&this.offset===t.offset&&this.unit===t.unit&&m2e(this.featureExpressionInfo,t.featureExpressionInfo)}};y([S({type:Nte,json:{write:!0}})],zp.prototype,"featureExpressionInfo",void 0),y([mt("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],zp.prototype,"readFeatureExpressionInfo",null),y([yt("featureExpressionInfo",{featureExpressionInfo:{type:Nte},"featureExpression.value":{type:[0]}})],zp.prototype,"writeFeatureExpressionInfo",null),y([S({type:iN.apiValues,nonNullable:!0,json:{type:iN.jsonValues,read:iN.read,write:{writer:iN.write,isRequired:!0}}})],zp.prototype,"mode",null),y([S({type:Number,json:{write:!0}})],zp.prototype,"offset",void 0),y([S({type:_Ge,json:{type:String,read:Rte.read,write:Rte.write}})],zp.prototype,"unit",null),zp=$B=y([se("esri.symbols.support.ElevationInfo")],zp);const R_e=zp;let Gp=class extends D_e(N_e(A4)){constructor(e){super(e),this.elevationInfo=null,this.graphics=new e1,this.screenSizePerspectiveEnabled=!0,this.type="graphics",this.internal=!1}destroy(){this.removeAll(),this.graphics.destroy()}add(e){return this.graphics.add(e),this}addMany(e){return this.graphics.addMany(e),this}removeAll(){return this.graphics.removeAll(),this}remove(e){this.graphics.remove(e)}removeMany(e){this.graphics.removeMany(e)}on(e,i){return super.on(e,i)}graphicChanged(e){this.emit("graphic-update",e)}};y([S({type:R_e})],Gp.prototype,"elevationInfo",void 0),y([S(LB(e1,"graphics"))],Gp.prototype,"graphics",void 0),y([S({type:["show","hide"]})],Gp.prototype,"listMode",void 0),y([S()],Gp.prototype,"screenSizePerspectiveEnabled",void 0),y([S({readOnly:!0})],Gp.prototype,"type",void 0),y([S({constructOnly:!0})],Gp.prototype,"internal",void 0),Gp=y([se("esri.layers.GraphicsLayer")],Gp);const yGe=Gp;class sN{constructor(e,i,s){Lt(this,"projectedPoint");Lt(this,"button");Lt(this,"action");this.projectedPoint=e,this.button=i,this.action=s}}let L4;function O_e(){return!!L4&&PF()}async function vGe(){if(!O_e()){const[t,e]=await Promise.all([_e(()=>Promise.resolve().then(()=>ZT),void 0).then(i=>i.aH),_e(()=>Promise.resolve().then(()=>ZT),void 0).then(i=>i.aG).then(({injectPe:i})=>i),AH()]);L4=new t.OperatorProject,e(xce)}}function xGe(t,e){return L4.execute(t,e,null)}function bGe(){return L4.supportsCurves()}let L_e,Bj,UB,F_e,k_e,$_e,U_e,V_e,z_e,G_e,B_e;function wGe(){return!!Bj&&O_e()}async function SGe(){if(!wGe()){const[t,e,i,s]=await Promise.all([_e(()=>Promise.resolve().then(()=>Dze),void 0),_e(()=>Promise.resolve().then(()=>ZT),void 0).then(n=>n.aI).then(({CompositeGeographicTransformation:n})=>n),_e(()=>Promise.resolve().then(()=>ZT),void 0).then(n=>n.aJ).then(({create:n,createFromWKT:r})=>({create:n,createFromWKT:r})),_e(()=>Promise.resolve().then(()=>ZT),void 0).then(n=>n.aK).then(({create:n,createEx:r,createFromAoi:o})=>({create:n,createEx:r,createFromAoi:o})),vGe()]);L_e=t.fromExtent,Bj=t.fromGeometry,UB=t.fromSpatialReference,F_e=t.getSpatialReference,k_e=t.toGeometry,$_e=e,U_e=i.create,V_e=i.createFromWKT,z_e=s.createEx,G_e=s.createFromAoi,B_e=s.create,bGe()}}function q_e(t,e,i={}){const s=EGe(F_e(t),e,i);return k_e(xGe(Bj(t),s),e)}function EGe(t,e,i={}){let s;const n=UB(t),r=UB(e);if(i!=null&&i.geographicTransformation){const o=i.geographicTransformation.steps.map(a=>a.wkid?U_e(a.wkid,a.isInverse):V_e(a.wkt,a.isInverse));s=new $_e(o,null,n,r)}else if(i!=null&&i.areaOfInterestExtent)return G_e(n,r,L_e(i.areaOfInterestExtent).asEnvelope2D());return s?z_e(n,r,s):B_e(n,r)}class qj{constructor(e,i){Lt(this,"builderType",Pa.PolygonBuilder);Lt(this,"graphics");Lt(this,"model");Lt(this,"polygonGraphic");Lt(this,"fillSymbol");Lt(this,"finishCallback");this.model=new Fj(e),this.graphics=i,this.fillSymbol=sy.fillSymbol(),this.polygonGraphic=new Kr({geometry:new fy({rings:[this.model.vertices.map(s=>[s.x,s.y])],spatialReference:this.model.vertices[0].spatialReference}),symbol:this.fillSymbol,attributes:{modelAttributes:new xu(this.model,Zr.Polygon,0)}}),i.add(this.polygonGraphic)}static fromBasePoints(e,i){const s=e,n=[s.anchorPoint,s.endPoint,gn.offsetPoint(s.endPoint,5,0)];return new qj(n,i)}move(e){this.model.vertices[this.model.vertices.length-1]=e.projectedPoint,this.polygonGraphic.geometry=new fy({rings:[this.model.vertices.map(i=>[i.x,i.y])],spatialReference:this.model.vertices[0].spatialReference})}click(e){this.move(e),this.model.vertices.push(gn.offsetPoint(e.projectedPoint,5,0))}dblclick(e){this.click(e),this.polygonGraphic.symbol=wS.red(),this.finishCallback&&this.finishCallback(this.model)}activate(){}deactivate(){}destroy(){this.graphics.remove(this.polygonGraphic)}onFinish(e){this.finishCallback=e}}class u5{static click(e,i){e.currentBuilder?e.currentBuilder.builderType===Pa.LineBuilder||e.currentBuilder.builderType===Pa.PolygonBuilder&&e.currentBuilder.model.modelId===e.currentModel.modelId?e.currentBuilder.click(i):e.currentBuilder=void 0:(e.currentBuilder=new Lj(i.projectedPoint,e.graphicsLayer.graphics),e.currentModel=e.currentBuilder.model,e.currentBuilder.onFinish(s=>{var n;(n=e.currentBuilder)==null||n.destroy(),e.currentBuilder=qj.fromBasePoints(s,e.graphicsLayer.graphics),e.currentModel=e.currentBuilder.model,e.currentBuilder.onFinish(()=>{e.currentBuilder=void 0}),e.currentBuilder.activate()}),e.currentBuilder.activate())}static dblclick(e,i){e.currentBuilder&&e.currentBuilder.dblclick(i)}static move(e,i){if(e.currentBuilder){e.currentBuilder.move(i);const s=e.currentBuilder;s.builderType===Pa.LineBuilder?e.compassHandler.updateFromVertices([s.model.anchorPoint,s.model.endPoint]):s.builderType===Pa.PolygonBuilder&&e.compassHandler.updateFromVertices(s.model.vertices)}return e.currentBuilder!==void 0}}const hu=Math.PI/180,CGe=/(?:SPHEROID|ELLIPSOID)\[([^\]]+)]/i,Gg=Pr.radius,Ah=Pr.eccentricitySquared,TGe={a1:Gg*Ah,a2:Gg*Ah*Gg*Ah,a3:Gg*Ah*Ah/2,a4:Gg*Ah*Gg*Ah*2.5,a5:Gg*Ah+Gg*Ah*Ah/2,a6:1-Ah},PGe={4267:{a:63782064e-1,f:1/294.9786982},4269:{a:6378137,f:1/298.257222101},4326:{a:Pr.radius,f:Pr.flattening},4490:{a:6378137,f:1/298.257222101},104900:{a:2439700,f:0},104901:{a:6051e3,f:0},104902:{a:6051800,f:0},104903:{a:my.radius,f:my.flattening},104904:{a:3393400,f:1/192.0430107526882},104905:{a:Pm.radius,f:Pm.flattening},104906:{a:6200,f:0},104907:{a:11100,f:0},104908:{a:71492e3,f:.06487439154031222},104909:{a:8200,f:0},104910:{a:83500,f:0},104911:{a:1e4,f:0},104912:{a:2409300,f:0},104913:{a:15e3,f:0},104914:{a:4e4,f:0},104915:{a:1562090,f:0},104916:{a:2632345,f:0},104917:{a:85e3,f:0},104918:{a:1821460,f:0},104919:{a:5e3,f:0},104920:{a:12e3,f:0},104921:{a:3e4,f:3},104922:{a:18e3,f:0},104923:{a:14e3,f:0},104924:{a:49300,f:0},104925:{a:60268e3,f:1/10.2079945799458},104926:{a:16e3,f:0},104927:{a:9500,f:0},104928:{a:56e4,f:0},104929:{a:249400,f:0},104930:{a:59500,f:0},104931:{a:16e3,f:0},104932:{a:133e3,f:0},104933:{a:718e3,f:0},104934:{a:888e3,f:0},104935:{a:1986300,f:0},104936:{a:1e4,f:0},104937:{a:41900,f:0},104938:{a:11e4,f:0},104939:{a:50100,f:0},104940:{a:764e3,f:0},104941:{a:11e3,f:0},104942:{a:529800,f:0},104943:{a:2575e3,f:0},104944:{a:25559e3,f:1/43.61604095563141},104945:{a:578900,f:0},104946:{a:33e3,f:0},104947:{a:21e3,f:0},104948:{a:13e3,f:0},104949:{a:31e3,f:0},104950:{a:27e3,f:0},104951:{a:42e3,f:0},104952:{a:235800,f:0},104953:{a:761400,f:0},104954:{a:15e3,f:0},104955:{a:54e3,f:0},104956:{a:77e3,f:0},104957:{a:27e3,f:0},104958:{a:788900,f:0},104959:{a:584700,f:0},104960:{a:24764e3,f:.01708124697141011},104961:{a:74e3,f:0},104962:{a:79e3,f:0},104963:{a:104e3,f:.14423076923076922},104964:{a:29e3,f:0},104965:{a:17e4,f:0},104966:{a:208e3,f:0},104967:{a:4e4,f:0},104968:{a:1352600,f:0},104969:{a:1195e3,f:0},104970:{a:593e3,f:0},104971:{a:Pm.radius,f:0},104972:{a:47e4,f:0},104973:{a:255e3,f:0},104974:{a:2439400,f:0}};function H_e(t){if(!t)return null;const e=t.wkid;if(e)return PGe[e];const i=t.wkt2??t.wkt;return i?MGe(i):null}function MGe(t){const e=CGe.exec(t);if(!e||e.length!==2)return null;const i=e[1].split(",");if(!i||i.length<3)return null;const s=parseFloat(i[1]),n=parseFloat(i[2]);return isNaN(s)||isNaN(n)?null:{a:s,f:n===0?0:1/n}}function F4(t){const e=H_e(t);if(AGe(e))return e;const i=e.a*(1-e.f);return Object.assign(e,{b:i,eSq:1-(i/e.a)**2,radius:(2*e.a+i)/3,densificationRatio:1e4/((2*e.a+i)/3)})}function AGe(t){return t!=null&&"b"in t&&"eSq"in t&&"radius"in t}function nN(t,e,i){const{a:s,eSq:n}=F4(i),r=Math.sqrt(n),o=Math.sin(e[1]*hu),a=s*e[0]*hu;let l;return n>0?l=s*((1-n)*(o/(1-n*(o*o))-1/(2*r)*Math.log((1-r*o)/(1+r*o))))*.5:l=s*o,t[0]=a,t[1]=l,t}function k4(t){return Rf(t)&&!!H_e(t)}function U0t(t,e="square-meters"){if(t.some(o=>!k4(o.spatialReference)))throw new Se("geodesic-areas:invalid-spatial-reference","the input geometries spatial reference is not supported");const i=[];for(let o=0;o<t.length;o++){const a=t[o],l=a.spatialReference,{radius:u,densificationRatio:c}=F4(l),h=u*c;i.push(IGe(a,h))}const s=[],n=[0,0],r=[0,0];for(let o=0;o<i.length;o++){const{rings:a,spatialReference:l}=i[o];let u=0;for(let c=0;c<a.length;c++){const h=a[c];nN(n,h[0],l),nN(r,h[h.length-1],l);let d=r[0]*n[1]-n[0]*r[1];for(let m=0;m<h.length-1;m++)nN(n,h[m+1],l),nN(r,h[m],l),d+=r[0]*n[1]-n[0]*r[1];u+=d}u=Qn(u,"square-meters",e),s.push(u/-2)}return s}function V0t(t,e="meters"){if(!t)throw new Se("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(t.some(s=>!k4(s.spatialReference)))throw new Se("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const i=[];for(let s=0;s<t.length;s++){const n=t[s],{spatialReference:r}=n,o=n.type==="polyline"?n.paths:n.rings;let a=0;for(let l=0;l<o.length;l++){const u=o[l];let c=0;for(let h=1;h<u.length;h++){const d=u[h-1][0],m=u[h][0],f=u[h-1][1],_=u[h][1];if(f!==_||d!==m){const v=new j_e;Y_e(v,[d,f],[m,_],r),c+=v.distance}}a+=c}a=Qn(a,"meters",e),i.push(a)}return i}function IGe(t,e){if(t.type!=="polyline"&&t.type!=="polygon")throw new Se("geodesic-densify:invalid-geometry","the input geometry is neither polyline nor polygon");const{spatialReference:i}=t;if(!k4(i))throw new Se("geodesic-densify:invalid-spatial-reference","the input geometry spatial reference is not supported");const s=t.type==="polyline"?t.paths:t.rings,n=[],r=[0,0],o=new j_e;for(const l of s){const u=[];n.push(u),u.push([l[0][0],l[0][1]]);let c,h,d=l[0][0],m=l[0][1];for(let f=0;f<l.length-1;f++){if(c=l[f+1][0],h=l[f+1][1],d===c&&m===h)continue;const _=[d,m];Y_e(o,[d,m],[c,h],i);const{azimuth:v,distance:x}=o,w=x/e;if(w>1){for(let T=1;T<=w-1;T++)d3(r,_,v,T*e,i),u.push(r.slice());d3(r,_,v,(x+Math.floor(w-1)*e)/2,i),u.push(r.slice())}d3(r,_,v,x,i),u.push(r.slice()),d=r[0],m=r[1]}}const a=OS(Ri,i);return t.type==="polyline"?new gu({paths:n,spatialReference:a}):new Na({rings:n,spatialReference:a})}let j_e=class{constructor(e=0,i=void 0,s=void 0){this.distance=e,this.azimuth=i,this.reverseAzimuth=s}};function d3(t,e,i,s,n){const r=e[0],o=e[1],a=r*hu,l=o*hu,u=(i??0)*hu,{a:c,b:h,f:d}=F4(n),m=Math.sin(u),f=Math.cos(u),_=(1-d)*Math.tan(l),v=1/Math.sqrt(1+_*_),x=_*v,w=Math.atan2(_,f),T=v*m,C=T*T,M=1-C,A=M*(c*c-h*h)/(h*h),I=1+A/16384*(4096+A*(A*(320-175*A)-768)),L=A/1024*(256+A*(A*(74-47*A)-128));let D,O,U,$=s/(h*I),B=2*Math.PI;for(;Math.abs($-B)>1e-12;)U=Math.cos(2*w+$),D=Math.sin($),O=Math.cos($),B=$,$=s/(h*I)+L*D*(U+L/4*(O*(2*U*U-1)-L/6*U*(4*D*D-3)*(4*U*U-3)));const V=x*D-v*O*f,H=Math.atan2(x*O+v*D*f,(1-d)*Math.sqrt(C+V*V)),Y=d/16*M*(4+d*(4-3*M)),W=Math.atan2(D*m,v*O-x*D*f)-(1-Y)*d*T*($+Y*D*(U+Y*O*(2*U*U-1)));return t[0]=(a+W)/hu,t[1]=H/hu,t}function Y_e(t,e,i,s){const n=e[0]*hu,r=e[1]*hu,o=i[0]*hu,a=i[1]*hu,{a:l,b:u,f:c,radius:h}=F4(s),d=o-n,m=Math.atan((1-c)*Math.tan(r)),f=Math.atan((1-c)*Math.tan(a)),_=Math.sin(m),v=Math.cos(m),x=Math.sin(f),w=Math.cos(f);let T,C,M,A,I,L,D,O,U,$,B=1e3,V=d;do{if(D=Math.sin(V),O=Math.cos(V),M=Math.sqrt(w*D*(w*D)+(v*x-_*w*O)*(v*x-_*w*O)),M===0)return t.distance=0,t.azimuth=void 0,t.reverseAzimuth=void 0,t;I=_*x+v*w*O,L=Math.atan2(M,I),U=v*w*D/M,C=1-U*U,A=I-2*_*x/C,isNaN(A)&&(A=0),$=c/16*C*(4+c*(4-3*C)),T=V,V=d+(1-$)*c*U*(L+$*M*(A+$*I*(2*A*A-1)))}while(Math.abs(V-T)>1e-12&&--B>0);if(B===0){const j=h,oe=Math.acos(Math.sin(r)*Math.sin(a)+Math.cos(r)*Math.cos(a)*Math.cos(o-n))*j,ve=o-n,Ye=Math.sin(ve)*Math.cos(a),de=Math.cos(r)*Math.sin(a)-Math.sin(r)*Math.cos(a)*Math.cos(ve),fe=Math.atan2(Ye,de);return t.azimuth=fe/hu,t.distance=oe,t.reverseAzimuth=void 0,t}const H=C*(l*l-u*u)/(u*u),Y=H/1024*(256+H*(H*(74-47*H)-128)),W=u*(1+H/16384*(4096+H*(H*(320-175*H)-768)))*(L-Y*M*(A+Y/4*(I*(2*A*A-1)-Y/6*A*(4*M*M-3)*(4*A*A-3)))),ee=Math.atan2(w*Math.sin(V),v*x-_*w*Math.cos(V)),ne=Math.atan2(v*Math.sin(V),v*x*Math.cos(V)-_*w);return t.azimuth=ee/hu,t.distance=W,t.reverseAzimuth=ne/hu,t}function G0t(t){return k4(t)?t:yd(t)?Ri.WGS84:null}var VB;let m_=VB=class extends Na{constructor(t){super(t),this.center=null,this.geodesic=!1,this.numberOfPoints=60,this.radius=1e3,this.radiusUnit="meters"}initialize(){const t=this.center,e=this.numberOfPoints;if(this.hasZ=(t==null?void 0:t.hasZ)??!1,this.rings.length!==0||!t)return;const i=Qn(this.radius,this.radiusUnit,"meters"),s=t.spatialReference;let n,r="geographic";if(s.isWebMercator?r="webMercator":((s.wkid&&K[s.wkid])!=null||(s.wkt2||s.wkt)&&IF(s.wkt2||s.wkt))&&(r="projected"),this.geodesic){let o;switch(r){case"webMercator":o=Ov(t);break;case"projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case"geographic":o=t}n=this._createGeodesicCircle(o,i,e),r==="webMercator"&&(n=ty(n))}else{let o;r==="webMercator"||r==="projected"?o=i/OH(t.spatialReference):r==="geographic"&&(o=Oce(i,"meters",Mce(t.spatialReference).radius)),n=this._createPlanarCircle(t,o,e)}this.spatialReference=n.spatialReference,this.addRing(n.rings[0])}clone(){const{center:t,numberOfPoints:e,radius:i,radiusUnit:s,geodesic:n}=this;return new VB({center:t==null?void 0:t.clone(),numberOfPoints:e,radius:i,radiusUnit:s,geodesic:n})}_createGeodesicCircle(t,e,i){const s=[],n=[t.x,t.y];for(let r=0;r<360;r+=360/i){const o=this.hasZ?[0,0,t.z??0]:[0,0];d3(o,n,r,e,Ri.WGS84),s.push(o)}return s.push(s[0]),new Na({rings:[s]})}_createPlanarCircle(t,e,i){const s=[],n=2*Math.PI/i;for(let r=0;r<i;++r){const o=n*r,a=[t.x+Math.cos(-o)*e,t.y+Math.sin(-o)*e];this.hasZ&&a.push(t.z??0),s.push(a)}return s.push(s[0]),new Na({spatialReference:t.spatialReference,rings:[s]})}};y([S({type:ki})],m_.prototype,"center",void 0),y([S()],m_.prototype,"geodesic",void 0),y([S()],m_.prototype,"numberOfPoints",void 0),y([S()],m_.prototype,"radius",void 0),y([S()],m_.prototype,"radiusUnit",void 0),m_=VB=y([se("esri.geometry.Circle")],m_);const DGe=m_;class au{constructor(e,i){Lt(this,"centerPoint");Lt(this,"azimuth");Lt(this,"centerGraphic");Lt(this,"azimuthGraphic");Lt(this,"normalGraphic");Lt(this,"innerCircleGraphic");Lt(this,"outerCircleGraphic");this.centerPoint=e,this.azimuth=i,this.centerGraphic=new Kr({geometry:e,symbol:W_.redCircle()}),this.azimuthGraphic=au.createAzimuth(au.createAzimuthGeometry(e,i)),this.normalGraphic=au.createNormal(au.createNormalGeometry(e,i)),this.innerCircleGraphic=au.createCircle(au.createCircleGeometry(e,5280/2)),this.outerCircleGraphic=au.createCircle(au.createCircleGeometry(e,5280))}updateFromVertices(e){this.centerPoint=gn.pointsToPolygon(e).centroid,this.azimuth=gn.convertPathToAzimuth([[e[0].x,e[0].y],[e[1].x,e[1].y]]),this.updateGraphics()}updateGraphics(){this.azimuthGraphic.geometry=au.createAzimuthGeometry(this.centerPoint,this.azimuth),this.normalGraphic.geometry=au.createNormalGeometry(this.centerPoint,this.azimuth),this.innerCircleGraphic.geometry=au.createCircleGeometry(this.centerPoint,5280/2),this.outerCircleGraphic.geometry=au.createCircleGeometry(this.centerPoint,5280)}static createAzimuthGeometry(e,i){const s=gn.offsetByAzimuth(e,i,2e4),n=gn.offsetByAzimuth(e,i-180,2e4);return new CP({paths:[[[s.x,s.y],[n.x,n.y]]],spatialReference:e.spatialReference})}static createNormalGeometry(e,i){const s=gn.offsetByAzimuth(e,i+90,2e4),n=gn.offsetByAzimuth(e,i-90,2e4);return new CP({paths:[[[s.x,s.y],[n.x,n.y]]],spatialReference:e.spatialReference})}static createCircleGeometry(e,i){return new DGe({center:e,radius:i,radiusUnit:"feet"})}static createCircle(e){return new Kr({geometry:e,symbol:new xf({color:"#ff000011",width:"2px",style:"long-dash"}),attributes:{modelAttributes:new xu(new Iw,Zr.Compass,0)}})}static createAzimuth(e){return new Kr({geometry:e,symbol:new xf({color:"#ff000011",width:"3px",style:"long-dash"}),attributes:{modelAttributes:new xu(new Iw,Zr.Compass,0)}})}static createNormal(e){return new Kr({geometry:e,symbol:new xf({color:"#ff000011",width:"2px",style:"short-dash"}),attributes:{modelAttributes:new xu(new Iw,Zr.Compass,0)}})}}const hF=class hF{constructor(){Lt(this,"view");Lt(this,"statePlane");Lt(this,"statePlaneName","");Lt(this,"currentModel",new Iw);Lt(this,"currentBuilder");Lt(this,"compassHandler");Lt(this,"currentMode",dr.None);Lt(this,"graphicsLayer");Lt(this,"clickListeners",[]);Lt(this,"dragListeners",[]);Lt(this,"moveListeners",[]);this.graphicsLayer=new yGe({id:dhe.graphicsLayerName}),this.compassHandler=new au(new Mm,0),this.graphicsLayer.addMany([this.compassHandler.azimuthGraphic,this.compassHandler.normalGraphic,this.compassHandler.innerCircleGraphic,this.compassHandler.outerCircleGraphic])}toStatePlane(e){return q_e(this.view.toMap(e),this.statePlane)}setMode(e){if(this.currentMode=e,this.currentBuilder&&this.currentBuilder.deactivate(),this.currentBuilder=void 0,e===dr.TransformRect){const i=this.graphicsLayer.graphics.find(s=>s.attributes.modelAttributes.model.modelId===this.currentModel.modelId&&s.attributes.modelAttributes.role===Zr.Polygon);i&&(this.currentBuilder=new c_e(i,this.graphicsLayer.graphics),this.currentBuilder.activate())}}click(e){if(this.currentMode===dr.None){this.hitTest(e,(s,n,r)=>{r.attributes.FID&&s.graphicsLayer.add(new Kr({geometry:new fy({rings:r.geometry.rings,spatialReference:r.geometry.spatialReference}),symbol:wS.red()}))});return}e.stopPropagation();const i=new sN(this.toStatePlane(e),e.buttons,"click");switch(this.currentMode){case dr.DrawLine:r5.click(this,i);break;case dr.DrawRect:o5.click(this,i);break;case dr.DrawPolygon:u5.click(this,i);break;case dr.TransformRect:this.hitTest(e,tN.click);break}Promise.all(this.clickListeners.map(s=>s()))}dblclick(e){if(this.currentMode===dr.None)return;e.stopPropagation();const i=new sN(this.toStatePlane(e),e.buttons,"dblclick");switch(this.currentMode){case dr.DrawLine:r5.click(this,i);break;case dr.DrawRect:o5.click(this,i);break;case dr.DrawPolygon:u5.dblclick(this,i);break;case dr.TransformRect:this.hitTest(e,tN.dblclick);break}Promise.all(this.clickListeners.map(s=>s()))}move(e){if(this.currentMode===dr.None)return;e.stopPropagation();const i=new sN(this.toStatePlane(e),e.button,"move");switch(this.currentMode){case dr.DrawLine:r5.move(this,i)&&Promise.all(this.moveListeners.map(s=>s()));break;case dr.DrawRect:o5.move(this,i)&&Promise.all(this.moveListeners.map(s=>s()));break;case dr.DrawPolygon:u5.move(this,i)&&Promise.all(this.moveListeners.map(s=>s()));break;case dr.TransformRect:tN.move(this,i);break}}drag(e){if(this.currentMode!==dr.None)switch(e.stopPropagation(),this.currentMode){case dr.TransformRect:this.hitTest(e,tN.drag),Promise.all(this.dragListeners.map(i=>i()));break}}hitTest(e,i){this.view.hitTest(e).then(s=>{const n=new sN(this.toStatePlane(e),e.button,"action"in e?e.action:"hit");s.results.forEach(r=>{i(this,n,r.graphic)})})}escape(){this.currentBuilder&&this.currentBuilder.destroy(),this.currentModel=new Iw,this.setMode(dr.None)}};Lt(hF,"instance",new hF);let IL=hF;const Hj=Ve.createContext(IL.instance);var m3={exports:{}};/*!
  * Bootstrap v5.3.6 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var NGe=m3.exports,Ote;function RGe(){return Ote||(Ote=1,function(t,e){(function(i,s){t.exports=s()})(NGe,function(){const i=new Map,s={set(Q,F,X){i.has(Q)||i.set(Q,new Map);const ae=i.get(Q);ae.has(F)||ae.size===0?ae.set(F,X):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(ae.keys())[0]}.`)},get:(Q,F)=>i.has(Q)&&i.get(Q).get(F)||null,remove(Q,F){if(!i.has(Q))return;const X=i.get(Q);X.delete(F),X.size===0&&i.delete(Q)}},n="transitionend",r=Q=>(Q&&window.CSS&&window.CSS.escape&&(Q=Q.replace(/#([^\s"#']+)/g,(F,X)=>`#${CSS.escape(X)}`)),Q),o=Q=>{Q.dispatchEvent(new Event(n))},a=Q=>!(!Q||typeof Q!="object")&&(Q.jquery!==void 0&&(Q=Q[0]),Q.nodeType!==void 0),l=Q=>a(Q)?Q.jquery?Q[0]:Q:typeof Q=="string"&&Q.length>0?document.querySelector(r(Q)):null,u=Q=>{if(!a(Q)||Q.getClientRects().length===0)return!1;const F=getComputedStyle(Q).getPropertyValue("visibility")==="visible",X=Q.closest("details:not([open])");if(!X)return F;if(X!==Q){const ae=Q.closest("summary");if(ae&&ae.parentNode!==X||ae===null)return!1}return F},c=Q=>!Q||Q.nodeType!==Node.ELEMENT_NODE||!!Q.classList.contains("disabled")||(Q.disabled!==void 0?Q.disabled:Q.hasAttribute("disabled")&&Q.getAttribute("disabled")!=="false"),h=Q=>{if(!document.documentElement.attachShadow)return null;if(typeof Q.getRootNode=="function"){const F=Q.getRootNode();return F instanceof ShadowRoot?F:null}return Q instanceof ShadowRoot?Q:Q.parentNode?h(Q.parentNode):null},d=()=>{},m=Q=>{Q.offsetHeight},f=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,_=[],v=()=>document.documentElement.dir==="rtl",x=Q=>{var F;F=()=>{const X=f();if(X){const ae=Q.NAME,Te=X.fn[ae];X.fn[ae]=Q.jQueryInterface,X.fn[ae].Constructor=Q,X.fn[ae].noConflict=()=>(X.fn[ae]=Te,Q.jQueryInterface)}},document.readyState==="loading"?(_.length||document.addEventListener("DOMContentLoaded",()=>{for(const X of _)X()}),_.push(F)):F()},w=(Q,F=[],X=Q)=>typeof Q=="function"?Q.call(...F):X,T=(Q,F,X=!0)=>{if(!X)return void w(Q);const ae=(Ke=>{if(!Ke)return 0;let{transitionDuration:lt,transitionDelay:vt}=window.getComputedStyle(Ke);const Ft=Number.parseFloat(lt),Ht=Number.parseFloat(vt);return Ft||Ht?(lt=lt.split(",")[0],vt=vt.split(",")[0],1e3*(Number.parseFloat(lt)+Number.parseFloat(vt))):0})(F)+5;let Te=!1;const Pe=({target:Ke})=>{Ke===F&&(Te=!0,F.removeEventListener(n,Pe),w(Q))};F.addEventListener(n,Pe),setTimeout(()=>{Te||o(F)},ae)},C=(Q,F,X,ae)=>{const Te=Q.length;let Pe=Q.indexOf(F);return Pe===-1?!X&&ae?Q[Te-1]:Q[0]:(Pe+=X?1:-1,ae&&(Pe=(Pe+Te)%Te),Q[Math.max(0,Math.min(Pe,Te-1))])},M=/[^.]*(?=\..*)\.|.*/,A=/\..*/,I=/::\d+$/,L={};let D=1;const O={mouseenter:"mouseover",mouseleave:"mouseout"},U=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function $(Q,F){return F&&`${F}::${D++}`||Q.uidEvent||D++}function B(Q){const F=$(Q);return Q.uidEvent=F,L[F]=L[F]||{},L[F]}function V(Q,F,X=null){return Object.values(Q).find(ae=>ae.callable===F&&ae.delegationSelector===X)}function H(Q,F,X){const ae=typeof F=="string",Te=ae?X:F||X;let Pe=ne(Q);return U.has(Pe)||(Pe=Q),[ae,Te,Pe]}function Y(Q,F,X,ae,Te){if(typeof F!="string"||!Q)return;let[Pe,Ke,lt]=H(F,X,ae);F in O&&(Ke=(Oi=>function(Vi){if(!Vi.relatedTarget||Vi.relatedTarget!==Vi.delegateTarget&&!Vi.delegateTarget.contains(Vi.relatedTarget))return Oi.call(this,Vi)})(Ke));const vt=B(Q),Ft=vt[lt]||(vt[lt]={}),Ht=V(Ft,Ke,Pe?X:null);if(Ht)return void(Ht.oneOff=Ht.oneOff&&Te);const Ot=$(Ke,F.replace(M,"")),ts=Pe?function(Si,Oi,Vi){return function Xi(Ds){const tn=Si.querySelectorAll(Oi);for(let{target:ls}=Ds;ls&&ls!==this;ls=ls.parentNode)for(const Ns of tn)if(Ns===ls)return oe(Ds,{delegateTarget:ls}),Xi.oneOff&&j.off(Si,Ds.type,Oi,Vi),Vi.apply(ls,[Ds])}}(Q,X,Ke):function(Si,Oi){return function Vi(Xi){return oe(Xi,{delegateTarget:Si}),Vi.oneOff&&j.off(Si,Xi.type,Oi),Oi.apply(Si,[Xi])}}(Q,Ke);ts.delegationSelector=Pe?X:null,ts.callable=Ke,ts.oneOff=Te,ts.uidEvent=Ot,Ft[Ot]=ts,Q.addEventListener(lt,ts,Pe)}function W(Q,F,X,ae,Te){const Pe=V(F[X],ae,Te);Pe&&(Q.removeEventListener(X,Pe,!!Te),delete F[X][Pe.uidEvent])}function ee(Q,F,X,ae){const Te=F[X]||{};for(const[Pe,Ke]of Object.entries(Te))Pe.includes(ae)&&W(Q,F,X,Ke.callable,Ke.delegationSelector)}function ne(Q){return Q=Q.replace(A,""),O[Q]||Q}const j={on(Q,F,X,ae){Y(Q,F,X,ae,!1)},one(Q,F,X,ae){Y(Q,F,X,ae,!0)},off(Q,F,X,ae){if(typeof F!="string"||!Q)return;const[Te,Pe,Ke]=H(F,X,ae),lt=Ke!==F,vt=B(Q),Ft=vt[Ke]||{},Ht=F.startsWith(".");if(Pe===void 0){if(Ht)for(const Ot of Object.keys(vt))ee(Q,vt,Ot,F.slice(1));for(const[Ot,ts]of Object.entries(Ft)){const Si=Ot.replace(I,"");lt&&!F.includes(Si)||W(Q,vt,Ke,ts.callable,ts.delegationSelector)}}else{if(!Object.keys(Ft).length)return;W(Q,vt,Ke,Pe,Te?X:null)}},trigger(Q,F,X){if(typeof F!="string"||!Q)return null;const ae=f();let Te=null,Pe=!0,Ke=!0,lt=!1;F!==ne(F)&&ae&&(Te=ae.Event(F,X),ae(Q).trigger(Te),Pe=!Te.isPropagationStopped(),Ke=!Te.isImmediatePropagationStopped(),lt=Te.isDefaultPrevented());const vt=oe(new Event(F,{bubbles:Pe,cancelable:!0}),X);return lt&&vt.preventDefault(),Ke&&Q.dispatchEvent(vt),vt.defaultPrevented&&Te&&Te.preventDefault(),vt}};function oe(Q,F={}){for(const[X,ae]of Object.entries(F))try{Q[X]=ae}catch{Object.defineProperty(Q,X,{configurable:!0,get:()=>ae})}return Q}function ve(Q){if(Q==="true")return!0;if(Q==="false")return!1;if(Q===Number(Q).toString())return Number(Q);if(Q===""||Q==="null")return null;if(typeof Q!="string")return Q;try{return JSON.parse(decodeURIComponent(Q))}catch{return Q}}function Ye(Q){return Q.replace(/[A-Z]/g,F=>`-${F.toLowerCase()}`)}const de={setDataAttribute(Q,F,X){Q.setAttribute(`data-bs-${Ye(F)}`,X)},removeDataAttribute(Q,F){Q.removeAttribute(`data-bs-${Ye(F)}`)},getDataAttributes(Q){if(!Q)return{};const F={},X=Object.keys(Q.dataset).filter(ae=>ae.startsWith("bs")&&!ae.startsWith("bsConfig"));for(const ae of X){let Te=ae.replace(/^bs/,"");Te=Te.charAt(0).toLowerCase()+Te.slice(1),F[Te]=ve(Q.dataset[ae])}return F},getDataAttribute:(Q,F)=>ve(Q.getAttribute(`data-bs-${Ye(F)}`))};class fe{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(F){return F=this._mergeConfigObj(F),F=this._configAfterMerge(F),this._typeCheckConfig(F),F}_configAfterMerge(F){return F}_mergeConfigObj(F,X){const ae=a(X)?de.getDataAttribute(X,"config"):{};return{...this.constructor.Default,...typeof ae=="object"?ae:{},...a(X)?de.getDataAttributes(X):{},...typeof F=="object"?F:{}}}_typeCheckConfig(F,X=this.constructor.DefaultType){for(const[Te,Pe]of Object.entries(X)){const Ke=F[Te],lt=a(Ke)?"element":(ae=Ke)==null?`${ae}`:Object.prototype.toString.call(ae).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(Pe).test(lt))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${Te}" provided type "${lt}" but expected type "${Pe}".`)}var ae}}class Ne extends fe{constructor(F,X){super(),(F=l(F))&&(this._element=F,this._config=this._getConfig(X),s.set(this._element,this.constructor.DATA_KEY,this))}dispose(){s.remove(this._element,this.constructor.DATA_KEY),j.off(this._element,this.constructor.EVENT_KEY);for(const F of Object.getOwnPropertyNames(this))this[F]=null}_queueCallback(F,X,ae=!0){T(F,X,ae)}_getConfig(F){return F=this._mergeConfigObj(F,this._element),F=this._configAfterMerge(F),this._typeCheckConfig(F),F}static getInstance(F){return s.get(l(F),this.DATA_KEY)}static getOrCreateInstance(F,X={}){return this.getInstance(F)||new this(F,typeof X=="object"?X:null)}static get VERSION(){return"5.3.6"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(F){return`${F}${this.EVENT_KEY}`}}const je=Q=>{let F=Q.getAttribute("data-bs-target");if(!F||F==="#"){let X=Q.getAttribute("href");if(!X||!X.includes("#")&&!X.startsWith("."))return null;X.includes("#")&&!X.startsWith("#")&&(X=`#${X.split("#")[1]}`),F=X&&X!=="#"?X.trim():null}return F?F.split(",").map(X=>r(X)).join(","):null},Ee={find:(Q,F=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(F,Q)),findOne:(Q,F=document.documentElement)=>Element.prototype.querySelector.call(F,Q),children:(Q,F)=>[].concat(...Q.children).filter(X=>X.matches(F)),parents(Q,F){const X=[];let ae=Q.parentNode.closest(F);for(;ae;)X.push(ae),ae=ae.parentNode.closest(F);return X},prev(Q,F){let X=Q.previousElementSibling;for(;X;){if(X.matches(F))return[X];X=X.previousElementSibling}return[]},next(Q,F){let X=Q.nextElementSibling;for(;X;){if(X.matches(F))return[X];X=X.nextElementSibling}return[]},focusableChildren(Q){const F=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(X=>`${X}:not([tabindex^="-"])`).join(",");return this.find(F,Q).filter(X=>!c(X)&&u(X))},getSelectorFromElement(Q){const F=je(Q);return F&&Ee.findOne(F)?F:null},getElementFromSelector(Q){const F=je(Q);return F?Ee.findOne(F):null},getMultipleElementsFromSelector(Q){const F=je(Q);return F?Ee.find(F):[]}},Zt=(Q,F="hide")=>{const X=`click.dismiss${Q.EVENT_KEY}`,ae=Q.NAME;j.on(document,X,`[data-bs-dismiss="${ae}"]`,function(Te){if(["A","AREA"].includes(this.tagName)&&Te.preventDefault(),c(this))return;const Pe=Ee.getElementFromSelector(this)||this.closest(`.${ae}`);Q.getOrCreateInstance(Pe)[F]()})},qt=".bs.alert",Mi=`close${qt}`,oi=`closed${qt}`;class si extends Ne{static get NAME(){return"alert"}close(){if(j.trigger(this._element,Mi).defaultPrevented)return;this._element.classList.remove("show");const F=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,F)}_destroyElement(){this._element.remove(),j.trigger(this._element,oi),this.dispose()}static jQueryInterface(F){return this.each(function(){const X=si.getOrCreateInstance(this);if(typeof F=="string"){if(X[F]===void 0||F.startsWith("_")||F==="constructor")throw new TypeError(`No method named "${F}"`);X[F](this)}})}}Zt(si,"close"),x(si);const me='[data-bs-toggle="button"]';class Bi extends Ne{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(F){return this.each(function(){const X=Bi.getOrCreateInstance(this);F==="toggle"&&X[F]()})}}j.on(document,"click.bs.button.data-api",me,Q=>{Q.preventDefault();const F=Q.target.closest(me);Bi.getOrCreateInstance(F).toggle()}),x(Bi);const pt=".bs.swipe",$e=`touchstart${pt}`,wt=`touchmove${pt}`,$i=`touchend${pt}`,Mt=`pointerdown${pt}`,le=`pointerup${pt}`,te={endCallback:null,leftCallback:null,rightCallback:null},De={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class et extends fe{constructor(F,X){super(),this._element=F,F&&et.isSupported()&&(this._config=this._getConfig(X),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return te}static get DefaultType(){return De}static get NAME(){return"swipe"}dispose(){j.off(this._element,pt)}_start(F){this._supportPointerEvents?this._eventIsPointerPenTouch(F)&&(this._deltaX=F.clientX):this._deltaX=F.touches[0].clientX}_end(F){this._eventIsPointerPenTouch(F)&&(this._deltaX=F.clientX-this._deltaX),this._handleSwipe(),w(this._config.endCallback)}_move(F){this._deltaX=F.touches&&F.touches.length>1?0:F.touches[0].clientX-this._deltaX}_handleSwipe(){const F=Math.abs(this._deltaX);if(F<=40)return;const X=F/this._deltaX;this._deltaX=0,X&&w(X>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(j.on(this._element,Mt,F=>this._start(F)),j.on(this._element,le,F=>this._end(F)),this._element.classList.add("pointer-event")):(j.on(this._element,$e,F=>this._start(F)),j.on(this._element,wt,F=>this._move(F)),j.on(this._element,$i,F=>this._end(F)))}_eventIsPointerPenTouch(F){return this._supportPointerEvents&&(F.pointerType==="pen"||F.pointerType==="touch")}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const tt=".bs.carousel",Ze=".data-api",Ct="ArrowLeft",gt="ArrowRight",dt="next",hi="prev",ct="left",xt="right",li=`slide${tt}`,jt=`slid${tt}`,Tt=`keydown${tt}`,Ii=`mouseenter${tt}`,di=`mouseleave${tt}`,ms=`dragstart${tt}`,we=`load${tt}${Ze}`,Dt=`click${tt}${Ze}`,Qe="carousel",ot="active",Rt=".active",It=".carousel-item",qi=Rt+It,hn={[Ct]:xt,[gt]:ct},or={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Ms={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Le extends Ne{constructor(F,X){super(F,X),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=Ee.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===Qe&&this.cycle()}static get Default(){return or}static get DefaultType(){return Ms}static get NAME(){return"carousel"}next(){this._slide(dt)}nextWhenVisible(){!document.hidden&&u(this._element)&&this.next()}prev(){this._slide(hi)}pause(){this._isSliding&&o(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?j.one(this._element,jt,()=>this.cycle()):this.cycle())}to(F){const X=this._getItems();if(F>X.length-1||F<0)return;if(this._isSliding)return void j.one(this._element,jt,()=>this.to(F));const ae=this._getItemIndex(this._getActive());if(ae===F)return;const Te=F>ae?dt:hi;this._slide(Te,X[F])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(F){return F.defaultInterval=F.interval,F}_addEventListeners(){this._config.keyboard&&j.on(this._element,Tt,F=>this._keydown(F)),this._config.pause==="hover"&&(j.on(this._element,Ii,()=>this.pause()),j.on(this._element,di,()=>this._maybeEnableCycle())),this._config.touch&&et.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const X of Ee.find(".carousel-item img",this._element))j.on(X,ms,ae=>ae.preventDefault());const F={leftCallback:()=>this._slide(this._directionToOrder(ct)),rightCallback:()=>this._slide(this._directionToOrder(xt)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}};this._swipeHelper=new et(this._element,F)}_keydown(F){if(/input|textarea/i.test(F.target.tagName))return;const X=hn[F.key];X&&(F.preventDefault(),this._slide(this._directionToOrder(X)))}_getItemIndex(F){return this._getItems().indexOf(F)}_setActiveIndicatorElement(F){if(!this._indicatorsElement)return;const X=Ee.findOne(Rt,this._indicatorsElement);X.classList.remove(ot),X.removeAttribute("aria-current");const ae=Ee.findOne(`[data-bs-slide-to="${F}"]`,this._indicatorsElement);ae&&(ae.classList.add(ot),ae.setAttribute("aria-current","true"))}_updateInterval(){const F=this._activeElement||this._getActive();if(!F)return;const X=Number.parseInt(F.getAttribute("data-bs-interval"),10);this._config.interval=X||this._config.defaultInterval}_slide(F,X=null){if(this._isSliding)return;const ae=this._getActive(),Te=F===dt,Pe=X||C(this._getItems(),ae,Te,this._config.wrap);if(Pe===ae)return;const Ke=this._getItemIndex(Pe),lt=Ot=>j.trigger(this._element,Ot,{relatedTarget:Pe,direction:this._orderToDirection(F),from:this._getItemIndex(ae),to:Ke});if(lt(li).defaultPrevented||!ae||!Pe)return;const vt=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(Ke),this._activeElement=Pe;const Ft=Te?"carousel-item-start":"carousel-item-end",Ht=Te?"carousel-item-next":"carousel-item-prev";Pe.classList.add(Ht),m(Pe),ae.classList.add(Ft),Pe.classList.add(Ft),this._queueCallback(()=>{Pe.classList.remove(Ft,Ht),Pe.classList.add(ot),ae.classList.remove(ot,Ht,Ft),this._isSliding=!1,lt(jt)},ae,this._isAnimated()),vt&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return Ee.findOne(qi,this._element)}_getItems(){return Ee.find(It,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(F){return v()?F===ct?hi:dt:F===ct?dt:hi}_orderToDirection(F){return v()?F===hi?ct:xt:F===hi?xt:ct}static jQueryInterface(F){return this.each(function(){const X=Le.getOrCreateInstance(this,F);if(typeof F!="number"){if(typeof F=="string"){if(X[F]===void 0||F.startsWith("_")||F==="constructor")throw new TypeError(`No method named "${F}"`);X[F]()}}else X.to(F)})}}j.on(document,Dt,"[data-bs-slide], [data-bs-slide-to]",function(Q){const F=Ee.getElementFromSelector(this);if(!F||!F.classList.contains(Qe))return;Q.preventDefault();const X=Le.getOrCreateInstance(F),ae=this.getAttribute("data-bs-slide-to");return ae?(X.to(ae),void X._maybeEnableCycle()):de.getDataAttribute(this,"slide")==="next"?(X.next(),void X._maybeEnableCycle()):(X.prev(),void X._maybeEnableCycle())}),j.on(window,we,()=>{const Q=Ee.find('[data-bs-ride="carousel"]');for(const F of Q)Le.getOrCreateInstance(F)}),x(Le);const Ui=".bs.collapse",Sn=`show${Ui}`,Js=`shown${Ui}`,Br=`hide${Ui}`,Bt=`hidden${Ui}`,ch=`click${Ui}.data-api`,Rn="show",Qr="collapse",dl="collapsing",Jr=`:scope .${Qr} .${Qr}`,La='[data-bs-toggle="collapse"]',Bl={parent:null,toggle:!0},wi={parent:"(null|element)",toggle:"boolean"};class ha extends Ne{constructor(F,X){super(F,X),this._isTransitioning=!1,this._triggerArray=[];const ae=Ee.find(La);for(const Te of ae){const Pe=Ee.getSelectorFromElement(Te),Ke=Ee.find(Pe).filter(lt=>lt===this._element);Pe!==null&&Ke.length&&this._triggerArray.push(Te)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Bl}static get DefaultType(){return wi}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let F=[];if(this._config.parent&&(F=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(Te=>Te!==this._element).map(Te=>ha.getOrCreateInstance(Te,{toggle:!1}))),F.length&&F[0]._isTransitioning||j.trigger(this._element,Sn).defaultPrevented)return;for(const Te of F)Te.hide();const X=this._getDimension();this._element.classList.remove(Qr),this._element.classList.add(dl),this._element.style[X]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const ae=`scroll${X[0].toUpperCase()+X.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(dl),this._element.classList.add(Qr,Rn),this._element.style[X]="",j.trigger(this._element,Js)},this._element,!0),this._element.style[X]=`${this._element[ae]}px`}hide(){if(this._isTransitioning||!this._isShown()||j.trigger(this._element,Br).defaultPrevented)return;const F=this._getDimension();this._element.style[F]=`${this._element.getBoundingClientRect()[F]}px`,m(this._element),this._element.classList.add(dl),this._element.classList.remove(Qr,Rn);for(const X of this._triggerArray){const ae=Ee.getElementFromSelector(X);ae&&!this._isShown(ae)&&this._addAriaAndCollapsedClass([X],!1)}this._isTransitioning=!0,this._element.style[F]="",this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(dl),this._element.classList.add(Qr),j.trigger(this._element,Bt)},this._element,!0)}_isShown(F=this._element){return F.classList.contains(Rn)}_configAfterMerge(F){return F.toggle=!!F.toggle,F.parent=l(F.parent),F}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const F=this._getFirstLevelChildren(La);for(const X of F){const ae=Ee.getElementFromSelector(X);ae&&this._addAriaAndCollapsedClass([X],this._isShown(ae))}}_getFirstLevelChildren(F){const X=Ee.find(Jr,this._config.parent);return Ee.find(F,this._config.parent).filter(ae=>!X.includes(ae))}_addAriaAndCollapsedClass(F,X){if(F.length)for(const ae of F)ae.classList.toggle("collapsed",!X),ae.setAttribute("aria-expanded",X)}static jQueryInterface(F){const X={};return typeof F=="string"&&/show|hide/.test(F)&&(X.toggle=!1),this.each(function(){const ae=ha.getOrCreateInstance(this,X);if(typeof F=="string"){if(ae[F]===void 0)throw new TypeError(`No method named "${F}"`);ae[F]()}})}}j.on(document,ch,La,function(Q){(Q.target.tagName==="A"||Q.delegateTarget&&Q.delegateTarget.tagName==="A")&&Q.preventDefault();for(const F of Ee.getMultipleElementsFromSelector(this))ha.getOrCreateInstance(F,{toggle:!1}).toggle()}),x(ha);var ys="top",eo="bottom",to="right",_n="left",re="auto",Ce=[ys,eo,to,_n],Oe="start",Be="end",Ae="clippingParents",ft="viewport",St="popper",At="reference",zt=Ce.reduce(function(Q,F){return Q.concat([F+"-"+Oe,F+"-"+Be])},[]),Ti=[].concat(Ce,[re]).reduce(function(Q,F){return Q.concat([F,F+"-"+Oe,F+"-"+Be])},[]),Yt="beforeRead",ci="read",os="afterRead",ue="beforeMain",He="main",Je="afterMain",bt="beforeWrite",Pt="write",Hi="afterWrite",xi=[Yt,ci,os,ue,He,Je,bt,Pt,Hi];function as(Q){return Q?(Q.nodeName||"").toLowerCase():null}function Ir(Q){if(Q==null)return window;if(Q.toString()!=="[object Window]"){var F=Q.ownerDocument;return F&&F.defaultView||window}return Q}function Fs(Q){return Q instanceof Ir(Q).Element||Q instanceof Element}function Dr(Q){return Q instanceof Ir(Q).HTMLElement||Q instanceof HTMLElement}function en(Q){return typeof ShadowRoot<"u"&&(Q instanceof Ir(Q).ShadowRoot||Q instanceof ShadowRoot)}const io={name:"applyStyles",enabled:!0,phase:"write",fn:function(Q){var F=Q.state;Object.keys(F.elements).forEach(function(X){var ae=F.styles[X]||{},Te=F.attributes[X]||{},Pe=F.elements[X];Dr(Pe)&&as(Pe)&&(Object.assign(Pe.style,ae),Object.keys(Te).forEach(function(Ke){var lt=Te[Ke];lt===!1?Pe.removeAttribute(Ke):Pe.setAttribute(Ke,lt===!0?"":lt)}))})},effect:function(Q){var F=Q.state,X={popper:{position:F.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(F.elements.popper.style,X.popper),F.styles=X,F.elements.arrow&&Object.assign(F.elements.arrow.style,X.arrow),function(){Object.keys(F.elements).forEach(function(ae){var Te=F.elements[ae],Pe=F.attributes[ae]||{},Ke=Object.keys(F.styles.hasOwnProperty(ae)?F.styles[ae]:X[ae]).reduce(function(lt,vt){return lt[vt]="",lt},{});Dr(Te)&&as(Te)&&(Object.assign(Te.style,Ke),Object.keys(Pe).forEach(function(lt){Te.removeAttribute(lt)}))})}},requires:["computeStyles"]};function dn(Q){return Q.split("-")[0]}var Gn=Math.max,Nr=Math.min,da=Math.round;function Nu(){var Q=navigator.userAgentData;return Q!=null&&Q.brands&&Array.isArray(Q.brands)?Q.brands.map(function(F){return F.brand+"/"+F.version}).join(" "):navigator.userAgent}function mE(){return!/^((?!chrome|android).)*safari/i.test(Nu())}function Wm(Q,F,X){F===void 0&&(F=!1),X===void 0&&(X=!1);var ae=Q.getBoundingClientRect(),Te=1,Pe=1;F&&Dr(Q)&&(Te=Q.offsetWidth>0&&da(ae.width)/Q.offsetWidth||1,Pe=Q.offsetHeight>0&&da(ae.height)/Q.offsetHeight||1);var Ke=(Fs(Q)?Ir(Q):window).visualViewport,lt=!mE()&&X,vt=(ae.left+(lt&&Ke?Ke.offsetLeft:0))/Te,Ft=(ae.top+(lt&&Ke?Ke.offsetTop:0))/Pe,Ht=ae.width/Te,Ot=ae.height/Pe;return{width:Ht,height:Ot,top:Ft,right:vt+Ht,bottom:Ft+Ot,left:vt,x:vt,y:Ft}}function Xy(Q){var F=Wm(Q),X=Q.offsetWidth,ae=Q.offsetHeight;return Math.abs(F.width-X)<=1&&(X=F.width),Math.abs(F.height-ae)<=1&&(ae=F.height),{x:Q.offsetLeft,y:Q.offsetTop,width:X,height:ae}}function RA(Q,F){var X=F.getRootNode&&F.getRootNode();if(Q.contains(F))return!0;if(X&&en(X)){var ae=F;do{if(ae&&Q.isSameNode(ae))return!0;ae=ae.parentNode||ae.host}while(ae)}return!1}function hh(Q){return Ir(Q).getComputedStyle(Q)}function W1(Q){return["table","td","th"].indexOf(as(Q))>=0}function _c(Q){return((Fs(Q)?Q.ownerDocument:Q.document)||window.document).documentElement}function Jf(Q){return as(Q)==="html"?Q:Q.assignedSlot||Q.parentNode||(en(Q)?Q.host:null)||_c(Q)}function Zm(Q){return Dr(Q)&&hh(Q).position!=="fixed"?Q.offsetParent:null}function yc(Q){for(var F=Ir(Q),X=Zm(Q);X&&W1(X)&&hh(X).position==="static";)X=Zm(X);return X&&(as(X)==="html"||as(X)==="body"&&hh(X).position==="static")?F:X||function(ae){var Te=/firefox/i.test(Nu());if(/Trident/i.test(Nu())&&Dr(ae)&&hh(ae).position==="fixed")return null;var Pe=Jf(ae);for(en(Pe)&&(Pe=Pe.host);Dr(Pe)&&["html","body"].indexOf(as(Pe))<0;){var Ke=hh(Pe);if(Ke.transform!=="none"||Ke.perspective!=="none"||Ke.contain==="paint"||["transform","perspective"].indexOf(Ke.willChange)!==-1||Te&&Ke.willChange==="filter"||Te&&Ke.filter&&Ke.filter!=="none")return Pe;Pe=Pe.parentNode}return null}(Q)||F}function Z1(Q){return["top","bottom"].indexOf(Q)>=0?"x":"y"}function Km(Q,F,X){return Gn(Q,Nr(F,X))}function pE(Q){return Object.assign({},{top:0,right:0,bottom:0,left:0},Q)}function eg(Q,F){return F.reduce(function(X,ae){return X[ae]=Q,X},{})}const vc={name:"arrow",enabled:!0,phase:"main",fn:function(Q){var F,X=Q.state,ae=Q.name,Te=Q.options,Pe=X.elements.arrow,Ke=X.modifiersData.popperOffsets,lt=dn(X.placement),vt=Z1(lt),Ft=[_n,to].indexOf(lt)>=0?"height":"width";if(Pe&&Ke){var Ht=function(yi,Li){return pE(typeof(yi=typeof yi=="function"?yi(Object.assign({},Li.rects,{placement:Li.placement})):yi)!="number"?yi:eg(yi,Ce))}(Te.padding,X),Ot=Xy(Pe),ts=vt==="y"?ys:_n,Si=vt==="y"?eo:to,Oi=X.rects.reference[Ft]+X.rects.reference[vt]-Ke[vt]-X.rects.popper[Ft],Vi=Ke[vt]-X.rects.reference[vt],Xi=yc(Pe),Ds=Xi?vt==="y"?Xi.clientHeight||0:Xi.clientWidth||0:0,tn=Oi/2-Vi/2,ls=Ht[ts],Ns=Ds-Ot[Ft]-Ht[Si],is=Ds/2-Ot[Ft]/2+tn,ss=Km(ls,is,Ns),Xt=vt;X.modifiersData[ae]=((F={})[Xt]=ss,F.centerOffset=ss-is,F)}},effect:function(Q){var F=Q.state,X=Q.options.element,ae=X===void 0?"[data-popper-arrow]":X;ae!=null&&(typeof ae!="string"||(ae=F.elements.popper.querySelector(ae)))&&RA(F.elements.popper,ae)&&(F.elements.arrow=ae)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Ad(Q){return Q.split("-")[1]}var Wy={top:"auto",right:"auto",bottom:"auto",left:"auto"};function dh(Q){var F,X=Q.popper,ae=Q.popperRect,Te=Q.placement,Pe=Q.variation,Ke=Q.offsets,lt=Q.position,vt=Q.gpuAcceleration,Ft=Q.adaptive,Ht=Q.roundOffsets,Ot=Q.isFixed,ts=Ke.x,Si=ts===void 0?0:ts,Oi=Ke.y,Vi=Oi===void 0?0:Oi,Xi=typeof Ht=="function"?Ht({x:Si,y:Vi}):{x:Si,y:Vi};Si=Xi.x,Vi=Xi.y;var Ds=Ke.hasOwnProperty("x"),tn=Ke.hasOwnProperty("y"),ls=_n,Ns=ys,is=window;if(Ft){var ss=yc(X),Xt="clientHeight",yi="clientWidth";ss===Ir(X)&&hh(ss=_c(X)).position!=="static"&&lt==="absolute"&&(Xt="scrollHeight",yi="scrollWidth"),(Te===ys||(Te===_n||Te===to)&&Pe===Be)&&(Ns=eo,Vi-=(Ot&&ss===is&&is.visualViewport?is.visualViewport.height:ss[Xt])-ae.height,Vi*=vt?1:-1),Te!==_n&&(Te!==ys&&Te!==eo||Pe!==Be)||(ls=to,Si-=(Ot&&ss===is&&is.visualViewport?is.visualViewport.width:ss[yi])-ae.width,Si*=vt?1:-1)}var Li,Bn=Object.assign({position:lt},Ft&&Wy),no=Ht===!0?function(wo,ro){var Go=wo.x,So=wo.y,lr=ro.devicePixelRatio||1;return{x:da(Go*lr)/lr||0,y:da(So*lr)/lr||0}}({x:Si,y:Vi},Ir(X)):{x:Si,y:Vi};return Si=no.x,Vi=no.y,vt?Object.assign({},Bn,((Li={})[Ns]=tn?"0":"",Li[ls]=Ds?"0":"",Li.transform=(is.devicePixelRatio||1)<=1?"translate("+Si+"px, "+Vi+"px)":"translate3d("+Si+"px, "+Vi+"px, 0)",Li)):Object.assign({},Bn,((F={})[Ns]=tn?Vi+"px":"",F[ls]=Ds?Si+"px":"",F.transform="",F))}const Zy={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(Q){var F=Q.state,X=Q.options,ae=X.gpuAcceleration,Te=ae===void 0||ae,Pe=X.adaptive,Ke=Pe===void 0||Pe,lt=X.roundOffsets,vt=lt===void 0||lt,Ft={placement:dn(F.placement),variation:Ad(F.placement),popper:F.elements.popper,popperRect:F.rects.popper,gpuAcceleration:Te,isFixed:F.options.strategy==="fixed"};F.modifiersData.popperOffsets!=null&&(F.styles.popper=Object.assign({},F.styles.popper,dh(Object.assign({},Ft,{offsets:F.modifiersData.popperOffsets,position:F.options.strategy,adaptive:Ke,roundOffsets:vt})))),F.modifiersData.arrow!=null&&(F.styles.arrow=Object.assign({},F.styles.arrow,dh(Object.assign({},Ft,{offsets:F.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:vt})))),F.attributes.popper=Object.assign({},F.attributes.popper,{"data-popper-placement":F.placement})},data:{}};var Qm={passive:!0};const K1={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(Q){var F=Q.state,X=Q.instance,ae=Q.options,Te=ae.scroll,Pe=Te===void 0||Te,Ke=ae.resize,lt=Ke===void 0||Ke,vt=Ir(F.elements.popper),Ft=[].concat(F.scrollParents.reference,F.scrollParents.popper);return Pe&&Ft.forEach(function(Ht){Ht.addEventListener("scroll",X.update,Qm)}),lt&&vt.addEventListener("resize",X.update,Qm),function(){Pe&&Ft.forEach(function(Ht){Ht.removeEventListener("scroll",X.update,Qm)}),lt&&vt.removeEventListener("resize",X.update,Qm)}},data:{}};var Q1={left:"right",right:"left",bottom:"top",top:"bottom"};function Jm(Q){return Q.replace(/left|right|bottom|top/g,function(F){return Q1[F]})}var OA={start:"end",end:"start"};function ma(Q){return Q.replace(/start|end/g,function(F){return OA[F]})}function mh(Q){var F=Ir(Q);return{scrollLeft:F.pageXOffset,scrollTop:F.pageYOffset}}function tg(Q){return Wm(_c(Q)).left+mh(Q).scrollLeft}function ep(Q){var F=hh(Q),X=F.overflow,ae=F.overflowX,Te=F.overflowY;return/auto|scroll|overlay|hidden/.test(X+Te+ae)}function LA(Q){return["html","body","#document"].indexOf(as(Q))>=0?Q.ownerDocument.body:Dr(Q)&&ep(Q)?Q:LA(Jf(Q))}function tp(Q,F){var X;F===void 0&&(F=[]);var ae=LA(Q),Te=ae===((X=Q.ownerDocument)==null?void 0:X.body),Pe=Ir(ae),Ke=Te?[Pe].concat(Pe.visualViewport||[],ep(ae)?ae:[]):ae,lt=F.concat(Ke);return Te?lt:lt.concat(tp(Jf(Ke)))}function Ky(Q){return Object.assign({},Q,{left:Q.x,top:Q.y,right:Q.x+Q.width,bottom:Q.y+Q.height})}function ig(Q,F,X){return F===ft?Ky(function(ae,Te){var Pe=Ir(ae),Ke=_c(ae),lt=Pe.visualViewport,vt=Ke.clientWidth,Ft=Ke.clientHeight,Ht=0,Ot=0;if(lt){vt=lt.width,Ft=lt.height;var ts=mE();(ts||!ts&&Te==="fixed")&&(Ht=lt.offsetLeft,Ot=lt.offsetTop)}return{width:vt,height:Ft,x:Ht+tg(ae),y:Ot}}(Q,X)):Fs(F)?function(ae,Te){var Pe=Wm(ae,!1,Te==="fixed");return Pe.top=Pe.top+ae.clientTop,Pe.left=Pe.left+ae.clientLeft,Pe.bottom=Pe.top+ae.clientHeight,Pe.right=Pe.left+ae.clientWidth,Pe.width=ae.clientWidth,Pe.height=ae.clientHeight,Pe.x=Pe.left,Pe.y=Pe.top,Pe}(F,X):Ky(function(ae){var Te,Pe=_c(ae),Ke=mh(ae),lt=(Te=ae.ownerDocument)==null?void 0:Te.body,vt=Gn(Pe.scrollWidth,Pe.clientWidth,lt?lt.scrollWidth:0,lt?lt.clientWidth:0),Ft=Gn(Pe.scrollHeight,Pe.clientHeight,lt?lt.scrollHeight:0,lt?lt.clientHeight:0),Ht=-Ke.scrollLeft+tg(ae),Ot=-Ke.scrollTop;return hh(lt||Pe).direction==="rtl"&&(Ht+=Gn(Pe.clientWidth,lt?lt.clientWidth:0)-vt),{width:vt,height:Ft,x:Ht,y:Ot}}(_c(Q)))}function Qy(Q){var F,X=Q.reference,ae=Q.element,Te=Q.placement,Pe=Te?dn(Te):null,Ke=Te?Ad(Te):null,lt=X.x+X.width/2-ae.width/2,vt=X.y+X.height/2-ae.height/2;switch(Pe){case ys:F={x:lt,y:X.y-ae.height};break;case eo:F={x:lt,y:X.y+X.height};break;case to:F={x:X.x+X.width,y:vt};break;case _n:F={x:X.x-ae.width,y:vt};break;default:F={x:X.x,y:X.y}}var Ft=Pe?Z1(Pe):null;if(Ft!=null){var Ht=Ft==="y"?"height":"width";switch(Ke){case Oe:F[Ft]=F[Ft]-(X[Ht]/2-ae[Ht]/2);break;case Be:F[Ft]=F[Ft]+(X[Ht]/2-ae[Ht]/2)}}return F}function ip(Q,F){F===void 0&&(F={});var X=F,ae=X.placement,Te=ae===void 0?Q.placement:ae,Pe=X.strategy,Ke=Pe===void 0?Q.strategy:Pe,lt=X.boundary,vt=lt===void 0?Ae:lt,Ft=X.rootBoundary,Ht=Ft===void 0?ft:Ft,Ot=X.elementContext,ts=Ot===void 0?St:Ot,Si=X.altBoundary,Oi=Si!==void 0&&Si,Vi=X.padding,Xi=Vi===void 0?0:Vi,Ds=pE(typeof Xi!="number"?Xi:eg(Xi,Ce)),tn=ts===St?At:St,ls=Q.rects.popper,Ns=Q.elements[Oi?tn:ts],is=function(ro,Go,So,lr){var js=Go==="clippingParents"?function(mn){var ga=tp(Jf(mn)),$a=["absolute","fixed"].indexOf(hh(mn).position)>=0&&Dr(mn)?yc(mn):mn;return Fs($a)?ga.filter(function(wc){return Fs(wc)&&RA(wc,$a)&&as(wc)!=="body"}):[]}(ro):[].concat(Go),Yl=[].concat(js,[So]),Vd=Yl[0],qr=Yl.reduce(function(mn,ga){var $a=ig(ro,ga,lr);return mn.top=Gn($a.top,mn.top),mn.right=Nr($a.right,mn.right),mn.bottom=Nr($a.bottom,mn.bottom),mn.left=Gn($a.left,mn.left),mn},ig(ro,Vd,lr));return qr.width=qr.right-qr.left,qr.height=qr.bottom-qr.top,qr.x=qr.left,qr.y=qr.top,qr}(Fs(Ns)?Ns:Ns.contextElement||_c(Q.elements.popper),vt,Ht,Ke),ss=Wm(Q.elements.reference),Xt=Qy({reference:ss,element:ls,placement:Te}),yi=Ky(Object.assign({},ls,Xt)),Li=ts===St?yi:ss,Bn={top:is.top-Li.top+Ds.top,bottom:Li.bottom-is.bottom+Ds.bottom,left:is.left-Li.left+Ds.left,right:Li.right-is.right+Ds.right},no=Q.modifiersData.offset;if(ts===St&&no){var wo=no[Te];Object.keys(Bn).forEach(function(ro){var Go=[to,eo].indexOf(ro)>=0?1:-1,So=[ys,eo].indexOf(ro)>=0?"y":"x";Bn[ro]+=wo[So]*Go})}return Bn}function Sk(Q,F){F===void 0&&(F={});var X=F,ae=X.placement,Te=X.boundary,Pe=X.rootBoundary,Ke=X.padding,lt=X.flipVariations,vt=X.allowedAutoPlacements,Ft=vt===void 0?Ti:vt,Ht=Ad(ae),Ot=Ht?lt?zt:zt.filter(function(Oi){return Ad(Oi)===Ht}):Ce,ts=Ot.filter(function(Oi){return Ft.indexOf(Oi)>=0});ts.length===0&&(ts=Ot);var Si=ts.reduce(function(Oi,Vi){return Oi[Vi]=ip(Q,{placement:Vi,boundary:Te,rootBoundary:Pe,padding:Ke})[dn(Vi)],Oi},{});return Object.keys(Si).sort(function(Oi,Vi){return Si[Oi]-Si[Vi]})}const FA={name:"flip",enabled:!0,phase:"main",fn:function(Q){var F=Q.state,X=Q.options,ae=Q.name;if(!F.modifiersData[ae]._skip){for(var Te=X.mainAxis,Pe=Te===void 0||Te,Ke=X.altAxis,lt=Ke===void 0||Ke,vt=X.fallbackPlacements,Ft=X.padding,Ht=X.boundary,Ot=X.rootBoundary,ts=X.altBoundary,Si=X.flipVariations,Oi=Si===void 0||Si,Vi=X.allowedAutoPlacements,Xi=F.options.placement,Ds=dn(Xi),tn=vt||(Ds!==Xi&&Oi?function(mn){if(dn(mn)===re)return[];var ga=Jm(mn);return[ma(mn),ga,ma(ga)]}(Xi):[Jm(Xi)]),ls=[Xi].concat(tn).reduce(function(mn,ga){return mn.concat(dn(ga)===re?Sk(F,{placement:ga,boundary:Ht,rootBoundary:Ot,padding:Ft,flipVariations:Oi,allowedAutoPlacements:Vi}):ga)},[]),Ns=F.rects.reference,is=F.rects.popper,ss=new Map,Xt=!0,yi=ls[0],Li=0;Li<ls.length;Li++){var Bn=ls[Li],no=dn(Bn),wo=Ad(Bn)===Oe,ro=[ys,eo].indexOf(no)>=0,Go=ro?"width":"height",So=ip(F,{placement:Bn,boundary:Ht,rootBoundary:Ot,altBoundary:ts,padding:Ft}),lr=ro?wo?to:_n:wo?eo:ys;Ns[Go]>is[Go]&&(lr=Jm(lr));var js=Jm(lr),Yl=[];if(Pe&&Yl.push(So[no]<=0),lt&&Yl.push(So[lr]<=0,So[js]<=0),Yl.every(function(mn){return mn})){yi=Bn,Xt=!1;break}ss.set(Bn,Yl)}if(Xt)for(var Vd=function(mn){var ga=ls.find(function($a){var wc=ss.get($a);if(wc)return wc.slice(0,mn).every(function(gg){return gg})});if(ga)return yi=ga,"break"},qr=Oi?3:1;qr>0&&Vd(qr)!=="break";qr--);F.placement!==yi&&(F.modifiersData[ae]._skip=!0,F.placement=yi,F.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function kA(Q,F,X){return X===void 0&&(X={x:0,y:0}),{top:Q.top-F.height-X.y,right:Q.right-F.width+X.x,bottom:Q.bottom-F.height+X.y,left:Q.left-F.width-X.x}}function J1(Q){return[ys,to,eo,_n].some(function(F){return Q[F]>=0})}const $A={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(Q){var F=Q.state,X=Q.name,ae=F.rects.reference,Te=F.rects.popper,Pe=F.modifiersData.preventOverflow,Ke=ip(F,{elementContext:"reference"}),lt=ip(F,{altBoundary:!0}),vt=kA(Ke,ae),Ft=kA(lt,Te,Pe),Ht=J1(vt),Ot=J1(Ft);F.modifiersData[X]={referenceClippingOffsets:vt,popperEscapeOffsets:Ft,isReferenceHidden:Ht,hasPopperEscaped:Ot},F.attributes.popper=Object.assign({},F.attributes.popper,{"data-popper-reference-hidden":Ht,"data-popper-escaped":Ot})}},UA={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(Q){var F=Q.state,X=Q.options,ae=Q.name,Te=X.offset,Pe=Te===void 0?[0,0]:Te,Ke=Ti.reduce(function(Ht,Ot){return Ht[Ot]=function(ts,Si,Oi){var Vi=dn(ts),Xi=[_n,ys].indexOf(Vi)>=0?-1:1,Ds=typeof Oi=="function"?Oi(Object.assign({},Si,{placement:ts})):Oi,tn=Ds[0],ls=Ds[1];return tn=tn||0,ls=(ls||0)*Xi,[_n,to].indexOf(Vi)>=0?{x:ls,y:tn}:{x:tn,y:ls}}(Ot,F.rects,Pe),Ht},{}),lt=Ke[F.placement],vt=lt.x,Ft=lt.y;F.modifiersData.popperOffsets!=null&&(F.modifiersData.popperOffsets.x+=vt,F.modifiersData.popperOffsets.y+=Ft),F.modifiersData[ae]=Ke}},fE={name:"popperOffsets",enabled:!0,phase:"read",fn:function(Q){var F=Q.state,X=Q.name;F.modifiersData[X]=Qy({reference:F.rects.reference,element:F.rects.popper,placement:F.placement})},data:{}},VA={name:"preventOverflow",enabled:!0,phase:"main",fn:function(Q){var F=Q.state,X=Q.options,ae=Q.name,Te=X.mainAxis,Pe=Te===void 0||Te,Ke=X.altAxis,lt=Ke!==void 0&&Ke,vt=X.boundary,Ft=X.rootBoundary,Ht=X.altBoundary,Ot=X.padding,ts=X.tether,Si=ts===void 0||ts,Oi=X.tetherOffset,Vi=Oi===void 0?0:Oi,Xi=ip(F,{boundary:vt,rootBoundary:Ft,padding:Ot,altBoundary:Ht}),Ds=dn(F.placement),tn=Ad(F.placement),ls=!tn,Ns=Z1(Ds),is=Ns==="x"?"y":"x",ss=F.modifiersData.popperOffsets,Xt=F.rects.reference,yi=F.rects.popper,Li=typeof Vi=="function"?Vi(Object.assign({},F.rects,{placement:F.placement})):Vi,Bn=typeof Li=="number"?{mainAxis:Li,altAxis:Li}:Object.assign({mainAxis:0,altAxis:0},Li),no=F.modifiersData.offset?F.modifiersData.offset[F.placement]:null,wo={x:0,y:0};if(ss){if(Pe){var ro,Go=Ns==="y"?ys:_n,So=Ns==="y"?eo:to,lr=Ns==="y"?"height":"width",js=ss[Ns],Yl=js+Xi[Go],Vd=js-Xi[So],qr=Si?-yi[lr]/2:0,mn=tn===Oe?Xt[lr]:yi[lr],ga=tn===Oe?-yi[lr]:-Xt[lr],$a=F.elements.arrow,wc=Si&&$a?Xy($a):{width:0,height:0},gg=F.modifiersData["arrow#persistent"]?F.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},_a=gg[Go],wr=gg[So],_g=Km(0,Xt[lr],wc[lr]),l0=ls?Xt[lr]/2-qr-_g-_a-Bn.mainAxis:mn-_g-_a-Bn.mainAxis,dx=ls?-Xt[lr]/2+qr+_g+wr+Bn.mainAxis:ga+_g+wr+Bn.mainAxis,u0=F.elements.arrow&&yc(F.elements.arrow),bh=u0?Ns==="y"?u0.clientTop||0:u0.clientLeft||0:0,c0=(ro=no==null?void 0:no[Ns])!=null?ro:0,BE=js+dx-c0,mx=Km(Si?Nr(Yl,js+l0-c0-bh):Yl,js,Si?Gn(Vd,BE):Vd);ss[Ns]=mx,wo[Ns]=mx-js}if(lt){var qE,wI=Ns==="x"?ys:_n,SI=Ns==="x"?eo:to,zd=ss[is],h0=is==="y"?"height":"width",HE=zd+Xi[wI],px=zd-Xi[SI],fx=[ys,_n].indexOf(Ds)!==-1,EI=(qE=no==null?void 0:no[is])!=null?qE:0,jE=fx?HE:zd-Xt[h0]-yi[h0]-EI+Bn.altAxis,YE=fx?zd+Xt[h0]+yi[h0]-EI-Bn.altAxis:px,XE=Si&&fx?function(WE,CI,gx){var ZE=Km(WE,CI,gx);return ZE>gx?gx:ZE}(jE,zd,YE):Km(Si?jE:HE,zd,Si?YE:px);ss[is]=XE,wo[is]=XE-zd}F.modifiersData[ae]=wo}},requiresIfExists:["offset"]};function Ek(Q,F,X){X===void 0&&(X=!1);var ae,Te,Pe=Dr(F),Ke=Dr(F)&&function(Ot){var ts=Ot.getBoundingClientRect(),Si=da(ts.width)/Ot.offsetWidth||1,Oi=da(ts.height)/Ot.offsetHeight||1;return Si!==1||Oi!==1}(F),lt=_c(F),vt=Wm(Q,Ke,X),Ft={scrollLeft:0,scrollTop:0},Ht={x:0,y:0};return(Pe||!Pe&&!X)&&((as(F)!=="body"||ep(lt))&&(Ft=(ae=F)!==Ir(ae)&&Dr(ae)?{scrollLeft:(Te=ae).scrollLeft,scrollTop:Te.scrollTop}:mh(ae)),Dr(F)?((Ht=Wm(F,!0)).x+=F.clientLeft,Ht.y+=F.clientTop):lt&&(Ht.x=tg(lt))),{x:vt.left+Ft.scrollLeft-Ht.x,y:vt.top+Ft.scrollTop-Ht.y,width:vt.width,height:vt.height}}function zA(Q){var F=new Map,X=new Set,ae=[];function Te(Pe){X.add(Pe.name),[].concat(Pe.requires||[],Pe.requiresIfExists||[]).forEach(function(Ke){if(!X.has(Ke)){var lt=F.get(Ke);lt&&Te(lt)}}),ae.push(Pe)}return Q.forEach(function(Pe){F.set(Pe.name,Pe)}),Q.forEach(function(Pe){X.has(Pe.name)||Te(Pe)}),ae}var GA={placement:"bottom",modifiers:[],strategy:"absolute"};function BA(){for(var Q=arguments.length,F=new Array(Q),X=0;X<Q;X++)F[X]=arguments[X];return!F.some(function(ae){return!(ae&&typeof ae.getBoundingClientRect=="function")})}function ex(Q){Q===void 0&&(Q={});var F=Q,X=F.defaultModifiers,ae=X===void 0?[]:X,Te=F.defaultOptions,Pe=Te===void 0?GA:Te;return function(Ke,lt,vt){vt===void 0&&(vt=Pe);var Ft,Ht,Ot={placement:"bottom",orderedModifiers:[],options:Object.assign({},GA,Pe),modifiersData:{},elements:{reference:Ke,popper:lt},attributes:{},styles:{}},ts=[],Si=!1,Oi={state:Ot,setOptions:function(Xi){var Ds=typeof Xi=="function"?Xi(Ot.options):Xi;Vi(),Ot.options=Object.assign({},Pe,Ot.options,Ds),Ot.scrollParents={reference:Fs(Ke)?tp(Ke):Ke.contextElement?tp(Ke.contextElement):[],popper:tp(lt)};var tn,ls,Ns=function(is){var ss=zA(is);return xi.reduce(function(Xt,yi){return Xt.concat(ss.filter(function(Li){return Li.phase===yi}))},[])}((tn=[].concat(ae,Ot.options.modifiers),ls=tn.reduce(function(is,ss){var Xt=is[ss.name];return is[ss.name]=Xt?Object.assign({},Xt,ss,{options:Object.assign({},Xt.options,ss.options),data:Object.assign({},Xt.data,ss.data)}):ss,is},{}),Object.keys(ls).map(function(is){return ls[is]})));return Ot.orderedModifiers=Ns.filter(function(is){return is.enabled}),Ot.orderedModifiers.forEach(function(is){var ss=is.name,Xt=is.options,yi=Xt===void 0?{}:Xt,Li=is.effect;if(typeof Li=="function"){var Bn=Li({state:Ot,name:ss,instance:Oi,options:yi});ts.push(Bn||function(){})}}),Oi.update()},forceUpdate:function(){if(!Si){var Xi=Ot.elements,Ds=Xi.reference,tn=Xi.popper;if(BA(Ds,tn)){Ot.rects={reference:Ek(Ds,yc(tn),Ot.options.strategy==="fixed"),popper:Xy(tn)},Ot.reset=!1,Ot.placement=Ot.options.placement,Ot.orderedModifiers.forEach(function(Li){return Ot.modifiersData[Li.name]=Object.assign({},Li.data)});for(var ls=0;ls<Ot.orderedModifiers.length;ls++)if(Ot.reset!==!0){var Ns=Ot.orderedModifiers[ls],is=Ns.fn,ss=Ns.options,Xt=ss===void 0?{}:ss,yi=Ns.name;typeof is=="function"&&(Ot=is({state:Ot,options:Xt,name:yi,instance:Oi})||Ot)}else Ot.reset=!1,ls=-1}}},update:(Ft=function(){return new Promise(function(Xi){Oi.forceUpdate(),Xi(Ot)})},function(){return Ht||(Ht=new Promise(function(Xi){Promise.resolve().then(function(){Ht=void 0,Xi(Ft())})})),Ht}),destroy:function(){Vi(),Si=!0}};if(!BA(Ke,lt))return Oi;function Vi(){ts.forEach(function(Xi){return Xi()}),ts=[]}return Oi.setOptions(vt).then(function(Xi){!Si&&vt.onFirstUpdate&&vt.onFirstUpdate(Xi)}),Oi}}var Ck=ex(),gE=ex({defaultModifiers:[K1,fE,Zy,io]}),_E=ex({defaultModifiers:[K1,fE,Zy,io,UA,FA,VA,vc,$A]});const qA=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Je,afterRead:os,afterWrite:Hi,applyStyles:io,arrow:vc,auto:re,basePlacements:Ce,beforeMain:ue,beforeRead:Yt,beforeWrite:bt,bottom:eo,clippingParents:Ae,computeStyles:Zy,createPopper:_E,createPopperBase:Ck,createPopperLite:gE,detectOverflow:ip,end:Be,eventListeners:K1,flip:FA,hide:$A,left:_n,main:He,modifierPhases:xi,offset:UA,placements:Ti,popper:St,popperGenerator:ex,popperOffsets:fE,preventOverflow:VA,read:ci,reference:At,right:to,start:Oe,top:ys,variationPlacements:zt,viewport:ft,write:Pt},Symbol.toStringTag,{value:"Module"})),HA="dropdown",Id=".bs.dropdown",yE=".data-api",Tk="ArrowUp",jA="ArrowDown",Pk=`hide${Id}`,Mk=`hidden${Id}`,Ak=`show${Id}`,Ik=`shown${Id}`,YA=`click${Id}${yE}`,XA=`keydown${Id}${yE}`,vE=`keyup${Id}${yE}`,xc="show",sp='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',WA=`${sp}.${xc}`,Jy=".dropdown-menu",ZA=v()?"top-end":"top-start",KA=v()?"top-start":"top-end",QA=v()?"bottom-end":"bottom-start",sg=v()?"bottom-start":"bottom-end",Dk=v()?"left-start":"right-start",Nk=v()?"right-start":"left-start",Rk={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},JA={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class ql extends Ne{constructor(F,X){super(F,X),this._popper=null,this._parent=this._element.parentNode,this._menu=Ee.next(this._element,Jy)[0]||Ee.prev(this._element,Jy)[0]||Ee.findOne(Jy,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Rk}static get DefaultType(){return JA}static get NAME(){return HA}toggle(){return this._isShown()?this.hide():this.show()}show(){if(c(this._element)||this._isShown())return;const F={relatedTarget:this._element};if(!j.trigger(this._element,Ak,F).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const X of[].concat(...document.body.children))j.on(X,"mouseover",d);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(xc),this._element.classList.add(xc),j.trigger(this._element,Ik,F)}}hide(){if(c(this._element)||!this._isShown())return;const F={relatedTarget:this._element};this._completeHide(F)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(F){if(!j.trigger(this._element,Pk,F).defaultPrevented){if("ontouchstart"in document.documentElement)for(const X of[].concat(...document.body.children))j.off(X,"mouseover",d);this._popper&&this._popper.destroy(),this._menu.classList.remove(xc),this._element.classList.remove(xc),this._element.setAttribute("aria-expanded","false"),de.removeDataAttribute(this._menu,"popper"),j.trigger(this._element,Mk,F),this._element.focus()}}_getConfig(F){if(typeof(F=super._getConfig(F)).reference=="object"&&!a(F.reference)&&typeof F.reference.getBoundingClientRect!="function")throw new TypeError(`${HA.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return F}_createPopper(){if(qA===void 0)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let F=this._element;this._config.reference==="parent"?F=this._parent:a(this._config.reference)?F=l(this._config.reference):typeof this._config.reference=="object"&&(F=this._config.reference);const X=this._getPopperConfig();this._popper=_E(F,this._menu,X)}_isShown(){return this._menu.classList.contains(xc)}_getPlacement(){const F=this._parent;if(F.classList.contains("dropend"))return Dk;if(F.classList.contains("dropstart"))return Nk;if(F.classList.contains("dropup-center"))return"top";if(F.classList.contains("dropdown-center"))return"bottom";const X=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return F.classList.contains("dropup")?X?KA:ZA:X?sg:QA}_detectNavbar(){return this._element.closest(".navbar")!==null}_getOffset(){const{offset:F}=this._config;return typeof F=="string"?F.split(",").map(X=>Number.parseInt(X,10)):typeof F=="function"?X=>F(X,this._element):F}_getPopperConfig(){const F={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(de.setDataAttribute(this._menu,"popper","static"),F.modifiers=[{name:"applyStyles",enabled:!1}]),{...F,...w(this._config.popperConfig,[void 0,F])}}_selectMenuItem({key:F,target:X}){const ae=Ee.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(Te=>u(Te));ae.length&&C(ae,X,F===jA,!ae.includes(X)).focus()}static jQueryInterface(F){return this.each(function(){const X=ql.getOrCreateInstance(this,F);if(typeof F=="string"){if(X[F]===void 0)throw new TypeError(`No method named "${F}"`);X[F]()}})}static clearMenus(F){if(F.button===2||F.type==="keyup"&&F.key!=="Tab")return;const X=Ee.find(WA);for(const ae of X){const Te=ql.getInstance(ae);if(!Te||Te._config.autoClose===!1)continue;const Pe=F.composedPath(),Ke=Pe.includes(Te._menu);if(Pe.includes(Te._element)||Te._config.autoClose==="inside"&&!Ke||Te._config.autoClose==="outside"&&Ke||Te._menu.contains(F.target)&&(F.type==="keyup"&&F.key==="Tab"||/input|select|option|textarea|form/i.test(F.target.tagName)))continue;const lt={relatedTarget:Te._element};F.type==="click"&&(lt.clickEvent=F),Te._completeHide(lt)}}static dataApiKeydownHandler(F){const X=/input|textarea/i.test(F.target.tagName),ae=F.key==="Escape",Te=[Tk,jA].includes(F.key);if(!Te&&!ae||X&&!ae)return;F.preventDefault();const Pe=this.matches(sp)?this:Ee.prev(this,sp)[0]||Ee.next(this,sp)[0]||Ee.findOne(sp,F.delegateTarget.parentNode),Ke=ql.getOrCreateInstance(Pe);if(Te)return F.stopPropagation(),Ke.show(),void Ke._selectMenuItem(F);Ke._isShown()&&(F.stopPropagation(),Ke.hide(),Pe.focus())}}j.on(document,XA,sp,ql.dataApiKeydownHandler),j.on(document,XA,Jy,ql.dataApiKeydownHandler),j.on(document,YA,ql.clearMenus),j.on(document,vE,ql.clearMenus),j.on(document,YA,sp,function(Q){Q.preventDefault(),ql.getOrCreateInstance(this).toggle()}),x(ql);const ng="backdrop",rg="show",eI=`mousedown.bs.${ng}`,tx={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},tI={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class xE extends fe{constructor(F){super(),this._config=this._getConfig(F),this._isAppended=!1,this._element=null}static get Default(){return tx}static get DefaultType(){return tI}static get NAME(){return ng}show(F){if(!this._config.isVisible)return void w(F);this._append();const X=this._getElement();this._config.isAnimated&&m(X),X.classList.add(rg),this._emulateAnimation(()=>{w(F)})}hide(F){this._config.isVisible?(this._getElement().classList.remove(rg),this._emulateAnimation(()=>{this.dispose(),w(F)})):w(F)}dispose(){this._isAppended&&(j.off(this._element,eI),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const F=document.createElement("div");F.className=this._config.className,this._config.isAnimated&&F.classList.add("fade"),this._element=F}return this._element}_configAfterMerge(F){return F.rootElement=l(F.rootElement),F}_append(){if(this._isAppended)return;const F=this._getElement();this._config.rootElement.append(F),j.on(F,eI,()=>{w(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(F){T(F,this._getElement(),this._config.isAnimated)}}const og=".bs.focustrap",bE=`focusin${og}`,iI=`keydown.tab${og}`,wE="backward",sI={autofocus:!0,trapElement:null},Ok={autofocus:"boolean",trapElement:"element"};class nI extends fe{constructor(F){super(),this._config=this._getConfig(F),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return sI}static get DefaultType(){return Ok}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),j.off(document,og),j.on(document,bE,F=>this._handleFocusin(F)),j.on(document,iI,F=>this._handleKeydown(F)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,j.off(document,og))}_handleFocusin(F){const{trapElement:X}=this._config;if(F.target===document||F.target===X||X.contains(F.target))return;const ae=Ee.focusableChildren(X);ae.length===0?X.focus():this._lastTabNavDirection===wE?ae[ae.length-1].focus():ae[0].focus()}_handleKeydown(F){F.key==="Tab"&&(this._lastTabNavDirection=F.shiftKey?wE:"forward")}}const rI=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",oI=".sticky-top",ix="padding-right",Fa="margin-right";class np{constructor(){this._element=document.body}getWidth(){const F=document.documentElement.clientWidth;return Math.abs(window.innerWidth-F)}hide(){const F=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,ix,X=>X+F),this._setElementAttributes(rI,ix,X=>X+F),this._setElementAttributes(oI,Fa,X=>X-F)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,ix),this._resetElementAttributes(rI,ix),this._resetElementAttributes(oI,Fa)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(F,X,ae){const Te=this.getWidth();this._applyManipulationCallback(F,Pe=>{if(Pe!==this._element&&window.innerWidth>Pe.clientWidth+Te)return;this._saveInitialAttribute(Pe,X);const Ke=window.getComputedStyle(Pe).getPropertyValue(X);Pe.style.setProperty(X,`${ae(Number.parseFloat(Ke))}px`)})}_saveInitialAttribute(F,X){const ae=F.style.getPropertyValue(X);ae&&de.setDataAttribute(F,X,ae)}_resetElementAttributes(F,X){this._applyManipulationCallback(F,ae=>{const Te=de.getDataAttribute(ae,X);Te!==null?(de.removeDataAttribute(ae,X),ae.style.setProperty(X,Te)):ae.style.removeProperty(X)})}_applyManipulationCallback(F,X){if(a(F))X(F);else for(const ae of Ee.find(F,this._element))X(ae)}}const ml=".bs.modal",aI=`hide${ml}`,lI=`hidePrevented${ml}`,SE=`hidden${ml}`,sx=`show${ml}`,Lk=`shown${ml}`,ag=`resize${ml}`,EE=`click.dismiss${ml}`,e0=`mousedown.dismiss${ml}`,CE=`keydown.dismiss${ml}`,uI=`click${ml}.data-api`,Dd="modal-open",rp="show",t0="modal-static",cI={backdrop:!0,focus:!0,keyboard:!0},op={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Nd extends Ne{constructor(F,X){super(F,X),this._dialog=Ee.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new np,this._addEventListeners()}static get Default(){return cI}static get DefaultType(){return op}static get NAME(){return"modal"}toggle(F){return this._isShown?this.hide():this.show(F)}show(F){this._isShown||this._isTransitioning||j.trigger(this._element,sx,{relatedTarget:F}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Dd),this._adjustDialog(),this._backdrop.show(()=>this._showElement(F)))}hide(){this._isShown&&!this._isTransitioning&&(j.trigger(this._element,aI).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(rp),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated())))}dispose(){j.off(window,ml),j.off(this._dialog,ml),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new xE({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new nI({trapElement:this._element})}_showElement(F){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const X=Ee.findOne(".modal-body",this._dialog);X&&(X.scrollTop=0),m(this._element),this._element.classList.add(rp),this._queueCallback(()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,j.trigger(this._element,Lk,{relatedTarget:F})},this._dialog,this._isAnimated())}_addEventListeners(){j.on(this._element,CE,F=>{F.key==="Escape"&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())}),j.on(window,ag,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),j.on(this._element,e0,F=>{j.one(this._element,EE,X=>{this._element===F.target&&this._element===X.target&&(this._config.backdrop!=="static"?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Dd),this._resetAdjustments(),this._scrollBar.reset(),j.trigger(this._element,SE)})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(j.trigger(this._element,lI).defaultPrevented)return;const F=this._element.scrollHeight>document.documentElement.clientHeight,X=this._element.style.overflowY;X==="hidden"||this._element.classList.contains(t0)||(F||(this._element.style.overflowY="hidden"),this._element.classList.add(t0),this._queueCallback(()=>{this._element.classList.remove(t0),this._queueCallback(()=>{this._element.style.overflowY=X},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const F=this._element.scrollHeight>document.documentElement.clientHeight,X=this._scrollBar.getWidth(),ae=X>0;if(ae&&!F){const Te=v()?"paddingLeft":"paddingRight";this._element.style[Te]=`${X}px`}if(!ae&&F){const Te=v()?"paddingRight":"paddingLeft";this._element.style[Te]=`${X}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(F,X){return this.each(function(){const ae=Nd.getOrCreateInstance(this,F);if(typeof F=="string"){if(ae[F]===void 0)throw new TypeError(`No method named "${F}"`);ae[F](X)}})}}j.on(document,uI,'[data-bs-toggle="modal"]',function(Q){const F=Ee.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&Q.preventDefault(),j.one(F,sx,ae=>{ae.defaultPrevented||j.one(F,SE,()=>{u(this)&&this.focus()})});const X=Ee.findOne(".modal.show");X&&Nd.getInstance(X).hide(),Nd.getOrCreateInstance(F).toggle(this)}),Zt(Nd),x(Nd);const bc=".bs.offcanvas",TE=".data-api",Fk=`load${bc}${TE}`,hI="show",dI="showing",PE="hiding",ME=".offcanvas.show",AE=`show${bc}`,Ru=`shown${bc}`,mI=`hide${bc}`,pl=`hidePrevented${bc}`,fl=`hidden${bc}`,lg=`resize${bc}`,IE=`click${bc}${TE}`,nx=`keydown.dismiss${bc}`,rx={backdrop:!0,keyboard:!0,scroll:!1},DE={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class ka extends Ne{constructor(F,X){super(F,X),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return rx}static get DefaultType(){return DE}static get NAME(){return"offcanvas"}toggle(F){return this._isShown?this.hide():this.show(F)}show(F){this._isShown||j.trigger(this._element,AE,{relatedTarget:F}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||new np().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(dI),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(hI),this._element.classList.remove(dI),j.trigger(this._element,Ru,{relatedTarget:F})},this._element,!0))}hide(){this._isShown&&(j.trigger(this._element,mI).defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(PE),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove(hI,PE),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new np().reset(),j.trigger(this._element,fl)},this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const F=!!this._config.backdrop;return new xE({className:"offcanvas-backdrop",isVisible:F,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:F?()=>{this._config.backdrop!=="static"?this.hide():j.trigger(this._element,pl)}:null})}_initializeFocusTrap(){return new nI({trapElement:this._element})}_addEventListeners(){j.on(this._element,nx,F=>{F.key==="Escape"&&(this._config.keyboard?this.hide():j.trigger(this._element,pl))})}static jQueryInterface(F){return this.each(function(){const X=ka.getOrCreateInstance(this,F);if(typeof F=="string"){if(X[F]===void 0||F.startsWith("_")||F==="constructor")throw new TypeError(`No method named "${F}"`);X[F](this)}})}}j.on(document,IE,'[data-bs-toggle="offcanvas"]',function(Q){const F=Ee.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&Q.preventDefault(),c(this))return;j.one(F,fl,()=>{u(this)&&this.focus()});const X=Ee.findOne(ME);X&&X!==F&&ka.getInstance(X).hide(),ka.getOrCreateInstance(F).toggle(this)}),j.on(window,Fk,()=>{for(const Q of Ee.find(ME))ka.getOrCreateInstance(Q).show()}),j.on(window,lg,()=>{for(const Q of Ee.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(Q).position!=="fixed"&&ka.getOrCreateInstance(Q).hide()}),Zt(ka),x(ka);const NE={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},ox=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),ug=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,kk=(Q,F)=>{const X=Q.nodeName.toLowerCase();return F.includes(X)?!ox.has(X)||!!ug.test(Q.nodeValue):F.filter(ae=>ae instanceof RegExp).some(ae=>ae.test(X))},gl={allowList:NE,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},RE={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},ph={entry:"(string|element|function|null)",selector:"(string|element)"};class pI extends fe{constructor(F){super(),this._config=this._getConfig(F)}static get Default(){return gl}static get DefaultType(){return RE}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(F=>this._resolvePossibleFunction(F)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(F){return this._checkContent(F),this._config.content={...this._config.content,...F},this}toHtml(){const F=document.createElement("div");F.innerHTML=this._maybeSanitize(this._config.template);for(const[Te,Pe]of Object.entries(this._config.content))this._setContent(F,Pe,Te);const X=F.children[0],ae=this._resolvePossibleFunction(this._config.extraClass);return ae&&X.classList.add(...ae.split(" ")),X}_typeCheckConfig(F){super._typeCheckConfig(F),this._checkContent(F.content)}_checkContent(F){for(const[X,ae]of Object.entries(F))super._typeCheckConfig({selector:X,entry:ae},ph)}_setContent(F,X,ae){const Te=Ee.findOne(ae,F);Te&&((X=this._resolvePossibleFunction(X))?a(X)?this._putElementInTemplate(l(X),Te):this._config.html?Te.innerHTML=this._maybeSanitize(X):Te.textContent=X:Te.remove())}_maybeSanitize(F){return this._config.sanitize?function(X,ae,Te){if(!X.length)return X;if(Te&&typeof Te=="function")return Te(X);const Pe=new window.DOMParser().parseFromString(X,"text/html"),Ke=[].concat(...Pe.body.querySelectorAll("*"));for(const lt of Ke){const vt=lt.nodeName.toLowerCase();if(!Object.keys(ae).includes(vt)){lt.remove();continue}const Ft=[].concat(...lt.attributes),Ht=[].concat(ae["*"]||[],ae[vt]||[]);for(const Ot of Ft)kk(Ot,Ht)||lt.removeAttribute(Ot.nodeName)}return Pe.body.innerHTML}(F,this._config.allowList,this._config.sanitizeFn):F}_resolvePossibleFunction(F){return w(F,[void 0,this])}_putElementInTemplate(F,X){if(this._config.html)return X.innerHTML="",void X.append(F);X.textContent=F.textContent}}const ax=new Set(["sanitize","allowList","sanitizeFn"]),fh="fade",cg="show",OE=".tooltip-inner",ap=".modal",lp="hide.bs.modal",Rd="hover",hg="focus",Hl={AUTO:"auto",TOP:"top",RIGHT:v()?"left":"right",BOTTOM:"bottom",LEFT:v()?"right":"left"},jl={allowList:NE,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},up={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class pa extends Ne{constructor(F,X){if(qA===void 0)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(F,X),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return jl}static get DefaultType(){return up}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),j.off(this._element.closest(ap),lp,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const F=j.trigger(this._element,this.constructor.eventName("show")),X=(h(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(F.defaultPrevented||!X)return;this._disposePopper();const ae=this._getTipElement();this._element.setAttribute("aria-describedby",ae.getAttribute("id"));const{container:Te}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(Te.append(ae),j.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(ae),ae.classList.add(cg),"ontouchstart"in document.documentElement)for(const Pe of[].concat(...document.body.children))j.on(Pe,"mouseover",d);this._queueCallback(()=>{j.trigger(this._element,this.constructor.eventName("shown")),this._isHovered===!1&&this._leave(),this._isHovered=!1},this.tip,this._isAnimated())}hide(){if(this._isShown()&&!j.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(cg),"ontouchstart"in document.documentElement)for(const F of[].concat(...document.body.children))j.off(F,"mouseover",d);this._activeTrigger.click=!1,this._activeTrigger[hg]=!1,this._activeTrigger[Rd]=!1,this._isHovered=null,this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),j.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(F){const X=this._getTemplateFactory(F).toHtml();if(!X)return null;X.classList.remove(fh,cg),X.classList.add(`bs-${this.constructor.NAME}-auto`);const ae=(Te=>{do Te+=Math.floor(1e6*Math.random());while(document.getElementById(Te));return Te})(this.constructor.NAME).toString();return X.setAttribute("id",ae),this._isAnimated()&&X.classList.add(fh),X}setContent(F){this._newContent=F,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(F){return this._templateFactory?this._templateFactory.changeContent(F):this._templateFactory=new pI({...this._config,content:F,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[OE]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(F){return this.constructor.getOrCreateInstance(F.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(fh)}_isShown(){return this.tip&&this.tip.classList.contains(cg)}_createPopper(F){const X=w(this._config.placement,[this,F,this._element]),ae=Hl[X.toUpperCase()];return _E(this._element,F,this._getPopperConfig(ae))}_getOffset(){const{offset:F}=this._config;return typeof F=="string"?F.split(",").map(X=>Number.parseInt(X,10)):typeof F=="function"?X=>F(X,this._element):F}_resolvePossibleFunction(F){return w(F,[this._element,this._element])}_getPopperConfig(F){const X={placement:F,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:ae=>{this._getTipElement().setAttribute("data-popper-placement",ae.state.placement)}}]};return{...X,...w(this._config.popperConfig,[void 0,X])}}_setListeners(){const F=this._config.trigger.split(" ");for(const X of F)if(X==="click")j.on(this._element,this.constructor.eventName("click"),this._config.selector,ae=>{this._initializeOnDelegatedTarget(ae).toggle()});else if(X!=="manual"){const ae=X===Rd?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),Te=X===Rd?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");j.on(this._element,ae,this._config.selector,Pe=>{const Ke=this._initializeOnDelegatedTarget(Pe);Ke._activeTrigger[Pe.type==="focusin"?hg:Rd]=!0,Ke._enter()}),j.on(this._element,Te,this._config.selector,Pe=>{const Ke=this._initializeOnDelegatedTarget(Pe);Ke._activeTrigger[Pe.type==="focusout"?hg:Rd]=Ke._element.contains(Pe.relatedTarget),Ke._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},j.on(this._element.closest(ap),lp,this._hideModalHandler)}_fixTitle(){const F=this._element.getAttribute("title");F&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",F),this._element.setAttribute("data-bs-original-title",F),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(F,X){clearTimeout(this._timeout),this._timeout=setTimeout(F,X)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(F){const X=de.getDataAttributes(this._element);for(const ae of Object.keys(X))ax.has(ae)&&delete X[ae];return F={...X,...typeof F=="object"&&F?F:{}},F=this._mergeConfigObj(F),F=this._configAfterMerge(F),this._typeCheckConfig(F),F}_configAfterMerge(F){return F.container=F.container===!1?document.body:l(F.container),typeof F.delay=="number"&&(F.delay={show:F.delay,hide:F.delay}),typeof F.title=="number"&&(F.title=F.title.toString()),typeof F.content=="number"&&(F.content=F.content.toString()),F}_getDelegateConfig(){const F={};for(const[X,ae]of Object.entries(this._config))this.constructor.Default[X]!==ae&&(F[X]=ae);return F.selector=!1,F.trigger="manual",F}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(F){return this.each(function(){const X=pa.getOrCreateInstance(this,F);if(typeof F=="string"){if(X[F]===void 0)throw new TypeError(`No method named "${F}"`);X[F]()}})}}x(pa);const gh=".popover-header",cp=".popover-body",fI={...pa.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},LE={...pa.DefaultType,content:"(null|string|element|function)"};class dg extends pa{static get Default(){return fI}static get DefaultType(){return LE}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[gh]:this._getTitle(),[cp]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(F){return this.each(function(){const X=dg.getOrCreateInstance(this,F);if(typeof F=="string"){if(X[F]===void 0)throw new TypeError(`No method named "${F}"`);X[F]()}})}}x(dg);const bo=".bs.scrollspy",ar=`activate${bo}`,ks=`click${bo}`,hp=`load${bo}.data-api`,fa="active",i0="[href]",Od=".nav-link",gI=`${Od}, .nav-item > ${Od}, .list-group-item`,_I={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},s0={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class _h extends Ne{constructor(F,X){super(F,X),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return _I}static get DefaultType(){return s0}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const F of this._observableSections.values())this._observer.observe(F)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(F){return F.target=l(F.target)||document.body,F.rootMargin=F.offset?`${F.offset}px 0px -30%`:F.rootMargin,typeof F.threshold=="string"&&(F.threshold=F.threshold.split(",").map(X=>Number.parseFloat(X))),F}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(j.off(this._config.target,ks),j.on(this._config.target,ks,i0,F=>{const X=this._observableSections.get(F.target.hash);if(X){F.preventDefault();const ae=this._rootElement||window,Te=X.offsetTop-this._element.offsetTop;if(ae.scrollTo)return void ae.scrollTo({top:Te,behavior:"smooth"});ae.scrollTop=Te}}))}_getNewObserver(){const F={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(X=>this._observerCallback(X),F)}_observerCallback(F){const X=Ke=>this._targetLinks.get(`#${Ke.target.id}`),ae=Ke=>{this._previousScrollData.visibleEntryTop=Ke.target.offsetTop,this._process(X(Ke))},Te=(this._rootElement||document.documentElement).scrollTop,Pe=Te>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=Te;for(const Ke of F){if(!Ke.isIntersecting){this._activeTarget=null,this._clearActiveClass(X(Ke));continue}const lt=Ke.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(Pe&&lt){if(ae(Ke),!Te)return}else Pe||lt||ae(Ke)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const F=Ee.find(i0,this._config.target);for(const X of F){if(!X.hash||c(X))continue;const ae=Ee.findOne(decodeURI(X.hash),this._element);u(ae)&&(this._targetLinks.set(decodeURI(X.hash),X),this._observableSections.set(X.hash,ae))}}_process(F){this._activeTarget!==F&&(this._clearActiveClass(this._config.target),this._activeTarget=F,F.classList.add(fa),this._activateParents(F),j.trigger(this._element,ar,{relatedTarget:F}))}_activateParents(F){if(F.classList.contains("dropdown-item"))Ee.findOne(".dropdown-toggle",F.closest(".dropdown")).classList.add(fa);else for(const X of Ee.parents(F,".nav, .list-group"))for(const ae of Ee.prev(X,gI))ae.classList.add(fa)}_clearActiveClass(F){F.classList.remove(fa);const X=Ee.find(`${i0}.${fa}`,F);for(const ae of X)ae.classList.remove(fa)}static jQueryInterface(F){return this.each(function(){const X=_h.getOrCreateInstance(this,F);if(typeof F=="string"){if(X[F]===void 0||F.startsWith("_")||F==="constructor")throw new TypeError(`No method named "${F}"`);X[F]()}})}}j.on(window,hp,()=>{for(const Q of Ee.find('[data-bs-spy="scroll"]'))_h.getOrCreateInstance(Q)}),x(_h);const Ld=".bs.tab",n0=`hide${Ld}`,FE=`hidden${Ld}`,dp=`show${Ld}`,yh=`shown${Ld}`,Fd=`click${Ld}`,vh=`keydown${Ld}`,kE=`load${Ld}`,$E="ArrowLeft",mg="ArrowRight",lx="ArrowUp",kd="ArrowDown",so="Home",r0="End",$d="active",yI="fade",UE="show",vI=".dropdown-toggle",br=`:not(${vI})`,ux='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',mp=`.nav-link${br}, .list-group-item${br}, [role="tab"]${br}, ${ux}`,o0=`.${$d}[data-bs-toggle="tab"], .${$d}[data-bs-toggle="pill"], .${$d}[data-bs-toggle="list"]`;class xh extends Ne{constructor(F){super(F),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),j.on(this._element,vh,X=>this._keydown(X)))}static get NAME(){return"tab"}show(){const F=this._element;if(this._elemIsActive(F))return;const X=this._getActiveElem(),ae=X?j.trigger(X,n0,{relatedTarget:F}):null;j.trigger(F,dp,{relatedTarget:X}).defaultPrevented||ae&&ae.defaultPrevented||(this._deactivate(X,F),this._activate(F,X))}_activate(F,X){F&&(F.classList.add($d),this._activate(Ee.getElementFromSelector(F)),this._queueCallback(()=>{F.getAttribute("role")==="tab"?(F.removeAttribute("tabindex"),F.setAttribute("aria-selected",!0),this._toggleDropDown(F,!0),j.trigger(F,yh,{relatedTarget:X})):F.classList.add(UE)},F,F.classList.contains(yI)))}_deactivate(F,X){F&&(F.classList.remove($d),F.blur(),this._deactivate(Ee.getElementFromSelector(F)),this._queueCallback(()=>{F.getAttribute("role")==="tab"?(F.setAttribute("aria-selected",!1),F.setAttribute("tabindex","-1"),this._toggleDropDown(F,!1),j.trigger(F,FE,{relatedTarget:X})):F.classList.remove(UE)},F,F.classList.contains(yI)))}_keydown(F){if(![$E,mg,lx,kd,so,r0].includes(F.key))return;F.stopPropagation(),F.preventDefault();const X=this._getChildren().filter(Te=>!c(Te));let ae;if([so,r0].includes(F.key))ae=X[F.key===so?0:X.length-1];else{const Te=[mg,kd].includes(F.key);ae=C(X,F.target,Te,!0)}ae&&(ae.focus({preventScroll:!0}),xh.getOrCreateInstance(ae).show())}_getChildren(){return Ee.find(mp,this._parent)}_getActiveElem(){return this._getChildren().find(F=>this._elemIsActive(F))||null}_setInitialAttributes(F,X){this._setAttributeIfNotExists(F,"role","tablist");for(const ae of X)this._setInitialAttributesOnChild(ae)}_setInitialAttributesOnChild(F){F=this._getInnerElement(F);const X=this._elemIsActive(F),ae=this._getOuterElement(F);F.setAttribute("aria-selected",X),ae!==F&&this._setAttributeIfNotExists(ae,"role","presentation"),X||F.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(F,"role","tab"),this._setInitialAttributesOnTargetPanel(F)}_setInitialAttributesOnTargetPanel(F){const X=Ee.getElementFromSelector(F);X&&(this._setAttributeIfNotExists(X,"role","tabpanel"),F.id&&this._setAttributeIfNotExists(X,"aria-labelledby",`${F.id}`))}_toggleDropDown(F,X){const ae=this._getOuterElement(F);if(!ae.classList.contains("dropdown"))return;const Te=(Pe,Ke)=>{const lt=Ee.findOne(Pe,ae);lt&&lt.classList.toggle(Ke,X)};Te(vI,$d),Te(".dropdown-menu",UE),ae.setAttribute("aria-expanded",X)}_setAttributeIfNotExists(F,X,ae){F.hasAttribute(X)||F.setAttribute(X,ae)}_elemIsActive(F){return F.classList.contains($d)}_getInnerElement(F){return F.matches(mp)?F:Ee.findOne(mp,F)}_getOuterElement(F){return F.closest(".nav-item, .list-group-item")||F}static jQueryInterface(F){return this.each(function(){const X=xh.getOrCreateInstance(this);if(typeof F=="string"){if(X[F]===void 0||F.startsWith("_")||F==="constructor")throw new TypeError(`No method named "${F}"`);X[F]()}})}}j.on(document,Fd,ux,function(Q){["A","AREA"].includes(this.tagName)&&Q.preventDefault(),c(this)||xh.getOrCreateInstance(this).show()}),j.on(window,kE,()=>{for(const Q of Ee.find(o0))xh.getOrCreateInstance(Q)}),x(xh);const _l=".bs.toast",pg=`mouseover${_l}`,$k=`mouseout${_l}`,xI=`focusin${_l}`,Uk=`focusout${_l}`,bI=`hide${_l}`,pp=`hidden${_l}`,VE=`show${_l}`,cx=`shown${_l}`,zE="hide",Ud="show",a0="showing",hx={animation:"boolean",autohide:"boolean",delay:"number"},GE={animation:!0,autohide:!0,delay:5e3};class fg extends Ne{constructor(F,X){super(F,X),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return GE}static get DefaultType(){return hx}static get NAME(){return"toast"}show(){j.trigger(this._element,VE).defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(zE),m(this._element),this._element.classList.add(Ud,a0),this._queueCallback(()=>{this._element.classList.remove(a0),j.trigger(this._element,cx),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this.isShown()&&(j.trigger(this._element,bI).defaultPrevented||(this._element.classList.add(a0),this._queueCallback(()=>{this._element.classList.add(zE),this._element.classList.remove(a0,Ud),j.trigger(this._element,pp)},this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Ud),super.dispose()}isShown(){return this._element.classList.contains(Ud)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(F,X){switch(F.type){case"mouseover":case"mouseout":this._hasMouseInteraction=X;break;case"focusin":case"focusout":this._hasKeyboardInteraction=X}if(X)return void this._clearTimeout();const ae=F.relatedTarget;this._element===ae||this._element.contains(ae)||this._maybeScheduleHide()}_setListeners(){j.on(this._element,pg,F=>this._onInteraction(F,!0)),j.on(this._element,$k,F=>this._onInteraction(F,!1)),j.on(this._element,xI,F=>this._onInteraction(F,!0)),j.on(this._element,Uk,F=>this._onInteraction(F,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(F){return this.each(function(){const X=fg.getOrCreateInstance(this,F);if(typeof F=="string"){if(X[F]===void 0)throw new TypeError(`No method named "${F}"`);X[F](this)}})}}return Zt(fg),x(fg),{Alert:si,Button:Bi,Carousel:Le,Collapse:ha,Dropdown:ql,Modal:Nd,Offcanvas:ka,Popover:dg,ScrollSpy:_h,Tab:xh,Toast:fg,Tooltip:pa}})}(m3)),m3.exports}RGe();/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const jj="175",Nw={ROTATE:0,DOLLY:1,PAN:2},pw={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},OGe=0,Lte=1,LGe=2,X_e=1,FGe=2,Bp=3,Cy=0,bu=1,Sm=2,ay=0,Rw=1,Fte=2,kte=3,$te=4,kGe=5,Mv=100,$Ge=101,UGe=102,VGe=103,zGe=104,GGe=200,BGe=201,qGe=202,HGe=203,zB=204,GB=205,jGe=206,YGe=207,XGe=208,WGe=209,ZGe=210,KGe=211,QGe=212,JGe=213,eBe=214,BB=0,qB=1,HB=2,SS=3,jB=4,YB=5,XB=6,WB=7,W_e=0,tBe=1,iBe=2,ly=0,sBe=1,nBe=2,rBe=3,oBe=4,aBe=5,lBe=6,uBe=7,Z_e=300,ES=301,CS=302,ZB=303,KB=304,$4=306,QB=1e3,Vv=1001,JB=1002,fd=1003,cBe=1004,rN=1005,Cm=1006,c5=1007,zv=1008,Vf=1009,K_e=1010,Q_e=1011,hM=1012,Yj=1013,I1=1014,wf=1015,yA=1016,Xj=1017,Wj=1018,dM=1020,J_e=35902,eye=1021,tye=1022,cd=1023,iye=1024,sye=1025,mM=1026,pM=1027,nye=1028,Zj=1029,rye=1030,Kj=1031,Qj=1033,p3=33776,f3=33777,g3=33778,_3=33779,e8=35840,t8=35841,i8=35842,s8=35843,n8=36196,r8=37492,o8=37496,a8=37808,l8=37809,u8=37810,c8=37811,h8=37812,d8=37813,m8=37814,p8=37815,f8=37816,g8=37817,_8=37818,y8=37819,v8=37820,x8=37821,y3=36492,b8=36494,w8=36495,oye=36283,S8=36284,E8=36285,C8=36286,hBe=3200,dBe=3201,mBe=0,pBe=1,G_="",Hc="srgb",TS="srgb-linear",DL="linear",Mn="srgb",Bx=7680,Ute=519,fBe=512,gBe=513,_Be=514,aye=515,yBe=516,vBe=517,xBe=518,bBe=519,Vte=35044,zte="300 es",Sf=2e3,NL=2001;class j1{addEventListener(e,i){this._listeners===void 0&&(this._listeners={});const s=this._listeners;s[e]===void 0&&(s[e]=[]),s[e].indexOf(i)===-1&&s[e].push(i)}hasEventListener(e,i){const s=this._listeners;return s===void 0?!1:s[e]!==void 0&&s[e].indexOf(i)!==-1}removeEventListener(e,i){const s=this._listeners;if(s===void 0)return;const n=s[e];if(n!==void 0){const r=n.indexOf(i);r!==-1&&n.splice(r,1)}}dispatchEvent(e){const i=this._listeners;if(i===void 0)return;const s=i[e.type];if(s!==void 0){e.target=this;const n=s.slice(0);for(let r=0,o=n.length;r<o;r++)n[r].call(this,e);e.target=null}}}const Va=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],v3=Math.PI/180,T8=180/Math.PI;function vA(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0,s=Math.random()*4294967295|0;return(Va[t&255]+Va[t>>8&255]+Va[t>>16&255]+Va[t>>24&255]+"-"+Va[e&255]+Va[e>>8&255]+"-"+Va[e>>16&15|64]+Va[e>>24&255]+"-"+Va[i&63|128]+Va[i>>8&255]+"-"+Va[i>>16&255]+Va[i>>24&255]+Va[s&255]+Va[s>>8&255]+Va[s>>16&255]+Va[s>>24&255]).toLowerCase()}function Cs(t,e,i){return Math.max(e,Math.min(i,t))}function wBe(t,e){return(t%e+e)%e}function h5(t,e,i){return(1-i)*t+i*e}function z2(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function Zl(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}const SBe={DEG2RAD:v3};class hs{constructor(e=0,i=0){hs.prototype.isVector2=!0,this.x=e,this.y=i}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,i){return this.x=e,this.y=i,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const i=this.x,s=this.y,n=e.elements;return this.x=n[0]*i+n[3]*s+n[6],this.y=n[1]*i+n[4]*s+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,i){return this.x=Cs(this.x,e.x,i.x),this.y=Cs(this.y,e.y,i.y),this}clampScalar(e,i){return this.x=Cs(this.x,e,i),this.y=Cs(this.y,e,i),this}clampLength(e,i){const s=this.length();return this.divideScalar(s||1).multiplyScalar(Cs(s,e,i))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;const s=this.dot(e)/i;return Math.acos(Cs(s,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,s=this.y-e.y;return i*i+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this}lerpVectors(e,i,s){return this.x=e.x+(i.x-e.x)*s,this.y=e.y+(i.y-e.y)*s,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this}rotateAround(e,i){const s=Math.cos(i),n=Math.sin(i),r=this.x-e.x,o=this.y-e.y;return this.x=r*s-o*n+e.x,this.y=r*n+o*s+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class cs{constructor(e,i,s,n,r,o,a,l,u){cs.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,i,s,n,r,o,a,l,u)}set(e,i,s,n,r,o,a,l,u){const c=this.elements;return c[0]=e,c[1]=n,c[2]=a,c[3]=i,c[4]=r,c[5]=l,c[6]=s,c[7]=o,c[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const i=this.elements,s=e.elements;return i[0]=s[0],i[1]=s[1],i[2]=s[2],i[3]=s[3],i[4]=s[4],i[5]=s[5],i[6]=s[6],i[7]=s[7],i[8]=s[8],this}extractBasis(e,i,s){return e.setFromMatrix3Column(this,0),i.setFromMatrix3Column(this,1),s.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const i=e.elements;return this.set(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const s=e.elements,n=i.elements,r=this.elements,o=s[0],a=s[3],l=s[6],u=s[1],c=s[4],h=s[7],d=s[2],m=s[5],f=s[8],_=n[0],v=n[3],x=n[6],w=n[1],T=n[4],C=n[7],M=n[2],A=n[5],I=n[8];return r[0]=o*_+a*w+l*M,r[3]=o*v+a*T+l*A,r[6]=o*x+a*C+l*I,r[1]=u*_+c*w+h*M,r[4]=u*v+c*T+h*A,r[7]=u*x+c*C+h*I,r[2]=d*_+m*w+f*M,r[5]=d*v+m*T+f*A,r[8]=d*x+m*C+f*I,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=e,i[4]*=e,i[7]*=e,i[2]*=e,i[5]*=e,i[8]*=e,this}determinant(){const e=this.elements,i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8];return i*o*c-i*a*u-s*r*c+s*a*l+n*r*u-n*o*l}invert(){const e=this.elements,i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=c*o-a*u,d=a*l-c*r,m=u*r-o*l,f=i*h+s*d+n*m;if(f===0)return this.set(0,0,0,0,0,0,0,0,0);const _=1/f;return e[0]=h*_,e[1]=(n*u-c*s)*_,e[2]=(a*s-n*o)*_,e[3]=d*_,e[4]=(c*i-n*l)*_,e[5]=(n*r-a*i)*_,e[6]=m*_,e[7]=(s*l-u*i)*_,e[8]=(o*i-s*r)*_,this}transpose(){let e;const i=this.elements;return e=i[1],i[1]=i[3],i[3]=e,e=i[2],i[2]=i[6],i[6]=e,e=i[5],i[5]=i[7],i[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const i=this.elements;return e[0]=i[0],e[1]=i[3],e[2]=i[6],e[3]=i[1],e[4]=i[4],e[5]=i[7],e[6]=i[2],e[7]=i[5],e[8]=i[8],this}setUvTransform(e,i,s,n,r,o,a){const l=Math.cos(r),u=Math.sin(r);return this.set(s*l,s*u,-s*(l*o+u*a)+o+e,-n*u,n*l,-n*(-u*o+l*a)+a+i,0,0,1),this}scale(e,i){return this.premultiply(d5.makeScale(e,i)),this}rotate(e){return this.premultiply(d5.makeRotation(-e)),this}translate(e,i){return this.premultiply(d5.makeTranslation(e,i)),this}makeTranslation(e,i){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,i,0,0,1),this}makeRotation(e){const i=Math.cos(e),s=Math.sin(e);return this.set(i,-s,0,s,i,0,0,0,1),this}makeScale(e,i){return this.set(e,0,0,0,i,0,0,0,1),this}equals(e){const i=this.elements,s=e.elements;for(let n=0;n<9;n++)if(i[n]!==s[n])return!1;return!0}fromArray(e,i=0){for(let s=0;s<9;s++)this.elements[s]=e[s+i];return this}toArray(e=[],i=0){const s=this.elements;return e[i]=s[0],e[i+1]=s[1],e[i+2]=s[2],e[i+3]=s[3],e[i+4]=s[4],e[i+5]=s[5],e[i+6]=s[6],e[i+7]=s[7],e[i+8]=s[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const d5=new cs;function lye(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}function fM(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function EBe(){const t=fM("canvas");return t.style.display="block",t}const Gte={};function x3(t){t in Gte||(Gte[t]=!0,console.warn(t))}function CBe(t,e,i){return new Promise(function(s,n){function r(){switch(t.clientWaitSync(e,t.SYNC_FLUSH_COMMANDS_BIT,0)){case t.WAIT_FAILED:n();break;case t.TIMEOUT_EXPIRED:setTimeout(r,i);break;default:s()}}setTimeout(r,i)})}function TBe(t){const e=t.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function PBe(t){const e=t.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const Bte=new cs().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),qte=new cs().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function MBe(){const t={enabled:!0,workingColorSpace:TS,spaces:{},convert:function(n,r,o){return this.enabled===!1||r===o||!r||!o||(this.spaces[r].transfer===Mn&&(n.r=Tf(n.r),n.g=Tf(n.g),n.b=Tf(n.b)),this.spaces[r].primaries!==this.spaces[o].primaries&&(n.applyMatrix3(this.spaces[r].toXYZ),n.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===Mn&&(n.r=Ow(n.r),n.g=Ow(n.g),n.b=Ow(n.b))),n},fromWorkingColorSpace:function(n,r){return this.convert(n,this.workingColorSpace,r)},toWorkingColorSpace:function(n,r){return this.convert(n,r,this.workingColorSpace)},getPrimaries:function(n){return this.spaces[n].primaries},getTransfer:function(n){return n===G_?DL:this.spaces[n].transfer},getLuminanceCoefficients:function(n,r=this.workingColorSpace){return n.fromArray(this.spaces[r].luminanceCoefficients)},define:function(n){Object.assign(this.spaces,n)},_getMatrix:function(n,r,o){return n.copy(this.spaces[r].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(n){return this.spaces[n].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(n=this.workingColorSpace){return this.spaces[n].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],i=[.2126,.7152,.0722],s=[.3127,.329];return t.define({[TS]:{primaries:e,whitePoint:s,transfer:DL,toXYZ:Bte,fromXYZ:qte,luminanceCoefficients:i,workingColorSpaceConfig:{unpackColorSpace:Hc},outputColorSpaceConfig:{drawingBufferColorSpace:Hc}},[Hc]:{primaries:e,whitePoint:s,transfer:Mn,toXYZ:Bte,fromXYZ:qte,luminanceCoefficients:i,outputColorSpaceConfig:{drawingBufferColorSpace:Hc}}}),t}const Zs=MBe();function Tf(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function Ow(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}let qx;class ABe{static getDataURL(e,i="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let s;if(e instanceof HTMLCanvasElement)s=e;else{qx===void 0&&(qx=fM("canvas")),qx.width=e.width,qx.height=e.height;const n=qx.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),s=qx}return s.toDataURL(i)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const i=fM("canvas");i.width=e.width,i.height=e.height;const s=i.getContext("2d");s.drawImage(e,0,0,e.width,e.height);const n=s.getImageData(0,0,e.width,e.height),r=n.data;for(let o=0;o<r.length;o++)r[o]=Tf(r[o]/255)*255;return s.putImageData(n,0,0),i}else if(e.data){const i=e.data.slice(0);for(let s=0;s<i.length;s++)i instanceof Uint8Array||i instanceof Uint8ClampedArray?i[s]=Math.floor(Tf(i[s]/255)*255):i[s]=Tf(i[s]);return{data:i,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let IBe=0;class Jj{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:IBe++}),this.uuid=vA(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const i=e===void 0||typeof e=="string";if(!i&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const s={uuid:this.uuid,url:""},n=this.data;if(n!==null){let r;if(Array.isArray(n)){r=[];for(let o=0,a=n.length;o<a;o++)n[o].isDataTexture?r.push(m5(n[o].image)):r.push(m5(n[o]))}else r=m5(n);s.url=r}return i||(e.images[this.uuid]=s),s}}function m5(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?ABe.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let DBe=0;class $l extends j1{constructor(e=$l.DEFAULT_IMAGE,i=$l.DEFAULT_MAPPING,s=Vv,n=Vv,r=Cm,o=zv,a=cd,l=Vf,u=$l.DEFAULT_ANISOTROPY,c=G_){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:DBe++}),this.uuid=vA(),this.name="",this.source=new Jj(e),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=s,this.wrapT=n,this.magFilter=r,this.minFilter=o,this.anisotropy=u,this.format=a,this.internalFormat=null,this.type=l,this.offset=new hs(0,0),this.repeat=new hs(1,1),this.center=new hs(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new cs,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const i=e===void 0||typeof e=="string";if(!i&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const s={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(s.userData=this.userData),i||(e.textures[this.uuid]=s),s}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Z_e)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case QB:e.x=e.x-Math.floor(e.x);break;case Vv:e.x=e.x<0?0:1;break;case JB:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case QB:e.y=e.y-Math.floor(e.y);break;case Vv:e.y=e.y<0?0:1;break;case JB:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}$l.DEFAULT_IMAGE=null;$l.DEFAULT_MAPPING=Z_e;$l.DEFAULT_ANISOTROPY=1;class zr{constructor(e=0,i=0,s=0,n=1){zr.prototype.isVector4=!0,this.x=e,this.y=i,this.z=s,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,i,s,n){return this.x=e,this.y=i,this.z=s,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this.w=e.w+i.w,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this.w+=e.w*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this.w=e.w-i.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const i=this.x,s=this.y,n=this.z,r=this.w,o=e.elements;return this.x=o[0]*i+o[4]*s+o[8]*n+o[12]*r,this.y=o[1]*i+o[5]*s+o[9]*n+o[13]*r,this.z=o[2]*i+o[6]*s+o[10]*n+o[14]*r,this.w=o[3]*i+o[7]*s+o[11]*n+o[15]*r,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const i=Math.sqrt(1-e.w*e.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/i,this.y=e.y/i,this.z=e.z/i),this}setAxisAngleFromRotationMatrix(e){let i,s,n,r;const l=e.elements,u=l[0],c=l[4],h=l[8],d=l[1],m=l[5],f=l[9],_=l[2],v=l[6],x=l[10];if(Math.abs(c-d)<.01&&Math.abs(h-_)<.01&&Math.abs(f-v)<.01){if(Math.abs(c+d)<.1&&Math.abs(h+_)<.1&&Math.abs(f+v)<.1&&Math.abs(u+m+x-3)<.1)return this.set(1,0,0,0),this;i=Math.PI;const T=(u+1)/2,C=(m+1)/2,M=(x+1)/2,A=(c+d)/4,I=(h+_)/4,L=(f+v)/4;return T>C&&T>M?T<.01?(s=0,n=.707106781,r=.707106781):(s=Math.sqrt(T),n=A/s,r=I/s):C>M?C<.01?(s=.707106781,n=0,r=.707106781):(n=Math.sqrt(C),s=A/n,r=L/n):M<.01?(s=.707106781,n=.707106781,r=0):(r=Math.sqrt(M),s=I/r,n=L/r),this.set(s,n,r,i),this}let w=Math.sqrt((v-f)*(v-f)+(h-_)*(h-_)+(d-c)*(d-c));return Math.abs(w)<.001&&(w=1),this.x=(v-f)/w,this.y=(h-_)/w,this.z=(d-c)/w,this.w=Math.acos((u+m+x-1)/2),this}setFromMatrixPosition(e){const i=e.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this.w=i[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,i){return this.x=Cs(this.x,e.x,i.x),this.y=Cs(this.y,e.y,i.y),this.z=Cs(this.z,e.z,i.z),this.w=Cs(this.w,e.w,i.w),this}clampScalar(e,i){return this.x=Cs(this.x,e,i),this.y=Cs(this.y,e,i),this.z=Cs(this.z,e,i),this.w=Cs(this.w,e,i),this}clampLength(e,i){const s=this.length();return this.divideScalar(s||1).multiplyScalar(Cs(s,e,i))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this.w+=(e.w-this.w)*i,this}lerpVectors(e,i,s){return this.x=e.x+(i.x-e.x)*s,this.y=e.y+(i.y-e.y)*s,this.z=e.z+(i.z-e.z)*s,this.w=e.w+(i.w-e.w)*s,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this.w=e[i+3],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e[i+3]=this.w,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this.w=e.getW(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class NBe extends j1{constructor(e=1,i=1,s={}){super(),this.isRenderTarget=!0,this.width=e,this.height=i,this.depth=1,this.scissor=new zr(0,0,e,i),this.scissorTest=!1,this.viewport=new zr(0,0,e,i);const n={width:e,height:i,depth:1};s=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Cm,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},s);const r=new $l(n,s.mapping,s.wrapS,s.wrapT,s.magFilter,s.minFilter,s.format,s.type,s.anisotropy,s.colorSpace);r.flipY=!1,r.generateMipmaps=s.generateMipmaps,r.internalFormat=s.internalFormat,this.textures=[];const o=s.count;for(let a=0;a<o;a++)this.textures[a]=r.clone(),this.textures[a].isRenderTargetTexture=!0,this.textures[a].renderTarget=this;this.depthBuffer=s.depthBuffer,this.stencilBuffer=s.stencilBuffer,this.resolveDepthBuffer=s.resolveDepthBuffer,this.resolveStencilBuffer=s.resolveStencilBuffer,this._depthTexture=s.depthTexture,this.samples=s.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,i,s=1){if(this.width!==e||this.height!==i||this.depth!==s){this.width=e,this.height=i,this.depth=s;for(let n=0,r=this.textures.length;n<r;n++)this.textures[n].image.width=e,this.textures[n].image.height=i,this.textures[n].image.depth=s;this.dispose()}this.viewport.set(0,0,e,i),this.scissor.set(0,0,e,i)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let i=0,s=e.textures.length;i<s;i++){this.textures[i]=e.textures[i].clone(),this.textures[i].isRenderTargetTexture=!0,this.textures[i].renderTarget=this;const n=Object.assign({},e.textures[i].image);this.textures[i].source=new Jj(n)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class D1 extends NBe{constructor(e=1,i=1,s={}){super(e,i,s),this.isWebGLRenderTarget=!0}}class uye extends $l{constructor(e=null,i=1,s=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:i,height:s,depth:n},this.magFilter=fd,this.minFilter=fd,this.wrapR=Vv,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class RBe extends $l{constructor(e=null,i=1,s=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:i,height:s,depth:n},this.magFilter=fd,this.minFilter=fd,this.wrapR=Vv,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class N1{constructor(e=0,i=0,s=0,n=1){this.isQuaternion=!0,this._x=e,this._y=i,this._z=s,this._w=n}static slerpFlat(e,i,s,n,r,o,a){let l=s[n+0],u=s[n+1],c=s[n+2],h=s[n+3];const d=r[o+0],m=r[o+1],f=r[o+2],_=r[o+3];if(a===0){e[i+0]=l,e[i+1]=u,e[i+2]=c,e[i+3]=h;return}if(a===1){e[i+0]=d,e[i+1]=m,e[i+2]=f,e[i+3]=_;return}if(h!==_||l!==d||u!==m||c!==f){let v=1-a;const x=l*d+u*m+c*f+h*_,w=x>=0?1:-1,T=1-x*x;if(T>Number.EPSILON){const M=Math.sqrt(T),A=Math.atan2(M,x*w);v=Math.sin(v*A)/M,a=Math.sin(a*A)/M}const C=a*w;if(l=l*v+d*C,u=u*v+m*C,c=c*v+f*C,h=h*v+_*C,v===1-a){const M=1/Math.sqrt(l*l+u*u+c*c+h*h);l*=M,u*=M,c*=M,h*=M}}e[i]=l,e[i+1]=u,e[i+2]=c,e[i+3]=h}static multiplyQuaternionsFlat(e,i,s,n,r,o){const a=s[n],l=s[n+1],u=s[n+2],c=s[n+3],h=r[o],d=r[o+1],m=r[o+2],f=r[o+3];return e[i]=a*f+c*h+l*m-u*d,e[i+1]=l*f+c*d+u*h-a*m,e[i+2]=u*f+c*m+a*d-l*h,e[i+3]=c*f-a*h-l*d-u*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,i,s,n){return this._x=e,this._y=i,this._z=s,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,i=!0){const s=e._x,n=e._y,r=e._z,o=e._order,a=Math.cos,l=Math.sin,u=a(s/2),c=a(n/2),h=a(r/2),d=l(s/2),m=l(n/2),f=l(r/2);switch(o){case"XYZ":this._x=d*c*h+u*m*f,this._y=u*m*h-d*c*f,this._z=u*c*f+d*m*h,this._w=u*c*h-d*m*f;break;case"YXZ":this._x=d*c*h+u*m*f,this._y=u*m*h-d*c*f,this._z=u*c*f-d*m*h,this._w=u*c*h+d*m*f;break;case"ZXY":this._x=d*c*h-u*m*f,this._y=u*m*h+d*c*f,this._z=u*c*f+d*m*h,this._w=u*c*h-d*m*f;break;case"ZYX":this._x=d*c*h-u*m*f,this._y=u*m*h+d*c*f,this._z=u*c*f-d*m*h,this._w=u*c*h+d*m*f;break;case"YZX":this._x=d*c*h+u*m*f,this._y=u*m*h+d*c*f,this._z=u*c*f-d*m*h,this._w=u*c*h-d*m*f;break;case"XZY":this._x=d*c*h-u*m*f,this._y=u*m*h-d*c*f,this._z=u*c*f+d*m*h,this._w=u*c*h+d*m*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return i===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,i){const s=i/2,n=Math.sin(s);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(s),this._onChangeCallback(),this}setFromRotationMatrix(e){const i=e.elements,s=i[0],n=i[4],r=i[8],o=i[1],a=i[5],l=i[9],u=i[2],c=i[6],h=i[10],d=s+a+h;if(d>0){const m=.5/Math.sqrt(d+1);this._w=.25/m,this._x=(c-l)*m,this._y=(r-u)*m,this._z=(o-n)*m}else if(s>a&&s>h){const m=2*Math.sqrt(1+s-a-h);this._w=(c-l)/m,this._x=.25*m,this._y=(n+o)/m,this._z=(r+u)/m}else if(a>h){const m=2*Math.sqrt(1+a-s-h);this._w=(r-u)/m,this._x=(n+o)/m,this._y=.25*m,this._z=(l+c)/m}else{const m=2*Math.sqrt(1+h-s-a);this._w=(o-n)/m,this._x=(r+u)/m,this._y=(l+c)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,i){let s=e.dot(i)+1;return s<Number.EPSILON?(s=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=s):(this._x=0,this._y=-e.z,this._z=e.y,this._w=s)):(this._x=e.y*i.z-e.z*i.y,this._y=e.z*i.x-e.x*i.z,this._z=e.x*i.y-e.y*i.x,this._w=s),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Cs(this.dot(e),-1,1)))}rotateTowards(e,i){const s=this.angleTo(e);if(s===0)return this;const n=Math.min(1,i/s);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,i){const s=e._x,n=e._y,r=e._z,o=e._w,a=i._x,l=i._y,u=i._z,c=i._w;return this._x=s*c+o*a+n*u-r*l,this._y=n*c+o*l+r*a-s*u,this._z=r*c+o*u+s*l-n*a,this._w=o*c-s*a-n*l-r*u,this._onChangeCallback(),this}slerp(e,i){if(i===0)return this;if(i===1)return this.copy(e);const s=this._x,n=this._y,r=this._z,o=this._w;let a=o*e._w+s*e._x+n*e._y+r*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=s,this._y=n,this._z=r,this;const l=1-a*a;if(l<=Number.EPSILON){const m=1-i;return this._w=m*o+i*this._w,this._x=m*s+i*this._x,this._y=m*n+i*this._y,this._z=m*r+i*this._z,this.normalize(),this}const u=Math.sqrt(l),c=Math.atan2(u,a),h=Math.sin((1-i)*c)/u,d=Math.sin(i*c)/u;return this._w=o*h+this._w*d,this._x=s*h+this._x*d,this._y=n*h+this._y*d,this._z=r*h+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,i,s){return this.copy(e).slerp(i,s)}random(){const e=2*Math.PI*Math.random(),i=2*Math.PI*Math.random(),s=Math.random(),n=Math.sqrt(1-s),r=Math.sqrt(s);return this.set(n*Math.sin(e),n*Math.cos(e),r*Math.sin(i),r*Math.cos(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,i=0){return this._x=e[i],this._y=e[i+1],this._z=e[i+2],this._w=e[i+3],this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._w,e}fromBufferAttribute(e,i){return this._x=e.getX(i),this._y=e.getY(i),this._z=e.getZ(i),this._w=e.getW(i),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ze{constructor(e=0,i=0,s=0){ze.prototype.isVector3=!0,this.x=e,this.y=i,this.z=s}set(e,i,s){return s===void 0&&(s=this.z),this.x=e,this.y=i,this.z=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,i){return this.x=e.x*i.x,this.y=e.y*i.y,this.z=e.z*i.z,this}applyEuler(e){return this.applyQuaternion(Hte.setFromEuler(e))}applyAxisAngle(e,i){return this.applyQuaternion(Hte.setFromAxisAngle(e,i))}applyMatrix3(e){const i=this.x,s=this.y,n=this.z,r=e.elements;return this.x=r[0]*i+r[3]*s+r[6]*n,this.y=r[1]*i+r[4]*s+r[7]*n,this.z=r[2]*i+r[5]*s+r[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const i=this.x,s=this.y,n=this.z,r=e.elements,o=1/(r[3]*i+r[7]*s+r[11]*n+r[15]);return this.x=(r[0]*i+r[4]*s+r[8]*n+r[12])*o,this.y=(r[1]*i+r[5]*s+r[9]*n+r[13])*o,this.z=(r[2]*i+r[6]*s+r[10]*n+r[14])*o,this}applyQuaternion(e){const i=this.x,s=this.y,n=this.z,r=e.x,o=e.y,a=e.z,l=e.w,u=2*(o*n-a*s),c=2*(a*i-r*n),h=2*(r*s-o*i);return this.x=i+l*u+o*h-a*c,this.y=s+l*c+a*u-r*h,this.z=n+l*h+r*c-o*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const i=this.x,s=this.y,n=this.z,r=e.elements;return this.x=r[0]*i+r[4]*s+r[8]*n,this.y=r[1]*i+r[5]*s+r[9]*n,this.z=r[2]*i+r[6]*s+r[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,i){return this.x=Cs(this.x,e.x,i.x),this.y=Cs(this.y,e.y,i.y),this.z=Cs(this.z,e.z,i.z),this}clampScalar(e,i){return this.x=Cs(this.x,e,i),this.y=Cs(this.y,e,i),this.z=Cs(this.z,e,i),this}clampLength(e,i){const s=this.length();return this.divideScalar(s||1).multiplyScalar(Cs(s,e,i))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this}lerpVectors(e,i,s){return this.x=e.x+(i.x-e.x)*s,this.y=e.y+(i.y-e.y)*s,this.z=e.z+(i.z-e.z)*s,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,i){const s=e.x,n=e.y,r=e.z,o=i.x,a=i.y,l=i.z;return this.x=n*l-r*a,this.y=r*o-s*l,this.z=s*a-n*o,this}projectOnVector(e){const i=e.lengthSq();if(i===0)return this.set(0,0,0);const s=e.dot(this)/i;return this.copy(e).multiplyScalar(s)}projectOnPlane(e){return p5.copy(this).projectOnVector(e),this.sub(p5)}reflect(e){return this.sub(p5.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;const s=this.dot(e)/i;return Math.acos(Cs(s,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,s=this.y-e.y,n=this.z-e.z;return i*i+s*s+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,i,s){const n=Math.sin(i)*e;return this.x=n*Math.sin(s),this.y=Math.cos(i)*e,this.z=n*Math.cos(s),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,i,s){return this.x=e*Math.sin(i),this.y=s,this.z=e*Math.cos(i),this}setFromMatrixPosition(e){const i=e.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this}setFromMatrixScale(e){const i=this.setFromMatrixColumn(e,0).length(),s=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=i,this.y=s,this.z=n,this}setFromMatrixColumn(e,i){return this.fromArray(e.elements,i*4)}setFromMatrix3Column(e,i){return this.fromArray(e.elements,i*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,i=Math.random()*2-1,s=Math.sqrt(1-i*i);return this.x=s*Math.cos(e),this.y=i,this.z=s*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const p5=new ze,Hte=new N1;class xA{constructor(e=new ze(1/0,1/0,1/0),i=new ze(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=i}set(e,i){return this.min.copy(e),this.max.copy(i),this}setFromArray(e){this.makeEmpty();for(let i=0,s=e.length;i<s;i+=3)this.expandByPoint(Ih.fromArray(e,i));return this}setFromBufferAttribute(e){this.makeEmpty();for(let i=0,s=e.count;i<s;i++)this.expandByPoint(Ih.fromBufferAttribute(e,i));return this}setFromPoints(e){this.makeEmpty();for(let i=0,s=e.length;i<s;i++)this.expandByPoint(e[i]);return this}setFromCenterAndSize(e,i){const s=Ih.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(s),this.max.copy(e).add(s),this}setFromObject(e,i=!1){return this.makeEmpty(),this.expandByObject(e,i)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,i=!1){e.updateWorldMatrix(!1,!1);const s=e.geometry;if(s!==void 0){const r=s.getAttribute("position");if(i===!0&&r!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=r.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,Ih):Ih.fromBufferAttribute(r,o),Ih.applyMatrix4(e.matrixWorld),this.expandByPoint(Ih);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),oN.copy(e.boundingBox)):(s.boundingBox===null&&s.computeBoundingBox(),oN.copy(s.boundingBox)),oN.applyMatrix4(e.matrixWorld),this.union(oN)}const n=e.children;for(let r=0,o=n.length;r<o;r++)this.expandByObject(n[r],i);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,i){return i.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Ih),Ih.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let i,s;return e.normal.x>0?(i=e.normal.x*this.min.x,s=e.normal.x*this.max.x):(i=e.normal.x*this.max.x,s=e.normal.x*this.min.x),e.normal.y>0?(i+=e.normal.y*this.min.y,s+=e.normal.y*this.max.y):(i+=e.normal.y*this.max.y,s+=e.normal.y*this.min.y),e.normal.z>0?(i+=e.normal.z*this.min.z,s+=e.normal.z*this.max.z):(i+=e.normal.z*this.max.z,s+=e.normal.z*this.min.z),i<=-e.constant&&s>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(G2),aN.subVectors(this.max,G2),Hx.subVectors(e.a,G2),jx.subVectors(e.b,G2),Yx.subVectors(e.c,G2),Bg.subVectors(jx,Hx),qg.subVectors(Yx,jx),w0.subVectors(Hx,Yx);let i=[0,-Bg.z,Bg.y,0,-qg.z,qg.y,0,-w0.z,w0.y,Bg.z,0,-Bg.x,qg.z,0,-qg.x,w0.z,0,-w0.x,-Bg.y,Bg.x,0,-qg.y,qg.x,0,-w0.y,w0.x,0];return!f5(i,Hx,jx,Yx,aN)||(i=[1,0,0,0,1,0,0,0,1],!f5(i,Hx,jx,Yx,aN))?!1:(lN.crossVectors(Bg,qg),i=[lN.x,lN.y,lN.z],f5(i,Hx,jx,Yx,aN))}clampPoint(e,i){return i.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Ih).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Ih).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Ep[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Ep[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Ep[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Ep[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Ep[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Ep[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Ep[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Ep[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Ep),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Ep=[new ze,new ze,new ze,new ze,new ze,new ze,new ze,new ze],Ih=new ze,oN=new xA,Hx=new ze,jx=new ze,Yx=new ze,Bg=new ze,qg=new ze,w0=new ze,G2=new ze,aN=new ze,lN=new ze,S0=new ze;function f5(t,e,i,s,n){for(let r=0,o=t.length-3;r<=o;r+=3){S0.fromArray(t,r);const a=n.x*Math.abs(S0.x)+n.y*Math.abs(S0.y)+n.z*Math.abs(S0.z),l=e.dot(S0),u=i.dot(S0),c=s.dot(S0);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>a)return!1}return!0}const OBe=new xA,B2=new ze,g5=new ze;class eY{constructor(e=new ze,i=-1){this.isSphere=!0,this.center=e,this.radius=i}set(e,i){return this.center.copy(e),this.radius=i,this}setFromPoints(e,i){const s=this.center;i!==void 0?s.copy(i):OBe.setFromPoints(e).getCenter(s);let n=0;for(let r=0,o=e.length;r<o;r++)n=Math.max(n,s.distanceToSquared(e[r]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const i=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=i*i}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,i){const s=this.center.distanceToSquared(e);return i.copy(e),s>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;B2.subVectors(e,this.center);const i=B2.lengthSq();if(i>this.radius*this.radius){const s=Math.sqrt(i),n=(s-this.radius)*.5;this.center.addScaledVector(B2,n/s),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(g5.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(B2.copy(e.center).add(g5)),this.expandByPoint(B2.copy(e.center).sub(g5))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Cp=new ze,_5=new ze,uN=new ze,Hg=new ze,y5=new ze,cN=new ze,v5=new ze;class cye{constructor(e=new ze,i=new ze(0,0,-1)){this.origin=e,this.direction=i}set(e,i){return this.origin.copy(e),this.direction.copy(i),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,i){return i.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Cp)),this}closestPointToPoint(e,i){i.subVectors(e,this.origin);const s=i.dot(this.direction);return s<0?i.copy(this.origin):i.copy(this.origin).addScaledVector(this.direction,s)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const i=Cp.subVectors(e,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(e):(Cp.copy(this.origin).addScaledVector(this.direction,i),Cp.distanceToSquared(e))}distanceSqToSegment(e,i,s,n){_5.copy(e).add(i).multiplyScalar(.5),uN.copy(i).sub(e).normalize(),Hg.copy(this.origin).sub(_5);const r=e.distanceTo(i)*.5,o=-this.direction.dot(uN),a=Hg.dot(this.direction),l=-Hg.dot(uN),u=Hg.lengthSq(),c=Math.abs(1-o*o);let h,d,m,f;if(c>0)if(h=o*l-a,d=o*a-l,f=r*c,h>=0)if(d>=-f)if(d<=f){const _=1/c;h*=_,d*=_,m=h*(h+o*d+2*a)+d*(o*h+d+2*l)+u}else d=r,h=Math.max(0,-(o*d+a)),m=-h*h+d*(d+2*l)+u;else d=-r,h=Math.max(0,-(o*d+a)),m=-h*h+d*(d+2*l)+u;else d<=-f?(h=Math.max(0,-(-o*r+a)),d=h>0?-r:Math.min(Math.max(-r,-l),r),m=-h*h+d*(d+2*l)+u):d<=f?(h=0,d=Math.min(Math.max(-r,-l),r),m=d*(d+2*l)+u):(h=Math.max(0,-(o*r+a)),d=h>0?r:Math.min(Math.max(-r,-l),r),m=-h*h+d*(d+2*l)+u);else d=o>0?-r:r,h=Math.max(0,-(o*d+a)),m=-h*h+d*(d+2*l)+u;return s&&s.copy(this.origin).addScaledVector(this.direction,h),n&&n.copy(_5).addScaledVector(uN,d),m}intersectSphere(e,i){Cp.subVectors(e.center,this.origin);const s=Cp.dot(this.direction),n=Cp.dot(Cp)-s*s,r=e.radius*e.radius;if(n>r)return null;const o=Math.sqrt(r-n),a=s-o,l=s+o;return l<0?null:a<0?this.at(l,i):this.at(a,i)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const i=e.normal.dot(this.direction);if(i===0)return e.distanceToPoint(this.origin)===0?0:null;const s=-(this.origin.dot(e.normal)+e.constant)/i;return s>=0?s:null}intersectPlane(e,i){const s=this.distanceToPlane(e);return s===null?null:this.at(s,i)}intersectsPlane(e){const i=e.distanceToPoint(this.origin);return i===0||e.normal.dot(this.direction)*i<0}intersectBox(e,i){let s,n,r,o,a,l;const u=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,d=this.origin;return u>=0?(s=(e.min.x-d.x)*u,n=(e.max.x-d.x)*u):(s=(e.max.x-d.x)*u,n=(e.min.x-d.x)*u),c>=0?(r=(e.min.y-d.y)*c,o=(e.max.y-d.y)*c):(r=(e.max.y-d.y)*c,o=(e.min.y-d.y)*c),s>o||r>n||((r>s||isNaN(s))&&(s=r),(o<n||isNaN(n))&&(n=o),h>=0?(a=(e.min.z-d.z)*h,l=(e.max.z-d.z)*h):(a=(e.max.z-d.z)*h,l=(e.min.z-d.z)*h),s>l||a>n)||((a>s||s!==s)&&(s=a),(l<n||n!==n)&&(n=l),n<0)?null:this.at(s>=0?s:n,i)}intersectsBox(e){return this.intersectBox(e,Cp)!==null}intersectTriangle(e,i,s,n,r){y5.subVectors(i,e),cN.subVectors(s,e),v5.crossVectors(y5,cN);let o=this.direction.dot(v5),a;if(o>0){if(n)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Hg.subVectors(this.origin,e);const l=a*this.direction.dot(cN.crossVectors(Hg,cN));if(l<0)return null;const u=a*this.direction.dot(y5.cross(Hg));if(u<0||l+u>o)return null;const c=-a*Hg.dot(v5);return c<0?null:this.at(c/o,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Gr{constructor(e,i,s,n,r,o,a,l,u,c,h,d,m,f,_,v){Gr.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,i,s,n,r,o,a,l,u,c,h,d,m,f,_,v)}set(e,i,s,n,r,o,a,l,u,c,h,d,m,f,_,v){const x=this.elements;return x[0]=e,x[4]=i,x[8]=s,x[12]=n,x[1]=r,x[5]=o,x[9]=a,x[13]=l,x[2]=u,x[6]=c,x[10]=h,x[14]=d,x[3]=m,x[7]=f,x[11]=_,x[15]=v,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Gr().fromArray(this.elements)}copy(e){const i=this.elements,s=e.elements;return i[0]=s[0],i[1]=s[1],i[2]=s[2],i[3]=s[3],i[4]=s[4],i[5]=s[5],i[6]=s[6],i[7]=s[7],i[8]=s[8],i[9]=s[9],i[10]=s[10],i[11]=s[11],i[12]=s[12],i[13]=s[13],i[14]=s[14],i[15]=s[15],this}copyPosition(e){const i=this.elements,s=e.elements;return i[12]=s[12],i[13]=s[13],i[14]=s[14],this}setFromMatrix3(e){const i=e.elements;return this.set(i[0],i[3],i[6],0,i[1],i[4],i[7],0,i[2],i[5],i[8],0,0,0,0,1),this}extractBasis(e,i,s){return e.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),s.setFromMatrixColumn(this,2),this}makeBasis(e,i,s){return this.set(e.x,i.x,s.x,0,e.y,i.y,s.y,0,e.z,i.z,s.z,0,0,0,0,1),this}extractRotation(e){const i=this.elements,s=e.elements,n=1/Xx.setFromMatrixColumn(e,0).length(),r=1/Xx.setFromMatrixColumn(e,1).length(),o=1/Xx.setFromMatrixColumn(e,2).length();return i[0]=s[0]*n,i[1]=s[1]*n,i[2]=s[2]*n,i[3]=0,i[4]=s[4]*r,i[5]=s[5]*r,i[6]=s[6]*r,i[7]=0,i[8]=s[8]*o,i[9]=s[9]*o,i[10]=s[10]*o,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromEuler(e){const i=this.elements,s=e.x,n=e.y,r=e.z,o=Math.cos(s),a=Math.sin(s),l=Math.cos(n),u=Math.sin(n),c=Math.cos(r),h=Math.sin(r);if(e.order==="XYZ"){const d=o*c,m=o*h,f=a*c,_=a*h;i[0]=l*c,i[4]=-l*h,i[8]=u,i[1]=m+f*u,i[5]=d-_*u,i[9]=-a*l,i[2]=_-d*u,i[6]=f+m*u,i[10]=o*l}else if(e.order==="YXZ"){const d=l*c,m=l*h,f=u*c,_=u*h;i[0]=d+_*a,i[4]=f*a-m,i[8]=o*u,i[1]=o*h,i[5]=o*c,i[9]=-a,i[2]=m*a-f,i[6]=_+d*a,i[10]=o*l}else if(e.order==="ZXY"){const d=l*c,m=l*h,f=u*c,_=u*h;i[0]=d-_*a,i[4]=-o*h,i[8]=f+m*a,i[1]=m+f*a,i[5]=o*c,i[9]=_-d*a,i[2]=-o*u,i[6]=a,i[10]=o*l}else if(e.order==="ZYX"){const d=o*c,m=o*h,f=a*c,_=a*h;i[0]=l*c,i[4]=f*u-m,i[8]=d*u+_,i[1]=l*h,i[5]=_*u+d,i[9]=m*u-f,i[2]=-u,i[6]=a*l,i[10]=o*l}else if(e.order==="YZX"){const d=o*l,m=o*u,f=a*l,_=a*u;i[0]=l*c,i[4]=_-d*h,i[8]=f*h+m,i[1]=h,i[5]=o*c,i[9]=-a*c,i[2]=-u*c,i[6]=m*h+f,i[10]=d-_*h}else if(e.order==="XZY"){const d=o*l,m=o*u,f=a*l,_=a*u;i[0]=l*c,i[4]=-h,i[8]=u*c,i[1]=d*h+_,i[5]=o*c,i[9]=m*h-f,i[2]=f*h-m,i[6]=a*c,i[10]=_*h+d}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromQuaternion(e){return this.compose(LBe,e,FBe)}lookAt(e,i,s){const n=this.elements;return Uu.subVectors(e,i),Uu.lengthSq()===0&&(Uu.z=1),Uu.normalize(),jg.crossVectors(s,Uu),jg.lengthSq()===0&&(Math.abs(s.z)===1?Uu.x+=1e-4:Uu.z+=1e-4,Uu.normalize(),jg.crossVectors(s,Uu)),jg.normalize(),hN.crossVectors(Uu,jg),n[0]=jg.x,n[4]=hN.x,n[8]=Uu.x,n[1]=jg.y,n[5]=hN.y,n[9]=Uu.y,n[2]=jg.z,n[6]=hN.z,n[10]=Uu.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const s=e.elements,n=i.elements,r=this.elements,o=s[0],a=s[4],l=s[8],u=s[12],c=s[1],h=s[5],d=s[9],m=s[13],f=s[2],_=s[6],v=s[10],x=s[14],w=s[3],T=s[7],C=s[11],M=s[15],A=n[0],I=n[4],L=n[8],D=n[12],O=n[1],U=n[5],$=n[9],B=n[13],V=n[2],H=n[6],Y=n[10],W=n[14],ee=n[3],ne=n[7],j=n[11],oe=n[15];return r[0]=o*A+a*O+l*V+u*ee,r[4]=o*I+a*U+l*H+u*ne,r[8]=o*L+a*$+l*Y+u*j,r[12]=o*D+a*B+l*W+u*oe,r[1]=c*A+h*O+d*V+m*ee,r[5]=c*I+h*U+d*H+m*ne,r[9]=c*L+h*$+d*Y+m*j,r[13]=c*D+h*B+d*W+m*oe,r[2]=f*A+_*O+v*V+x*ee,r[6]=f*I+_*U+v*H+x*ne,r[10]=f*L+_*$+v*Y+x*j,r[14]=f*D+_*B+v*W+x*oe,r[3]=w*A+T*O+C*V+M*ee,r[7]=w*I+T*U+C*H+M*ne,r[11]=w*L+T*$+C*Y+M*j,r[15]=w*D+T*B+C*W+M*oe,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[4]*=e,i[8]*=e,i[12]*=e,i[1]*=e,i[5]*=e,i[9]*=e,i[13]*=e,i[2]*=e,i[6]*=e,i[10]*=e,i[14]*=e,i[3]*=e,i[7]*=e,i[11]*=e,i[15]*=e,this}determinant(){const e=this.elements,i=e[0],s=e[4],n=e[8],r=e[12],o=e[1],a=e[5],l=e[9],u=e[13],c=e[2],h=e[6],d=e[10],m=e[14],f=e[3],_=e[7],v=e[11],x=e[15];return f*(+r*l*h-n*u*h-r*a*d+s*u*d+n*a*m-s*l*m)+_*(+i*l*m-i*u*d+r*o*d-n*o*m+n*u*c-r*l*c)+v*(+i*u*h-i*a*m-r*o*h+s*o*m+r*a*c-s*u*c)+x*(-n*a*c-i*l*h+i*a*d+n*o*h-s*o*d+s*l*c)}transpose(){const e=this.elements;let i;return i=e[1],e[1]=e[4],e[4]=i,i=e[2],e[2]=e[8],e[8]=i,i=e[6],e[6]=e[9],e[9]=i,i=e[3],e[3]=e[12],e[12]=i,i=e[7],e[7]=e[13],e[13]=i,i=e[11],e[11]=e[14],e[14]=i,this}setPosition(e,i,s){const n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=i,n[14]=s),this}invert(){const e=this.elements,i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],m=e[11],f=e[12],_=e[13],v=e[14],x=e[15],w=h*v*u-_*d*u+_*l*m-a*v*m-h*l*x+a*d*x,T=f*d*u-c*v*u-f*l*m+o*v*m+c*l*x-o*d*x,C=c*_*u-f*h*u+f*a*m-o*_*m-c*a*x+o*h*x,M=f*h*l-c*_*l-f*a*d+o*_*d+c*a*v-o*h*v,A=i*w+s*T+n*C+r*M;if(A===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const I=1/A;return e[0]=w*I,e[1]=(_*d*r-h*v*r-_*n*m+s*v*m+h*n*x-s*d*x)*I,e[2]=(a*v*r-_*l*r+_*n*u-s*v*u-a*n*x+s*l*x)*I,e[3]=(h*l*r-a*d*r-h*n*u+s*d*u+a*n*m-s*l*m)*I,e[4]=T*I,e[5]=(c*v*r-f*d*r+f*n*m-i*v*m-c*n*x+i*d*x)*I,e[6]=(f*l*r-o*v*r-f*n*u+i*v*u+o*n*x-i*l*x)*I,e[7]=(o*d*r-c*l*r+c*n*u-i*d*u-o*n*m+i*l*m)*I,e[8]=C*I,e[9]=(f*h*r-c*_*r-f*s*m+i*_*m+c*s*x-i*h*x)*I,e[10]=(o*_*r-f*a*r+f*s*u-i*_*u-o*s*x+i*a*x)*I,e[11]=(c*a*r-o*h*r-c*s*u+i*h*u+o*s*m-i*a*m)*I,e[12]=M*I,e[13]=(c*_*n-f*h*n+f*s*d-i*_*d-c*s*v+i*h*v)*I,e[14]=(f*a*n-o*_*n-f*s*l+i*_*l+o*s*v-i*a*v)*I,e[15]=(o*h*n-c*a*n+c*s*l-i*h*l-o*s*d+i*a*d)*I,this}scale(e){const i=this.elements,s=e.x,n=e.y,r=e.z;return i[0]*=s,i[4]*=n,i[8]*=r,i[1]*=s,i[5]*=n,i[9]*=r,i[2]*=s,i[6]*=n,i[10]*=r,i[3]*=s,i[7]*=n,i[11]*=r,this}getMaxScaleOnAxis(){const e=this.elements,i=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],s=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(i,s,n))}makeTranslation(e,i,s){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,i,0,0,1,s,0,0,0,1),this}makeRotationX(e){const i=Math.cos(e),s=Math.sin(e);return this.set(1,0,0,0,0,i,-s,0,0,s,i,0,0,0,0,1),this}makeRotationY(e){const i=Math.cos(e),s=Math.sin(e);return this.set(i,0,s,0,0,1,0,0,-s,0,i,0,0,0,0,1),this}makeRotationZ(e){const i=Math.cos(e),s=Math.sin(e);return this.set(i,-s,0,0,s,i,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,i){const s=Math.cos(i),n=Math.sin(i),r=1-s,o=e.x,a=e.y,l=e.z,u=r*o,c=r*a;return this.set(u*o+s,u*a-n*l,u*l+n*a,0,u*a+n*l,c*a+s,c*l-n*o,0,u*l-n*a,c*l+n*o,r*l*l+s,0,0,0,0,1),this}makeScale(e,i,s){return this.set(e,0,0,0,0,i,0,0,0,0,s,0,0,0,0,1),this}makeShear(e,i,s,n,r,o){return this.set(1,s,r,0,e,1,o,0,i,n,1,0,0,0,0,1),this}compose(e,i,s){const n=this.elements,r=i._x,o=i._y,a=i._z,l=i._w,u=r+r,c=o+o,h=a+a,d=r*u,m=r*c,f=r*h,_=o*c,v=o*h,x=a*h,w=l*u,T=l*c,C=l*h,M=s.x,A=s.y,I=s.z;return n[0]=(1-(_+x))*M,n[1]=(m+C)*M,n[2]=(f-T)*M,n[3]=0,n[4]=(m-C)*A,n[5]=(1-(d+x))*A,n[6]=(v+w)*A,n[7]=0,n[8]=(f+T)*I,n[9]=(v-w)*I,n[10]=(1-(d+_))*I,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,i,s){const n=this.elements;let r=Xx.set(n[0],n[1],n[2]).length();const o=Xx.set(n[4],n[5],n[6]).length(),a=Xx.set(n[8],n[9],n[10]).length();this.determinant()<0&&(r=-r),e.x=n[12],e.y=n[13],e.z=n[14],Dh.copy(this);const u=1/r,c=1/o,h=1/a;return Dh.elements[0]*=u,Dh.elements[1]*=u,Dh.elements[2]*=u,Dh.elements[4]*=c,Dh.elements[5]*=c,Dh.elements[6]*=c,Dh.elements[8]*=h,Dh.elements[9]*=h,Dh.elements[10]*=h,i.setFromRotationMatrix(Dh),s.x=r,s.y=o,s.z=a,this}makePerspective(e,i,s,n,r,o,a=Sf){const l=this.elements,u=2*r/(i-e),c=2*r/(s-n),h=(i+e)/(i-e),d=(s+n)/(s-n);let m,f;if(a===Sf)m=-(o+r)/(o-r),f=-2*o*r/(o-r);else if(a===NL)m=-o/(o-r),f=-o*r/(o-r);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return l[0]=u,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=c,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=m,l[14]=f,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,i,s,n,r,o,a=Sf){const l=this.elements,u=1/(i-e),c=1/(s-n),h=1/(o-r),d=(i+e)*u,m=(s+n)*c;let f,_;if(a===Sf)f=(o+r)*h,_=-2*h;else if(a===NL)f=r*h,_=-1*h;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return l[0]=2*u,l[4]=0,l[8]=0,l[12]=-d,l[1]=0,l[5]=2*c,l[9]=0,l[13]=-m,l[2]=0,l[6]=0,l[10]=_,l[14]=-f,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const i=this.elements,s=e.elements;for(let n=0;n<16;n++)if(i[n]!==s[n])return!1;return!0}fromArray(e,i=0){for(let s=0;s<16;s++)this.elements[s]=e[s+i];return this}toArray(e=[],i=0){const s=this.elements;return e[i]=s[0],e[i+1]=s[1],e[i+2]=s[2],e[i+3]=s[3],e[i+4]=s[4],e[i+5]=s[5],e[i+6]=s[6],e[i+7]=s[7],e[i+8]=s[8],e[i+9]=s[9],e[i+10]=s[10],e[i+11]=s[11],e[i+12]=s[12],e[i+13]=s[13],e[i+14]=s[14],e[i+15]=s[15],e}}const Xx=new ze,Dh=new Gr,LBe=new ze(0,0,0),FBe=new ze(1,1,1),jg=new ze,hN=new ze,Uu=new ze,jte=new Gr,Yte=new N1;class zf{constructor(e=0,i=0,s=0,n=zf.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=i,this._z=s,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,i,s,n=this._order){return this._x=e,this._y=i,this._z=s,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,i=this._order,s=!0){const n=e.elements,r=n[0],o=n[4],a=n[8],l=n[1],u=n[5],c=n[9],h=n[2],d=n[6],m=n[10];switch(i){case"XYZ":this._y=Math.asin(Cs(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,m),this._z=Math.atan2(-o,r)):(this._x=Math.atan2(d,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Cs(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,m),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-h,r),this._z=0);break;case"ZXY":this._x=Math.asin(Cs(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-h,m),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,r));break;case"ZYX":this._y=Math.asin(-Cs(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(d,m),this._z=Math.atan2(l,r)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(Cs(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-h,r)):(this._x=0,this._y=Math.atan2(a,m));break;case"XZY":this._z=Math.asin(-Cs(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,u),this._y=Math.atan2(a,r)):(this._x=Math.atan2(-c,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,s===!0&&this._onChangeCallback(),this}setFromQuaternion(e,i,s){return jte.makeRotationFromQuaternion(e),this.setFromRotationMatrix(jte,i,s)}setFromVector3(e,i=this._order){return this.set(e.x,e.y,e.z,i)}reorder(e){return Yte.setFromEuler(this),this.setFromQuaternion(Yte,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}zf.DEFAULT_ORDER="XYZ";class hye{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let kBe=0;const Xte=new ze,Wx=new N1,Tp=new Gr,dN=new ze,q2=new ze,$Be=new ze,UBe=new N1,Wte=new ze(1,0,0),Zte=new ze(0,1,0),Kte=new ze(0,0,1),Qte={type:"added"},VBe={type:"removed"},Zx={type:"childadded",child:null},x5={type:"childremoved",child:null};class rl extends j1{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:kBe++}),this.uuid=vA(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=rl.DEFAULT_UP.clone();const e=new ze,i=new zf,s=new N1,n=new ze(1,1,1);function r(){s.setFromEuler(i,!1)}function o(){i.setFromQuaternion(s,void 0,!1)}i._onChange(r),s._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:s},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new Gr},normalMatrix:{value:new cs}}),this.matrix=new Gr,this.matrixWorld=new Gr,this.matrixAutoUpdate=rl.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=rl.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new hye,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,i){this.quaternion.setFromAxisAngle(e,i)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,i){return Wx.setFromAxisAngle(e,i),this.quaternion.multiply(Wx),this}rotateOnWorldAxis(e,i){return Wx.setFromAxisAngle(e,i),this.quaternion.premultiply(Wx),this}rotateX(e){return this.rotateOnAxis(Wte,e)}rotateY(e){return this.rotateOnAxis(Zte,e)}rotateZ(e){return this.rotateOnAxis(Kte,e)}translateOnAxis(e,i){return Xte.copy(e).applyQuaternion(this.quaternion),this.position.add(Xte.multiplyScalar(i)),this}translateX(e){return this.translateOnAxis(Wte,e)}translateY(e){return this.translateOnAxis(Zte,e)}translateZ(e){return this.translateOnAxis(Kte,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Tp.copy(this.matrixWorld).invert())}lookAt(e,i,s){e.isVector3?dN.copy(e):dN.set(e,i,s);const n=this.parent;this.updateWorldMatrix(!0,!1),q2.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Tp.lookAt(q2,dN,this.up):Tp.lookAt(dN,q2,this.up),this.quaternion.setFromRotationMatrix(Tp),n&&(Tp.extractRotation(n.matrixWorld),Wx.setFromRotationMatrix(Tp),this.quaternion.premultiply(Wx.invert()))}add(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(Qte),Zx.child=e,this.dispatchEvent(Zx),Zx.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.remove(arguments[s]);return this}const i=this.children.indexOf(e);return i!==-1&&(e.parent=null,this.children.splice(i,1),e.dispatchEvent(VBe),x5.child=e,this.dispatchEvent(x5),x5.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Tp.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Tp.multiply(e.parent.matrixWorld)),e.applyMatrix4(Tp),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(Qte),Zx.child=e,this.dispatchEvent(Zx),Zx.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,i){if(this[e]===i)return this;for(let s=0,n=this.children.length;s<n;s++){const o=this.children[s].getObjectByProperty(e,i);if(o!==void 0)return o}}getObjectsByProperty(e,i,s=[]){this[e]===i&&s.push(this);const n=this.children;for(let r=0,o=n.length;r<o;r++)n[r].getObjectsByProperty(e,i,s);return s}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(q2,e,$Be),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(q2,UBe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return e.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(e){e(this);const i=this.children;for(let s=0,n=i.length;s<n;s++)i[s].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const i=this.children;for(let s=0,n=i.length;s<n;s++)i[s].traverseVisible(e)}traverseAncestors(e){const i=this.parent;i!==null&&(e(i),i.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const i=this.children;for(let s=0,n=i.length;s<n;s++)i[s].updateMatrixWorld(e)}updateWorldMatrix(e,i){const s=this.parent;if(e===!0&&s!==null&&s.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),i===!0){const n=this.children;for(let r=0,o=n.length;r<o;r++)n[r].updateWorldMatrix(!1,!0)}}toJSON(e){const i=e===void 0||typeof e=="string",s={};i&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},s.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),n.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(n.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(n.type="BatchedMesh",n.perObjectFrustumCulled=this.perObjectFrustumCulled,n.sortObjects=this.sortObjects,n.drawRanges=this._drawRanges,n.reservedRanges=this._reservedRanges,n.visibility=this._visibility,n.active=this._active,n.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),n.maxInstanceCount=this._maxInstanceCount,n.maxVertexCount=this._maxVertexCount,n.maxIndexCount=this._maxIndexCount,n.geometryInitialized=this._geometryInitialized,n.geometryCount=this._geometryCount,n.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(n.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(n.boundingSphere={center:n.boundingSphere.center.toArray(),radius:n.boundingSphere.radius}),this.boundingBox!==null&&(n.boundingBox={min:n.boundingBox.min.toArray(),max:n.boundingBox.max.toArray()}));function r(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=r(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let u=0,c=l.length;u<c;u++){const h=l[u];r(e.shapes,h)}else r(e.shapes,l)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(r(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,u=this.material.length;l<u;l++)a.push(r(e.materials,this.material[l]));n.material=a}else n.material=r(e.materials,this.material);if(this.children.length>0){n.children=[];for(let a=0;a<this.children.length;a++)n.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];n.animations.push(r(e.animations,l))}}if(i){const a=o(e.geometries),l=o(e.materials),u=o(e.textures),c=o(e.images),h=o(e.shapes),d=o(e.skeletons),m=o(e.animations),f=o(e.nodes);a.length>0&&(s.geometries=a),l.length>0&&(s.materials=l),u.length>0&&(s.textures=u),c.length>0&&(s.images=c),h.length>0&&(s.shapes=h),d.length>0&&(s.skeletons=d),m.length>0&&(s.animations=m),f.length>0&&(s.nodes=f)}return s.object=n,s;function o(a){const l=[];for(const u in a){const c=a[u];delete c.metadata,l.push(c)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,i=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),i===!0)for(let s=0;s<e.children.length;s++){const n=e.children[s];this.add(n.clone())}return this}}rl.DEFAULT_UP=new ze(0,1,0);rl.DEFAULT_MATRIX_AUTO_UPDATE=!0;rl.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Nh=new ze,Pp=new ze,b5=new ze,Mp=new ze,Kx=new ze,Qx=new ze,Jte=new ze,w5=new ze,S5=new ze,E5=new ze,C5=new zr,T5=new zr,P5=new zr;class ad{constructor(e=new ze,i=new ze,s=new ze){this.a=e,this.b=i,this.c=s}static getNormal(e,i,s,n){n.subVectors(s,i),Nh.subVectors(e,i),n.cross(Nh);const r=n.lengthSq();return r>0?n.multiplyScalar(1/Math.sqrt(r)):n.set(0,0,0)}static getBarycoord(e,i,s,n,r){Nh.subVectors(n,i),Pp.subVectors(s,i),b5.subVectors(e,i);const o=Nh.dot(Nh),a=Nh.dot(Pp),l=Nh.dot(b5),u=Pp.dot(Pp),c=Pp.dot(b5),h=o*u-a*a;if(h===0)return r.set(0,0,0),null;const d=1/h,m=(u*l-a*c)*d,f=(o*c-a*l)*d;return r.set(1-m-f,f,m)}static containsPoint(e,i,s,n){return this.getBarycoord(e,i,s,n,Mp)===null?!1:Mp.x>=0&&Mp.y>=0&&Mp.x+Mp.y<=1}static getInterpolation(e,i,s,n,r,o,a,l){return this.getBarycoord(e,i,s,n,Mp)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(r,Mp.x),l.addScaledVector(o,Mp.y),l.addScaledVector(a,Mp.z),l)}static getInterpolatedAttribute(e,i,s,n,r,o){return C5.setScalar(0),T5.setScalar(0),P5.setScalar(0),C5.fromBufferAttribute(e,i),T5.fromBufferAttribute(e,s),P5.fromBufferAttribute(e,n),o.setScalar(0),o.addScaledVector(C5,r.x),o.addScaledVector(T5,r.y),o.addScaledVector(P5,r.z),o}static isFrontFacing(e,i,s,n){return Nh.subVectors(s,i),Pp.subVectors(e,i),Nh.cross(Pp).dot(n)<0}set(e,i,s){return this.a.copy(e),this.b.copy(i),this.c.copy(s),this}setFromPointsAndIndices(e,i,s,n){return this.a.copy(e[i]),this.b.copy(e[s]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,i,s,n){return this.a.fromBufferAttribute(e,i),this.b.fromBufferAttribute(e,s),this.c.fromBufferAttribute(e,n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Nh.subVectors(this.c,this.b),Pp.subVectors(this.a,this.b),Nh.cross(Pp).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return ad.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,i){return ad.getBarycoord(e,this.a,this.b,this.c,i)}getInterpolation(e,i,s,n,r){return ad.getInterpolation(e,this.a,this.b,this.c,i,s,n,r)}containsPoint(e){return ad.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return ad.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,i){const s=this.a,n=this.b,r=this.c;let o,a;Kx.subVectors(n,s),Qx.subVectors(r,s),w5.subVectors(e,s);const l=Kx.dot(w5),u=Qx.dot(w5);if(l<=0&&u<=0)return i.copy(s);S5.subVectors(e,n);const c=Kx.dot(S5),h=Qx.dot(S5);if(c>=0&&h<=c)return i.copy(n);const d=l*h-c*u;if(d<=0&&l>=0&&c<=0)return o=l/(l-c),i.copy(s).addScaledVector(Kx,o);E5.subVectors(e,r);const m=Kx.dot(E5),f=Qx.dot(E5);if(f>=0&&m<=f)return i.copy(r);const _=m*u-l*f;if(_<=0&&u>=0&&f<=0)return a=u/(u-f),i.copy(s).addScaledVector(Qx,a);const v=c*f-m*h;if(v<=0&&h-c>=0&&m-f>=0)return Jte.subVectors(r,n),a=(h-c)/(h-c+(m-f)),i.copy(n).addScaledVector(Jte,a);const x=1/(v+_+d);return o=_*x,a=d*x,i.copy(s).addScaledVector(Kx,o).addScaledVector(Qx,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const dye={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Yg={h:0,s:0,l:0},mN={h:0,s:0,l:0};function M5(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+(e-t)*6*i:i<1/2?e:i<2/3?t+(e-t)*6*(2/3-i):t}class bn{constructor(e,i,s){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,i,s)}set(e,i,s){if(i===void 0&&s===void 0){const n=e;n&&n.isColor?this.copy(n):typeof n=="number"?this.setHex(n):typeof n=="string"&&this.setStyle(n)}else this.setRGB(e,i,s);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,i=Hc){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Zs.toWorkingColorSpace(this,i),this}setRGB(e,i,s,n=Zs.workingColorSpace){return this.r=e,this.g=i,this.b=s,Zs.toWorkingColorSpace(this,n),this}setHSL(e,i,s,n=Zs.workingColorSpace){if(e=wBe(e,1),i=Cs(i,0,1),s=Cs(s,0,1),i===0)this.r=this.g=this.b=s;else{const r=s<=.5?s*(1+i):s+i-s*i,o=2*s-r;this.r=M5(o,r,e+1/3),this.g=M5(o,r,e),this.b=M5(o,r,e-1/3)}return Zs.toWorkingColorSpace(this,n),this}setStyle(e,i=Hc){function s(r){r!==void 0&&parseFloat(r)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^(\w+)\(([^\)]*)\)/.exec(e)){let r;const o=n[1],a=n[2];switch(o){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return s(r[4]),this.setRGB(Math.min(255,parseInt(r[1],10))/255,Math.min(255,parseInt(r[2],10))/255,Math.min(255,parseInt(r[3],10))/255,i);if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return s(r[4]),this.setRGB(Math.min(100,parseInt(r[1],10))/100,Math.min(100,parseInt(r[2],10))/100,Math.min(100,parseInt(r[3],10))/100,i);break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return s(r[4]),this.setHSL(parseFloat(r[1])/360,parseFloat(r[2])/100,parseFloat(r[3])/100,i);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){const r=n[1],o=r.length;if(o===3)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,i);if(o===6)return this.setHex(parseInt(r,16),i);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,i);return this}setColorName(e,i=Hc){const s=dye[e.toLowerCase()];return s!==void 0?this.setHex(s,i):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Tf(e.r),this.g=Tf(e.g),this.b=Tf(e.b),this}copyLinearToSRGB(e){return this.r=Ow(e.r),this.g=Ow(e.g),this.b=Ow(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Hc){return Zs.fromWorkingColorSpace(za.copy(this),e),Math.round(Cs(za.r*255,0,255))*65536+Math.round(Cs(za.g*255,0,255))*256+Math.round(Cs(za.b*255,0,255))}getHexString(e=Hc){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,i=Zs.workingColorSpace){Zs.fromWorkingColorSpace(za.copy(this),i);const s=za.r,n=za.g,r=za.b,o=Math.max(s,n,r),a=Math.min(s,n,r);let l,u;const c=(a+o)/2;if(a===o)l=0,u=0;else{const h=o-a;switch(u=c<=.5?h/(o+a):h/(2-o-a),o){case s:l=(n-r)/h+(n<r?6:0);break;case n:l=(r-s)/h+2;break;case r:l=(s-n)/h+4;break}l/=6}return e.h=l,e.s=u,e.l=c,e}getRGB(e,i=Zs.workingColorSpace){return Zs.fromWorkingColorSpace(za.copy(this),i),e.r=za.r,e.g=za.g,e.b=za.b,e}getStyle(e=Hc){Zs.fromWorkingColorSpace(za.copy(this),e);const i=za.r,s=za.g,n=za.b;return e!==Hc?`color(${e} ${i.toFixed(3)} ${s.toFixed(3)} ${n.toFixed(3)})`:`rgb(${Math.round(i*255)},${Math.round(s*255)},${Math.round(n*255)})`}offsetHSL(e,i,s){return this.getHSL(Yg),this.setHSL(Yg.h+e,Yg.s+i,Yg.l+s)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,i){return this.r=e.r+i.r,this.g=e.g+i.g,this.b=e.b+i.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,i){return this.r+=(e.r-this.r)*i,this.g+=(e.g-this.g)*i,this.b+=(e.b-this.b)*i,this}lerpColors(e,i,s){return this.r=e.r+(i.r-e.r)*s,this.g=e.g+(i.g-e.g)*s,this.b=e.b+(i.b-e.b)*s,this}lerpHSL(e,i){this.getHSL(Yg),e.getHSL(mN);const s=h5(Yg.h,mN.h,i),n=h5(Yg.s,mN.s,i),r=h5(Yg.l,mN.l,i);return this.setHSL(s,n,r),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const i=this.r,s=this.g,n=this.b,r=e.elements;return this.r=r[0]*i+r[3]*s+r[6]*n,this.g=r[1]*i+r[4]*s+r[7]*n,this.b=r[2]*i+r[5]*s+r[8]*n,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,i=0){return this.r=e[i],this.g=e[i+1],this.b=e[i+2],this}toArray(e=[],i=0){return e[i]=this.r,e[i+1]=this.g,e[i+2]=this.b,e}fromBufferAttribute(e,i){return this.r=e.getX(i),this.g=e.getY(i),this.b=e.getZ(i),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const za=new bn;bn.NAMES=dye;let zBe=0;class U4 extends j1{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:zBe++}),this.uuid=vA(),this.name="",this.type="Material",this.blending=Rw,this.side=Cy,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=zB,this.blendDst=GB,this.blendEquation=Mv,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new bn(0,0,0),this.blendAlpha=0,this.depthFunc=SS,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Ute,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Bx,this.stencilZFail=Bx,this.stencilZPass=Bx,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const i in e){const s=e[i];if(s===void 0){console.warn(`THREE.Material: parameter '${i}' has value of undefined.`);continue}const n=this[i];if(n===void 0){console.warn(`THREE.Material: '${i}' is not a property of THREE.${this.type}.`);continue}n&&n.isColor?n.set(s):n&&n.isVector3&&s&&s.isVector3?n.copy(s):this[i]=s}}toJSON(e){const i=e===void 0||typeof e=="string";i&&(e={textures:{},images:{}});const s={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.color&&this.color.isColor&&(s.color=this.color.getHex()),this.roughness!==void 0&&(s.roughness=this.roughness),this.metalness!==void 0&&(s.metalness=this.metalness),this.sheen!==void 0&&(s.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(s.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(s.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(s.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(s.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(s.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(s.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(s.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(s.shininess=this.shininess),this.clearcoat!==void 0&&(s.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(s.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(s.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(s.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,s.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(s.dispersion=this.dispersion),this.iridescence!==void 0&&(s.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(s.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(s.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(s.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(s.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(s.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(s.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(s.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(s.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(s.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(s.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(s.lightMap=this.lightMap.toJSON(e).uuid,s.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(s.aoMap=this.aoMap.toJSON(e).uuid,s.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(s.bumpMap=this.bumpMap.toJSON(e).uuid,s.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(s.normalMap=this.normalMap.toJSON(e).uuid,s.normalMapType=this.normalMapType,s.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(s.displacementMap=this.displacementMap.toJSON(e).uuid,s.displacementScale=this.displacementScale,s.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(s.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(s.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(s.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(s.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(s.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(s.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(s.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(s.combine=this.combine)),this.envMapRotation!==void 0&&(s.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(s.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(s.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(s.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(s.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(s.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(s.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(s.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(s.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(s.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(s.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(s.size=this.size),this.shadowSide!==null&&(s.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(s.sizeAttenuation=this.sizeAttenuation),this.blending!==Rw&&(s.blending=this.blending),this.side!==Cy&&(s.side=this.side),this.vertexColors===!0&&(s.vertexColors=!0),this.opacity<1&&(s.opacity=this.opacity),this.transparent===!0&&(s.transparent=!0),this.blendSrc!==zB&&(s.blendSrc=this.blendSrc),this.blendDst!==GB&&(s.blendDst=this.blendDst),this.blendEquation!==Mv&&(s.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(s.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(s.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(s.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(s.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(s.blendAlpha=this.blendAlpha),this.depthFunc!==SS&&(s.depthFunc=this.depthFunc),this.depthTest===!1&&(s.depthTest=this.depthTest),this.depthWrite===!1&&(s.depthWrite=this.depthWrite),this.colorWrite===!1&&(s.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(s.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Ute&&(s.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(s.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(s.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Bx&&(s.stencilFail=this.stencilFail),this.stencilZFail!==Bx&&(s.stencilZFail=this.stencilZFail),this.stencilZPass!==Bx&&(s.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(s.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(s.rotation=this.rotation),this.polygonOffset===!0&&(s.polygonOffset=!0),this.polygonOffsetFactor!==0&&(s.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(s.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(s.linewidth=this.linewidth),this.dashSize!==void 0&&(s.dashSize=this.dashSize),this.gapSize!==void 0&&(s.gapSize=this.gapSize),this.scale!==void 0&&(s.scale=this.scale),this.dithering===!0&&(s.dithering=!0),this.alphaTest>0&&(s.alphaTest=this.alphaTest),this.alphaHash===!0&&(s.alphaHash=!0),this.alphaToCoverage===!0&&(s.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(s.premultipliedAlpha=!0),this.forceSinglePass===!0&&(s.forceSinglePass=!0),this.wireframe===!0&&(s.wireframe=!0),this.wireframeLinewidth>1&&(s.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(s.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(s.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(s.flatShading=!0),this.visible===!1&&(s.visible=!1),this.toneMapped===!1&&(s.toneMapped=!1),this.fog===!1&&(s.fog=!1),Object.keys(this.userData).length>0&&(s.userData=this.userData);function n(r){const o=[];for(const a in r){const l=r[a];delete l.metadata,o.push(l)}return o}if(i){const r=n(e.textures),o=n(e.images);r.length>0&&(s.textures=r),o.length>0&&(s.images=o)}return s}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const i=e.clippingPlanes;let s=null;if(i!==null){const n=i.length;s=new Array(n);for(let r=0;r!==n;++r)s[r]=i[r].clone()}return this.clippingPlanes=s,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class eP extends U4{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new bn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new zf,this.combine=W_e,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const oo=new ze,pN=new hs;let GBe=0;class Dm{constructor(e,i,s=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:GBe++}),this.name="",this.array=e,this.itemSize=i,this.count=e!==void 0?e.length/i:0,this.normalized=s,this.usage=Vte,this.updateRanges=[],this.gpuType=wf,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,i){this.updateRanges.push({start:e,count:i})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,i,s){e*=this.itemSize,s*=i.itemSize;for(let n=0,r=this.itemSize;n<r;n++)this.array[e+n]=i.array[s+n];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let i=0,s=this.count;i<s;i++)pN.fromBufferAttribute(this,i),pN.applyMatrix3(e),this.setXY(i,pN.x,pN.y);else if(this.itemSize===3)for(let i=0,s=this.count;i<s;i++)oo.fromBufferAttribute(this,i),oo.applyMatrix3(e),this.setXYZ(i,oo.x,oo.y,oo.z);return this}applyMatrix4(e){for(let i=0,s=this.count;i<s;i++)oo.fromBufferAttribute(this,i),oo.applyMatrix4(e),this.setXYZ(i,oo.x,oo.y,oo.z);return this}applyNormalMatrix(e){for(let i=0,s=this.count;i<s;i++)oo.fromBufferAttribute(this,i),oo.applyNormalMatrix(e),this.setXYZ(i,oo.x,oo.y,oo.z);return this}transformDirection(e){for(let i=0,s=this.count;i<s;i++)oo.fromBufferAttribute(this,i),oo.transformDirection(e),this.setXYZ(i,oo.x,oo.y,oo.z);return this}set(e,i=0){return this.array.set(e,i),this}getComponent(e,i){let s=this.array[e*this.itemSize+i];return this.normalized&&(s=z2(s,this.array)),s}setComponent(e,i,s){return this.normalized&&(s=Zl(s,this.array)),this.array[e*this.itemSize+i]=s,this}getX(e){let i=this.array[e*this.itemSize];return this.normalized&&(i=z2(i,this.array)),i}setX(e,i){return this.normalized&&(i=Zl(i,this.array)),this.array[e*this.itemSize]=i,this}getY(e){let i=this.array[e*this.itemSize+1];return this.normalized&&(i=z2(i,this.array)),i}setY(e,i){return this.normalized&&(i=Zl(i,this.array)),this.array[e*this.itemSize+1]=i,this}getZ(e){let i=this.array[e*this.itemSize+2];return this.normalized&&(i=z2(i,this.array)),i}setZ(e,i){return this.normalized&&(i=Zl(i,this.array)),this.array[e*this.itemSize+2]=i,this}getW(e){let i=this.array[e*this.itemSize+3];return this.normalized&&(i=z2(i,this.array)),i}setW(e,i){return this.normalized&&(i=Zl(i,this.array)),this.array[e*this.itemSize+3]=i,this}setXY(e,i,s){return e*=this.itemSize,this.normalized&&(i=Zl(i,this.array),s=Zl(s,this.array)),this.array[e+0]=i,this.array[e+1]=s,this}setXYZ(e,i,s,n){return e*=this.itemSize,this.normalized&&(i=Zl(i,this.array),s=Zl(s,this.array),n=Zl(n,this.array)),this.array[e+0]=i,this.array[e+1]=s,this.array[e+2]=n,this}setXYZW(e,i,s,n,r){return e*=this.itemSize,this.normalized&&(i=Zl(i,this.array),s=Zl(s,this.array),n=Zl(n,this.array),r=Zl(r,this.array)),this.array[e+0]=i,this.array[e+1]=s,this.array[e+2]=n,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Vte&&(e.usage=this.usage),e}}class mye extends Dm{constructor(e,i,s){super(new Uint16Array(e),i,s)}}class pye extends Dm{constructor(e,i,s){super(new Uint32Array(e),i,s)}}class Nm extends Dm{constructor(e,i,s){super(new Float32Array(e),i,s)}}let BBe=0;const Ac=new Gr,A5=new rl,Jx=new ze,Vu=new xA,H2=new xA,Yo=new ze;class qy extends j1{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:BBe++}),this.uuid=vA(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(lye(e)?pye:mye)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,i){return this.attributes[e]=i,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,i,s=0){this.groups.push({start:e,count:i,materialIndex:s})}clearGroups(){this.groups=[]}setDrawRange(e,i){this.drawRange.start=e,this.drawRange.count=i}applyMatrix4(e){const i=this.attributes.position;i!==void 0&&(i.applyMatrix4(e),i.needsUpdate=!0);const s=this.attributes.normal;if(s!==void 0){const r=new cs().getNormalMatrix(e);s.applyNormalMatrix(r),s.needsUpdate=!0}const n=this.attributes.tangent;return n!==void 0&&(n.transformDirection(e),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Ac.makeRotationFromQuaternion(e),this.applyMatrix4(Ac),this}rotateX(e){return Ac.makeRotationX(e),this.applyMatrix4(Ac),this}rotateY(e){return Ac.makeRotationY(e),this.applyMatrix4(Ac),this}rotateZ(e){return Ac.makeRotationZ(e),this.applyMatrix4(Ac),this}translate(e,i,s){return Ac.makeTranslation(e,i,s),this.applyMatrix4(Ac),this}scale(e,i,s){return Ac.makeScale(e,i,s),this.applyMatrix4(Ac),this}lookAt(e){return A5.lookAt(e),A5.updateMatrix(),this.applyMatrix4(A5.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Jx).negate(),this.translate(Jx.x,Jx.y,Jx.z),this}setFromPoints(e){const i=this.getAttribute("position");if(i===void 0){const s=[];for(let n=0,r=e.length;n<r;n++){const o=e[n];s.push(o.x,o.y,o.z||0)}this.setAttribute("position",new Nm(s,3))}else{const s=Math.min(e.length,i.count);for(let n=0;n<s;n++){const r=e[n];i.setXYZ(n,r.x,r.y,r.z||0)}e.length>i.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),i.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new xA);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new ze(-1/0,-1/0,-1/0),new ze(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),i)for(let s=0,n=i.length;s<n;s++){const r=i[s];Vu.setFromBufferAttribute(r),this.morphTargetsRelative?(Yo.addVectors(this.boundingBox.min,Vu.min),this.boundingBox.expandByPoint(Yo),Yo.addVectors(this.boundingBox.max,Vu.max),this.boundingBox.expandByPoint(Yo)):(this.boundingBox.expandByPoint(Vu.min),this.boundingBox.expandByPoint(Vu.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new eY);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new ze,1/0);return}if(e){const s=this.boundingSphere.center;if(Vu.setFromBufferAttribute(e),i)for(let r=0,o=i.length;r<o;r++){const a=i[r];H2.setFromBufferAttribute(a),this.morphTargetsRelative?(Yo.addVectors(Vu.min,H2.min),Vu.expandByPoint(Yo),Yo.addVectors(Vu.max,H2.max),Vu.expandByPoint(Yo)):(Vu.expandByPoint(H2.min),Vu.expandByPoint(H2.max))}Vu.getCenter(s);let n=0;for(let r=0,o=e.count;r<o;r++)Yo.fromBufferAttribute(e,r),n=Math.max(n,s.distanceToSquared(Yo));if(i)for(let r=0,o=i.length;r<o;r++){const a=i[r],l=this.morphTargetsRelative;for(let u=0,c=a.count;u<c;u++)Yo.fromBufferAttribute(a,u),l&&(Jx.fromBufferAttribute(e,u),Yo.add(Jx)),n=Math.max(n,s.distanceToSquared(Yo))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,i=this.attributes;if(e===null||i.position===void 0||i.normal===void 0||i.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const s=i.position,n=i.normal,r=i.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Dm(new Float32Array(4*s.count),4));const o=this.getAttribute("tangent"),a=[],l=[];for(let L=0;L<s.count;L++)a[L]=new ze,l[L]=new ze;const u=new ze,c=new ze,h=new ze,d=new hs,m=new hs,f=new hs,_=new ze,v=new ze;function x(L,D,O){u.fromBufferAttribute(s,L),c.fromBufferAttribute(s,D),h.fromBufferAttribute(s,O),d.fromBufferAttribute(r,L),m.fromBufferAttribute(r,D),f.fromBufferAttribute(r,O),c.sub(u),h.sub(u),m.sub(d),f.sub(d);const U=1/(m.x*f.y-f.x*m.y);isFinite(U)&&(_.copy(c).multiplyScalar(f.y).addScaledVector(h,-m.y).multiplyScalar(U),v.copy(h).multiplyScalar(m.x).addScaledVector(c,-f.x).multiplyScalar(U),a[L].add(_),a[D].add(_),a[O].add(_),l[L].add(v),l[D].add(v),l[O].add(v))}let w=this.groups;w.length===0&&(w=[{start:0,count:e.count}]);for(let L=0,D=w.length;L<D;++L){const O=w[L],U=O.start,$=O.count;for(let B=U,V=U+$;B<V;B+=3)x(e.getX(B+0),e.getX(B+1),e.getX(B+2))}const T=new ze,C=new ze,M=new ze,A=new ze;function I(L){M.fromBufferAttribute(n,L),A.copy(M);const D=a[L];T.copy(D),T.sub(M.multiplyScalar(M.dot(D))).normalize(),C.crossVectors(A,D);const U=C.dot(l[L])<0?-1:1;o.setXYZW(L,T.x,T.y,T.z,U)}for(let L=0,D=w.length;L<D;++L){const O=w[L],U=O.start,$=O.count;for(let B=U,V=U+$;B<V;B+=3)I(e.getX(B+0)),I(e.getX(B+1)),I(e.getX(B+2))}}computeVertexNormals(){const e=this.index,i=this.getAttribute("position");if(i!==void 0){let s=this.getAttribute("normal");if(s===void 0)s=new Dm(new Float32Array(i.count*3),3),this.setAttribute("normal",s);else for(let d=0,m=s.count;d<m;d++)s.setXYZ(d,0,0,0);const n=new ze,r=new ze,o=new ze,a=new ze,l=new ze,u=new ze,c=new ze,h=new ze;if(e)for(let d=0,m=e.count;d<m;d+=3){const f=e.getX(d+0),_=e.getX(d+1),v=e.getX(d+2);n.fromBufferAttribute(i,f),r.fromBufferAttribute(i,_),o.fromBufferAttribute(i,v),c.subVectors(o,r),h.subVectors(n,r),c.cross(h),a.fromBufferAttribute(s,f),l.fromBufferAttribute(s,_),u.fromBufferAttribute(s,v),a.add(c),l.add(c),u.add(c),s.setXYZ(f,a.x,a.y,a.z),s.setXYZ(_,l.x,l.y,l.z),s.setXYZ(v,u.x,u.y,u.z)}else for(let d=0,m=i.count;d<m;d+=3)n.fromBufferAttribute(i,d+0),r.fromBufferAttribute(i,d+1),o.fromBufferAttribute(i,d+2),c.subVectors(o,r),h.subVectors(n,r),c.cross(h),s.setXYZ(d+0,c.x,c.y,c.z),s.setXYZ(d+1,c.x,c.y,c.z),s.setXYZ(d+2,c.x,c.y,c.z);this.normalizeNormals(),s.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let i=0,s=e.count;i<s;i++)Yo.fromBufferAttribute(e,i),Yo.normalize(),e.setXYZ(i,Yo.x,Yo.y,Yo.z)}toNonIndexed(){function e(a,l){const u=a.array,c=a.itemSize,h=a.normalized,d=new u.constructor(l.length*c);let m=0,f=0;for(let _=0,v=l.length;_<v;_++){a.isInterleavedBufferAttribute?m=l[_]*a.data.stride+a.offset:m=l[_]*c;for(let x=0;x<c;x++)d[f++]=u[m++]}return new Dm(d,c,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const i=new qy,s=this.index.array,n=this.attributes;for(const a in n){const l=n[a],u=e(l,s);i.setAttribute(a,u)}const r=this.morphAttributes;for(const a in r){const l=[],u=r[a];for(let c=0,h=u.length;c<h;c++){const d=u[c],m=e(d,s);l.push(m)}i.morphAttributes[a]=l}i.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const u=o[a];i.addGroup(u.start,u.count,u.materialIndex)}return i}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};const i=this.index;i!==null&&(e.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});const s=this.attributes;for(const l in s){const u=s[l];e.data.attributes[l]=u.toJSON(e.data)}const n={};let r=!1;for(const l in this.morphAttributes){const u=this.morphAttributes[l],c=[];for(let h=0,d=u.length;h<d;h++){const m=u[h];c.push(m.toJSON(e.data))}c.length>0&&(n[l]=c,r=!0)}r&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const i={};this.name=e.name;const s=e.index;s!==null&&this.setIndex(s.clone());const n=e.attributes;for(const u in n){const c=n[u];this.setAttribute(u,c.clone(i))}const r=e.morphAttributes;for(const u in r){const c=[],h=r[u];for(let d=0,m=h.length;d<m;d++)c.push(h[d].clone(i));this.morphAttributes[u]=c}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let u=0,c=o.length;u<c;u++){const h=o[u];this.addGroup(h.start,h.count,h.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const eie=new Gr,E0=new cye,fN=new eY,tie=new ze,gN=new ze,_N=new ze,yN=new ze,I5=new ze,vN=new ze,iie=new ze,xN=new ze;class Qc extends rl{constructor(e=new qy,i=new eP){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=i,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const i=this.geometry.morphAttributes,s=Object.keys(i);if(s.length>0){const n=i[s[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,o=n.length;r<o;r++){const a=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=r}}}}getVertexPosition(e,i){const s=this.geometry,n=s.attributes.position,r=s.morphAttributes.position,o=s.morphTargetsRelative;i.fromBufferAttribute(n,e);const a=this.morphTargetInfluences;if(r&&a){vN.set(0,0,0);for(let l=0,u=r.length;l<u;l++){const c=a[l],h=r[l];c!==0&&(I5.fromBufferAttribute(h,e),o?vN.addScaledVector(I5,c):vN.addScaledVector(I5.sub(i),c))}i.add(vN)}return i}raycast(e,i){const s=this.geometry,n=this.material,r=this.matrixWorld;n!==void 0&&(s.boundingSphere===null&&s.computeBoundingSphere(),fN.copy(s.boundingSphere),fN.applyMatrix4(r),E0.copy(e.ray).recast(e.near),!(fN.containsPoint(E0.origin)===!1&&(E0.intersectSphere(fN,tie)===null||E0.origin.distanceToSquared(tie)>(e.far-e.near)**2))&&(eie.copy(r).invert(),E0.copy(e.ray).applyMatrix4(eie),!(s.boundingBox!==null&&E0.intersectsBox(s.boundingBox)===!1)&&this._computeIntersections(e,i,E0)))}_computeIntersections(e,i,s){let n;const r=this.geometry,o=this.material,a=r.index,l=r.attributes.position,u=r.attributes.uv,c=r.attributes.uv1,h=r.attributes.normal,d=r.groups,m=r.drawRange;if(a!==null)if(Array.isArray(o))for(let f=0,_=d.length;f<_;f++){const v=d[f],x=o[v.materialIndex],w=Math.max(v.start,m.start),T=Math.min(a.count,Math.min(v.start+v.count,m.start+m.count));for(let C=w,M=T;C<M;C+=3){const A=a.getX(C),I=a.getX(C+1),L=a.getX(C+2);n=bN(this,x,e,s,u,c,h,A,I,L),n&&(n.faceIndex=Math.floor(C/3),n.face.materialIndex=v.materialIndex,i.push(n))}}else{const f=Math.max(0,m.start),_=Math.min(a.count,m.start+m.count);for(let v=f,x=_;v<x;v+=3){const w=a.getX(v),T=a.getX(v+1),C=a.getX(v+2);n=bN(this,o,e,s,u,c,h,w,T,C),n&&(n.faceIndex=Math.floor(v/3),i.push(n))}}else if(l!==void 0)if(Array.isArray(o))for(let f=0,_=d.length;f<_;f++){const v=d[f],x=o[v.materialIndex],w=Math.max(v.start,m.start),T=Math.min(l.count,Math.min(v.start+v.count,m.start+m.count));for(let C=w,M=T;C<M;C+=3){const A=C,I=C+1,L=C+2;n=bN(this,x,e,s,u,c,h,A,I,L),n&&(n.faceIndex=Math.floor(C/3),n.face.materialIndex=v.materialIndex,i.push(n))}}else{const f=Math.max(0,m.start),_=Math.min(l.count,m.start+m.count);for(let v=f,x=_;v<x;v+=3){const w=v,T=v+1,C=v+2;n=bN(this,o,e,s,u,c,h,w,T,C),n&&(n.faceIndex=Math.floor(v/3),i.push(n))}}}}function qBe(t,e,i,s,n,r,o,a){let l;if(e.side===bu?l=s.intersectTriangle(o,r,n,!0,a):l=s.intersectTriangle(n,r,o,e.side===Cy,a),l===null)return null;xN.copy(a),xN.applyMatrix4(t.matrixWorld);const u=i.ray.origin.distanceTo(xN);return u<i.near||u>i.far?null:{distance:u,point:xN.clone(),object:t}}function bN(t,e,i,s,n,r,o,a,l,u){t.getVertexPosition(a,gN),t.getVertexPosition(l,_N),t.getVertexPosition(u,yN);const c=qBe(t,e,i,s,gN,_N,yN,iie);if(c){const h=new ze;ad.getBarycoord(iie,gN,_N,yN,h),n&&(c.uv=ad.getInterpolatedAttribute(n,a,l,u,h,new hs)),r&&(c.uv1=ad.getInterpolatedAttribute(r,a,l,u,h,new hs)),o&&(c.normal=ad.getInterpolatedAttribute(o,a,l,u,h,new ze),c.normal.dot(s.direction)>0&&c.normal.multiplyScalar(-1));const d={a,b:l,c:u,normal:new ze,materialIndex:0};ad.getNormal(gN,_N,yN,d.normal),c.face=d,c.barycoord=h}return c}class bA extends qy{constructor(e=1,i=1,s=1,n=1,r=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:i,depth:s,widthSegments:n,heightSegments:r,depthSegments:o};const a=this;n=Math.floor(n),r=Math.floor(r),o=Math.floor(o);const l=[],u=[],c=[],h=[];let d=0,m=0;f("z","y","x",-1,-1,s,i,e,o,r,0),f("z","y","x",1,-1,s,i,-e,o,r,1),f("x","z","y",1,1,e,s,i,n,o,2),f("x","z","y",1,-1,e,s,-i,n,o,3),f("x","y","z",1,-1,e,i,s,n,r,4),f("x","y","z",-1,-1,e,i,-s,n,r,5),this.setIndex(l),this.setAttribute("position",new Nm(u,3)),this.setAttribute("normal",new Nm(c,3)),this.setAttribute("uv",new Nm(h,2));function f(_,v,x,w,T,C,M,A,I,L,D){const O=C/I,U=M/L,$=C/2,B=M/2,V=A/2,H=I+1,Y=L+1;let W=0,ee=0;const ne=new ze;for(let j=0;j<Y;j++){const oe=j*U-B;for(let ve=0;ve<H;ve++){const Ye=ve*O-$;ne[_]=Ye*w,ne[v]=oe*T,ne[x]=V,u.push(ne.x,ne.y,ne.z),ne[_]=0,ne[v]=0,ne[x]=A>0?1:-1,c.push(ne.x,ne.y,ne.z),h.push(ve/I),h.push(1-j/L),W+=1}}for(let j=0;j<L;j++)for(let oe=0;oe<I;oe++){const ve=d+oe+H*j,Ye=d+oe+H*(j+1),de=d+(oe+1)+H*(j+1),fe=d+(oe+1)+H*j;l.push(ve,Ye,fe),l.push(Ye,de,fe),ee+=6}a.addGroup(m,ee,D),m+=ee,d+=W}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new bA(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function PS(t){const e={};for(const i in t){e[i]={};for(const s in t[i]){const n=t[i][s];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?n.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[i][s]=null):e[i][s]=n.clone():Array.isArray(n)?e[i][s]=n.slice():e[i][s]=n}}return e}function Cl(t){const e={};for(let i=0;i<t.length;i++){const s=PS(t[i]);for(const n in s)e[n]=s[n]}return e}function HBe(t){const e=[];for(let i=0;i<t.length;i++)e.push(t[i].clone());return e}function fye(t){const e=t.getRenderTarget();return e===null?t.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Zs.workingColorSpace}const jBe={clone:PS,merge:Cl};var YBe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,XBe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Ty extends U4{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=YBe,this.fragmentShader=XBe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=PS(e.uniforms),this.uniformsGroups=HBe(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const i=super.toJSON(e);i.glslVersion=this.glslVersion,i.uniforms={};for(const n in this.uniforms){const o=this.uniforms[n].value;o&&o.isTexture?i.uniforms[n]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?i.uniforms[n]={type:"c",value:o.getHex()}:o&&o.isVector2?i.uniforms[n]={type:"v2",value:o.toArray()}:o&&o.isVector3?i.uniforms[n]={type:"v3",value:o.toArray()}:o&&o.isVector4?i.uniforms[n]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?i.uniforms[n]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?i.uniforms[n]={type:"m4",value:o.toArray()}:i.uniforms[n]={value:o}}Object.keys(this.defines).length>0&&(i.defines=this.defines),i.vertexShader=this.vertexShader,i.fragmentShader=this.fragmentShader,i.lights=this.lights,i.clipping=this.clipping;const s={};for(const n in this.extensions)this.extensions[n]===!0&&(s[n]=!0);return Object.keys(s).length>0&&(i.extensions=s),i}}class gye extends rl{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Gr,this.projectionMatrix=new Gr,this.projectionMatrixInverse=new Gr,this.coordinateSystem=Sf}copy(e,i){return super.copy(e,i),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,i){super.updateWorldMatrix(e,i),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Xg=new ze,sie=new hs,nie=new hs;class jc extends gye{constructor(e=50,i=1,s=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=s,this.far=n,this.focus=10,this.aspect=i,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,i){return super.copy(e,i),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const i=.5*this.getFilmHeight()/e;this.fov=T8*2*Math.atan(i),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(v3*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return T8*2*Math.atan(Math.tan(v3*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,i,s){Xg.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(Xg.x,Xg.y).multiplyScalar(-e/Xg.z),Xg.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),s.set(Xg.x,Xg.y).multiplyScalar(-e/Xg.z)}getViewSize(e,i){return this.getViewBounds(e,sie,nie),i.subVectors(nie,sie)}setViewOffset(e,i,s,n,r,o){this.aspect=e/i,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=s,this.view.offsetY=n,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let i=e*Math.tan(v3*.5*this.fov)/this.zoom,s=2*i,n=this.aspect*s,r=-.5*n;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,u=o.fullHeight;r+=o.offsetX*n/l,i-=o.offsetY*s/u,n*=o.width/l,s*=o.height/u}const a=this.filmOffset;a!==0&&(r+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+n,i,i-s,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const i=super.toJSON(e);return i.object.fov=this.fov,i.object.zoom=this.zoom,i.object.near=this.near,i.object.far=this.far,i.object.focus=this.focus,i.object.aspect=this.aspect,this.view!==null&&(i.object.view=Object.assign({},this.view)),i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i}}const eb=-90,tb=1;class WBe extends rl{constructor(e,i,s){super(),this.type="CubeCamera",this.renderTarget=s,this.coordinateSystem=null,this.activeMipmapLevel=0;const n=new jc(eb,tb,e,i);n.layers=this.layers,this.add(n);const r=new jc(eb,tb,e,i);r.layers=this.layers,this.add(r);const o=new jc(eb,tb,e,i);o.layers=this.layers,this.add(o);const a=new jc(eb,tb,e,i);a.layers=this.layers,this.add(a);const l=new jc(eb,tb,e,i);l.layers=this.layers,this.add(l);const u=new jc(eb,tb,e,i);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const e=this.coordinateSystem,i=this.children.concat(),[s,n,r,o,a,l]=i;for(const u of i)this.remove(u);if(e===Sf)s.up.set(0,1,0),s.lookAt(1,0,0),n.up.set(0,1,0),n.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===NL)s.up.set(0,-1,0),s.lookAt(-1,0,0),n.up.set(0,-1,0),n.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const u of i)this.add(u),u.updateMatrixWorld()}update(e,i){this.parent===null&&this.updateMatrixWorld();const{renderTarget:s,activeMipmapLevel:n}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[r,o,a,l,u,c]=this.children,h=e.getRenderTarget(),d=e.getActiveCubeFace(),m=e.getActiveMipmapLevel(),f=e.xr.enabled;e.xr.enabled=!1;const _=s.texture.generateMipmaps;s.texture.generateMipmaps=!1,e.setRenderTarget(s,0,n),e.render(i,r),e.setRenderTarget(s,1,n),e.render(i,o),e.setRenderTarget(s,2,n),e.render(i,a),e.setRenderTarget(s,3,n),e.render(i,l),e.setRenderTarget(s,4,n),e.render(i,u),s.texture.generateMipmaps=_,e.setRenderTarget(s,5,n),e.render(i,c),e.setRenderTarget(h,d,m),e.xr.enabled=f,s.texture.needsPMREMUpdate=!0}}class _ye extends $l{constructor(e=[],i=ES,s,n,r,o,a,l,u,c){super(e,i,s,n,r,o,a,l,u,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class ZBe extends D1{constructor(e=1,i={}){super(e,e,i),this.isWebGLCubeRenderTarget=!0;const s={width:e,height:e,depth:1},n=[s,s,s,s,s,s];this.texture=new _ye(n,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:Cm}fromEquirectangularTexture(e,i){this.texture.type=i.type,this.texture.colorSpace=i.colorSpace,this.texture.generateMipmaps=i.generateMipmaps,this.texture.minFilter=i.minFilter,this.texture.magFilter=i.magFilter;const s={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},n=new bA(5,5,5),r=new Ty({name:"CubemapFromEquirect",uniforms:PS(s.uniforms),vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,side:bu,blending:ay});r.uniforms.tEquirect.value=i;const o=new Qc(n,r),a=i.minFilter;return i.minFilter===zv&&(i.minFilter=Cm),new WBe(1,10,this).update(e,o),i.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,i=!0,s=!0,n=!0){const r=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(i,s,n);e.setRenderTarget(r)}}class wN extends rl{constructor(){super(),this.isGroup=!0,this.type="Group"}}const KBe={type:"move"};class D5{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new wN,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new wN,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ze,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ze),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new wN,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ze,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ze),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const i=this._hand;if(i)for(const s of e.hand.values())this._getHandJoint(i,s)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,i,s){let n=null,r=null,o=null;const a=this._targetRay,l=this._grip,u=this._hand;if(e&&i.session.visibilityState!=="visible-blurred"){if(u&&e.hand){o=!0;for(const _ of e.hand.values()){const v=i.getJointPose(_,s),x=this._getHandJoint(u,_);v!==null&&(x.matrix.fromArray(v.transform.matrix),x.matrix.decompose(x.position,x.rotation,x.scale),x.matrixWorldNeedsUpdate=!0,x.jointRadius=v.radius),x.visible=v!==null}const c=u.joints["index-finger-tip"],h=u.joints["thumb-tip"],d=c.position.distanceTo(h.position),m=.02,f=.005;u.inputState.pinching&&d>m+f?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&d<=m-f&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(r=i.getPose(e.gripSpace,s),r!==null&&(l.matrix.fromArray(r.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,r.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(r.linearVelocity)):l.hasLinearVelocity=!1,r.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(r.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(n=i.getPose(e.targetRaySpace,s),n===null&&r!==null&&(n=r),n!==null&&(a.matrix.fromArray(n.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,n.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(n.linearVelocity)):a.hasLinearVelocity=!1,n.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(n.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(KBe)))}return a!==null&&(a.visible=n!==null),l!==null&&(l.visible=r!==null),u!==null&&(u.visible=o!==null),this}_getHandJoint(e,i){if(e.joints[i.jointName]===void 0){const s=new wN;s.matrixAutoUpdate=!1,s.visible=!1,e.joints[i.jointName]=s,e.add(s)}return e.joints[i.jointName]}}class QBe extends rl{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new zf,this.environmentIntensity=1,this.environmentRotation=new zf,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,i){return super.copy(e,i),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const i=super.toJSON(e);return this.fog!==null&&(i.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(i.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(i.object.backgroundIntensity=this.backgroundIntensity),i.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(i.object.environmentIntensity=this.environmentIntensity),i.object.environmentRotation=this.environmentRotation.toArray(),i}}const N5=new ze,JBe=new ze,e8e=new cs;class L_{constructor(e=new ze(1,0,0),i=0){this.isPlane=!0,this.normal=e,this.constant=i}set(e,i){return this.normal.copy(e),this.constant=i,this}setComponents(e,i,s,n){return this.normal.set(e,i,s),this.constant=n,this}setFromNormalAndCoplanarPoint(e,i){return this.normal.copy(e),this.constant=-i.dot(this.normal),this}setFromCoplanarPoints(e,i,s){const n=N5.subVectors(s,i).cross(JBe.subVectors(e,i)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,i){return i.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,i){const s=e.delta(N5),n=this.normal.dot(s);if(n===0)return this.distanceToPoint(e.start)===0?i.copy(e.start):null;const r=-(e.start.dot(this.normal)+this.constant)/n;return r<0||r>1?null:i.copy(e.start).addScaledVector(s,r)}intersectsLine(e){const i=this.distanceToPoint(e.start),s=this.distanceToPoint(e.end);return i<0&&s>0||s<0&&i>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,i){const s=i||e8e.getNormalMatrix(e),n=this.coplanarPoint(N5).applyMatrix4(e),r=this.normal.applyMatrix3(s).normalize();return this.constant=-n.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const C0=new eY,SN=new ze;class tY{constructor(e=new L_,i=new L_,s=new L_,n=new L_,r=new L_,o=new L_){this.planes=[e,i,s,n,r,o]}set(e,i,s,n,r,o){const a=this.planes;return a[0].copy(e),a[1].copy(i),a[2].copy(s),a[3].copy(n),a[4].copy(r),a[5].copy(o),this}copy(e){const i=this.planes;for(let s=0;s<6;s++)i[s].copy(e.planes[s]);return this}setFromProjectionMatrix(e,i=Sf){const s=this.planes,n=e.elements,r=n[0],o=n[1],a=n[2],l=n[3],u=n[4],c=n[5],h=n[6],d=n[7],m=n[8],f=n[9],_=n[10],v=n[11],x=n[12],w=n[13],T=n[14],C=n[15];if(s[0].setComponents(l-r,d-u,v-m,C-x).normalize(),s[1].setComponents(l+r,d+u,v+m,C+x).normalize(),s[2].setComponents(l+o,d+c,v+f,C+w).normalize(),s[3].setComponents(l-o,d-c,v-f,C-w).normalize(),s[4].setComponents(l-a,d-h,v-_,C-T).normalize(),i===Sf)s[5].setComponents(l+a,d+h,v+_,C+T).normalize();else if(i===NL)s[5].setComponents(a,h,_,T).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+i);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),C0.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const i=e.geometry;i.boundingSphere===null&&i.computeBoundingSphere(),C0.copy(i.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(C0)}intersectsSprite(e){return C0.center.set(0,0,0),C0.radius=.7071067811865476,C0.applyMatrix4(e.matrixWorld),this.intersectsSphere(C0)}intersectsSphere(e){const i=this.planes,s=e.center,n=-e.radius;for(let r=0;r<6;r++)if(i[r].distanceToPoint(s)<n)return!1;return!0}intersectsBox(e){const i=this.planes;for(let s=0;s<6;s++){const n=i[s];if(SN.x=n.normal.x>0?e.max.x:e.min.x,SN.y=n.normal.y>0?e.max.y:e.min.y,SN.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(SN)<0)return!1}return!0}containsPoint(e){const i=this.planes;for(let s=0;s<6;s++)if(i[s].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}class yye extends $l{constructor(e,i,s=I1,n,r,o,a=fd,l=fd,u,c=mM){if(c!==mM&&c!==pM)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super(null,n,r,o,a,l,c,s,u),this.isDepthTexture=!0,this.image={width:e,height:i},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new Jj(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const i=super.toJSON(e);return this.compareFunction!==null&&(i.compareFunction=this.compareFunction),i}}class iY extends qy{constructor(e=1,i=1,s=1,n=32,r=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:i,height:s,radialSegments:n,heightSegments:r,openEnded:o,thetaStart:a,thetaLength:l};const u=this;n=Math.floor(n),r=Math.floor(r);const c=[],h=[],d=[],m=[];let f=0;const _=[],v=s/2;let x=0;w(),o===!1&&(e>0&&T(!0),i>0&&T(!1)),this.setIndex(c),this.setAttribute("position",new Nm(h,3)),this.setAttribute("normal",new Nm(d,3)),this.setAttribute("uv",new Nm(m,2));function w(){const C=new ze,M=new ze;let A=0;const I=(i-e)/s;for(let L=0;L<=r;L++){const D=[],O=L/r,U=O*(i-e)+e;for(let $=0;$<=n;$++){const B=$/n,V=B*l+a,H=Math.sin(V),Y=Math.cos(V);M.x=U*H,M.y=-O*s+v,M.z=U*Y,h.push(M.x,M.y,M.z),C.set(H,I,Y).normalize(),d.push(C.x,C.y,C.z),m.push(B,1-O),D.push(f++)}_.push(D)}for(let L=0;L<n;L++)for(let D=0;D<r;D++){const O=_[D][L],U=_[D+1][L],$=_[D+1][L+1],B=_[D][L+1];(e>0||D!==0)&&(c.push(O,U,B),A+=3),(i>0||D!==r-1)&&(c.push(U,$,B),A+=3)}u.addGroup(x,A,0),x+=A}function T(C){const M=f,A=new hs,I=new ze;let L=0;const D=C===!0?e:i,O=C===!0?1:-1;for(let $=1;$<=n;$++)h.push(0,v*O,0),d.push(0,O,0),m.push(.5,.5),f++;const U=f;for(let $=0;$<=n;$++){const V=$/n*l+a,H=Math.cos(V),Y=Math.sin(V);I.x=D*Y,I.y=v*O,I.z=D*H,h.push(I.x,I.y,I.z),d.push(0,O,0),A.x=H*.5+.5,A.y=Y*.5*O+.5,m.push(A.x,A.y),f++}for(let $=0;$<n;$++){const B=M+$,V=U+$;C===!0?c.push(V,V+1,B):c.push(V+1,V,B),L+=3}u.addGroup(x,L,C===!0?1:2),x+=L}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new iY(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class MS extends qy{constructor(e=1,i=1,s=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:i,widthSegments:s,heightSegments:n};const r=e/2,o=i/2,a=Math.floor(s),l=Math.floor(n),u=a+1,c=l+1,h=e/a,d=i/l,m=[],f=[],_=[],v=[];for(let x=0;x<c;x++){const w=x*d-o;for(let T=0;T<u;T++){const C=T*h-r;f.push(C,-w,0),_.push(0,0,1),v.push(T/a),v.push(1-x/l)}}for(let x=0;x<l;x++)for(let w=0;w<a;w++){const T=w+u*x,C=w+u*(x+1),M=w+1+u*(x+1),A=w+1+u*x;m.push(T,C,A),m.push(C,M,A)}this.setIndex(m),this.setAttribute("position",new Nm(f,3)),this.setAttribute("normal",new Nm(_,3)),this.setAttribute("uv",new Nm(v,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new MS(e.width,e.height,e.widthSegments,e.heightSegments)}}class t8e extends U4{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=hBe,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class i8e extends U4{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const rie={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class s8e{constructor(e,i,s){const n=this;let r=!1,o=0,a=0,l;const u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=i,this.onError=s,this.itemStart=function(c){a++,r===!1&&n.onStart!==void 0&&n.onStart(c,o,a),r=!0},this.itemEnd=function(c){o++,n.onProgress!==void 0&&n.onProgress(c,o,a),o===a&&(r=!1,n.onLoad!==void 0&&n.onLoad())},this.itemError=function(c){n.onError!==void 0&&n.onError(c)},this.resolveURL=function(c){return l?l(c):c},this.setURLModifier=function(c){return l=c,this},this.addHandler=function(c,h){return u.push(c,h),this},this.removeHandler=function(c){const h=u.indexOf(c);return h!==-1&&u.splice(h,2),this},this.getHandler=function(c){for(let h=0,d=u.length;h<d;h+=2){const m=u[h],f=u[h+1];if(m.global&&(m.lastIndex=0),m.test(c))return f}return null}}}const n8e=new s8e;class sY{constructor(e){this.manager=e!==void 0?e:n8e,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,i){const s=this;return new Promise(function(n,r){s.load(e,n,i,r)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}sY.DEFAULT_MATERIAL_NAME="__DEFAULT";class r8e extends sY{constructor(e){super(e)}load(e,i,s,n){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const r=this,o=rie.get(e);if(o!==void 0)return r.manager.itemStart(e),setTimeout(function(){i&&i(o),r.manager.itemEnd(e)},0),o;const a=fM("img");function l(){c(),rie.add(e,this),i&&i(this),r.manager.itemEnd(e)}function u(h){c(),n&&n(h),r.manager.itemError(e),r.manager.itemEnd(e)}function c(){a.removeEventListener("load",l,!1),a.removeEventListener("error",u,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),r.manager.itemStart(e),a.src=e,a}}class o8e extends sY{constructor(e){super(e)}load(e,i,s,n){const r=new $l,o=new r8e(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){r.image=a,r.needsUpdate=!0,i!==void 0&&i(r)},s,n),r}}class a8e extends rl{constructor(e,i=1){super(),this.isLight=!0,this.type="Light",this.color=new bn(e),this.intensity=i}dispose(){}copy(e,i){return super.copy(e,i),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const i=super.toJSON(e);return i.object.color=this.color.getHex(),i.object.intensity=this.intensity,this.groundColor!==void 0&&(i.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(i.object.distance=this.distance),this.angle!==void 0&&(i.object.angle=this.angle),this.decay!==void 0&&(i.object.decay=this.decay),this.penumbra!==void 0&&(i.object.penumbra=this.penumbra),this.shadow!==void 0&&(i.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(i.object.target=this.target.uuid),i}}const R5=new Gr,oie=new ze,aie=new ze;class l8e{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new hs(512,512),this.map=null,this.mapPass=null,this.matrix=new Gr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new tY,this._frameExtents=new hs(1,1),this._viewportCount=1,this._viewports=[new zr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const i=this.camera,s=this.matrix;oie.setFromMatrixPosition(e.matrixWorld),i.position.copy(oie),aie.setFromMatrixPosition(e.target.matrixWorld),i.lookAt(aie),i.updateMatrixWorld(),R5.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(R5),s.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),s.multiply(R5)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class vye extends gye{constructor(e=-1,i=1,s=1,n=-1,r=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=i,this.top=s,this.bottom=n,this.near=r,this.far=o,this.updateProjectionMatrix()}copy(e,i){return super.copy(e,i),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,i,s,n,r,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=s,this.view.offsetY=n,this.view.width=r,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),s=(this.right+this.left)/2,n=(this.top+this.bottom)/2;let r=s-e,o=s+e,a=n+i,l=n-i;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=u*this.view.offsetX,o=r+u*this.view.width,a-=c*this.view.offsetY,l=a-c*this.view.height}this.projectionMatrix.makeOrthographic(r,o,a,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const i=super.toJSON(e);return i.object.zoom=this.zoom,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,i.object.near=this.near,i.object.far=this.far,this.view!==null&&(i.object.view=Object.assign({},this.view)),i}}class u8e extends l8e{constructor(){super(new vye(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class c8e extends a8e{constructor(e,i){super(e,i),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(rl.DEFAULT_UP),this.updateMatrix(),this.target=new rl,this.shadow=new u8e}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class h8e extends jc{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e,this.index=0}}class lie{constructor(e=1,i=0,s=0){this.radius=e,this.phi=i,this.theta=s}set(e,i,s){return this.radius=e,this.phi=i,this.theta=s,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Cs(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,i,s){return this.radius=Math.sqrt(e*e+i*i+s*s),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,s),this.phi=Math.acos(Cs(i/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class d8e extends j1{constructor(e,i=null){super(),this.object=e,this.domElement=i,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){console.warn("THREE.Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function uie(t,e,i,s){const n=m8e(s);switch(i){case eye:return t*e;case iye:return t*e;case sye:return t*e*2;case nye:return t*e/n.components*n.byteLength;case Zj:return t*e/n.components*n.byteLength;case rye:return t*e*2/n.components*n.byteLength;case Kj:return t*e*2/n.components*n.byteLength;case tye:return t*e*3/n.components*n.byteLength;case cd:return t*e*4/n.components*n.byteLength;case Qj:return t*e*4/n.components*n.byteLength;case p3:case f3:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case g3:case _3:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case t8:case s8:return Math.max(t,16)*Math.max(e,8)/4;case e8:case i8:return Math.max(t,8)*Math.max(e,8)/2;case n8:case r8:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case o8:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case a8:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case l8:return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16;case u8:return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16;case c8:return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16;case h8:return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16;case d8:return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16;case m8:return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16;case p8:return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16;case f8:return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16;case g8:return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16;case _8:return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16;case y8:return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16;case v8:return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16;case x8:return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16;case y3:case b8:case w8:return Math.ceil(t/4)*Math.ceil(e/4)*16;case oye:case S8:return Math.ceil(t/4)*Math.ceil(e/4)*8;case E8:case C8:return Math.ceil(t/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${i} format.`)}function m8e(t){switch(t){case Vf:case K_e:return{byteLength:1,components:1};case hM:case Q_e:case yA:return{byteLength:2,components:1};case Xj:case Wj:return{byteLength:2,components:4};case I1:case Yj:case wf:return{byteLength:4,components:1};case J_e:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${t}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:jj}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=jj);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function xye(){let t=null,e=!1,i=null,s=null;function n(r,o){i(r,o),s=t.requestAnimationFrame(n)}return{start:function(){e!==!0&&i!==null&&(s=t.requestAnimationFrame(n),e=!0)},stop:function(){t.cancelAnimationFrame(s),e=!1},setAnimationLoop:function(r){i=r},setContext:function(r){t=r}}}function p8e(t){const e=new WeakMap;function i(a,l){const u=a.array,c=a.usage,h=u.byteLength,d=t.createBuffer();t.bindBuffer(l,d),t.bufferData(l,u,c),a.onUploadCallback();let m;if(u instanceof Float32Array)m=t.FLOAT;else if(u instanceof Uint16Array)a.isFloat16BufferAttribute?m=t.HALF_FLOAT:m=t.UNSIGNED_SHORT;else if(u instanceof Int16Array)m=t.SHORT;else if(u instanceof Uint32Array)m=t.UNSIGNED_INT;else if(u instanceof Int32Array)m=t.INT;else if(u instanceof Int8Array)m=t.BYTE;else if(u instanceof Uint8Array)m=t.UNSIGNED_BYTE;else if(u instanceof Uint8ClampedArray)m=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:d,type:m,bytesPerElement:u.BYTES_PER_ELEMENT,version:a.version,size:h}}function s(a,l,u){const c=l.array,h=l.updateRanges;if(t.bindBuffer(u,a),h.length===0)t.bufferSubData(u,0,c);else{h.sort((m,f)=>m.start-f.start);let d=0;for(let m=1;m<h.length;m++){const f=h[d],_=h[m];_.start<=f.start+f.count+1?f.count=Math.max(f.count,_.start+_.count-f.start):(++d,h[d]=_)}h.length=d+1;for(let m=0,f=h.length;m<f;m++){const _=h[m];t.bufferSubData(u,_.start*c.BYTES_PER_ELEMENT,c,_.start,_.count)}l.clearUpdateRanges()}l.onUploadCallback()}function n(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)}function r(a){a.isInterleavedBufferAttribute&&(a=a.data);const l=e.get(a);l&&(t.deleteBuffer(l.buffer),e.delete(a))}function o(a,l){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){const c=e.get(a);(!c||c.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version});return}const u=e.get(a);if(u===void 0)e.set(a,i(a,l));else if(u.version<a.version){if(u.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");s(u.buffer,a,l),u.version=a.version}}return{get:n,remove:r,update:o}}var f8e=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,g8e=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,_8e=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,y8e=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,v8e=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,x8e=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,b8e=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,w8e=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,S8e=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,E8e=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,C8e=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,T8e=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,P8e=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,M8e=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,A8e=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,I8e=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,D8e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,N8e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,R8e=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,O8e=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,L8e=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,F8e=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,k8e=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,$8e=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,U8e=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,V8e=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,z8e=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,G8e=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,B8e=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,q8e=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,H8e="gl_FragColor = linearToOutputTexel( gl_FragColor );",j8e=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Y8e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,X8e=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,W8e=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Z8e=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,K8e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Q8e=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,J8e=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,eqe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,tqe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,iqe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,sqe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,nqe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,rqe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,oqe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,aqe=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,lqe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,uqe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,cqe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,hqe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,dqe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,mqe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,pqe=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,fqe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,gqe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,_qe=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,yqe=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,vqe=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,xqe=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,bqe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,wqe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Sqe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Eqe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Cqe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Tqe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Pqe=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,Mqe=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Aqe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Iqe=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,Dqe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Nqe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,Rqe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Oqe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Lqe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Fqe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,kqe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,$qe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,Uqe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,Vqe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,zqe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Gqe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Bqe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,qqe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Hqe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,jqe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Yqe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Xqe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Wqe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Zqe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,Kqe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Qqe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Jqe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,e9e=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,t9e=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,i9e=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,s9e=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,n9e=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,r9e=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,o9e=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,a9e=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,l9e=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,u9e=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,c9e=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,h9e=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,d9e=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,m9e=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const p9e=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,f9e=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,g9e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,_9e=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,y9e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,v9e=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,x9e=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,b9e=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,w9e=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,S9e=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,E9e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,C9e=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,T9e=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,P9e=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,M9e=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,A9e=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,I9e=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,D9e=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,N9e=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,R9e=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,O9e=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,L9e=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,F9e=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,k9e=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,$9e=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,U9e=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,V9e=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,z9e=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,G9e=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,B9e=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,q9e=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,H9e=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,j9e=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Y9e=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,fs={alphahash_fragment:f8e,alphahash_pars_fragment:g8e,alphamap_fragment:_8e,alphamap_pars_fragment:y8e,alphatest_fragment:v8e,alphatest_pars_fragment:x8e,aomap_fragment:b8e,aomap_pars_fragment:w8e,batching_pars_vertex:S8e,batching_vertex:E8e,begin_vertex:C8e,beginnormal_vertex:T8e,bsdfs:P8e,iridescence_fragment:M8e,bumpmap_pars_fragment:A8e,clipping_planes_fragment:I8e,clipping_planes_pars_fragment:D8e,clipping_planes_pars_vertex:N8e,clipping_planes_vertex:R8e,color_fragment:O8e,color_pars_fragment:L8e,color_pars_vertex:F8e,color_vertex:k8e,common:$8e,cube_uv_reflection_fragment:U8e,defaultnormal_vertex:V8e,displacementmap_pars_vertex:z8e,displacementmap_vertex:G8e,emissivemap_fragment:B8e,emissivemap_pars_fragment:q8e,colorspace_fragment:H8e,colorspace_pars_fragment:j8e,envmap_fragment:Y8e,envmap_common_pars_fragment:X8e,envmap_pars_fragment:W8e,envmap_pars_vertex:Z8e,envmap_physical_pars_fragment:aqe,envmap_vertex:K8e,fog_vertex:Q8e,fog_pars_vertex:J8e,fog_fragment:eqe,fog_pars_fragment:tqe,gradientmap_pars_fragment:iqe,lightmap_pars_fragment:sqe,lights_lambert_fragment:nqe,lights_lambert_pars_fragment:rqe,lights_pars_begin:oqe,lights_toon_fragment:lqe,lights_toon_pars_fragment:uqe,lights_phong_fragment:cqe,lights_phong_pars_fragment:hqe,lights_physical_fragment:dqe,lights_physical_pars_fragment:mqe,lights_fragment_begin:pqe,lights_fragment_maps:fqe,lights_fragment_end:gqe,logdepthbuf_fragment:_qe,logdepthbuf_pars_fragment:yqe,logdepthbuf_pars_vertex:vqe,logdepthbuf_vertex:xqe,map_fragment:bqe,map_pars_fragment:wqe,map_particle_fragment:Sqe,map_particle_pars_fragment:Eqe,metalnessmap_fragment:Cqe,metalnessmap_pars_fragment:Tqe,morphinstance_vertex:Pqe,morphcolor_vertex:Mqe,morphnormal_vertex:Aqe,morphtarget_pars_vertex:Iqe,morphtarget_vertex:Dqe,normal_fragment_begin:Nqe,normal_fragment_maps:Rqe,normal_pars_fragment:Oqe,normal_pars_vertex:Lqe,normal_vertex:Fqe,normalmap_pars_fragment:kqe,clearcoat_normal_fragment_begin:$qe,clearcoat_normal_fragment_maps:Uqe,clearcoat_pars_fragment:Vqe,iridescence_pars_fragment:zqe,opaque_fragment:Gqe,packing:Bqe,premultiplied_alpha_fragment:qqe,project_vertex:Hqe,dithering_fragment:jqe,dithering_pars_fragment:Yqe,roughnessmap_fragment:Xqe,roughnessmap_pars_fragment:Wqe,shadowmap_pars_fragment:Zqe,shadowmap_pars_vertex:Kqe,shadowmap_vertex:Qqe,shadowmask_pars_fragment:Jqe,skinbase_vertex:e9e,skinning_pars_vertex:t9e,skinning_vertex:i9e,skinnormal_vertex:s9e,specularmap_fragment:n9e,specularmap_pars_fragment:r9e,tonemapping_fragment:o9e,tonemapping_pars_fragment:a9e,transmission_fragment:l9e,transmission_pars_fragment:u9e,uv_pars_fragment:c9e,uv_pars_vertex:h9e,uv_vertex:d9e,worldpos_vertex:m9e,background_vert:p9e,background_frag:f9e,backgroundCube_vert:g9e,backgroundCube_frag:_9e,cube_vert:y9e,cube_frag:v9e,depth_vert:x9e,depth_frag:b9e,distanceRGBA_vert:w9e,distanceRGBA_frag:S9e,equirect_vert:E9e,equirect_frag:C9e,linedashed_vert:T9e,linedashed_frag:P9e,meshbasic_vert:M9e,meshbasic_frag:A9e,meshlambert_vert:I9e,meshlambert_frag:D9e,meshmatcap_vert:N9e,meshmatcap_frag:R9e,meshnormal_vert:O9e,meshnormal_frag:L9e,meshphong_vert:F9e,meshphong_frag:k9e,meshphysical_vert:$9e,meshphysical_frag:U9e,meshtoon_vert:V9e,meshtoon_frag:z9e,points_vert:G9e,points_frag:B9e,shadow_vert:q9e,shadow_frag:H9e,sprite_vert:j9e,sprite_frag:Y9e},kt={common:{diffuse:{value:new bn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new cs},alphaMap:{value:null},alphaMapTransform:{value:new cs},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new cs}},envmap:{envMap:{value:null},envMapRotation:{value:new cs},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new cs}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new cs}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new cs},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new cs},normalScale:{value:new hs(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new cs},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new cs}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new cs}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new cs}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new bn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new bn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new cs},alphaTest:{value:0},uvTransform:{value:new cs}},sprite:{diffuse:{value:new bn(16777215)},opacity:{value:1},center:{value:new hs(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new cs},alphaMap:{value:null},alphaMapTransform:{value:new cs},alphaTest:{value:0}}},xm={basic:{uniforms:Cl([kt.common,kt.specularmap,kt.envmap,kt.aomap,kt.lightmap,kt.fog]),vertexShader:fs.meshbasic_vert,fragmentShader:fs.meshbasic_frag},lambert:{uniforms:Cl([kt.common,kt.specularmap,kt.envmap,kt.aomap,kt.lightmap,kt.emissivemap,kt.bumpmap,kt.normalmap,kt.displacementmap,kt.fog,kt.lights,{emissive:{value:new bn(0)}}]),vertexShader:fs.meshlambert_vert,fragmentShader:fs.meshlambert_frag},phong:{uniforms:Cl([kt.common,kt.specularmap,kt.envmap,kt.aomap,kt.lightmap,kt.emissivemap,kt.bumpmap,kt.normalmap,kt.displacementmap,kt.fog,kt.lights,{emissive:{value:new bn(0)},specular:{value:new bn(1118481)},shininess:{value:30}}]),vertexShader:fs.meshphong_vert,fragmentShader:fs.meshphong_frag},standard:{uniforms:Cl([kt.common,kt.envmap,kt.aomap,kt.lightmap,kt.emissivemap,kt.bumpmap,kt.normalmap,kt.displacementmap,kt.roughnessmap,kt.metalnessmap,kt.fog,kt.lights,{emissive:{value:new bn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:fs.meshphysical_vert,fragmentShader:fs.meshphysical_frag},toon:{uniforms:Cl([kt.common,kt.aomap,kt.lightmap,kt.emissivemap,kt.bumpmap,kt.normalmap,kt.displacementmap,kt.gradientmap,kt.fog,kt.lights,{emissive:{value:new bn(0)}}]),vertexShader:fs.meshtoon_vert,fragmentShader:fs.meshtoon_frag},matcap:{uniforms:Cl([kt.common,kt.bumpmap,kt.normalmap,kt.displacementmap,kt.fog,{matcap:{value:null}}]),vertexShader:fs.meshmatcap_vert,fragmentShader:fs.meshmatcap_frag},points:{uniforms:Cl([kt.points,kt.fog]),vertexShader:fs.points_vert,fragmentShader:fs.points_frag},dashed:{uniforms:Cl([kt.common,kt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:fs.linedashed_vert,fragmentShader:fs.linedashed_frag},depth:{uniforms:Cl([kt.common,kt.displacementmap]),vertexShader:fs.depth_vert,fragmentShader:fs.depth_frag},normal:{uniforms:Cl([kt.common,kt.bumpmap,kt.normalmap,kt.displacementmap,{opacity:{value:1}}]),vertexShader:fs.meshnormal_vert,fragmentShader:fs.meshnormal_frag},sprite:{uniforms:Cl([kt.sprite,kt.fog]),vertexShader:fs.sprite_vert,fragmentShader:fs.sprite_frag},background:{uniforms:{uvTransform:{value:new cs},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:fs.background_vert,fragmentShader:fs.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new cs}},vertexShader:fs.backgroundCube_vert,fragmentShader:fs.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:fs.cube_vert,fragmentShader:fs.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:fs.equirect_vert,fragmentShader:fs.equirect_frag},distanceRGBA:{uniforms:Cl([kt.common,kt.displacementmap,{referencePosition:{value:new ze},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:fs.distanceRGBA_vert,fragmentShader:fs.distanceRGBA_frag},shadow:{uniforms:Cl([kt.lights,kt.fog,{color:{value:new bn(0)},opacity:{value:1}}]),vertexShader:fs.shadow_vert,fragmentShader:fs.shadow_frag}};xm.physical={uniforms:Cl([xm.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new cs},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new cs},clearcoatNormalScale:{value:new hs(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new cs},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new cs},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new cs},sheen:{value:0},sheenColor:{value:new bn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new cs},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new cs},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new cs},transmissionSamplerSize:{value:new hs},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new cs},attenuationDistance:{value:0},attenuationColor:{value:new bn(0)},specularColor:{value:new bn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new cs},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new cs},anisotropyVector:{value:new hs},anisotropyMap:{value:null},anisotropyMapTransform:{value:new cs}}]),vertexShader:fs.meshphysical_vert,fragmentShader:fs.meshphysical_frag};const EN={r:0,b:0,g:0},T0=new zf,X9e=new Gr;function W9e(t,e,i,s,n,r,o){const a=new bn(0);let l=r===!0?0:1,u,c,h=null,d=0,m=null;function f(T){let C=T.isScene===!0?T.background:null;return C&&C.isTexture&&(C=(T.backgroundBlurriness>0?i:e).get(C)),C}function _(T){let C=!1;const M=f(T);M===null?x(a,l):M&&M.isColor&&(x(M,1),C=!0);const A=t.xr.getEnvironmentBlendMode();A==="additive"?s.buffers.color.setClear(0,0,0,1,o):A==="alpha-blend"&&s.buffers.color.setClear(0,0,0,0,o),(t.autoClear||C)&&(s.buffers.depth.setTest(!0),s.buffers.depth.setMask(!0),s.buffers.color.setMask(!0),t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil))}function v(T,C){const M=f(C);M&&(M.isCubeTexture||M.mapping===$4)?(c===void 0&&(c=new Qc(new bA(1,1,1),new Ty({name:"BackgroundCubeMaterial",uniforms:PS(xm.backgroundCube.uniforms),vertexShader:xm.backgroundCube.vertexShader,fragmentShader:xm.backgroundCube.fragmentShader,side:bu,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(A,I,L){this.matrixWorld.copyPosition(L.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(c)),T0.copy(C.backgroundRotation),T0.x*=-1,T0.y*=-1,T0.z*=-1,M.isCubeTexture&&M.isRenderTargetTexture===!1&&(T0.y*=-1,T0.z*=-1),c.material.uniforms.envMap.value=M,c.material.uniforms.flipEnvMap.value=M.isCubeTexture&&M.isRenderTargetTexture===!1?-1:1,c.material.uniforms.backgroundBlurriness.value=C.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=C.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(X9e.makeRotationFromEuler(T0)),c.material.toneMapped=Zs.getTransfer(M.colorSpace)!==Mn,(h!==M||d!==M.version||m!==t.toneMapping)&&(c.material.needsUpdate=!0,h=M,d=M.version,m=t.toneMapping),c.layers.enableAll(),T.unshift(c,c.geometry,c.material,0,0,null)):M&&M.isTexture&&(u===void 0&&(u=new Qc(new MS(2,2),new Ty({name:"BackgroundMaterial",uniforms:PS(xm.background.uniforms),vertexShader:xm.background.vertexShader,fragmentShader:xm.background.fragmentShader,side:Cy,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(u)),u.material.uniforms.t2D.value=M,u.material.uniforms.backgroundIntensity.value=C.backgroundIntensity,u.material.toneMapped=Zs.getTransfer(M.colorSpace)!==Mn,M.matrixAutoUpdate===!0&&M.updateMatrix(),u.material.uniforms.uvTransform.value.copy(M.matrix),(h!==M||d!==M.version||m!==t.toneMapping)&&(u.material.needsUpdate=!0,h=M,d=M.version,m=t.toneMapping),u.layers.enableAll(),T.unshift(u,u.geometry,u.material,0,0,null))}function x(T,C){T.getRGB(EN,fye(t)),s.buffers.color.setClear(EN.r,EN.g,EN.b,C,o)}function w(){c!==void 0&&(c.geometry.dispose(),c.material.dispose(),c=void 0),u!==void 0&&(u.geometry.dispose(),u.material.dispose(),u=void 0)}return{getClearColor:function(){return a},setClearColor:function(T,C=1){a.set(T),l=C,x(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(T){l=T,x(a,l)},render:_,addToRenderList:v,dispose:w}}function Z9e(t,e){const i=t.getParameter(t.MAX_VERTEX_ATTRIBS),s={},n=d(null);let r=n,o=!1;function a(O,U,$,B,V){let H=!1;const Y=h(B,$,U);r!==Y&&(r=Y,u(r.object)),H=m(O,B,$,V),H&&f(O,B,$,V),V!==null&&e.update(V,t.ELEMENT_ARRAY_BUFFER),(H||o)&&(o=!1,C(O,U,$,B),V!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.get(V).buffer))}function l(){return t.createVertexArray()}function u(O){return t.bindVertexArray(O)}function c(O){return t.deleteVertexArray(O)}function h(O,U,$){const B=$.wireframe===!0;let V=s[O.id];V===void 0&&(V={},s[O.id]=V);let H=V[U.id];H===void 0&&(H={},V[U.id]=H);let Y=H[B];return Y===void 0&&(Y=d(l()),H[B]=Y),Y}function d(O){const U=[],$=[],B=[];for(let V=0;V<i;V++)U[V]=0,$[V]=0,B[V]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:U,enabledAttributes:$,attributeDivisors:B,object:O,attributes:{},index:null}}function m(O,U,$,B){const V=r.attributes,H=U.attributes;let Y=0;const W=$.getAttributes();for(const ee in W)if(W[ee].location>=0){const j=V[ee];let oe=H[ee];if(oe===void 0&&(ee==="instanceMatrix"&&O.instanceMatrix&&(oe=O.instanceMatrix),ee==="instanceColor"&&O.instanceColor&&(oe=O.instanceColor)),j===void 0||j.attribute!==oe||oe&&j.data!==oe.data)return!0;Y++}return r.attributesNum!==Y||r.index!==B}function f(O,U,$,B){const V={},H=U.attributes;let Y=0;const W=$.getAttributes();for(const ee in W)if(W[ee].location>=0){let j=H[ee];j===void 0&&(ee==="instanceMatrix"&&O.instanceMatrix&&(j=O.instanceMatrix),ee==="instanceColor"&&O.instanceColor&&(j=O.instanceColor));const oe={};oe.attribute=j,j&&j.data&&(oe.data=j.data),V[ee]=oe,Y++}r.attributes=V,r.attributesNum=Y,r.index=B}function _(){const O=r.newAttributes;for(let U=0,$=O.length;U<$;U++)O[U]=0}function v(O){x(O,0)}function x(O,U){const $=r.newAttributes,B=r.enabledAttributes,V=r.attributeDivisors;$[O]=1,B[O]===0&&(t.enableVertexAttribArray(O),B[O]=1),V[O]!==U&&(t.vertexAttribDivisor(O,U),V[O]=U)}function w(){const O=r.newAttributes,U=r.enabledAttributes;for(let $=0,B=U.length;$<B;$++)U[$]!==O[$]&&(t.disableVertexAttribArray($),U[$]=0)}function T(O,U,$,B,V,H,Y){Y===!0?t.vertexAttribIPointer(O,U,$,V,H):t.vertexAttribPointer(O,U,$,B,V,H)}function C(O,U,$,B){_();const V=B.attributes,H=$.getAttributes(),Y=U.defaultAttributeValues;for(const W in H){const ee=H[W];if(ee.location>=0){let ne=V[W];if(ne===void 0&&(W==="instanceMatrix"&&O.instanceMatrix&&(ne=O.instanceMatrix),W==="instanceColor"&&O.instanceColor&&(ne=O.instanceColor)),ne!==void 0){const j=ne.normalized,oe=ne.itemSize,ve=e.get(ne);if(ve===void 0)continue;const Ye=ve.buffer,de=ve.type,fe=ve.bytesPerElement,Ne=de===t.INT||de===t.UNSIGNED_INT||ne.gpuType===Yj;if(ne.isInterleavedBufferAttribute){const je=ne.data,Ee=je.stride,Zt=ne.offset;if(je.isInstancedInterleavedBuffer){for(let qt=0;qt<ee.locationSize;qt++)x(ee.location+qt,je.meshPerAttribute);O.isInstancedMesh!==!0&&B._maxInstanceCount===void 0&&(B._maxInstanceCount=je.meshPerAttribute*je.count)}else for(let qt=0;qt<ee.locationSize;qt++)v(ee.location+qt);t.bindBuffer(t.ARRAY_BUFFER,Ye);for(let qt=0;qt<ee.locationSize;qt++)T(ee.location+qt,oe/ee.locationSize,de,j,Ee*fe,(Zt+oe/ee.locationSize*qt)*fe,Ne)}else{if(ne.isInstancedBufferAttribute){for(let je=0;je<ee.locationSize;je++)x(ee.location+je,ne.meshPerAttribute);O.isInstancedMesh!==!0&&B._maxInstanceCount===void 0&&(B._maxInstanceCount=ne.meshPerAttribute*ne.count)}else for(let je=0;je<ee.locationSize;je++)v(ee.location+je);t.bindBuffer(t.ARRAY_BUFFER,Ye);for(let je=0;je<ee.locationSize;je++)T(ee.location+je,oe/ee.locationSize,de,j,oe*fe,oe/ee.locationSize*je*fe,Ne)}}else if(Y!==void 0){const j=Y[W];if(j!==void 0)switch(j.length){case 2:t.vertexAttrib2fv(ee.location,j);break;case 3:t.vertexAttrib3fv(ee.location,j);break;case 4:t.vertexAttrib4fv(ee.location,j);break;default:t.vertexAttrib1fv(ee.location,j)}}}}w()}function M(){L();for(const O in s){const U=s[O];for(const $ in U){const B=U[$];for(const V in B)c(B[V].object),delete B[V];delete U[$]}delete s[O]}}function A(O){if(s[O.id]===void 0)return;const U=s[O.id];for(const $ in U){const B=U[$];for(const V in B)c(B[V].object),delete B[V];delete U[$]}delete s[O.id]}function I(O){for(const U in s){const $=s[U];if($[O.id]===void 0)continue;const B=$[O.id];for(const V in B)c(B[V].object),delete B[V];delete $[O.id]}}function L(){D(),o=!0,r!==n&&(r=n,u(r.object))}function D(){n.geometry=null,n.program=null,n.wireframe=!1}return{setup:a,reset:L,resetDefaultState:D,dispose:M,releaseStatesOfGeometry:A,releaseStatesOfProgram:I,initAttributes:_,enableAttribute:v,disableUnusedAttributes:w}}function K9e(t,e,i){let s;function n(u){s=u}function r(u,c){t.drawArrays(s,u,c),i.update(c,s,1)}function o(u,c,h){h!==0&&(t.drawArraysInstanced(s,u,c,h),i.update(c,s,h))}function a(u,c,h){if(h===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(s,u,0,c,0,h);let m=0;for(let f=0;f<h;f++)m+=c[f];i.update(m,s,1)}function l(u,c,h,d){if(h===0)return;const m=e.get("WEBGL_multi_draw");if(m===null)for(let f=0;f<u.length;f++)o(u[f],c[f],d[f]);else{m.multiDrawArraysInstancedWEBGL(s,u,0,c,0,d,0,h);let f=0;for(let _=0;_<h;_++)f+=c[_]*d[_];i.update(f,s,1)}}this.setMode=n,this.render=r,this.renderInstances=o,this.renderMultiDraw=a,this.renderMultiDrawInstances=l}function Q9e(t,e,i,s){let n;function r(){if(n!==void 0)return n;if(e.has("EXT_texture_filter_anisotropic")===!0){const I=e.get("EXT_texture_filter_anisotropic");n=t.getParameter(I.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n}function o(I){return!(I!==cd&&s.convert(I)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT))}function a(I){const L=I===yA&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(I!==Vf&&s.convert(I)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE)&&I!==wf&&!L)}function l(I){if(I==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";I="mediump"}return I==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let u=i.precision!==void 0?i.precision:"highp";const c=l(u);c!==u&&(console.warn("THREE.WebGLRenderer:",u,"not supported, using",c,"instead."),u=c);const h=i.logarithmicDepthBuffer===!0,d=i.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),m=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),f=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),_=t.getParameter(t.MAX_TEXTURE_SIZE),v=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),x=t.getParameter(t.MAX_VERTEX_ATTRIBS),w=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),T=t.getParameter(t.MAX_VARYING_VECTORS),C=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),M=f>0,A=t.getParameter(t.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:r,getMaxPrecision:l,textureFormatReadable:o,textureTypeReadable:a,precision:u,logarithmicDepthBuffer:h,reverseDepthBuffer:d,maxTextures:m,maxVertexTextures:f,maxTextureSize:_,maxCubemapSize:v,maxAttributes:x,maxVertexUniforms:w,maxVaryings:T,maxFragmentUniforms:C,vertexTextures:M,maxSamples:A}}function J9e(t){const e=this;let i=null,s=0,n=!1,r=!1;const o=new L_,a=new cs,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d){const m=h.length!==0||d||s!==0||n;return n=d,s=h.length,m},this.beginShadows=function(){r=!0,c(null)},this.endShadows=function(){r=!1},this.setGlobalState=function(h,d){i=c(h,d,0)},this.setState=function(h,d,m){const f=h.clippingPlanes,_=h.clipIntersection,v=h.clipShadows,x=t.get(h);if(!n||f===null||f.length===0||r&&!v)r?c(null):u();else{const w=r?0:s,T=w*4;let C=x.clippingState||null;l.value=C,C=c(f,d,T,m);for(let M=0;M!==T;++M)C[M]=i[M];x.clippingState=C,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=w}};function u(){l.value!==i&&(l.value=i,l.needsUpdate=s>0),e.numPlanes=s,e.numIntersection=0}function c(h,d,m,f){const _=h!==null?h.length:0;let v=null;if(_!==0){if(v=l.value,f!==!0||v===null){const x=m+_*4,w=d.matrixWorldInverse;a.getNormalMatrix(w),(v===null||v.length<x)&&(v=new Float32Array(x));for(let T=0,C=m;T!==_;++T,C+=4)o.copy(h[T]).applyMatrix4(w,a),o.normal.toArray(v,C),v[C+3]=o.constant}l.value=v,l.needsUpdate=!0}return e.numPlanes=_,e.numIntersection=0,v}}function eHe(t){let e=new WeakMap;function i(o,a){return a===ZB?o.mapping=ES:a===KB&&(o.mapping=CS),o}function s(o){if(o&&o.isTexture){const a=o.mapping;if(a===ZB||a===KB)if(e.has(o)){const l=e.get(o).texture;return i(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const u=new ZBe(l.height);return u.fromEquirectangularTexture(t,o),e.set(o,u),o.addEventListener("dispose",n),i(u.texture,o.mapping)}else return null}}return o}function n(o){const a=o.target;a.removeEventListener("dispose",n);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function r(){e=new WeakMap}return{get:s,dispose:r}}const fw=4,cie=[.125,.215,.35,.446,.526,.582],Av=20,O5=new vye,hie=new bn;let L5=null,F5=0,k5=0,$5=!1;const K0=(1+Math.sqrt(5))/2,ib=1/K0,die=[new ze(-K0,ib,0),new ze(K0,ib,0),new ze(-ib,0,K0),new ze(ib,0,K0),new ze(0,K0,-ib),new ze(0,K0,ib),new ze(-1,1,-1),new ze(1,1,-1),new ze(-1,1,1),new ze(1,1,1)],tHe=new ze;class mie{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,i=0,s=.1,n=100,r={}){const{size:o=256,position:a=tHe}=r;L5=this._renderer.getRenderTarget(),F5=this._renderer.getActiveCubeFace(),k5=this._renderer.getActiveMipmapLevel(),$5=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(o);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,s,n,l,a),i>0&&this._blur(l,0,0,i),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,i=null){return this._fromTexture(e,i)}fromCubemap(e,i=null){return this._fromTexture(e,i)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=gie(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=fie(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(L5,F5,k5),this._renderer.xr.enabled=$5,e.scissorTest=!1,CN(e,0,0,e.width,e.height)}_fromTexture(e,i){e.mapping===ES||e.mapping===CS?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),L5=this._renderer.getRenderTarget(),F5=this._renderer.getActiveCubeFace(),k5=this._renderer.getActiveMipmapLevel(),$5=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const s=i||this._allocateTargets();return this._textureToCubeUV(e,s),this._applyPMREM(s),this._cleanup(s),s}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),i=4*this._cubeSize,s={magFilter:Cm,minFilter:Cm,generateMipmaps:!1,type:yA,format:cd,colorSpace:TS,depthBuffer:!1},n=pie(e,i,s);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==i){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=pie(e,i,s);const{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=iHe(r)),this._blurMaterial=sHe(r,e,i)}return n}_compileMaterial(e){const i=new Qc(this._lodPlanes[0],e);this._renderer.compile(i,O5)}_sceneToCubeUV(e,i,s,n,r){const l=new jc(90,1,i,s),u=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],h=this._renderer,d=h.autoClear,m=h.toneMapping;h.getClearColor(hie),h.toneMapping=ly,h.autoClear=!1;const f=new eP({name:"PMREM.Background",side:bu,depthWrite:!1,depthTest:!1}),_=new Qc(new bA,f);let v=!1;const x=e.background;x?x.isColor&&(f.color.copy(x),e.background=null,v=!0):(f.color.copy(hie),v=!0);for(let w=0;w<6;w++){const T=w%3;T===0?(l.up.set(0,u[w],0),l.position.set(r.x,r.y,r.z),l.lookAt(r.x+c[w],r.y,r.z)):T===1?(l.up.set(0,0,u[w]),l.position.set(r.x,r.y,r.z),l.lookAt(r.x,r.y+c[w],r.z)):(l.up.set(0,u[w],0),l.position.set(r.x,r.y,r.z),l.lookAt(r.x,r.y,r.z+c[w]));const C=this._cubeSize;CN(n,T*C,w>2?C:0,C,C),h.setRenderTarget(n),v&&h.render(_,l),h.render(e,l)}_.geometry.dispose(),_.material.dispose(),h.toneMapping=m,h.autoClear=d,e.background=x}_textureToCubeUV(e,i){const s=this._renderer,n=e.mapping===ES||e.mapping===CS;n?(this._cubemapMaterial===null&&(this._cubemapMaterial=gie()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=fie());const r=n?this._cubemapMaterial:this._equirectMaterial,o=new Qc(this._lodPlanes[0],r),a=r.uniforms;a.envMap.value=e;const l=this._cubeSize;CN(i,0,0,3*l,2*l),s.setRenderTarget(i),s.render(o,O5)}_applyPMREM(e){const i=this._renderer,s=i.autoClear;i.autoClear=!1;const n=this._lodPlanes.length;for(let r=1;r<n;r++){const o=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),a=die[(n-r-1)%die.length];this._blur(e,r-1,r,o,a)}i.autoClear=s}_blur(e,i,s,n,r){const o=this._pingPongRenderTarget;this._halfBlur(e,o,i,s,n,"latitudinal",r),this._halfBlur(o,e,s,s,n,"longitudinal",r)}_halfBlur(e,i,s,n,r,o,a){const l=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const c=3,h=new Qc(this._lodPlanes[n],u),d=u.uniforms,m=this._sizeLods[s]-1,f=isFinite(r)?Math.PI/(2*m):2*Math.PI/(2*Av-1),_=r/f,v=isFinite(r)?1+Math.floor(c*_):Av;v>Av&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${v} samples when the maximum is set to ${Av}`);const x=[];let w=0;for(let I=0;I<Av;++I){const L=I/_,D=Math.exp(-L*L/2);x.push(D),I===0?w+=D:I<v&&(w+=2*D)}for(let I=0;I<x.length;I++)x[I]=x[I]/w;d.envMap.value=e.texture,d.samples.value=v,d.weights.value=x,d.latitudinal.value=o==="latitudinal",a&&(d.poleAxis.value=a);const{_lodMax:T}=this;d.dTheta.value=f,d.mipInt.value=T-s;const C=this._sizeLods[n],M=3*C*(n>T-fw?n-T+fw:0),A=4*(this._cubeSize-C);CN(i,M,A,3*C,2*C),l.setRenderTarget(i),l.render(h,O5)}}function iHe(t){const e=[],i=[],s=[];let n=t;const r=t-fw+1+cie.length;for(let o=0;o<r;o++){const a=Math.pow(2,n);i.push(a);let l=1/a;o>t-fw?l=cie[o-t+fw-1]:o===0&&(l=0),s.push(l);const u=1/(a-2),c=-u,h=1+u,d=[c,c,h,c,h,h,c,c,h,h,c,h],m=6,f=6,_=3,v=2,x=1,w=new Float32Array(_*f*m),T=new Float32Array(v*f*m),C=new Float32Array(x*f*m);for(let A=0;A<m;A++){const I=A%3*2/3-1,L=A>2?0:-1,D=[I,L,0,I+2/3,L,0,I+2/3,L+1,0,I,L,0,I+2/3,L+1,0,I,L+1,0];w.set(D,_*f*A),T.set(d,v*f*A);const O=[A,A,A,A,A,A];C.set(O,x*f*A)}const M=new qy;M.setAttribute("position",new Dm(w,_)),M.setAttribute("uv",new Dm(T,v)),M.setAttribute("faceIndex",new Dm(C,x)),e.push(M),n>fw&&n--}return{lodPlanes:e,sizeLods:i,sigmas:s}}function pie(t,e,i){const s=new D1(t,e,i);return s.texture.mapping=$4,s.texture.name="PMREM.cubeUv",s.scissorTest=!0,s}function CN(t,e,i,s,n){t.viewport.set(e,i,s,n),t.scissor.set(e,i,s,n)}function sHe(t,e,i){const s=new Float32Array(Av),n=new ze(0,1,0);return new Ty({name:"SphericalGaussianBlur",defines:{n:Av,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:s},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:nY(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:ay,depthTest:!1,depthWrite:!1})}function fie(){return new Ty({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:nY(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:ay,depthTest:!1,depthWrite:!1})}function gie(){return new Ty({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:nY(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:ay,depthTest:!1,depthWrite:!1})}function nY(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function nHe(t){let e=new WeakMap,i=null;function s(a){if(a&&a.isTexture){const l=a.mapping,u=l===ZB||l===KB,c=l===ES||l===CS;if(u||c){let h=e.get(a);const d=h!==void 0?h.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==d)return i===null&&(i=new mie(t)),h=u?i.fromEquirectangular(a,h):i.fromCubemap(a,h),h.texture.pmremVersion=a.pmremVersion,e.set(a,h),h.texture;if(h!==void 0)return h.texture;{const m=a.image;return u&&m&&m.height>0||c&&m&&n(m)?(i===null&&(i=new mie(t)),h=u?i.fromEquirectangular(a):i.fromCubemap(a),h.texture.pmremVersion=a.pmremVersion,e.set(a,h),a.addEventListener("dispose",r),h.texture):null}}}return a}function n(a){let l=0;const u=6;for(let c=0;c<u;c++)a[c]!==void 0&&l++;return l===u}function r(a){const l=a.target;l.removeEventListener("dispose",r);const u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}function o(){e=new WeakMap,i!==null&&(i.dispose(),i=null)}return{get:s,dispose:o}}function rHe(t){const e={};function i(s){if(e[s]!==void 0)return e[s];let n;switch(s){case"WEBGL_depth_texture":n=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=t.getExtension(s)}return e[s]=n,n}return{has:function(s){return i(s)!==null},init:function(){i("EXT_color_buffer_float"),i("WEBGL_clip_cull_distance"),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture"),i("WEBGL_render_shared_exponent")},get:function(s){const n=i(s);return n===null&&x3("THREE.WebGLRenderer: "+s+" extension not supported."),n}}}function oHe(t,e,i,s){const n={},r=new WeakMap;function o(h){const d=h.target;d.index!==null&&e.remove(d.index);for(const f in d.attributes)e.remove(d.attributes[f]);d.removeEventListener("dispose",o),delete n[d.id];const m=r.get(d);m&&(e.remove(m),r.delete(d)),s.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,i.memory.geometries--}function a(h,d){return n[d.id]===!0||(d.addEventListener("dispose",o),n[d.id]=!0,i.memory.geometries++),d}function l(h){const d=h.attributes;for(const m in d)e.update(d[m],t.ARRAY_BUFFER)}function u(h){const d=[],m=h.index,f=h.attributes.position;let _=0;if(m!==null){const w=m.array;_=m.version;for(let T=0,C=w.length;T<C;T+=3){const M=w[T+0],A=w[T+1],I=w[T+2];d.push(M,A,A,I,I,M)}}else if(f!==void 0){const w=f.array;_=f.version;for(let T=0,C=w.length/3-1;T<C;T+=3){const M=T+0,A=T+1,I=T+2;d.push(M,A,A,I,I,M)}}else return;const v=new(lye(d)?pye:mye)(d,1);v.version=_;const x=r.get(h);x&&e.remove(x),r.set(h,v)}function c(h){const d=r.get(h);if(d){const m=h.index;m!==null&&d.version<m.version&&u(h)}else u(h);return r.get(h)}return{get:a,update:l,getWireframeAttribute:c}}function aHe(t,e,i){let s;function n(d){s=d}let r,o;function a(d){r=d.type,o=d.bytesPerElement}function l(d,m){t.drawElements(s,m,r,d*o),i.update(m,s,1)}function u(d,m,f){f!==0&&(t.drawElementsInstanced(s,m,r,d*o,f),i.update(m,s,f))}function c(d,m,f){if(f===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(s,m,0,r,d,0,f);let v=0;for(let x=0;x<f;x++)v+=m[x];i.update(v,s,1)}function h(d,m,f,_){if(f===0)return;const v=e.get("WEBGL_multi_draw");if(v===null)for(let x=0;x<d.length;x++)u(d[x]/o,m[x],_[x]);else{v.multiDrawElementsInstancedWEBGL(s,m,0,r,d,0,_,0,f);let x=0;for(let w=0;w<f;w++)x+=m[w]*_[w];i.update(x,s,1)}}this.setMode=n,this.setIndex=a,this.render=l,this.renderInstances=u,this.renderMultiDraw=c,this.renderMultiDrawInstances=h}function lHe(t){const e={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function s(r,o,a){switch(i.calls++,o){case t.TRIANGLES:i.triangles+=a*(r/3);break;case t.LINES:i.lines+=a*(r/2);break;case t.LINE_STRIP:i.lines+=a*(r-1);break;case t.LINE_LOOP:i.lines+=a*r;break;case t.POINTS:i.points+=a*r;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function n(){i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:e,render:i,programs:null,autoReset:!0,reset:n,update:s}}function uHe(t,e,i){const s=new WeakMap,n=new zr;function r(o,a,l){const u=o.morphTargetInfluences,c=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,h=c!==void 0?c.length:0;let d=s.get(a);if(d===void 0||d.count!==h){let D=function(){I.dispose(),s.delete(a),a.removeEventListener("dispose",D)};d!==void 0&&d.texture.dispose();const m=a.morphAttributes.position!==void 0,f=a.morphAttributes.normal!==void 0,_=a.morphAttributes.color!==void 0,v=a.morphAttributes.position||[],x=a.morphAttributes.normal||[],w=a.morphAttributes.color||[];let T=0;m===!0&&(T=1),f===!0&&(T=2),_===!0&&(T=3);let C=a.attributes.position.count*T,M=1;C>e.maxTextureSize&&(M=Math.ceil(C/e.maxTextureSize),C=e.maxTextureSize);const A=new Float32Array(C*M*4*h),I=new uye(A,C,M,h);I.type=wf,I.needsUpdate=!0;const L=T*4;for(let O=0;O<h;O++){const U=v[O],$=x[O],B=w[O],V=C*M*4*O;for(let H=0;H<U.count;H++){const Y=H*L;m===!0&&(n.fromBufferAttribute(U,H),A[V+Y+0]=n.x,A[V+Y+1]=n.y,A[V+Y+2]=n.z,A[V+Y+3]=0),f===!0&&(n.fromBufferAttribute($,H),A[V+Y+4]=n.x,A[V+Y+5]=n.y,A[V+Y+6]=n.z,A[V+Y+7]=0),_===!0&&(n.fromBufferAttribute(B,H),A[V+Y+8]=n.x,A[V+Y+9]=n.y,A[V+Y+10]=n.z,A[V+Y+11]=B.itemSize===4?n.w:1)}}d={count:h,texture:I,size:new hs(C,M)},s.set(a,d),a.addEventListener("dispose",D)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)l.getUniforms().setValue(t,"morphTexture",o.morphTexture,i);else{let m=0;for(let _=0;_<u.length;_++)m+=u[_];const f=a.morphTargetsRelative?1:1-m;l.getUniforms().setValue(t,"morphTargetBaseInfluence",f),l.getUniforms().setValue(t,"morphTargetInfluences",u)}l.getUniforms().setValue(t,"morphTargetsTexture",d.texture,i),l.getUniforms().setValue(t,"morphTargetsTextureSize",d.size)}return{update:r}}function cHe(t,e,i,s){let n=new WeakMap;function r(l){const u=s.render.frame,c=l.geometry,h=e.get(l,c);if(n.get(h)!==u&&(e.update(h),n.set(h,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),n.get(l)!==u&&(i.update(l.instanceMatrix,t.ARRAY_BUFFER),l.instanceColor!==null&&i.update(l.instanceColor,t.ARRAY_BUFFER),n.set(l,u))),l.isSkinnedMesh){const d=l.skeleton;n.get(d)!==u&&(d.update(),n.set(d,u))}return h}function o(){n=new WeakMap}function a(l){const u=l.target;u.removeEventListener("dispose",a),i.remove(u.instanceMatrix),u.instanceColor!==null&&i.remove(u.instanceColor)}return{update:r,dispose:o}}const bye=new $l,_ie=new yye(1,1),wye=new uye,Sye=new RBe,Eye=new _ye,yie=[],vie=[],xie=new Float32Array(16),bie=new Float32Array(9),wie=new Float32Array(4);function aE(t,e,i){const s=t[0];if(s<=0||s>0)return t;const n=e*i;let r=yie[n];if(r===void 0&&(r=new Float32Array(n),yie[n]=r),e!==0){s.toArray(r,0);for(let o=1,a=0;o!==e;++o)a+=i,t[o].toArray(r,a)}return r}function Uo(t,e){if(t.length!==e.length)return!1;for(let i=0,s=t.length;i<s;i++)if(t[i]!==e[i])return!1;return!0}function Vo(t,e){for(let i=0,s=e.length;i<s;i++)t[i]=e[i]}function V4(t,e){let i=vie[e];i===void 0&&(i=new Int32Array(e),vie[e]=i);for(let s=0;s!==e;++s)i[s]=t.allocateTextureUnit();return i}function hHe(t,e){const i=this.cache;i[0]!==e&&(t.uniform1f(this.addr,e),i[0]=e)}function dHe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(Uo(i,e))return;t.uniform2fv(this.addr,e),Vo(i,e)}}function mHe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else if(e.r!==void 0)(i[0]!==e.r||i[1]!==e.g||i[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),i[0]=e.r,i[1]=e.g,i[2]=e.b);else{if(Uo(i,e))return;t.uniform3fv(this.addr,e),Vo(i,e)}}function pHe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(Uo(i,e))return;t.uniform4fv(this.addr,e),Vo(i,e)}}function fHe(t,e){const i=this.cache,s=e.elements;if(s===void 0){if(Uo(i,e))return;t.uniformMatrix2fv(this.addr,!1,e),Vo(i,e)}else{if(Uo(i,s))return;wie.set(s),t.uniformMatrix2fv(this.addr,!1,wie),Vo(i,s)}}function gHe(t,e){const i=this.cache,s=e.elements;if(s===void 0){if(Uo(i,e))return;t.uniformMatrix3fv(this.addr,!1,e),Vo(i,e)}else{if(Uo(i,s))return;bie.set(s),t.uniformMatrix3fv(this.addr,!1,bie),Vo(i,s)}}function _He(t,e){const i=this.cache,s=e.elements;if(s===void 0){if(Uo(i,e))return;t.uniformMatrix4fv(this.addr,!1,e),Vo(i,e)}else{if(Uo(i,s))return;xie.set(s),t.uniformMatrix4fv(this.addr,!1,xie),Vo(i,s)}}function yHe(t,e){const i=this.cache;i[0]!==e&&(t.uniform1i(this.addr,e),i[0]=e)}function vHe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(Uo(i,e))return;t.uniform2iv(this.addr,e),Vo(i,e)}}function xHe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(Uo(i,e))return;t.uniform3iv(this.addr,e),Vo(i,e)}}function bHe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(Uo(i,e))return;t.uniform4iv(this.addr,e),Vo(i,e)}}function wHe(t,e){const i=this.cache;i[0]!==e&&(t.uniform1ui(this.addr,e),i[0]=e)}function SHe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(Uo(i,e))return;t.uniform2uiv(this.addr,e),Vo(i,e)}}function EHe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(Uo(i,e))return;t.uniform3uiv(this.addr,e),Vo(i,e)}}function CHe(t,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(Uo(i,e))return;t.uniform4uiv(this.addr,e),Vo(i,e)}}function THe(t,e,i){const s=this.cache,n=i.allocateTextureUnit();s[0]!==n&&(t.uniform1i(this.addr,n),s[0]=n);let r;this.type===t.SAMPLER_2D_SHADOW?(_ie.compareFunction=aye,r=_ie):r=bye,i.setTexture2D(e||r,n)}function PHe(t,e,i){const s=this.cache,n=i.allocateTextureUnit();s[0]!==n&&(t.uniform1i(this.addr,n),s[0]=n),i.setTexture3D(e||Sye,n)}function MHe(t,e,i){const s=this.cache,n=i.allocateTextureUnit();s[0]!==n&&(t.uniform1i(this.addr,n),s[0]=n),i.setTextureCube(e||Eye,n)}function AHe(t,e,i){const s=this.cache,n=i.allocateTextureUnit();s[0]!==n&&(t.uniform1i(this.addr,n),s[0]=n),i.setTexture2DArray(e||wye,n)}function IHe(t){switch(t){case 5126:return hHe;case 35664:return dHe;case 35665:return mHe;case 35666:return pHe;case 35674:return fHe;case 35675:return gHe;case 35676:return _He;case 5124:case 35670:return yHe;case 35667:case 35671:return vHe;case 35668:case 35672:return xHe;case 35669:case 35673:return bHe;case 5125:return wHe;case 36294:return SHe;case 36295:return EHe;case 36296:return CHe;case 35678:case 36198:case 36298:case 36306:case 35682:return THe;case 35679:case 36299:case 36307:return PHe;case 35680:case 36300:case 36308:case 36293:return MHe;case 36289:case 36303:case 36311:case 36292:return AHe}}function DHe(t,e){t.uniform1fv(this.addr,e)}function NHe(t,e){const i=aE(e,this.size,2);t.uniform2fv(this.addr,i)}function RHe(t,e){const i=aE(e,this.size,3);t.uniform3fv(this.addr,i)}function OHe(t,e){const i=aE(e,this.size,4);t.uniform4fv(this.addr,i)}function LHe(t,e){const i=aE(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,i)}function FHe(t,e){const i=aE(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,i)}function kHe(t,e){const i=aE(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,i)}function $He(t,e){t.uniform1iv(this.addr,e)}function UHe(t,e){t.uniform2iv(this.addr,e)}function VHe(t,e){t.uniform3iv(this.addr,e)}function zHe(t,e){t.uniform4iv(this.addr,e)}function GHe(t,e){t.uniform1uiv(this.addr,e)}function BHe(t,e){t.uniform2uiv(this.addr,e)}function qHe(t,e){t.uniform3uiv(this.addr,e)}function HHe(t,e){t.uniform4uiv(this.addr,e)}function jHe(t,e,i){const s=this.cache,n=e.length,r=V4(i,n);Uo(s,r)||(t.uniform1iv(this.addr,r),Vo(s,r));for(let o=0;o!==n;++o)i.setTexture2D(e[o]||bye,r[o])}function YHe(t,e,i){const s=this.cache,n=e.length,r=V4(i,n);Uo(s,r)||(t.uniform1iv(this.addr,r),Vo(s,r));for(let o=0;o!==n;++o)i.setTexture3D(e[o]||Sye,r[o])}function XHe(t,e,i){const s=this.cache,n=e.length,r=V4(i,n);Uo(s,r)||(t.uniform1iv(this.addr,r),Vo(s,r));for(let o=0;o!==n;++o)i.setTextureCube(e[o]||Eye,r[o])}function WHe(t,e,i){const s=this.cache,n=e.length,r=V4(i,n);Uo(s,r)||(t.uniform1iv(this.addr,r),Vo(s,r));for(let o=0;o!==n;++o)i.setTexture2DArray(e[o]||wye,r[o])}function ZHe(t){switch(t){case 5126:return DHe;case 35664:return NHe;case 35665:return RHe;case 35666:return OHe;case 35674:return LHe;case 35675:return FHe;case 35676:return kHe;case 5124:case 35670:return $He;case 35667:case 35671:return UHe;case 35668:case 35672:return VHe;case 35669:case 35673:return zHe;case 5125:return GHe;case 36294:return BHe;case 36295:return qHe;case 36296:return HHe;case 35678:case 36198:case 36298:case 36306:case 35682:return jHe;case 35679:case 36299:case 36307:return YHe;case 35680:case 36300:case 36308:case 36293:return XHe;case 36289:case 36303:case 36311:case 36292:return WHe}}class KHe{constructor(e,i,s){this.id=e,this.addr=s,this.cache=[],this.type=i.type,this.setValue=IHe(i.type)}}class QHe{constructor(e,i,s){this.id=e,this.addr=s,this.cache=[],this.type=i.type,this.size=i.size,this.setValue=ZHe(i.type)}}class JHe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,i,s){const n=this.seq;for(let r=0,o=n.length;r!==o;++r){const a=n[r];a.setValue(e,i[a.id],s)}}}const U5=/(\w+)(\])?(\[|\.)?/g;function Sie(t,e){t.seq.push(e),t.map[e.id]=e}function e7e(t,e,i){const s=t.name,n=s.length;for(U5.lastIndex=0;;){const r=U5.exec(s),o=U5.lastIndex;let a=r[1];const l=r[2]==="]",u=r[3];if(l&&(a=a|0),u===void 0||u==="["&&o+2===n){Sie(i,u===void 0?new KHe(a,t,e):new QHe(a,t,e));break}else{let h=i.map[a];h===void 0&&(h=new JHe(a),Sie(i,h)),i=h}}}class b3{constructor(e,i){this.seq=[],this.map={};const s=e.getProgramParameter(i,e.ACTIVE_UNIFORMS);for(let n=0;n<s;++n){const r=e.getActiveUniform(i,n),o=e.getUniformLocation(i,r.name);e7e(r,o,this)}}setValue(e,i,s,n){const r=this.map[i];r!==void 0&&r.setValue(e,s,n)}setOptional(e,i,s){const n=i[s];n!==void 0&&this.setValue(e,s,n)}static upload(e,i,s,n){for(let r=0,o=i.length;r!==o;++r){const a=i[r],l=s[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,n)}}static seqWithValue(e,i){const s=[];for(let n=0,r=e.length;n!==r;++n){const o=e[n];o.id in i&&s.push(o)}return s}}function Eie(t,e,i){const s=t.createShader(e);return t.shaderSource(s,i),t.compileShader(s),s}const t7e=37297;let i7e=0;function s7e(t,e){const i=t.split(`
`),s=[],n=Math.max(e-6,0),r=Math.min(e+6,i.length);for(let o=n;o<r;o++){const a=o+1;s.push(`${a===e?">":" "} ${a}: ${i[o]}`)}return s.join(`
`)}const Cie=new cs;function n7e(t){Zs._getMatrix(Cie,Zs.workingColorSpace,t);const e=`mat3( ${Cie.elements.map(i=>i.toFixed(4))} )`;switch(Zs.getTransfer(t)){case DL:return[e,"LinearTransferOETF"];case Mn:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",t),[e,"LinearTransferOETF"]}}function Tie(t,e,i){const s=t.getShaderParameter(e,t.COMPILE_STATUS),n=t.getShaderInfoLog(e).trim();if(s&&n==="")return"";const r=/ERROR: 0:(\d+)/.exec(n);if(r){const o=parseInt(r[1]);return i.toUpperCase()+`

`+n+`

`+s7e(t.getShaderSource(e),o)}else return n}function r7e(t,e){const i=n7e(e);return[`vec4 ${t}( vec4 value ) {`,`	return ${i[1]}( vec4( value.rgb * ${i[0]}, value.a ) );`,"}"].join(`
`)}function o7e(t,e){let i;switch(e){case sBe:i="Linear";break;case nBe:i="Reinhard";break;case rBe:i="Cineon";break;case oBe:i="ACESFilmic";break;case lBe:i="AgX";break;case uBe:i="Neutral";break;case aBe:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),i="Linear"}return"vec3 "+t+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}const TN=new ze;function a7e(){Zs.getLuminanceCoefficients(TN);const t=TN.x.toFixed(4),e=TN.y.toFixed(4),i=TN.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${t}, ${e}, ${i} );`,"	return dot( weights, rgb );","}"].join(`
`)}function l7e(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(eT).join(`
`)}function u7e(t){const e=[];for(const i in t){const s=t[i];s!==!1&&e.push("#define "+i+" "+s)}return e.join(`
`)}function c7e(t,e){const i={},s=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let n=0;n<s;n++){const r=t.getActiveAttrib(e,n),o=r.name;let a=1;r.type===t.FLOAT_MAT2&&(a=2),r.type===t.FLOAT_MAT3&&(a=3),r.type===t.FLOAT_MAT4&&(a=4),i[o]={type:r.type,location:t.getAttribLocation(e,o),locationSize:a}}return i}function eT(t){return t!==""}function Pie(t,e){const i=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Mie(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const h7e=/^[ \t]*#include +<([\w\d./]+)>/gm;function P8(t){return t.replace(h7e,m7e)}const d7e=new Map;function m7e(t,e){let i=fs[e];if(i===void 0){const s=d7e.get(e);if(s!==void 0)i=fs[s],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,s);else throw new Error("Can not resolve #include <"+e+">")}return P8(i)}const p7e=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Aie(t){return t.replace(p7e,f7e)}function f7e(t,e,i,s){let n="";for(let r=parseInt(e);r<parseInt(i);r++)n+=s.replace(/\[\s*i\s*\]/g,"[ "+r+" ]").replace(/UNROLLED_LOOP_INDEX/g,r);return n}function Iie(t){let e=`precision ${t.precision} float;
	precision ${t.precision} int;
	precision ${t.precision} sampler2D;
	precision ${t.precision} samplerCube;
	precision ${t.precision} sampler3D;
	precision ${t.precision} sampler2DArray;
	precision ${t.precision} sampler2DShadow;
	precision ${t.precision} samplerCubeShadow;
	precision ${t.precision} sampler2DArrayShadow;
	precision ${t.precision} isampler2D;
	precision ${t.precision} isampler3D;
	precision ${t.precision} isamplerCube;
	precision ${t.precision} isampler2DArray;
	precision ${t.precision} usampler2D;
	precision ${t.precision} usampler3D;
	precision ${t.precision} usamplerCube;
	precision ${t.precision} usampler2DArray;
	`;return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function g7e(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===X_e?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===FGe?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===Bp&&(e="SHADOWMAP_TYPE_VSM"),e}function _7e(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case ES:case CS:e="ENVMAP_TYPE_CUBE";break;case $4:e="ENVMAP_TYPE_CUBE_UV";break}return e}function y7e(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case CS:e="ENVMAP_MODE_REFRACTION";break}return e}function v7e(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case W_e:e="ENVMAP_BLENDING_MULTIPLY";break;case tBe:e="ENVMAP_BLENDING_MIX";break;case iBe:e="ENVMAP_BLENDING_ADD";break}return e}function x7e(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const i=Math.log2(e)-2,s=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,i),7*16)),texelHeight:s,maxMip:i}}function b7e(t,e,i,s){const n=t.getContext(),r=i.defines;let o=i.vertexShader,a=i.fragmentShader;const l=g7e(i),u=_7e(i),c=y7e(i),h=v7e(i),d=x7e(i),m=l7e(i),f=u7e(r),_=n.createProgram();let v,x,w=i.glslVersion?"#version "+i.glslVersion+`
`:"";i.isRawShaderMaterial?(v=["#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,f].filter(eT).join(`
`),v.length>0&&(v+=`
`),x=["#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,f].filter(eT).join(`
`),x.length>0&&(x+=`
`)):(v=[Iie(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,f,i.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",i.batching?"#define USE_BATCHING":"",i.batchingColor?"#define USE_BATCHING_COLOR":"",i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.instancingMorph?"#define USE_INSTANCING_MORPH":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+c:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.displacementMap?"#define USE_DISPLACEMENTMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropy?"#define USE_ANISOTROPY":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.mapUv?"#define MAP_UV "+i.mapUv:"",i.alphaMapUv?"#define ALPHAMAP_UV "+i.alphaMapUv:"",i.lightMapUv?"#define LIGHTMAP_UV "+i.lightMapUv:"",i.aoMapUv?"#define AOMAP_UV "+i.aoMapUv:"",i.emissiveMapUv?"#define EMISSIVEMAP_UV "+i.emissiveMapUv:"",i.bumpMapUv?"#define BUMPMAP_UV "+i.bumpMapUv:"",i.normalMapUv?"#define NORMALMAP_UV "+i.normalMapUv:"",i.displacementMapUv?"#define DISPLACEMENTMAP_UV "+i.displacementMapUv:"",i.metalnessMapUv?"#define METALNESSMAP_UV "+i.metalnessMapUv:"",i.roughnessMapUv?"#define ROUGHNESSMAP_UV "+i.roughnessMapUv:"",i.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+i.anisotropyMapUv:"",i.clearcoatMapUv?"#define CLEARCOATMAP_UV "+i.clearcoatMapUv:"",i.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+i.clearcoatNormalMapUv:"",i.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+i.clearcoatRoughnessMapUv:"",i.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+i.iridescenceMapUv:"",i.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+i.iridescenceThicknessMapUv:"",i.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+i.sheenColorMapUv:"",i.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+i.sheenRoughnessMapUv:"",i.specularMapUv?"#define SPECULARMAP_UV "+i.specularMapUv:"",i.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+i.specularColorMapUv:"",i.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+i.specularIntensityMapUv:"",i.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+i.transmissionMapUv:"",i.thicknessMapUv?"#define THICKNESSMAP_UV "+i.thicknessMapUv:"",i.vertexTangents&&i.flatShading===!1?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.morphColors?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.numLightProbes>0?"#define USE_LIGHT_PROBES":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(eT).join(`
`),x=[Iie(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,f,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+u:"",i.envMap?"#define "+c:"",i.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropy?"#define USE_ANISOTROPY":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.dispersion?"#define USE_DISPERSION":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.vertexTangents&&i.flatShading===!1?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor||i.batchingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.numLightProbes>0?"#define USE_LIGHT_PROBES":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==ly?"#define TONE_MAPPING":"",i.toneMapping!==ly?fs.tonemapping_pars_fragment:"",i.toneMapping!==ly?o7e("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",fs.colorspace_pars_fragment,r7e("linearToOutputTexel",i.outputColorSpace),a7e(),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(eT).join(`
`)),o=P8(o),o=Pie(o,i),o=Mie(o,i),a=P8(a),a=Pie(a,i),a=Mie(a,i),o=Aie(o),a=Aie(a),i.isRawShaderMaterial!==!0&&(w=`#version 300 es
`,v=[m,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+v,x=["#define varying in",i.glslVersion===zte?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===zte?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+x);const T=w+v+o,C=w+x+a,M=Eie(n,n.VERTEX_SHADER,T),A=Eie(n,n.FRAGMENT_SHADER,C);n.attachShader(_,M),n.attachShader(_,A),i.index0AttributeName!==void 0?n.bindAttribLocation(_,0,i.index0AttributeName):i.morphTargets===!0&&n.bindAttribLocation(_,0,"position"),n.linkProgram(_);function I(U){if(t.debug.checkShaderErrors){const $=n.getProgramInfoLog(_).trim(),B=n.getShaderInfoLog(M).trim(),V=n.getShaderInfoLog(A).trim();let H=!0,Y=!0;if(n.getProgramParameter(_,n.LINK_STATUS)===!1)if(H=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(n,_,M,A);else{const W=Tie(n,M,"vertex"),ee=Tie(n,A,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(_,n.VALIDATE_STATUS)+`

Material Name: `+U.name+`
Material Type: `+U.type+`

Program Info Log: `+$+`
`+W+`
`+ee)}else $!==""?console.warn("THREE.WebGLProgram: Program Info Log:",$):(B===""||V==="")&&(Y=!1);Y&&(U.diagnostics={runnable:H,programLog:$,vertexShader:{log:B,prefix:v},fragmentShader:{log:V,prefix:x}})}n.deleteShader(M),n.deleteShader(A),L=new b3(n,_),D=c7e(n,_)}let L;this.getUniforms=function(){return L===void 0&&I(this),L};let D;this.getAttributes=function(){return D===void 0&&I(this),D};let O=i.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return O===!1&&(O=n.getProgramParameter(_,t7e)),O},this.destroy=function(){s.releaseStatesOfProgram(this),n.deleteProgram(_),this.program=void 0},this.type=i.shaderType,this.name=i.shaderName,this.id=i7e++,this.cacheKey=e,this.usedTimes=1,this.program=_,this.vertexShader=M,this.fragmentShader=A,this}let w7e=0;class S7e{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.vertexShader,s=e.fragmentShader,n=this._getShaderStage(i),r=this._getShaderStage(s),o=this._getShaderCacheForMaterial(e);return o.has(n)===!1&&(o.add(n),n.usedTimes++),o.has(r)===!1&&(o.add(r),r.usedTimes++),this}remove(e){const i=this.materialCache.get(e);for(const s of i)s.usedTimes--,s.usedTimes===0&&this.shaderCache.delete(s.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const i=this.materialCache;let s=i.get(e);return s===void 0&&(s=new Set,i.set(e,s)),s}_getShaderStage(e){const i=this.shaderCache;let s=i.get(e);return s===void 0&&(s=new E7e(e),i.set(e,s)),s}}class E7e{constructor(e){this.id=w7e++,this.code=e,this.usedTimes=0}}function C7e(t,e,i,s,n,r,o){const a=new hye,l=new S7e,u=new Set,c=[],h=n.logarithmicDepthBuffer,d=n.vertexTextures;let m=n.precision;const f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function _(D){return u.add(D),D===0?"uv":`uv${D}`}function v(D,O,U,$,B){const V=$.fog,H=B.geometry,Y=D.isMeshStandardMaterial?$.environment:null,W=(D.isMeshStandardMaterial?i:e).get(D.envMap||Y),ee=W&&W.mapping===$4?W.image.height:null,ne=f[D.type];D.precision!==null&&(m=n.getMaxPrecision(D.precision),m!==D.precision&&console.warn("THREE.WebGLProgram.getParameters:",D.precision,"not supported, using",m,"instead."));const j=H.morphAttributes.position||H.morphAttributes.normal||H.morphAttributes.color,oe=j!==void 0?j.length:0;let ve=0;H.morphAttributes.position!==void 0&&(ve=1),H.morphAttributes.normal!==void 0&&(ve=2),H.morphAttributes.color!==void 0&&(ve=3);let Ye,de,fe,Ne;if(ne){const Ms=xm[ne];Ye=Ms.vertexShader,de=Ms.fragmentShader}else Ye=D.vertexShader,de=D.fragmentShader,l.update(D),fe=l.getVertexShaderID(D),Ne=l.getFragmentShaderID(D);const je=t.getRenderTarget(),Ee=t.state.buffers.depth.getReversed(),Zt=B.isInstancedMesh===!0,qt=B.isBatchedMesh===!0,Mi=!!D.map,oi=!!D.matcap,si=!!W,me=!!D.aoMap,Bi=!!D.lightMap,pt=!!D.bumpMap,$e=!!D.normalMap,wt=!!D.displacementMap,$i=!!D.emissiveMap,Mt=!!D.metalnessMap,le=!!D.roughnessMap,te=D.anisotropy>0,De=D.clearcoat>0,et=D.dispersion>0,tt=D.iridescence>0,Ze=D.sheen>0,Ct=D.transmission>0,gt=te&&!!D.anisotropyMap,dt=De&&!!D.clearcoatMap,hi=De&&!!D.clearcoatNormalMap,ct=De&&!!D.clearcoatRoughnessMap,xt=tt&&!!D.iridescenceMap,li=tt&&!!D.iridescenceThicknessMap,jt=Ze&&!!D.sheenColorMap,Tt=Ze&&!!D.sheenRoughnessMap,Ii=!!D.specularMap,di=!!D.specularColorMap,ms=!!D.specularIntensityMap,we=Ct&&!!D.transmissionMap,Dt=Ct&&!!D.thicknessMap,Qe=!!D.gradientMap,ot=!!D.alphaMap,Rt=D.alphaTest>0,It=!!D.alphaHash,qi=!!D.extensions;let hn=ly;D.toneMapped&&(je===null||je.isXRRenderTarget===!0)&&(hn=t.toneMapping);const or={shaderID:ne,shaderType:D.type,shaderName:D.name,vertexShader:Ye,fragmentShader:de,defines:D.defines,customVertexShaderID:fe,customFragmentShaderID:Ne,isRawShaderMaterial:D.isRawShaderMaterial===!0,glslVersion:D.glslVersion,precision:m,batching:qt,batchingColor:qt&&B._colorsTexture!==null,instancing:Zt,instancingColor:Zt&&B.instanceColor!==null,instancingMorph:Zt&&B.morphTexture!==null,supportsVertexTextures:d,outputColorSpace:je===null?t.outputColorSpace:je.isXRRenderTarget===!0?je.texture.colorSpace:TS,alphaToCoverage:!!D.alphaToCoverage,map:Mi,matcap:oi,envMap:si,envMapMode:si&&W.mapping,envMapCubeUVHeight:ee,aoMap:me,lightMap:Bi,bumpMap:pt,normalMap:$e,displacementMap:d&&wt,emissiveMap:$i,normalMapObjectSpace:$e&&D.normalMapType===pBe,normalMapTangentSpace:$e&&D.normalMapType===mBe,metalnessMap:Mt,roughnessMap:le,anisotropy:te,anisotropyMap:gt,clearcoat:De,clearcoatMap:dt,clearcoatNormalMap:hi,clearcoatRoughnessMap:ct,dispersion:et,iridescence:tt,iridescenceMap:xt,iridescenceThicknessMap:li,sheen:Ze,sheenColorMap:jt,sheenRoughnessMap:Tt,specularMap:Ii,specularColorMap:di,specularIntensityMap:ms,transmission:Ct,transmissionMap:we,thicknessMap:Dt,gradientMap:Qe,opaque:D.transparent===!1&&D.blending===Rw&&D.alphaToCoverage===!1,alphaMap:ot,alphaTest:Rt,alphaHash:It,combine:D.combine,mapUv:Mi&&_(D.map.channel),aoMapUv:me&&_(D.aoMap.channel),lightMapUv:Bi&&_(D.lightMap.channel),bumpMapUv:pt&&_(D.bumpMap.channel),normalMapUv:$e&&_(D.normalMap.channel),displacementMapUv:wt&&_(D.displacementMap.channel),emissiveMapUv:$i&&_(D.emissiveMap.channel),metalnessMapUv:Mt&&_(D.metalnessMap.channel),roughnessMapUv:le&&_(D.roughnessMap.channel),anisotropyMapUv:gt&&_(D.anisotropyMap.channel),clearcoatMapUv:dt&&_(D.clearcoatMap.channel),clearcoatNormalMapUv:hi&&_(D.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ct&&_(D.clearcoatRoughnessMap.channel),iridescenceMapUv:xt&&_(D.iridescenceMap.channel),iridescenceThicknessMapUv:li&&_(D.iridescenceThicknessMap.channel),sheenColorMapUv:jt&&_(D.sheenColorMap.channel),sheenRoughnessMapUv:Tt&&_(D.sheenRoughnessMap.channel),specularMapUv:Ii&&_(D.specularMap.channel),specularColorMapUv:di&&_(D.specularColorMap.channel),specularIntensityMapUv:ms&&_(D.specularIntensityMap.channel),transmissionMapUv:we&&_(D.transmissionMap.channel),thicknessMapUv:Dt&&_(D.thicknessMap.channel),alphaMapUv:ot&&_(D.alphaMap.channel),vertexTangents:!!H.attributes.tangent&&($e||te),vertexColors:D.vertexColors,vertexAlphas:D.vertexColors===!0&&!!H.attributes.color&&H.attributes.color.itemSize===4,pointsUvs:B.isPoints===!0&&!!H.attributes.uv&&(Mi||ot),fog:!!V,useFog:D.fog===!0,fogExp2:!!V&&V.isFogExp2,flatShading:D.flatShading===!0,sizeAttenuation:D.sizeAttenuation===!0,logarithmicDepthBuffer:h,reverseDepthBuffer:Ee,skinning:B.isSkinnedMesh===!0,morphTargets:H.morphAttributes.position!==void 0,morphNormals:H.morphAttributes.normal!==void 0,morphColors:H.morphAttributes.color!==void 0,morphTargetsCount:oe,morphTextureStride:ve,numDirLights:O.directional.length,numPointLights:O.point.length,numSpotLights:O.spot.length,numSpotLightMaps:O.spotLightMap.length,numRectAreaLights:O.rectArea.length,numHemiLights:O.hemi.length,numDirLightShadows:O.directionalShadowMap.length,numPointLightShadows:O.pointShadowMap.length,numSpotLightShadows:O.spotShadowMap.length,numSpotLightShadowsWithMaps:O.numSpotLightShadowsWithMaps,numLightProbes:O.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:D.dithering,shadowMapEnabled:t.shadowMap.enabled&&U.length>0,shadowMapType:t.shadowMap.type,toneMapping:hn,decodeVideoTexture:Mi&&D.map.isVideoTexture===!0&&Zs.getTransfer(D.map.colorSpace)===Mn,decodeVideoTextureEmissive:$i&&D.emissiveMap.isVideoTexture===!0&&Zs.getTransfer(D.emissiveMap.colorSpace)===Mn,premultipliedAlpha:D.premultipliedAlpha,doubleSided:D.side===Sm,flipSided:D.side===bu,useDepthPacking:D.depthPacking>=0,depthPacking:D.depthPacking||0,index0AttributeName:D.index0AttributeName,extensionClipCullDistance:qi&&D.extensions.clipCullDistance===!0&&s.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(qi&&D.extensions.multiDraw===!0||qt)&&s.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:s.has("KHR_parallel_shader_compile"),customProgramCacheKey:D.customProgramCacheKey()};return or.vertexUv1s=u.has(1),or.vertexUv2s=u.has(2),or.vertexUv3s=u.has(3),u.clear(),or}function x(D){const O=[];if(D.shaderID?O.push(D.shaderID):(O.push(D.customVertexShaderID),O.push(D.customFragmentShaderID)),D.defines!==void 0)for(const U in D.defines)O.push(U),O.push(D.defines[U]);return D.isRawShaderMaterial===!1&&(w(O,D),T(O,D),O.push(t.outputColorSpace)),O.push(D.customProgramCacheKey),O.join()}function w(D,O){D.push(O.precision),D.push(O.outputColorSpace),D.push(O.envMapMode),D.push(O.envMapCubeUVHeight),D.push(O.mapUv),D.push(O.alphaMapUv),D.push(O.lightMapUv),D.push(O.aoMapUv),D.push(O.bumpMapUv),D.push(O.normalMapUv),D.push(O.displacementMapUv),D.push(O.emissiveMapUv),D.push(O.metalnessMapUv),D.push(O.roughnessMapUv),D.push(O.anisotropyMapUv),D.push(O.clearcoatMapUv),D.push(O.clearcoatNormalMapUv),D.push(O.clearcoatRoughnessMapUv),D.push(O.iridescenceMapUv),D.push(O.iridescenceThicknessMapUv),D.push(O.sheenColorMapUv),D.push(O.sheenRoughnessMapUv),D.push(O.specularMapUv),D.push(O.specularColorMapUv),D.push(O.specularIntensityMapUv),D.push(O.transmissionMapUv),D.push(O.thicknessMapUv),D.push(O.combine),D.push(O.fogExp2),D.push(O.sizeAttenuation),D.push(O.morphTargetsCount),D.push(O.morphAttributeCount),D.push(O.numDirLights),D.push(O.numPointLights),D.push(O.numSpotLights),D.push(O.numSpotLightMaps),D.push(O.numHemiLights),D.push(O.numRectAreaLights),D.push(O.numDirLightShadows),D.push(O.numPointLightShadows),D.push(O.numSpotLightShadows),D.push(O.numSpotLightShadowsWithMaps),D.push(O.numLightProbes),D.push(O.shadowMapType),D.push(O.toneMapping),D.push(O.numClippingPlanes),D.push(O.numClipIntersection),D.push(O.depthPacking)}function T(D,O){a.disableAll(),O.supportsVertexTextures&&a.enable(0),O.instancing&&a.enable(1),O.instancingColor&&a.enable(2),O.instancingMorph&&a.enable(3),O.matcap&&a.enable(4),O.envMap&&a.enable(5),O.normalMapObjectSpace&&a.enable(6),O.normalMapTangentSpace&&a.enable(7),O.clearcoat&&a.enable(8),O.iridescence&&a.enable(9),O.alphaTest&&a.enable(10),O.vertexColors&&a.enable(11),O.vertexAlphas&&a.enable(12),O.vertexUv1s&&a.enable(13),O.vertexUv2s&&a.enable(14),O.vertexUv3s&&a.enable(15),O.vertexTangents&&a.enable(16),O.anisotropy&&a.enable(17),O.alphaHash&&a.enable(18),O.batching&&a.enable(19),O.dispersion&&a.enable(20),O.batchingColor&&a.enable(21),D.push(a.mask),a.disableAll(),O.fog&&a.enable(0),O.useFog&&a.enable(1),O.flatShading&&a.enable(2),O.logarithmicDepthBuffer&&a.enable(3),O.reverseDepthBuffer&&a.enable(4),O.skinning&&a.enable(5),O.morphTargets&&a.enable(6),O.morphNormals&&a.enable(7),O.morphColors&&a.enable(8),O.premultipliedAlpha&&a.enable(9),O.shadowMapEnabled&&a.enable(10),O.doubleSided&&a.enable(11),O.flipSided&&a.enable(12),O.useDepthPacking&&a.enable(13),O.dithering&&a.enable(14),O.transmission&&a.enable(15),O.sheen&&a.enable(16),O.opaque&&a.enable(17),O.pointsUvs&&a.enable(18),O.decodeVideoTexture&&a.enable(19),O.decodeVideoTextureEmissive&&a.enable(20),O.alphaToCoverage&&a.enable(21),D.push(a.mask)}function C(D){const O=f[D.type];let U;if(O){const $=xm[O];U=jBe.clone($.uniforms)}else U=D.uniforms;return U}function M(D,O){let U;for(let $=0,B=c.length;$<B;$++){const V=c[$];if(V.cacheKey===O){U=V,++U.usedTimes;break}}return U===void 0&&(U=new b7e(t,O,D,r),c.push(U)),U}function A(D){if(--D.usedTimes===0){const O=c.indexOf(D);c[O]=c[c.length-1],c.pop(),D.destroy()}}function I(D){l.remove(D)}function L(){l.dispose()}return{getParameters:v,getProgramCacheKey:x,getUniforms:C,acquireProgram:M,releaseProgram:A,releaseShaderCache:I,programs:c,dispose:L}}function T7e(){let t=new WeakMap;function e(o){return t.has(o)}function i(o){let a=t.get(o);return a===void 0&&(a={},t.set(o,a)),a}function s(o){t.delete(o)}function n(o,a,l){t.get(o)[a]=l}function r(){t=new WeakMap}return{has:e,get:i,remove:s,update:n,dispose:r}}function P7e(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Die(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Nie(){const t=[];let e=0;const i=[],s=[],n=[];function r(){e=0,i.length=0,s.length=0,n.length=0}function o(h,d,m,f,_,v){let x=t[e];return x===void 0?(x={id:h.id,object:h,geometry:d,material:m,groupOrder:f,renderOrder:h.renderOrder,z:_,group:v},t[e]=x):(x.id=h.id,x.object=h,x.geometry=d,x.material=m,x.groupOrder=f,x.renderOrder=h.renderOrder,x.z=_,x.group=v),e++,x}function a(h,d,m,f,_,v){const x=o(h,d,m,f,_,v);m.transmission>0?s.push(x):m.transparent===!0?n.push(x):i.push(x)}function l(h,d,m,f,_,v){const x=o(h,d,m,f,_,v);m.transmission>0?s.unshift(x):m.transparent===!0?n.unshift(x):i.unshift(x)}function u(h,d){i.length>1&&i.sort(h||P7e),s.length>1&&s.sort(d||Die),n.length>1&&n.sort(d||Die)}function c(){for(let h=e,d=t.length;h<d;h++){const m=t[h];if(m.id===null)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}}return{opaque:i,transmissive:s,transparent:n,init:r,push:a,unshift:l,finish:c,sort:u}}function M7e(){let t=new WeakMap;function e(s,n){const r=t.get(s);let o;return r===void 0?(o=new Nie,t.set(s,[o])):n>=r.length?(o=new Nie,r.push(o)):o=r[n],o}function i(){t=new WeakMap}return{get:e,dispose:i}}function A7e(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let i;switch(e.type){case"DirectionalLight":i={direction:new ze,color:new bn};break;case"SpotLight":i={position:new ze,direction:new ze,color:new bn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new ze,color:new bn,distance:0,decay:0};break;case"HemisphereLight":i={direction:new ze,skyColor:new bn,groundColor:new bn};break;case"RectAreaLight":i={color:new bn,position:new ze,halfWidth:new ze,halfHeight:new ze};break}return t[e.id]=i,i}}}function I7e(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let i;switch(e.type){case"DirectionalLight":i={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new hs};break;case"SpotLight":i={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new hs};break;case"PointLight":i={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new hs,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=i,i}}}let D7e=0;function N7e(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function R7e(t){const e=new A7e,i=I7e(),s={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)s.probe.push(new ze);const n=new ze,r=new Gr,o=new Gr;function a(u){let c=0,h=0,d=0;for(let D=0;D<9;D++)s.probe[D].set(0,0,0);let m=0,f=0,_=0,v=0,x=0,w=0,T=0,C=0,M=0,A=0,I=0;u.sort(N7e);for(let D=0,O=u.length;D<O;D++){const U=u[D],$=U.color,B=U.intensity,V=U.distance,H=U.shadow&&U.shadow.map?U.shadow.map.texture:null;if(U.isAmbientLight)c+=$.r*B,h+=$.g*B,d+=$.b*B;else if(U.isLightProbe){for(let Y=0;Y<9;Y++)s.probe[Y].addScaledVector(U.sh.coefficients[Y],B);I++}else if(U.isDirectionalLight){const Y=e.get(U);if(Y.color.copy(U.color).multiplyScalar(U.intensity),U.castShadow){const W=U.shadow,ee=i.get(U);ee.shadowIntensity=W.intensity,ee.shadowBias=W.bias,ee.shadowNormalBias=W.normalBias,ee.shadowRadius=W.radius,ee.shadowMapSize=W.mapSize,s.directionalShadow[m]=ee,s.directionalShadowMap[m]=H,s.directionalShadowMatrix[m]=U.shadow.matrix,w++}s.directional[m]=Y,m++}else if(U.isSpotLight){const Y=e.get(U);Y.position.setFromMatrixPosition(U.matrixWorld),Y.color.copy($).multiplyScalar(B),Y.distance=V,Y.coneCos=Math.cos(U.angle),Y.penumbraCos=Math.cos(U.angle*(1-U.penumbra)),Y.decay=U.decay,s.spot[_]=Y;const W=U.shadow;if(U.map&&(s.spotLightMap[M]=U.map,M++,W.updateMatrices(U),U.castShadow&&A++),s.spotLightMatrix[_]=W.matrix,U.castShadow){const ee=i.get(U);ee.shadowIntensity=W.intensity,ee.shadowBias=W.bias,ee.shadowNormalBias=W.normalBias,ee.shadowRadius=W.radius,ee.shadowMapSize=W.mapSize,s.spotShadow[_]=ee,s.spotShadowMap[_]=H,C++}_++}else if(U.isRectAreaLight){const Y=e.get(U);Y.color.copy($).multiplyScalar(B),Y.halfWidth.set(U.width*.5,0,0),Y.halfHeight.set(0,U.height*.5,0),s.rectArea[v]=Y,v++}else if(U.isPointLight){const Y=e.get(U);if(Y.color.copy(U.color).multiplyScalar(U.intensity),Y.distance=U.distance,Y.decay=U.decay,U.castShadow){const W=U.shadow,ee=i.get(U);ee.shadowIntensity=W.intensity,ee.shadowBias=W.bias,ee.shadowNormalBias=W.normalBias,ee.shadowRadius=W.radius,ee.shadowMapSize=W.mapSize,ee.shadowCameraNear=W.camera.near,ee.shadowCameraFar=W.camera.far,s.pointShadow[f]=ee,s.pointShadowMap[f]=H,s.pointShadowMatrix[f]=U.shadow.matrix,T++}s.point[f]=Y,f++}else if(U.isHemisphereLight){const Y=e.get(U);Y.skyColor.copy(U.color).multiplyScalar(B),Y.groundColor.copy(U.groundColor).multiplyScalar(B),s.hemi[x]=Y,x++}}v>0&&(t.has("OES_texture_float_linear")===!0?(s.rectAreaLTC1=kt.LTC_FLOAT_1,s.rectAreaLTC2=kt.LTC_FLOAT_2):(s.rectAreaLTC1=kt.LTC_HALF_1,s.rectAreaLTC2=kt.LTC_HALF_2)),s.ambient[0]=c,s.ambient[1]=h,s.ambient[2]=d;const L=s.hash;(L.directionalLength!==m||L.pointLength!==f||L.spotLength!==_||L.rectAreaLength!==v||L.hemiLength!==x||L.numDirectionalShadows!==w||L.numPointShadows!==T||L.numSpotShadows!==C||L.numSpotMaps!==M||L.numLightProbes!==I)&&(s.directional.length=m,s.spot.length=_,s.rectArea.length=v,s.point.length=f,s.hemi.length=x,s.directionalShadow.length=w,s.directionalShadowMap.length=w,s.pointShadow.length=T,s.pointShadowMap.length=T,s.spotShadow.length=C,s.spotShadowMap.length=C,s.directionalShadowMatrix.length=w,s.pointShadowMatrix.length=T,s.spotLightMatrix.length=C+M-A,s.spotLightMap.length=M,s.numSpotLightShadowsWithMaps=A,s.numLightProbes=I,L.directionalLength=m,L.pointLength=f,L.spotLength=_,L.rectAreaLength=v,L.hemiLength=x,L.numDirectionalShadows=w,L.numPointShadows=T,L.numSpotShadows=C,L.numSpotMaps=M,L.numLightProbes=I,s.version=D7e++)}function l(u,c){let h=0,d=0,m=0,f=0,_=0;const v=c.matrixWorldInverse;for(let x=0,w=u.length;x<w;x++){const T=u[x];if(T.isDirectionalLight){const C=s.directional[h];C.direction.setFromMatrixPosition(T.matrixWorld),n.setFromMatrixPosition(T.target.matrixWorld),C.direction.sub(n),C.direction.transformDirection(v),h++}else if(T.isSpotLight){const C=s.spot[m];C.position.setFromMatrixPosition(T.matrixWorld),C.position.applyMatrix4(v),C.direction.setFromMatrixPosition(T.matrixWorld),n.setFromMatrixPosition(T.target.matrixWorld),C.direction.sub(n),C.direction.transformDirection(v),m++}else if(T.isRectAreaLight){const C=s.rectArea[f];C.position.setFromMatrixPosition(T.matrixWorld),C.position.applyMatrix4(v),o.identity(),r.copy(T.matrixWorld),r.premultiply(v),o.extractRotation(r),C.halfWidth.set(T.width*.5,0,0),C.halfHeight.set(0,T.height*.5,0),C.halfWidth.applyMatrix4(o),C.halfHeight.applyMatrix4(o),f++}else if(T.isPointLight){const C=s.point[d];C.position.setFromMatrixPosition(T.matrixWorld),C.position.applyMatrix4(v),d++}else if(T.isHemisphereLight){const C=s.hemi[_];C.direction.setFromMatrixPosition(T.matrixWorld),C.direction.transformDirection(v),_++}}}return{setup:a,setupView:l,state:s}}function Rie(t){const e=new R7e(t),i=[],s=[];function n(c){u.camera=c,i.length=0,s.length=0}function r(c){i.push(c)}function o(c){s.push(c)}function a(){e.setup(i)}function l(c){e.setupView(i,c)}const u={lightsArray:i,shadowsArray:s,camera:null,lights:e,transmissionRenderTarget:{}};return{init:n,state:u,setupLights:a,setupLightsView:l,pushLight:r,pushShadow:o}}function O7e(t){let e=new WeakMap;function i(n,r=0){const o=e.get(n);let a;return o===void 0?(a=new Rie(t),e.set(n,[a])):r>=o.length?(a=new Rie(t),o.push(a)):a=o[r],a}function s(){e=new WeakMap}return{get:i,dispose:s}}const L7e=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,F7e=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function k7e(t,e,i){let s=new tY;const n=new hs,r=new hs,o=new zr,a=new t8e({depthPacking:dBe}),l=new i8e,u={},c=i.maxTextureSize,h={[Cy]:bu,[bu]:Cy,[Sm]:Sm},d=new Ty({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new hs},radius:{value:4}},vertexShader:L7e,fragmentShader:F7e}),m=d.clone();m.defines.HORIZONTAL_PASS=1;const f=new qy;f.setAttribute("position",new Dm(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const _=new Qc(f,d),v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=X_e;let x=this.type;this.render=function(A,I,L){if(v.enabled===!1||v.autoUpdate===!1&&v.needsUpdate===!1||A.length===0)return;const D=t.getRenderTarget(),O=t.getActiveCubeFace(),U=t.getActiveMipmapLevel(),$=t.state;$.setBlending(ay),$.buffers.color.setClear(1,1,1,1),$.buffers.depth.setTest(!0),$.setScissorTest(!1);const B=x!==Bp&&this.type===Bp,V=x===Bp&&this.type!==Bp;for(let H=0,Y=A.length;H<Y;H++){const W=A[H],ee=W.shadow;if(ee===void 0){console.warn("THREE.WebGLShadowMap:",W,"has no shadow.");continue}if(ee.autoUpdate===!1&&ee.needsUpdate===!1)continue;n.copy(ee.mapSize);const ne=ee.getFrameExtents();if(n.multiply(ne),r.copy(ee.mapSize),(n.x>c||n.y>c)&&(n.x>c&&(r.x=Math.floor(c/ne.x),n.x=r.x*ne.x,ee.mapSize.x=r.x),n.y>c&&(r.y=Math.floor(c/ne.y),n.y=r.y*ne.y,ee.mapSize.y=r.y)),ee.map===null||B===!0||V===!0){const oe=this.type!==Bp?{minFilter:fd,magFilter:fd}:{};ee.map!==null&&ee.map.dispose(),ee.map=new D1(n.x,n.y,oe),ee.map.texture.name=W.name+".shadowMap",ee.camera.updateProjectionMatrix()}t.setRenderTarget(ee.map),t.clear();const j=ee.getViewportCount();for(let oe=0;oe<j;oe++){const ve=ee.getViewport(oe);o.set(r.x*ve.x,r.y*ve.y,r.x*ve.z,r.y*ve.w),$.viewport(o),ee.updateMatrices(W,oe),s=ee.getFrustum(),C(I,L,ee.camera,W,this.type)}ee.isPointLightShadow!==!0&&this.type===Bp&&w(ee,L),ee.needsUpdate=!1}x=this.type,v.needsUpdate=!1,t.setRenderTarget(D,O,U)};function w(A,I){const L=e.update(_);d.defines.VSM_SAMPLES!==A.blurSamples&&(d.defines.VSM_SAMPLES=A.blurSamples,m.defines.VSM_SAMPLES=A.blurSamples,d.needsUpdate=!0,m.needsUpdate=!0),A.mapPass===null&&(A.mapPass=new D1(n.x,n.y)),d.uniforms.shadow_pass.value=A.map.texture,d.uniforms.resolution.value=A.mapSize,d.uniforms.radius.value=A.radius,t.setRenderTarget(A.mapPass),t.clear(),t.renderBufferDirect(I,null,L,d,_,null),m.uniforms.shadow_pass.value=A.mapPass.texture,m.uniforms.resolution.value=A.mapSize,m.uniforms.radius.value=A.radius,t.setRenderTarget(A.map),t.clear(),t.renderBufferDirect(I,null,L,m,_,null)}function T(A,I,L,D){let O=null;const U=L.isPointLight===!0?A.customDistanceMaterial:A.customDepthMaterial;if(U!==void 0)O=U;else if(O=L.isPointLight===!0?l:a,t.localClippingEnabled&&I.clipShadows===!0&&Array.isArray(I.clippingPlanes)&&I.clippingPlanes.length!==0||I.displacementMap&&I.displacementScale!==0||I.alphaMap&&I.alphaTest>0||I.map&&I.alphaTest>0){const $=O.uuid,B=I.uuid;let V=u[$];V===void 0&&(V={},u[$]=V);let H=V[B];H===void 0&&(H=O.clone(),V[B]=H,I.addEventListener("dispose",M)),O=H}if(O.visible=I.visible,O.wireframe=I.wireframe,D===Bp?O.side=I.shadowSide!==null?I.shadowSide:I.side:O.side=I.shadowSide!==null?I.shadowSide:h[I.side],O.alphaMap=I.alphaMap,O.alphaTest=I.alphaTest,O.map=I.map,O.clipShadows=I.clipShadows,O.clippingPlanes=I.clippingPlanes,O.clipIntersection=I.clipIntersection,O.displacementMap=I.displacementMap,O.displacementScale=I.displacementScale,O.displacementBias=I.displacementBias,O.wireframeLinewidth=I.wireframeLinewidth,O.linewidth=I.linewidth,L.isPointLight===!0&&O.isMeshDistanceMaterial===!0){const $=t.properties.get(O);$.light=L}return O}function C(A,I,L,D,O){if(A.visible===!1)return;if(A.layers.test(I.layers)&&(A.isMesh||A.isLine||A.isPoints)&&(A.castShadow||A.receiveShadow&&O===Bp)&&(!A.frustumCulled||s.intersectsObject(A))){A.modelViewMatrix.multiplyMatrices(L.matrixWorldInverse,A.matrixWorld);const B=e.update(A),V=A.material;if(Array.isArray(V)){const H=B.groups;for(let Y=0,W=H.length;Y<W;Y++){const ee=H[Y],ne=V[ee.materialIndex];if(ne&&ne.visible){const j=T(A,ne,D,O);A.onBeforeShadow(t,A,I,L,B,j,ee),t.renderBufferDirect(L,null,B,j,A,ee),A.onAfterShadow(t,A,I,L,B,j,ee)}}}else if(V.visible){const H=T(A,V,D,O);A.onBeforeShadow(t,A,I,L,B,H,null),t.renderBufferDirect(L,null,B,H,A,null),A.onAfterShadow(t,A,I,L,B,H,null)}}const $=A.children;for(let B=0,V=$.length;B<V;B++)C($[B],I,L,D,O)}function M(A){A.target.removeEventListener("dispose",M);for(const L in u){const D=u[L],O=A.target.uuid;O in D&&(D[O].dispose(),delete D[O])}}}const $7e={[BB]:qB,[HB]:XB,[jB]:WB,[SS]:YB,[qB]:BB,[XB]:HB,[WB]:jB,[YB]:SS};function U7e(t,e){function i(){let we=!1;const Dt=new zr;let Qe=null;const ot=new zr(0,0,0,0);return{setMask:function(Rt){Qe!==Rt&&!we&&(t.colorMask(Rt,Rt,Rt,Rt),Qe=Rt)},setLocked:function(Rt){we=Rt},setClear:function(Rt,It,qi,hn,or){or===!0&&(Rt*=hn,It*=hn,qi*=hn),Dt.set(Rt,It,qi,hn),ot.equals(Dt)===!1&&(t.clearColor(Rt,It,qi,hn),ot.copy(Dt))},reset:function(){we=!1,Qe=null,ot.set(-1,0,0,0)}}}function s(){let we=!1,Dt=!1,Qe=null,ot=null,Rt=null;return{setReversed:function(It){if(Dt!==It){const qi=e.get("EXT_clip_control");It?qi.clipControlEXT(qi.LOWER_LEFT_EXT,qi.ZERO_TO_ONE_EXT):qi.clipControlEXT(qi.LOWER_LEFT_EXT,qi.NEGATIVE_ONE_TO_ONE_EXT),Dt=It;const hn=Rt;Rt=null,this.setClear(hn)}},getReversed:function(){return Dt},setTest:function(It){It?je(t.DEPTH_TEST):Ee(t.DEPTH_TEST)},setMask:function(It){Qe!==It&&!we&&(t.depthMask(It),Qe=It)},setFunc:function(It){if(Dt&&(It=$7e[It]),ot!==It){switch(It){case BB:t.depthFunc(t.NEVER);break;case qB:t.depthFunc(t.ALWAYS);break;case HB:t.depthFunc(t.LESS);break;case SS:t.depthFunc(t.LEQUAL);break;case jB:t.depthFunc(t.EQUAL);break;case YB:t.depthFunc(t.GEQUAL);break;case XB:t.depthFunc(t.GREATER);break;case WB:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}ot=It}},setLocked:function(It){we=It},setClear:function(It){Rt!==It&&(Dt&&(It=1-It),t.clearDepth(It),Rt=It)},reset:function(){we=!1,Qe=null,ot=null,Rt=null,Dt=!1}}}function n(){let we=!1,Dt=null,Qe=null,ot=null,Rt=null,It=null,qi=null,hn=null,or=null;return{setTest:function(Ms){we||(Ms?je(t.STENCIL_TEST):Ee(t.STENCIL_TEST))},setMask:function(Ms){Dt!==Ms&&!we&&(t.stencilMask(Ms),Dt=Ms)},setFunc:function(Ms,Le,Ui){(Qe!==Ms||ot!==Le||Rt!==Ui)&&(t.stencilFunc(Ms,Le,Ui),Qe=Ms,ot=Le,Rt=Ui)},setOp:function(Ms,Le,Ui){(It!==Ms||qi!==Le||hn!==Ui)&&(t.stencilOp(Ms,Le,Ui),It=Ms,qi=Le,hn=Ui)},setLocked:function(Ms){we=Ms},setClear:function(Ms){or!==Ms&&(t.clearStencil(Ms),or=Ms)},reset:function(){we=!1,Dt=null,Qe=null,ot=null,Rt=null,It=null,qi=null,hn=null,or=null}}}const r=new i,o=new s,a=new n,l=new WeakMap,u=new WeakMap;let c={},h={},d=new WeakMap,m=[],f=null,_=!1,v=null,x=null,w=null,T=null,C=null,M=null,A=null,I=new bn(0,0,0),L=0,D=!1,O=null,U=null,$=null,B=null,V=null;const H=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Y=!1,W=0;const ee=t.getParameter(t.VERSION);ee.indexOf("WebGL")!==-1?(W=parseFloat(/^WebGL (\d)/.exec(ee)[1]),Y=W>=1):ee.indexOf("OpenGL ES")!==-1&&(W=parseFloat(/^OpenGL ES (\d)/.exec(ee)[1]),Y=W>=2);let ne=null,j={};const oe=t.getParameter(t.SCISSOR_BOX),ve=t.getParameter(t.VIEWPORT),Ye=new zr().fromArray(oe),de=new zr().fromArray(ve);function fe(we,Dt,Qe,ot){const Rt=new Uint8Array(4),It=t.createTexture();t.bindTexture(we,It),t.texParameteri(we,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(we,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let qi=0;qi<Qe;qi++)we===t.TEXTURE_3D||we===t.TEXTURE_2D_ARRAY?t.texImage3D(Dt,0,t.RGBA,1,1,ot,0,t.RGBA,t.UNSIGNED_BYTE,Rt):t.texImage2D(Dt+qi,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,Rt);return It}const Ne={};Ne[t.TEXTURE_2D]=fe(t.TEXTURE_2D,t.TEXTURE_2D,1),Ne[t.TEXTURE_CUBE_MAP]=fe(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),Ne[t.TEXTURE_2D_ARRAY]=fe(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),Ne[t.TEXTURE_3D]=fe(t.TEXTURE_3D,t.TEXTURE_3D,1,1),r.setClear(0,0,0,1),o.setClear(1),a.setClear(0),je(t.DEPTH_TEST),o.setFunc(SS),pt(!1),$e(Lte),je(t.CULL_FACE),me(ay);function je(we){c[we]!==!0&&(t.enable(we),c[we]=!0)}function Ee(we){c[we]!==!1&&(t.disable(we),c[we]=!1)}function Zt(we,Dt){return h[we]!==Dt?(t.bindFramebuffer(we,Dt),h[we]=Dt,we===t.DRAW_FRAMEBUFFER&&(h[t.FRAMEBUFFER]=Dt),we===t.FRAMEBUFFER&&(h[t.DRAW_FRAMEBUFFER]=Dt),!0):!1}function qt(we,Dt){let Qe=m,ot=!1;if(we){Qe=d.get(Dt),Qe===void 0&&(Qe=[],d.set(Dt,Qe));const Rt=we.textures;if(Qe.length!==Rt.length||Qe[0]!==t.COLOR_ATTACHMENT0){for(let It=0,qi=Rt.length;It<qi;It++)Qe[It]=t.COLOR_ATTACHMENT0+It;Qe.length=Rt.length,ot=!0}}else Qe[0]!==t.BACK&&(Qe[0]=t.BACK,ot=!0);ot&&t.drawBuffers(Qe)}function Mi(we){return f!==we?(t.useProgram(we),f=we,!0):!1}const oi={[Mv]:t.FUNC_ADD,[$Ge]:t.FUNC_SUBTRACT,[UGe]:t.FUNC_REVERSE_SUBTRACT};oi[VGe]=t.MIN,oi[zGe]=t.MAX;const si={[GGe]:t.ZERO,[BGe]:t.ONE,[qGe]:t.SRC_COLOR,[zB]:t.SRC_ALPHA,[ZGe]:t.SRC_ALPHA_SATURATE,[XGe]:t.DST_COLOR,[jGe]:t.DST_ALPHA,[HGe]:t.ONE_MINUS_SRC_COLOR,[GB]:t.ONE_MINUS_SRC_ALPHA,[WGe]:t.ONE_MINUS_DST_COLOR,[YGe]:t.ONE_MINUS_DST_ALPHA,[KGe]:t.CONSTANT_COLOR,[QGe]:t.ONE_MINUS_CONSTANT_COLOR,[JGe]:t.CONSTANT_ALPHA,[eBe]:t.ONE_MINUS_CONSTANT_ALPHA};function me(we,Dt,Qe,ot,Rt,It,qi,hn,or,Ms){if(we===ay){_===!0&&(Ee(t.BLEND),_=!1);return}if(_===!1&&(je(t.BLEND),_=!0),we!==kGe){if(we!==v||Ms!==D){if((x!==Mv||C!==Mv)&&(t.blendEquation(t.FUNC_ADD),x=Mv,C=Mv),Ms)switch(we){case Rw:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case Fte:t.blendFunc(t.ONE,t.ONE);break;case kte:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case $te:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",we);break}else switch(we){case Rw:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case Fte:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case kte:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case $te:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",we);break}w=null,T=null,M=null,A=null,I.set(0,0,0),L=0,v=we,D=Ms}return}Rt=Rt||Dt,It=It||Qe,qi=qi||ot,(Dt!==x||Rt!==C)&&(t.blendEquationSeparate(oi[Dt],oi[Rt]),x=Dt,C=Rt),(Qe!==w||ot!==T||It!==M||qi!==A)&&(t.blendFuncSeparate(si[Qe],si[ot],si[It],si[qi]),w=Qe,T=ot,M=It,A=qi),(hn.equals(I)===!1||or!==L)&&(t.blendColor(hn.r,hn.g,hn.b,or),I.copy(hn),L=or),v=we,D=!1}function Bi(we,Dt){we.side===Sm?Ee(t.CULL_FACE):je(t.CULL_FACE);let Qe=we.side===bu;Dt&&(Qe=!Qe),pt(Qe),we.blending===Rw&&we.transparent===!1?me(ay):me(we.blending,we.blendEquation,we.blendSrc,we.blendDst,we.blendEquationAlpha,we.blendSrcAlpha,we.blendDstAlpha,we.blendColor,we.blendAlpha,we.premultipliedAlpha),o.setFunc(we.depthFunc),o.setTest(we.depthTest),o.setMask(we.depthWrite),r.setMask(we.colorWrite);const ot=we.stencilWrite;a.setTest(ot),ot&&(a.setMask(we.stencilWriteMask),a.setFunc(we.stencilFunc,we.stencilRef,we.stencilFuncMask),a.setOp(we.stencilFail,we.stencilZFail,we.stencilZPass)),$i(we.polygonOffset,we.polygonOffsetFactor,we.polygonOffsetUnits),we.alphaToCoverage===!0?je(t.SAMPLE_ALPHA_TO_COVERAGE):Ee(t.SAMPLE_ALPHA_TO_COVERAGE)}function pt(we){O!==we&&(we?t.frontFace(t.CW):t.frontFace(t.CCW),O=we)}function $e(we){we!==OGe?(je(t.CULL_FACE),we!==U&&(we===Lte?t.cullFace(t.BACK):we===LGe?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):Ee(t.CULL_FACE),U=we}function wt(we){we!==$&&(Y&&t.lineWidth(we),$=we)}function $i(we,Dt,Qe){we?(je(t.POLYGON_OFFSET_FILL),(B!==Dt||V!==Qe)&&(t.polygonOffset(Dt,Qe),B=Dt,V=Qe)):Ee(t.POLYGON_OFFSET_FILL)}function Mt(we){we?je(t.SCISSOR_TEST):Ee(t.SCISSOR_TEST)}function le(we){we===void 0&&(we=t.TEXTURE0+H-1),ne!==we&&(t.activeTexture(we),ne=we)}function te(we,Dt,Qe){Qe===void 0&&(ne===null?Qe=t.TEXTURE0+H-1:Qe=ne);let ot=j[Qe];ot===void 0&&(ot={type:void 0,texture:void 0},j[Qe]=ot),(ot.type!==we||ot.texture!==Dt)&&(ne!==Qe&&(t.activeTexture(Qe),ne=Qe),t.bindTexture(we,Dt||Ne[we]),ot.type=we,ot.texture=Dt)}function De(){const we=j[ne];we!==void 0&&we.type!==void 0&&(t.bindTexture(we.type,null),we.type=void 0,we.texture=void 0)}function et(){try{t.compressedTexImage2D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function tt(){try{t.compressedTexImage3D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function Ze(){try{t.texSubImage2D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function Ct(){try{t.texSubImage3D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function gt(){try{t.compressedTexSubImage2D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function dt(){try{t.compressedTexSubImage3D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function hi(){try{t.texStorage2D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function ct(){try{t.texStorage3D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function xt(){try{t.texImage2D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function li(){try{t.texImage3D(...arguments)}catch(we){console.error("THREE.WebGLState:",we)}}function jt(we){Ye.equals(we)===!1&&(t.scissor(we.x,we.y,we.z,we.w),Ye.copy(we))}function Tt(we){de.equals(we)===!1&&(t.viewport(we.x,we.y,we.z,we.w),de.copy(we))}function Ii(we,Dt){let Qe=u.get(Dt);Qe===void 0&&(Qe=new WeakMap,u.set(Dt,Qe));let ot=Qe.get(we);ot===void 0&&(ot=t.getUniformBlockIndex(Dt,we.name),Qe.set(we,ot))}function di(we,Dt){const ot=u.get(Dt).get(we);l.get(Dt)!==ot&&(t.uniformBlockBinding(Dt,ot,we.__bindingPointIndex),l.set(Dt,ot))}function ms(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),o.setReversed(!1),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),c={},ne=null,j={},h={},d=new WeakMap,m=[],f=null,_=!1,v=null,x=null,w=null,T=null,C=null,M=null,A=null,I=new bn(0,0,0),L=0,D=!1,O=null,U=null,$=null,B=null,V=null,Ye.set(0,0,t.canvas.width,t.canvas.height),de.set(0,0,t.canvas.width,t.canvas.height),r.reset(),o.reset(),a.reset()}return{buffers:{color:r,depth:o,stencil:a},enable:je,disable:Ee,bindFramebuffer:Zt,drawBuffers:qt,useProgram:Mi,setBlending:me,setMaterial:Bi,setFlipSided:pt,setCullFace:$e,setLineWidth:wt,setPolygonOffset:$i,setScissorTest:Mt,activeTexture:le,bindTexture:te,unbindTexture:De,compressedTexImage2D:et,compressedTexImage3D:tt,texImage2D:xt,texImage3D:li,updateUBOMapping:Ii,uniformBlockBinding:di,texStorage2D:hi,texStorage3D:ct,texSubImage2D:Ze,texSubImage3D:Ct,compressedTexSubImage2D:gt,compressedTexSubImage3D:dt,scissor:jt,viewport:Tt,reset:ms}}function V7e(t,e,i,s,n,r,o){const a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),u=new hs,c=new WeakMap;let h;const d=new WeakMap;let m=!1;try{m=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function f(le,te){return m?new OffscreenCanvas(le,te):fM("canvas")}function _(le,te,De){let et=1;const tt=Mt(le);if((tt.width>De||tt.height>De)&&(et=De/Math.max(tt.width,tt.height)),et<1)if(typeof HTMLImageElement<"u"&&le instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&le instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&le instanceof ImageBitmap||typeof VideoFrame<"u"&&le instanceof VideoFrame){const Ze=Math.floor(et*tt.width),Ct=Math.floor(et*tt.height);h===void 0&&(h=f(Ze,Ct));const gt=te?f(Ze,Ct):h;return gt.width=Ze,gt.height=Ct,gt.getContext("2d").drawImage(le,0,0,Ze,Ct),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+tt.width+"x"+tt.height+") to ("+Ze+"x"+Ct+")."),gt}else return"data"in le&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+tt.width+"x"+tt.height+")."),le;return le}function v(le){return le.generateMipmaps}function x(le){t.generateMipmap(le)}function w(le){return le.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:le.isWebGL3DRenderTarget?t.TEXTURE_3D:le.isWebGLArrayRenderTarget||le.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:t.TEXTURE_2D}function T(le,te,De,et,tt=!1){if(le!==null){if(t[le]!==void 0)return t[le];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+le+"'")}let Ze=te;if(te===t.RED&&(De===t.FLOAT&&(Ze=t.R32F),De===t.HALF_FLOAT&&(Ze=t.R16F),De===t.UNSIGNED_BYTE&&(Ze=t.R8)),te===t.RED_INTEGER&&(De===t.UNSIGNED_BYTE&&(Ze=t.R8UI),De===t.UNSIGNED_SHORT&&(Ze=t.R16UI),De===t.UNSIGNED_INT&&(Ze=t.R32UI),De===t.BYTE&&(Ze=t.R8I),De===t.SHORT&&(Ze=t.R16I),De===t.INT&&(Ze=t.R32I)),te===t.RG&&(De===t.FLOAT&&(Ze=t.RG32F),De===t.HALF_FLOAT&&(Ze=t.RG16F),De===t.UNSIGNED_BYTE&&(Ze=t.RG8)),te===t.RG_INTEGER&&(De===t.UNSIGNED_BYTE&&(Ze=t.RG8UI),De===t.UNSIGNED_SHORT&&(Ze=t.RG16UI),De===t.UNSIGNED_INT&&(Ze=t.RG32UI),De===t.BYTE&&(Ze=t.RG8I),De===t.SHORT&&(Ze=t.RG16I),De===t.INT&&(Ze=t.RG32I)),te===t.RGB_INTEGER&&(De===t.UNSIGNED_BYTE&&(Ze=t.RGB8UI),De===t.UNSIGNED_SHORT&&(Ze=t.RGB16UI),De===t.UNSIGNED_INT&&(Ze=t.RGB32UI),De===t.BYTE&&(Ze=t.RGB8I),De===t.SHORT&&(Ze=t.RGB16I),De===t.INT&&(Ze=t.RGB32I)),te===t.RGBA_INTEGER&&(De===t.UNSIGNED_BYTE&&(Ze=t.RGBA8UI),De===t.UNSIGNED_SHORT&&(Ze=t.RGBA16UI),De===t.UNSIGNED_INT&&(Ze=t.RGBA32UI),De===t.BYTE&&(Ze=t.RGBA8I),De===t.SHORT&&(Ze=t.RGBA16I),De===t.INT&&(Ze=t.RGBA32I)),te===t.RGB&&De===t.UNSIGNED_INT_5_9_9_9_REV&&(Ze=t.RGB9_E5),te===t.RGBA){const Ct=tt?DL:Zs.getTransfer(et);De===t.FLOAT&&(Ze=t.RGBA32F),De===t.HALF_FLOAT&&(Ze=t.RGBA16F),De===t.UNSIGNED_BYTE&&(Ze=Ct===Mn?t.SRGB8_ALPHA8:t.RGBA8),De===t.UNSIGNED_SHORT_4_4_4_4&&(Ze=t.RGBA4),De===t.UNSIGNED_SHORT_5_5_5_1&&(Ze=t.RGB5_A1)}return(Ze===t.R16F||Ze===t.R32F||Ze===t.RG16F||Ze===t.RG32F||Ze===t.RGBA16F||Ze===t.RGBA32F)&&e.get("EXT_color_buffer_float"),Ze}function C(le,te){let De;return le?te===null||te===I1||te===dM?De=t.DEPTH24_STENCIL8:te===wf?De=t.DEPTH32F_STENCIL8:te===hM&&(De=t.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):te===null||te===I1||te===dM?De=t.DEPTH_COMPONENT24:te===wf?De=t.DEPTH_COMPONENT32F:te===hM&&(De=t.DEPTH_COMPONENT16),De}function M(le,te){return v(le)===!0||le.isFramebufferTexture&&le.minFilter!==fd&&le.minFilter!==Cm?Math.log2(Math.max(te.width,te.height))+1:le.mipmaps!==void 0&&le.mipmaps.length>0?le.mipmaps.length:le.isCompressedTexture&&Array.isArray(le.image)?te.mipmaps.length:1}function A(le){const te=le.target;te.removeEventListener("dispose",A),L(te),te.isVideoTexture&&c.delete(te)}function I(le){const te=le.target;te.removeEventListener("dispose",I),O(te)}function L(le){const te=s.get(le);if(te.__webglInit===void 0)return;const De=le.source,et=d.get(De);if(et){const tt=et[te.__cacheKey];tt.usedTimes--,tt.usedTimes===0&&D(le),Object.keys(et).length===0&&d.delete(De)}s.remove(le)}function D(le){const te=s.get(le);t.deleteTexture(te.__webglTexture);const De=le.source,et=d.get(De);delete et[te.__cacheKey],o.memory.textures--}function O(le){const te=s.get(le);if(le.depthTexture&&(le.depthTexture.dispose(),s.remove(le.depthTexture)),le.isWebGLCubeRenderTarget)for(let et=0;et<6;et++){if(Array.isArray(te.__webglFramebuffer[et]))for(let tt=0;tt<te.__webglFramebuffer[et].length;tt++)t.deleteFramebuffer(te.__webglFramebuffer[et][tt]);else t.deleteFramebuffer(te.__webglFramebuffer[et]);te.__webglDepthbuffer&&t.deleteRenderbuffer(te.__webglDepthbuffer[et])}else{if(Array.isArray(te.__webglFramebuffer))for(let et=0;et<te.__webglFramebuffer.length;et++)t.deleteFramebuffer(te.__webglFramebuffer[et]);else t.deleteFramebuffer(te.__webglFramebuffer);if(te.__webglDepthbuffer&&t.deleteRenderbuffer(te.__webglDepthbuffer),te.__webglMultisampledFramebuffer&&t.deleteFramebuffer(te.__webglMultisampledFramebuffer),te.__webglColorRenderbuffer)for(let et=0;et<te.__webglColorRenderbuffer.length;et++)te.__webglColorRenderbuffer[et]&&t.deleteRenderbuffer(te.__webglColorRenderbuffer[et]);te.__webglDepthRenderbuffer&&t.deleteRenderbuffer(te.__webglDepthRenderbuffer)}const De=le.textures;for(let et=0,tt=De.length;et<tt;et++){const Ze=s.get(De[et]);Ze.__webglTexture&&(t.deleteTexture(Ze.__webglTexture),o.memory.textures--),s.remove(De[et])}s.remove(le)}let U=0;function $(){U=0}function B(){const le=U;return le>=n.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+le+" texture units while this GPU supports only "+n.maxTextures),U+=1,le}function V(le){const te=[];return te.push(le.wrapS),te.push(le.wrapT),te.push(le.wrapR||0),te.push(le.magFilter),te.push(le.minFilter),te.push(le.anisotropy),te.push(le.internalFormat),te.push(le.format),te.push(le.type),te.push(le.generateMipmaps),te.push(le.premultiplyAlpha),te.push(le.flipY),te.push(le.unpackAlignment),te.push(le.colorSpace),te.join()}function H(le,te){const De=s.get(le);if(le.isVideoTexture&&wt(le),le.isRenderTargetTexture===!1&&le.version>0&&De.__version!==le.version){const et=le.image;if(et===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(et.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{de(De,le,te);return}}i.bindTexture(t.TEXTURE_2D,De.__webglTexture,t.TEXTURE0+te)}function Y(le,te){const De=s.get(le);if(le.version>0&&De.__version!==le.version){de(De,le,te);return}i.bindTexture(t.TEXTURE_2D_ARRAY,De.__webglTexture,t.TEXTURE0+te)}function W(le,te){const De=s.get(le);if(le.version>0&&De.__version!==le.version){de(De,le,te);return}i.bindTexture(t.TEXTURE_3D,De.__webglTexture,t.TEXTURE0+te)}function ee(le,te){const De=s.get(le);if(le.version>0&&De.__version!==le.version){fe(De,le,te);return}i.bindTexture(t.TEXTURE_CUBE_MAP,De.__webglTexture,t.TEXTURE0+te)}const ne={[QB]:t.REPEAT,[Vv]:t.CLAMP_TO_EDGE,[JB]:t.MIRRORED_REPEAT},j={[fd]:t.NEAREST,[cBe]:t.NEAREST_MIPMAP_NEAREST,[rN]:t.NEAREST_MIPMAP_LINEAR,[Cm]:t.LINEAR,[c5]:t.LINEAR_MIPMAP_NEAREST,[zv]:t.LINEAR_MIPMAP_LINEAR},oe={[fBe]:t.NEVER,[bBe]:t.ALWAYS,[gBe]:t.LESS,[aye]:t.LEQUAL,[_Be]:t.EQUAL,[xBe]:t.GEQUAL,[yBe]:t.GREATER,[vBe]:t.NOTEQUAL};function ve(le,te){if(te.type===wf&&e.has("OES_texture_float_linear")===!1&&(te.magFilter===Cm||te.magFilter===c5||te.magFilter===rN||te.magFilter===zv||te.minFilter===Cm||te.minFilter===c5||te.minFilter===rN||te.minFilter===zv)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),t.texParameteri(le,t.TEXTURE_WRAP_S,ne[te.wrapS]),t.texParameteri(le,t.TEXTURE_WRAP_T,ne[te.wrapT]),(le===t.TEXTURE_3D||le===t.TEXTURE_2D_ARRAY)&&t.texParameteri(le,t.TEXTURE_WRAP_R,ne[te.wrapR]),t.texParameteri(le,t.TEXTURE_MAG_FILTER,j[te.magFilter]),t.texParameteri(le,t.TEXTURE_MIN_FILTER,j[te.minFilter]),te.compareFunction&&(t.texParameteri(le,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(le,t.TEXTURE_COMPARE_FUNC,oe[te.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(te.magFilter===fd||te.minFilter!==rN&&te.minFilter!==zv||te.type===wf&&e.has("OES_texture_float_linear")===!1)return;if(te.anisotropy>1||s.get(te).__currentAnisotropy){const De=e.get("EXT_texture_filter_anisotropic");t.texParameterf(le,De.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(te.anisotropy,n.getMaxAnisotropy())),s.get(te).__currentAnisotropy=te.anisotropy}}}function Ye(le,te){let De=!1;le.__webglInit===void 0&&(le.__webglInit=!0,te.addEventListener("dispose",A));const et=te.source;let tt=d.get(et);tt===void 0&&(tt={},d.set(et,tt));const Ze=V(te);if(Ze!==le.__cacheKey){tt[Ze]===void 0&&(tt[Ze]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,De=!0),tt[Ze].usedTimes++;const Ct=tt[le.__cacheKey];Ct!==void 0&&(tt[le.__cacheKey].usedTimes--,Ct.usedTimes===0&&D(te)),le.__cacheKey=Ze,le.__webglTexture=tt[Ze].texture}return De}function de(le,te,De){let et=t.TEXTURE_2D;(te.isDataArrayTexture||te.isCompressedArrayTexture)&&(et=t.TEXTURE_2D_ARRAY),te.isData3DTexture&&(et=t.TEXTURE_3D);const tt=Ye(le,te),Ze=te.source;i.bindTexture(et,le.__webglTexture,t.TEXTURE0+De);const Ct=s.get(Ze);if(Ze.version!==Ct.__version||tt===!0){i.activeTexture(t.TEXTURE0+De);const gt=Zs.getPrimaries(Zs.workingColorSpace),dt=te.colorSpace===G_?null:Zs.getPrimaries(te.colorSpace),hi=te.colorSpace===G_||gt===dt?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,te.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,te.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,te.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,hi);let ct=_(te.image,!1,n.maxTextureSize);ct=$i(te,ct);const xt=r.convert(te.format,te.colorSpace),li=r.convert(te.type);let jt=T(te.internalFormat,xt,li,te.colorSpace,te.isVideoTexture);ve(et,te);let Tt;const Ii=te.mipmaps,di=te.isVideoTexture!==!0,ms=Ct.__version===void 0||tt===!0,we=Ze.dataReady,Dt=M(te,ct);if(te.isDepthTexture)jt=C(te.format===pM,te.type),ms&&(di?i.texStorage2D(t.TEXTURE_2D,1,jt,ct.width,ct.height):i.texImage2D(t.TEXTURE_2D,0,jt,ct.width,ct.height,0,xt,li,null));else if(te.isDataTexture)if(Ii.length>0){di&&ms&&i.texStorage2D(t.TEXTURE_2D,Dt,jt,Ii[0].width,Ii[0].height);for(let Qe=0,ot=Ii.length;Qe<ot;Qe++)Tt=Ii[Qe],di?we&&i.texSubImage2D(t.TEXTURE_2D,Qe,0,0,Tt.width,Tt.height,xt,li,Tt.data):i.texImage2D(t.TEXTURE_2D,Qe,jt,Tt.width,Tt.height,0,xt,li,Tt.data);te.generateMipmaps=!1}else di?(ms&&i.texStorage2D(t.TEXTURE_2D,Dt,jt,ct.width,ct.height),we&&i.texSubImage2D(t.TEXTURE_2D,0,0,0,ct.width,ct.height,xt,li,ct.data)):i.texImage2D(t.TEXTURE_2D,0,jt,ct.width,ct.height,0,xt,li,ct.data);else if(te.isCompressedTexture)if(te.isCompressedArrayTexture){di&&ms&&i.texStorage3D(t.TEXTURE_2D_ARRAY,Dt,jt,Ii[0].width,Ii[0].height,ct.depth);for(let Qe=0,ot=Ii.length;Qe<ot;Qe++)if(Tt=Ii[Qe],te.format!==cd)if(xt!==null)if(di){if(we)if(te.layerUpdates.size>0){const Rt=uie(Tt.width,Tt.height,te.format,te.type);for(const It of te.layerUpdates){const qi=Tt.data.subarray(It*Rt/Tt.data.BYTES_PER_ELEMENT,(It+1)*Rt/Tt.data.BYTES_PER_ELEMENT);i.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Qe,0,0,It,Tt.width,Tt.height,1,xt,qi)}te.clearLayerUpdates()}else i.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,Qe,0,0,0,Tt.width,Tt.height,ct.depth,xt,Tt.data)}else i.compressedTexImage3D(t.TEXTURE_2D_ARRAY,Qe,jt,Tt.width,Tt.height,ct.depth,0,Tt.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else di?we&&i.texSubImage3D(t.TEXTURE_2D_ARRAY,Qe,0,0,0,Tt.width,Tt.height,ct.depth,xt,li,Tt.data):i.texImage3D(t.TEXTURE_2D_ARRAY,Qe,jt,Tt.width,Tt.height,ct.depth,0,xt,li,Tt.data)}else{di&&ms&&i.texStorage2D(t.TEXTURE_2D,Dt,jt,Ii[0].width,Ii[0].height);for(let Qe=0,ot=Ii.length;Qe<ot;Qe++)Tt=Ii[Qe],te.format!==cd?xt!==null?di?we&&i.compressedTexSubImage2D(t.TEXTURE_2D,Qe,0,0,Tt.width,Tt.height,xt,Tt.data):i.compressedTexImage2D(t.TEXTURE_2D,Qe,jt,Tt.width,Tt.height,0,Tt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):di?we&&i.texSubImage2D(t.TEXTURE_2D,Qe,0,0,Tt.width,Tt.height,xt,li,Tt.data):i.texImage2D(t.TEXTURE_2D,Qe,jt,Tt.width,Tt.height,0,xt,li,Tt.data)}else if(te.isDataArrayTexture)if(di){if(ms&&i.texStorage3D(t.TEXTURE_2D_ARRAY,Dt,jt,ct.width,ct.height,ct.depth),we)if(te.layerUpdates.size>0){const Qe=uie(ct.width,ct.height,te.format,te.type);for(const ot of te.layerUpdates){const Rt=ct.data.subarray(ot*Qe/ct.data.BYTES_PER_ELEMENT,(ot+1)*Qe/ct.data.BYTES_PER_ELEMENT);i.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,ot,ct.width,ct.height,1,xt,li,Rt)}te.clearLayerUpdates()}else i.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,ct.width,ct.height,ct.depth,xt,li,ct.data)}else i.texImage3D(t.TEXTURE_2D_ARRAY,0,jt,ct.width,ct.height,ct.depth,0,xt,li,ct.data);else if(te.isData3DTexture)di?(ms&&i.texStorage3D(t.TEXTURE_3D,Dt,jt,ct.width,ct.height,ct.depth),we&&i.texSubImage3D(t.TEXTURE_3D,0,0,0,0,ct.width,ct.height,ct.depth,xt,li,ct.data)):i.texImage3D(t.TEXTURE_3D,0,jt,ct.width,ct.height,ct.depth,0,xt,li,ct.data);else if(te.isFramebufferTexture){if(ms)if(di)i.texStorage2D(t.TEXTURE_2D,Dt,jt,ct.width,ct.height);else{let Qe=ct.width,ot=ct.height;for(let Rt=0;Rt<Dt;Rt++)i.texImage2D(t.TEXTURE_2D,Rt,jt,Qe,ot,0,xt,li,null),Qe>>=1,ot>>=1}}else if(Ii.length>0){if(di&&ms){const Qe=Mt(Ii[0]);i.texStorage2D(t.TEXTURE_2D,Dt,jt,Qe.width,Qe.height)}for(let Qe=0,ot=Ii.length;Qe<ot;Qe++)Tt=Ii[Qe],di?we&&i.texSubImage2D(t.TEXTURE_2D,Qe,0,0,xt,li,Tt):i.texImage2D(t.TEXTURE_2D,Qe,jt,xt,li,Tt);te.generateMipmaps=!1}else if(di){if(ms){const Qe=Mt(ct);i.texStorage2D(t.TEXTURE_2D,Dt,jt,Qe.width,Qe.height)}we&&i.texSubImage2D(t.TEXTURE_2D,0,0,0,xt,li,ct)}else i.texImage2D(t.TEXTURE_2D,0,jt,xt,li,ct);v(te)&&x(et),Ct.__version=Ze.version,te.onUpdate&&te.onUpdate(te)}le.__version=te.version}function fe(le,te,De){if(te.image.length!==6)return;const et=Ye(le,te),tt=te.source;i.bindTexture(t.TEXTURE_CUBE_MAP,le.__webglTexture,t.TEXTURE0+De);const Ze=s.get(tt);if(tt.version!==Ze.__version||et===!0){i.activeTexture(t.TEXTURE0+De);const Ct=Zs.getPrimaries(Zs.workingColorSpace),gt=te.colorSpace===G_?null:Zs.getPrimaries(te.colorSpace),dt=te.colorSpace===G_||Ct===gt?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,te.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,te.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,te.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,dt);const hi=te.isCompressedTexture||te.image[0].isCompressedTexture,ct=te.image[0]&&te.image[0].isDataTexture,xt=[];for(let ot=0;ot<6;ot++)!hi&&!ct?xt[ot]=_(te.image[ot],!0,n.maxCubemapSize):xt[ot]=ct?te.image[ot].image:te.image[ot],xt[ot]=$i(te,xt[ot]);const li=xt[0],jt=r.convert(te.format,te.colorSpace),Tt=r.convert(te.type),Ii=T(te.internalFormat,jt,Tt,te.colorSpace),di=te.isVideoTexture!==!0,ms=Ze.__version===void 0||et===!0,we=tt.dataReady;let Dt=M(te,li);ve(t.TEXTURE_CUBE_MAP,te);let Qe;if(hi){di&&ms&&i.texStorage2D(t.TEXTURE_CUBE_MAP,Dt,Ii,li.width,li.height);for(let ot=0;ot<6;ot++){Qe=xt[ot].mipmaps;for(let Rt=0;Rt<Qe.length;Rt++){const It=Qe[Rt];te.format!==cd?jt!==null?di?we&&i.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ot,Rt,0,0,It.width,It.height,jt,It.data):i.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ot,Rt,Ii,It.width,It.height,0,It.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):di?we&&i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ot,Rt,0,0,It.width,It.height,jt,Tt,It.data):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ot,Rt,Ii,It.width,It.height,0,jt,Tt,It.data)}}}else{if(Qe=te.mipmaps,di&&ms){Qe.length>0&&Dt++;const ot=Mt(xt[0]);i.texStorage2D(t.TEXTURE_CUBE_MAP,Dt,Ii,ot.width,ot.height)}for(let ot=0;ot<6;ot++)if(ct){di?we&&i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ot,0,0,0,xt[ot].width,xt[ot].height,jt,Tt,xt[ot].data):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ot,0,Ii,xt[ot].width,xt[ot].height,0,jt,Tt,xt[ot].data);for(let Rt=0;Rt<Qe.length;Rt++){const qi=Qe[Rt].image[ot].image;di?we&&i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ot,Rt+1,0,0,qi.width,qi.height,jt,Tt,qi.data):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ot,Rt+1,Ii,qi.width,qi.height,0,jt,Tt,qi.data)}}else{di?we&&i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ot,0,0,0,jt,Tt,xt[ot]):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ot,0,Ii,jt,Tt,xt[ot]);for(let Rt=0;Rt<Qe.length;Rt++){const It=Qe[Rt];di?we&&i.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ot,Rt+1,0,0,jt,Tt,It.image[ot]):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+ot,Rt+1,Ii,jt,Tt,It.image[ot])}}}v(te)&&x(t.TEXTURE_CUBE_MAP),Ze.__version=tt.version,te.onUpdate&&te.onUpdate(te)}le.__version=te.version}function Ne(le,te,De,et,tt,Ze){const Ct=r.convert(De.format,De.colorSpace),gt=r.convert(De.type),dt=T(De.internalFormat,Ct,gt,De.colorSpace),hi=s.get(te),ct=s.get(De);if(ct.__renderTarget=te,!hi.__hasExternalTextures){const xt=Math.max(1,te.width>>Ze),li=Math.max(1,te.height>>Ze);tt===t.TEXTURE_3D||tt===t.TEXTURE_2D_ARRAY?i.texImage3D(tt,Ze,dt,xt,li,te.depth,0,Ct,gt,null):i.texImage2D(tt,Ze,dt,xt,li,0,Ct,gt,null)}i.bindFramebuffer(t.FRAMEBUFFER,le),$e(te)?a.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,et,tt,ct.__webglTexture,0,pt(te)):(tt===t.TEXTURE_2D||tt>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&tt<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,et,tt,ct.__webglTexture,Ze),i.bindFramebuffer(t.FRAMEBUFFER,null)}function je(le,te,De){if(t.bindRenderbuffer(t.RENDERBUFFER,le),te.depthBuffer){const et=te.depthTexture,tt=et&&et.isDepthTexture?et.type:null,Ze=C(te.stencilBuffer,tt),Ct=te.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,gt=pt(te);$e(te)?a.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,gt,Ze,te.width,te.height):De?t.renderbufferStorageMultisample(t.RENDERBUFFER,gt,Ze,te.width,te.height):t.renderbufferStorage(t.RENDERBUFFER,Ze,te.width,te.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,Ct,t.RENDERBUFFER,le)}else{const et=te.textures;for(let tt=0;tt<et.length;tt++){const Ze=et[tt],Ct=r.convert(Ze.format,Ze.colorSpace),gt=r.convert(Ze.type),dt=T(Ze.internalFormat,Ct,gt,Ze.colorSpace),hi=pt(te);De&&$e(te)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,hi,dt,te.width,te.height):$e(te)?a.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,hi,dt,te.width,te.height):t.renderbufferStorage(t.RENDERBUFFER,dt,te.width,te.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function Ee(le,te){if(te&&te.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(t.FRAMEBUFFER,le),!(te.depthTexture&&te.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const et=s.get(te.depthTexture);et.__renderTarget=te,(!et.__webglTexture||te.depthTexture.image.width!==te.width||te.depthTexture.image.height!==te.height)&&(te.depthTexture.image.width=te.width,te.depthTexture.image.height=te.height,te.depthTexture.needsUpdate=!0),H(te.depthTexture,0);const tt=et.__webglTexture,Ze=pt(te);if(te.depthTexture.format===mM)$e(te)?a.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,tt,0,Ze):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,tt,0);else if(te.depthTexture.format===pM)$e(te)?a.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,tt,0,Ze):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,tt,0);else throw new Error("Unknown depthTexture format")}function Zt(le){const te=s.get(le),De=le.isWebGLCubeRenderTarget===!0;if(te.__boundDepthTexture!==le.depthTexture){const et=le.depthTexture;if(te.__depthDisposeCallback&&te.__depthDisposeCallback(),et){const tt=()=>{delete te.__boundDepthTexture,delete te.__depthDisposeCallback,et.removeEventListener("dispose",tt)};et.addEventListener("dispose",tt),te.__depthDisposeCallback=tt}te.__boundDepthTexture=et}if(le.depthTexture&&!te.__autoAllocateDepthBuffer){if(De)throw new Error("target.depthTexture not supported in Cube render targets");Ee(te.__webglFramebuffer,le)}else if(De){te.__webglDepthbuffer=[];for(let et=0;et<6;et++)if(i.bindFramebuffer(t.FRAMEBUFFER,te.__webglFramebuffer[et]),te.__webglDepthbuffer[et]===void 0)te.__webglDepthbuffer[et]=t.createRenderbuffer(),je(te.__webglDepthbuffer[et],le,!1);else{const tt=le.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Ze=te.__webglDepthbuffer[et];t.bindRenderbuffer(t.RENDERBUFFER,Ze),t.framebufferRenderbuffer(t.FRAMEBUFFER,tt,t.RENDERBUFFER,Ze)}}else if(i.bindFramebuffer(t.FRAMEBUFFER,te.__webglFramebuffer),te.__webglDepthbuffer===void 0)te.__webglDepthbuffer=t.createRenderbuffer(),je(te.__webglDepthbuffer,le,!1);else{const et=le.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,tt=te.__webglDepthbuffer;t.bindRenderbuffer(t.RENDERBUFFER,tt),t.framebufferRenderbuffer(t.FRAMEBUFFER,et,t.RENDERBUFFER,tt)}i.bindFramebuffer(t.FRAMEBUFFER,null)}function qt(le,te,De){const et=s.get(le);te!==void 0&&Ne(et.__webglFramebuffer,le,le.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),De!==void 0&&Zt(le)}function Mi(le){const te=le.texture,De=s.get(le),et=s.get(te);le.addEventListener("dispose",I);const tt=le.textures,Ze=le.isWebGLCubeRenderTarget===!0,Ct=tt.length>1;if(Ct||(et.__webglTexture===void 0&&(et.__webglTexture=t.createTexture()),et.__version=te.version,o.memory.textures++),Ze){De.__webglFramebuffer=[];for(let gt=0;gt<6;gt++)if(te.mipmaps&&te.mipmaps.length>0){De.__webglFramebuffer[gt]=[];for(let dt=0;dt<te.mipmaps.length;dt++)De.__webglFramebuffer[gt][dt]=t.createFramebuffer()}else De.__webglFramebuffer[gt]=t.createFramebuffer()}else{if(te.mipmaps&&te.mipmaps.length>0){De.__webglFramebuffer=[];for(let gt=0;gt<te.mipmaps.length;gt++)De.__webglFramebuffer[gt]=t.createFramebuffer()}else De.__webglFramebuffer=t.createFramebuffer();if(Ct)for(let gt=0,dt=tt.length;gt<dt;gt++){const hi=s.get(tt[gt]);hi.__webglTexture===void 0&&(hi.__webglTexture=t.createTexture(),o.memory.textures++)}if(le.samples>0&&$e(le)===!1){De.__webglMultisampledFramebuffer=t.createFramebuffer(),De.__webglColorRenderbuffer=[],i.bindFramebuffer(t.FRAMEBUFFER,De.__webglMultisampledFramebuffer);for(let gt=0;gt<tt.length;gt++){const dt=tt[gt];De.__webglColorRenderbuffer[gt]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,De.__webglColorRenderbuffer[gt]);const hi=r.convert(dt.format,dt.colorSpace),ct=r.convert(dt.type),xt=T(dt.internalFormat,hi,ct,dt.colorSpace,le.isXRRenderTarget===!0),li=pt(le);t.renderbufferStorageMultisample(t.RENDERBUFFER,li,xt,le.width,le.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+gt,t.RENDERBUFFER,De.__webglColorRenderbuffer[gt])}t.bindRenderbuffer(t.RENDERBUFFER,null),le.depthBuffer&&(De.__webglDepthRenderbuffer=t.createRenderbuffer(),je(De.__webglDepthRenderbuffer,le,!0)),i.bindFramebuffer(t.FRAMEBUFFER,null)}}if(Ze){i.bindTexture(t.TEXTURE_CUBE_MAP,et.__webglTexture),ve(t.TEXTURE_CUBE_MAP,te);for(let gt=0;gt<6;gt++)if(te.mipmaps&&te.mipmaps.length>0)for(let dt=0;dt<te.mipmaps.length;dt++)Ne(De.__webglFramebuffer[gt][dt],le,te,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+gt,dt);else Ne(De.__webglFramebuffer[gt],le,te,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+gt,0);v(te)&&x(t.TEXTURE_CUBE_MAP),i.unbindTexture()}else if(Ct){for(let gt=0,dt=tt.length;gt<dt;gt++){const hi=tt[gt],ct=s.get(hi);i.bindTexture(t.TEXTURE_2D,ct.__webglTexture),ve(t.TEXTURE_2D,hi),Ne(De.__webglFramebuffer,le,hi,t.COLOR_ATTACHMENT0+gt,t.TEXTURE_2D,0),v(hi)&&x(t.TEXTURE_2D)}i.unbindTexture()}else{let gt=t.TEXTURE_2D;if((le.isWebGL3DRenderTarget||le.isWebGLArrayRenderTarget)&&(gt=le.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),i.bindTexture(gt,et.__webglTexture),ve(gt,te),te.mipmaps&&te.mipmaps.length>0)for(let dt=0;dt<te.mipmaps.length;dt++)Ne(De.__webglFramebuffer[dt],le,te,t.COLOR_ATTACHMENT0,gt,dt);else Ne(De.__webglFramebuffer,le,te,t.COLOR_ATTACHMENT0,gt,0);v(te)&&x(gt),i.unbindTexture()}le.depthBuffer&&Zt(le)}function oi(le){const te=le.textures;for(let De=0,et=te.length;De<et;De++){const tt=te[De];if(v(tt)){const Ze=w(le),Ct=s.get(tt).__webglTexture;i.bindTexture(Ze,Ct),x(Ze),i.unbindTexture()}}}const si=[],me=[];function Bi(le){if(le.samples>0){if($e(le)===!1){const te=le.textures,De=le.width,et=le.height;let tt=t.COLOR_BUFFER_BIT;const Ze=le.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Ct=s.get(le),gt=te.length>1;if(gt)for(let dt=0;dt<te.length;dt++)i.bindFramebuffer(t.FRAMEBUFFER,Ct.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+dt,t.RENDERBUFFER,null),i.bindFramebuffer(t.FRAMEBUFFER,Ct.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+dt,t.TEXTURE_2D,null,0);i.bindFramebuffer(t.READ_FRAMEBUFFER,Ct.__webglMultisampledFramebuffer),i.bindFramebuffer(t.DRAW_FRAMEBUFFER,Ct.__webglFramebuffer);for(let dt=0;dt<te.length;dt++){if(le.resolveDepthBuffer&&(le.depthBuffer&&(tt|=t.DEPTH_BUFFER_BIT),le.stencilBuffer&&le.resolveStencilBuffer&&(tt|=t.STENCIL_BUFFER_BIT)),gt){t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,Ct.__webglColorRenderbuffer[dt]);const hi=s.get(te[dt]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,hi,0)}t.blitFramebuffer(0,0,De,et,0,0,De,et,tt,t.NEAREST),l===!0&&(si.length=0,me.length=0,si.push(t.COLOR_ATTACHMENT0+dt),le.depthBuffer&&le.resolveDepthBuffer===!1&&(si.push(Ze),me.push(Ze),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,me)),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,si))}if(i.bindFramebuffer(t.READ_FRAMEBUFFER,null),i.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),gt)for(let dt=0;dt<te.length;dt++){i.bindFramebuffer(t.FRAMEBUFFER,Ct.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+dt,t.RENDERBUFFER,Ct.__webglColorRenderbuffer[dt]);const hi=s.get(te[dt]).__webglTexture;i.bindFramebuffer(t.FRAMEBUFFER,Ct.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+dt,t.TEXTURE_2D,hi,0)}i.bindFramebuffer(t.DRAW_FRAMEBUFFER,Ct.__webglMultisampledFramebuffer)}else if(le.depthBuffer&&le.resolveDepthBuffer===!1&&l){const te=le.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[te])}}}function pt(le){return Math.min(n.maxSamples,le.samples)}function $e(le){const te=s.get(le);return le.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&te.__useRenderToTexture!==!1}function wt(le){const te=o.render.frame;c.get(le)!==te&&(c.set(le,te),le.update())}function $i(le,te){const De=le.colorSpace,et=le.format,tt=le.type;return le.isCompressedTexture===!0||le.isVideoTexture===!0||De!==TS&&De!==G_&&(Zs.getTransfer(De)===Mn?(et!==cd||tt!==Vf)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",De)),te}function Mt(le){return typeof HTMLImageElement<"u"&&le instanceof HTMLImageElement?(u.width=le.naturalWidth||le.width,u.height=le.naturalHeight||le.height):typeof VideoFrame<"u"&&le instanceof VideoFrame?(u.width=le.displayWidth,u.height=le.displayHeight):(u.width=le.width,u.height=le.height),u}this.allocateTextureUnit=B,this.resetTextureUnits=$,this.setTexture2D=H,this.setTexture2DArray=Y,this.setTexture3D=W,this.setTextureCube=ee,this.rebindTextures=qt,this.setupRenderTarget=Mi,this.updateRenderTargetMipmap=oi,this.updateMultisampleRenderTarget=Bi,this.setupDepthRenderbuffer=Zt,this.setupFrameBufferTexture=Ne,this.useMultisampledRTT=$e}function z7e(t,e){function i(s,n=G_){let r;const o=Zs.getTransfer(n);if(s===Vf)return t.UNSIGNED_BYTE;if(s===Xj)return t.UNSIGNED_SHORT_4_4_4_4;if(s===Wj)return t.UNSIGNED_SHORT_5_5_5_1;if(s===J_e)return t.UNSIGNED_INT_5_9_9_9_REV;if(s===K_e)return t.BYTE;if(s===Q_e)return t.SHORT;if(s===hM)return t.UNSIGNED_SHORT;if(s===Yj)return t.INT;if(s===I1)return t.UNSIGNED_INT;if(s===wf)return t.FLOAT;if(s===yA)return t.HALF_FLOAT;if(s===eye)return t.ALPHA;if(s===tye)return t.RGB;if(s===cd)return t.RGBA;if(s===iye)return t.LUMINANCE;if(s===sye)return t.LUMINANCE_ALPHA;if(s===mM)return t.DEPTH_COMPONENT;if(s===pM)return t.DEPTH_STENCIL;if(s===nye)return t.RED;if(s===Zj)return t.RED_INTEGER;if(s===rye)return t.RG;if(s===Kj)return t.RG_INTEGER;if(s===Qj)return t.RGBA_INTEGER;if(s===p3||s===f3||s===g3||s===_3)if(o===Mn)if(r=e.get("WEBGL_compressed_texture_s3tc_srgb"),r!==null){if(s===p3)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===f3)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===g3)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===_3)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(r=e.get("WEBGL_compressed_texture_s3tc"),r!==null){if(s===p3)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===f3)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===g3)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===_3)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===e8||s===t8||s===i8||s===s8)if(r=e.get("WEBGL_compressed_texture_pvrtc"),r!==null){if(s===e8)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===t8)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===i8)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===s8)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===n8||s===r8||s===o8)if(r=e.get("WEBGL_compressed_texture_etc"),r!==null){if(s===n8||s===r8)return o===Mn?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(s===o8)return o===Mn?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===a8||s===l8||s===u8||s===c8||s===h8||s===d8||s===m8||s===p8||s===f8||s===g8||s===_8||s===y8||s===v8||s===x8)if(r=e.get("WEBGL_compressed_texture_astc"),r!==null){if(s===a8)return o===Mn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===l8)return o===Mn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===u8)return o===Mn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===c8)return o===Mn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===h8)return o===Mn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===d8)return o===Mn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===m8)return o===Mn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===p8)return o===Mn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===f8)return o===Mn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===g8)return o===Mn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===_8)return o===Mn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===y8)return o===Mn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===v8)return o===Mn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===x8)return o===Mn?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===y3||s===b8||s===w8)if(r=e.get("EXT_texture_compression_bptc"),r!==null){if(s===y3)return o===Mn?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(s===b8)return r.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(s===w8)return r.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(s===oye||s===S8||s===E8||s===C8)if(r=e.get("EXT_texture_compression_rgtc"),r!==null){if(s===y3)return r.COMPRESSED_RED_RGTC1_EXT;if(s===S8)return r.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===E8)return r.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===C8)return r.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===dM?t.UNSIGNED_INT_24_8:t[s]!==void 0?t[s]:null}return{convert:i}}const G7e=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,B7e=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class q7e{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,i,s){if(this.texture===null){const n=new $l,r=e.properties.get(n);r.__webglTexture=i.texture,(i.depthNear!==s.depthNear||i.depthFar!==s.depthFar)&&(this.depthNear=i.depthNear,this.depthFar=i.depthFar),this.texture=n}}getMesh(e){if(this.texture!==null&&this.mesh===null){const i=e.cameras[0].viewport,s=new Ty({vertexShader:G7e,fragmentShader:B7e,uniforms:{depthColor:{value:this.texture},depthWidth:{value:i.z},depthHeight:{value:i.w}}});this.mesh=new Qc(new MS(20,20),s)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class H7e extends j1{constructor(e,i){super();const s=this;let n=null,r=1,o=null,a="local-floor",l=1,u=null,c=null,h=null,d=null,m=null,f=null;const _=new q7e,v=i.getContextAttributes();let x=null,w=null;const T=[],C=[],M=new hs;let A=null;const I=new jc;I.viewport=new zr;const L=new jc;L.viewport=new zr;const D=[I,L],O=new h8e;let U=null,$=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(de){let fe=T[de];return fe===void 0&&(fe=new D5,T[de]=fe),fe.getTargetRaySpace()},this.getControllerGrip=function(de){let fe=T[de];return fe===void 0&&(fe=new D5,T[de]=fe),fe.getGripSpace()},this.getHand=function(de){let fe=T[de];return fe===void 0&&(fe=new D5,T[de]=fe),fe.getHandSpace()};function B(de){const fe=C.indexOf(de.inputSource);if(fe===-1)return;const Ne=T[fe];Ne!==void 0&&(Ne.update(de.inputSource,de.frame,u||o),Ne.dispatchEvent({type:de.type,data:de.inputSource}))}function V(){n.removeEventListener("select",B),n.removeEventListener("selectstart",B),n.removeEventListener("selectend",B),n.removeEventListener("squeeze",B),n.removeEventListener("squeezestart",B),n.removeEventListener("squeezeend",B),n.removeEventListener("end",V),n.removeEventListener("inputsourceschange",H);for(let de=0;de<T.length;de++){const fe=C[de];fe!==null&&(C[de]=null,T[de].disconnect(fe))}U=null,$=null,_.reset(),e.setRenderTarget(x),m=null,d=null,h=null,n=null,w=null,Ye.stop(),s.isPresenting=!1,e.setPixelRatio(A),e.setSize(M.width,M.height,!1),s.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(de){r=de,s.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(de){a=de,s.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||o},this.setReferenceSpace=function(de){u=de},this.getBaseLayer=function(){return d!==null?d:m},this.getBinding=function(){return h},this.getFrame=function(){return f},this.getSession=function(){return n},this.setSession=async function(de){if(n=de,n!==null){if(x=e.getRenderTarget(),n.addEventListener("select",B),n.addEventListener("selectstart",B),n.addEventListener("selectend",B),n.addEventListener("squeeze",B),n.addEventListener("squeezestart",B),n.addEventListener("squeezeend",B),n.addEventListener("end",V),n.addEventListener("inputsourceschange",H),v.xrCompatible!==!0&&await i.makeXRCompatible(),A=e.getPixelRatio(),e.getSize(M),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let Ne=null,je=null,Ee=null;v.depth&&(Ee=v.stencil?i.DEPTH24_STENCIL8:i.DEPTH_COMPONENT24,Ne=v.stencil?pM:mM,je=v.stencil?dM:I1);const Zt={colorFormat:i.RGBA8,depthFormat:Ee,scaleFactor:r};h=new XRWebGLBinding(n,i),d=h.createProjectionLayer(Zt),n.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),w=new D1(d.textureWidth,d.textureHeight,{format:cd,type:Vf,depthTexture:new yye(d.textureWidth,d.textureHeight,je,void 0,void 0,void 0,void 0,void 0,void 0,Ne),stencilBuffer:v.stencil,colorSpace:e.outputColorSpace,samples:v.antialias?4:0,resolveDepthBuffer:d.ignoreDepthValues===!1,resolveStencilBuffer:d.ignoreDepthValues===!1})}else{const Ne={antialias:v.antialias,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:r};m=new XRWebGLLayer(n,i,Ne),n.updateRenderState({baseLayer:m}),e.setPixelRatio(1),e.setSize(m.framebufferWidth,m.framebufferHeight,!1),w=new D1(m.framebufferWidth,m.framebufferHeight,{format:cd,type:Vf,colorSpace:e.outputColorSpace,stencilBuffer:v.stencil,resolveDepthBuffer:m.ignoreDepthValues===!1,resolveStencilBuffer:m.ignoreDepthValues===!1})}w.isXRRenderTarget=!0,this.setFoveation(l),u=null,o=await n.requestReferenceSpace(a),Ye.setContext(n),Ye.start(),s.isPresenting=!0,s.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(n!==null)return n.environmentBlendMode},this.getDepthTexture=function(){return _.getDepthTexture()};function H(de){for(let fe=0;fe<de.removed.length;fe++){const Ne=de.removed[fe],je=C.indexOf(Ne);je>=0&&(C[je]=null,T[je].disconnect(Ne))}for(let fe=0;fe<de.added.length;fe++){const Ne=de.added[fe];let je=C.indexOf(Ne);if(je===-1){for(let Zt=0;Zt<T.length;Zt++)if(Zt>=C.length){C.push(Ne),je=Zt;break}else if(C[Zt]===null){C[Zt]=Ne,je=Zt;break}if(je===-1)break}const Ee=T[je];Ee&&Ee.connect(Ne)}}const Y=new ze,W=new ze;function ee(de,fe,Ne){Y.setFromMatrixPosition(fe.matrixWorld),W.setFromMatrixPosition(Ne.matrixWorld);const je=Y.distanceTo(W),Ee=fe.projectionMatrix.elements,Zt=Ne.projectionMatrix.elements,qt=Ee[14]/(Ee[10]-1),Mi=Ee[14]/(Ee[10]+1),oi=(Ee[9]+1)/Ee[5],si=(Ee[9]-1)/Ee[5],me=(Ee[8]-1)/Ee[0],Bi=(Zt[8]+1)/Zt[0],pt=qt*me,$e=qt*Bi,wt=je/(-me+Bi),$i=wt*-me;if(fe.matrixWorld.decompose(de.position,de.quaternion,de.scale),de.translateX($i),de.translateZ(wt),de.matrixWorld.compose(de.position,de.quaternion,de.scale),de.matrixWorldInverse.copy(de.matrixWorld).invert(),Ee[10]===-1)de.projectionMatrix.copy(fe.projectionMatrix),de.projectionMatrixInverse.copy(fe.projectionMatrixInverse);else{const Mt=qt+wt,le=Mi+wt,te=pt-$i,De=$e+(je-$i),et=oi*Mi/le*Mt,tt=si*Mi/le*Mt;de.projectionMatrix.makePerspective(te,De,et,tt,Mt,le),de.projectionMatrixInverse.copy(de.projectionMatrix).invert()}}function ne(de,fe){fe===null?de.matrixWorld.copy(de.matrix):de.matrixWorld.multiplyMatrices(fe.matrixWorld,de.matrix),de.matrixWorldInverse.copy(de.matrixWorld).invert()}this.updateCamera=function(de){if(n===null)return;let fe=de.near,Ne=de.far;_.texture!==null&&(_.depthNear>0&&(fe=_.depthNear),_.depthFar>0&&(Ne=_.depthFar)),O.near=L.near=I.near=fe,O.far=L.far=I.far=Ne,(U!==O.near||$!==O.far)&&(n.updateRenderState({depthNear:O.near,depthFar:O.far}),U=O.near,$=O.far),I.layers.mask=de.layers.mask|2,L.layers.mask=de.layers.mask|4,O.layers.mask=I.layers.mask|L.layers.mask;const je=de.parent,Ee=O.cameras;ne(O,je);for(let Zt=0;Zt<Ee.length;Zt++)ne(Ee[Zt],je);Ee.length===2?ee(O,I,L):O.projectionMatrix.copy(I.projectionMatrix),j(de,O,je)};function j(de,fe,Ne){Ne===null?de.matrix.copy(fe.matrixWorld):(de.matrix.copy(Ne.matrixWorld),de.matrix.invert(),de.matrix.multiply(fe.matrixWorld)),de.matrix.decompose(de.position,de.quaternion,de.scale),de.updateMatrixWorld(!0),de.projectionMatrix.copy(fe.projectionMatrix),de.projectionMatrixInverse.copy(fe.projectionMatrixInverse),de.isPerspectiveCamera&&(de.fov=T8*2*Math.atan(1/de.projectionMatrix.elements[5]),de.zoom=1)}this.getCamera=function(){return O},this.getFoveation=function(){if(!(d===null&&m===null))return l},this.setFoveation=function(de){l=de,d!==null&&(d.fixedFoveation=de),m!==null&&m.fixedFoveation!==void 0&&(m.fixedFoveation=de)},this.hasDepthSensing=function(){return _.texture!==null},this.getDepthSensingMesh=function(){return _.getMesh(O)};let oe=null;function ve(de,fe){if(c=fe.getViewerPose(u||o),f=fe,c!==null){const Ne=c.views;m!==null&&(e.setRenderTargetFramebuffer(w,m.framebuffer),e.setRenderTarget(w));let je=!1;Ne.length!==O.cameras.length&&(O.cameras.length=0,je=!0);for(let qt=0;qt<Ne.length;qt++){const Mi=Ne[qt];let oi=null;if(m!==null)oi=m.getViewport(Mi);else{const me=h.getViewSubImage(d,Mi);oi=me.viewport,qt===0&&(e.setRenderTargetTextures(w,me.colorTexture,me.depthStencilTexture),e.setRenderTarget(w))}let si=D[qt];si===void 0&&(si=new jc,si.layers.enable(qt),si.viewport=new zr,D[qt]=si),si.matrix.fromArray(Mi.transform.matrix),si.matrix.decompose(si.position,si.quaternion,si.scale),si.projectionMatrix.fromArray(Mi.projectionMatrix),si.projectionMatrixInverse.copy(si.projectionMatrix).invert(),si.viewport.set(oi.x,oi.y,oi.width,oi.height),qt===0&&(O.matrix.copy(si.matrix),O.matrix.decompose(O.position,O.quaternion,O.scale)),je===!0&&O.cameras.push(si)}const Ee=n.enabledFeatures;if(Ee&&Ee.includes("depth-sensing")&&n.depthUsage=="gpu-optimized"&&h){const qt=h.getDepthInformation(Ne[0]);qt&&qt.isValid&&qt.texture&&_.init(e,qt,n.renderState)}}for(let Ne=0;Ne<T.length;Ne++){const je=C[Ne],Ee=T[Ne];je!==null&&Ee!==void 0&&Ee.update(je,fe,u||o)}oe&&oe(de,fe),fe.detectedPlanes&&s.dispatchEvent({type:"planesdetected",data:fe}),f=null}const Ye=new xye;Ye.setAnimationLoop(ve),this.setAnimationLoop=function(de){oe=de},this.dispose=function(){}}}const P0=new zf,j7e=new Gr;function Y7e(t,e){function i(v,x){v.matrixAutoUpdate===!0&&v.updateMatrix(),x.value.copy(v.matrix)}function s(v,x){x.color.getRGB(v.fogColor.value,fye(t)),x.isFog?(v.fogNear.value=x.near,v.fogFar.value=x.far):x.isFogExp2&&(v.fogDensity.value=x.density)}function n(v,x,w,T,C){x.isMeshBasicMaterial||x.isMeshLambertMaterial?r(v,x):x.isMeshToonMaterial?(r(v,x),h(v,x)):x.isMeshPhongMaterial?(r(v,x),c(v,x)):x.isMeshStandardMaterial?(r(v,x),d(v,x),x.isMeshPhysicalMaterial&&m(v,x,C)):x.isMeshMatcapMaterial?(r(v,x),f(v,x)):x.isMeshDepthMaterial?r(v,x):x.isMeshDistanceMaterial?(r(v,x),_(v,x)):x.isMeshNormalMaterial?r(v,x):x.isLineBasicMaterial?(o(v,x),x.isLineDashedMaterial&&a(v,x)):x.isPointsMaterial?l(v,x,w,T):x.isSpriteMaterial?u(v,x):x.isShadowMaterial?(v.color.value.copy(x.color),v.opacity.value=x.opacity):x.isShaderMaterial&&(x.uniformsNeedUpdate=!1)}function r(v,x){v.opacity.value=x.opacity,x.color&&v.diffuse.value.copy(x.color),x.emissive&&v.emissive.value.copy(x.emissive).multiplyScalar(x.emissiveIntensity),x.map&&(v.map.value=x.map,i(x.map,v.mapTransform)),x.alphaMap&&(v.alphaMap.value=x.alphaMap,i(x.alphaMap,v.alphaMapTransform)),x.bumpMap&&(v.bumpMap.value=x.bumpMap,i(x.bumpMap,v.bumpMapTransform),v.bumpScale.value=x.bumpScale,x.side===bu&&(v.bumpScale.value*=-1)),x.normalMap&&(v.normalMap.value=x.normalMap,i(x.normalMap,v.normalMapTransform),v.normalScale.value.copy(x.normalScale),x.side===bu&&v.normalScale.value.negate()),x.displacementMap&&(v.displacementMap.value=x.displacementMap,i(x.displacementMap,v.displacementMapTransform),v.displacementScale.value=x.displacementScale,v.displacementBias.value=x.displacementBias),x.emissiveMap&&(v.emissiveMap.value=x.emissiveMap,i(x.emissiveMap,v.emissiveMapTransform)),x.specularMap&&(v.specularMap.value=x.specularMap,i(x.specularMap,v.specularMapTransform)),x.alphaTest>0&&(v.alphaTest.value=x.alphaTest);const w=e.get(x),T=w.envMap,C=w.envMapRotation;T&&(v.envMap.value=T,P0.copy(C),P0.x*=-1,P0.y*=-1,P0.z*=-1,T.isCubeTexture&&T.isRenderTargetTexture===!1&&(P0.y*=-1,P0.z*=-1),v.envMapRotation.value.setFromMatrix4(j7e.makeRotationFromEuler(P0)),v.flipEnvMap.value=T.isCubeTexture&&T.isRenderTargetTexture===!1?-1:1,v.reflectivity.value=x.reflectivity,v.ior.value=x.ior,v.refractionRatio.value=x.refractionRatio),x.lightMap&&(v.lightMap.value=x.lightMap,v.lightMapIntensity.value=x.lightMapIntensity,i(x.lightMap,v.lightMapTransform)),x.aoMap&&(v.aoMap.value=x.aoMap,v.aoMapIntensity.value=x.aoMapIntensity,i(x.aoMap,v.aoMapTransform))}function o(v,x){v.diffuse.value.copy(x.color),v.opacity.value=x.opacity,x.map&&(v.map.value=x.map,i(x.map,v.mapTransform))}function a(v,x){v.dashSize.value=x.dashSize,v.totalSize.value=x.dashSize+x.gapSize,v.scale.value=x.scale}function l(v,x,w,T){v.diffuse.value.copy(x.color),v.opacity.value=x.opacity,v.size.value=x.size*w,v.scale.value=T*.5,x.map&&(v.map.value=x.map,i(x.map,v.uvTransform)),x.alphaMap&&(v.alphaMap.value=x.alphaMap,i(x.alphaMap,v.alphaMapTransform)),x.alphaTest>0&&(v.alphaTest.value=x.alphaTest)}function u(v,x){v.diffuse.value.copy(x.color),v.opacity.value=x.opacity,v.rotation.value=x.rotation,x.map&&(v.map.value=x.map,i(x.map,v.mapTransform)),x.alphaMap&&(v.alphaMap.value=x.alphaMap,i(x.alphaMap,v.alphaMapTransform)),x.alphaTest>0&&(v.alphaTest.value=x.alphaTest)}function c(v,x){v.specular.value.copy(x.specular),v.shininess.value=Math.max(x.shininess,1e-4)}function h(v,x){x.gradientMap&&(v.gradientMap.value=x.gradientMap)}function d(v,x){v.metalness.value=x.metalness,x.metalnessMap&&(v.metalnessMap.value=x.metalnessMap,i(x.metalnessMap,v.metalnessMapTransform)),v.roughness.value=x.roughness,x.roughnessMap&&(v.roughnessMap.value=x.roughnessMap,i(x.roughnessMap,v.roughnessMapTransform)),x.envMap&&(v.envMapIntensity.value=x.envMapIntensity)}function m(v,x,w){v.ior.value=x.ior,x.sheen>0&&(v.sheenColor.value.copy(x.sheenColor).multiplyScalar(x.sheen),v.sheenRoughness.value=x.sheenRoughness,x.sheenColorMap&&(v.sheenColorMap.value=x.sheenColorMap,i(x.sheenColorMap,v.sheenColorMapTransform)),x.sheenRoughnessMap&&(v.sheenRoughnessMap.value=x.sheenRoughnessMap,i(x.sheenRoughnessMap,v.sheenRoughnessMapTransform))),x.clearcoat>0&&(v.clearcoat.value=x.clearcoat,v.clearcoatRoughness.value=x.clearcoatRoughness,x.clearcoatMap&&(v.clearcoatMap.value=x.clearcoatMap,i(x.clearcoatMap,v.clearcoatMapTransform)),x.clearcoatRoughnessMap&&(v.clearcoatRoughnessMap.value=x.clearcoatRoughnessMap,i(x.clearcoatRoughnessMap,v.clearcoatRoughnessMapTransform)),x.clearcoatNormalMap&&(v.clearcoatNormalMap.value=x.clearcoatNormalMap,i(x.clearcoatNormalMap,v.clearcoatNormalMapTransform),v.clearcoatNormalScale.value.copy(x.clearcoatNormalScale),x.side===bu&&v.clearcoatNormalScale.value.negate())),x.dispersion>0&&(v.dispersion.value=x.dispersion),x.iridescence>0&&(v.iridescence.value=x.iridescence,v.iridescenceIOR.value=x.iridescenceIOR,v.iridescenceThicknessMinimum.value=x.iridescenceThicknessRange[0],v.iridescenceThicknessMaximum.value=x.iridescenceThicknessRange[1],x.iridescenceMap&&(v.iridescenceMap.value=x.iridescenceMap,i(x.iridescenceMap,v.iridescenceMapTransform)),x.iridescenceThicknessMap&&(v.iridescenceThicknessMap.value=x.iridescenceThicknessMap,i(x.iridescenceThicknessMap,v.iridescenceThicknessMapTransform))),x.transmission>0&&(v.transmission.value=x.transmission,v.transmissionSamplerMap.value=w.texture,v.transmissionSamplerSize.value.set(w.width,w.height),x.transmissionMap&&(v.transmissionMap.value=x.transmissionMap,i(x.transmissionMap,v.transmissionMapTransform)),v.thickness.value=x.thickness,x.thicknessMap&&(v.thicknessMap.value=x.thicknessMap,i(x.thicknessMap,v.thicknessMapTransform)),v.attenuationDistance.value=x.attenuationDistance,v.attenuationColor.value.copy(x.attenuationColor)),x.anisotropy>0&&(v.anisotropyVector.value.set(x.anisotropy*Math.cos(x.anisotropyRotation),x.anisotropy*Math.sin(x.anisotropyRotation)),x.anisotropyMap&&(v.anisotropyMap.value=x.anisotropyMap,i(x.anisotropyMap,v.anisotropyMapTransform))),v.specularIntensity.value=x.specularIntensity,v.specularColor.value.copy(x.specularColor),x.specularColorMap&&(v.specularColorMap.value=x.specularColorMap,i(x.specularColorMap,v.specularColorMapTransform)),x.specularIntensityMap&&(v.specularIntensityMap.value=x.specularIntensityMap,i(x.specularIntensityMap,v.specularIntensityMapTransform))}function f(v,x){x.matcap&&(v.matcap.value=x.matcap)}function _(v,x){const w=e.get(x).light;v.referencePosition.value.setFromMatrixPosition(w.matrixWorld),v.nearDistance.value=w.shadow.camera.near,v.farDistance.value=w.shadow.camera.far}return{refreshFogUniforms:s,refreshMaterialUniforms:n}}function X7e(t,e,i,s){let n={},r={},o=[];const a=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);function l(w,T){const C=T.program;s.uniformBlockBinding(w,C)}function u(w,T){let C=n[w.id];C===void 0&&(f(w),C=c(w),n[w.id]=C,w.addEventListener("dispose",v));const M=T.program;s.updateUBOMapping(w,M);const A=e.render.frame;r[w.id]!==A&&(d(w),r[w.id]=A)}function c(w){const T=h();w.__bindingPointIndex=T;const C=t.createBuffer(),M=w.__size,A=w.usage;return t.bindBuffer(t.UNIFORM_BUFFER,C),t.bufferData(t.UNIFORM_BUFFER,M,A),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,T,C),C}function h(){for(let w=0;w<a;w++)if(o.indexOf(w)===-1)return o.push(w),w;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(w){const T=n[w.id],C=w.uniforms,M=w.__cache;t.bindBuffer(t.UNIFORM_BUFFER,T);for(let A=0,I=C.length;A<I;A++){const L=Array.isArray(C[A])?C[A]:[C[A]];for(let D=0,O=L.length;D<O;D++){const U=L[D];if(m(U,A,D,M)===!0){const $=U.__offset,B=Array.isArray(U.value)?U.value:[U.value];let V=0;for(let H=0;H<B.length;H++){const Y=B[H],W=_(Y);typeof Y=="number"||typeof Y=="boolean"?(U.__data[0]=Y,t.bufferSubData(t.UNIFORM_BUFFER,$+V,U.__data)):Y.isMatrix3?(U.__data[0]=Y.elements[0],U.__data[1]=Y.elements[1],U.__data[2]=Y.elements[2],U.__data[3]=0,U.__data[4]=Y.elements[3],U.__data[5]=Y.elements[4],U.__data[6]=Y.elements[5],U.__data[7]=0,U.__data[8]=Y.elements[6],U.__data[9]=Y.elements[7],U.__data[10]=Y.elements[8],U.__data[11]=0):(Y.toArray(U.__data,V),V+=W.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,$,U.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function m(w,T,C,M){const A=w.value,I=T+"_"+C;if(M[I]===void 0)return typeof A=="number"||typeof A=="boolean"?M[I]=A:M[I]=A.clone(),!0;{const L=M[I];if(typeof A=="number"||typeof A=="boolean"){if(L!==A)return M[I]=A,!0}else if(L.equals(A)===!1)return L.copy(A),!0}return!1}function f(w){const T=w.uniforms;let C=0;const M=16;for(let I=0,L=T.length;I<L;I++){const D=Array.isArray(T[I])?T[I]:[T[I]];for(let O=0,U=D.length;O<U;O++){const $=D[O],B=Array.isArray($.value)?$.value:[$.value];for(let V=0,H=B.length;V<H;V++){const Y=B[V],W=_(Y),ee=C%M,ne=ee%W.boundary,j=ee+ne;C+=ne,j!==0&&M-j<W.storage&&(C+=M-j),$.__data=new Float32Array(W.storage/Float32Array.BYTES_PER_ELEMENT),$.__offset=C,C+=W.storage}}}const A=C%M;return A>0&&(C+=M-A),w.__size=C,w.__cache={},this}function _(w){const T={boundary:0,storage:0};return typeof w=="number"||typeof w=="boolean"?(T.boundary=4,T.storage=4):w.isVector2?(T.boundary=8,T.storage=8):w.isVector3||w.isColor?(T.boundary=16,T.storage=12):w.isVector4?(T.boundary=16,T.storage=16):w.isMatrix3?(T.boundary=48,T.storage=48):w.isMatrix4?(T.boundary=64,T.storage=64):w.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",w),T}function v(w){const T=w.target;T.removeEventListener("dispose",v);const C=o.indexOf(T.__bindingPointIndex);o.splice(C,1),t.deleteBuffer(n[T.id]),delete n[T.id],delete r[T.id]}function x(){for(const w in n)t.deleteBuffer(n[w]);o=[],n={},r={}}return{bind:l,update:u,dispose:x}}class W7e{constructor(e={}){const{canvas:i=EBe(),context:s=null,depth:n=!0,stencil:r=!1,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:u=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:h=!1,reverseDepthBuffer:d=!1}=e;this.isWebGLRenderer=!0;let m;if(s!==null){if(typeof WebGLRenderingContext<"u"&&s instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");m=s.getContextAttributes().alpha}else m=o;const f=new Uint32Array(4),_=new Int32Array(4);let v=null,x=null;const w=[],T=[];this.domElement=i,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=ly,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const C=this;let M=!1;this._outputColorSpace=Hc;let A=0,I=0,L=null,D=-1,O=null;const U=new zr,$=new zr;let B=null;const V=new bn(0);let H=0,Y=i.width,W=i.height,ee=1,ne=null,j=null;const oe=new zr(0,0,Y,W),ve=new zr(0,0,Y,W);let Ye=!1;const de=new tY;let fe=!1,Ne=!1;const je=new Gr,Ee=new Gr,Zt=new ze,qt=new zr,Mi={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let oi=!1;function si(){return L===null?ee:1}let me=s;function Bi(re,Ce){return i.getContext(re,Ce)}try{const re={alpha:!0,depth:n,stencil:r,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:c,failIfMajorPerformanceCaveat:h};if("setAttribute"in i&&i.setAttribute("data-engine",`three.js r${jj}`),i.addEventListener("webglcontextlost",ot,!1),i.addEventListener("webglcontextrestored",Rt,!1),i.addEventListener("webglcontextcreationerror",It,!1),me===null){const Ce="webgl2";if(me=Bi(Ce,re),me===null)throw Bi(Ce)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(re){throw console.error("THREE.WebGLRenderer: "+re.message),re}let pt,$e,wt,$i,Mt,le,te,De,et,tt,Ze,Ct,gt,dt,hi,ct,xt,li,jt,Tt,Ii,di,ms,we;function Dt(){pt=new rHe(me),pt.init(),di=new z7e(me,pt),$e=new Q9e(me,pt,e,di),wt=new U7e(me,pt),$e.reverseDepthBuffer&&d&&wt.buffers.depth.setReversed(!0),$i=new lHe(me),Mt=new T7e,le=new V7e(me,pt,wt,Mt,$e,di,$i),te=new eHe(C),De=new nHe(C),et=new p8e(me),ms=new Z9e(me,et),tt=new oHe(me,et,$i,ms),Ze=new cHe(me,tt,et,$i),jt=new uHe(me,$e,le),ct=new J9e(Mt),Ct=new C7e(C,te,De,pt,$e,ms,ct),gt=new Y7e(C,Mt),dt=new M7e,hi=new O7e(pt),li=new W9e(C,te,De,wt,Ze,m,l),xt=new k7e(C,Ze,$e),we=new X7e(me,$i,$e,wt),Tt=new K9e(me,pt,$i),Ii=new aHe(me,pt,$i),$i.programs=Ct.programs,C.capabilities=$e,C.extensions=pt,C.properties=Mt,C.renderLists=dt,C.shadowMap=xt,C.state=wt,C.info=$i}Dt();const Qe=new H7e(C,me);this.xr=Qe,this.getContext=function(){return me},this.getContextAttributes=function(){return me.getContextAttributes()},this.forceContextLoss=function(){const re=pt.get("WEBGL_lose_context");re&&re.loseContext()},this.forceContextRestore=function(){const re=pt.get("WEBGL_lose_context");re&&re.restoreContext()},this.getPixelRatio=function(){return ee},this.setPixelRatio=function(re){re!==void 0&&(ee=re,this.setSize(Y,W,!1))},this.getSize=function(re){return re.set(Y,W)},this.setSize=function(re,Ce,Oe=!0){if(Qe.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Y=re,W=Ce,i.width=Math.floor(re*ee),i.height=Math.floor(Ce*ee),Oe===!0&&(i.style.width=re+"px",i.style.height=Ce+"px"),this.setViewport(0,0,re,Ce)},this.getDrawingBufferSize=function(re){return re.set(Y*ee,W*ee).floor()},this.setDrawingBufferSize=function(re,Ce,Oe){Y=re,W=Ce,ee=Oe,i.width=Math.floor(re*Oe),i.height=Math.floor(Ce*Oe),this.setViewport(0,0,re,Ce)},this.getCurrentViewport=function(re){return re.copy(U)},this.getViewport=function(re){return re.copy(oe)},this.setViewport=function(re,Ce,Oe,Be){re.isVector4?oe.set(re.x,re.y,re.z,re.w):oe.set(re,Ce,Oe,Be),wt.viewport(U.copy(oe).multiplyScalar(ee).round())},this.getScissor=function(re){return re.copy(ve)},this.setScissor=function(re,Ce,Oe,Be){re.isVector4?ve.set(re.x,re.y,re.z,re.w):ve.set(re,Ce,Oe,Be),wt.scissor($.copy(ve).multiplyScalar(ee).round())},this.getScissorTest=function(){return Ye},this.setScissorTest=function(re){wt.setScissorTest(Ye=re)},this.setOpaqueSort=function(re){ne=re},this.setTransparentSort=function(re){j=re},this.getClearColor=function(re){return re.copy(li.getClearColor())},this.setClearColor=function(){li.setClearColor(...arguments)},this.getClearAlpha=function(){return li.getClearAlpha()},this.setClearAlpha=function(){li.setClearAlpha(...arguments)},this.clear=function(re=!0,Ce=!0,Oe=!0){let Be=0;if(re){let Ae=!1;if(L!==null){const ft=L.texture.format;Ae=ft===Qj||ft===Kj||ft===Zj}if(Ae){const ft=L.texture.type,St=ft===Vf||ft===I1||ft===hM||ft===dM||ft===Xj||ft===Wj,At=li.getClearColor(),zt=li.getClearAlpha(),Ti=At.r,Yt=At.g,ci=At.b;St?(f[0]=Ti,f[1]=Yt,f[2]=ci,f[3]=zt,me.clearBufferuiv(me.COLOR,0,f)):(_[0]=Ti,_[1]=Yt,_[2]=ci,_[3]=zt,me.clearBufferiv(me.COLOR,0,_))}else Be|=me.COLOR_BUFFER_BIT}Ce&&(Be|=me.DEPTH_BUFFER_BIT),Oe&&(Be|=me.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),me.clear(Be)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){i.removeEventListener("webglcontextlost",ot,!1),i.removeEventListener("webglcontextrestored",Rt,!1),i.removeEventListener("webglcontextcreationerror",It,!1),li.dispose(),dt.dispose(),hi.dispose(),Mt.dispose(),te.dispose(),De.dispose(),Ze.dispose(),ms.dispose(),we.dispose(),Ct.dispose(),Qe.dispose(),Qe.removeEventListener("sessionstart",Sn),Qe.removeEventListener("sessionend",Js),Br.stop()};function ot(re){re.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),M=!0}function Rt(){console.log("THREE.WebGLRenderer: Context Restored."),M=!1;const re=$i.autoReset,Ce=xt.enabled,Oe=xt.autoUpdate,Be=xt.needsUpdate,Ae=xt.type;Dt(),$i.autoReset=re,xt.enabled=Ce,xt.autoUpdate=Oe,xt.needsUpdate=Be,xt.type=Ae}function It(re){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",re.statusMessage)}function qi(re){const Ce=re.target;Ce.removeEventListener("dispose",qi),hn(Ce)}function hn(re){or(re),Mt.remove(re)}function or(re){const Ce=Mt.get(re).programs;Ce!==void 0&&(Ce.forEach(function(Oe){Ct.releaseProgram(Oe)}),re.isShaderMaterial&&Ct.releaseShaderCache(re))}this.renderBufferDirect=function(re,Ce,Oe,Be,Ae,ft){Ce===null&&(Ce=Mi);const St=Ae.isMesh&&Ae.matrixWorld.determinant()<0,At=wi(re,Ce,Oe,Be,Ae);wt.setMaterial(Be,St);let zt=Oe.index,Ti=1;if(Be.wireframe===!0){if(zt=tt.getWireframeAttribute(Oe),zt===void 0)return;Ti=2}const Yt=Oe.drawRange,ci=Oe.attributes.position;let os=Yt.start*Ti,ue=(Yt.start+Yt.count)*Ti;ft!==null&&(os=Math.max(os,ft.start*Ti),ue=Math.min(ue,(ft.start+ft.count)*Ti)),zt!==null?(os=Math.max(os,0),ue=Math.min(ue,zt.count)):ci!=null&&(os=Math.max(os,0),ue=Math.min(ue,ci.count));const He=ue-os;if(He<0||He===1/0)return;ms.setup(Ae,Be,At,Oe,zt);let Je,bt=Tt;if(zt!==null&&(Je=et.get(zt),bt=Ii,bt.setIndex(Je)),Ae.isMesh)Be.wireframe===!0?(wt.setLineWidth(Be.wireframeLinewidth*si()),bt.setMode(me.LINES)):bt.setMode(me.TRIANGLES);else if(Ae.isLine){let Pt=Be.linewidth;Pt===void 0&&(Pt=1),wt.setLineWidth(Pt*si()),Ae.isLineSegments?bt.setMode(me.LINES):Ae.isLineLoop?bt.setMode(me.LINE_LOOP):bt.setMode(me.LINE_STRIP)}else Ae.isPoints?bt.setMode(me.POINTS):Ae.isSprite&&bt.setMode(me.TRIANGLES);if(Ae.isBatchedMesh)if(Ae._multiDrawInstances!==null)x3("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),bt.renderMultiDrawInstances(Ae._multiDrawStarts,Ae._multiDrawCounts,Ae._multiDrawCount,Ae._multiDrawInstances);else if(pt.get("WEBGL_multi_draw"))bt.renderMultiDraw(Ae._multiDrawStarts,Ae._multiDrawCounts,Ae._multiDrawCount);else{const Pt=Ae._multiDrawStarts,Hi=Ae._multiDrawCounts,xi=Ae._multiDrawCount,as=zt?et.get(zt).bytesPerElement:1,Ir=Mt.get(Be).currentProgram.getUniforms();for(let Fs=0;Fs<xi;Fs++)Ir.setValue(me,"_gl_DrawID",Fs),bt.render(Pt[Fs]/as,Hi[Fs])}else if(Ae.isInstancedMesh)bt.renderInstances(os,He,Ae.count);else if(Oe.isInstancedBufferGeometry){const Pt=Oe._maxInstanceCount!==void 0?Oe._maxInstanceCount:1/0,Hi=Math.min(Oe.instanceCount,Pt);bt.renderInstances(os,He,Hi)}else bt.render(os,He)};function Ms(re,Ce,Oe){re.transparent===!0&&re.side===Sm&&re.forceSinglePass===!1?(re.side=bu,re.needsUpdate=!0,Jr(re,Ce,Oe),re.side=Cy,re.needsUpdate=!0,Jr(re,Ce,Oe),re.side=Sm):Jr(re,Ce,Oe)}this.compile=function(re,Ce,Oe=null){Oe===null&&(Oe=re),x=hi.get(Oe),x.init(Ce),T.push(x),Oe.traverseVisible(function(Ae){Ae.isLight&&Ae.layers.test(Ce.layers)&&(x.pushLight(Ae),Ae.castShadow&&x.pushShadow(Ae))}),re!==Oe&&re.traverseVisible(function(Ae){Ae.isLight&&Ae.layers.test(Ce.layers)&&(x.pushLight(Ae),Ae.castShadow&&x.pushShadow(Ae))}),x.setupLights();const Be=new Set;return re.traverse(function(Ae){if(!(Ae.isMesh||Ae.isPoints||Ae.isLine||Ae.isSprite))return;const ft=Ae.material;if(ft)if(Array.isArray(ft))for(let St=0;St<ft.length;St++){const At=ft[St];Ms(At,Oe,Ae),Be.add(At)}else Ms(ft,Oe,Ae),Be.add(ft)}),x=T.pop(),Be},this.compileAsync=function(re,Ce,Oe=null){const Be=this.compile(re,Ce,Oe);return new Promise(Ae=>{function ft(){if(Be.forEach(function(St){Mt.get(St).currentProgram.isReady()&&Be.delete(St)}),Be.size===0){Ae(re);return}setTimeout(ft,10)}pt.get("KHR_parallel_shader_compile")!==null?ft():setTimeout(ft,10)})};let Le=null;function Ui(re){Le&&Le(re)}function Sn(){Br.stop()}function Js(){Br.start()}const Br=new xye;Br.setAnimationLoop(Ui),typeof self<"u"&&Br.setContext(self),this.setAnimationLoop=function(re){Le=re,Qe.setAnimationLoop(re),re===null?Br.stop():Br.start()},Qe.addEventListener("sessionstart",Sn),Qe.addEventListener("sessionend",Js),this.render=function(re,Ce){if(Ce!==void 0&&Ce.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(M===!0)return;if(re.matrixWorldAutoUpdate===!0&&re.updateMatrixWorld(),Ce.parent===null&&Ce.matrixWorldAutoUpdate===!0&&Ce.updateMatrixWorld(),Qe.enabled===!0&&Qe.isPresenting===!0&&(Qe.cameraAutoUpdate===!0&&Qe.updateCamera(Ce),Ce=Qe.getCamera()),re.isScene===!0&&re.onBeforeRender(C,re,Ce,L),x=hi.get(re,T.length),x.init(Ce),T.push(x),Ee.multiplyMatrices(Ce.projectionMatrix,Ce.matrixWorldInverse),de.setFromProjectionMatrix(Ee),Ne=this.localClippingEnabled,fe=ct.init(this.clippingPlanes,Ne),v=dt.get(re,w.length),v.init(),w.push(v),Qe.enabled===!0&&Qe.isPresenting===!0){const ft=C.xr.getDepthSensingMesh();ft!==null&&Bt(ft,Ce,-1/0,C.sortObjects)}Bt(re,Ce,0,C.sortObjects),v.finish(),C.sortObjects===!0&&v.sort(ne,j),oi=Qe.enabled===!1||Qe.isPresenting===!1||Qe.hasDepthSensing()===!1,oi&&li.addToRenderList(v,re),this.info.render.frame++,fe===!0&&ct.beginShadows();const Oe=x.state.shadowsArray;xt.render(Oe,re,Ce),fe===!0&&ct.endShadows(),this.info.autoReset===!0&&this.info.reset();const Be=v.opaque,Ae=v.transmissive;if(x.setupLights(),Ce.isArrayCamera){const ft=Ce.cameras;if(Ae.length>0)for(let St=0,At=ft.length;St<At;St++){const zt=ft[St];Rn(Be,Ae,re,zt)}oi&&li.render(re);for(let St=0,At=ft.length;St<At;St++){const zt=ft[St];ch(v,re,zt,zt.viewport)}}else Ae.length>0&&Rn(Be,Ae,re,Ce),oi&&li.render(re),ch(v,re,Ce);L!==null&&I===0&&(le.updateMultisampleRenderTarget(L),le.updateRenderTargetMipmap(L)),re.isScene===!0&&re.onAfterRender(C,re,Ce),ms.resetDefaultState(),D=-1,O=null,T.pop(),T.length>0?(x=T[T.length-1],fe===!0&&ct.setGlobalState(C.clippingPlanes,x.state.camera)):x=null,w.pop(),w.length>0?v=w[w.length-1]:v=null};function Bt(re,Ce,Oe,Be){if(re.visible===!1)return;if(re.layers.test(Ce.layers)){if(re.isGroup)Oe=re.renderOrder;else if(re.isLOD)re.autoUpdate===!0&&re.update(Ce);else if(re.isLight)x.pushLight(re),re.castShadow&&x.pushShadow(re);else if(re.isSprite){if(!re.frustumCulled||de.intersectsSprite(re)){Be&&qt.setFromMatrixPosition(re.matrixWorld).applyMatrix4(Ee);const St=Ze.update(re),At=re.material;At.visible&&v.push(re,St,At,Oe,qt.z,null)}}else if((re.isMesh||re.isLine||re.isPoints)&&(!re.frustumCulled||de.intersectsObject(re))){const St=Ze.update(re),At=re.material;if(Be&&(re.boundingSphere!==void 0?(re.boundingSphere===null&&re.computeBoundingSphere(),qt.copy(re.boundingSphere.center)):(St.boundingSphere===null&&St.computeBoundingSphere(),qt.copy(St.boundingSphere.center)),qt.applyMatrix4(re.matrixWorld).applyMatrix4(Ee)),Array.isArray(At)){const zt=St.groups;for(let Ti=0,Yt=zt.length;Ti<Yt;Ti++){const ci=zt[Ti],os=At[ci.materialIndex];os&&os.visible&&v.push(re,St,os,Oe,qt.z,ci)}}else At.visible&&v.push(re,St,At,Oe,qt.z,null)}}const ft=re.children;for(let St=0,At=ft.length;St<At;St++)Bt(ft[St],Ce,Oe,Be)}function ch(re,Ce,Oe,Be){const Ae=re.opaque,ft=re.transmissive,St=re.transparent;x.setupLightsView(Oe),fe===!0&&ct.setGlobalState(C.clippingPlanes,Oe),Be&&wt.viewport(U.copy(Be)),Ae.length>0&&Qr(Ae,Ce,Oe),ft.length>0&&Qr(ft,Ce,Oe),St.length>0&&Qr(St,Ce,Oe),wt.buffers.depth.setTest(!0),wt.buffers.depth.setMask(!0),wt.buffers.color.setMask(!0),wt.setPolygonOffset(!1)}function Rn(re,Ce,Oe,Be){if((Oe.isScene===!0?Oe.overrideMaterial:null)!==null)return;x.state.transmissionRenderTarget[Be.id]===void 0&&(x.state.transmissionRenderTarget[Be.id]=new D1(1,1,{generateMipmaps:!0,type:pt.has("EXT_color_buffer_half_float")||pt.has("EXT_color_buffer_float")?yA:Vf,minFilter:zv,samples:4,stencilBuffer:r,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Zs.workingColorSpace}));const ft=x.state.transmissionRenderTarget[Be.id],St=Be.viewport||U;ft.setSize(St.z*C.transmissionResolutionScale,St.w*C.transmissionResolutionScale);const At=C.getRenderTarget();C.setRenderTarget(ft),C.getClearColor(V),H=C.getClearAlpha(),H<1&&C.setClearColor(16777215,.5),C.clear(),oi&&li.render(Oe);const zt=C.toneMapping;C.toneMapping=ly;const Ti=Be.viewport;if(Be.viewport!==void 0&&(Be.viewport=void 0),x.setupLightsView(Be),fe===!0&&ct.setGlobalState(C.clippingPlanes,Be),Qr(re,Oe,Be),le.updateMultisampleRenderTarget(ft),le.updateRenderTargetMipmap(ft),pt.has("WEBGL_multisampled_render_to_texture")===!1){let Yt=!1;for(let ci=0,os=Ce.length;ci<os;ci++){const ue=Ce[ci],He=ue.object,Je=ue.geometry,bt=ue.material,Pt=ue.group;if(bt.side===Sm&&He.layers.test(Be.layers)){const Hi=bt.side;bt.side=bu,bt.needsUpdate=!0,dl(He,Oe,Be,Je,bt,Pt),bt.side=Hi,bt.needsUpdate=!0,Yt=!0}}Yt===!0&&(le.updateMultisampleRenderTarget(ft),le.updateRenderTargetMipmap(ft))}C.setRenderTarget(At),C.setClearColor(V,H),Ti!==void 0&&(Be.viewport=Ti),C.toneMapping=zt}function Qr(re,Ce,Oe){const Be=Ce.isScene===!0?Ce.overrideMaterial:null;for(let Ae=0,ft=re.length;Ae<ft;Ae++){const St=re[Ae],At=St.object,zt=St.geometry,Ti=St.group;let Yt=St.material;Yt.allowOverride===!0&&Be!==null&&(Yt=Be),At.layers.test(Oe.layers)&&dl(At,Ce,Oe,zt,Yt,Ti)}}function dl(re,Ce,Oe,Be,Ae,ft){re.onBeforeRender(C,Ce,Oe,Be,Ae,ft),re.modelViewMatrix.multiplyMatrices(Oe.matrixWorldInverse,re.matrixWorld),re.normalMatrix.getNormalMatrix(re.modelViewMatrix),Ae.onBeforeRender(C,Ce,Oe,Be,re,ft),Ae.transparent===!0&&Ae.side===Sm&&Ae.forceSinglePass===!1?(Ae.side=bu,Ae.needsUpdate=!0,C.renderBufferDirect(Oe,Ce,Be,Ae,re,ft),Ae.side=Cy,Ae.needsUpdate=!0,C.renderBufferDirect(Oe,Ce,Be,Ae,re,ft),Ae.side=Sm):C.renderBufferDirect(Oe,Ce,Be,Ae,re,ft),re.onAfterRender(C,Ce,Oe,Be,Ae,ft)}function Jr(re,Ce,Oe){Ce.isScene!==!0&&(Ce=Mi);const Be=Mt.get(re),Ae=x.state.lights,ft=x.state.shadowsArray,St=Ae.state.version,At=Ct.getParameters(re,Ae.state,ft,Ce,Oe),zt=Ct.getProgramCacheKey(At);let Ti=Be.programs;Be.environment=re.isMeshStandardMaterial?Ce.environment:null,Be.fog=Ce.fog,Be.envMap=(re.isMeshStandardMaterial?De:te).get(re.envMap||Be.environment),Be.envMapRotation=Be.environment!==null&&re.envMap===null?Ce.environmentRotation:re.envMapRotation,Ti===void 0&&(re.addEventListener("dispose",qi),Ti=new Map,Be.programs=Ti);let Yt=Ti.get(zt);if(Yt!==void 0){if(Be.currentProgram===Yt&&Be.lightsStateVersion===St)return Bl(re,At),Yt}else At.uniforms=Ct.getUniforms(re),re.onBeforeCompile(At,C),Yt=Ct.acquireProgram(At,zt),Ti.set(zt,Yt),Be.uniforms=At.uniforms;const ci=Be.uniforms;return(!re.isShaderMaterial&&!re.isRawShaderMaterial||re.clipping===!0)&&(ci.clippingPlanes=ct.uniform),Bl(re,At),Be.needsLights=ys(re),Be.lightsStateVersion=St,Be.needsLights&&(ci.ambientLightColor.value=Ae.state.ambient,ci.lightProbe.value=Ae.state.probe,ci.directionalLights.value=Ae.state.directional,ci.directionalLightShadows.value=Ae.state.directionalShadow,ci.spotLights.value=Ae.state.spot,ci.spotLightShadows.value=Ae.state.spotShadow,ci.rectAreaLights.value=Ae.state.rectArea,ci.ltc_1.value=Ae.state.rectAreaLTC1,ci.ltc_2.value=Ae.state.rectAreaLTC2,ci.pointLights.value=Ae.state.point,ci.pointLightShadows.value=Ae.state.pointShadow,ci.hemisphereLights.value=Ae.state.hemi,ci.directionalShadowMap.value=Ae.state.directionalShadowMap,ci.directionalShadowMatrix.value=Ae.state.directionalShadowMatrix,ci.spotShadowMap.value=Ae.state.spotShadowMap,ci.spotLightMatrix.value=Ae.state.spotLightMatrix,ci.spotLightMap.value=Ae.state.spotLightMap,ci.pointShadowMap.value=Ae.state.pointShadowMap,ci.pointShadowMatrix.value=Ae.state.pointShadowMatrix),Be.currentProgram=Yt,Be.uniformsList=null,Yt}function La(re){if(re.uniformsList===null){const Ce=re.currentProgram.getUniforms();re.uniformsList=b3.seqWithValue(Ce.seq,re.uniforms)}return re.uniformsList}function Bl(re,Ce){const Oe=Mt.get(re);Oe.outputColorSpace=Ce.outputColorSpace,Oe.batching=Ce.batching,Oe.batchingColor=Ce.batchingColor,Oe.instancing=Ce.instancing,Oe.instancingColor=Ce.instancingColor,Oe.instancingMorph=Ce.instancingMorph,Oe.skinning=Ce.skinning,Oe.morphTargets=Ce.morphTargets,Oe.morphNormals=Ce.morphNormals,Oe.morphColors=Ce.morphColors,Oe.morphTargetsCount=Ce.morphTargetsCount,Oe.numClippingPlanes=Ce.numClippingPlanes,Oe.numIntersection=Ce.numClipIntersection,Oe.vertexAlphas=Ce.vertexAlphas,Oe.vertexTangents=Ce.vertexTangents,Oe.toneMapping=Ce.toneMapping}function wi(re,Ce,Oe,Be,Ae){Ce.isScene!==!0&&(Ce=Mi),le.resetTextureUnits();const ft=Ce.fog,St=Be.isMeshStandardMaterial?Ce.environment:null,At=L===null?C.outputColorSpace:L.isXRRenderTarget===!0?L.texture.colorSpace:TS,zt=(Be.isMeshStandardMaterial?De:te).get(Be.envMap||St),Ti=Be.vertexColors===!0&&!!Oe.attributes.color&&Oe.attributes.color.itemSize===4,Yt=!!Oe.attributes.tangent&&(!!Be.normalMap||Be.anisotropy>0),ci=!!Oe.morphAttributes.position,os=!!Oe.morphAttributes.normal,ue=!!Oe.morphAttributes.color;let He=ly;Be.toneMapped&&(L===null||L.isXRRenderTarget===!0)&&(He=C.toneMapping);const Je=Oe.morphAttributes.position||Oe.morphAttributes.normal||Oe.morphAttributes.color,bt=Je!==void 0?Je.length:0,Pt=Mt.get(Be),Hi=x.state.lights;if(fe===!0&&(Ne===!0||re!==O)){const Gn=re===O&&Be.id===D;ct.setState(Be,re,Gn)}let xi=!1;Be.version===Pt.__version?(Pt.needsLights&&Pt.lightsStateVersion!==Hi.state.version||Pt.outputColorSpace!==At||Ae.isBatchedMesh&&Pt.batching===!1||!Ae.isBatchedMesh&&Pt.batching===!0||Ae.isBatchedMesh&&Pt.batchingColor===!0&&Ae.colorTexture===null||Ae.isBatchedMesh&&Pt.batchingColor===!1&&Ae.colorTexture!==null||Ae.isInstancedMesh&&Pt.instancing===!1||!Ae.isInstancedMesh&&Pt.instancing===!0||Ae.isSkinnedMesh&&Pt.skinning===!1||!Ae.isSkinnedMesh&&Pt.skinning===!0||Ae.isInstancedMesh&&Pt.instancingColor===!0&&Ae.instanceColor===null||Ae.isInstancedMesh&&Pt.instancingColor===!1&&Ae.instanceColor!==null||Ae.isInstancedMesh&&Pt.instancingMorph===!0&&Ae.morphTexture===null||Ae.isInstancedMesh&&Pt.instancingMorph===!1&&Ae.morphTexture!==null||Pt.envMap!==zt||Be.fog===!0&&Pt.fog!==ft||Pt.numClippingPlanes!==void 0&&(Pt.numClippingPlanes!==ct.numPlanes||Pt.numIntersection!==ct.numIntersection)||Pt.vertexAlphas!==Ti||Pt.vertexTangents!==Yt||Pt.morphTargets!==ci||Pt.morphNormals!==os||Pt.morphColors!==ue||Pt.toneMapping!==He||Pt.morphTargetsCount!==bt)&&(xi=!0):(xi=!0,Pt.__version=Be.version);let as=Pt.currentProgram;xi===!0&&(as=Jr(Be,Ce,Ae));let Ir=!1,Fs=!1,Dr=!1;const en=as.getUniforms(),io=Pt.uniforms;if(wt.useProgram(as.program)&&(Ir=!0,Fs=!0,Dr=!0),Be.id!==D&&(D=Be.id,Fs=!0),Ir||O!==re){wt.buffers.depth.getReversed()?(je.copy(re.projectionMatrix),TBe(je),PBe(je),en.setValue(me,"projectionMatrix",je)):en.setValue(me,"projectionMatrix",re.projectionMatrix),en.setValue(me,"viewMatrix",re.matrixWorldInverse);const Nr=en.map.cameraPosition;Nr!==void 0&&Nr.setValue(me,Zt.setFromMatrixPosition(re.matrixWorld)),$e.logarithmicDepthBuffer&&en.setValue(me,"logDepthBufFC",2/(Math.log(re.far+1)/Math.LN2)),(Be.isMeshPhongMaterial||Be.isMeshToonMaterial||Be.isMeshLambertMaterial||Be.isMeshBasicMaterial||Be.isMeshStandardMaterial||Be.isShaderMaterial)&&en.setValue(me,"isOrthographic",re.isOrthographicCamera===!0),O!==re&&(O=re,Fs=!0,Dr=!0)}if(Ae.isSkinnedMesh){en.setOptional(me,Ae,"bindMatrix"),en.setOptional(me,Ae,"bindMatrixInverse");const Gn=Ae.skeleton;Gn&&(Gn.boneTexture===null&&Gn.computeBoneTexture(),en.setValue(me,"boneTexture",Gn.boneTexture,le))}Ae.isBatchedMesh&&(en.setOptional(me,Ae,"batchingTexture"),en.setValue(me,"batchingTexture",Ae._matricesTexture,le),en.setOptional(me,Ae,"batchingIdTexture"),en.setValue(me,"batchingIdTexture",Ae._indirectTexture,le),en.setOptional(me,Ae,"batchingColorTexture"),Ae._colorsTexture!==null&&en.setValue(me,"batchingColorTexture",Ae._colorsTexture,le));const dn=Oe.morphAttributes;if((dn.position!==void 0||dn.normal!==void 0||dn.color!==void 0)&&jt.update(Ae,Oe,as),(Fs||Pt.receiveShadow!==Ae.receiveShadow)&&(Pt.receiveShadow=Ae.receiveShadow,en.setValue(me,"receiveShadow",Ae.receiveShadow)),Be.isMeshGouraudMaterial&&Be.envMap!==null&&(io.envMap.value=zt,io.flipEnvMap.value=zt.isCubeTexture&&zt.isRenderTargetTexture===!1?-1:1),Be.isMeshStandardMaterial&&Be.envMap===null&&Ce.environment!==null&&(io.envMapIntensity.value=Ce.environmentIntensity),Fs&&(en.setValue(me,"toneMappingExposure",C.toneMappingExposure),Pt.needsLights&&ha(io,Dr),ft&&Be.fog===!0&&gt.refreshFogUniforms(io,ft),gt.refreshMaterialUniforms(io,Be,ee,W,x.state.transmissionRenderTarget[re.id]),b3.upload(me,La(Pt),io,le)),Be.isShaderMaterial&&Be.uniformsNeedUpdate===!0&&(b3.upload(me,La(Pt),io,le),Be.uniformsNeedUpdate=!1),Be.isSpriteMaterial&&en.setValue(me,"center",Ae.center),en.setValue(me,"modelViewMatrix",Ae.modelViewMatrix),en.setValue(me,"normalMatrix",Ae.normalMatrix),en.setValue(me,"modelMatrix",Ae.matrixWorld),Be.isShaderMaterial||Be.isRawShaderMaterial){const Gn=Be.uniformsGroups;for(let Nr=0,da=Gn.length;Nr<da;Nr++){const Nu=Gn[Nr];we.update(Nu,as),we.bind(Nu,as)}}return as}function ha(re,Ce){re.ambientLightColor.needsUpdate=Ce,re.lightProbe.needsUpdate=Ce,re.directionalLights.needsUpdate=Ce,re.directionalLightShadows.needsUpdate=Ce,re.pointLights.needsUpdate=Ce,re.pointLightShadows.needsUpdate=Ce,re.spotLights.needsUpdate=Ce,re.spotLightShadows.needsUpdate=Ce,re.rectAreaLights.needsUpdate=Ce,re.hemisphereLights.needsUpdate=Ce}function ys(re){return re.isMeshLambertMaterial||re.isMeshToonMaterial||re.isMeshPhongMaterial||re.isMeshStandardMaterial||re.isShadowMaterial||re.isShaderMaterial&&re.lights===!0}this.getActiveCubeFace=function(){return A},this.getActiveMipmapLevel=function(){return I},this.getRenderTarget=function(){return L},this.setRenderTargetTextures=function(re,Ce,Oe){const Be=Mt.get(re);Be.__autoAllocateDepthBuffer=re.resolveDepthBuffer===!1,Be.__autoAllocateDepthBuffer===!1&&(Be.__useRenderToTexture=!1),Mt.get(re.texture).__webglTexture=Ce,Mt.get(re.depthTexture).__webglTexture=Be.__autoAllocateDepthBuffer?void 0:Oe,Be.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(re,Ce){const Oe=Mt.get(re);Oe.__webglFramebuffer=Ce,Oe.__useDefaultFramebuffer=Ce===void 0};const eo=me.createFramebuffer();this.setRenderTarget=function(re,Ce=0,Oe=0){L=re,A=Ce,I=Oe;let Be=!0,Ae=null,ft=!1,St=!1;if(re){const zt=Mt.get(re);if(zt.__useDefaultFramebuffer!==void 0)wt.bindFramebuffer(me.FRAMEBUFFER,null),Be=!1;else if(zt.__webglFramebuffer===void 0)le.setupRenderTarget(re);else if(zt.__hasExternalTextures)le.rebindTextures(re,Mt.get(re.texture).__webglTexture,Mt.get(re.depthTexture).__webglTexture);else if(re.depthBuffer){const ci=re.depthTexture;if(zt.__boundDepthTexture!==ci){if(ci!==null&&Mt.has(ci)&&(re.width!==ci.image.width||re.height!==ci.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");le.setupDepthRenderbuffer(re)}}const Ti=re.texture;(Ti.isData3DTexture||Ti.isDataArrayTexture||Ti.isCompressedArrayTexture)&&(St=!0);const Yt=Mt.get(re).__webglFramebuffer;re.isWebGLCubeRenderTarget?(Array.isArray(Yt[Ce])?Ae=Yt[Ce][Oe]:Ae=Yt[Ce],ft=!0):re.samples>0&&le.useMultisampledRTT(re)===!1?Ae=Mt.get(re).__webglMultisampledFramebuffer:Array.isArray(Yt)?Ae=Yt[Oe]:Ae=Yt,U.copy(re.viewport),$.copy(re.scissor),B=re.scissorTest}else U.copy(oe).multiplyScalar(ee).floor(),$.copy(ve).multiplyScalar(ee).floor(),B=Ye;if(Oe!==0&&(Ae=eo),wt.bindFramebuffer(me.FRAMEBUFFER,Ae)&&Be&&wt.drawBuffers(re,Ae),wt.viewport(U),wt.scissor($),wt.setScissorTest(B),ft){const zt=Mt.get(re.texture);me.framebufferTexture2D(me.FRAMEBUFFER,me.COLOR_ATTACHMENT0,me.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,zt.__webglTexture,Oe)}else if(St){const zt=Mt.get(re.texture),Ti=Ce;me.framebufferTextureLayer(me.FRAMEBUFFER,me.COLOR_ATTACHMENT0,zt.__webglTexture,Oe,Ti)}else if(re!==null&&Oe!==0){const zt=Mt.get(re.texture);me.framebufferTexture2D(me.FRAMEBUFFER,me.COLOR_ATTACHMENT0,me.TEXTURE_2D,zt.__webglTexture,Oe)}D=-1},this.readRenderTargetPixels=function(re,Ce,Oe,Be,Ae,ft,St){if(!(re&&re.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let At=Mt.get(re).__webglFramebuffer;if(re.isWebGLCubeRenderTarget&&St!==void 0&&(At=At[St]),At){wt.bindFramebuffer(me.FRAMEBUFFER,At);try{const zt=re.texture,Ti=zt.format,Yt=zt.type;if(!$e.textureFormatReadable(Ti)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!$e.textureTypeReadable(Yt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Ce>=0&&Ce<=re.width-Be&&Oe>=0&&Oe<=re.height-Ae&&me.readPixels(Ce,Oe,Be,Ae,di.convert(Ti),di.convert(Yt),ft)}finally{const zt=L!==null?Mt.get(L).__webglFramebuffer:null;wt.bindFramebuffer(me.FRAMEBUFFER,zt)}}},this.readRenderTargetPixelsAsync=async function(re,Ce,Oe,Be,Ae,ft,St){if(!(re&&re.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let At=Mt.get(re).__webglFramebuffer;if(re.isWebGLCubeRenderTarget&&St!==void 0&&(At=At[St]),At)if(Ce>=0&&Ce<=re.width-Be&&Oe>=0&&Oe<=re.height-Ae){wt.bindFramebuffer(me.FRAMEBUFFER,At);const zt=re.texture,Ti=zt.format,Yt=zt.type;if(!$e.textureFormatReadable(Ti))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!$e.textureTypeReadable(Yt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const ci=me.createBuffer();me.bindBuffer(me.PIXEL_PACK_BUFFER,ci),me.bufferData(me.PIXEL_PACK_BUFFER,ft.byteLength,me.STREAM_READ),me.readPixels(Ce,Oe,Be,Ae,di.convert(Ti),di.convert(Yt),0);const os=L!==null?Mt.get(L).__webglFramebuffer:null;wt.bindFramebuffer(me.FRAMEBUFFER,os);const ue=me.fenceSync(me.SYNC_GPU_COMMANDS_COMPLETE,0);return me.flush(),await CBe(me,ue,4),me.bindBuffer(me.PIXEL_PACK_BUFFER,ci),me.getBufferSubData(me.PIXEL_PACK_BUFFER,0,ft),me.deleteBuffer(ci),me.deleteSync(ue),ft}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(re,Ce=null,Oe=0){const Be=Math.pow(2,-Oe),Ae=Math.floor(re.image.width*Be),ft=Math.floor(re.image.height*Be),St=Ce!==null?Ce.x:0,At=Ce!==null?Ce.y:0;le.setTexture2D(re,0),me.copyTexSubImage2D(me.TEXTURE_2D,Oe,0,0,St,At,Ae,ft),wt.unbindTexture()};const to=me.createFramebuffer(),_n=me.createFramebuffer();this.copyTextureToTexture=function(re,Ce,Oe=null,Be=null,Ae=0,ft=null){ft===null&&(Ae!==0?(x3("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),ft=Ae,Ae=0):ft=0);let St,At,zt,Ti,Yt,ci,os,ue,He;const Je=re.isCompressedTexture?re.mipmaps[ft]:re.image;if(Oe!==null)St=Oe.max.x-Oe.min.x,At=Oe.max.y-Oe.min.y,zt=Oe.isBox3?Oe.max.z-Oe.min.z:1,Ti=Oe.min.x,Yt=Oe.min.y,ci=Oe.isBox3?Oe.min.z:0;else{const dn=Math.pow(2,-Ae);St=Math.floor(Je.width*dn),At=Math.floor(Je.height*dn),re.isDataArrayTexture?zt=Je.depth:re.isData3DTexture?zt=Math.floor(Je.depth*dn):zt=1,Ti=0,Yt=0,ci=0}Be!==null?(os=Be.x,ue=Be.y,He=Be.z):(os=0,ue=0,He=0);const bt=di.convert(Ce.format),Pt=di.convert(Ce.type);let Hi;Ce.isData3DTexture?(le.setTexture3D(Ce,0),Hi=me.TEXTURE_3D):Ce.isDataArrayTexture||Ce.isCompressedArrayTexture?(le.setTexture2DArray(Ce,0),Hi=me.TEXTURE_2D_ARRAY):(le.setTexture2D(Ce,0),Hi=me.TEXTURE_2D),me.pixelStorei(me.UNPACK_FLIP_Y_WEBGL,Ce.flipY),me.pixelStorei(me.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ce.premultiplyAlpha),me.pixelStorei(me.UNPACK_ALIGNMENT,Ce.unpackAlignment);const xi=me.getParameter(me.UNPACK_ROW_LENGTH),as=me.getParameter(me.UNPACK_IMAGE_HEIGHT),Ir=me.getParameter(me.UNPACK_SKIP_PIXELS),Fs=me.getParameter(me.UNPACK_SKIP_ROWS),Dr=me.getParameter(me.UNPACK_SKIP_IMAGES);me.pixelStorei(me.UNPACK_ROW_LENGTH,Je.width),me.pixelStorei(me.UNPACK_IMAGE_HEIGHT,Je.height),me.pixelStorei(me.UNPACK_SKIP_PIXELS,Ti),me.pixelStorei(me.UNPACK_SKIP_ROWS,Yt),me.pixelStorei(me.UNPACK_SKIP_IMAGES,ci);const en=re.isDataArrayTexture||re.isData3DTexture,io=Ce.isDataArrayTexture||Ce.isData3DTexture;if(re.isDepthTexture){const dn=Mt.get(re),Gn=Mt.get(Ce),Nr=Mt.get(dn.__renderTarget),da=Mt.get(Gn.__renderTarget);wt.bindFramebuffer(me.READ_FRAMEBUFFER,Nr.__webglFramebuffer),wt.bindFramebuffer(me.DRAW_FRAMEBUFFER,da.__webglFramebuffer);for(let Nu=0;Nu<zt;Nu++)en&&(me.framebufferTextureLayer(me.READ_FRAMEBUFFER,me.COLOR_ATTACHMENT0,Mt.get(re).__webglTexture,Ae,ci+Nu),me.framebufferTextureLayer(me.DRAW_FRAMEBUFFER,me.COLOR_ATTACHMENT0,Mt.get(Ce).__webglTexture,ft,He+Nu)),me.blitFramebuffer(Ti,Yt,St,At,os,ue,St,At,me.DEPTH_BUFFER_BIT,me.NEAREST);wt.bindFramebuffer(me.READ_FRAMEBUFFER,null),wt.bindFramebuffer(me.DRAW_FRAMEBUFFER,null)}else if(Ae!==0||re.isRenderTargetTexture||Mt.has(re)){const dn=Mt.get(re),Gn=Mt.get(Ce);wt.bindFramebuffer(me.READ_FRAMEBUFFER,to),wt.bindFramebuffer(me.DRAW_FRAMEBUFFER,_n);for(let Nr=0;Nr<zt;Nr++)en?me.framebufferTextureLayer(me.READ_FRAMEBUFFER,me.COLOR_ATTACHMENT0,dn.__webglTexture,Ae,ci+Nr):me.framebufferTexture2D(me.READ_FRAMEBUFFER,me.COLOR_ATTACHMENT0,me.TEXTURE_2D,dn.__webglTexture,Ae),io?me.framebufferTextureLayer(me.DRAW_FRAMEBUFFER,me.COLOR_ATTACHMENT0,Gn.__webglTexture,ft,He+Nr):me.framebufferTexture2D(me.DRAW_FRAMEBUFFER,me.COLOR_ATTACHMENT0,me.TEXTURE_2D,Gn.__webglTexture,ft),Ae!==0?me.blitFramebuffer(Ti,Yt,St,At,os,ue,St,At,me.COLOR_BUFFER_BIT,me.NEAREST):io?me.copyTexSubImage3D(Hi,ft,os,ue,He+Nr,Ti,Yt,St,At):me.copyTexSubImage2D(Hi,ft,os,ue,Ti,Yt,St,At);wt.bindFramebuffer(me.READ_FRAMEBUFFER,null),wt.bindFramebuffer(me.DRAW_FRAMEBUFFER,null)}else io?re.isDataTexture||re.isData3DTexture?me.texSubImage3D(Hi,ft,os,ue,He,St,At,zt,bt,Pt,Je.data):Ce.isCompressedArrayTexture?me.compressedTexSubImage3D(Hi,ft,os,ue,He,St,At,zt,bt,Je.data):me.texSubImage3D(Hi,ft,os,ue,He,St,At,zt,bt,Pt,Je):re.isDataTexture?me.texSubImage2D(me.TEXTURE_2D,ft,os,ue,St,At,bt,Pt,Je.data):re.isCompressedTexture?me.compressedTexSubImage2D(me.TEXTURE_2D,ft,os,ue,Je.width,Je.height,bt,Je.data):me.texSubImage2D(me.TEXTURE_2D,ft,os,ue,St,At,bt,Pt,Je);me.pixelStorei(me.UNPACK_ROW_LENGTH,xi),me.pixelStorei(me.UNPACK_IMAGE_HEIGHT,as),me.pixelStorei(me.UNPACK_SKIP_PIXELS,Ir),me.pixelStorei(me.UNPACK_SKIP_ROWS,Fs),me.pixelStorei(me.UNPACK_SKIP_IMAGES,Dr),ft===0&&Ce.generateMipmaps&&me.generateMipmap(Hi),wt.unbindTexture()},this.copyTextureToTexture3D=function(re,Ce,Oe=null,Be=null,Ae=0){return x3('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(re,Ce,Oe,Be,Ae)},this.initRenderTarget=function(re){Mt.get(re).__webglFramebuffer===void 0&&le.setupRenderTarget(re)},this.initTexture=function(re){re.isCubeTexture?le.setTextureCube(re,0):re.isData3DTexture?le.setTexture3D(re,0):re.isDataArrayTexture||re.isCompressedArrayTexture?le.setTexture2DArray(re,0):le.setTexture2D(re,0),wt.unbindTexture()},this.resetState=function(){A=0,I=0,L=null,wt.reset(),ms.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Sf}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const i=this.getContext();i.drawingBufferColorSpace=Zs._getDrawingBufferColorSpace(e),i.unpackColorSpace=Zs._getUnpackColorSpace()}}const Oie={type:"change"},rY={type:"start"},Cye={type:"end"},PN=new cye,Lie=new L_,Z7e=Math.cos(70*SBe.DEG2RAD),Co=new ze,Kl=2*Math.PI,An={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},V5=1e-6;class K7e extends d8e{constructor(e,i=null){super(e,i),this.state=An.NONE,this.target=new ze,this.cursor=new ze,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Nw.ROTATE,MIDDLE:Nw.DOLLY,RIGHT:Nw.PAN},this.touches={ONE:pw.ROTATE,TWO:pw.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new ze,this._lastQuaternion=new N1,this._lastTargetPosition=new ze,this._quat=new N1().setFromUnitVectors(e.up,new ze(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new lie,this._sphericalDelta=new lie,this._scale=1,this._panOffset=new ze,this._rotateStart=new hs,this._rotateEnd=new hs,this._rotateDelta=new hs,this._panStart=new hs,this._panEnd=new hs,this._panDelta=new hs,this._dollyStart=new hs,this._dollyEnd=new hs,this._dollyDelta=new hs,this._dollyDirection=new ze,this._mouse=new hs,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=J7e.bind(this),this._onPointerDown=Q7e.bind(this),this._onPointerUp=eje.bind(this),this._onContextMenu=aje.bind(this),this._onMouseWheel=sje.bind(this),this._onKeyDown=nje.bind(this),this._onTouchStart=rje.bind(this),this._onTouchMove=oje.bind(this),this._onMouseDown=tje.bind(this),this._onMouseMove=ije.bind(this),this._interceptControlDown=lje.bind(this),this._interceptControlUp=uje.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(e){super.connect(e),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(Oie),this.update(),this.state=An.NONE}update(e=null){const i=this.object.position;Co.copy(i).sub(this.target),Co.applyQuaternion(this._quat),this._spherical.setFromVector3(Co),this.autoRotate&&this.state===An.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let s=this.minAzimuthAngle,n=this.maxAzimuthAngle;isFinite(s)&&isFinite(n)&&(s<-Math.PI?s+=Kl:s>Math.PI&&(s-=Kl),n<-Math.PI?n+=Kl:n>Math.PI&&(n-=Kl),s<=n?this._spherical.theta=Math.max(s,Math.min(n,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(s+n)/2?Math.max(s,this._spherical.theta):Math.min(n,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let r=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const o=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),r=o!=this._spherical.radius}if(Co.setFromSpherical(this._spherical),Co.applyQuaternion(this._quatInverse),i.copy(this.target).add(Co),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let o=null;if(this.object.isPerspectiveCamera){const a=Co.length();o=this._clampDistance(a*this._scale);const l=a-o;this.object.position.addScaledVector(this._dollyDirection,l),this.object.updateMatrixWorld(),r=!!l}else if(this.object.isOrthographicCamera){const a=new ze(this._mouse.x,this._mouse.y,0);a.unproject(this.object);const l=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),r=l!==this.object.zoom;const u=new ze(this._mouse.x,this._mouse.y,0);u.unproject(this.object),this.object.position.sub(u).add(a),this.object.updateMatrixWorld(),o=Co.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;o!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(o).add(this.object.position):(PN.origin.copy(this.object.position),PN.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(PN.direction))<Z7e?this.object.lookAt(this.target):(Lie.setFromNormalAndCoplanarPoint(this.object.up,this.target),PN.intersectPlane(Lie,this.target))))}else if(this.object.isOrthographicCamera){const o=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),o!==this.object.zoom&&(this.object.updateProjectionMatrix(),r=!0)}return this._scale=1,this._performCursorZoom=!1,r||this._lastPosition.distanceToSquared(this.object.position)>V5||8*(1-this._lastQuaternion.dot(this.object.quaternion))>V5||this._lastTargetPosition.distanceToSquared(this.target)>V5?(this.dispatchEvent(Oie),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?Kl/60*this.autoRotateSpeed*e:Kl/60/60*this.autoRotateSpeed}_getZoomScale(e){const i=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*i)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,i){Co.setFromMatrixColumn(i,0),Co.multiplyScalar(-e),this._panOffset.add(Co)}_panUp(e,i){this.screenSpacePanning===!0?Co.setFromMatrixColumn(i,1):(Co.setFromMatrixColumn(i,0),Co.crossVectors(this.object.up,Co)),Co.multiplyScalar(e),this._panOffset.add(Co)}_pan(e,i){const s=this.domElement;if(this.object.isPerspectiveCamera){const n=this.object.position;Co.copy(n).sub(this.target);let r=Co.length();r*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*r/s.clientHeight,this.object.matrix),this._panUp(2*i*r/s.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/s.clientWidth,this.object.matrix),this._panUp(i*(this.object.top-this.object.bottom)/this.object.zoom/s.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,i){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const s=this.domElement.getBoundingClientRect(),n=e-s.left,r=i-s.top,o=s.width,a=s.height;this._mouse.x=n/o*2-1,this._mouse.y=-(r/a)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const i=this.domElement;this._rotateLeft(Kl*this._rotateDelta.x/i.clientHeight),this._rotateUp(Kl*this._rotateDelta.y/i.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let i=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(Kl*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),i=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-Kl*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),i=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(Kl*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),i=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-Kl*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),i=!0;break}i&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{const i=this._getSecondPointerPosition(e),s=.5*(e.pageX+i.x),n=.5*(e.pageY+i.y);this._rotateStart.set(s,n)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{const i=this._getSecondPointerPosition(e),s=.5*(e.pageX+i.x),n=.5*(e.pageY+i.y);this._panStart.set(s,n)}}_handleTouchStartDolly(e){const i=this._getSecondPointerPosition(e),s=e.pageX-i.x,n=e.pageY-i.y,r=Math.sqrt(s*s+n*n);this._dollyStart.set(0,r)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{const s=this._getSecondPointerPosition(e),n=.5*(e.pageX+s.x),r=.5*(e.pageY+s.y);this._rotateEnd.set(n,r)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const i=this.domElement;this._rotateLeft(Kl*this._rotateDelta.x/i.clientHeight),this._rotateUp(Kl*this._rotateDelta.y/i.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{const i=this._getSecondPointerPosition(e),s=.5*(e.pageX+i.x),n=.5*(e.pageY+i.y);this._panEnd.set(s,n)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const i=this._getSecondPointerPosition(e),s=e.pageX-i.x,n=e.pageY-i.y,r=Math.sqrt(s*s+n*n);this._dollyEnd.set(0,r),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const o=(e.pageX+i.x)*.5,a=(e.pageY+i.y)*.5;this._updateZoomParameters(o,a)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let i=0;i<this._pointers.length;i++)if(this._pointers[i]==e.pointerId){this._pointers.splice(i,1);return}}_isTrackingPointer(e){for(let i=0;i<this._pointers.length;i++)if(this._pointers[i]==e.pointerId)return!0;return!1}_trackPointer(e){let i=this._pointerPositions[e.pointerId];i===void 0&&(i=new hs,this._pointerPositions[e.pointerId]=i),i.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const i=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[i]}_customWheelEvent(e){const i=e.deltaMode,s={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(i){case 1:s.deltaY*=16;break;case 2:s.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(s.deltaY*=10),s}}function Q7e(t){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(t.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(t)&&(this._addPointer(t),t.pointerType==="touch"?this._onTouchStart(t):this._onMouseDown(t)))}function J7e(t){this.enabled!==!1&&(t.pointerType==="touch"?this._onTouchMove(t):this._onMouseMove(t))}function eje(t){switch(this._removePointer(t),this._pointers.length){case 0:this.domElement.releasePointerCapture(t.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(Cye),this.state=An.NONE;break;case 1:const e=this._pointers[0],i=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:i.x,pageY:i.y});break}}function tje(t){let e;switch(t.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case Nw.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(t),this.state=An.DOLLY;break;case Nw.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(t),this.state=An.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(t),this.state=An.ROTATE}break;case Nw.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(t),this.state=An.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(t),this.state=An.PAN}break;default:this.state=An.NONE}this.state!==An.NONE&&this.dispatchEvent(rY)}function ije(t){switch(this.state){case An.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(t);break;case An.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(t);break;case An.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(t);break}}function sje(t){this.enabled===!1||this.enableZoom===!1||this.state!==An.NONE||(t.preventDefault(),this.dispatchEvent(rY),this._handleMouseWheel(this._customWheelEvent(t)),this.dispatchEvent(Cye))}function nje(t){this.enabled!==!1&&this._handleKeyDown(t)}function rje(t){switch(this._trackPointer(t),this._pointers.length){case 1:switch(this.touches.ONE){case pw.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(t),this.state=An.TOUCH_ROTATE;break;case pw.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(t),this.state=An.TOUCH_PAN;break;default:this.state=An.NONE}break;case 2:switch(this.touches.TWO){case pw.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(t),this.state=An.TOUCH_DOLLY_PAN;break;case pw.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(t),this.state=An.TOUCH_DOLLY_ROTATE;break;default:this.state=An.NONE}break;default:this.state=An.NONE}this.state!==An.NONE&&this.dispatchEvent(rY)}function oje(t){switch(this._trackPointer(t),this.state){case An.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(t),this.update();break;case An.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(t),this.update();break;case An.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(t),this.update();break;case An.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(t),this.update();break;default:this.state=An.NONE}}function aje(t){this.enabled!==!1&&t.preventDefault()}function lje(t){t.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function uje(t){t.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}class MN{static createPolygonWalls(e,i,s){return e.map((n,r,o)=>{const a=(r+1)%o.length,l=[(n[0]+o[a][0])/2,(n[1]+o[a][1])/2],u=gn.distance(n,o[a])/s,c=gn.radians2(n,o[a]),h=new MS(u,100,u,100);h.rotateY(c);const d=(l[0]-i[0])/s,m=(l[1]-i[1])/s;h.translate(d,0,-m);const f=new eP({color:16711680,side:Sm,wireframe:!0,transparent:!0,opacity:.1});return new Qc(h,f)})}static createLinePipe(e,i,s){const n=[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2],r=gn.distance(e[0],e[1])/s,o=gn.radians2(e[0],e[1]),a=new iY(1,1,r,8);a.rotateZ(Math.PI/2),a.rotateY(o);const l=(n[0]-i[0])/s,u=(n[1]-i[1])/s;a.translate(l,0,-u);const c=new eP({color:0,transparent:!0,opacity:.6});return new Qc(a,c)}static loadHeightMap(e,i,s){new o8e().load("/react-styx/heightmap.png",r=>{const o=r.image,a=document.createElement("canvas");a.width=o.width,a.height=o.height;const l=a.getContext("2d");l.drawImage(o,0,0);const u=l.getImageData(0,0,o.width,o.height).data,c=new MS(200,200,o.width-1,o.height-1);c.rotateX(-Math.PI/2);const h=c.attributes.position;for(let m=0;m<h.count;m++){const _=u[m*4]/255*50+e;h.setY(m,_)}h.needsUpdate=!0,c.computeVertexNormals();const d=new eP({color:i,wireframe:!0,transparent:!0,opacity:.05});s(new Qc(c,d))})}}const cje=Ve.forwardRef((t,e)=>{Ve.useImperativeHandle(e,()=>({resize:()=>{M(C+1)}}));const i=Ve.useContext(Hj),s=Ve.useRef(null),n=Ve.useRef(null),r=Ve.useRef(null),o=Ve.useRef(null),a=Ve.useRef(null),[l,u]=Ve.useState([]),[c,h]=Ve.useState([]),[d,m]=Ve.useState([[0,0],[1,1]]),[f,_]=Ve.useState(1),[v,x]=Ve.useState([0,0]),[w,T]=Ve.useState(0),[C,M]=Ve.useState(0),A=Ve.useRef([]),I=Ve.useRef([]);return i.moveListeners.push(async()=>{T(w+1)}),i.dragListeners.push(async()=>{T(w+1)}),Ve.useEffect(()=>{u(i.graphicsLayer.graphics.filter(D=>Im.getModelAttributes(D).role===Zr.Polygon).toArray()),h(i.graphicsLayer.graphics.filter(D=>Im.getModelAttributes(D).role===Zr.Line).toArray());const L=i.graphicsLayer.graphics.filter(D=>Im.getModelAttributes(D).role===Zr.Boundary);L.length>0&&L.getItemAt(0)&&m(L.getItemAt(0).geometry.rings[0]),console.log("ctxState")},[w]),Ve.useEffect(()=>{const L=gn.distance(d[0],d[1]);_(L/200),x([d.map(D=>D[0]).reduce((D,O)=>D+O,0)/d.length,d.map(D=>D[1]).reduce((D,O)=>D+O,0)/d.length]),MN.loadHeightMap(-20,8965256,D=>{r.current.add(D)}),MN.loadHeightMap(-60,8947916,D=>{r.current.add(D)}),console.log("boundaryRing")},[d]),Ve.useEffect(()=>{I.current.forEach(L=>{r.current.remove(L),L.geometry.dispose(),Array.isArray(L.material)?L.material.forEach(D=>D.dispose()):L.material.dispose()}),I.current.length=0,l.forEach((L,D)=>{const O=L.geometry.rings[0];MN.createPolygonWalls(O,v,f).forEach($=>{$.name=L.attributes.modelAttributes.model.id,r.current.add($),I.current.push($)})})},[l]),Ve.useEffect(()=>{A.current.forEach(L=>{r.current.remove(L),L.geometry.dispose(),Array.isArray(L.material)?L.material.forEach(D=>D.dispose()):L.material.dispose()}),A.current.length=0,c.forEach((L,D)=>{const O=L.geometry.paths[0],U=MN.createLinePipe(O,v,f);U.name=L.attributes.modelAttributes.model.id,A.current.push(U),r.current.add(U)})},[c]),Ve.useEffect(()=>{if(!s.current||!o.current||!n.current)return;const L=s.current.getBoundingClientRect(),D=L.width,O=L.height-40;n.current.setSize(D,O),o.current.aspect=D/O,o.current.updateProjectionMatrix(),console.log("sizeCounter")},[C]),Ve.useEffect(()=>{if(!s.current||i.graphicsLayer.graphics.length===0)return;const L=s.current,D=s.current.getBoundingClientRect(),O=D.width,U=D.height-40;if(!n.current){r.current=new QBe,o.current=new jc(45,O/U,1,1e3),o.current.position.set(0,100,200),o.current.lookAt(0,0,0),n.current=new W7e({antialias:!0}),n.current.setSize(O,U),n.current.setClearColor(16777215);const $=new c8e(16777215,1);$.position.set(0,100,100),r.current.add($),new K7e(o.current,n.current.domElement).update()}if(o.current.aspect=O/U,o.current.updateProjectionMatrix(),s.current&&n.current){const $=()=>{a.current=requestAnimationFrame($),n.current.render(r.current,o.current)};$()}return s.current.appendChild(n.current.domElement),()=>{var $;L&&(($=n.current)!=null&&$.domElement)&&L.removeChild(n.current.domElement),a.current&&cancelAnimationFrame(a.current)}},[]),ri.jsx("div",{ref:s,style:{position:"absolute",width:"100%",height:"100%"}})});var j2={exports:{}},z5={},G5={exports:{}},B5,Fie;function hje(){if(Fie)return B5;Fie=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return B5=t,B5}var q5,kie;function dje(){if(kie)return q5;kie=1;var t=hje();function e(){}function i(){}return i.resetWarningCache=e,q5=function(){function s(o,a,l,u,c,h){if(h!==t){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}s.isRequired=s;function n(){return s}var r={array:s,bigint:s,bool:s,func:s,number:s,object:s,string:s,symbol:s,any:s,arrayOf:n,element:s,elementType:s,instanceOf:n,node:s,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:i,resetWarningCache:e};return r.PropTypes=r,r},q5}var $ie;function Tye(){return $ie||($ie=1,G5.exports=dje()()),G5.exports}function Pye(t){var e,i,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(i=Pye(t[e]))&&(s&&(s+=" "),s+=i);else for(e in t)t[e]&&(s&&(s+=" "),s+=e);return s}function Uie(){for(var t,e,i=0,s="";i<arguments.length;)(t=arguments[i++])&&(e=Pye(t))&&(s&&(s+=" "),s+=e);return s}const mje=Object.freeze(Object.defineProperty({__proto__:null,clsx:Uie,default:Uie},Symbol.toStringTag,{value:"Module"})),pje=XSe(mje);var jr={},Wg={},Vie;function z4(){if(Vie)return Wg;Vie=1,Object.defineProperty(Wg,"__esModule",{value:!0}),Wg.dontSetMe=n,Wg.findInArray=t,Wg.int=s,Wg.isFunction=e,Wg.isNum=i;function t(r,o){for(let a=0,l=r.length;a<l;a++)if(o.apply(o,[r[a],a,r]))return r[a]}function e(r){return typeof r=="function"||Object.prototype.toString.call(r)==="[object Function]"}function i(r){return typeof r=="number"&&!isNaN(r)}function s(r){return parseInt(r,10)}function n(r,o,a){if(r[o])return new Error("Invalid prop ".concat(o," passed to ").concat(a," - do not set this, set it on the child."))}return Wg}var Zg={},zie;function fje(){if(zie)return Zg;zie=1,Object.defineProperty(Zg,"__esModule",{value:!0}),Zg.browserPrefixToKey=i,Zg.browserPrefixToStyle=s,Zg.default=void 0,Zg.getPrefix=e;const t=["Moz","Webkit","O","ms"];function e(){var r;let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const a=(r=window.document)===null||r===void 0||(r=r.documentElement)===null||r===void 0?void 0:r.style;if(!a||o in a)return"";for(let l=0;l<t.length;l++)if(i(o,t[l])in a)return t[l];return""}function i(r,o){return o?"".concat(o).concat(n(r)):r}function s(r,o){return o?"-".concat(o.toLowerCase(),"-").concat(r):r}function n(r){let o="",a=!0;for(let l=0;l<r.length;l++)a?(o+=r[l].toUpperCase(),a=!1):r[l]==="-"?a=!0:o+=r[l];return o}return Zg.default=e(),Zg}var Gie;function oY(){if(Gie)return jr;Gie=1,Object.defineProperty(jr,"__esModule",{value:!0}),jr.addClassName=M,jr.addEvent=a,jr.addUserSelectStyles=T,jr.createCSSTransform=f,jr.createSVGTransform=_,jr.getTouch=x,jr.getTouchIdentifier=w,jr.getTranslation=v,jr.innerHeight=h,jr.innerWidth=d,jr.matchesSelector=r,jr.matchesSelectorAndParentsTo=o,jr.offsetXYFromParent=m,jr.outerHeight=u,jr.outerWidth=c,jr.removeClassName=A,jr.removeEvent=l,jr.removeUserSelectStyles=C;var t=z4(),e=s(fje());function i(I){if(typeof WeakMap!="function")return null;var L=new WeakMap,D=new WeakMap;return(i=function(O){return O?D:L})(I)}function s(I,L){if(I&&I.__esModule)return I;if(I===null||typeof I!="object"&&typeof I!="function")return{default:I};var D=i(L);if(D&&D.has(I))return D.get(I);var O={},U=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $ in I)if($!=="default"&&Object.prototype.hasOwnProperty.call(I,$)){var B=U?Object.getOwnPropertyDescriptor(I,$):null;B&&(B.get||B.set)?Object.defineProperty(O,$,B):O[$]=I[$]}return O.default=I,D&&D.set(I,O),O}let n="";function r(I,L){return n||(n=(0,t.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(D){return(0,t.isFunction)(I[D])})),(0,t.isFunction)(I[n])?I[n](L):!1}function o(I,L,D){let O=I;do{if(r(O,L))return!0;if(O===D)return!1;O=O.parentNode}while(O);return!1}function a(I,L,D,O){if(!I)return;const U={capture:!0,...O};I.addEventListener?I.addEventListener(L,D,U):I.attachEvent?I.attachEvent("on"+L,D):I["on"+L]=D}function l(I,L,D,O){if(!I)return;const U={capture:!0,...O};I.removeEventListener?I.removeEventListener(L,D,U):I.detachEvent?I.detachEvent("on"+L,D):I["on"+L]=null}function u(I){let L=I.clientHeight;const D=I.ownerDocument.defaultView.getComputedStyle(I);return L+=(0,t.int)(D.borderTopWidth),L+=(0,t.int)(D.borderBottomWidth),L}function c(I){let L=I.clientWidth;const D=I.ownerDocument.defaultView.getComputedStyle(I);return L+=(0,t.int)(D.borderLeftWidth),L+=(0,t.int)(D.borderRightWidth),L}function h(I){let L=I.clientHeight;const D=I.ownerDocument.defaultView.getComputedStyle(I);return L-=(0,t.int)(D.paddingTop),L-=(0,t.int)(D.paddingBottom),L}function d(I){let L=I.clientWidth;const D=I.ownerDocument.defaultView.getComputedStyle(I);return L-=(0,t.int)(D.paddingLeft),L-=(0,t.int)(D.paddingRight),L}function m(I,L,D){const U=L===L.ownerDocument.body?{left:0,top:0}:L.getBoundingClientRect(),$=(I.clientX+L.scrollLeft-U.left)/D,B=(I.clientY+L.scrollTop-U.top)/D;return{x:$,y:B}}function f(I,L){const D=v(I,L,"px");return{[(0,e.browserPrefixToKey)("transform",e.default)]:D}}function _(I,L){return v(I,L,"")}function v(I,L,D){let{x:O,y:U}=I,$="translate(".concat(O).concat(D,",").concat(U).concat(D,")");if(L){const B="".concat(typeof L.x=="string"?L.x:L.x+D),V="".concat(typeof L.y=="string"?L.y:L.y+D);$="translate(".concat(B,", ").concat(V,")")+$}return $}function x(I,L){return I.targetTouches&&(0,t.findInArray)(I.targetTouches,D=>L===D.identifier)||I.changedTouches&&(0,t.findInArray)(I.changedTouches,D=>L===D.identifier)}function w(I){if(I.targetTouches&&I.targetTouches[0])return I.targetTouches[0].identifier;if(I.changedTouches&&I.changedTouches[0])return I.changedTouches[0].identifier}function T(I){if(!I)return;let L=I.getElementById("react-draggable-style-el");L||(L=I.createElement("style"),L.type="text/css",L.id="react-draggable-style-el",L.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,L.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,I.getElementsByTagName("head")[0].appendChild(L)),I.body&&M(I.body,"react-draggable-transparent-selection")}function C(I){if(I)try{if(I.body&&A(I.body,"react-draggable-transparent-selection"),I.selection)I.selection.empty();else{const L=(I.defaultView||window).getSelection();L&&L.type!=="Caret"&&L.removeAllRanges()}}catch{}}function M(I,L){I.classList?I.classList.add(L):I.className.match(new RegExp("(?:^|\\s)".concat(L,"(?!\\S)")))||(I.className+=" ".concat(L))}function A(I,L){I.classList?I.classList.remove(L):I.className=I.className.replace(new RegExp("(?:^|\\s)".concat(L,"(?!\\S)"),"g"),"")}return jr}var Yd={},Bie;function Mye(){if(Bie)return Yd;Bie=1,Object.defineProperty(Yd,"__esModule",{value:!0}),Yd.canDragX=n,Yd.canDragY=r,Yd.createCoreData=a,Yd.createDraggableData=l,Yd.getBoundPosition=i,Yd.getControlPosition=o,Yd.snapToGrid=s;var t=z4(),e=oY();function i(h,d,m){if(!h.props.bounds)return[d,m];let{bounds:f}=h.props;f=typeof f=="string"?f:u(f);const _=c(h);if(typeof f=="string"){const{ownerDocument:v}=_,x=v.defaultView;let w;if(f==="parent"?w=_.parentNode:w=v.querySelector(f),!(w instanceof x.HTMLElement))throw new Error('Bounds selector "'+f+'" could not find an element.');const T=w,C=x.getComputedStyle(_),M=x.getComputedStyle(T);f={left:-_.offsetLeft+(0,t.int)(M.paddingLeft)+(0,t.int)(C.marginLeft),top:-_.offsetTop+(0,t.int)(M.paddingTop)+(0,t.int)(C.marginTop),right:(0,e.innerWidth)(T)-(0,e.outerWidth)(_)-_.offsetLeft+(0,t.int)(M.paddingRight)-(0,t.int)(C.marginRight),bottom:(0,e.innerHeight)(T)-(0,e.outerHeight)(_)-_.offsetTop+(0,t.int)(M.paddingBottom)-(0,t.int)(C.marginBottom)}}return(0,t.isNum)(f.right)&&(d=Math.min(d,f.right)),(0,t.isNum)(f.bottom)&&(m=Math.min(m,f.bottom)),(0,t.isNum)(f.left)&&(d=Math.max(d,f.left)),(0,t.isNum)(f.top)&&(m=Math.max(m,f.top)),[d,m]}function s(h,d,m){const f=Math.round(d/h[0])*h[0],_=Math.round(m/h[1])*h[1];return[f,_]}function n(h){return h.props.axis==="both"||h.props.axis==="x"}function r(h){return h.props.axis==="both"||h.props.axis==="y"}function o(h,d,m){const f=typeof d=="number"?(0,e.getTouch)(h,d):null;if(typeof d=="number"&&!f)return null;const _=c(m),v=m.props.offsetParent||_.offsetParent||_.ownerDocument.body;return(0,e.offsetXYFromParent)(f||h,v,m.props.scale)}function a(h,d,m){const f=!(0,t.isNum)(h.lastX),_=c(h);return f?{node:_,deltaX:0,deltaY:0,lastX:d,lastY:m,x:d,y:m}:{node:_,deltaX:d-h.lastX,deltaY:m-h.lastY,lastX:h.lastX,lastY:h.lastY,x:d,y:m}}function l(h,d){const m=h.props.scale;return{node:d.node,x:h.state.x+d.deltaX/m,y:h.state.y+d.deltaY/m,deltaX:d.deltaX/m,deltaY:d.deltaY/m,lastX:h.state.x,lastY:h.state.y}}function u(h){return{left:h.left,top:h.top,right:h.right,bottom:h.bottom}}function c(h){const d=h.findDOMNode();if(!d)throw new Error("<DraggableCore>: Unmounted during event!");return d}return Yd}var Y2={},AN={},qie;function Aye(){if(qie)return AN;qie=1,Object.defineProperty(AN,"__esModule",{value:!0}),AN.default=t;function t(){}return AN}var Hie;function gje(){if(Hie)return Y2;Hie=1,Object.defineProperty(Y2,"__esModule",{value:!0}),Y2.default=void 0;var t=u(NM()),e=a(Tye()),i=a(dF()),s=oY(),n=Mye(),r=z4(),o=a(Aye());function a(v){return v&&v.__esModule?v:{default:v}}function l(v){if(typeof WeakMap!="function")return null;var x=new WeakMap,w=new WeakMap;return(l=function(T){return T?w:x})(v)}function u(v,x){if(v&&v.__esModule)return v;if(v===null||typeof v!="object"&&typeof v!="function")return{default:v};var w=l(x);if(w&&w.has(v))return w.get(v);var T={},C=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var M in v)if(M!=="default"&&Object.prototype.hasOwnProperty.call(v,M)){var A=C?Object.getOwnPropertyDescriptor(v,M):null;A&&(A.get||A.set)?Object.defineProperty(T,M,A):T[M]=v[M]}return T.default=v,w&&w.set(v,T),T}function c(v,x,w){return x=h(x),x in v?Object.defineProperty(v,x,{value:w,enumerable:!0,configurable:!0,writable:!0}):v[x]=w,v}function h(v){var x=d(v,"string");return typeof x=="symbol"?x:String(x)}function d(v,x){if(typeof v!="object"||v===null)return v;var w=v[Symbol.toPrimitive];if(w!==void 0){var T=w.call(v,x);if(typeof T!="object")return T;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(v)}const m={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let f=m.mouse,_=class extends t.Component{constructor(){super(...arguments),c(this,"dragging",!1),c(this,"lastX",NaN),c(this,"lastY",NaN),c(this,"touchIdentifier",null),c(this,"mounted",!1),c(this,"handleDragStart",x=>{if(this.props.onMouseDown(x),!this.props.allowAnyClick&&typeof x.button=="number"&&x.button!==0)return!1;const w=this.findDOMNode();if(!w||!w.ownerDocument||!w.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:T}=w;if(this.props.disabled||!(x.target instanceof T.defaultView.Node)||this.props.handle&&!(0,s.matchesSelectorAndParentsTo)(x.target,this.props.handle,w)||this.props.cancel&&(0,s.matchesSelectorAndParentsTo)(x.target,this.props.cancel,w))return;x.type==="touchstart"&&x.preventDefault();const C=(0,s.getTouchIdentifier)(x);this.touchIdentifier=C;const M=(0,n.getControlPosition)(x,C,this);if(M==null)return;const{x:A,y:I}=M,L=(0,n.createCoreData)(this,A,I);(0,o.default)("DraggableCore: handleDragStart: %j",L),(0,o.default)("calling",this.props.onStart),!(this.props.onStart(x,L)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,s.addUserSelectStyles)(T),this.dragging=!0,this.lastX=A,this.lastY=I,(0,s.addEvent)(T,f.move,this.handleDrag),(0,s.addEvent)(T,f.stop,this.handleDragStop))}),c(this,"handleDrag",x=>{const w=(0,n.getControlPosition)(x,this.touchIdentifier,this);if(w==null)return;let{x:T,y:C}=w;if(Array.isArray(this.props.grid)){let I=T-this.lastX,L=C-this.lastY;if([I,L]=(0,n.snapToGrid)(this.props.grid,I,L),!I&&!L)return;T=this.lastX+I,C=this.lastY+L}const M=(0,n.createCoreData)(this,T,C);if((0,o.default)("DraggableCore: handleDrag: %j",M),this.props.onDrag(x,M)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const L=document.createEvent("MouseEvents");L.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(L)}return}this.lastX=T,this.lastY=C}),c(this,"handleDragStop",x=>{if(!this.dragging)return;const w=(0,n.getControlPosition)(x,this.touchIdentifier,this);if(w==null)return;let{x:T,y:C}=w;if(Array.isArray(this.props.grid)){let L=T-this.lastX||0,D=C-this.lastY||0;[L,D]=(0,n.snapToGrid)(this.props.grid,L,D),T=this.lastX+L,C=this.lastY+D}const M=(0,n.createCoreData)(this,T,C);if(this.props.onStop(x,M)===!1||this.mounted===!1)return!1;const I=this.findDOMNode();I&&this.props.enableUserSelectHack&&(0,s.removeUserSelectStyles)(I.ownerDocument),(0,o.default)("DraggableCore: handleDragStop: %j",M),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,I&&((0,o.default)("DraggableCore: Removing handlers"),(0,s.removeEvent)(I.ownerDocument,f.move,this.handleDrag),(0,s.removeEvent)(I.ownerDocument,f.stop,this.handleDragStop))}),c(this,"onMouseDown",x=>(f=m.mouse,this.handleDragStart(x))),c(this,"onMouseUp",x=>(f=m.mouse,this.handleDragStop(x))),c(this,"onTouchStart",x=>(f=m.touch,this.handleDragStart(x))),c(this,"onTouchEnd",x=>(f=m.touch,this.handleDragStop(x)))}componentDidMount(){this.mounted=!0;const x=this.findDOMNode();x&&(0,s.addEvent)(x,m.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const x=this.findDOMNode();if(x){const{ownerDocument:w}=x;(0,s.removeEvent)(w,m.mouse.move,this.handleDrag),(0,s.removeEvent)(w,m.touch.move,this.handleDrag),(0,s.removeEvent)(w,m.mouse.stop,this.handleDragStop),(0,s.removeEvent)(w,m.touch.stop,this.handleDragStop),(0,s.removeEvent)(x,m.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,s.removeUserSelectStyles)(w)}}findDOMNode(){var x,w;return(x=this.props)!==null&&x!==void 0&&x.nodeRef?(w=this.props)===null||w===void 0||(w=w.nodeRef)===null||w===void 0?void 0:w.current:i.default.findDOMNode(this)}render(){return t.cloneElement(t.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};return Y2.default=_,c(_,"displayName","DraggableCore"),c(_,"propTypes",{allowAnyClick:e.default.bool,children:e.default.node.isRequired,disabled:e.default.bool,enableUserSelectHack:e.default.bool,offsetParent:function(v,x){if(v[x]&&v[x].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:e.default.arrayOf(e.default.number),handle:e.default.string,cancel:e.default.string,nodeRef:e.default.object,onStart:e.default.func,onDrag:e.default.func,onStop:e.default.func,onMouseDown:e.default.func,scale:e.default.number,className:r.dontSetMe,style:r.dontSetMe,transform:r.dontSetMe}),c(_,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1}),Y2}var jie;function _je(){return jie||(jie=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DraggableCore",{enumerable:!0,get:function(){return l.default}}),t.default=void 0;var e=d(NM()),i=c(Tye()),s=c(dF()),n=c(pje),r=oY(),o=Mye(),a=z4(),l=c(gje()),u=c(Aye());function c(w){return w&&w.__esModule?w:{default:w}}function h(w){if(typeof WeakMap!="function")return null;var T=new WeakMap,C=new WeakMap;return(h=function(M){return M?C:T})(w)}function d(w,T){if(w&&w.__esModule)return w;if(w===null||typeof w!="object"&&typeof w!="function")return{default:w};var C=h(T);if(C&&C.has(w))return C.get(w);var M={},A=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var I in w)if(I!=="default"&&Object.prototype.hasOwnProperty.call(w,I)){var L=A?Object.getOwnPropertyDescriptor(w,I):null;L&&(L.get||L.set)?Object.defineProperty(M,I,L):M[I]=w[I]}return M.default=w,C&&C.set(w,M),M}function m(){return m=Object.assign?Object.assign.bind():function(w){for(var T=1;T<arguments.length;T++){var C=arguments[T];for(var M in C)Object.prototype.hasOwnProperty.call(C,M)&&(w[M]=C[M])}return w},m.apply(this,arguments)}function f(w,T,C){return T=_(T),T in w?Object.defineProperty(w,T,{value:C,enumerable:!0,configurable:!0,writable:!0}):w[T]=C,w}function _(w){var T=v(w,"string");return typeof T=="symbol"?T:String(T)}function v(w,T){if(typeof w!="object"||w===null)return w;var C=w[Symbol.toPrimitive];if(C!==void 0){var M=C.call(w,T);if(typeof M!="object")return M;throw new TypeError("@@toPrimitive must return a primitive value.")}return(T==="string"?String:Number)(w)}class x extends e.Component{static getDerivedStateFromProps(T,C){let{position:M}=T,{prevPropsPosition:A}=C;return M&&(!A||M.x!==A.x||M.y!==A.y)?((0,u.default)("Draggable: getDerivedStateFromProps %j",{position:M,prevPropsPosition:A}),{x:M.x,y:M.y,prevPropsPosition:{...M}}):null}constructor(T){super(T),f(this,"onDragStart",(C,M)=>{if((0,u.default)("Draggable: onDragStart: %j",M),this.props.onStart(C,(0,o.createDraggableData)(this,M))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),f(this,"onDrag",(C,M)=>{if(!this.state.dragging)return!1;(0,u.default)("Draggable: onDrag: %j",M);const A=(0,o.createDraggableData)(this,M),I={x:A.x,y:A.y,slackX:0,slackY:0};if(this.props.bounds){const{x:D,y:O}=I;I.x+=this.state.slackX,I.y+=this.state.slackY;const[U,$]=(0,o.getBoundPosition)(this,I.x,I.y);I.x=U,I.y=$,I.slackX=this.state.slackX+(D-I.x),I.slackY=this.state.slackY+(O-I.y),A.x=I.x,A.y=I.y,A.deltaX=I.x-this.state.x,A.deltaY=I.y-this.state.y}if(this.props.onDrag(C,A)===!1)return!1;this.setState(I)}),f(this,"onDragStop",(C,M)=>{if(!this.state.dragging||this.props.onStop(C,(0,o.createDraggableData)(this,M))===!1)return!1;(0,u.default)("Draggable: onDragStop: %j",M);const I={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){const{x:D,y:O}=this.props.position;I.x=D,I.y=O}this.setState(I)}),this.state={dragging:!1,dragged:!1,x:T.position?T.position.x:T.defaultPosition.x,y:T.position?T.position.y:T.defaultPosition.y,prevPropsPosition:{...T.position},slackX:0,slackY:0,isElementSVG:!1},T.position&&!(T.onDrag||T.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.setState({dragging:!1})}findDOMNode(){var T,C;return(T=(C=this.props)===null||C===void 0||(C=C.nodeRef)===null||C===void 0?void 0:C.current)!==null&&T!==void 0?T:s.default.findDOMNode(this)}render(){const{axis:T,bounds:C,children:M,defaultPosition:A,defaultClassName:I,defaultClassNameDragging:L,defaultClassNameDragged:D,position:O,positionOffset:U,scale:$,...B}=this.props;let V={},H=null;const W=!!!O||this.state.dragging,ee=O||A,ne={x:(0,o.canDragX)(this)&&W?this.state.x:ee.x,y:(0,o.canDragY)(this)&&W?this.state.y:ee.y};this.state.isElementSVG?H=(0,r.createSVGTransform)(ne,U):V=(0,r.createCSSTransform)(ne,U);const j=(0,n.default)(M.props.className||"",I,{[L]:this.state.dragging,[D]:this.state.dragged});return e.createElement(l.default,m({},B,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),e.cloneElement(e.Children.only(M),{className:j,style:{...M.props.style,...V},transform:H}))}}t.default=x,f(x,"displayName","Draggable"),f(x,"propTypes",{...l.default.propTypes,axis:i.default.oneOf(["both","x","y","none"]),bounds:i.default.oneOfType([i.default.shape({left:i.default.number,right:i.default.number,top:i.default.number,bottom:i.default.number}),i.default.string,i.default.oneOf([!1])]),defaultClassName:i.default.string,defaultClassNameDragging:i.default.string,defaultClassNameDragged:i.default.string,defaultPosition:i.default.shape({x:i.default.number,y:i.default.number}),positionOffset:i.default.shape({x:i.default.oneOfType([i.default.number,i.default.string]),y:i.default.oneOfType([i.default.number,i.default.string])}),position:i.default.shape({x:i.default.number,y:i.default.number}),className:a.dontSetMe,style:a.dontSetMe,transform:a.dontSetMe}),f(x,"defaultProps",{...l.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})}(z5)),z5}var Yie;function yje(){if(Yie)return j2.exports;Yie=1;const{default:t,DraggableCore:e}=_je();return j2.exports=t,j2.exports.default=t,j2.exports.DraggableCore=e,j2.exports}var vje=yje();const xje=YSe(vje);var Iye=dF(),mo=function(){return mo=Object.assign||function(t){for(var e,i=1,s=arguments.length;i<s;i++){e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},mo.apply(this,arguments)},Xie={width:"100%",height:"10px",top:"0px",left:"0px",cursor:"row-resize"},Wie={width:"10px",height:"100%",top:"0px",left:"0px",cursor:"col-resize"},IN={width:"20px",height:"20px",position:"absolute",zIndex:1},bje={top:mo(mo({},Xie),{top:"-5px"}),right:mo(mo({},Wie),{left:void 0,right:"-5px"}),bottom:mo(mo({},Xie),{top:void 0,bottom:"-5px"}),left:mo(mo({},Wie),{left:"-5px"}),topRight:mo(mo({},IN),{right:"-10px",top:"-10px",cursor:"ne-resize"}),bottomRight:mo(mo({},IN),{right:"-10px",bottom:"-10px",cursor:"se-resize"}),bottomLeft:mo(mo({},IN),{left:"-10px",bottom:"-10px",cursor:"sw-resize"}),topLeft:mo(mo({},IN),{left:"-10px",top:"-10px",cursor:"nw-resize"})},wje=Ve.memo(function(t){var e=t.onResizeStart,i=t.direction,s=t.children,n=t.replaceStyles,r=t.className,o=Ve.useCallback(function(u){e(u,i)},[e,i]),a=Ve.useCallback(function(u){e(u,i)},[e,i]),l=Ve.useMemo(function(){return mo(mo({position:"absolute",userSelect:"none"},bje[i]),n??{})},[n,i]);return ri.jsx("div",{className:r||void 0,style:l,onMouseDown:o,onTouchStart:a,children:s})}),Sje=function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,n){s.__proto__=n}||function(s,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(s[r]=n[r])},t(e,i)};return function(e,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(e,i);function s(){this.constructor=e}e.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),dm=function(){return dm=Object.assign||function(t){for(var e,i=1,s=arguments.length;i<s;i++){e=arguments[i];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},dm.apply(this,arguments)},Eje={width:"auto",height:"auto"},DN=function(t,e,i){return Math.max(Math.min(t,i),e)},Zie=function(t,e,i){var s=Math.round(t/e);return s*e+i*(s-1)},sb=function(t,e){return new RegExp(t,"i").test(e)},NN=function(t){return!!(t.touches&&t.touches.length)},Cje=function(t){return!!((t.clientX||t.clientX===0)&&(t.clientY||t.clientY===0))},Kie=function(t,e,i){i===void 0&&(i=0);var s=e.reduce(function(r,o,a){return Math.abs(o-t)<Math.abs(e[r]-t)?a:r},0),n=Math.abs(e[s]-t);return i===0||n<i?e[s]:t},H5=function(t){return t=t.toString(),t==="auto"||t.endsWith("px")||t.endsWith("%")||t.endsWith("vh")||t.endsWith("vw")||t.endsWith("vmax")||t.endsWith("vmin")?t:"".concat(t,"px")},RN=function(t,e,i,s){if(t&&typeof t=="string"){if(t.endsWith("px"))return Number(t.replace("px",""));if(t.endsWith("%")){var n=Number(t.replace("%",""))/100;return e*n}if(t.endsWith("vw")){var n=Number(t.replace("vw",""))/100;return i*n}if(t.endsWith("vh")){var n=Number(t.replace("vh",""))/100;return s*n}}return t},Tje=function(t,e,i,s,n,r,o){return s=RN(s,t.width,e,i),n=RN(n,t.height,e,i),r=RN(r,t.width,e,i),o=RN(o,t.height,e,i),{maxWidth:typeof s>"u"?void 0:Number(s),maxHeight:typeof n>"u"?void 0:Number(n),minWidth:typeof r>"u"?void 0:Number(r),minHeight:typeof o>"u"?void 0:Number(o)}},Pje=function(t){return Array.isArray(t)?t:[t,t]},Mje=["as","ref","style","className","grid","gridGap","snap","bounds","boundsByDirection","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],Qie="__resizable_base__",Aje=function(t){Sje(e,t);function e(i){var s,n,r,o,a=t.call(this,i)||this;return a.ratio=1,a.resizable=null,a.parentLeft=0,a.parentTop=0,a.resizableLeft=0,a.resizableRight=0,a.resizableTop=0,a.resizableBottom=0,a.targetLeft=0,a.targetTop=0,a.delta={width:0,height:0},a.appendBase=function(){if(!a.resizable||!a.window)return null;var l=a.parentNode;if(!l)return null;var u=a.window.document.createElement("div");return u.style.width="100%",u.style.height="100%",u.style.position="absolute",u.style.transform="scale(0, 0)",u.style.left="0",u.style.flex="0 0 100%",u.classList?u.classList.add(Qie):u.className+=Qie,l.appendChild(u),u},a.removeBase=function(l){var u=a.parentNode;u&&u.removeChild(l)},a.state={isResizing:!1,width:(n=(s=a.propsSize)===null||s===void 0?void 0:s.width)!==null&&n!==void 0?n:"auto",height:(o=(r=a.propsSize)===null||r===void 0?void 0:r.height)!==null&&o!==void 0?o:"auto",direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},a.onResizeStart=a.onResizeStart.bind(a),a.onMouseMove=a.onMouseMove.bind(a),a.onMouseUp=a.onMouseUp.bind(a),a}return Object.defineProperty(e.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"window",{get:function(){return!this.resizable||!this.resizable.ownerDocument?null:this.resizable.ownerDocument.defaultView},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||Eje},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){var i=0,s=0;if(this.resizable&&this.window){var n=this.resizable.offsetWidth,r=this.resizable.offsetHeight,o=this.resizable.style.position;o!=="relative"&&(this.resizable.style.position="relative"),i=this.resizable.style.width!=="auto"?this.resizable.offsetWidth:n,s=this.resizable.style.height!=="auto"?this.resizable.offsetHeight:r,this.resizable.style.position=o}return{width:i,height:s}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sizeStyle",{get:function(){var i=this,s=this.props.size,n=function(a){var l;if(typeof i.state[a]>"u"||i.state[a]==="auto")return"auto";if(i.propsSize&&i.propsSize[a]&&(!((l=i.propsSize[a])===null||l===void 0)&&l.toString().endsWith("%"))){if(i.state[a].toString().endsWith("%"))return i.state[a].toString();var u=i.getParentSize(),c=Number(i.state[a].toString().replace("px","")),h=c/u[a]*100;return"".concat(h,"%")}return H5(i.state[a])},r=s&&typeof s.width<"u"&&!this.state.isResizing?H5(s.width):n("width"),o=s&&typeof s.height<"u"&&!this.state.isResizing?H5(s.height):n("height");return{width:r,height:o}},enumerable:!1,configurable:!0}),e.prototype.getParentSize=function(){if(!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var i=this.appendBase();if(!i)return{width:0,height:0};var s=!1,n=this.parentNode.style.flexWrap;n!=="wrap"&&(s=!0,this.parentNode.style.flexWrap="wrap"),i.style.position="relative",i.style.minWidth="100%",i.style.minHeight="100%";var r={width:i.offsetWidth,height:i.offsetHeight};return s&&(this.parentNode.style.flexWrap=n),this.removeBase(i),r},e.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},e.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},e.prototype.componentDidMount=function(){if(!(!this.resizable||!this.window)){var i=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:i.flexBasis!=="auto"?i.flexBasis:void 0})}},e.prototype.componentWillUnmount=function(){this.window&&this.unbindEvents()},e.prototype.createSizeForCssProperty=function(i,s){var n=this.propsSize&&this.propsSize[s];return this.state[s]==="auto"&&this.state.original[s]===i&&(typeof n>"u"||n==="auto")?"auto":i},e.prototype.calculateNewMaxFromBoundary=function(i,s){var n=this.props.boundsByDirection,r=this.state.direction,o=n&&sb("left",r),a=n&&sb("top",r),l,u;if(this.props.bounds==="parent"){var c=this.parentNode;c&&(l=o?this.resizableRight-this.parentLeft:c.offsetWidth+(this.parentLeft-this.resizableLeft),u=a?this.resizableBottom-this.parentTop:c.offsetHeight+(this.parentTop-this.resizableTop))}else this.props.bounds==="window"?this.window&&(l=o?this.resizableRight:this.window.innerWidth-this.resizableLeft,u=a?this.resizableBottom:this.window.innerHeight-this.resizableTop):this.props.bounds&&(l=o?this.resizableRight-this.targetLeft:this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),u=a?this.resizableBottom-this.targetTop:this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop));return l&&Number.isFinite(l)&&(i=i&&i<l?i:l),u&&Number.isFinite(u)&&(s=s&&s<u?s:u),{maxWidth:i,maxHeight:s}},e.prototype.calculateNewSizeFromDirection=function(i,s){var n=this.props.scale||1,r=Pje(this.props.resizeRatio||1),o=r[0],a=r[1],l=this.state,u=l.direction,c=l.original,h=this.props,d=h.lockAspectRatio,m=h.lockAspectRatioExtraHeight,f=h.lockAspectRatioExtraWidth,_=c.width,v=c.height,x=m||0,w=f||0;return sb("right",u)&&(_=c.width+(i-c.x)*o/n,d&&(v=(_-w)/this.ratio+x)),sb("left",u)&&(_=c.width-(i-c.x)*o/n,d&&(v=(_-w)/this.ratio+x)),sb("bottom",u)&&(v=c.height+(s-c.y)*a/n,d&&(_=(v-x)*this.ratio+w)),sb("top",u)&&(v=c.height-(s-c.y)*a/n,d&&(_=(v-x)*this.ratio+w)),{newWidth:_,newHeight:v}},e.prototype.calculateNewSizeFromAspectRatio=function(i,s,n,r){var o=this.props,a=o.lockAspectRatio,l=o.lockAspectRatioExtraHeight,u=o.lockAspectRatioExtraWidth,c=typeof r.width>"u"?10:r.width,h=typeof n.width>"u"||n.width<0?i:n.width,d=typeof r.height>"u"?10:r.height,m=typeof n.height>"u"||n.height<0?s:n.height,f=l||0,_=u||0;if(a){var v=(d-f)*this.ratio+_,x=(m-f)*this.ratio+_,w=(c-_)/this.ratio+f,T=(h-_)/this.ratio+f,C=Math.max(c,v),M=Math.min(h,x),A=Math.max(d,w),I=Math.min(m,T);i=DN(i,C,M),s=DN(s,A,I)}else i=DN(i,c,h),s=DN(s,d,m);return{newWidth:i,newHeight:s}},e.prototype.setBoundingClientRect=function(){var i=1/(this.props.scale||1);if(this.props.bounds==="parent"){var s=this.parentNode;if(s){var n=s.getBoundingClientRect();this.parentLeft=n.left*i,this.parentTop=n.top*i}}if(this.props.bounds&&typeof this.props.bounds!="string"){var r=this.props.bounds.getBoundingClientRect();this.targetLeft=r.left*i,this.targetTop=r.top*i}if(this.resizable){var o=this.resizable.getBoundingClientRect(),a=o.left,l=o.top,u=o.right,c=o.bottom;this.resizableLeft=a*i,this.resizableRight=u*i,this.resizableTop=l*i,this.resizableBottom=c*i}},e.prototype.onResizeStart=function(i,s){if(!(!this.resizable||!this.window)){var n=0,r=0;if(i.nativeEvent&&Cje(i.nativeEvent)?(n=i.nativeEvent.clientX,r=i.nativeEvent.clientY):i.nativeEvent&&NN(i.nativeEvent)&&(n=i.nativeEvent.touches[0].clientX,r=i.nativeEvent.touches[0].clientY),this.props.onResizeStart&&this.resizable){var o=this.props.onResizeStart(i,s,this.resizable);if(o===!1)return}this.props.size&&(typeof this.props.size.height<"u"&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),typeof this.props.size.width<"u"&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio=typeof this.props.lockAspectRatio=="number"?this.props.lockAspectRatio:this.size.width/this.size.height;var a,l=this.window.getComputedStyle(this.resizable);if(l.flexBasis!=="auto"){var u=this.parentNode;if(u){var c=this.window.getComputedStyle(u).flexDirection;this.flexDir=c.startsWith("row")?"row":"column",a=l.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var h={original:{x:n,y:r,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:dm(dm({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(i.target).cursor||"auto"}),direction:s,flexBasis:a};this.setState(h)}},e.prototype.onMouseMove=function(i){var s=this;if(!(!this.state.isResizing||!this.resizable||!this.window)){if(this.window.TouchEvent&&NN(i))try{i.preventDefault(),i.stopPropagation()}catch{}var n=this.props,r=n.maxWidth,o=n.maxHeight,a=n.minWidth,l=n.minHeight,u=NN(i)?i.touches[0].clientX:i.clientX,c=NN(i)?i.touches[0].clientY:i.clientY,h=this.state,d=h.direction,m=h.original,f=h.width,_=h.height,v=this.getParentSize(),x=Tje(v,this.window.innerWidth,this.window.innerHeight,r,o,a,l);r=x.maxWidth,o=x.maxHeight,a=x.minWidth,l=x.minHeight;var w=this.calculateNewSizeFromDirection(u,c),T=w.newHeight,C=w.newWidth,M=this.calculateNewMaxFromBoundary(r,o);this.props.snap&&this.props.snap.x&&(C=Kie(C,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(T=Kie(T,this.props.snap.y,this.props.snapGap));var A=this.calculateNewSizeFromAspectRatio(C,T,{width:M.maxWidth,height:M.maxHeight},{width:a,height:l});if(C=A.newWidth,T=A.newHeight,this.props.grid){var I=Zie(C,this.props.grid[0],this.props.gridGap?this.props.gridGap[0]:0),L=Zie(T,this.props.grid[1],this.props.gridGap?this.props.gridGap[1]:0),D=this.props.snapGap||0,O=D===0||Math.abs(I-C)<=D?I:C,U=D===0||Math.abs(L-T)<=D?L:T;C=O,T=U}var $={width:C-m.width,height:T-m.height};if(this.delta=$,f&&typeof f=="string"){if(f.endsWith("%")){var B=C/v.width*100;C="".concat(B,"%")}else if(f.endsWith("vw")){var V=C/this.window.innerWidth*100;C="".concat(V,"vw")}else if(f.endsWith("vh")){var H=C/this.window.innerHeight*100;C="".concat(H,"vh")}}if(_&&typeof _=="string"){if(_.endsWith("%")){var B=T/v.height*100;T="".concat(B,"%")}else if(_.endsWith("vw")){var V=T/this.window.innerWidth*100;T="".concat(V,"vw")}else if(_.endsWith("vh")){var H=T/this.window.innerHeight*100;T="".concat(H,"vh")}}var Y={width:this.createSizeForCssProperty(C,"width"),height:this.createSizeForCssProperty(T,"height")};this.flexDir==="row"?Y.flexBasis=Y.width:this.flexDir==="column"&&(Y.flexBasis=Y.height);var W=this.state.width!==Y.width,ee=this.state.height!==Y.height,ne=this.state.flexBasis!==Y.flexBasis,j=W||ee||ne;j&&Iye.flushSync(function(){s.setState(Y)}),this.props.onResize&&j&&this.props.onResize(i,d,this.resizable,$)}},e.prototype.onMouseUp=function(i){var s,n,r=this.state,o=r.isResizing,a=r.direction;r.original,!(!o||!this.resizable)&&(this.props.onResizeStop&&this.props.onResizeStop(i,a,this.resizable,this.delta),this.props.size&&this.setState({width:(s=this.props.size.width)!==null&&s!==void 0?s:"auto",height:(n=this.props.size.height)!==null&&n!==void 0?n:"auto"}),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:dm(dm({},this.state.backgroundStyle),{cursor:"auto"})}))},e.prototype.updateSize=function(i){var s,n;this.setState({width:(s=i.width)!==null&&s!==void 0?s:"auto",height:(n=i.height)!==null&&n!==void 0?n:"auto"})},e.prototype.renderResizer=function(){var i=this,s=this.props,n=s.enable,r=s.handleStyles,o=s.handleClasses,a=s.handleWrapperStyle,l=s.handleWrapperClass,u=s.handleComponent;if(!n)return null;var c=Object.keys(n).map(function(h){return n[h]!==!1?ri.jsx(wje,{direction:h,onResizeStart:i.onResizeStart,replaceStyles:r&&r[h],className:o&&o[h],children:u&&u[h]?u[h]:null},h):null});return ri.jsx("div",{className:l,style:a,children:c})},e.prototype.render=function(){var i=this,s=Object.keys(this.props).reduce(function(o,a){return Mje.indexOf(a)!==-1||(o[a]=i.props[a]),o},{}),n=dm(dm(dm({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(n.flexBasis=this.state.flexBasis);var r=this.props.as||"div";return ri.jsxs(r,dm({style:n,className:this.props.className},s,{ref:function(o){o&&(i.resizable=o)},children:[this.state.isResizing&&ri.jsx("div",{style:this.state.backgroundStyle}),this.props.children,this.renderResizer()]}))},e.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],gridGap:[0,0],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},e}(Ve.PureComponent);/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var M8=function(t,e){return M8=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,s){i.__proto__=s}||function(i,s){for(var n in s)s.hasOwnProperty(n)&&(i[n]=s[n])},M8(t,e)};function Ije(t,e){M8(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}var Ao=function(){return Ao=Object.assign||function(e){for(var i,s=1,n=arguments.length;s<n;s++){i=arguments[s];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},Ao.apply(this,arguments)};function Dje(t,e){var i={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(i[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(i[s[n]]=t[s[n]]);return i}var Nje={width:"auto",height:"auto",display:"inline-block",position:"absolute",top:0,left:0},Rje=function(t){return{bottom:t,bottomLeft:t,bottomRight:t,left:t,right:t,top:t,topLeft:t,topRight:t}},Oje=function(t){Ije(e,t);function e(i){var s=t.call(this,i)||this;return s.resizingPosition={x:0,y:0},s.offsetFromParent={left:0,top:0},s.resizableElement={current:null},s.originalPosition={x:0,y:0},s.state={resizing:!1,bounds:{top:0,right:0,bottom:0,left:0},maxWidth:i.maxWidth,maxHeight:i.maxHeight},s.onResizeStart=s.onResizeStart.bind(s),s.onResize=s.onResize.bind(s),s.onResizeStop=s.onResizeStop.bind(s),s.onDragStart=s.onDragStart.bind(s),s.onDrag=s.onDrag.bind(s),s.onDragStop=s.onDragStop.bind(s),s.getMaxSizesFromProps=s.getMaxSizesFromProps.bind(s),s}return e.prototype.componentDidMount=function(){this.updateOffsetFromParent();var i=this.offsetFromParent,s=i.left,n=i.top,r=this.getDraggablePosition(),o=r.x,a=r.y;this.draggable.setState({x:o-s,y:a-n}),this.forceUpdate()},e.prototype.getDraggablePosition=function(){var i=this.draggable.state,s=i.x,n=i.y;return{x:s,y:n}},e.prototype.getParent=function(){return this.resizable&&this.resizable.parentNode},e.prototype.getParentSize=function(){return this.resizable.getParentSize()},e.prototype.getMaxSizesFromProps=function(){var i=typeof this.props.maxWidth>"u"?Number.MAX_SAFE_INTEGER:this.props.maxWidth,s=typeof this.props.maxHeight>"u"?Number.MAX_SAFE_INTEGER:this.props.maxHeight;return{maxWidth:i,maxHeight:s}},e.prototype.getSelfElement=function(){return this.resizable&&this.resizable.resizable},e.prototype.getOffsetHeight=function(i){var s=this.props.scale;switch(this.props.bounds){case"window":return window.innerHeight/s;case"body":return document.body.offsetHeight/s;default:return i.offsetHeight}},e.prototype.getOffsetWidth=function(i){var s=this.props.scale;switch(this.props.bounds){case"window":return window.innerWidth/s;case"body":return document.body.offsetWidth/s;default:return i.offsetWidth}},e.prototype.onDragStart=function(i,s){this.props.onDragStart&&this.props.onDragStart(i,s);var n=this.getDraggablePosition();if(this.originalPosition=n,!!this.props.bounds){var r=this.getParent(),o=this.props.scale,a;if(this.props.bounds==="parent")a=r;else if(this.props.bounds==="body"){var l=r.getBoundingClientRect(),u=l.left,c=l.top,h=document.body.getBoundingClientRect(),d=-(u-r.offsetLeft*o-h.left)/o,m=-(c-r.offsetTop*o-h.top)/o,f=(document.body.offsetWidth-this.resizable.size.width*o)/o+d,_=(document.body.offsetHeight-this.resizable.size.height*o)/o+m;return this.setState({bounds:{top:m,right:f,bottom:_,left:d}})}else if(this.props.bounds==="window"){if(!this.resizable)return;var v=r.getBoundingClientRect(),x=v.left,w=v.top,T=-(x-r.offsetLeft*o)/o,C=-(w-r.offsetTop*o)/o,f=(window.innerWidth-this.resizable.size.width*o)/o+T,_=(window.innerHeight-this.resizable.size.height*o)/o+C;return this.setState({bounds:{top:C,right:f,bottom:_,left:T}})}else typeof this.props.bounds=="string"?a=document.querySelector(this.props.bounds):this.props.bounds instanceof HTMLElement&&(a=this.props.bounds);if(!(!(a instanceof HTMLElement)||!(r instanceof HTMLElement))){var M=a.getBoundingClientRect(),A=M.left,I=M.top,L=r.getBoundingClientRect(),D=L.left,O=L.top,U=(A-D)/o,$=I-O;if(this.resizable){this.updateOffsetFromParent();var B=this.offsetFromParent;this.setState({bounds:{top:$-B.top,right:U+(a.offsetWidth-this.resizable.size.width)-B.left/o,bottom:$+(a.offsetHeight-this.resizable.size.height)-B.top,left:U-B.left/o}})}}}},e.prototype.onDrag=function(i,s){if(this.props.onDrag){var n=this.offsetFromParent,r=n.left,o=n.top;if(!this.props.dragAxis||this.props.dragAxis==="both")return this.props.onDrag(i,Ao(Ao({},s),{x:s.x+r,y:s.y+o}));if(this.props.dragAxis==="x")return this.props.onDrag(i,Ao(Ao({},s),{x:s.x+r,y:this.originalPosition.y+o,deltaY:0}));if(this.props.dragAxis==="y")return this.props.onDrag(i,Ao(Ao({},s),{x:this.originalPosition.x+r,y:s.y+o,deltaX:0}))}},e.prototype.onDragStop=function(i,s){if(this.props.onDragStop){var n=this.offsetFromParent,r=n.left,o=n.top;if(!this.props.dragAxis||this.props.dragAxis==="both")return this.props.onDragStop(i,Ao(Ao({},s),{x:s.x+r,y:s.y+o}));if(this.props.dragAxis==="x")return this.props.onDragStop(i,Ao(Ao({},s),{x:s.x+r,y:this.originalPosition.y+o,deltaY:0}));if(this.props.dragAxis==="y")return this.props.onDragStop(i,Ao(Ao({},s),{x:this.originalPosition.x+r,y:s.y+o,deltaX:0}))}},e.prototype.onResizeStart=function(i,s,n){i.stopPropagation(),this.setState({resizing:!0});var r=this.props.scale,o=this.offsetFromParent,a=this.getDraggablePosition();if(this.resizingPosition={x:a.x+o.left,y:a.y+o.top},this.originalPosition=a,this.props.bounds){var l=this.getParent(),u=void 0;this.props.bounds==="parent"?u=l:this.props.bounds==="body"?u=document.body:this.props.bounds==="window"?u=window:typeof this.props.bounds=="string"?u=document.querySelector(this.props.bounds):this.props.bounds instanceof HTMLElement&&(u=this.props.bounds);var c=this.getSelfElement();if(c instanceof Element&&(u instanceof HTMLElement||u===window)&&l instanceof HTMLElement){var h=this.getMaxSizesFromProps(),d=h.maxWidth,m=h.maxHeight,f=this.getParentSize();if(d&&typeof d=="string")if(d.endsWith("%")){var _=Number(d.replace("%",""))/100;d=f.width*_}else d.endsWith("px")&&(d=Number(d.replace("px","")));if(m&&typeof m=="string")if(m.endsWith("%")){var _=Number(m.replace("%",""))/100;m=f.height*_}else m.endsWith("px")&&(m=Number(m.replace("px","")));var v=c.getBoundingClientRect(),x=v.left,w=v.top,T=this.props.bounds==="window"?{left:0,top:0}:u.getBoundingClientRect(),C=T.left,M=T.top,A=this.getOffsetWidth(u),I=this.getOffsetHeight(u),L=s.toLowerCase().endsWith("left"),D=s.toLowerCase().endsWith("right"),O=s.startsWith("top"),U=s.startsWith("bottom");if((L||O)&&this.resizable){var $=(x-C)/r+this.resizable.size.width;this.setState({maxWidth:$>Number(d)?d:$})}if(D||this.props.lockAspectRatio&&!L&&!O){var $=A+(C-x)/r;this.setState({maxWidth:$>Number(d)?d:$})}if((O||L)&&this.resizable){var $=(w-M)/r+this.resizable.size.height;this.setState({maxHeight:$>Number(m)?m:$})}if(U||this.props.lockAspectRatio&&!O&&!L){var $=I+(M-w)/r;this.setState({maxHeight:$>Number(m)?m:$})}}}else this.setState({maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight});this.props.onResizeStart&&this.props.onResizeStart(i,s,n)},e.prototype.onResize=function(i,s,n,r){var o=this,a={x:this.originalPosition.x,y:this.originalPosition.y},l=-r.width,u=-r.height,c=["top","left","topLeft","bottomLeft","topRight"];c.includes(s)&&(s==="bottomLeft"?a.x+=l:(s==="topRight"||(a.x+=l),a.y+=u));var h=this.draggable.state;(a.x!==h.x||a.y!==h.y)&&Iye.flushSync(function(){o.draggable.setState(a)}),this.updateOffsetFromParent();var d=this.offsetFromParent,m=this.getDraggablePosition().x+d.left,f=this.getDraggablePosition().y+d.top;this.resizingPosition={x:m,y:f},this.props.onResize&&this.props.onResize(i,s,n,r,{x:m,y:f})},e.prototype.onResizeStop=function(i,s,n,r){this.setState({resizing:!1});var o=this.getMaxSizesFromProps(),a=o.maxWidth,l=o.maxHeight;this.setState({maxWidth:a,maxHeight:l}),this.props.onResizeStop&&this.props.onResizeStop(i,s,n,r,this.resizingPosition)},e.prototype.updateSize=function(i){this.resizable&&this.resizable.updateSize({width:i.width,height:i.height})},e.prototype.updatePosition=function(i){this.draggable.setState(i)},e.prototype.updateOffsetFromParent=function(){var i=this.props.scale,s=this.getParent(),n=this.getSelfElement();if(!s||n===null)return{top:0,left:0};var r=s.getBoundingClientRect(),o=r.left,a=r.top,l=n.getBoundingClientRect(),u=this.getDraggablePosition(),c=s.scrollLeft,h=s.scrollTop;this.offsetFromParent={left:l.left-o+c-u.x*i,top:l.top-a+h-u.y*i}},e.prototype.render=function(){var i=this,s=this.props,n=s.disableDragging,r=s.style,o=s.dragHandleClassName,a=s.position,l=s.onMouseDown,u=s.onMouseUp,c=s.dragAxis,h=s.dragGrid,d=s.bounds,m=s.enableUserSelectHack,f=s.cancel,_=s.children;s.onResizeStart,s.onResize,s.onResizeStop,s.onDragStart,s.onDrag,s.onDragStop;var v=s.resizeHandleStyles,x=s.resizeHandleClasses,w=s.resizeHandleComponent,T=s.enableResizing,C=s.resizeGrid,M=s.resizeHandleWrapperClass,A=s.resizeHandleWrapperStyle,I=s.scale,L=s.allowAnyClick,D=s.dragPositionOffset,O=Dje(s,["disableDragging","style","dragHandleClassName","position","onMouseDown","onMouseUp","dragAxis","dragGrid","bounds","enableUserSelectHack","cancel","children","onResizeStart","onResize","onResizeStop","onDragStart","onDrag","onDragStop","resizeHandleStyles","resizeHandleClasses","resizeHandleComponent","enableResizing","resizeGrid","resizeHandleWrapperClass","resizeHandleWrapperStyle","scale","allowAnyClick","dragPositionOffset"]),U=this.props.default?Ao({},this.props.default):void 0;delete O.default;var $=n||o?{cursor:"auto"}:{cursor:"move"},B=Ao(Ao(Ao({},Nje),$),r),V=this.offsetFromParent,H=V.left,Y=V.top,W;a&&(W={x:a.x-H,y:a.y-Y});var ee=this.state.resizing?void 0:W,ne=this.state.resizing?"both":c;return Ve.createElement(xje,{ref:function(j){j&&(i.draggable=j)},handle:o?".".concat(o):void 0,defaultPosition:U,onMouseDown:l,onMouseUp:u,onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop,axis:ne,disabled:n,grid:h,bounds:d?this.state.bounds:void 0,position:ee,enableUserSelectHack:m,cancel:f,scale:I,allowAnyClick:L,nodeRef:this.resizableElement,positionOffset:D},Ve.createElement(Aje,Ao({},O,{ref:function(j){j&&(i.resizable=j,i.resizableElement.current=j.resizable)},defaultSize:U,size:this.props.size,enable:typeof T=="boolean"?Rje(T):T,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeStop:this.onResizeStop,style:B,minWidth:this.props.minWidth,minHeight:this.props.minHeight,maxWidth:this.state.resizing?this.state.maxWidth:this.props.maxWidth,maxHeight:this.state.resizing?this.state.maxHeight:this.props.maxHeight,grid:C,handleWrapperClass:M,handleWrapperStyle:A,lockAspectRatio:this.props.lockAspectRatio,lockAspectRatioExtraWidth:this.props.lockAspectRatioExtraWidth,lockAspectRatioExtraHeight:this.props.lockAspectRatioExtraHeight,handleStyles:v,handleClasses:x,handleComponent:w,scale:this.props.scale}),_))},e.defaultProps={maxWidth:Number.MAX_SAFE_INTEGER,maxHeight:Number.MAX_SAFE_INTEGER,scale:1,onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},onDragStart:function(){},onDrag:function(){},onDragStop:function(){}},e}(Ve.PureComponent);const Jie=Ve.forwardRef(({children:t,panelCode:e,title:i,defaults:s,onBringToFront:n,onSetToBackPanel:r,onResize:o},a)=>{const[l,u]=Ve.useState(s.position),[c,h]=Ve.useState(s.size),[d,m]=Ve.useState(0),[f,_]=Ve.useState(!0);Ve.useImperativeHandle(a,()=>({setBackPanelCode(T){T===e&&f?x():T!==e&&!f&&v()},setZOrder(T){f&&m(T.indexOf(e))},hide(){f&&w()}}));const v=()=>{_(!0),u(s.position),h(s.size),m(0)},x=()=>{f&&(_(!1),u({x:0,y:0}),h({width:"100vw",height:"100vh"}),m(-100),r())},w=()=>{m(-1e3)};return ri.jsx(Oje,{size:c,position:l,dragHandleClassName:"custom-drag-handle",style:{border:"1px solid #555",background:"#f9f9f9",zIndex:d},onDragStop:(T,C)=>{u({x:C.x,y:C.y})},onResize:(T,C,M,A,I)=>{const L={width:M.style.width,height:M.style.height};h(L),u(I),o(L)},children:ri.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[ri.jsxs("div",{className:"custom-drag-handle bg-primary text-white p-2 d-flex align-items-center",style:{cursor:"move",height:"40px",overflow:"hidden"},children:[i,ri.jsxs("div",{className:"ms-auto d-flex align-items-center",style:{padding:"0px 0px"},children:[ri.jsx("i",{className:"bi bi-x fs-2 me-1",style:{cursor:"pointer",fontSize:"2rem",lineHeight:1},onClick:()=>w()}),ri.jsx("i",{className:"bi bi-chevron-bar-up fs-3 me-2",style:{cursor:"pointer",fontSize:"2rem",lineHeight:1},onClick:()=>n()}),ri.jsx("i",{className:"bi bi-arrows-fullscreen",style:{cursor:"pointer"},onClick:()=>x()})]})]}),ri.jsx("div",{className:"flex-grow-1",children:t})]})})});let Q0=class extends bs{constructor(e){super(e),this.row=0,this.column=0,this.rows=1,this.columns=1}equals(e){return e!=null&&this.row===e.row&&this.rows===e.rows&&this.column===e.column&&this.columns===e.columns}};y([S({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Q0.prototype,"row",void 0),y([S({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Q0.prototype,"column",void 0),y([S({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Q0.prototype,"rows",void 0),y([S({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],Q0.prototype,"columns",void 0),Q0=y([se("esri.CameraLayout")],Q0);const Dye=Q0;let aY=class{constructor(e,i){this.min=e,this.max=i,this.range=i-e}normalize(e,i=0,s=!1){return ese(this.range,this.min,this.max,e,i,s)}clamp(e,i=0){return sh(e-i,this.min,this.max)+i}monotonic(e,i,s){return e<i?i:i+A8(this.range,e-i,s)}minimalMonotonic(e,i,s){return ese(this.range,e,e+this.range,i,s)}center(e,i,s){return i=this.monotonic(e,i,s),this.normalize((e+i)/2,s)}diff(e,i,s){return this.monotonic(e,i,s)-e}shortestSignedDiff(e,i){e=this.normalize(e);const s=(i=this.normalize(i))-e,n=i<e?this.minimalMonotonic(e,i)-e:i-this.minimalMonotonic(i,e);return Math.abs(s)<Math.abs(n)?s:n}contains(e,i,s){return i=this.minimalMonotonic(e,i),(s=this.minimalMonotonic(e,s))>e&&s<i}};function ese(t,e,i,s,n=0,r=!1){return(s-=n)<e?s+=A8(t,e-s):s>i&&(s-=A8(t,s-i)),r&&s===i&&(s=e),s+n}function A8(t,e,i=0){return Math.ceil((e-i)/t)*t+i}const j0t=new aY(0,2*Math.PI),Y0t=new aY(-Math.PI,Math.PI),Lje=new aY(0,360);let sm=class extends bs.ClonableMixin(it){constructor(...e){super(...e),this.position=new ki([0,0,0]),this.heading=0,this.tilt=0,this.fov=55,this.layout=new Dye}normalizeCtorArgs(e,i,s,n){if(e&&typeof e=="object"&&("x"in e||Array.isArray(e))){const r={position:e};return i!=null&&(r.heading=i),s!=null&&(r.tilt=s),n!=null&&(r.fov=n),r}return e}writePosition(e,i,s,n){const r=e.clone();r.x=Al(e.x||0),r.y=Al(e.y||0),r.z=e.hasZ?Al(e.z||0):e.z,i[s]=r.write({},n)}readPosition(e,i){const s=new ki;return s.read(e,i),s.x=Al(s.x||0),s.y=Al(s.y||0),s.z=s.hasZ?Al(s.z||0):s.z,s}equals(e){return e!=null&&this.tilt===e.tilt&&this.heading===e.heading&&this.fov===e.fov&&this.position.equals(e.position)&&this.layout.equals(e.layout)}};y([S({type:ki,json:{write:{isRequired:!0}}})],sm.prototype,"position",void 0),y([yt("position")],sm.prototype,"writePosition",null),y([mt("position")],sm.prototype,"readPosition",null),y([S({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Ls(t=>Lje.normalize(Al(t)))],sm.prototype,"heading",void 0),y([S({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Ls(t=>sh(Al(t),-180,180))],sm.prototype,"tilt",void 0),y([S({type:Number,nonNullable:!0,json:{default:55,write:!0}}),Ls(t=>sh(Al(t,55),1,170))],sm.prototype,"fov",void 0),y([S({type:Dye,nonNullable:!0,json:{read:!1,write:!1}})],sm.prototype,"layout",void 0),sm=y([se("esri.Camera")],sm);const Fje=sm;var I8;let p_=I8=class extends it{constructor(t){super(t),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(t){return(t%=360)<0&&(t+=360),t}clone(){return new I8({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry!=null?this.targetGeometry.clone():null,camera:this.camera!=null?this.camera.clone():null})}};y([S({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:j5}}}}})],p_.prototype,"rotation",void 0),y([Ls("rotation")],p_.prototype,"castRotation",null),y([S({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:j5}}}}})],p_.prototype,"scale",void 0),y([S({types:QM,json:{read:f1,write:!0,origins:{"web-scene":{read:f1,write:{overridePolicy:j5}}}}})],p_.prototype,"targetGeometry",void 0),y([S({type:Fje,json:{write:!0,origins:{"web-scene":{write:{isRequired:!0}}}}})],p_.prototype,"camera",void 0),p_=I8=y([se("esri.Viewpoint")],p_);const th=p_;function j5(){return{enabled:!this.camera}}let Tb=class extends Nt{constructor(e){super(e),this.getCollections=null}initialize(){this.addHandles(kue(()=>this._refresh(),km))}destroy(){this.getCollections=null}_refresh(){const e=this.getCollections!=null?this.getCollections():null;if(e==null)return void this.removeAll();let i=0;for(const s of e)s!=null&&(i=this._processCollection(i,s));this.splice(i,this.length)}_createNewInstance(e){return new Nt(e)}_processCollection(e,i){if(!i)return e;const s=this.itemFilterFunction??(n=>!!n);for(const n of i)if(n){if(s(n)){const r=this.indexOf(n,e);r>=0?r!==e&&this.reorder(n,e):this.add(n,e),++e}if(this.getChildrenFunction){const r=this.getChildrenFunction(n);if(Array.isArray(r))for(const o of r)e=this._processCollection(e,o);else e=this._processCollection(e,r)}}return e}};y([S()],Tb.prototype,"getCollections",void 0),y([S()],Tb.prototype,"getChildrenFunction",void 0),y([S()],Tb.prototype,"itemFilterFunction",void 0),Tb=y([se("esri.core.CollectionFlattener")],Tb);const gM=Tb;let RL=class{constructor(e=i=>i.values().next().value){this._peeker=e,this._observable=new HM,this._items=new Set}get length(){return fi(this._observable),this._items.size}clear(){this.length!==0&&(this._items.clear(),this._observable.notify())}last(){if(this.length===0)return;let e;for(e of this._items);return e}peek(){if(this.length!==0)return this._peeker(this._items)}push(e){this.contains(e)||(this._items.add(e),this._observable.notify())}contains(e){return fi(this._observable),this._items.has(e)}pop(){if(this.length===0)return;const e=this.peek();return this._items.delete(e),this._observable.notify(),e}popLast(){if(this.length===0)return;const e=this.last();return this._items.delete(e),this._observable.notify(),e}remove(e){this.contains(e)&&(this._items.delete(e),this._observable.notify())}filter(e){const i=this.length;return this._items.forEach(s=>{e(s)||this._items.delete(s)}),i!==this._items.size&&this._observable.notify(),this}*[Symbol.iterator](){fi(this._observable),yield*this._items}};const Nye=new FinalizationRegistry(t=>{t.close()});function kje(t,e){Nye.register(t,e,e)}function $je(t){Nye.unregister(t)}function Rye(t,e){return new Proxy({},{get:(i,s,n)=>(...r)=>{let o,a;const l=r[r.length-1];return Uje(l)&&(o=l.signal,a=l.transferList,r.pop()),t.apply(e?`${e}.${s.toString()}`:s.toString(),r,{transferList:a,signal:o})}})}function Uje(t){return typeof t=="object"&&!Array.isArray(t)&&t!=null&&("signal"in t||"transferList"in t||Object.keys(t).length===0)}const Vje={statsWorker:()=>_e(()=>import("./statsWorker-Bot70LcP.js"),__vite__mapDeps([32,33,34,35,36,37])),geometryEngineWorker:()=>_e(()=>import("./geometryEngineWorker-CA-tZxOm.js"),__vite__mapDeps([38,39,40,3,41])),arcadeGeometryOperatorsWorker:()=>_e(()=>import("./operatorsWorker-D1dNgUxB.js"),[]),CSVSourceWorker:()=>_e(()=>import("./CSVSourceWorker-5OYCfj1m.js"),__vite__mapDeps([42,43,41,14,15,44,45,46,13,16,4,5,6,47,48,34,33,35,36,37,49,50,51,52,53,54,12,55])),EdgeProcessingWorker:()=>_e(()=>import("./EdgeProcessingWorker-CxUe3CDB.js"),__vite__mapDeps([56,57,58,59,60,61,62,63,64,65,66,67])),ElevationSamplerWorker:()=>_e(()=>import("./ElevationSamplerWorker-Wg5ER-8c.js"),__vite__mapDeps([68,53,69,70,71,72,73,74,75,76,77,59,78])),FeatureServiceSnappingSourceWorker:()=>_e(()=>import("./FeatureServiceSnappingSourceWorker-DXcayeQH.js"),__vite__mapDeps([79,44,45,41,46,13,14,15,16,4,5,6,47,48,34,33,35,36,37,49,50,51,52,53,54,80,81,82,83,21])),GeoJSONSourceWorker:()=>_e(()=>import("./GeoJSONSourceWorker-iA62Vnw-.js"),__vite__mapDeps([84,13,14,15,16,44,45,41,46,4,5,6,47,48,34,33,35,36,37,49,50,51,52,53,54,85,43,55,86])),LercWorker:()=>_e(()=>import("./LercWorker-SKx_CiPu.js"),[]),MemorySourceWorker:()=>_e(()=>import("./MemorySourceWorker-B9spVyMG.js"),__vite__mapDeps([87,13,14,15,16,88,44,45,41,46,4,5,6,47,48,34,33,35,36,37,49,50,51,52,53,54,55,86,43])),PBFDecoderWorker:()=>_e(()=>import("./PBFDecoderWorker-DlFQG2QU.js"),__vite__mapDeps([89,90,15,13,14,16,81,82])),FeaturePipelineWorker:()=>_e(()=>import("./FeaturePipelineWorker-yg_aETey.js"),__vite__mapDeps([91,92,93,66,94,95,14,15,96,97,98,99,45,41,47,13,16,6,34,100,101,102,103,104,105,106,107,108,54,46,4,5,48,33,35,36,37,49,50,109,110,111,83,81,82,112,85,43,55,86,113,114,115])),PointCloudWorker:()=>_e(()=>import("./PointCloudWorker-CyFZ9WDp.js"),__vite__mapDeps([116,117,71,118,119,120,121,64,122,72,73,74,123])),RasterWorker:()=>_e(()=>import("./RasterWorker-B5QJBw3D.js"),__vite__mapDeps([124,125,126,3,127,128,129,130])),SceneLayerSnappingSourceWorker:()=>_e(()=>import("./SceneLayerSnappingSourceWorker-p_9uzbEP.js"),__vite__mapDeps([131,132,133,71,123,72,118,134,58,59,60,61,62,63,64,65,66,67])),SceneLayerWorker:()=>_e(()=>import("./SceneLayerWorker-BqoqeTTV.js"),__vite__mapDeps([135,69,77,136,75,133,71,123,72,118,137,121,64,138,98,139,140,141,142,122,117,73,74])),WFSSourceWorker:()=>_e(()=>import("./WFSSourceWorker-BqgH2uB7.js"),__vite__mapDeps([143,13,14,15,16,44,45,41,46,4,5,6,47,48,34,33,35,36,37,49,50,51,52,53,54,85,43,86,144,145])),WorkerTileHandler:()=>_e(()=>import("./WorkerTileHandler-C0NHhH7s.js"),__vite__mapDeps([146,147,96,99,148,149,82,15,104,150,151,66,127,106,95])),Lyr3DWorker:()=>_e(()=>import("./Lyr3DWorker-kMIoQrIR.js"),[]),Feature3DPipelineWorker:()=>_e(()=>import("./Feature3DPipelineWorker-CFK5R_Vx.js"),__vite__mapDeps([152,46,13,14,15,16,4,5,6,47,45,41,48,34,33,35,36,37,49,50,53,83,81,82,63,153,154,155,156,141,72,142,140,71,64,157,133,123,118,132,122,117,73,74,158,159,58,59,60,160,65,66,161,134,162,98,163,164,76,69,136,75,165,119,166,167,168,139,169])),TextureCompressionWorker:()=>_e(()=>import("./TextureCompressionWorker-DdNw54I_.js"),__vite__mapDeps([170,159]))},Oye="worker:port-closed";var na;(function(t){t[t.HANDSHAKE=0]="HANDSHAKE",t[t.OPEN=1]="OPEN",t[t.OPENED=2]="OPENED",t[t.RESPONSE=3]="RESPONSE",t[t.INVOKE=4]="INVOKE",t[t.ABORT=5]="ABORT",t[t.CLOSE=6]="CLOSE",t[t.OPEN_PORT=7]="OPEN_PORT",t[t.ON=8]="ON"})(na||(na={}));let zje=0;function Lye(){return zje++}function Gje(t){return t&&typeof t=="object"&&("result"in t||"transferList"in t)}function _M(t){return t?typeof t=="string"?JSON.stringify({name:"message",message:t}):t.toJSON?JSON.stringify(t):JSON.stringify({name:t.name,message:t.message,details:t.details||{stack:t.stack}}):null}function lY(t,e,i,s){if(e.type===na.OPEN_PORT)return void t.postMessage(e,[e.port]);if(e.type!==na.INVOKE&&e.type!==na.RESPONSE)return void t.postMessage(e);let n;if(Gje(i)?(n=tse(i.transferList),e.data=i.result):(n=tse(s),e.data=i),n){if(ke("ff")){for(const r of n)if("byteLength"in r&&r.byteLength>267386880){const o="Worker call with large ArrayBuffer would crash Firefox";switch(e.type){case na.INVOKE:throw o;case na.RESPONSE:return void lY(t,{type:na.RESPONSE,jobId:e.jobId,error:_M(o)})}}}t.postMessage(e,n)}else t.postMessage(e)}function yM(t){if(!t)return null;const e=t.data;return e?typeof e=="string"?JSON.parse(e):e:null}function tse(t){if(!(t!=null&&t.length))return null;if(ke("esri-workers-arraybuffer-transfer"))return t;const e=t.filter(i=>!Bje(i));return e.length?e:null}function Bje(t){var e;return t instanceof ArrayBuffer||((e=t==null?void 0:t.constructor)==null?void 0:e.name)==="ArrayBuffer"}async function K0t(t){try{return await t}catch(e){const i=(e==null?void 0:e.name)===Oye;if(!(cl(e)||i))throw e;return}}const{CLOSE:ise,ABORT:sse,INVOKE:nse,RESPONSE:X2,OPEN_PORT:rse,ON:qje}=na,Hje=2;let jje=class{constructor(e){this._invoke=e,this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._timer=null,this._process=this._process.bind(this)}push(e){e.type===na.ABORT?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),this._timer===null&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){this._timer=null;for(const e of this._invokeMessages)this._cancelledJobIds.has(e.jobId)||this._invoke(e);this._cancelledJobIds.clear(),this._invokeMessages.length=0}},Py=class Pb{static connect(e,i){const s=new MessageChannel;let n;n=typeof e=="function"?new e:"default"in e&&typeof e.default=="function"?new e.default:e;const r=new Pb(s.port1,{channel:s,client:n,schedule:i});return typeof n=="object"&&"remoteClient"in n&&(n.remoteClient=r),Pb.clients.set(r,n),s.port2}static loadWorker(e){const i=Vje[e];return i?i():Promise.resolve(null)}constructor(e,i,s){this._port=e,this._jobQueue=s,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new jje(n=>this._onInvokeMessage(n)),this._client=i.client,this._onMessage=this._onMessage.bind(this),this._channel=i.channel,this._schedule=i.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}close(){this._post({type:ise}),this._close()}isBusy(){return this._outJobs.size>0}invoke(e,i,s){return this.apply(e,[i],s)}apply(e,i,s){const n=s==null?void 0:s.signal,r=s==null?void 0:s.transferList;if(!this._port)return Promise.reject(new Se(Oye,`Cannot call invoke('${e}'), port is closed`,{methodName:e,data:i}));const o=Lye();return new Promise((a,l)=>{if(dc(n))return this._processWork(),void l(Vn());const u=Jc(n,()=>{const h=this._outJobs.get(o);h&&(this._outJobs.delete(o),this._processWork(),sr(h.abortHandle),this._post({type:sse,jobId:o}),l(Vn()))}),c={resolve:a,reject:l,abortHandle:u,debugInfo:e};this._outJobs.set(o,c),this._post({type:nse,jobId:o,methodName:e,abortable:n!=null},i,r)})}createInvokeProxy(e){return Rye(this,e)}on(e,i){const s=new MessageChannel;function n(r){i(r.data)}return this._port.postMessage({type:na.ON,eventType:e,port:s.port2},[s.port2]),s.port1.addEventListener("message",n),s.port1.start(),Gs(()=>{s.port1.postMessage({type:na.CLOSE}),s.port1.close(),s.port1.removeEventListener("message",n)})}jobAdded(){this._processWork()}openPort(){const e=new MessageChannel;return this._post({type:rse,port:e.port2}),e.port1}_processWork(){var o;if(this._outJobs.size>=Hje)return;const e=(o=this._jobQueue)==null?void 0:o.pop();if(!e)return;const{methodName:i,data:s,invokeOptions:n,resolver:r}=e;this.apply(i,s,n).then(a=>r.resolve(a)).catch(a=>r.reject(a))}_close(){this._channel&&(this._channel=void 0),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach(e=>{sr(e.abortHandle),e.reject(Vn(`Worker closing, aborting job calling '${e.debugInfo}'`))}),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=null,this._client=null,this._schedule=null}_onMessage(e){this._schedule!=null?this._schedule(()=>this._processMessage(e,!0)):this._processMessage(e,!1)}_processMessage(e,i){const s=yM(e);if(s)switch(s.type){case X2:this._onResponseMessage(s);break;case nse:i?this._onInvokeMessage(s):this._invokeQueue.push(s);break;case sse:this._onAbortMessage(s);break;case ise:this._onCloseMessage();break;case rse:this._onOpenPortMessage(s);break;case qje:this._onOnMessage(s)}}_onAbortMessage(e){const i=this._inJobs,s=e.jobId,n=i.get(s);this._invokeQueue.push(e),n&&(n.controller&&n.controller.abort(),i.delete(s))}_onCloseMessage(){const e=this._client;this._close(),e&&"destroy"in e&&Pb.clients.get(this)===e&&e.destroy(),Pb.clients.delete(this),e!=null&&e.remoteClient&&(e.remoteClient=null)}_onInvokeMessage(e){const{methodName:i,jobId:s,data:n=[],abortable:r}=e,o=r?new AbortController:null,a=this._inJobs;let l,u=this._client,c=u[i];try{if(!c&&i&&i.includes(".")){const h=i.split(".");for(let d=0;d<h.length-1;d++)u=u[h[d]],c=u[h[d+1]]}if(typeof c!="function")throw new TypeError(`${i} is not a function`);n.push({client:this,signal:o?o.signal:null}),l=c.apply(u,n)}catch(h){return void this._post({type:X2,jobId:s,error:_M(h)})}Hm(l)?(a.set(s,{controller:o,promise:l}),l.then(h=>{a.has(s)&&(a.delete(s),this._post({type:X2,jobId:s},h))},h=>{a.has(s)&&(a.delete(s),cl(h)||this._post({type:X2,jobId:s,error:_M(h||{message:`Error encountered at method ${i}`})}))})):this._post({type:X2,jobId:s},l)}_onOpenPortMessage(e){new Pb(e.port,{client:this._client})}_onOnMessage(e){const{port:i}=e,s=this._client.on(e.eventType,r=>{i.postMessage(r)}),n=$M(e.port,"message",r=>{const o=yM(r);(o==null?void 0:o.type)===na.CLOSE&&(n.remove(),s.remove(),i.close())})}_onResponseMessage(e){const{jobId:i,error:s,data:n}=e,r=this._outJobs;if(!r.has(i))return;const o=r.get(i);r.delete(i),this._processWork(),sr(o.abortHandle),s?o.reject(Se.fromJSON(JSON.parse(s))):o.resolve(n)}_post(e,i,s){return lY(this._port,e,i,s)}};Py.kernelInfo={buildDate:oce,fullVersion:CH,revision:ace},Py.clients=new Map;let Yje=class{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new RL}destroy(){this.close()}get closed(){var e;return!((e=this._clients)!=null&&e.length)}open(e,i){return new Promise((s,n)=>{let r=!0;const o=a=>{vr(i.signal),r&&(r=!1,a())};this._clients.length=e.length,this._clientPromises.length=e.length,this._inUseClients.length=e.length;for(let a=0;a<e.length;++a){const l=e[a];Hm(l)?this._clientPromises[a]=l.then(u=>(this._clients[a]=new Py(u,i,this._ongoingJobsQueue),o(s),this._clients[a]),()=>(o(n),null)):(this._clients[a]=new Py(l,i,this._ongoingJobsQueue),this._clientPromises[a]=Promise.resolve(this._clients[a]),o(s))}})}broadcast(e,i,s){const n=new Array(this._clientPromises.length);for(let r=0;r<this._clientPromises.length;++r){const o=this._clientPromises[r];n[r]=o.then(a=>a==null?void 0:a.invoke(e,i,s))}return n}close(){let e;for(;e=this._ongoingJobsQueue.pop();)e.resolver.reject(Vn(`Worker closing, aborting job calling '${e.methodName}'`));for(const i of this._clientPromises)i.then(s=>s==null?void 0:s.close());this._clients.length=0,this._clientPromises.length=0,this._inUseClients.length=0,$je(this)}invoke(e,i,s){return this.apply(e,[i],s)}apply(e,i,s){const n=mc();this._ongoingJobsQueue.push({methodName:e,data:i,invokeOptions:s,resolver:n});for(let r=0;r<this._clientPromises.length;r++){const o=this._clients[r];o?o.jobAdded():this._clientPromises[r].then(a=>a==null?void 0:a.jobAdded())}return n.promise}createInvokeProxy(e){return Rye(this,e)}on(e,i){return Promise.all(this._clientPromises).then(()=>LM(this._clients.map(s=>s.on(e,i))))}openPorts(){return new Promise(e=>{const i=new Array(this._clientPromises.length);let s=i.length;for(let n=0;n<this._clientPromises.length;++n)this._clientPromises[n].then(r=>{r&&(i[n]=r.openPort()),--s==0&&e(i)})})}get test(){}};const Xje={async request(t,e){var o,a;const i=t.options,s=i.responseType;i.signal=e==null?void 0:e.signal,i.responseType=s==="native"||s==="native-request-init"?"native-request-init":s&&["blob","json","text"].includes(s)&&((o=wz(t.url))!=null&&o.after)?s:"array-buffer";const n=await $n(t.url,i),r={data:n.data,httpStatus:n.httpStatus,ssl:n.ssl};switch((a=n.requestOptions)==null?void 0:a.responseType){case"native-request-init":return delete r.data.signal,r;case"blob":r.data=await r.data.arrayBuffer();break;case"json":r.data=new TextEncoder().encode(JSON.stringify(r.data)).buffer;break;case"text":r.data=new TextEncoder().encode(r.data).buffer}return{result:r,transferList:[r.data]}}},Wje={ar:"ar-u-nu-latn"};let w3=new WeakMap,Fye={};function D8(t){const e=t||Fye;if(!w3.has(e)){const i=vu(),s=Wje[vu()]||i;w3.set(e,new Intl.NumberFormat(s,t))}return w3.get(e)}function evt(t={}){const e={};return t.digitSeparator!=null&&(e.useGrouping=t.digitSeparator),t.places!=null&&(e.minimumFractionDigits=e.maximumFractionDigits=t.places),e}function tvt(t,e){return Object.is(t,-0)&&(t=0),D8(e).format(t)}function ivt(t,e=vu()){var s,n;if(!t)return null;let i=ose.get(e);if(!i){const r=D8().formatToParts(12345.6),o=[...D8({useGrouping:!1}).format(9876543210)].reverse(),a=new Map(o.map((m,f)=>[m,f])),l=new RegExp(`[${(s=r.find(m=>m.type==="group"))==null?void 0:s.value}]`,"g"),u=new RegExp(`[${(n=r.find(m=>m.type==="decimal"))==null?void 0:n.value}]`),c=new RegExp(`[${o.join("")}]`,"g"),h=/[\u200E\u200F\u202A\u202B\u202C\u202D\u202E\u2066\u2067\u2068\u2069\u061C]/g,d=/[-\u2212\u2013\u2014\u2015]/g;i=m=>{if((m=m.trim().replaceAll(l,"").replace(u,".").replace(c,_=>String(a.get(_))).replaceAll(h,"").replaceAll(d,"-"))==="")return null;const f=Number(m);return isNaN(f)?null:f},ose.set(e,i)}return i(t)}JH(()=>{w3=new WeakMap,Fye={}});const ose=new Map,ase=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,kye={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:"no",nl:!0,no:!0,pl:!0,pt:"pt-BR","pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,zh:"zh-CN","zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function Zje(t){return t in kye}function lse(t){if(Zje(t)){const e=kye[t];return e===!0?t:e}return null}const tT=[],Lw=new Map;function use(t){for(const e of Lw.keys())Vye(t.pattern,e)&&Lw.delete(e)}function Kje(t){return tT.includes(t)||(use(t),tT.unshift(t)),Gs(()=>{const e=tT.indexOf(t);e>-1&&(tT.splice(e,1),use(t))})}async function $ye(t){const e=vu();Lw.has(t)||Lw.set(t,Qje(t,e));const i=Lw.get(t);return i&&await Jje.add(i),i}function Uye(t){if(!ase.test(t))return null;const e=ase.exec(t);if(e===null)return null;const[,i,s]=e;return lse(i+(s?"-"+s.toUpperCase():""))??lse(i)}async function Qje(t,e){const i=[];for(const s of tT)if(Vye(s.pattern,t))try{return await s.fetchMessageBundle(t,e)}catch(n){i.push(n)}throw i.length?new Se("intl:message-bundle-error",`Errors occurred while loading "${t}"`,{errors:i}):new Se("intl:no-message-bundle-loader",`No loader found for message bundle "${t}"`)}function Vye(t,e){return typeof t=="string"?e.startsWith(t):t.test(e)}JH(()=>{Lw.clear()});const Jje=new class{constructor(){this._numLoading=0,this._dfd=null}async waitForAll(){this._dfd&&await this._dfd.promise}add(t){return this._increase(),t.then(()=>this._decrease(),()=>this._decrease()),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=mc())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&this._numLoading===0&&(this._dfd.resolve(),this._dfd=null)}};async function eYe(t,e,i,s){const n=e.exec(i);if(!n)throw new Se("esri-intl:invalid-bundle",`Bundle id "${i}" is not compatible with the pattern "${e}"`);const r=n[1]?`${n[1]}/`:"",o=n[2],a=Uye(s),l=`${r}${o}.json`,u=a?`${r}${o}_${a}.json`:l;let c;try{c=await cse(t(u))}catch(h){if(u===l)throw new Se("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:h});try{c=await cse(t(l))}catch(d){throw new Se("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:d})}}return c}async function cse(t){if(hse.fetchBundleAsset!=null)return hse.fetchBundleAsset(t);const e=await $n(t,{responseType:"text"});return JSON.parse(e.data)}let tYe=class{constructor({base:e="",pattern:i,location:s=new URL(window.location.href)}){let n;n=typeof s=="string"?r=>new URL(r,new URL(s,window.location.href)).href:s instanceof URL?r=>new URL(r,s).href:s,this.pattern=typeof i=="string"?new RegExp(`^${i}`):i,this.getAssetUrl=n,e=e?e.endsWith("/")?e:e+"/":"",this.matcher=new RegExp(`^${e}(?:(.*)\\/)?(.*)$`)}fetchMessageBundle(e,i){return eYe(this.getAssetUrl,this.matcher,e,i)}};function iYe(t){return new tYe(t)}const hse={};Kje(iYe({pattern:"esri/",location:$r}));const dse={};function sYe(t){var i;const e={async:t.async,isDebug:t.isDebug,locale:t.locale,baseUrl:t.baseUrl,has:{...t.has},map:{...t.map},packages:((i=t.packages)==null?void 0:i.slice())||[],paths:{...dse.paths,...t.paths}};return t.hasOwnProperty("async")||(e.async=!0),t.hasOwnProperty("isDebug")||(e.isDebug=!1),t.baseUrl||(e.baseUrl=dse.baseUrl),e}let nYe=class{constructor(){const e=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(i=>{this[i]=(...s)=>e[i](...s)})}},S3=class{constructor(){this._dispatcher=new nYe,this._workerPostMessage({type:na.HANDSHAKE})}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(e){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=e,e&&this.addEventListener("message",e)}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(e){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=e,e&&this.addEventListener("messageerror",e)}get onerror(){return this._onerrorHandler}set onerror(e){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=e,e&&this.addEventListener("error",e)}postMessage(e){xO(()=>{this._workerMessageHandler(new MessageEvent("message",{data:e}))})}dispatchEvent(e){return this._dispatcher.dispatchEvent(e)}addEventListener(e,i,s){this._dispatcher.addEventListener(e,i,s)}removeEventListener(e,i,s){this._dispatcher.removeEventListener(e,i,s)}_workerPostMessage(e){xO(()=>{this.dispatchEvent(new MessageEvent("message",{data:e}))})}async _workerMessageHandler(e){const i=yM(e);if(i&&i.type===na.OPEN){const{modulePath:s,jobId:n}=i;let r=await Py.loadWorker(s);r||(r=await import(s));const o=Py.connect(r);this._workerPostMessage({type:na.OPENED,jobId:n,data:o})}}};const N8=()=>ht.getLogger("esri.core.workers.workerFactory"),{HANDSHAKE:rYe}=na,oYe='let globalId=0;const outgoing=new Map,configuration={CONFIGURATION};self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;let s=null;return new Promise(((r,i)=>{if(t){if(t.aborted)return i(createAbortError());s=()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:5,jobId:n}),i(createAbortError()))},t.addEventListener("abort",s)}outgoing.set(n,{resolve:r,reject:i}),self.postMessage({type:4,jobId:n,methodName:e,abortable:null!=t,data:o})})).finally((()=>{t&&t.removeEventListener("abort",s)}))}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,fullVersion:r}=configuration.kernelInfo,{revision:t,fullVersion:n,version:s}=e.kernelInfo;esriConfig.assetsPath!==esriConfig.defaultAssetsPath&&o!==t&&console.warn(`Version mismatch detected between ArcGIS Maps SDK for JavaScript modules and assets. For more information visit https://bit.ly/3QnsuSo.\nModules version: ${r}\nAssets version: ${n??s}\nAssets path: ${esriConfig.assetsPath}`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case 1:let n;function t(e){const o=n.connect(e);self.postMessage({type:2,jobId:r,data:o},[o])}"function"==typeof define&&define.amd?require([workerPath],(e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||new Promise((e=>{require([o.modulePath],e)})))).then(t)})):"System"in self&&"function"==typeof System.import?System.import(workerPath).then((e=>(n=e.default,checkWorkerRevision(n),n.loadWorker(o.modulePath)))).then((e=>e||System.import(o.modulePath))).then(t):esriConfig.workers.useDynamicImport?import(workerPath).then((e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||import(o.modulePath))).then(t)})):(self.RemoteClient||importScripts(workerPath),n=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(t));break;case 3:if(outgoing.has(r)){const s=outgoing.get(r);outgoing.delete(r),o.error?s.reject(JSON.parse(o.error)):s.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});';let ON,LN;const mse="Failed to create Worker. Fallback to execute module in main thread";async function aYe(){if(!ke("esri-workers"))return pse(new S3);if(!ON&&!LN)try{const e=oYe.split("{CONFIGURATION}").join(lYe());ON=URL.createObjectURL(new Blob([e],{type:"text/javascript"}))}catch(e){LN=e||{}}let t;if(ON)try{t=new Worker(ON,{name:"esri-worker-"+uYe++})}catch{N8().warn(mse,LN),t=new S3}else N8().warn(mse,LN),t=new S3;return pse(t)}async function pse(t){return new Promise(e=>{function i(n){const r=yM(n);r&&r.type===rYe&&(t.removeEventListener("message",i),t.removeEventListener("error",s),e(t))}function s(n){n.preventDefault(),t.removeEventListener("message",i),t.removeEventListener("error",s),N8().warn("Failed to create Worker. Fallback to execute module in main thread",n),(t=new S3).addEventListener("message",i),t.addEventListener("error",s)}t.addEventListener("message",i),t.addEventListener("error",s)})}function lYe(){let t;if(Ks.default!=null){const n={...Ks};delete n.default,t=JSON.parse(JSON.stringify(n))}else t=JSON.parse(JSON.stringify(Ks));t.assetsPath=Yc(t.assetsPath),t.defaultAssetsPath=t.defaultAssetsPath?Yc(t.defaultAssetsPath):void 0,t.request.interceptors=[],t.log.interceptors=[],t.locale=vu(),t.has={"esri-csp-restrictions":ke("esri-csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":ke("esri-2d-update-debug"),"esri-2d-log-updating":ke("esri-2d-log-updating"),"featurelayer-pbf":ke("featurelayer-pbf"),"featurelayer-fast-triangulation-enabled":ke("featurelayer-fast-triangulation-enabled"),"featurelayer-simplify-thresholds":ke("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":ke("featurelayer-simplify-payload-size-factors"),"featurelayer-simplify-mobile-factor":ke("featurelayer-simplify-mobile-factor"),"featurelayer-query-max-depth":ke("featurelayer-query-max-depth"),"featurelayer-query-pausing-enabled":ke("featurelayer-query-pausing-enabled"),"featurelayer-snapshot-enabled":ke("featurelayer-snapshot-enabled"),"esri-atomics":ke("esri-atomics"),"esri-shared-array-buffer":ke("esri-shared-array-buffer"),"esri-tiles-debug":ke("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":ke("esri-workers-arraybuffer-transfer"),"feature-polyline-generalization-factor":ke("feature-polyline-generalization-factor"),"host-webworker":1},t.workers.loaderUrl&&(t.workers.loaderUrl=Yc(t.workers.loaderUrl)),t.workers.workerPath?t.workers.workerPath=Yc(t.workers.workerPath):t.workers.workerPath=Yc($r("esri/core/workers/RemoteClient.js")),t.workers.useDynamicImport=!1;const e=Ks.workers.loaderConfig,i=sYe({baseUrl:e==null?void 0:e.baseUrl,locale:vu(),has:{"csp-restrictions":1,"dojo-test-sniff":0,"host-webworker":1,...e==null?void 0:e.has},map:{...e==null?void 0:e.map},paths:{...e==null?void 0:e.paths},packages:(e==null?void 0:e.packages)||[]});return JSON.stringify({esriConfig:t,loaderConfig:i,kernelInfo:{buildDate:oce,fullVersion:CH,revision:ace}})}let uYe=0;const{ABORT:fse,INVOKE:cYe,OPEN:hYe,OPENED:dYe,RESPONSE:W2}=na;let mYe=class zye{static async create(e){const i=await aYe();return new zye(i,e)}constructor(e,i){this._outJobs=new Map,this._inJobs=new Map,this.worker=e,this.id=i,e.addEventListener("message",this._onMessage.bind(this)),e.addEventListener("error",s=>{s.preventDefault(),ht.getLogger("esri.core.workers.WorkerOwner").error(s)})}terminate(){this.worker.terminate()}async open(e,i={}){const{signal:s}=i,n=Lye();return new Promise((r,o)=>{const a={resolve:r,reject:o,abortHandle:hH(s,()=>{this._outJobs.delete(n),this._post({type:fse,jobId:n})})};this._outJobs.set(n,a),this._post({type:hYe,jobId:n,modulePath:e})})}_onMessage(e){const i=yM(e);if(i)switch(i.type){case dYe:this._onOpenedMessage(i);break;case W2:this._onResponseMessage(i);break;case fse:this._onAbortMessage(i);break;case cYe:this._onInvokeMessage(i)}}_onAbortMessage(e){const i=this._inJobs,s=e.jobId,n=i.get(s);n&&(n.controller&&n.controller.abort(),i.delete(s))}_onInvokeMessage(e){const{methodName:i,jobId:s,data:n,abortable:r}=e,o=r?new AbortController:null,a=this._inJobs,l=Xje[i];let u;try{if(typeof l!="function")throw new TypeError(`${i} is not a function`);u=l.call(null,n,{signal:o?o.signal:null})}catch(c){return void this._post({type:W2,jobId:s,error:_M(c)})}Hm(u)?(a.set(s,{controller:o,promise:u}),u.then(c=>{a.has(s)&&(a.delete(s),this._post({type:W2,jobId:s},c))},c=>{a.has(s)&&(a.delete(s),c||(c={message:"Error encountered at method"+i}),cl(c)||this._post({type:W2,jobId:s,error:_M(c||{message:`Error encountered at method ${i}`})}))})):this._post({type:W2,jobId:s},u)}_onOpenedMessage(e){const{jobId:i,data:s}=e,n=this._outJobs.get(i);n&&(this._outJobs.delete(i),sr(n.abortHandle),n.resolve(s))}_onResponseMessage(e){const{jobId:i,error:s,data:n}=e,r=this._outJobs.get(i);r&&(this._outJobs.delete(i),sr(r.abortHandle),s?r.reject(Se.fromJSON(JSON.parse(s))):r.resolve(n))}_post(e,i,s){return lY(this.worker,e,i,s)}};const gse=ke("host-browser")?Math.min(navigator.hardwareConcurrency-1,ke("workers-pool-size")??8):0;let Gv=ke("esri-mobile")?Math.min(gse,3):gse;Gv||(Gv=ke("safari")&&ke("mac")?7:2);let _se=0;const E3=[];function pYe(){Gye()}async function FN(t,e){const i=new Yje,{registryTarget:s,...n}=e;return await i.open(t,n),s&&kje(s,i),i}async function fYe(t,e={}){if(typeof t!="string")throw new Se("workers:undefined-module","modulePath is missing");let i=e.strategy||"distributed";if(ke("host-webworker")&&!ke("esri-workers")&&(i="local"),i==="local"){let s=await Py.loadWorker(t);s||(s=await import(t)),vr(e.signal);const n=e.client||s;return FN([Py.connect(s,e.schedule)],{...e,client:n})}if(await Gye(),vr(e.signal),i==="dedicated"){const s=_se++%Gv;return FN([await E3[s].open(t,e)],e)}if(e.maxNumWorkers&&e.maxNumWorkers>0){const s=Math.min(e.maxNumWorkers,Gv);if(s<Gv){const n=new Array(s);for(let r=0;r<s;++r){const o=_se++%Gv;n[r]=E3[o].open(t,e)}return FN(n,e)}}return FN(E3.map(s=>s.open(t,e)),e)}let kN=null;async function Gye(){if(kN)return kN;new AbortController;const t=[];for(let e=0;e<Gv;e++){const i=mYe.create(e).then(s=>(E3[e]=s,s));t.push(i)}return kN=Promise.all(t),kN}var Re;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.SPHERICAL_ECEF=1]="SPHERICAL_ECEF",t[t.WGS84=2]="WGS84",t[t.WEB_MERCATOR=3]="WEB_MERCATOR",t[t.WGS84_ECEF=4]="WGS84_ECEF",t[t.CGCS2000=5]="CGCS2000",t[t.SPHERICAL_MARS_PCPF=6]="SPHERICAL_MARS_PCPF",t[t.GCSMARS2000=7]="GCSMARS2000",t[t.SPHERICAL_MOON_PCPF=8]="SPHERICAL_MOON_PCPF",t[t.GCSMOON2000=9]="GCSMOON2000",t[t.LON_LAT=10]="LON_LAT",t[t.PLATE_CARREE=11]="PLATE_CARREE"})(Re||(Re={}));const gYe={[Re.WGS84]:{[Re.CGCS2000]:Kn,[Re.GCSMARS2000]:null,[Re.GCSMOON2000]:null,[Re.LON_LAT]:Kn,[Re.SPHERICAL_ECEF]:iP,[Re.SPHERICAL_MARS_PCPF]:null,[Re.SPHERICAL_MOON_PCPF]:null,[Re.UNKNOWN]:null,[Re.WEB_MERCATOR]:Fw,[Re.PLATE_CARREE]:kw,[Re.WGS84]:Kn,[Re.WGS84_ECEF]:Vw},[Re.CGCS2000]:{[Re.CGCS2000]:Kn,[Re.GCSMARS2000]:null,[Re.GCSMOON2000]:null,[Re.LON_LAT]:Kn,[Re.SPHERICAL_ECEF]:iP,[Re.SPHERICAL_MARS_PCPF]:null,[Re.SPHERICAL_MOON_PCPF]:null,[Re.UNKNOWN]:null,[Re.WEB_MERCATOR]:Fw,[Re.PLATE_CARREE]:kw,[Re.WGS84]:Kn,[Re.WGS84_ECEF]:Vw},[Re.GCSMARS2000]:{[Re.CGCS2000]:null,[Re.GCSMARS2000]:Kn,[Re.GCSMOON2000]:null,[Re.LON_LAT]:Kn,[Re.SPHERICAL_ECEF]:null,[Re.SPHERICAL_MARS_PCPF]:xse,[Re.SPHERICAL_MOON_PCPF]:null,[Re.UNKNOWN]:null,[Re.WEB_MERCATOR]:null,[Re.PLATE_CARREE]:null,[Re.WGS84]:null,[Re.WGS84_ECEF]:null},[Re.GCSMOON2000]:{[Re.CGCS2000]:null,[Re.GCSMARS2000]:null,[Re.GCSMOON2000]:Kn,[Re.LON_LAT]:Kn,[Re.SPHERICAL_ECEF]:null,[Re.SPHERICAL_MARS_PCPF]:null,[Re.SPHERICAL_MOON_PCPF]:vse,[Re.UNKNOWN]:null,[Re.WEB_MERCATOR]:null,[Re.PLATE_CARREE]:null,[Re.WGS84]:null,[Re.WGS84_ECEF]:null},[Re.WEB_MERCATOR]:{[Re.CGCS2000]:tP,[Re.GCSMARS2000]:null,[Re.GCSMOON2000]:null,[Re.LON_LAT]:tP,[Re.SPHERICAL_ECEF]:yYe,[Re.SPHERICAL_MARS_PCPF]:null,[Re.SPHERICAL_MOON_PCPF]:null,[Re.UNKNOWN]:null,[Re.WEB_MERCATOR]:Kn,[Re.PLATE_CARREE]:bYe,[Re.WGS84]:tP,[Re.WGS84_ECEF]:vYe},[Re.WGS84_ECEF]:{[Re.CGCS2000]:zw,[Re.GCSMARS2000]:null,[Re.GCSMOON2000]:null,[Re.LON_LAT]:zw,[Re.SPHERICAL_ECEF]:IYe,[Re.SPHERICAL_MARS_PCPF]:null,[Re.SPHERICAL_MOON_PCPF]:null,[Re.UNKNOWN]:null,[Re.WEB_MERCATOR]:DYe,[Re.PLATE_CARREE]:wYe,[Re.WGS84]:zw,[Re.WGS84_ECEF]:Kn},[Re.SPHERICAL_ECEF]:{[Re.CGCS2000]:Uw,[Re.GCSMARS2000]:null,[Re.GCSMOON2000]:null,[Re.LON_LAT]:Uw,[Re.SPHERICAL_ECEF]:Kn,[Re.SPHERICAL_MARS_PCPF]:null,[Re.SPHERICAL_MOON_PCPF]:null,[Re.UNKNOWN]:null,[Re.WEB_MERCATOR]:PYe,[Re.PLATE_CARREE]:SYe,[Re.WGS84]:Uw,[Re.WGS84_ECEF]:MYe},[Re.SPHERICAL_MARS_PCPF]:{[Re.CGCS2000]:null,[Re.GCSMARS2000]:wse,[Re.GCSMOON2000]:null,[Re.LON_LAT]:wse,[Re.SPHERICAL_ECEF]:null,[Re.SPHERICAL_MARS_PCPF]:Kn,[Re.SPHERICAL_MOON_PCPF]:null,[Re.UNKNOWN]:null,[Re.WEB_MERCATOR]:null,[Re.PLATE_CARREE]:null,[Re.WGS84]:null,[Re.WGS84_ECEF]:null},[Re.SPHERICAL_MOON_PCPF]:{[Re.CGCS2000]:null,[Re.GCSMARS2000]:null,[Re.GCSMOON2000]:bse,[Re.LON_LAT]:bse,[Re.SPHERICAL_ECEF]:null,[Re.SPHERICAL_MARS_PCPF]:null,[Re.SPHERICAL_MOON_PCPF]:Kn,[Re.UNKNOWN]:null,[Re.WEB_MERCATOR]:null,[Re.PLATE_CARREE]:null,[Re.WGS84]:null,[Re.WGS84_ECEF]:null},[Re.UNKNOWN]:{[Re.CGCS2000]:null,[Re.GCSMARS2000]:null,[Re.GCSMOON2000]:null,[Re.LON_LAT]:null,[Re.SPHERICAL_ECEF]:null,[Re.SPHERICAL_MARS_PCPF]:null,[Re.SPHERICAL_MOON_PCPF]:null,[Re.UNKNOWN]:Kn,[Re.WEB_MERCATOR]:null,[Re.PLATE_CARREE]:null,[Re.WGS84]:null,[Re.WGS84_ECEF]:null},[Re.LON_LAT]:{[Re.CGCS2000]:Kn,[Re.GCSMARS2000]:Kn,[Re.GCSMOON2000]:Kn,[Re.LON_LAT]:Kn,[Re.SPHERICAL_ECEF]:iP,[Re.SPHERICAL_MARS_PCPF]:xse,[Re.SPHERICAL_MOON_PCPF]:vse,[Re.UNKNOWN]:null,[Re.WEB_MERCATOR]:Fw,[Re.PLATE_CARREE]:kw,[Re.WGS84]:Kn,[Re.WGS84_ECEF]:Vw},[Re.PLATE_CARREE]:{[Re.CGCS2000]:$w,[Re.GCSMARS2000]:null,[Re.GCSMOON2000]:null,[Re.LON_LAT]:$w,[Re.SPHERICAL_ECEF]:EYe,[Re.SPHERICAL_MARS_PCPF]:null,[Re.SPHERICAL_MOON_PCPF]:null,[Re.UNKNOWN]:null,[Re.WEB_MERCATOR]:CYe,[Re.PLATE_CARREE]:Kn,[Re.WGS84]:$w,[Re.WGS84_ECEF]:TYe}};function Bye(t,e){var i;return(i=_Ye(t,e))==null?void 0:i.projector}function _Ye(t,e){if(t==null||e==null)return null;if(Ap.source.spatialReference===t&&Ap.dest.spatialReference===e)return Ap;const i=yse(t,Ap.source),s=yse(e,Ap.dest);return i===Re.UNKNOWN&&s===Re.UNKNOWN?$o(t,e)?Ap.projector=Kn:Ap.projector=null:Ap.projector=gYe[i][s],Ap}function yse(t,e){return t?e.spatialReference===t?e.spatialReferenceId:(e.spatialReference=t,"metersPerUnit"in e&&(e.metersPerUnit=ah(t,1)),LO(t)?e.spatialReferenceId=Re.SPHERICAL_ECEF:l1(t)?e.spatialReferenceId=Re.WGS84:yd(t)?e.spatialReferenceId=Re.WEB_MERCATOR:OTe(t)?e.spatialReferenceId=Re.PLATE_CARREE:t.wkt===$Te.wkt?e.spatialReferenceId=Re.WGS84_ECEF:t.wkid===a1.CGCS2000?e.spatialReferenceId=Re.CGCS2000:t.wkt===DH.wkt?e.spatialReferenceId=Re.SPHERICAL_MARS_PCPF:t.wkt===NH.wkt?e.spatialReferenceId=Re.SPHERICAL_MOON_PCPF:Ece(t)?e.spatialReferenceId=Re.GCSMARS2000:Cce(t)?e.spatialReferenceId=Re.GCSMOON2000:e.spatialReferenceId=Re.UNKNOWN):Re.UNKNOWN}function Kn(t,e,i,s){t!==i&&(i[s++]=t[e++],i[s++]=t[e++],i[s]=t[e])}function tP(t,e,i,s){i[s]=IS*(t[e]/t1),i[s+1]=IS*(qye-2*Math.atan(Math.exp(-t[e+1]/t1))),i[s+2]=t[e+2]}function yYe(t,e,i,s){const n=t[e]/t1,r=qye-2*Math.atan(Math.exp(-t[e+1]/t1)),o=t1+t[e+2],a=Math.cos(r)*o;i[s]=Math.cos(n)*a,i[s+1]=Math.sin(n)*a,i[s+2]=Math.sin(r)*o}function vYe(t,e,i,s){tP(t,e,i,s),Vw(i,s,i,s)}function xYe(t,e,i,s,n){const r=.4999999*Math.PI,o=sh(AS*t[e+1],-r,r),a=Math.sin(o);i[s++]=AS*t[e]*n.radius,i[s++]=n.halfSemiMajorAxis*Math.log((1+a)/(1-a)),i[s]=t[e+2]}function Fw(t,e,i,s){xYe(t,e,i,s,Pr)}function kw(t,e,i,s){i[s]=t[e]*Sse,i[s+1]=t[e+1]*Sse,i[s+2]=t[e+2]}function $w(t,e,i,s){i[s]=t[e]*Ese,i[s+1]=t[e+1]*Ese,i[s+2]=t[e+2]}function bYe(t,e,i,s){tP(t,e,i,s),kw(i,s,i,s)}function wYe(t,e,i,s){zw(t,e,i,s),kw(i,s,i,s)}function SYe(t,e,i,s){Uw(t,e,i,s),kw(i,s,i,s)}function EYe(t,e,i,s){$w(t,e,i,s),iP(i,s,i,s)}function CYe(t,e,i,s){$w(t,e,i,s),Fw(i,s,i,s)}function TYe(t,e,i,s){$w(t,e,i,s),Vw(i,s,i,s)}function uY(t,e,i,s,n){const r=n+t[e+2],o=AS*t[e+1],a=AS*t[e],l=Math.cos(o)*r;i[s]=Math.cos(a)*l,i[s+1]=Math.sin(a)*l,i[s+2]=Math.sin(o)*r}function vse(t,e,i,s){uY(t,e,i,s,my.radius)}function xse(t,e,i,s){uY(t,e,i,s,Pm.radius)}function iP(t,e,i,s){uY(t,e,i,s,Pr.radius)}function cY(t,e,i,s,n){const r=t[e],o=t[e+1],a=t[e+2],l=Math.sqrt(r*r+o*o+a*a),u=VPe(a/(l===0?1:l)),c=Math.atan2(o,r);i[s++]=IS*c,i[s++]=IS*u,i[s]=l-n}function bse(t,e,i,s){cY(t,e,i,s,my.radius)}function wse(t,e,i,s){cY(t,e,i,s,Pm.radius)}function Uw(t,e,i,s){cY(t,e,i,s,Pr.radius)}function PYe(t,e,i,s){Uw(t,e,i,s),Fw(i,s,i,s)}function MYe(t,e,i,s){Uw(t,e,i,s),Vw(i,s,i,s)}function AYe(t,e,i,s,n){const r=AS*t[e],o=AS*t[e+1],a=t[e+2],l=Math.sin(o),u=Math.cos(o),c=n.radius/Math.sqrt(1-n.eccentricitySquared*l*l);i[s++]=(c+a)*u*Math.cos(r),i[s++]=(c+a)*u*Math.sin(r),i[s++]=(c*(1-n.eccentricitySquared)+a)*l}function Vw(t,e,i,s){AYe(t,e,i,s,Pr)}function zw(t,e,i,s){const n=TGe,r=t[e],o=t[e+1],a=t[e+2];let l,u,c,h,d,m,f,_,v,x,w,T,C,M,A,I,L,D,O,U,$;l=Math.abs(a),u=r*r+o*o,c=Math.sqrt(u),h=u+a*a,d=Math.sqrt(h),U=Math.atan2(o,r),m=a*a/h,f=u/h,M=n.a2/d,A=n.a3-n.a4/d,f>.3?(_=l/d*(1+f*(n.a1+M+m*A)/d),O=Math.asin(_),x=_*_,v=Math.sqrt(1-x)):(v=c/d*(1-m*(n.a5-M-f*A)/d),O=Math.acos(v),x=1-v*v,_=Math.sqrt(x)),w=1-Pr.eccentricitySquared*x,T=Pr.radius/Math.sqrt(w),C=n.a6*T,M=c-T*v,A=l-C*_,L=v*M+_*A,I=v*A-_*M,D=I/(C/w+L),O+=D,$=L+I*D/2,a<0&&(O=-O),i[s++]=IS*U,i[s++]=IS*O,i[s]=$}function IYe(t,e,i,s){zw(t,e,i,s),iP(i,s,i,s)}function DYe(t,e,i,s){zw(t,e,i,s),Fw(i,s,i,s)}const Ap={source:{spatialReference:null,spatialReferenceId:Re.UNKNOWN,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:Re.UNKNOWN,metersPerUnit:1},projector:Kn},AS=qM(1),IS=Xce(1),qye=.5*Math.PI,t1=Pr.radius,Sse=t1*Math.PI/180,Ese=180/(t1*Math.PI);function wA(t,e,i,s,n,r,o=Math.floor(t.length/3)){const a=Bye(e,n);if(a==null)return!1;if(a===Kn){if(t===s&&i===r)return!0;const u=i+3*o;for(let c=i,h=r;c<u;c++,h++)s[h]=t[c];return!0}const l=i+3*o;for(let u=i,c=r;u<l;u+=3,c+=3)a(t,u,s,c);return!0}const ovt=Object.freeze(Object.defineProperty({__proto__:null,projectBuffer:wA},Symbol.toStringTag,{value:"Module"}));function Cse(t,e,i,s,n,r){return $N[0]=t,$N[1]=e,$N[2]=i,wA($N,s,0,n,r,0)}const $N=Fy();let UN=0,Y5=class R8{static fromGE(e){const i=new R8;return i._wkt=e.wkt,i._wkid=e.wkid,i._isInverse=e.isInverse,i}constructor(e){this.uid=UN++,e?(this._wkt=e.wkt!=null?e.wkt:null,this._wkid=e.wkid!=null?e.wkid:-1,this._isInverse=e.isInverse!=null&&e.isInverse===!0):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}get wkt(){return this._wkt}set wkt(e){this._wkt=e,this.uid=UN++}get wkid(){return this._wkid}set wkid(e){this._wkid=e,this.uid=UN++}get isInverse(){return this._isInverse}set isInverse(e){this._isInverse=e,this.uid=UN++}getInverse(){const e=new R8;return e._wkt=this.wkt,e._wkid=this._wkid,e._isInverse=!this.isInverse,e}},OL=class iT{static cacheKey(e,i){var s,n,r,o,a,l;return[((s=e.wkid)==null?void 0:s.toString())??"-1",((n=e.wkt)==null?void 0:n.toString())??"",((r=e.wkt2)==null?void 0:r.toString())??"",((o=i.wkid)==null?void 0:o.toString())??"-1",((a=i.wkt)==null?void 0:a.toString())??"",((l=i.wkt2)==null?void 0:l.toString())??""].join()}static fromGE(e){const i=new iT;let s="";for(const n of e.steps){const r=Y5.fromGE(n);i.steps.push(r),s+=r.uid.toString()+","}return i._cachedProjection={},i._gtlistentry=null,i._chain=s,i}constructor(e){if(this.steps=[],this._cachedProjection={},this._chain="",this._gtlistentry=null,e==null?void 0:e.steps)for(const i of e.steps)i instanceof Y5?this.steps.push(i):this.steps.push(new Y5({wkid:i.wkid,wkt:i.wkt,isInverse:i.isInverse}))}getInverse(){const e=new iT;e.steps=[];for(let i=this.steps.length-1;i>=0;i--){const s=this.steps[i];e.steps.push(s.getInverse())}return e}getGTListEntry(){let e="";for(const i of this.steps)e+=i.uid.toString()+",";return e!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=e),this._gtlistentry}assignCachedGe(e,i,s){this._cachedProjection[iT.cacheKey(e,i)]=s}getCachedGeTransformation(e,i){let s="";for(const r of this.steps)s+=r.uid.toString()+",";s!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=s);const n=this._cachedProjection[iT.cacheKey(e,i)];return n===void 0?null:n}};function Hye(t,e,i){if(e==null||i==null||i.vcsWkid||$o(e,i)||py(e)||py(i))return null;const s=FO(e)/FO(i);if(s===1)return null;switch(t){case"point":case"esriGeometryPoint":return n=>NYe(n,s);case"polyline":case"esriGeometryPolyline":return n=>OYe(n,s);case"polygon":case"esriGeometryPolygon":return n=>RYe(n,s);case"multipoint":case"esriGeometryMultipoint":return n=>LYe(n,s);case"extent":case"esriGeometryEnvelope":return n=>FYe(n,s);default:return null}}function NYe(t,e){(t==null?void 0:t.z)!=null&&(t.z*=e)}function RYe(t,e){if(t)for(const i of t.rings)for(const s of i)s.length>2&&(s[2]*=e)}function OYe(t,e){if(t)for(const i of t.paths)for(const s of i)s.length>2&&(s[2]*=e)}function LYe(t,e){if(t)for(const i of t.points)i.length>2&&(i[2]*=e)}function FYe(t,e){t&&t.zmin!=null&&t.zmax!=null&&(t.zmin*=e,t.zmax*=e)}let gd=null,My=null,sP=null,C3={};const hY=new HM;function Hy(){return!!gd&&PF()}function jye(){return!!Hy()||(fi(hY),Ay(),!1)}function Yye(t,e){return!t||!e||Bm(t,e)||jye()}function kYe(t,e){return!Bm(t,e)&&!Hy()}function Ay(t){return sP==null&&(sP=Promise.all([AH(),_e(()=>import("./geometryEngineBase-B0ZyeKAX.js"),__vite__mapDeps([40,3])).then(e=>e.g),_e(()=>import("./hydrated-CwQyUIm-.js"),[])])),sP.then(([,e,{hydratedAdapter:i}])=>{vr(t),My=i,gd=e.default,gd._enableProjection(xce),hY.notify()})}function jy(t,e,i=null,s=null){return Array.isArray(t)?t.length===0?[]:(rPe(t),O8(My,t,t[0].spatialReference,e,i,s)):(tS(t),O8(My,[t],t.spatialReference,e,i,s)[0])}function O8(t,e,i,s,n=null,r=null){if(i==null||s==null)return e;if(Bm(i,s,n))return e.map(o=>T3(o,i,s));if(n==null&&LO(i))return e.map(o=>T3(o,i,Ri.WGS84)).map(o=>vM(o,s));if(n==null&&LO(s))return e.map(o=>vM(o,Ri.WGS84)).map(o=>T3(o,Ri.WGS84,s));if(n==null){const o=OL.cacheKey(i,s);C3[o]!==void 0?n=C3[o]:((n=Wye(i,s,void 0))==null&&(n=new OL),C3[o]=n)}if(gd==null||t==null)throw new G4;return r!=null?gd._project(t,e,i,s,n,r):gd._project(t,e,i,s,n)}function $Ye(t,e){const i=Xye([t],e);return i.pending!=null?{pending:i.pending,geometry:null}:i.geometries!=null?{pending:null,geometry:i.geometries[0]}:{pending:null,geometry:null}}function Xye(t,e){if(!Hy()){for(const i of t)if(i!=null&&!$o(i.spatialReference,e)&&rc(i.spatialReference)&&rc(e)&&!Bm(i.spatialReference,e))return fi(hY),{pending:Ay(),geometries:null}}return{pending:null,geometries:t.map(i=>i==null?null:$o(i.spatialReference,e)?i:rc(i.spatialReference)&&rc(e)?vM(i,e):null)}}function Wye(t,e,i=null){if(t==null||e==null)return null;if(gd==null||My==null)throw new G4;const s=gd._getTransformation(My,t,e,i,i==null?void 0:i.spatialReference);return s!==null?OL.fromGE(s):null}function UYe(t,e,i=null){if(gd==null||My==null)throw new G4;const s=gd._getTransformationBySuitability(My,t,e,i,i==null?void 0:i.spatialReference);if(s!==null){const n=[];for(const r of s)n.push(OL.fromGE(r));return n}return[]}let G4=class extends Se{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()")}};function VYe(){gd=null,My=null,sP=null,C3={}}const zYe={get loadPromise(){return sP}};function vM(t,e){try{const i=jy(t,e);if(i==null)return null;"xmin"in t&&"xmin"in i&&(i.zmin=t.zmin,i.zmax=t.zmax);const s=Hye(i.type,t.spatialReference,e);return s!=null&&s(i),i}catch(i){if(!(i instanceof G4))throw i;return null}}async function GYe(t,e,i){const s=t.spatialReference;return s!=null&&e!=null&&await dY(s,e,null,i),vM(t,e)}function Bm(t,e,i){return!i&&(!!$o(t,e)||rc(t)&&rc(e)&&!!Bye(t,e))}function BYe(t,e){if($o(t,e))return!0;if(!rc(t)||!rc(e))return!1;const i=l1(t)||yd(t)||kK(t),s=l1(e)||yd(e)||kK(e);return i&&s}async function dY(t,e,i,s){if(Hy())return SK(s);if(Array.isArray(t)){for(const{source:n,dest:r,geographicTransformation:o}of t)if(n&&r&&!Bm(n,r,o))return Ay(s)}else if(t&&e&&!Bm(t,e,i))return Ay(s);return SK(s)}function T3(t,e,i){return t?"x"in t?Zye(t,e,new ki,i,0):"xmin"in t?e0e(t,e,new Nn,i,0):"rings"in t?Jye(t,e,new Na,i,0):"paths"in t?Qye(t,e,new gu,i,0):"points"in t?Kye(t,e,new BM,i,0):null:null}function qYe(t,e,i=e.spatialReference,s=0){return i!=null&&t.spatialReference!=null&&Zye(t,t.spatialReference,e,i,s)!=null}function Zye(t,e,i,s,n){Ja[0]=t.x,Ja[1]=t.y;const r=t.z;return Ja[2]=r!==void 0?r:n,wA(Ja,e,0,Ja,s,0)?(i.x=Ja[0],i.y=Ja[1],i.spatialReference=s,r!==void 0||py(s)?(i.z=Ja[2],i.hasZ=!0):(i.z=void 0,i.hasZ=!1),t.m===void 0?(i.m=void 0,i.hasM=!1):(i.m=t.m,i.hasM=!0),i):null}function HYe(t,e,i=e.spatialReference,s=0){return t.spatialReference!=null&&i!=null&&Kye(t,t.spatialReference,e,i,s)!=null}function Kye(t,e,i,s,n){const{points:r,hasZ:o,hasM:a}=t,l=[],u=r.length,c=[];for(const d of r)c.push(d[0],d[1],o?d[2]:n);if(!wA(c,e,0,c,s,0,u))return null;const h=o||py(s);for(let d=0;d<u;++d){const m=3*d,f=c[m],_=c[m+1];h&&a?l.push([f,_,c[m+2],r[d][3]]):h?l.push([f,_,c[m+2]]):a?l.push([f,_,r[d][2]]):l.push([f,_])}return i.points=l,i.spatialReference=s,i.hasZ=o,i.hasM=a,i}function jYe(t,e,i=e.spatialReference,s=0){return t.spatialReference!=null&&i!=null&&Qye(t,t.spatialReference,e,i,s)!=null}function Qye(t,e,i,s,n){const{paths:r,hasZ:o,hasM:a}=t,l=[];if(!t0e(r,o??!1,a??!1,e,l,s,n))return null;const u=o||py(s);return i.paths=l,i.spatialReference=s,i.hasZ=u,i.hasM=a,i}function YYe(t,e,i=e.spatialReference,s=0){return t.spatialReference!=null&&i!=null&&Jye(t,t.spatialReference,e,i,s)!=null}function Jye(t,e,i,s,n){const{rings:r,hasZ:o,hasM:a}=t,l=[];if(!t0e(r,o??!1,a??!1,e,l,s,n))return null;const u=o||py(s);return i.rings=l,i.spatialReference=s,i.hasZ=u,i.hasM=a,i}function XYe(t,e,i=e.spatialReference,s=0){return t.spatialReference!=null&&i!=null&&e0e(t,t.spatialReference,e,i,s)!=null}function e0e(t,e,i,s,n){const{xmin:r,ymin:o,xmax:a,ymax:l,hasZ:u,hasM:c}=t,h=u?t.zmin:n;if(!Cse(r,o,h,e,Ja,s))return null;const d=u||py(s);i.xmin=Ja[0],i.ymin=Ja[1],d&&(i.zmin=Ja[2]);const m=u?t.zmax:n;return Cse(a,l,m,e,Ja,s)?(i.xmax=Ja[0],i.ymax=Ja[1],d&&(i.zmax=Ja[2]),c&&(i.mmin=t.mmin,i.mmax=t.mmax),i.spatialReference=s,i):null}function t0e(t,e,i,s,n,r,o=0){const a=new Array;for(const c of t)for(const h of c)a.push(h[0],h[1],e?h[2]:o);if(!wA(a,s,0,a,r,0))return!1;let l=0;n.length=0;const u=e||py(r);for(const c of t){const h=new Array;for(const d of c)u&&i?h.push([a[l++],a[l++],a[l++],d[3]]):u?h.push([a[l++],a[l++],a[l++]]):i?(h.push([a[l++],a[l++],d[2]]),l++):(h.push([a[l++],a[l++]]),l++);n.push(h)}return!0}const Ja=Fy(),lvt=Object.freeze(Object.defineProperty({__proto__:null,canProjectWithoutEngine:Bm,getTransformation:Wye,getTransformations:UYe,initializeProjection:dY,isEqualBaseGCS:BYe,isLoaded:Hy,isLoadedOrLoad:jye,isLoadedOrLoadFor:Yye,load:Ay,project:jy,projectExtent:XYe,projectMany:O8,projectMultipoint:HYe,projectOrLoad:$Ye,projectOrLoadMany:Xye,projectPoint:qYe,projectPolygon:YYe,projectPolyline:jYe,projectWithZConversion:GYe,projectWithoutEngine:T3,requiresLoad:kYe,test:zYe,tryProjectWithZConversion:vM,unload:VYe},Symbol.toStringTag,{value:"Module"}));var L8;let nm=L8=class extends it{constructor(t){super(t),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new L8({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}};y([S({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],nm.prototype,"cols",void 0),y([S({type:zs,json:{write:!0}})],nm.prototype,"level",void 0),y([S({type:String,json:{write:!0}})],nm.prototype,"levelValue",void 0),y([S({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],nm.prototype,"origin",void 0),y([S({type:Number,json:{write:!0}})],nm.prototype,"resolution",void 0),y([S({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],nm.prototype,"rows",void 0),y([S({type:Number,json:{write:!0}})],nm.prototype,"scale",void 0),nm=L8=y([se("esri.layers.support.LOD")],nm);const F_=nm;let WYe=class{constructor(e,i,s,n,r=void 0){this.id=e,this.level=i,this.row=s,this.col=n,this.extent=r}};var f_;const Tse=new gs({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});let Sa=f_=class extends it{static create(t={}){const{resolutionFactor:e=1,scales:i,size:s=256,spatialReference:n=Ri.WebMercator,numLODs:r=24}=t;if(!rc(n)){const h=[];if(i)for(let d=0;d<i.length;d++){const m=i[d];h.push(new F_({level:d,scale:m,resolution:m}))}else{let d=5e-4;for(let m=r-1;m>=0;m--)h.unshift(new F_({level:m,scale:d,resolution:d})),d*=2}return new f_({dpi:96,lods:h,origin:new ki(0,0,n),size:[s,s],spatialReference:n})}const o=Ol(n),a=t.origin?new ki({x:t.origin.x,y:t.origin.y,spatialReference:n}):new ki(o?{x:o.origin[0],y:o.origin[1],spatialReference:n}:{x:0,y:0,spatialReference:n}),l=96,u=1/(ah(n)*39.37*l),c=[];if(i)for(let h=0;h<i.length;h++){const d=i[h],m=d*u;c.push(new F_({level:h,scale:d,resolution:m}))}else{let h=Rf(n)?512/s*5916575275917094e-7:256/s*591657527591555e-6;const d=Math.ceil(r/e);c.push(new F_({level:0,scale:h,resolution:h*u}));for(let m=1;m<d;m++){const f=h/2**e,_=f*u;c.push(new F_({level:m,scale:f,resolution:_})),h=f}}return new f_({dpi:l,lods:c,origin:a,size:[s,s],spatialReference:n})}constructor(t){super(t),this.dpi=96,this.format=null,this.origin=null,this.size=null,this.spatialReference=null}get isWrappable(){const{spatialReference:t,origin:e}=this;if(t&&e){const i=Ol(t);return t.isWrappable&&!!i&&Math.abs(i.origin[0]-e.x)<=i.dx}return!1}readOrigin(t,e){return ki.fromJSON({spatialReference:e.spatialReference,...t})}set lods(t){let e=0,i=0;const s=[],n=this._levelToLOD={};t&&(e=-1/0,i=1/0,t.forEach(r=>{s.push(r.scale),e=r.scale>e?r.scale:e,i=r.scale<i?r.scale:i,n[r.level]=r})),this._set("scales",s),this._set("lods",t),this._initializeUpsampleLevels()}readSize(t,e){return[e.cols,e.rows]}writeSize(t,e){e.cols=t[0],e.rows=t[1]}zoomToScale(t){const e=this.scales;if(t<=0)return e[0];if(t>=e.length-1)return e[e.length-1];const i=Math.floor(t),s=i+1;return e[i]/(e[i]/e[s])**(t-i)}scaleToZoom(t){const e=this.scales,i=e.length-1;let s=0;for(;s<i;s++){const n=e[s],r=e[s+1];if(n<=t)return s;if(r===t)return s+1;if(n>t&&r<t)return s+Math.log(n/t)/Math.log(n/r)}return s}tileAt(t,e,i,s){const n=this.lodAt(t);if(!n)return null;let r,o;if(typeof e=="number")r=e,o=i;else if($o(e.spatialReference,this.spatialReference))r=e.x,o=e.y,s=i;else{const u=DF(e,this.spatialReference);if(u==null)return null;r=u.x,o=u.y,s=i}const a=n.resolution*this.size[0],l=n.resolution*this.size[1];return s||(s=new WYe(null,0,0,0,Dl())),s.level=t,s.row=Math.floor((this.origin.y-o)/l+.001),s.col=Math.floor((r-this.origin.x)/a+.001),this.updateTileInfo(s),s}updateTileInfo(t,e=f_.ExtrapolateOptions.NONE){let i=this.lodAt(t.level);if(!i&&e===f_.ExtrapolateOptions.POWER_OF_TWO){const o=this.lods[this.lods.length-1];o.level<t.level&&(i=o)}if(!i)return;const s=t.level-i.level,n=i.resolution*this.size[0]/2**s,r=i.resolution*this.size[1]/2**s;t.id=`${t.level}/${t.row}/${t.col}`,t.extent||(t.extent=Dl()),t.extent[0]=this.origin.x+t.col*n,t.extent[1]=this.origin.y-(t.row+1)*r,t.extent[2]=t.extent[0]+n,t.extent[3]=t.extent[1]+r}upsampleTile(t){const e=this._upsampleLevels[t.level];return!(!e||e.parentLevel===-1)&&(t.level=e.parentLevel,t.row=Math.floor(t.row/e.factor+.001),t.col=Math.floor(t.col/e.factor+.001),this.updateTileInfo(t),!0)}getTileBounds(t,e){const i=this.lodAt(e.level);if(i==null)return null;const{resolution:s}=i,n=s*this.size[0],r=s*this.size[1];return t[0]=this.origin.x+e.col*n,t[1]=this.origin.y-(e.row+1)*r,t[2]=t[0]+n,t[3]=t[1]+r,t}lodAt(t){var e;return((e=this._levelToLOD)==null?void 0:e[t])??null}clone(){return f_.fromJSON(this.write({}))}getCompatibleForVTL(t){if(this.size[0]!==this.size[1]||this.size[0]===256&&t===512)return null;const e=(this.size[0]===512&&t===256?-1:0)+(this.spatialReference.isGeographic?1:0);if(this.size[0]===t&&e===0)return this;const i=[],s=this.lods.length-e;for(let n=0;n<s;n++){const r=n+e,{scale:o,resolution:a}=r>=0?this.lods[r]:{scale:2*this.lods[0].scale,resolution:2*this.lods[0].resolution};i.push(new F_({level:n,scale:o,resolution:a}))}return new f_({size:[t,t],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:i})}_initializeUpsampleLevels(){const t=this.lods;this._upsampleLevels=[];let e=null;for(let i=0;i<t.length;i++){const s=t[i];this._upsampleLevels[s.level]={parentLevel:e?e.level:-1,factor:e?e.resolution/s.resolution:0},e=s}}};y([S({type:Number,json:{write:!0}})],Sa.prototype,"compressionQuality",void 0),y([S({type:Number,json:{write:!0}})],Sa.prototype,"dpi",void 0),y([S({type:String,json:{read:Tse.read,write:Tse.write,origins:{"web-scene":{read:!1,write:!1}}}})],Sa.prototype,"format",void 0),y([S({readOnly:!0})],Sa.prototype,"isWrappable",null),y([S({type:ki,json:{write:!0}})],Sa.prototype,"origin",void 0),y([mt("origin")],Sa.prototype,"readOrigin",null),y([S({type:[F_],value:null,json:{write:!0}})],Sa.prototype,"lods",null),y([S({readOnly:!0})],Sa.prototype,"scales",void 0),y([S({cast:t=>Array.isArray(t)?t:typeof t=="number"?[t,t]:[256,256]})],Sa.prototype,"size",void 0),y([mt("size",["rows","cols"])],Sa.prototype,"readSize",null),y([yt("size",{cols:{type:zs},rows:{type:zs}})],Sa.prototype,"writeSize",null),y([S({type:Ri,json:{write:!0}})],Sa.prototype,"spatialReference",void 0),Sa=f_=y([se("esri.layers.support.TileInfo")],Sa),function(t){var e;(e=t.ExtrapolateOptions||(t.ExtrapolateOptions={}))[e.NONE=0]="NONE",e[e.POWER_OF_TWO=1]="POWER_OF_TWO"}(Sa||(Sa={}));const ZYe=Sa,P3={widthBreakpoint:{getValue(t){const e=t.viewSize[0],i=t.breakpoints,s=this.values;return e<=i.xsmall?s.xsmall:e<=i.small?s.small:e<=i.medium?s.medium:e<=i.large?s.large:s.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(t){const e=t.viewSize[1],i=t.breakpoints,s=this.values;return e<=i.xsmall?s.xsmall:e<=i.small?s.small:e<=i.medium?s.medium:e<=i.large?s.large:s.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(t){const e=t.viewSize,i=e[0],s=e[1],n=this.values;return s>=i?n.portrait:n.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},X5={xsmall:544,small:768,medium:992,large:1200};function KYe(t){const e=t;return e&&e.xsmall<e.small&&e.small<e.medium&&e.medium<e.large}function W5(t,e){return e?P3[t].valueToClassName[e].split(" "):[]}const QYe=t=>{let e=class extends t{constructor(...i){super(...i),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=X5}initialize(){this.addHandles(Ai(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),nl))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(i){if(i!==this._get("breakpoints")){if(!KYe(i)){const s=JSON.stringify(X5,null,2);console.warn("provided breakpoints are not valid, using defaults:"+s),i=X5}this._set("breakpoints",{...i})}}_updateClassNames(){if(!this.container)return;const i=Il.acquire(),s=Il.acquire();let n,r=!1;for(n in P3){const o=this[n],a=P3[n].getValue({viewSize:this.size,breakpoints:this.breakpoints});o!==a&&(r=!0,this[n]=a,W5(n,o).forEach(l=>s.push(l)),W5(n,a).forEach(l=>i.push(l)))}r&&(this._applyClassNameChanges(i,s),Il.release(i),Il.release(s))}_applyClassNameChanges(i,s){const n=this.container;n&&(s.forEach(r=>n.classList.remove(r)),i.forEach(r=>n.classList.add(r)))}_removeActiveClassNames(){const i=this.container;if(!i)return;let s;for(s in P3)W5(s,this[s]).forEach(n=>i.classList.remove(n))}};return y([S()],e.prototype,"breakpoints",null),y([S()],e.prototype,"orientation",void 0),y([S()],e.prototype,"widthBreakpoint",void 0),y([S()],e.prototype,"heightBreakpoint",void 0),e=y([se("esri.views.BreakpointsOwner")],e),e};function mY(t){return typeof t=="string"?document.getElementById(t):t??null}function Pse(t,e){for(;;){const i=t.firstChild;if(!i)break;e.appendChild(i)}}let i1=class extends ei{constructor(){super(...arguments),this.updating=!1,this._handleId=0,this._scheduleHandleId=0,this._pendingPromises=new Set}destroy(){this.removeAll()}add(e,i,s={}){return this._installWatch(e,i,s,Ai)}addWhen(e,i,s={}){return this._installWatch(e,i,s,nh)}addOnCollectionChange(e,i,{initial:s=!1,final:n=!1}={}){const r=++this._handleId;return this.addHandles([yy(e,"after-changes",this._createSyncUpdatingCallback(),km),yy(e,"change",i,{onListenerAdd:s?o=>i({added:o.toArray(),removed:[]}):void 0,onListenerRemove:n?o=>i({added:[],removed:o.toArray()}):void 0})],r),Gs(()=>this.removeHandles(r))}addPromise(e){if(e==null)return e;const i=++this._handleId;this.addHandles(Gs(()=>{this._pendingPromises.delete(e)&&(this._pendingPromises.size!==0||this.hasHandles(VN)||this._set("updating",!1))}),i),this._pendingPromises.add(e),this._set("updating",!0);const s=()=>this.removeHandles(i);return e.then(s,s),e}removeAll(){this._pendingPromises.clear(),this.removeAllHandles(),this._set("updating",!1)}_installWatch(e,i,s={},n){const r=++this._handleId;s.sync||this._installSyncUpdatingWatch(e,r);const o=n(e,i,s);return this.addHandles(o,r),Gs(()=>this.removeHandles(r))}_installSyncUpdatingWatch(e,i){const s=this._createSyncUpdatingCallback(),n=Ai(e,s,{sync:!0,equals:()=>!1});return this.addHandles(n,i),n}_createSyncUpdatingCallback(){return()=>{this.removeHandles(VN),++this._scheduleHandleId;const e=this._scheduleHandleId;this._get("updating")||this._set("updating",!0),this.addHandles(VM(()=>{e===this._scheduleHandleId&&(this._set("updating",this._pendingPromises.size>0),this.removeHandles(VN))}),VN)}}};y([S({readOnly:!0})],i1.prototype,"updating",void 0),i1=y([se("esri.core.support.UpdatingHandles")],i1);const VN=-42;/*!
 * @esri/arcgis-html-sanitizer - v4.1.0 - Tue Dec 03 2024 09:13:28 GMT-0500 (Eastern Standard Time)
 * Copyright (c) 2024 - Environmental Systems Research Institute, Inc.
 * Apache-2.0
 * 
 * js-xss
 * Copyright (c) 2012-2018 Zongmin Lei(雷宗民) <leizongmin@gmail.com>
 * http://ucdok.com
 * MIT License, see https://github.com/leizongmin/js-xss/blob/master/LICENSE for details
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var LL=function(){return LL=Object.assign||function(e){for(var i,s=1,n=arguments.length;s<n;s++){i=arguments[s];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},LL.apply(this,arguments)},F8={exports:{}},Ar={},k8={exports:{}},Y1={};function i0e(){var t={};return t["align-content"]=!1,t["align-items"]=!1,t["align-self"]=!1,t["alignment-adjust"]=!1,t["alignment-baseline"]=!1,t.all=!1,t["anchor-point"]=!1,t.animation=!1,t["animation-delay"]=!1,t["animation-direction"]=!1,t["animation-duration"]=!1,t["animation-fill-mode"]=!1,t["animation-iteration-count"]=!1,t["animation-name"]=!1,t["animation-play-state"]=!1,t["animation-timing-function"]=!1,t.azimuth=!1,t["backface-visibility"]=!1,t.background=!0,t["background-attachment"]=!0,t["background-clip"]=!0,t["background-color"]=!0,t["background-image"]=!0,t["background-origin"]=!0,t["background-position"]=!0,t["background-repeat"]=!0,t["background-size"]=!0,t["baseline-shift"]=!1,t.binding=!1,t.bleed=!1,t["bookmark-label"]=!1,t["bookmark-level"]=!1,t["bookmark-state"]=!1,t.border=!0,t["border-bottom"]=!0,t["border-bottom-color"]=!0,t["border-bottom-left-radius"]=!0,t["border-bottom-right-radius"]=!0,t["border-bottom-style"]=!0,t["border-bottom-width"]=!0,t["border-collapse"]=!0,t["border-color"]=!0,t["border-image"]=!0,t["border-image-outset"]=!0,t["border-image-repeat"]=!0,t["border-image-slice"]=!0,t["border-image-source"]=!0,t["border-image-width"]=!0,t["border-left"]=!0,t["border-left-color"]=!0,t["border-left-style"]=!0,t["border-left-width"]=!0,t["border-radius"]=!0,t["border-right"]=!0,t["border-right-color"]=!0,t["border-right-style"]=!0,t["border-right-width"]=!0,t["border-spacing"]=!0,t["border-style"]=!0,t["border-top"]=!0,t["border-top-color"]=!0,t["border-top-left-radius"]=!0,t["border-top-right-radius"]=!0,t["border-top-style"]=!0,t["border-top-width"]=!0,t["border-width"]=!0,t.bottom=!1,t["box-decoration-break"]=!0,t["box-shadow"]=!0,t["box-sizing"]=!0,t["box-snap"]=!0,t["box-suppress"]=!0,t["break-after"]=!0,t["break-before"]=!0,t["break-inside"]=!0,t["caption-side"]=!1,t.chains=!1,t.clear=!0,t.clip=!1,t["clip-path"]=!1,t["clip-rule"]=!1,t.color=!0,t["color-interpolation-filters"]=!0,t["column-count"]=!1,t["column-fill"]=!1,t["column-gap"]=!1,t["column-rule"]=!1,t["column-rule-color"]=!1,t["column-rule-style"]=!1,t["column-rule-width"]=!1,t["column-span"]=!1,t["column-width"]=!1,t.columns=!1,t.contain=!1,t.content=!1,t["counter-increment"]=!1,t["counter-reset"]=!1,t["counter-set"]=!1,t.crop=!1,t.cue=!1,t["cue-after"]=!1,t["cue-before"]=!1,t.cursor=!1,t.direction=!1,t.display=!0,t["display-inside"]=!0,t["display-list"]=!0,t["display-outside"]=!0,t["dominant-baseline"]=!1,t.elevation=!1,t["empty-cells"]=!1,t.filter=!1,t.flex=!1,t["flex-basis"]=!1,t["flex-direction"]=!1,t["flex-flow"]=!1,t["flex-grow"]=!1,t["flex-shrink"]=!1,t["flex-wrap"]=!1,t.float=!1,t["float-offset"]=!1,t["flood-color"]=!1,t["flood-opacity"]=!1,t["flow-from"]=!1,t["flow-into"]=!1,t.font=!0,t["font-family"]=!0,t["font-feature-settings"]=!0,t["font-kerning"]=!0,t["font-language-override"]=!0,t["font-size"]=!0,t["font-size-adjust"]=!0,t["font-stretch"]=!0,t["font-style"]=!0,t["font-synthesis"]=!0,t["font-variant"]=!0,t["font-variant-alternates"]=!0,t["font-variant-caps"]=!0,t["font-variant-east-asian"]=!0,t["font-variant-ligatures"]=!0,t["font-variant-numeric"]=!0,t["font-variant-position"]=!0,t["font-weight"]=!0,t.grid=!1,t["grid-area"]=!1,t["grid-auto-columns"]=!1,t["grid-auto-flow"]=!1,t["grid-auto-rows"]=!1,t["grid-column"]=!1,t["grid-column-end"]=!1,t["grid-column-start"]=!1,t["grid-row"]=!1,t["grid-row-end"]=!1,t["grid-row-start"]=!1,t["grid-template"]=!1,t["grid-template-areas"]=!1,t["grid-template-columns"]=!1,t["grid-template-rows"]=!1,t["hanging-punctuation"]=!1,t.height=!0,t.hyphens=!1,t.icon=!1,t["image-orientation"]=!1,t["image-resolution"]=!1,t["ime-mode"]=!1,t["initial-letters"]=!1,t["inline-box-align"]=!1,t["justify-content"]=!1,t["justify-items"]=!1,t["justify-self"]=!1,t.left=!1,t["letter-spacing"]=!0,t["lighting-color"]=!0,t["line-box-contain"]=!1,t["line-break"]=!1,t["line-grid"]=!1,t["line-height"]=!1,t["line-snap"]=!1,t["line-stacking"]=!1,t["line-stacking-ruby"]=!1,t["line-stacking-shift"]=!1,t["line-stacking-strategy"]=!1,t["list-style"]=!0,t["list-style-image"]=!0,t["list-style-position"]=!0,t["list-style-type"]=!0,t.margin=!0,t["margin-bottom"]=!0,t["margin-left"]=!0,t["margin-right"]=!0,t["margin-top"]=!0,t["marker-offset"]=!1,t["marker-side"]=!1,t.marks=!1,t.mask=!1,t["mask-box"]=!1,t["mask-box-outset"]=!1,t["mask-box-repeat"]=!1,t["mask-box-slice"]=!1,t["mask-box-source"]=!1,t["mask-box-width"]=!1,t["mask-clip"]=!1,t["mask-image"]=!1,t["mask-origin"]=!1,t["mask-position"]=!1,t["mask-repeat"]=!1,t["mask-size"]=!1,t["mask-source-type"]=!1,t["mask-type"]=!1,t["max-height"]=!0,t["max-lines"]=!1,t["max-width"]=!0,t["min-height"]=!0,t["min-width"]=!0,t["move-to"]=!1,t["nav-down"]=!1,t["nav-index"]=!1,t["nav-left"]=!1,t["nav-right"]=!1,t["nav-up"]=!1,t["object-fit"]=!1,t["object-position"]=!1,t.opacity=!1,t.order=!1,t.orphans=!1,t.outline=!1,t["outline-color"]=!1,t["outline-offset"]=!1,t["outline-style"]=!1,t["outline-width"]=!1,t.overflow=!1,t["overflow-wrap"]=!1,t["overflow-x"]=!1,t["overflow-y"]=!1,t.padding=!0,t["padding-bottom"]=!0,t["padding-left"]=!0,t["padding-right"]=!0,t["padding-top"]=!0,t.page=!1,t["page-break-after"]=!1,t["page-break-before"]=!1,t["page-break-inside"]=!1,t["page-policy"]=!1,t.pause=!1,t["pause-after"]=!1,t["pause-before"]=!1,t.perspective=!1,t["perspective-origin"]=!1,t.pitch=!1,t["pitch-range"]=!1,t["play-during"]=!1,t.position=!1,t["presentation-level"]=!1,t.quotes=!1,t["region-fragment"]=!1,t.resize=!1,t.rest=!1,t["rest-after"]=!1,t["rest-before"]=!1,t.richness=!1,t.right=!1,t.rotation=!1,t["rotation-point"]=!1,t["ruby-align"]=!1,t["ruby-merge"]=!1,t["ruby-position"]=!1,t["shape-image-threshold"]=!1,t["shape-outside"]=!1,t["shape-margin"]=!1,t.size=!1,t.speak=!1,t["speak-as"]=!1,t["speak-header"]=!1,t["speak-numeral"]=!1,t["speak-punctuation"]=!1,t["speech-rate"]=!1,t.stress=!1,t["string-set"]=!1,t["tab-size"]=!1,t["table-layout"]=!1,t["text-align"]=!0,t["text-align-last"]=!0,t["text-combine-upright"]=!0,t["text-decoration"]=!0,t["text-decoration-color"]=!0,t["text-decoration-line"]=!0,t["text-decoration-skip"]=!0,t["text-decoration-style"]=!0,t["text-emphasis"]=!0,t["text-emphasis-color"]=!0,t["text-emphasis-position"]=!0,t["text-emphasis-style"]=!0,t["text-height"]=!0,t["text-indent"]=!0,t["text-justify"]=!0,t["text-orientation"]=!0,t["text-overflow"]=!0,t["text-shadow"]=!0,t["text-space-collapse"]=!0,t["text-transform"]=!0,t["text-underline-position"]=!0,t["text-wrap"]=!0,t.top=!1,t.transform=!1,t["transform-origin"]=!1,t["transform-style"]=!1,t.transition=!1,t["transition-delay"]=!1,t["transition-duration"]=!1,t["transition-property"]=!1,t["transition-timing-function"]=!1,t["unicode-bidi"]=!1,t["vertical-align"]=!1,t.visibility=!1,t["voice-balance"]=!1,t["voice-duration"]=!1,t["voice-family"]=!1,t["voice-pitch"]=!1,t["voice-range"]=!1,t["voice-rate"]=!1,t["voice-stress"]=!1,t["voice-volume"]=!1,t.volume=!1,t["white-space"]=!1,t.widows=!1,t.width=!0,t["will-change"]=!1,t["word-break"]=!0,t["word-spacing"]=!0,t["word-wrap"]=!0,t["wrap-flow"]=!1,t["wrap-through"]=!1,t["writing-mode"]=!1,t["z-index"]=!1,t}function JYe(t,e,i){}function eXe(t,e,i){}var tXe=/javascript\s*\:/img;function iXe(t,e){return tXe.test(e)?"":e}Y1.whiteList=i0e();Y1.getDefaultWhiteList=i0e;Y1.onAttr=JYe;Y1.onIgnoreAttr=eXe;Y1.safeAttrValue=iXe;var sXe={indexOf:function(t,e){var i,s;if(Array.prototype.indexOf)return t.indexOf(e);for(i=0,s=t.length;i<s;i++)if(t[i]===e)return i;return-1},forEach:function(t,e,i){var s,n;if(Array.prototype.forEach)return t.forEach(e,i);for(s=0,n=t.length;s<n;s++)e.call(i,t[s],s,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(t){return String.prototype.trimRight?t.trimRight():t.replace(/(\s*$)/g,"")}},Z2=sXe;function nXe(t,e){t=Z2.trimRight(t),t[t.length-1]!==";"&&(t+=";");var i=t.length,s=!1,n=0,r=0,o="";function a(){if(!s){var c=Z2.trim(t.slice(n,r)),h=c.indexOf(":");if(h!==-1){var d=Z2.trim(c.slice(0,h)),m=Z2.trim(c.slice(h+1));if(d){var f=e(n,o.length,d,m,c);f&&(o+=f+"; ")}}}n=r+1}for(;r<i;r++){var l=t[r];if(l==="/"&&t[r+1]==="*"){var u=t.indexOf("*/",r+2);if(u===-1)break;r=u+1,n=r+1,s=!1}else l==="("?s=!0:l===")"?s=!1:l===";"?s||a():l===`
`&&a()}return Z2.trim(o)}var rXe=nXe,zN=Y1,oXe=rXe;function Mse(t){return t==null}function aXe(t){var e={};for(var i in t)e[i]=t[i];return e}function s0e(t){t=aXe(t||{}),t.whiteList=t.whiteList||zN.whiteList,t.onAttr=t.onAttr||zN.onAttr,t.onIgnoreAttr=t.onIgnoreAttr||zN.onIgnoreAttr,t.safeAttrValue=t.safeAttrValue||zN.safeAttrValue,this.options=t}s0e.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,i=e.options,s=i.whiteList,n=i.onAttr,r=i.onIgnoreAttr,o=i.safeAttrValue,a=oXe(t,function(l,u,c,h,d){var m=s[c],f=!1;if(m===!0?f=m:typeof m=="function"?f=m(h):m instanceof RegExp&&(f=m.test(h)),f!==!0&&(f=!1),h=o(c,h),!!h){var _={position:u,sourcePosition:l,source:d,isWhite:f};if(f){var v=n(c,h,_);return Mse(v)?c+":"+h:v}else{var v=r(c,h,_);if(!Mse(v))return v}}});return a};var lXe=s0e;(function(t,e){var i=Y1,s=lXe;function n(o,a){var l=new s(a);return l.process(o)}e=t.exports=n,e.FilterCSS=s;for(var r in i)e[r]=i[r]})(k8,k8.exports);var pY=k8.exports,fY={indexOf:function(t,e){var i,s;if(Array.prototype.indexOf)return t.indexOf(e);for(i=0,s=t.length;i<s;i++)if(t[i]===e)return i;return-1},forEach:function(t,e,i){var s,n;if(Array.prototype.forEach)return t.forEach(e,i);for(s=0,n=t.length;s<n;s++)e.call(i,t[s],s,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(t){var e=/\s|\n|\t/,i=e.exec(t);return i?i.index:-1}},uXe=pY.FilterCSS,cXe=pY.getDefaultWhiteList,FL=fY;function n0e(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var r0e=new uXe;function hXe(t,e,i){}function dXe(t,e,i){}function mXe(t,e,i){}function pXe(t,e,i){}function o0e(t){return t.replace(gXe,"&lt;").replace(_Xe,"&gt;")}function fXe(t,e,i,s){if(i=d0e(i),e==="href"||e==="src"){if(i=FL.trim(i),i==="#")return"#";if(!(i.substr(0,7)==="http://"||i.substr(0,8)==="https://"||i.substr(0,7)==="mailto:"||i.substr(0,4)==="tel:"||i.substr(0,11)==="data:image/"||i.substr(0,6)==="ftp://"||i.substr(0,2)==="./"||i.substr(0,3)==="../"||i[0]==="#"||i[0]==="/"))return""}else if(e==="background"){if(GN.lastIndex=0,GN.test(i))return""}else if(e==="style"){if(Ase.lastIndex=0,Ase.test(i)||(Ise.lastIndex=0,Ise.test(i)&&(GN.lastIndex=0,GN.test(i))))return"";s!==!1&&(s=s||r0e,i=s.process(i))}return i=m0e(i),i}var gXe=/</g,_Xe=/>/g,yXe=/"/g,vXe=/&quot;/g,xXe=/&#([a-zA-Z0-9]*);?/gim,bXe=/&colon;?/gim,wXe=/&newline;?/gim,GN=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,Ase=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,Ise=/u\s*r\s*l\s*\(.*/gi;function a0e(t){return t.replace(yXe,"&quot;")}function l0e(t){return t.replace(vXe,'"')}function u0e(t){return t.replace(xXe,function(i,s){return s[0]==="x"||s[0]==="X"?String.fromCharCode(parseInt(s.substr(1),16)):String.fromCharCode(parseInt(s,10))})}function c0e(t){return t.replace(bXe,":").replace(wXe," ")}function h0e(t){for(var e="",i=0,s=t.length;i<s;i++)e+=t.charCodeAt(i)<32?" ":t.charAt(i);return FL.trim(e)}function d0e(t){return t=l0e(t),t=u0e(t),t=c0e(t),t=h0e(t),t}function m0e(t){return t=a0e(t),t=o0e(t),t}function SXe(){return""}function EXe(t,e){typeof e!="function"&&(e=function(){});var i=!Array.isArray(t);function s(o){return i?!0:FL.indexOf(t,o)!==-1}var n=[],r=!1;return{onIgnoreTag:function(o,a,l){if(s(o))if(l.isClosing){var u="[/removed]",c=l.position+u.length;return n.push([r!==!1?r:l.position,c]),r=!1,u}else return r||(r=l.position),"[removed]";else return e(o,a,l)},remove:function(o){var a="",l=0;return FL.forEach(n,function(u){a+=o.slice(l,u[0]),l=u[1]}),a+=o.slice(l),a}}}function CXe(t){for(var e="",i=0;i<t.length;){var s=t.indexOf("<!--",i);if(s===-1){e+=t.slice(i);break}e+=t.slice(i,s);var n=t.indexOf("-->",s);if(n===-1)break;i=n+3}return e}function TXe(t){var e=t.split("");return e=e.filter(function(i){var s=i.charCodeAt(0);return s===127?!1:s<=31?s===10||s===13:!0}),e.join("")}Ar.whiteList=n0e();Ar.getDefaultWhiteList=n0e;Ar.onTag=hXe;Ar.onIgnoreTag=dXe;Ar.onTagAttr=mXe;Ar.onIgnoreTagAttr=pXe;Ar.safeAttrValue=fXe;Ar.escapeHtml=o0e;Ar.escapeQuote=a0e;Ar.unescapeQuote=l0e;Ar.escapeHtmlEntities=u0e;Ar.escapeDangerHtml5Entities=c0e;Ar.clearNonPrintableCharacter=h0e;Ar.friendlyAttrValue=d0e;Ar.escapeAttrValue=m0e;Ar.onIgnoreTagStripAll=SXe;Ar.StripTagBody=EXe;Ar.stripCommentTag=CXe;Ar.stripBlankChar=TXe;Ar.cssFilter=r0e;Ar.getDefaultCSSWhiteList=cXe;var B4={},k_=fY;function PXe(t){var e=k_.spaceIndex(t),i;return e===-1?i=t.slice(1,-1):i=t.slice(1,e+1),i=k_.trim(i).toLowerCase(),i.slice(0,1)==="/"&&(i=i.slice(1)),i.slice(-1)==="/"&&(i=i.slice(0,-1)),i}function MXe(t){return t.slice(0,2)==="</"}function AXe(t,e,i){var s="",n=0,r=!1,o=!1,a=0,l=t.length,u="",c="";e:for(a=0;a<l;a++){var h=t.charAt(a);if(r===!1){if(h==="<"){r=a;continue}}else if(o===!1){if(h==="<"){s+=i(t.slice(n,a)),r=a,n=a;continue}if(h===">"){s+=i(t.slice(n,r)),c=t.slice(r,a+1),u=PXe(c),s+=e(r,s.length,u,c,MXe(c)),n=a+1,r=!1;continue}if(h==='"'||h==="'")for(var d=1,m=t.charAt(a-d);m.trim()===""||m==="=";){if(m==="="){o=h;continue e}m=t.charAt(a-++d)}}else if(h===o){o=!1;continue}}return n<t.length&&(s+=i(t.substr(n))),s}var IXe=/[^a-zA-Z0-9\\_:.-]/gim;function DXe(t,e){var i=0,s=0,n=[],r=!1,o=t.length;function a(d,m){if(d=k_.trim(d),d=d.replace(IXe,"").toLowerCase(),!(d.length<1)){var f=e(d,m||"");f&&n.push(f)}}for(var l=0;l<o;l++){var u=t.charAt(l),c,h;if(r===!1&&u==="="){r=t.slice(i,l),i=l+1,s=t.charAt(i)==='"'||t.charAt(i)==="'"?i:RXe(t,l+1);continue}if(r!==!1&&l===s){if(h=t.indexOf(u,l+1),h===-1)break;c=k_.trim(t.slice(s+1,h)),a(r,c),r=!1,l=h,i=l+1;continue}if(/\s|\n|\t/.test(u))if(t=t.replace(/\s|\n|\t/g," "),r===!1)if(h=NXe(t,l),h===-1){c=k_.trim(t.slice(i,l)),a(c),r=!1,i=l+1;continue}else{l=h-1;continue}else if(h=OXe(t,l-1),h===-1){c=k_.trim(t.slice(i,l)),c=Dse(c),a(r,c),r=!1,i=l+1;continue}else continue}return i<t.length&&(r===!1?a(t.slice(i)):a(r,Dse(k_.trim(t.slice(i))))),k_.trim(n.join(" "))}function NXe(t,e){for(;e<t.length;e++){var i=t[e];if(i!==" ")return i==="="?e:-1}}function RXe(t,e){for(;e<t.length;e++){var i=t[e];if(i!==" ")return i==="'"||i==='"'?e:-1}}function OXe(t,e){for(;e>0;e--){var i=t[e];if(i!==" ")return i==="="?e:-1}}function LXe(t){return t[0]==='"'&&t[t.length-1]==='"'||t[0]==="'"&&t[t.length-1]==="'"}function Dse(t){return LXe(t)?t.substr(1,t.length-2):t}B4.parseTag=AXe;B4.parseAttr=DXe;var FXe=pY.FilterCSS,Kh=Ar,p0e=B4,kXe=p0e.parseTag,$Xe=p0e.parseAttr,M3=fY;function BN(t){return t==null}function UXe(t){var e=M3.spaceIndex(t);if(e===-1)return{html:"",closing:t[t.length-2]==="/"};t=M3.trim(t.slice(e+1,-1));var i=t[t.length-1]==="/";return i&&(t=M3.trim(t.slice(0,-1))),{html:t,closing:i}}function VXe(t){var e={};for(var i in t)e[i]=t[i];return e}function zXe(t){var e={};for(var i in t)Array.isArray(t[i])?e[i.toLowerCase()]=t[i].map(function(s){return s.toLowerCase()}):e[i.toLowerCase()]=t[i];return e}function f0e(t){t=VXe(t||{}),t.stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=Kh.onIgnoreTagStripAll),t.whiteList||t.allowList?t.whiteList=zXe(t.whiteList||t.allowList):t.whiteList=Kh.whiteList,t.onTag=t.onTag||Kh.onTag,t.onTagAttr=t.onTagAttr||Kh.onTagAttr,t.onIgnoreTag=t.onIgnoreTag||Kh.onIgnoreTag,t.onIgnoreTagAttr=t.onIgnoreTagAttr||Kh.onIgnoreTagAttr,t.safeAttrValue=t.safeAttrValue||Kh.safeAttrValue,t.escapeHtml=t.escapeHtml||Kh.escapeHtml,this.options=t,t.css===!1?this.cssFilter=!1:(t.css=t.css||{},this.cssFilter=new FXe(t.css))}f0e.prototype.process=function(t){if(t=t||"",t=t.toString(),!t)return"";var e=this,i=e.options,s=i.whiteList,n=i.onTag,r=i.onIgnoreTag,o=i.onTagAttr,a=i.onIgnoreTagAttr,l=i.safeAttrValue,u=i.escapeHtml,c=e.cssFilter;i.stripBlankChar&&(t=Kh.stripBlankChar(t)),i.allowCommentTag||(t=Kh.stripCommentTag(t));var h=!1;i.stripIgnoreTagBody&&(h=Kh.StripTagBody(i.stripIgnoreTagBody,r),r=h.onIgnoreTag);var d=kXe(t,function(m,f,_,v,x){var w={sourcePosition:m,position:f,isClosing:x,isWhite:Object.prototype.hasOwnProperty.call(s,_)},T=n(_,v,w);if(!BN(T))return T;if(w.isWhite){if(w.isClosing)return"</"+_+">";var C=UXe(v),M=s[_],A=$Xe(C.html,function(I,L){var D=M3.indexOf(M,I)!==-1,O=o(_,I,L,D);return BN(O)?D?(L=l(_,I,L,c),L?I+'="'+L+'"':I):(O=a(_,I,L,D),BN(O)?void 0:O):O});return v="<"+_,A&&(v+=" "+A),C.closing&&(v+=" /"),v+=">",v}else return T=r(_,v,w),BN(T)?u(v):T},u);return h&&(d=h.remove(d)),d};var GXe=f0e;(function(t,e){var i=Ar,s=B4,n=GXe;function r(a,l){var u=new n(l);return u.process(a)}e=t.exports=r,e.filterXSS=r,e.FilterXSS=n,function(){for(var a in i)e[a]=i[a];for(var l in s)e[l]=s[l]}();function o(){return typeof self<"u"&&typeof DedicatedWorkerGlobalScope<"u"&&self instanceof DedicatedWorkerGlobalScope}o()&&(self.filterXSS=t.exports)})(F8,F8.exports);var nb=F8.exports,BXe=function(t){if(typeof t!="object"||t===null||Object.prototype.toString.call(t)!=="[object Object]")return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},qXe=function(){function t(e,i){var s=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],article:["style"],aside:["style"],audio:["autoplay","controls","loop","muted","preload"],b:[],blockquote:["style"],br:[],code:["style"],dd:["style"],del:["style"],details:["open","style"],div:["align","aria-hidden","aria-label","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],footer:["style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],header:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],main:["style"],mark:["style"],nav:["style"],ol:[],p:["style"],pre:["style"],section:["style"],source:["media","src","type"],span:["aria-hidden","aria-label","style"],strong:[],sub:["style"],summary:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],time:["style"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]},this.arcgisCSSWhiteList=LL(LL({},nb.getDefaultCSSWhiteList()),{"align-items":!0,"align-self":!0,flex:!0,"flex-basis":!0,"flex-direction":!0,"flex-flow":!0,"flex-grow":!0,"flex-shrink":!0,"flex-wrap":!0,float:!0,gap:!0,grid:!0,"grid-area":!0,"grid-auto-columns":!0,"grid-auto-flow":!0,"grid-auto-rows":!0,"grid-column":!0,"grid-column-end":!0,"grid-column-start":!0,"grid-row":!0,"grid-row-end":!0,"grid-row-start":!0,"grid-template":!0,"grid-template-areas":!0,"grid-template-columns":!0,"grid-template-rows":!0,"justify-content":!0,"justify-items":!0,"justify-self":!0,"line-height":!0,overflow:!0}),this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(r,o,a,l){return r==="a"&&o==="href"||(r==="img"||r==="source")&&o==="src"?s.sanitizeUrl(a):nb.safeAttrValue(r,o,a,l)}},this._entityMap={"&":"&#x38;","<":"&#x3C;",">":"&#x3E;",'"':"&#x22;","'":"&#x27;","/":"&#x2F;"};var n;e&&!i?n=e:e&&i?(n=Object.create(this.arcgisFilterOptions),n.css={whiteList:this.arcgisCSSWhiteList},Object.keys(e).forEach(function(r){if(r==="whiteList")n.whiteList=s._extendObjectOfArrays([s.arcgisWhiteList,e.whiteList||{}]);else if(r==="css"){var o=e.css.whiteList;o!=null&&e.css instanceof Object&&Object.keys(o).forEach(function(a){return n.css.whiteList[a]=o[a]})}else n[r]=e[r]})):(n=Object.create(this.arcgisFilterOptions),n.whiteList=this.arcgisWhiteList,n.css={whiteList:this.arcgisCSSWhiteList}),this.xssFilterOptions=n,this._xssFilter=new nb.FilterXSS(n)}return t.prototype.sanitize=function(e,i){switch(i===void 0&&(i={}),typeof e){case"number":return isNaN(e)||!isFinite(e)?null:e;case"boolean":return e;case"string":return this._xssFilter.process(e);case"object":return this._iterateOverObject(e,i);default:return i.allowUndefined&&typeof e>"u"?void 0:null}},t.prototype.sanitizeUrl=function(e,i){var s=(i??{}).isProtocolRequired,n=s===void 0?!0:s,r=this._trim(e.substring(0,e.indexOf(":"))),o=e==="/",a=/^#/.test(e),l=r&&this.allowedProtocols.indexOf(r.toLowerCase())>-1;return o||a||l?nb.escapeAttrValue(e):!r&&!n?nb.escapeAttrValue("https://".concat(e)):""},t.prototype.sanitizeHTMLAttribute=function(e,i,s,n){return typeof this.xssFilterOptions.safeAttrValue=="function"?this.xssFilterOptions.safeAttrValue(e,i,s,n):nb.safeAttrValue(e,i,s,n)},t.prototype.validate=function(e,i){i===void 0&&(i={});var s=this.sanitize(e,i);return{isValid:e===s,sanitized:s}},t.prototype.encodeHTML=function(e){var i=this;return String(e).replace(/[&<>"'\/]/g,function(s){return i._entityMap[s]})},t.prototype.encodeAttrValue=function(e){var i=/^[a-zA-Z0-9]$/;return String(e).replace(/[\x00-\xFF]/g,function(s,n){return i.test(s)?s:"&#x".concat(Number(e.charCodeAt(n)).toString(16),";")})},t.prototype._extendObjectOfArrays=function(e){var i={};return e.forEach(function(s){Object.keys(s).forEach(function(n){Array.isArray(s[n])&&Array.isArray(i[n])?i[n]=i[n].concat(s[n]):i[n]=s[n]})}),i},t.prototype._iterateOverObject=function(e,i){var s=this;i===void 0&&(i={});try{var n=!1,r=void 0;if(Array.isArray(e))r=e.reduce(function(a,l){var u=s.validate(l,i);return u.isValid?a.concat([l]):(n=!0,a.concat([u.sanitized]))},[]);else if(BXe(e)){var o=Object.keys(e);r=o.reduce(function(a,l){var u=e[l],c=s.validate(u,i);return c.isValid?a[l]=u:(n=!0,a[l]=c.sanitized),a},{})}else return i.allowUndefined&&typeof e>"u"?void 0:null;return n?r:e}catch{return null}},t.prototype._trim=function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},t}();const q4=new Map;function g0e(){q4.clear()}function HXe(t){return q4.get(t)}function jXe(t,e){q4.set(t,e)}function Z5(t){q4.delete(t)}function YXe(...t){const e=Il.acquire();for(let s=0;s<t.length;s++){const n=t[s],r=typeof n;if(r==="string")e.push(n);else if(Array.isArray(n))e.push.apply(e,n);else if(r==="object")for(const o in n)n[o]&&e.push(o)}const i=e.join(" ");return Il.release(e),i}(()=>{const t=new Map,e=new ResizeObserver(s=>{var n;g0e();for(const r of s)(n=t.get(r.target))==null||n(r)}),i=(s,n,r)=>(t.set(s,n),e.observe(s,r),Gs(()=>{e.unobserve(s),t.delete(s)}));return(s,n,r)=>{let o=null;return LM([Ai(()=>typeof s=="function"?s():s,a=>{o==null||o.remove(),a&&(o=i(a,n,r))},uu),Gs(()=>o==null?void 0:o.remove())])}})();function XXe(t){const e=t==null?void 0:t.closest("[dir]");return e!==null&&e instanceof HTMLElement&&e.dir==="rtl"||document.dir==="rtl"}function hvt(t){const e="data-node-ref";this[t.getAttribute(e)]=null}function dvt(t){const e="data-node-ref";this[t.getAttribute(e)]=t}const WXe=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"],ZXe=WXe.reduce((t,e)=>(t[e]=[],t),{}),KXe=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","d","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],_0e=new qXe({whiteList:ZXe,onTagAttr:(t,e,i)=>{const s=`${e}="${i}"`;if(KXe.includes(e))return s},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0);function QXe(t){return t==="Enter"||t===" "}async function JXe(t,e){await G2e(UM(e));const i=typeof t=="function"?t():t;i&&("setFocus"in i&&typeof i.setFocus=="function"?await i.setFocus():i instanceof HTMLElement&&i.focus())}const y0e="http://www.w3.org/",H4=`${y0e}2000/svg`,v0e=`${y0e}1999/xlink`;let Nse=[],gY=(t,e)=>{let i={};return Object.keys(t).forEach(s=>{i[s]=t[s]}),e&&Object.keys(e).forEach(s=>{i[s]=e[s]}),i},_Y=(t,e)=>t.vnodeSelector===e.vnodeSelector&&(t.properties&&e.properties?t.properties.key===e.properties.key&&t.properties.bind===e.properties.bind:!t.properties&&!e.properties),x0e=t=>{if(typeof t!="string")throw new Error("Style values must be strings")},eWe=(t,e,i)=>{if(e.vnodeSelector!==""){for(let s=i;s<t.length;s++)if(_Y(t[s],e))return s}return-1},K5=(t,e,i,s)=>{let n=t[e];if(n.vnodeSelector==="")return;let r=n.properties;if(!(r&&(r.key===void 0?r.bind:r.key))){for(let o=0;o<t.length;o++)if(o!==e){let a=t[o];if(_Y(a,n))throw new Error(`${i.vnodeSelector} had a ${n.vnodeSelector} child ${s==="added"?s:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}}},tWe=t=>{if(t.properties){let e=t.properties.enterAnimation;e&&e(t.domNode,t.properties)}},$8=[],U8=!1,b0e=t=>{(t.children||[]).forEach(b0e),t.properties&&t.properties.afterRemoved&&t.properties.afterRemoved.apply(t.properties.bind||t.properties,[t.domNode])},Rse=()=>{U8=!1,$8.forEach(b0e),$8.length=0},Ose=t=>{$8.push(t),U8||(U8=!0,typeof window<"u"&&"requestIdleCallback"in window?window.requestIdleCallback(Rse,{timeout:16}):setTimeout(Rse,16))},Lse=t=>{let e=t.domNode;if(t.properties){let i=t.properties.exitAnimation;if(i)return e.style.pointerEvents="none",void i(e,()=>{e.parentNode&&(e.parentNode.removeChild(e),Ose(t))},t.properties)}e.parentNode&&(e.parentNode.removeChild(e),Ose(t))},iWe=(t,e,i)=>{if(!e)return;let s=i.eventHandlerInterceptor,n=Object.keys(e),r=n.length;for(let o=0;o<r;o++){let a=n[o],l=e[a];if(a==="className")throw new Error('Property "className" is not supported, use "class".');if(a==="class")z8(t,l,!0);else if(a==="classes"){let u=Object.keys(l),c=u.length;for(let h=0;h<c;h++){let d=u[h];l[d]&&t.classList.add(d)}}else if(a==="styles"){let u=Object.keys(l),c=u.length;for(let h=0;h<c;h++){let d=u[h],m=l[d];m&&(x0e(m),i.styleApplyer(t,d,m))}}else if(a!=="key"&&l!=null){let u=typeof l;u==="function"?(a.lastIndexOf("on",0)===0&&(s&&(l=s(a,l,t,e)),a==="oninput"&&function(){let c=l;l=function(h){c.apply(this,[h]),h.target["oninput-value"]=h.target.value}}()),t[a]=l):i.namespace===H4?a==="href"?t.setAttributeNS(v0e,a,l):t.setAttribute(a,l):u==="string"&&a!=="value"?a==="innerHTML"?t[a]=_0e.sanitize(l):V8(t)&&a in t?t[a]=l:t.setAttribute(a,l):t[a]=l}}};function V8(t){if(!(t instanceof Element&&t.tagName.includes("-")))return!1;const e=window.customElements.get(t.tagName.toLowerCase());return!!e&&t instanceof e}let kL,sWe=(t,e,i)=>{if(e)for(let s of e)nP(s,t,void 0,i)},w0e=(t,e,i)=>{sWe(t,e.children,i),e.text&&(t.textContent=e.text),iWe(t,e.properties,i),e.properties&&e.properties.afterCreate&&e.properties.afterCreate.apply(e.properties.bind||e.properties,[t,i,e.vnodeSelector,e.properties,e.children])},nP=(t,e,i,s)=>{let n,r=0,o=t.vnodeSelector,a=e.ownerDocument;if(o==="")n=t.domNode=a.createTextNode(t.text),i!==void 0?e.insertBefore(n,i):e.appendChild(n);else{for(let l=0;l<=o.length;++l){let u=o.charAt(l);if(l===o.length||u==="."||u==="#"){let c=o.charAt(r-1),h=o.slice(r,l);c==="."?n.classList.add(h):c==="#"?n.id=h:(h==="svg"&&(s=gY(s,{namespace:H4})),s.namespace!==void 0?n=t.domNode=a.createElementNS(s.namespace,h):(n=t.domNode=t.domNode||a.createElement(h),h==="input"&&t.properties&&t.properties.type!==void 0&&n.setAttribute("type",t.properties.type)),i!==void 0?e.insertBefore(n,i):n.parentNode!==e&&e.appendChild(n)),r=l+1}}w0e(n,t,s)}},z8=(t,e,i)=>{e&&e.split(" ").forEach(s=>{s&&t.classList.toggle(s,i)})},nWe=(t,e,i,s)=>{if(!i)return;let n=!1,r=Object.keys(i),o=r.length;for(let a=0;a<o;a++){let l=r[a],u=i[l],c=e[l];if(l==="class")c!==u&&(z8(t,c,!1),z8(t,u,!0));else if(l==="classes"){let h=t.classList,d=Object.keys(u),m=d.length;for(let f=0;f<m;f++){let _=d[f],v=!!u[_];v!==!!c[_]&&(n=!0,v?h.add(_):h.remove(_))}}else if(l==="styles"){let h=Object.keys(u),d=h.length;for(let m=0;m<d;m++){let f=h[m],_=u[f];_!==c[f]&&(n=!0,_?(x0e(_),s.styleApplyer(t,f,_)):s.styleApplyer(t,f,""))}}else if(u||typeof c!="string"||(u=""),l!=="value"||V8(t)){if(u!==c){let h=typeof u;h==="function"&&s.eventHandlerInterceptor||(s.namespace===H4?l==="href"?t.setAttributeNS(v0e,l,u):t.setAttribute(l,u):h==="string"?l==="innerHTML"?t[l]=_0e.sanitize(u):l==="role"&&u===""?t.removeAttribute(l):V8(t)&&l in t?t[l]=u:t.setAttribute(l,u):t[l]!==u&&(t[l]=u),n=!0)}}else{let h=t[l];h!==u&&(t["oninput-value"]?h===t["oninput-value"]:u!==c)&&(t[l]=u,t["oninput-value"]=void 0),u!==c&&(n=!0)}}return n},rWe=(t,e,i,s,n)=>{if(i===s)return!1;s=s||Nse;let r,o=(i=i||Nse).length,a=s.length,l=0,u=0,c=!1;for(;u<a;){let h=l<o?i[l]:void 0,d=s[u];if(h!==void 0&&_Y(h,d))c=kL(h,d,n)||c,l++;else{let m=eWe(i,d,l+1);if(m>=0){for(r=l;r<m;r++)Lse(i[r]),K5(i,r,t,"removed");c=kL(i[m],d,n)||c,l=m+1}else nP(d,e,l<o?i[l].domNode:void 0,n),tWe(d),K5(s,u,t,"added")}u++}if(o>l)for(r=l;r<o;r++)Lse(i[r]),K5(i,r,t,"removed");return c};kL=(t,e,i)=>{let s=t.domNode,n=!1;if(t===e)return!1;let r=!1;if(e.vnodeSelector===""){if(e.text!==t.text){let o=s.ownerDocument.createTextNode(e.text);return s.parentNode.replaceChild(o,s),e.domNode=o,n=!0,n}e.domNode=s}else e.vnodeSelector.lastIndexOf("svg",0)===0&&(i=gY(i,{namespace:H4})),t.text!==e.text&&(r=!0,e.text===void 0?s.removeChild(s.firstChild):s.textContent=e.text),e.domNode=s,r=rWe(e,s,t.children,e.children,i)||r,r=nWe(s,t.properties,e.properties,i)||r,e.properties&&e.properties.afterUpdate&&e.properties.afterUpdate.apply(e.properties.bind||e.properties,[s,i,e.vnodeSelector,e.properties,e.children]);return r&&e.properties&&e.properties.updateAnimation&&e.properties.updateAnimation(s,e.properties,t.properties),n};let qN=(t,e)=>({getLastRender:()=>t,update:i=>{if(t.vnodeSelector!==i.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let s=t;t=i,kL(s,i,e)},domNode:t.domNode});const oWe={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,i)=>{e.charAt(0)==="-"?t.style.setProperty(e,i):t.style[e]=i}};let sT=t=>gY(oWe,t),Q_={append:(t,e,i)=>(i=sT(i),nP(e,t,void 0,i),qN(e,i)),insertBefore:(t,e,i)=>(i=sT(i),nP(e,t.parentNode,t,i),qN(e,i)),merge:(t,e,i)=>(i=sT(i),e.domNode=t,w0e(t,e,i),qN(e,i)),replace:(t,e,i)=>(i=sT(i),nP(e,t.parentNode,t,i),t.parentNode.removeChild(t),qN(e,i))},S0e,aWe=(t,e)=>{let i=[];for(;t&&t!==e;)i.push(t),t=t.parentNode;return i};S0e=Array.prototype.find?(t,e)=>t.find(e):(t,e)=>t.filter(e)[0];let lWe=(t,e)=>{let i=t;return e.forEach(s=>{i=i&&i.children?S0e(i.children,n=>n.domNode===s):void 0}),i},uWe=(t,e,i)=>{let s=function(n){i("domEvent",n);let r=e(),o=aWe(n.currentTarget,r.domNode);o.reverse();let a,l=lWe(r.getLastRender(),o);return t.scheduleRender(),l&&(a=l.properties[`on${n.type}`].apply(l.properties.bind||this,arguments)),i("domEventProcessed",n),a};return(n,r,o,a)=>s},Fse=t=>{let e,i,s=sT(t),n=s.performanceLogger,r=!0,o=!1,a=[],l=[],u=(h,d,m)=>{let f,_=()=>f;s.eventHandlerInterceptor=uWe(e,_,n),f=h(d,m(),s),a.push(f),l.push(m)},c=()=>{if(i=void 0,r){r=!1,n("renderStart",void 0);for(let h=0;h<a.length;h++){let d=l[h]();n("rendered",void 0),a[h].update(d),n("patched",void 0)}n("renderDone",void 0),r=!0}};return e={renderNow:c,scheduleRender:()=>{i||o||(i=requestAnimationFrame(c))},stop:()=>{i&&(cancelAnimationFrame(i),i=void 0),o=!0},resume:()=>{o=!1,r=!0,e.scheduleRender()},append:(h,d)=>{u(Q_.append,h,d)},insertBefore:(h,d)=>{u(Q_.insertBefore,h,d)},merge:(h,d)=>{u(Q_.merge,h,d)},replace:(h,d)=>{u(Q_.replace,h,d)},detach:h=>{for(let d=0;d<l.length;d++)if(l[d]===h)return l.splice(d,1),a.splice(d,1)[0];throw new Error("renderFunction was not found")}},e},g_=class extends ei{constructor(){super(...arguments),this.items=new Nt,this._watchUpdatingTracking=new i1,this._callbacks=new Map,this._projector=Fse(),this._hiddenProjector=Fse()}get needsRender(){return this.items.length>0}get updating(){var e;return((e=this._watchUpdatingTracking)==null?void 0:e.updating)??!1}initialize(){const e=document.createElement("div");e.className="esri-overlay-surface",this._set("surface",e),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),e.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,i=>{for(const s of i.added){const n=()=>s.render();this._callbacks.set(s,n),this._projector.append(this.surface,n)}for(const s of i.removed){const n=this._projector.detach(this._callbacks.get(s));this.surface.removeChild(n.domNode),this._callbacks.delete(s)}})}addItem(e){this.items.add(e)}removeItem(e){this.items.remove(e)}destroy(){this.items.removeAll(),this._callbacks.forEach(e=>this._projector.detach(e)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(e){const i=this._hiddenSurface,s=this._hiddenProjector;let n;const r=()=>(n=e.render(),n);s.append(i,r),s.renderNow();const o={left:0,top:0,right:0,bottom:0};if(n!=null&&n.domNode){const a=n.domNode.getBoundingClientRect();o.left=a.left,o.top=a.top,o.right=a.right,o.bottom=a.bottom}for(s.detach(r);i.firstChild;)i.removeChild(i.firstChild);return o}overlaps(e,i){const s=this.computeBoundingRect(e),n=this.computeBoundingRect(i);return Math.max(s.left,n.left)<=Math.min(s.right,n.right)&&Math.max(s.top,n.top)<=Math.min(s.bottom,n.bottom)}get hasVisibleItems(){return this.items.some(e=>e.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(e,i){const s=!!(i!=null&&i.disableDecorations);if(!this.items.some(r=>r.visible&&!(s&&r.isDecoration)))return;const n=e.getContext("2d");n.save(),n.font=this._fontString(),this.items.forEach(r=>{s&&r.isDecoration||(n.save(),r.renderCanvas(n),n.restore())}),n.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};y([S({readOnly:!0})],g_.prototype,"surface",void 0),y([S({readOnly:!0})],g_.prototype,"items",void 0),y([S({readOnly:!0})],g_.prototype,"needsRender",null),y([S({readOnly:!0})],g_.prototype,"_watchUpdatingTracking",void 0),y([S({readOnly:!0})],g_.prototype,"updating",null),g_=y([se("esri.views.overlay.ViewOverlay")],g_);const kse=g_,Q5=[0,0];function cWe(t){const e=(t.ownerDocument||window.document).defaultView,i=t.getBoundingClientRect();return Q5[0]=i.left+((e==null?void 0:e.pageXOffset)??0),Q5[1]=i.top+((e==null?void 0:e.pageYOffset)??0),Q5}function $se(t){t&&(t.textContent="",t.parentNode&&t.parentNode.removeChild(t))}function hWe(t){const e=document.createElement("div");return t.appendChild(e),e}const rb=16,K2=750,dWe=512,mWe=2,pWe=t=>{let e=class extends t{constructor(...i){super(...i),this._freqInfo={freq:rb,time:K2},this._overlayRenderTaskHandle=null,this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([Ai(()=>this.cursor,s=>{const{surface:n}=this;n&&n.setAttribute("data-cursor",s)}),Ai(()=>this.navigating,s=>{const{surface:n}=this;n&&n.setAttribute("data-navigating",s.toString())})])}initialize(){this.addHandles([Ai(()=>this.ui,(i,s)=>this._handleUIChange(i,s),nl),this.on("focus",()=>this.notifyChange("focused")),this.on("blur",()=>this.notifyChange("focused"))])}destroy(){var i;this.destroyed||((i=this.ui)==null||i.destroy(),this.container=null)}get container(){return this._get("container")??null}set container(i){const s=this._get("container"),n=mY(i);if(n||typeof i!="string"||ht.getLogger(this).error("#container",`element with id '${i}' not found`),s===n)return;if(this._stopMeasuring(),s&&(s.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&($se(this.root),this._set("root",null)),this.userContent&&(Pse(this.userContent,s),$se(this.userContent),this._set("userContent",null))),!n)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);n.classList.add("esri-view");const r=document.createElement("div");r.className="esri-view-user-storage",Pse(n,r),n.appendChild(r),this._set("userContent",r);const o=document.createElement("div");o.className="esri-view-root",n.insertBefore(o,n.firstChild),this._set("root",o);const a=document.createElement("div");a.className="esri-view-surface",a.setAttribute("role","application"),a.tabIndex=0,o.appendChild(a),this._set("surface",a);const l=new kse;o.appendChild(l.surface),this._set("overlay",l),this.addHandles(Ai(()=>l.needsRender,u=>{u&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=Ww({render:()=>{var c;return(c=this.overlay)==null?void 0:c.render()}}):this._overlayRenderTaskHandle=sr(this._overlayRenderTaskHandle)})),this.forceDOMReadyCycle(),this._set("container",n),this._startMeasuring()}get focused(){const i=document.activeElement===this.surface;return document.hasFocus()&&i}get size(){return[this.width,this.height]}blur(){var i;(i=this.surface)==null||i.blur()}focus(){var i;(i=this.surface)==null||i.focus()}pageToContainer(i,s,n){const r=this.position;return i-=r?r[0]:0,s-=r?r[1]:0,n?(n[0]=i,n[1]=s):n=[i,s],n}containerToPage(i,s,n){const r=this.position;return i+=r?r[0]:0,s+=r?r[1]:0,n?(n[0]=i,n[1]=s):n=[i,s],n}_handleUIChange(i,s){this.removeHandles("ui"),s&&s!==i&&s.destroy(),i&&(i.view=this,this.addHandles(Ai(()=>this.root,n=>{i.container=n?hWe(n):null},nl),"ui")),this._set("ui",i)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const i=this._freqInfo;i.freq=rb,i.time=K2;const s=Ww({prepare:o=>{const a=this._measure(),l=this._freqInfo;if(l.time+=o.deltaTime,a&&(l.freq=rb,this._get("resizing")||this._set("resizing",!0)),l.time<l.freq)return;l.time=0;const u=this._position();l.freq=u||a?rb:Math.min(K2,l.freq*mWe),!a&&l.freq>=dWe&&(s.pause(),this._get("resizing")&&this._set("resizing",!1))}}),n=new ResizeObserver(o=>{i.freq=rb,i.time=K2,s.resume()});this.container!=null&&n.observe(this.container);const r=Gs(()=>n.disconnect());this.addHandles([$M(window,"resize",()=>{i.freq=rb,i.time=K2,s.resume()}),r,s],"measuring"),this._measure(),this._position()}_measure(){const i=this.container,s=i?i.clientWidth:0,n=i?i.clientHeight:0;if(s===0||n===0)return this.suspended||this._set("suspended",!0),!1;const r=this.width,o=this.height;return s===r&&n===o?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",s),this._set("height",n),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:r,oldHeight:o,width:s,height:n}),!0)}_position(){const i=this.container,s=this.position,n=i&&cWe(i);return!!n&&(!s||n[0]!==s[0]||n[1]!==s[1])&&(this._set("position",[n[0],n[1]]),!0)}forceDOMReadyCycle(){}};return y([S()],e.prototype,"container",null),y([S({readOnly:!0})],e.prototype,"focused",null),y([S({readOnly:!0})],e.prototype,"height",void 0),y([S()],e.prototype,"messagesCommon",void 0),y([S({type:kse})],e.prototype,"overlay",void 0),y([S({readOnly:!0})],e.prototype,"position",void 0),y([S({readOnly:!0})],e.prototype,"resizing",void 0),y([S({readOnly:!0})],e.prototype,"root",void 0),y([S({value:null,readOnly:!0})],e.prototype,"size",null),y([S({readOnly:!0})],e.prototype,"surface",void 0),y([S({readOnly:!0})],e.prototype,"suspended",void 0),y([S({nonNullable:!0})],e.prototype,"ui",void 0),y([S({readOnly:!0})],e.prototype,"userContent",void 0),y([S({readOnly:!0})],e.prototype,"width",void 0),y([S()],e.prototype,"widthBreakpoint",void 0),e=y([se("esri.views.DOMContainer")],e),e},fWe=ke("mac")?"Meta":"Control",gWe=new Set(["Alt","Control","Meta","Shift","Ctrl","Primary"]),_We=t=>gWe.has(t);let yWe=class{constructor(e,i=[]){this.eventType=e,this.keyModifiers=i}matches(e){if(e.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const i=e.modifiers;for(const s of this.keyModifiers)if(!i.has(s))return!1;return!0}},zo=class{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const i=this._incoming[e];for(const s of i)this._incomingEventMatches.push(s.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(e=>e.eventType)),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(e){this._manager||(e.setEventCallback(i=>this._handleEvent(i)),e.setUninstallCallback(()=>this._onUninstall()),this._manager=e)}onUninstall(){}registerIncoming(e,i,s){let n;typeof i=="function"?(s=i,n=[]):n=i||[];const r=typeof e=="string"?new yWe(e,n):e,o=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},a=c=>{const h=this._incoming[c.match.eventType];if(h){const d=h.indexOf(c);h.splice(d,1),o(),this._manager&&this._manager.updateDependencies()}},l=new vWe(r,s,{onPause:a,onRemove:a,onResume:c=>{const h=this._incoming[c.match.eventType];h&&!h.includes(c)&&(h.push(c),o(),this._manager&&this._manager.updateDependencies())}});let u=this._incoming[r.eventType];return u||(u=[],this._incoming[r.eventType]=u),u.push(l),o(),this._manager&&this._manager.updateDependencies(),l}registerOutgoing(e){if(this._outgoing[e])throw new Error("There is already a callback registered for this outgoing InputEvent: "+e);const i=new xWe(e,{onEmit:(s,n,r,o)=>{var a;(a=this._manager)==null||a.emit(s.eventType,n,r,o)},onRemove:s=>{var n;delete this._outgoing[s.eventType],(n=this._manager)==null||n.updateDependencies()}});return this._outgoing[e]=i,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),i}startCapturingPointer(e){var i;(i=this._manager)==null||i.setPointerCapture(e,!0)}stopCapturingPointer(e){var i;(i=this._manager)==null||i.setPointerCapture(e,!1)}refreshHasPendingInputs(){var e;(e=this._manager)==null||e.refreshHasPendingInputs()}_onUninstall(){this._manager&&(this.onUninstall(),this._manager=null)}_handleEvent(e){var s;const i=this._incoming[e.type];if(i){for(const n of i)if(n.match.matches(e)&&((s=n.callback)==null||s.call(n,e),e.shouldStopPropagation()))break}}},vWe=class{constructor(e,i,s){this.match=e,this._callback=i,this._handler=s}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},xWe=class{constructor(e,i){this.eventType=e,this._removed=!1,this._handler=i}emit(e,i,s){this._removed||this._handler.onEmit(this,e,i,s)}remove(){this._removed=!0,this._handler.onRemove(this)}},bWe=class extends zo{constructor(e){super(!0),this._onChange=e,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",i=>this._update(i.data))}_update(e){const i=e.native.pointerType==="touch"?"touch":"mouse",{x:s,y:n}=e;i===this._value&&this._x===s&&this._y===n||(this._value=i,this._x=s,this._y=n,this._onChange(i,s,n))}},wWe=class{constructor(e,i){this._observable=new HM,this._value=e,this._equalityFunction=i}get value(){return fi(this._observable),this._value}set value(e){this._equalityFunction(e,this._value)||(this._value=e,this._observable.notify())}mutate(e){e(this._value),this._observable.notify()}};function DS(t,e=Yle){return new wWe(t,e)}let SWe=class extends zo{get multiTouchActive(){return this._multiTouchActive.value}constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=DS(!1),this._onPointerAdd=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.add(e.native.pointerId),this._update())},this._onPointerRemove=({data:e})=>{e.pointerType==="touch"&&(this._activeTouchPointerIds.delete(e.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}_update(){this._multiTouchActive.value=this._activeTouchPointerIds.size>1}},EWe=class{constructor(e,i){this._owner=i,this._properties={},this._afterDispatchHandle=null;for(const s in e){const n=e[s],r=new Tue(n,void 0,void 0,2,2);this._properties[s]={pool:r,acquired:[]}}this._afterDispatchHandle=tCe(()=>this._release())}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const e in this._properties){const i=this._properties[e];for(const s of i.acquired)TK(s)||i.pool.release(s);i.pool.destroy(),i.pool=null,i.acquired=null}this._properties=null,this._owner=null}get(e){const i=this._owner._get(e),s=this._properties[e];let n=s.pool.acquire();for(s.acquired.push(n);n===i;)s.acquired.push(n),n=s.pool.acquire();return n}_release(){for(const e in this._properties){const i=this._properties[e];let s=0;for(const n of i.acquired)TK(n)?i.acquired[s++]=n:i.pool.release(n);i.acquired.length=s}}},Oc=class extends ei{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=fWe,this._latestPointerType="mouse",this._propertiesPool=new EWe({latestPointerLocation:PWe},this),this.latestPointerLocation=null,this._paused=!1,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const e=Object.keys(this._nameToGroup);for(const i of e)this.uninstallHandlers(i);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some(e=>e.handler.hasPendingInputs)}get latestPointerType(){return this._latestPointerType}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}get updating(){return this.hasPendingInputs||this._paused}installHandlers(e,i,s=uy.INTERNAL){if(this._nameToGroup[e]||i.length===0)return;const n={name:e,handlers:i.map(r=>({handler:r,active:!0,removed:!1,priorityIndex:0,groupPriority:s,eventCallback:null,uninstallCallback:null}))};this._nameToGroup[e]=n;for(let r=n.handlers.length-1;r>=0;r--){const o=n.handlers[r];this._handlers.push(o),o.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(a,l,u,c,h)=>{this._emitInputEvent(o.priorityIndex+1,a,l,u,h,c)},setPointerCapture:(a,l)=>{this._setPointerCapture(n,o,a,l)},setEventCallback:a=>{o.eventCallback=a},setUninstallCallback:a=>{o.uninstallCallback=a},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(e){const i=this._nameToGroup[e];i?(i.handlers.forEach(s=>{var n;s.removed=!0,(n=s.uninstallCallback)==null||n.call(s)}),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):ht.getLogger(this).error("There is no InputHandler group registered under the name `"+e+"`")}hasHandlers(e){return this._nameToGroup[e]!==void 0}isModifierKeyDown(e){return this._activeKeyModifiers.has(e)}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,i=new Set;this._handlersPriority=[];for(let s=this._handlers.length-1;s>=0;s--){const n=this._handlers[s];n.priorityIndex=s,this._handlersPriority.push(n)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let s=this._handlersPriority.length-1;s>=0;s--){const n=this._handlersPriority[s];n.priorityIndex=s;let r=n.handler.hasSideEffects;if(!r){for(const o of n.handler.outgoingEventTypes)if(e.has(o)){r=!0;break}}if(r)for(const o of n.handler.incomingEventMatches){e.add(o.eventType);for(const a of o.keyModifiers)_We(a)||i.add(a)}n.active=r}this._sourceEvents=e,this._keyModifiers=i,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(e,i,s){this._latestPointerType=e;const n=this._get("latestPointerLocation");if(n==null||n.x!==i||n.y!==s){const r=this._propertiesPool.get("latestPointerLocation");r.x=i,r.y=s,this._set("latestPointerLocation",r)}}_onEventReceived(e,i){if(e==="pointer-capture-lost"){const r=i;this._pointerCaptures.delete(r.native.pointerId)}this._updateKeyModifiers(e,i);const s=this.test.timestamp!=null?this.test.timestamp:i.native?i.native.timestamp:void 0,n=i.native?i.native.cancelable:void 0;this._emitInputEventFromSource(e,i,s,n)}_updateKeyModifiers(e,i){if(!i)return;let s=!1;const n=()=>{s||(this._activeKeyModifiers=new Set(this._activeKeyModifiers),s=!0)},r=(a,l)=>{l&&!this._activeKeyModifiers.has(a)?(n(),this._activeKeyModifiers.add(a)):!l&&this._activeKeyModifiers.has(a)&&(n(),this._activeKeyModifiers.delete(a))};if(e==="key-down"||e==="key-up"){const a=i.key;this._keyModifiers.has(a)&&r(a,e==="key-down")}const o=i.native;r("Alt",!!(o!=null&&o.altKey)),r("Control",!!(o!=null&&o.ctrlKey)),r("Ctrl",!!(o!=null&&o.ctrlKey)),r("Shift",!!(o!=null&&o.shiftKey)),r("Meta",!!(o!=null&&o.metaKey)),r("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new bWe((e,i,s)=>this._setLatestPointer(e,i,s)),this._multiTouchHandler=new SWe,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],uy.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,uy.INTERNAL)}_setPointerCapture(e,i,s,n){const r=e.name+"-"+i.priorityIndex,o=this._pointerCaptures.get(s.pointerId)||new Set;this._pointerCaptures.set(s.pointerId,o),n?(o.add(r),o.size===1&&this.eventSource&&this.eventSource.setPointerCapture(s,!0)):o.has(r)&&(o.delete(r),o.size===0&&(this._pointerCaptures.delete(s.pointerId),this.eventSource&&this.eventSource.setPointerCapture(s,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter(e=>!e.removed),this.updateDependencies()}_emitInputEventFromSource(e,i,s,n){this._emitInputEvent(0,e,i,s,n)}_emitInputEvent(e,i,s,n,r,o){const a=n!==void 0?n:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),l=r!==void 0&&r,u={event:new CWe(i,s,a,o||this._activeKeyModifiers,l),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(u):this._doNewPropagation(u)}_doNewPropagation(e){this._currentPropagation={events:new RL,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation()}_continuePropagation(){var i,s,n;this._paused=!1;const e=this._currentPropagation;if(e){for(;e.events.length>0;){const{event:r,priorityIndex:o}=e.events.pop(),a=(i=r.data)==null?void 0:i.eventId;if(!(a!=null&&this._stoppedPropagationEventIds.has(a)))for(e.currentHandler=this._handlersPriority[o];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else{if(e.currentHandler.active&&!r.shouldStopPropagation()&&((n=(s=e.currentHandler).eventCallback)==null||n.call(s,r)),r.shouldStopPropagation()){a!=null&&this._stoppedPropagationEventIds.add(a);break}if(r.shouldPausePropagation(()=>this._continuePropagation()))return void this._pausePropagation({event:r,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1]}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}_pausePropagation(e){const i=new RL;i.push(e);const s=this._currentPropagation;if(s){for(;s.events.length;)i.push(s.events.pop());s.events=i,s.currentHandler=null,this._paused=!0}}_compareHandlerPriority(e,i){if(e.handler.hasSideEffects!==i.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==i.groupPriority)return e.groupPriority>i.groupPriority?-1:1;for(const s of e.handler.incomingEventMatches)for(const n of i.handler.incomingEventMatches){if(s.eventType!==n.eventType)continue;const r=s.keyModifiers.filter(o=>n.keyModifiers.includes(o));if(r.length===s.keyModifiers.length!=(r.length===n.keyModifiers.length))return s.keyModifiers.length>n.keyModifiers.length?-1:1}return e.priorityIndex>i.priorityIndex?-1:1}_sortHandlersPriority(e){const i=[];for(const s of e){let n=0;for(;n<i.length&&this._compareHandlerPriority(s,i[n])>=0;)n++;i.splice(n,0,s)}return i}get debug(){const e=i=>{const s=this._setPointerCapture;this._setPointerCapture=()=>{},i(),this._setPointerCapture=s};return{injectEvent:(i,s)=>{e(()=>this._onEventReceived(i,s))},disablePointerCapture:e}}};y([S({readOnly:!0})],Oc.prototype,"hasPendingInputs",null),y([S({constructOnly:!0})],Oc.prototype,"eventSource",void 0),y([S({constructOnly:!0})],Oc.prototype,"recognizers",void 0),y([S()],Oc.prototype,"_latestPointerType",void 0),y([S()],Oc.prototype,"latestPointerType",null),y([S()],Oc.prototype,"multiTouchActive",null),y([S({readOnly:!0})],Oc.prototype,"latestPointerLocation",void 0),y([S()],Oc.prototype,"_paused",void 0),y([S({readOnly:!0})],Oc.prototype,"updating",null),Oc=y([se("esri.views.input.InputManager")],Oc);let CWe=class{constructor(e,i,s,n,r){this.type=e,this.data=i,this.timestamp=s,this.modifiers=n,this.cancelable=r,this._propagationState=$_.NONE,this._resumeCallback=null}stopPropagation(){this._propagationState|=$_.STOPPED}shouldStopPropagation(){return!!(this._propagationState&$_.STOPPED)}async(e){this._propagationState|=$_.PAUSED;const i=(s,n)=>{this._propagationState&=~$_.PAUSED;const r=this._resumeCallback;if(this._resumeCallback=null,r&&r(),n)throw s;return s};return(typeof e=="function"?e():e).then(s=>i(s,!1),s=>i(s,!0))}shouldPausePropagation(e){return!!(this._propagationState&$_.PAUSED)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault()}};var $_;(function(t){t[t.NONE=0]="NONE",t[t.STOPPED=1]="STOPPED",t[t.PAUSED=2]="PAUSED"})($_||($_={}));const uy={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};let TWe=class{};const PWe=TWe;function Kg(t){return t!=null&&"open"in t&&"declaredClass"in t}function Use(t){return t!=null&&"declaredClass"in t&&"dockOptions"in t}const MWe=t=>{let e=class extends t{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([Ai(()=>[this.ui,this.popup],([i,s],n)=>{const r="popup",o="manual";if(n){const[a,l]=n;a&&Kg(l)&&(l.view=null,Use(l)&&a.remove(l,r))}i&&Kg(s)&&(s.view=this,Use(s)&&i.add(s,{key:r,position:o,internal:!0}))},nl),this.on("click",i=>{this.popup&&this.popupEnabled&&(i.pointerType!=="mouse"||i.button===0)&&(Kg(this.popup)?this.popup.viewModel.handleViewClick(i):i.async(async()=>{await this.setupPopup(),Kg(this.popup)&&!this.destroyed&&this.ready&&this.popupEnabled&&this.popup.viewModel.handleViewClick(i)}))},uy.WIDGET)]),h7(()=>this.ready&&this.popupEnabled&&!this.updating).then(()=>{_e(()=>import("./Popup-Cj_jW6aW.js").then(i=>i.P),__vite__mapDeps([171,1,172,21,173,174,175,35,176,177,178,83,81,82,15,14,16,11,6,179,180,127,181]))})}destroy(){this.destroyed||this.closePopup()}async openPopup(i){if(Kg(this.popup))return this.popup.open(i);try{if(await this.setupPopup(),!this.popup)return void ht.getLogger(this).error(new Se("view:null-popup","Popup is null and can't be opened"));this.popup.open(i)}catch{}}closePopup(){var i;(i=this._popupSetupTask)==null||i.abort(),Kg(this.popup)&&this.popup.close()}async fetchPopupFeatures(i,s){return await this.when(),this._popupHitsToFeatures(await this._getPopupHits(i,s),s)}async setupPopup(){var i;if((i=this._popupSetupTask)==null||i.abort(),this.popup&&!Kg(this.popup))return this._popupSetupTask=KM(async s=>{const{default:n}=await _e(()=>import("./Popup-Cj_jW6aW.js").then(o=>o.P),__vite__mapDeps([171,1,172,21,173,174,175,35,176,177,178,83,81,82,15,14,16,11,6,179,180,127,181]));if(vr(s),!this.popup||Kg(this.popup))return;const r=this.popup;delete r.open,delete r.close,this.popup=new n(r)}),this._popupSetupTask.promise}async _popupHitsToFeatures({location:i,hits:s},n){const r=[],o=[];let a=!1;const l=N2e(n,ke("popup-view-fetch-timeout")??IWe),u=d=>{const m=new AWe(d);return o.push(m),r.push(m.promise),m},c=d=>{const m=o.at(-1);return m&&m.layerView===d&&!a?m:u(d)};for(const d of s)"graphic"in d?(c(d.layerView).graphics.push(d.graphic),a=!1):(r.push(d.layerView.fetchPopupFeaturesAtLocation(d.mapPoint,l)),a=!0);o.map(d=>d.resolve(l));const h=D2e(r).then(d=>d.filter(m=>!!m).flat());return{pendingFeatures:r,allGraphicsPromise:h,location:i}}async _getPopupHits(i,s){const{hits:n,location:r}=await this.popupHitTest(i);vr(s);const o=[];for(const a of n)if("graphic"in a){if(this._isValidPopupGraphic(a.graphic,s)){const l=this._isValidPopupGraphicsLayerView(a.layerView)?a.layerView:void 0;o.push({graphic:a.graphic,layerView:l})}}else this._isValidPopupLocationLayerView(a.layerView)&&o.push({mapPoint:a.mapPoint,layerView:a.layerView});return{hits:o,location:r}}_isValidPopupGraphic(i,s){return i&&!!i.getEffectivePopupTemplate(s==null?void 0:s.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(i){return!i||(!("layer"in i)||!i.suspended)&&"fetchPopupFeaturesFromGraphics"in i}_isValidPopupLocationLayerView(i){return(!("layer"in i)||!i.suspended)&&"fetchPopupFeaturesAtLocation"in i}};return y([S()],e.prototype,"popup",void 0),y([S()],e.prototype,"popupEnabled",void 0),e=y([se("esri.views.PopupView")],e),e};let AWe=class{constructor(e){this.layerView=e,this._resolver=mc(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(e){const{layerView:i,graphics:s,_resolver:n}=this;if(!i)return n.resolve(s),n.promise;let r;return i.fetchPopupFeaturesFromGraphics(s,e).catch(o=>(r=o,null)).then(o=>{o?n.resolve(o):n.reject(r)}),n.promise}};const IWe=5e3;async function E0e(t,e){return await t.load(),DWe(t,e)}async function DWe(t,e){const i=[],s=(...r)=>{for(const o of r)o!=null&&(Array.isArray(o)?s(...o):Nt.isCollection(o)?o.forEach(a=>s(a)):Lf.isLoadable(o)&&i.push(o))};e(s);let n=null;if(await tNe(i,async r=>{const o=await qF(NWe(r)?r.loadAll():r.load());o.ok!==!1||n||(n=o)}),n)throw n.error;return t}function NWe(t){return"loadAll"in t&&typeof t.loadAll=="function"}let qp=class extends ei{constructor(e){super(e),this.portalItem=null}normalizeCtorArgs(e){return e!=null&&e.portalItem&&e.path?{...e,path:Vse(e.path,e.portalItem)}:e}set path(e){e!=null&&uc(e)?ht.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",e)}_castPath(e){return Vse(e,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(e="json",i){const s=this.cdnUrl;if(s==null)throw new Se("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(s,{responseType:e,query:{token:this.portalItem.apiKey,_ts:i!=null&&i.cacheBust?Date.now():null},signal:i==null?void 0:i.signal})}async update(e,i){const{addOrUpdateResources:s}=await _e(()=>import("./resourceUtils-CbKE4JAm.js"),[]);return await s(this.portalItem,[{resource:this,content:e,compress:i==null?void 0:i.compress,access:i==null?void 0:i.access}],"update",i),this}hasPath(){return this.path!=null}};function Vse(t,e){return t==null?t:(t=t.replace(/^\/+/,""),e!=null&&uc(t)&&(t=wH(t,e.itemUrl)),t==null?void 0:t.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}y([S()],qp.prototype,"portalItem",void 0),y([S({type:String,value:null})],qp.prototype,"path",null),y([Ls("path")],qp.prototype,"_castPath",null),y([S({type:String,readOnly:!0})],qp.prototype,"url",null),y([S({type:String,readOnly:!0})],qp.prototype,"cdnUrl",null),y([S({type:String,readOnly:!0})],qp.prototype,"itemRelativeUrl",null),qp=y([se("esri.portal.PortalItemResource")],qp);const RWe=qp;let nT=class extends ei{constructor(e){super(e),this.created=null,this.rating=null}};y([S({type:Date})],nT.prototype,"created",void 0),y([S()],nT.prototype,"rating",void 0),nT=y([se("esri.portal.PortalRating")],nT);const J5=nT;var J0;const OWe=new Set(["3DTiles Service","CSV","Feature Collection","Feature Service","Feed","GeoJson","Group Layer","Image Service","KML","Map Service","Media Layer","Scene Service","Stream Service","Vector Tile Service","WFS","WMS","WMTS"]),LWe=new Set(["KML","GeoJson","CSV"]);let Wi=J0=class extends it.JSONSupportMixin(Lf){static from(t){return OS(J0,t)}constructor(t){super(t),this.access=null,this.accessInformation=null,this.apiKey=null,this.applicationProxies=null,this.avgRating=null,this.categories=null,this.classification=null,this.created=null,this.culture=null,this.description=null,this.extent=null,this.groupCategories=null,this.id=null,this.isOrgItem=!1,this.itemControl=null,this.licenseInfo=null,this.modified=null,this.name=null,this.numComments=null,this.numRatings=null,this.numViews=null,this.owner=null,this.ownerFolder=null,this.portal=null,this.screenshots=null,this.size=null,this.snippet=null,this.sourceJSON=null,this.sourceUrl=null,this.spatialReference=null,this.tags=null,this.title=null,this.type=null,this.typeKeywords=null,this.url=null}destroy(){this.portal=null}get displayName(){const t=this.type,e=this.typeKeywords||[];let i=t;return t==="Feature Service"||t==="Feature Collection"?i=e.includes("Table")?"Table":e.includes("Route Layer")?"Route Layer":e.includes("Markup")?"Markup":"Feature Layer":t==="Image Service"?i=e.includes("Elevation 3D Layer")?"Elevation Layer":e.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":t==="Scene Service"?i="Scene Layer":t==="Video Service"?i="Video Layer":t==="Scene Package"?i="Scene Layer Package":t==="Stream Service"?i="Feature Layer":t==="Geoprocessing Service"?i=e.includes("Web Tool")?"Tool":"Geoprocessing Service":t==="Geoenrichment Service"?i="GeoEnrichment Service":t==="Geocoding Service"?i="Locator":t==="Microsoft Powerpoint"?i="Microsoft PowerPoint":t==="GeoJson"?i="GeoJSON":t==="Globe Service"?i="Globe Layer":t==="Vector Tile Service"?i="Tile Layer":t==="netCDF"?i="NetCDF":t==="Map Service"?i=e.includes("Spatiotemporal")||!e.includes("Hosted Service")&&!e.includes("Tiled")||e.includes("Relational")?"Map Image Layer":"Tile Layer":t!=null&&t.toLowerCase().includes("add in")?i=t.replaceAll(/(add in)/gi,"Add-In"):t==="datastore catalog service"?i="Big Data File Share":t==="Compact Tile Package"?i="Tile Package (tpkx)":t==="Raster function template"?i="Raster Function Template":t==="OGCFeatureServer"?i="OGC Feature Layer":t==="web mapping application"&&e.includes("configurableApp")?i="Instant App":t==="Insights Page"?i="Insights Report":t==="Excalibur Imagery Project"?i="Excalibur Project":t==="3DTiles Service"?i="3D tiles layer":t==="3DTiles Package"&&(i="3D tiles package"),i}readExtent(t){return t&&t.length?new Nn(t[0][0],t[0][1],t[1][0],t[1][1]):null}get iconUrl(){var m;const t=((m=this.type)==null?void 0:m.toLowerCase())||"",e=this.typeKeywords||[],i="esri/images/portal/",s="16";let n,r=!1,o=!1,a=!1,l=!1,u=!1,c=!1,h=!1,d=!1;return t.indexOf("service")>0||t==="feature collection"||t==="kml"||t==="wms"||t==="wmts"||t==="wfs"?(r=e.includes("Hosted Service"),t==="feature service"||t==="feature collection"||t==="kml"||t==="wfs"?(o=e.includes("Table"),a=e.includes("Route Layer"),l=e.includes("Markup"),u=e.includes("Spatiotemporal"),c=e.includes("UtilityNetwork"),n=u&&o?"spatiotemporaltable":o?"table":a?"routelayer":l?"markup":u?"spatiotemporal":c?"utilitynetwork":r?"featureshosted":"features"):t==="map service"||t==="wms"||t==="wmts"?(u=e.includes("Spatiotemporal"),h=e.includes("Relational"),n=u||h?"mapimages":r||e.includes("Tiled")||t==="wmts"?"maptiles":"mapimages"):n=t==="scene service"?e.includes("Line")?"sceneweblayerline":e.includes("3DObject")?"sceneweblayermultipatch":e.includes("Point")?"sceneweblayerpoint":e.includes("IntegratedMesh")?"sceneweblayermesh":e.includes("PointCloud")?"sceneweblayerpointcloud":e.includes("Polygon")?"sceneweblayerpolygon":e.includes("Building")?"sceneweblayerbuilding":e.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":t==="image service"?e.includes("Elevation 3D Layer")?"elevationlayer":e.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":t==="stream service"?"streamlayer":t==="vector tile service"?"vectortile":t==="datastore catalog service"?"datastorecollection":t==="geocoding service"?"geocodeservice":t==="video service"?e.includes("Live Stream")?"livestreamvideolayer":"videolayer":t==="geoprocessing service"?e.includes("Web Tool")?"tool":"layers":t==="geodata service"?"geodataservice":t==="3dtiles service"?e.includes("3DObject")?"3dobjecttileslayer":e.includes("IntegratedMesh")?"integratedmeshtileslayer":"3dtileslayer":"layers"):t==="web map"||t==="cityengine web scene"?n="maps":t==="web scene"?n=e.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":t==="web mapping application"&&e.includes("configurableApp")?n="instantapps":t==="web mapping application"||t==="mobile application"||t==="application"||t==="operation view"||t==="desktop application"?n="apps":t==="map document"||t==="map package"||t==="published map"||t==="scene document"||t==="globe document"||t==="basemap package"||t==="mobile basemap package"||t==="mobile map package"||t==="project package"||t==="project template"||t==="pro map"||t==="layout"||t==="layer"&&e.includes("ArcGIS Pro")||t==="explorer map"&&e.indexOf("Explorer Document")?n="mapsgray":t==="service definition"||t==="shapefile"||t==="cad drawing"||t==="geojson"||t==="netcdf"||t==="administrative report"?n="datafiles":t==="360 vr experience"?n="360vr":t==="explorer add in"||t==="desktop add in"||t==="windows viewer add in"||t==="windows viewer configuration"?n="appsgray":t==="arcgis pro add in"||t==="arcgis pro configuration"?n="addindesktop":t==="pdf"?n="pdf":t==="microsoft word"?n="word":t==="microsoft excel"?n="excel":t==="microsoft powerpoint"?n="ppt":t==="rule package"||t==="file geodatabase"||t==="sqlite geodatabase"||t==="csv collection"||t==="kml collection"||t==="windows mobile package"||t==="map template"||t==="desktop application template"||t==="gml"||t==="arcpad package"||t==="code sample"||t==="document link"||t==="earth configuration"||t==="operations dashboard add in"||t==="rules package"||t==="workflow manager package"||t==="explorer map"&&e.includes("Explorer Mapping Application")||e.includes("Document")?n="datafilesgray":t==="network analysis service"||t==="geoprocessing service"||t==="geodata service"||t==="geometry service"||t==="geoprocessing package"||t==="locator package"||t==="geoprocessing sample"||t==="workflow manager service"?n="toolsgray":t==="layer"||t==="layer package"||t==="explorer layer"?n="layersgray":t==="analysis model"?n="analysismodel":t==="scene package"?n="scenepackage":t==="3dtiles package"?n="3dtileslayerpackage":t==="3dtiles service"?n="3dtileslayer":t==="mobile scene package"?n="mobilescenepackage":t==="tile package"||t==="compact tile package"?n="tilepackage":t==="task file"?n="taskfile":t==="report template"?n="report-template":t==="statistical data collection"?n="statisticaldatacollection":t==="insights workbook"?n="workbook":t==="insights model"?n="insightsmodel":t==="insights page"?n="insightspage":t==="insights theme"?n="insightstheme":t==="hub initiative"?n="hubinitiative":t==="hub page"?n="hubpage":t==="hub site application"?n="hubsite":t==="hub event"?n="hubevent":t==="hub project"?n="hubproject":t==="relational database connection"?n="relationaldatabaseconnection":t==="big data file share"?n="datastorecollection":t==="image collection"?n="imagecollection":t==="desktop style"?n="desktopstyle":t==="style"?n=e.includes("Dictionary")?"dictionarystyle":"style":t==="dashboard"?n="dashboard":t==="raster function template"?n="rasterprocessingtemplate":t==="vector tile package"?n="vectortilepackage":t==="ortho mapping project"?n="orthomappingproject":t==="ortho mapping template"?n="orthomappingtemplate":t==="solution"?n="solutions":t==="geopackage"?n="geopackage":t==="deep learning package"?n="deeplearningpackage":t==="real time analytic"?n="realtimeanalytics":t==="reality mapping project"?n="realitymappingproject":t==="big data analytic"?n="bigdataanalytics":t==="feed"?n="feed":t==="excalibur imagery project"?n="excaliburimageryproject":t==="notebook"?n="notebook":t==="storymap"?n="storymap":t==="survey123 add in"?n="survey123addin":t==="mission"?n="mission":t==="mission report"?n="missionreport":t==="mission template"?n="missiontemplate":t==="quickcapture project"?n="quickcaptureproject":t==="pro report"?n="proreport":t==="pro report template"?n="proreporttemplate":t==="urban model"?n="urbanmodel":t==="urban project"?n="urbanproject":t==="web experience"?n="experiencebuilder":t==="web experience template"?n="webexperiencetemplate":t==="experience builder widget"?n="experiencebuilderwidget":t==="experience builder widget package"?n="experiencebuilderwidgetpackage":t==="workflow"?n="workflow":t==="kernel gateway connection"?n="kernelgatewayconnection":t==="insights script"?n="insightsscript":t==="hub initiative template"?n="hubinitiativetemplate":t==="storymap theme"?n="storymaptheme":t==="knowledge graph"?n="knowledgegraph":t==="knowledge graph layer"?n="knowledgegraphlayer":t==="knowledge studio project"?n="knowledgestudio":t==="native application"?n="nativeapp":t==="native application installer"?n="nativeappinstaller":t==="web link chart"?n="linkchart":t==="knowledge graph web investigation"?n="investigation":t==="ogcfeatureserver"?n="features":t==="pro presentation"?n="propresentation":t==="pro project"?n="proproject":t==="insights workbook package"?n="insightsworkbookpackage":t==="apache parquet"?n="apacheparquet":t==="notebook code snippet library"?n="notebookcodesnippets":t==="suitability model"?n="suitabilitymodel":t==="esri classifier definition"?n="classifierdefinition":t==="esri classification schema"?n="classificationschema":t==="insights data engineering workbook"?n="dataengineeringworkbook":t==="insights data engineering model"?n="dataengineeringmodel":t==="deep learning studio project"?n="deeplearningproject":t==="discussion"?n="discussion":t==="allsource project"?n="allsourceproject":t==="api key"?n="apikey":t==="data pipeline"?n="datapipelines":t==="group layer"?(d=e.includes("Map"),n=d?"layergroup2d":"layergroup"):n=t==="media layer"?"onlinemedialayer":t==="form"?e.includes("Survey123")?"survey":"datafilesgray":t==="csv"?"csv":t==="image"?"image":"maps",n?$r(i+n+s+".png"):null}get isLayer(){return this.type!=null&&OWe.has(this.type)}get itemCdnUrl(){return PH(this.itemUrl)}get itemPageUrl(){var e;const t=(e=this.portal)==null?void 0:e.itemPageUrl;return t&&this.id?`${t}?id=${this.id}`:null}get itemUrl(){var e;const t=(e=this.portal)==null?void 0:e.restUrl;return t&&this.id?`${t}/content/items/${this.id}`:null}get thumbnailUrl(){var i;const t=this.itemUrl,e=this.thumbnail;return t&&e?((i=this.portal)==null?void 0:i.normalizeUrl(`${t}/info/${e}?f=json`))??null:null}get userItemUrl(){var i,s,n;const t=(i=this.portal)==null?void 0:i.restUrl;if(!t)return null;const e=this.owner||((n=(s=this.portal)==null?void 0:s.user)==null?void 0:n.username);return e?`${t}/content/users/${this.ownerFolder?`${e}/${this.ownerFolder}`:e}/items/${this.id}`:null}load(t){const e=this.portal??(this.portal=Cu.getDefault()),i=e.load(t).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?e.request(this.itemUrl,{signal:t!=null?t.signal:null,query:{token:this.apiKey}}):{}).then(s=>{this.sourceJSON=s,this.read(s)});return this.addResolvingPromise(i),Promise.resolve(this)}async addRating(t){const e={method:"post",query:{}},i=t instanceof J5?t.rating:t;return i==null||isNaN(i)||typeof t!="number"||(e.query.rating=i),this.portal?(await this.portal.request(this.itemUrl+"/addRating",e),new J5({rating:i,created:new Date})):null}clone(){const t={access:this.access,accessInformation:this.accessInformation,applicationProxies:be(this.applicationProxies),avgRating:this.avgRating,categories:be(this.categories),classification:be(this.classification),created:be(this.created),culture:this.culture,description:this.description,extent:be(this.extent),groupCategories:be(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:be(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:be(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:be(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:be(this.typeKeywords),url:this.url};this.loaded&&(t.loadStatus="loaded");const e=new J0({sourceJSON:this.sourceJSON}).set(t);return e._set("isOrgItem",this.isOrgItem),e}createPostQuery(){var e;const t=this.toJSON();for(const i of["tags","typeKeywords","categories"])t[i]=(e=t[i])==null?void 0:e.join(", ");for(const i of["extent","classification"]){const s=t[i];s&&(t[i]=JSON.stringify(s))}return t}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(t="json",e){return this.portal.request(this.itemUrl+"/data",{responseType:t,...e,query:{token:this.apiKey}})}async fetchRating(t){const e=await this.portal.request(this.itemUrl+"/rating",{query:{token:this.apiKey},...t});return e.rating!=null?(e.created=new Date(e.created),new J5(e)):null}fetchRelatedItems(t,e){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...t,token:this.apiKey},...e},J0)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+=`&w=${t}`),e}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then(t=>(this.applicationProxies&&!Object.hasOwn(t,"appProxies")&&(this.applicationProxies=null),this.sourceJSON=t,this.read(t),this))}update(t){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const e=t==null?void 0:t.data,i={method:"post"};i.query=this.createPostQuery();for(const s in i.query)i.query[s]===null&&(i.query[s]="");return i.query.clearEmptyFields=!0,e!=null&&(typeof e=="string"?i.query.text=e:typeof e=="object"&&(i.query.text=JSON.stringify(e))),this.portal.request(`${this.userItemUrl}/update`,i).then(()=>this.reload())}):Promise.reject(new Se("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async copy(t){if(!this.id)throw new Se("portal:item-does-not-exist","The item does not exist yet");await this.load();const{portal:e,itemUrl:i}=this;await e.signIn();const{copyResources:s,folder:n,tags:r,title:o}=t||{},a={method:"post",query:{copyPrivateResources:s==="all",folder:typeof n=="string"?n:n==null?void 0:n.id,includeResources:!!s,tags:r==null?void 0:r.join(","),title:o}},{itemId:l}=await e.request(`${i}/copy`,a);return new J0({id:l,portal:e})}updateThumbnail(t){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const e=t.thumbnail,i=t.filename,s={method:"post"};if(typeof e=="string")k1(e)?s.query={data:e}:s.query={url:Yc(e)},i!=null&&(s.query.filename=i);else{const n=new FormData;i!=null?n.append("file",e,i):n.append("file",e),s.body=n}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,s).then(()=>this.reload())}):Promise.reject(new Se("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(t={},e){const{fetchResources:i}=await _e(()=>import("./resourceUtils-CbKE4JAm.js"),[]);return i(this,t,e)}async addResource(t,e,i){const{addOrUpdateResources:s}=await _e(()=>import("./resourceUtils-CbKE4JAm.js"),[]);return t.portalItem=this,await s(this,[{resource:t,content:e,compress:i==null?void 0:i.compress,access:i==null?void 0:i.access}],"add",i),t}async removeResource(t,e){const{removeResource:i}=await _e(()=>import("./resourceUtils-CbKE4JAm.js"),[]);if(t.portalItem&&t.portalItem.itemUrl!==this.itemUrl)throw new Se("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return i(this,t,e)}async removeAllResources(t){const{removeAllResources:e}=await _e(()=>import("./resourceUtils-CbKE4JAm.js"),[]);return e(this,t)}resourceFromPath(t){return new RWe({portalItem:this,path:t})}toJSON(){var i,s;const t=this.extent,e={accessInformation:this.accessInformation,categories:be(this.categories),classification:be(this.classification),created:(i=this.created)==null?void 0:i.getTime(),description:this.description,extent:t&&[[t.xmin,t.ymin],[t.xmax,t.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:(s=this.modified)==null?void 0:s.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:be(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:be(this.typeKeywords),url:this.url};return cEe(e)}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw new Error("JSON object is already hydrated");return new J0({sourceJSON:t})}_getPostQuery(){const t=this.toJSON();for(const e in t)e==="tags"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="typeKeywords"&&t[e]!==null&&(t[e]=t[e].join(", ")),e==="extent"&&t[e]&&(t[e]=JSON.stringify(t[e]));return t}};y([S({type:["private","shared","org","public"]})],Wi.prototype,"access",void 0),y([S()],Wi.prototype,"accessInformation",void 0),y([S({type:String})],Wi.prototype,"apiKey",void 0),y([S({json:{read:{source:"appProxies"}}})],Wi.prototype,"applicationProxies",void 0),y([S()],Wi.prototype,"avgRating",void 0),y([S()],Wi.prototype,"categories",void 0),y([S()],Wi.prototype,"classification",void 0),y([S({type:Date})],Wi.prototype,"created",void 0),y([S()],Wi.prototype,"culture",void 0),y([S()],Wi.prototype,"description",void 0),y([S({readOnly:!0})],Wi.prototype,"displayName",null),y([S({type:Nn})],Wi.prototype,"extent",void 0),y([mt("extent")],Wi.prototype,"readExtent",null),y([S()],Wi.prototype,"groupCategories",void 0),y([S({readOnly:!0})],Wi.prototype,"iconUrl",null),y([S()],Wi.prototype,"id",void 0),y([S({readOnly:!0})],Wi.prototype,"isLayer",null),y([S({type:Boolean,readOnly:!0})],Wi.prototype,"isOrgItem",void 0),y([S()],Wi.prototype,"itemControl",void 0),y([S({readOnly:!0})],Wi.prototype,"itemPageUrl",null),y([S({readOnly:!0})],Wi.prototype,"itemUrl",null),y([S()],Wi.prototype,"licenseInfo",void 0),y([S({type:Date})],Wi.prototype,"modified",void 0),y([S()],Wi.prototype,"name",void 0),y([S()],Wi.prototype,"numComments",void 0),y([S()],Wi.prototype,"numRatings",void 0),y([S()],Wi.prototype,"numViews",void 0),y([S()],Wi.prototype,"owner",void 0),y([S()],Wi.prototype,"ownerFolder",void 0),y([S({type:Cu})],Wi.prototype,"portal",void 0),y([S()],Wi.prototype,"screenshots",void 0),y([S()],Wi.prototype,"size",void 0),y([S()],Wi.prototype,"snippet",void 0),y([S()],Wi.prototype,"sourceJSON",void 0),y([S({type:String})],Wi.prototype,"sourceUrl",void 0),y([S({type:String})],Wi.prototype,"spatialReference",void 0),y([S()],Wi.prototype,"tags",void 0),y([S()],Wi.prototype,"thumbnail",void 0),y([S({readOnly:!0})],Wi.prototype,"thumbnailUrl",null),y([S()],Wi.prototype,"title",void 0),y([S()],Wi.prototype,"type",void 0),y([S()],Wi.prototype,"typeKeywords",void 0),y([S({type:String,json:{read(t,e){var i;if(LWe.has(e.type)){const s=(i=this.portal)==null?void 0:i.restUrl;t||(t=s&&this.id?`${s}/content/items/${this.id}/data`:null)}return t}}})],Wi.prototype,"url",void 0),y([S({readOnly:!0})],Wi.prototype,"userItemUrl",null),Wi=J0=y([se("esri.portal.PortalItem")],Wi);const rP=Wi,C0e=Object.freeze(Object.defineProperty({__proto__:null,default:rP},Symbol.toStringTag,{value:"Module"}));async function FWe(t){if(!t)return;const e=t.includes("-vector")?t.slice(0,t.indexOf("-vector")):t.includes("-3d")?t.slice(0,t.indexOf("-3d")):t,i=await $ye("esri/t9n/basemaps");return i[t]||i[e]}const G8={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return $r("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return $r("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return $r("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return $r("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return $r("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return $r("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get"dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return $r("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return $r("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return $r("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return $r("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return $r("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return $r("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return $r("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return $r("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return $r("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return $r("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return $r("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]}};let Hp=class extends ei{constructor(e){super(e),this.apiKey=null,this.id=null,this.language=null,this.places=null,this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2",this.worldview=null}get languageParameter(){const e=this.language;let i=e==="local"||e==="global"?e:Uye(e??vu())??"global";return i=i==="no"?"nb":i,i}};y([S()],Hp.prototype,"apiKey",void 0),y([S()],Hp.prototype,"id",void 0),y([S()],Hp.prototype,"language",void 0),y([S()],Hp.prototype,"places",void 0),y([S()],Hp.prototype,"serviceUrl",void 0),y([S()],Hp.prototype,"worldview",void 0),Hp=y([se("esri.support.BasemapStyle")],Hp);const kWe=Hp;function Avt(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="feature"}function $We(t){return t!=null&&typeof t=="object"&&"type"in t&&t.type==="subtype-group"&&"sublayers"in t}function ev(t){return(t==null?void 0:t.type)==="subtype-sublayer"}const Ivt={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function B8(t){const e=t==null?void 0:t.type;return e==="building-scene"||e==="integrated-mesh"||e==="point-cloud"||e==="scene"}function Dvt(t){return t==="integrated-mesh"||t==="integrated-mesh-3dtiles"}function j4(t){var e;return(t==null?void 0:t.type)==="feature"&&!t.url&&((e=t.source)==null?void 0:e.type)==="memory"}function Nvt(t){var i;const e=t==null?void 0:t.type;return(e==="feature"||e==="subtype-group"||e==="oriented-imagery")&&((i=t==null?void 0:t.source)==null?void 0:i.type)==="feature-layer"}async function yY(t,e){const i=Yi==null?void 0:Yi.findServerInfo(t);if((i==null?void 0:i.currentVersion)!=null)return i.owningSystemUrl||null;const s=t.toLowerCase().indexOf("/rest/services");if(s===-1)return null;const n=`${t.slice(0,s)}/rest/info`,r=e!=null?e.signal:null,{data:o}=await $n(n,{query:{f:"json"},responseType:"json",signal:r});return(o==null?void 0:o.owningSystemUrl)||null}function T0e(t){if(!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"sublayer":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}function UWe(t){return T0e(t)?"effectiveCapabilities"in t?t.effectiveCapabilities:t.capabilities:null}function VWe(t){if(!("editingEnabled"in t))return!1;switch(t.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":return!0;default:return!1}}function zWe(t){return!!VWe(t)&&("effectiveEditingEnabled"in t?t.effectiveEditingEnabled:t.editingEnabled)}const GWe=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wcs","wms","wmts"]),P0e=new Set(["catalog","csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","knowledge-graph","map-image","map-notes","media","ogc-feature","oriented-imagery","route","stream","subtype-group","tile","unknown","unsupported","vector-tile","web-tile","wcs","wfs","wms","wmts"]),BWe=new Set([...P0e,"link-chart"]);function qWe(t){switch(t.layerContainerType){case"basemap":return GWe;case"operational-layers":return t.origin==="link-chart"?BWe:P0e;default:return null}}function HWe(t,e){if(e.restrictedWebMapWriting){const i=qWe(e);return i==null||i.has(t.type)&&!j4(t)}return!0}function jWe(t,e){var i;if(e)if(j4(t)){const s=gF("featureCollection.layers",e),n=(i=s==null?void 0:s[0])==null?void 0:i.layerDefinition;n&&zse(t,n)}else t.type!=="group"&&zse(t,e)}function zse(t,e){"maxScale"in t&&(e.maxScale=_O(t.maxScale)??void 0),"minScale"in t&&(e.minScale=_O(t.minScale)??void 0)}function YWe(t,e){if(jWe(t,e),e&&(e.id=t.id,"blendMode"in t&&(e.blendMode=t.blendMode,e.blendMode==="normal"&&delete e.blendMode),e.opacity=_O(t.opacity)??void 0,e.title=t.title||"Layer",e.visibility=t.visible,"legendEnabled"in t&&t.type!=="wmts"))if(j4(t)){const i=e.featureCollection;i&&(i.showLegend=t.legendEnabled)}else e.showLegend=t.legendEnabled}function Gse(t,e,i){if(!t.persistenceEnabled)return null;if(!("write"in t)||!t.write)return i!=null&&i.messages&&i.messages.push(new Se("layer:unsupported",`Layers (${t.title}, ${t.id}) of type '${t.declaredClass}' cannot be persisted`,{layer:t})),null;if(j4(t)&&!t.isTable)e=t.resourceInfo;else if(HWe(t,i)){const s={};return t.write(s,i)?s:null}return e!=null&&YWe(t,e=be(e)),e}var rT;let XWe=0,Hu=rT=class extends it.JSONSupportMixin(Lf){constructor(t){super(t),this.id=null,this.portalItem=null,this.spatialReference=null,this.style=null,this.thumbnailUrl=null,this.title="Basemap",this.id=Date.now().toString(16)+"-basemap-"+XWe++,this.baseLayers=new Nt,this.referenceLayers=new Nt;const e=s=>{s.parent&&s.parent!==this&&"remove"in s.parent&&s.parent.remove(s),s.parent=this,s.type==="elevation"&&ht.getLogger(this).error(`Layer '${s.title}, id:${s.id}' of type '${s.type}' is not supported as a basemap layer and will therefore be ignored.`)},i=s=>{s.parent=null};this.addHandles([this.baseLayers.on("after-add",s=>e(s.item)),this.referenceLayers.on("after-add",s=>e(s.item)),this.baseLayers.on("after-remove",s=>i(s.item)),this.referenceLayers.on("after-remove",s=>i(s.item))])}initialize(){this.when().catch(t=>{ht.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,t)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const t=this.baseLayers.toArray();for(const i of t)i.destroy();const e=this.referenceLayers.toArray();for(const i of e)i.destroy();this.baseLayers.destroy(),this.referenceLayers.destroy(),this.portalItem=er(this.portalItem)}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}set baseLayers(t){this._set("baseLayers",Of(t,this._get("baseLayers")))}_writeBaseLayers(t,e,i){const s=[];t&&(i={...i,layerContainerType:"basemap"},this.baseLayers.forEach(n=>{const r=Gse(n,i.webmap?i.webmap.getLayerJSONFromResourceInfo(n):null,i);r!=null&&s.push(r)}),this.referenceLayers.forEach(n=>{const r=Gse(n,i.webmap?i.webmap.getLayerJSONFromResourceInfo(n):null,i);r!=null&&(n.type!=="scene"&&(r.isReference=!0),s.push(r))})),e.baseMapLayers=s}set referenceLayers(t){this._set("referenceLayers",Of(t,this._get("referenceLayers")))}writeTitle(t,e){e.title=t||"Basemap"}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return E0e(this,t=>{t(this.baseLayers,this.referenceLayers)})}clone(){const t={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(e=>cO(e)?e.clone():e),referenceLayers:this.referenceLayers.map(e=>cO(e)?e.clone():e)};return this.loaded&&(t.loadStatus="loaded"),new rT({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}write(t,e){var i;return t=t||{},e!=null&&e.origin||(e={origin:"web-map",...e}),super.write(t,e),!this.loaded&&((i=this.resourceInfo)!=null&&i.data.baseMapLayers)&&(t.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(s=>{const n=be(s);return n.url&&Lm(n.url)&&(n.url=`https:${n.url}`),n.templateUrl&&Lm(n.templateUrl)&&(n.templateUrl=`https:${n.templateUrl}`),n})),t}async _loadFromSource(t){const{resourceInfo:e,portalItem:i,style:s}=this;vr(t);const n=[];if(e){const r=e.context?e.context.url:null;if(n.push(this._loadLayersFromJSON(e.data,r,t)),e.data.id&&!e.data.title){const o=e.data.id;n.push(FWe(o).then(a=>{a&&this.read({title:a},e.context)}))}}else i?n.push(this._loadFromItem(i,t)):s&&n.push(this._loadFromStylesService(s,t));await Promise.all(n)}async _loadLayersFromJSON(t,e,i){var l,u;const s=(l=this.resourceInfo)==null?void 0:l.context,n=((u=this.portalItem)==null?void 0:u.portal)||(s==null?void 0:s.portal)||null,r=ZWe[(s==null?void 0:s.origin)||""]??"web-map",{populateOperationalLayers:o}=await _e(async()=>{const{populateOperationalLayers:c}=await import("./layersCreator-jvB-7Yhr.js");return{populateOperationalLayers:c}},__vite__mapDeps([182,29,28,27,30,26])),a=[];if(vr(i),t.baseMapLayers&&Array.isArray(t.baseMapLayers)){const c={context:{...s,origin:r,url:e,portal:n,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},h=f=>r==="web-scene"&&f.layerType==="ArcGISSceneServiceLayer"||f.isReference,d=o(this.baseLayers,t.baseMapLayers.filter(f=>!h(f)),c);a.push(d);const m=o(this.referenceLayers,t.baseMapLayers.filter(h),c);a.push(m)}await Promise.allSettled(a)}async _loadFromItem(t,e){const i=await t.load(e),s=await i.fetchData("json",e),n=ol(t.itemUrl??"");return this._set("resourceInfo",{data:s.baseMap??{},context:{origin:WWe[t.type||""]??"web-map",portal:t.portal||Cu.getDefault(),url:n}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:s.spatialReference},this.resourceInfo.context),this.read({title:t.title,thumbnailUrl:t.thumbnailUrl},{origin:"portal-item",portal:t.portal||Cu.getDefault(),url:n}),this._loadLayersFromJSON(this.resourceInfo.data,n,e)}async _loadFromStylesService(t,e){const i=t.serviceUrl.endsWith("/webmaps")?t.serviceUrl.slice(0,-8):t.serviceUrl,s=`${i}/styles/${t.id}/self`,n=`${i}/webmaps/${t.id}`,[r,o]=await Promise.all([(await $n(s,{query:{token:t.apiKey},signal:e==null?void 0:e.signal})).data,(await $n(n,{query:{language:t.languageParameter,places:t.places,worldview:t.worldview,token:t.apiKey},signal:e==null?void 0:e.signal})).data]);this.thumbnailUrl??(this.thumbnailUrl=r.thumbnailUrl);const a=ol(n);if(this._set("resourceInfo",{data:o.baseMap??{},context:{origin:"web-map",url:a}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:o.spatialReference},this.resourceInfo.context),await this._loadLayersFromJSON(this.resourceInfo.data,a,e),t.apiKey)for(const l of[...this.baseLayers,...this.referenceLayers])"apiKey"in l&&(l.apiKey=t.apiKey)}static fromId(t){const e=G8[t];return e?e.itemId?new rT({portalItem:{id:e.itemId,portal:{url:"https://www.arcgis.com"}}}):rT.fromJSON(e,{origin:e.is3d?"web-scene":"web-map"}):null}};y([S({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(t,e,i,s){this._writeBaseLayers(t,e,s)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:Nt}},writer(t,e,i,s){this._writeBaseLayers(t,e,s)}}}}}})],Hu.prototype,"baseLayers",null),y([S({type:String,json:{origins:{"web-scene":{write:!0}}}})],Hu.prototype,"id",void 0),y([S({type:rP})],Hu.prototype,"portalItem",void 0),y([S()],Hu.prototype,"referenceLayers",null),y([S({readOnly:!0})],Hu.prototype,"resourceInfo",void 0),y([S({type:Ri})],Hu.prototype,"spatialReference",void 0),y([S({type:kWe})],Hu.prototype,"style",void 0),y([S()],Hu.prototype,"thumbnailUrl",void 0),y([S({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],Hu.prototype,"title",void 0),y([yt("title")],Hu.prototype,"writeTitle",null),Hu=rT=y([se("esri.Basemap")],Hu);const WWe={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},ZWe={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"},oP=Hu,KWe=Object.freeze(Object.defineProperty({__proto__:null,default:oP},Symbol.toStringTag,{value:"Module"}));var q8;let A3=q8=class extends it{constructor(t){super(t),this.type="none"}clone(){return new q8({type:this.type})}};y([ai({none:"none",stayAbove:"stay-above"}),S({json:{write:{isRequired:!0}}})],A3.prototype,"type",void 0),A3=q8=y([se("esri.ground.NavigationConstraint")],A3);const QWe=Symbol("GroundInstance");var M0e,H8;let jp=H8=class extends it.JSONSupportMixin(Lf){constructor(t){super(t),this[M0e]=!0,this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new Nt;const e=s=>{s.parent&&s.parent!==this&&"remove"in s.parent&&s.parent.remove(s),s.parent=this,s.type!=="elevation"&&s.type!=="base-elevation"&&ht.getLogger(this).error(`Layer '${s.title}, id:${s.id}' of type '${s.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},i=s=>{s.parent=null};this.addHandles([this.layers.on("after-add",s=>e(s.item)),this.layers.on("after-remove",s=>i(s.item))])}initialize(){this.when().catch(t=>{cl(t)||ht.getLogger(this).error("#load()","Failed to load ground",t)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const t=this.layers.removeAll();for(const e of t)er(e);this.layers.destroy()}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}get layers(){return this._get("layers")}set layers(t){this._set("layers",Of(t,this._get("layers")))}writeLayers(t,e,i,s){const n=[];t&&(s={...s,layerContainerType:"ground"},t.forEach(r=>{if("write"in r){const o={};rEe(r)().write(o,s)&&n.push(o)}else s!=null&&s.messages&&s.messages.push(new Se("layer:unsupported",`Layers (${r.title}, ${r.id}) of type '${r.declaredClass}' cannot be persisted in the ground`,{layer:r}))})),e.layers=n}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return E0e(this,t=>{t(this.layers)})}async queryElevation(t,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:i}=await _e(()=>import("./ElevationQuery-GZ6OCQrB.js"),[]);vr(e);const s=new i,n=this.layers.filter(Bse).toArray();return s.queryAll(n,t,e)}async createElevationSampler(t,e){await this.load({signal:e==null?void 0:e.signal});const{ElevationQuery:i}=await _e(()=>import("./ElevationQuery-GZ6OCQrB.js"),[]);vr(e);const s=new i,n=this.layers.filter(Bse).toArray();return s.createSamplerAll(n,t,e)}clone(){const t={opacity:this.opacity,surfaceColor:be(this.surfaceColor),navigationConstraint:be(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(t.loadStatus="loaded"),new H8({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}_loadFromSource(t){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,t):Promise.resolve()}async _loadLayersFromJSON(t,e,i){const s=(e==null?void 0:e.origin)||"web-scene",n=(e==null?void 0:e.portal)||null,r=(e==null?void 0:e.url)||null,{populateOperationalLayers:o}=await _e(async()=>{const{populateOperationalLayers:l}=await import("./layersCreator-jvB-7Yhr.js");return{populateOperationalLayers:l}},__vite__mapDeps([182,29,28,27,30,26]));vr(i);const a=[];if(t.layers&&Array.isArray(t.layers)){const l={context:{origin:s,url:r,portal:n,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};a.push(o(this.layers,t.layers,l))}await Promise.allSettled(a)}};function JWe(t){return t&&"createElevationSampler"in t}function Bse(t){return t.type==="elevation"||JWe(t)}M0e=QWe,y([S({json:{read:!1,write:{isRequired:!0}}})],jp.prototype,"layers",null),y([yt("layers")],jp.prototype,"writeLayers",null),y([S({readOnly:!0})],jp.prototype,"resourceInfo",void 0),y([S({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:zs,read:{reader:IP,source:"transparency"},write:{writer:(t,e)=>{e.transparency=HF(t)},target:"transparency"}}})],jp.prototype,"opacity",void 0),y([S({type:Gt,json:{type:[zs],write:(t,e)=>{e.surfaceColor=t.toJSON().slice(0,3)}}})],jp.prototype,"surfaceColor",void 0),y([S({type:A3,json:{write:!0}})],jp.prototype,"navigationConstraint",void 0),jp=H8=y([se("esri.Ground")],jp);const $L=jp,HN=new WeakMap;function A0e(t){return!t.destroyed&&(HN.has(t)||t.addHandles([Ai(()=>{const e=t.parent;return!(!e||!("type"in e))&&(e.type==="catalog-dynamic-group"||A0e(e))},e=>HN.set(t,e),uu),Gs(()=>HN.delete(t))]),HN.get(t))}function eZe(t){return typeof t=="object"&&t!=null&&"loaded"in t&&t.loaded===!0&&"type"in t}function tZe(t){var e,i;return!(!eZe(t)||!((i=(e=UWe(t))==null?void 0:e.operations)!=null&&i.supportsEditing)||"editingEnabled"in t&&!zWe(t)||A0e(t))}const eV=()=>ht.getLogger("esri.support.basemapUtils");function iZe(){return{}}function sZe(t){for(const e in t){const i=t[e];er(i),delete t[e]}}function nZe(t,e){let i;if(typeof t=="string"){const s=t in G8,n=!s&&t.includes("/");if(!s&&!n){if(Ks.apiKey)eV().warn(`Unable to find basemap definition for: ${t}. See available styles at https://developers.arcgis.com/rest/basemap-styles/`);else{const r=Object.entries(G8).filter(([o,a])=>a.classic||a.is3d).map(([o])=>`"${o}"`).sort().join(", ");eV().warn(`Unable to find basemap definition for: ${t}. Try one of these: ${r}`)}return null}e&&(i=e[t]),i||(i=s?oP.fromId(t):new oP({style:{id:t}}),e&&(e[t]=i))}else i=xo(oP,t);return i!=null&&i.destroyed&&(eV().warn("The provided basemap is already destroyed",{basemap:i}),i=null),i}function rZe(t){return new gM({getCollections:()=>[t.tables,t.layers],getChildrenFunction:e=>{const i=[];return"tables"in e&&i.push(e.tables),"layers"in e&&i.push(e.layers),i},itemFilterFunction:e=>{const i=e.parent;return!!i&&"tables"in i&&i.tables.includes(e)}})}function tV(t){for(const e of t.values())e==null||e.destroy();t.clear()}const qse={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function oZe(t){let e=null;if(typeof t=="string")if(t in qse){const i=qse[t];e=new $L({resourceInfo:{data:{layers:[i]}}})}else ht.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${t}. Try "world-elevation"`);else e=xo($L,t);return e}function j8(t,e,i){let s,n;if(t)for(let r=0,o=t.length;r<o;r++){if(s=t.at(r),(s==null?void 0:s[e])===i)return s;if((s==null?void 0:s.type)==="group"&&(n=j8(s.layers,e,i),n))return n}}const aZe=t=>{let e=class extends t{constructor(...i){super(...i),this.layers=new Nt;const s=o=>{o.parent&&"remove"in o.parent&&o.parent.remove(o)},n=o=>{o.parent=this,this.layerAdded(o),o.type!=="elevation"&&o.type!=="base-elevation"||ht.getLogger(this).error(`Layer 'title:${o.title}, id:${o.id}' of type '${o.type}' is not supported as an operational layer and will therefore be ignored.`)},r=o=>{o.parent=null,this.layerRemoved(o)};this.addHandles([this.layers.on("before-add",o=>{if(o.item===this)return o.preventDefault(),void ht.getLogger(this).error("#add()","Cannot add layer to itself.");s(o.item)}),this.layers.on("after-add",o=>n(o.item)),this.layers.on("after-remove",o=>r(o.item))])}destroy(){const i=this.layers.toArray();for(const s of i)s.destroy();this.layers.destroy()}set layers(i){this._set("layers",Of(i,this._get("layers")))}add(i,s){const n=this.layers;if(s=n.getNextIndex(s),i instanceof A4){const r=i;r.parent===this?this.reorder(r,s):n.add(r,s)}else Hm(i)?i.then(r=>{this.destroyed||this.add(r,s)}):ht.getLogger(this).error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(i,s){const n=this.layers;let r=n.getNextIndex(s);i.slice().forEach(o=>{o.parent!==this?(n.add(o,r),r+=1):this.reorder(o,r)})}findLayerById(i){return j8(this.layers,"id",i)}findLayerByUid(i){return j8(this.layers,"uid",i)}remove(i){return this.layers.remove(i)}removeMany(i){return this.layers.removeMany(i)}removeAll(){return this.layers.removeAll()}reorder(i,s){return this.layers.reorder(i,s)}layerAdded(i){}layerRemoved(i){}};return y([S()],e.prototype,"layers",null),e=y([se("esri.support.LayersMixin")],e),e},lZe=new Set(["feature","subtype-group"]);function Y8(t,e,i){if(t)for(let s=0,n=t.length;s<n;s++){const r=t.at(s);if(r[e]===i)return r;if((r==null?void 0:r.type)==="group"){const o=Y8(r.tables,e,i);if(o)return o}}}const uZe=t=>{let e=class extends t{constructor(...i){super(...i),this.tables=new Nt,this.addHandles([this.tables.on("after-add",s=>{const n=s.item;n.parent&&n.parent!==this&&"tables"in n.parent&&n.parent.tables.remove(n),n.parent=this,lZe.has(n.type)||ht.getLogger(this).error(`Layer 'title:${n.title}, id:${n.id}' of type '${n.type}' is not supported as a table and will therefore be ignored.`)}),this.tables.on("after-remove",s=>{s.item.parent=null})])}destroy(){const i=this.tables.toArray();for(const s of i)s.destroy();this.tables.destroy()}set tables(i){this._set("tables",Of(i,this._get("tables")))}findTableById(i){return Y8(this.tables,"id",i)}findTableByUid(i){return Y8(this.tables,"uid",i)}};return y([S()],e.prototype,"tables",null),e=y([se("esri.support.TablesMixin")],e),e};let Bh=class extends uZe(aZe(vd.EventedMixin(ei))){constructor(e){super(e),this.allLayers=new gM({getCollections:()=>{var i,s,n;return[(i=this.basemap)==null?void 0:i.baseLayers,(s=this.ground)==null?void 0:s.layers,this.layers,(n=this.basemap)==null?void 0:n.referenceLayers]},getChildrenFunction:i=>"layers"in i?i.layers:null}),this.allTables=rZe(this),this.basemap=null,this.editableLayers=new gM({getCollections:()=>[this.allLayers],itemFilterFunction:tZe}),this.ground=new $L,this._basemapCache=iZe()}destroy(){sZe(this._basemapCache),this._basemapCache=null,this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),this.basemap=er(this.basemap),er(this.ground),this._set("ground",null)}castBasemap(e){return nZe(e,this._basemapCache)}castGround(e){return oZe(e)??this._get("ground")}findLayerById(e){return this.allLayers.find(i=>i.id===e)}findTableById(e){return this.allTables.find(i=>i.id===e)}};y([S({readOnly:!0,dependsOn:[]})],Bh.prototype,"allLayers",void 0),y([S({readOnly:!0})],Bh.prototype,"allTables",void 0),y([S({type:oP,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],Bh.prototype,"basemap",void 0),y([Ls("basemap")],Bh.prototype,"castBasemap",null),y([S({readOnly:!0})],Bh.prototype,"editableLayers",void 0),y([S({type:$L,nonNullable:!0})],Bh.prototype,"ground",void 0),y([Ls("ground")],Bh.prototype,"castGround",null),y([S()],Bh.prototype,"undoRedo",void 0),Bh=y([se("esri.Map")],Bh);const I0e=Bh;var oT;const UL=ca()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),D0e=UL.jsonValues.slice();aEe(D0e,"orthometric");const aP=ca()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let qh=oT=class extends it{constructor(t){super(t),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(t,e,i){return UL.write(t,e,i)}readHeightModel(t,e,i){return UL.read(t)||(i!=null&&i.messages&&i.messages.push(cZe(t,{context:i})),null)}readHeightUnit(t,e,i){return aP.read(t)||(i!=null&&i.messages&&i.messages.push(Hse(t,{context:i})),null)}readHeightUnitService(t,e,i){return RH(t)||aP.read(t)||(i!=null&&i.messages&&i.messages.push(Hse(t,{context:i})),null)}readVertCRS(t,e){return e.vertCRS||e.ellipsoid||e.geoid}clone(){return new oT({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(t){return!!t&&(this===t||this.heightModel===t.heightModel&&this.heightUnit===t.heightUnit&&this.vertCRS===t.vertCRS)}static deriveUnitFromSR(t,e){const i=Lce(e);return new oT({heightModel:t.heightModel,heightUnit:i??void 0,vertCRS:t.vertCRS})}write(t,e){return e={origin:"web-scene",...e},super.write(t,e)}static fromJSON(t){if(!t)return null;const e=new oT;return e.read(t,{origin:"web-scene"}),e}};function Hse(t,e){return new ih("height-unit:unsupported",`Height unit of value '${t}' is not supported`,e)}function cZe(t,e){return new ih("height-model:unsupported",`Height model of value '${t}' is not supported`,e)}y([S({type:UL.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:D0e,default:"ellipsoidal",write:{isRequired:!0}}}}})],qh.prototype,"heightModel",void 0),y([yt("web-scene","heightModel")],qh.prototype,"writeHeightModel",null),y([mt(["web-scene","service"],"heightModel")],qh.prototype,"readHeightModel",null),y([S({type:aP.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:aP.jsonValues,write:{writer:aP.write,isRequired:!0}}}}})],qh.prototype,"heightUnit",void 0),y([mt("web-scene","heightUnit")],qh.prototype,"readHeightUnit",null),y([mt("service","heightUnit")],qh.prototype,"readHeightUnitService",null),y([S({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],qh.prototype,"vertCRS",void 0),y([mt("service","vertCRS",["vertCRS","ellipsoid","geoid"])],qh.prototype,"readVertCRS",null),qh=oT=y([se("esri.geometry.HeightModelInfo")],qh);const SA=qh;let VL=class extends QT{constructor(e){super(e),this.addHandles(this.on("before-add",i=>{i.item!=null&&i.item.parent===this.owner&&(ht.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),i.preventDefault())}))}_own(e){e.parent=this.owner}_release(e){e.parent=null}};VL=y([se("esri.support.AnalysesCollection")],VL);let __=class extends ei{constructor(e){super(e),this.view=null,this.baseLayerViews=new Nt,this.referenceLayerViews=new Nt,this._loadingHandle=Ai(()=>{var i,s;return(s=(i=this.view)==null?void 0:i.map)==null?void 0:s.basemap},i=>{i&&i.load().catch(()=>{})},nl)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);for(const e of this.baseLayerViews)e.destroy();this.baseLayerViews.length=0;for(const e of this.referenceLayerViews)e.destroy();this.referenceLayerViews.length=0}get suspended(){var e;return((e=this.view)==null?void 0:e.suspended)??!0}get updating(){var i,s,n;if((i=this.view)!=null&&i.suspended)return!1;const e=(n=(s=this.view)==null?void 0:s.map)==null?void 0:n.basemap;return!!(e!=null&&e.loaded)&&(this.baseLayerViews.some(r=>r.updating)||this.referenceLayerViews.some(r=>r.updating))}};y([S({constructOnly:!0})],__.prototype,"view",void 0),y([S({readOnly:!0})],__.prototype,"baseLayerViews",void 0),y([S({readOnly:!0})],__.prototype,"referenceLayerViews",void 0),y([S({readOnly:!0})],__.prototype,"suspended",null),y([S({type:Boolean,readOnly:!0})],__.prototype,"updating",null),__=y([se("esri.views.BasemapView")],__);const hZe=__;function dZe(t){return"tryRecycleWith"in t}function mZe(t){return t!=null&&typeof t=="object"&&"layerViews"in t}let pZe=class{constructor(e,i,s){this.layer=e,this.view=i,this.layerViewImporter=s,this._controller=new AbortController,this._deferred=mc(),this._started=!1,this.done=!1,this.promise=this._deferred.promise,Jc(this._controller.signal,()=>{const n=new Se("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(n)})}tryRecycle(e){if(!this.done||!this.layerView||!dZe(this.layerView))return null;const i=this.layer.type,s=this._controller.signal;for(let n=0;n<e.length;n++){const r=e[n];if(r.type!==i)continue;const o=this.layerView.tryRecycleWith(r,{signal:s});if(o){e.splice(n,1),this.layer=r;const a=this.layerView,l=a.view;return this.promise=Promise.race([o.then(()=>(vr(this._controller.signal),r.emit("layerview-destroy",{view:l,layerView:a}),l.emit("layerview-destroy",{view:l,layerView:a}),r.emit("layerview-create",{view:l,layerView:a}),l.emit("layerview-create",{view:l,layerView:a}),a)),new Promise((u,c)=>Jc(this._controller.signal,()=>c(Vn())))]),this.promise}}return null}destroy(){this._controller.abort();const{layerView:e}=this;if(e){const{layer:i,view:s}=this;i.emit("layerview-destroy",{view:s,layerView:e}),s.emit("layerview-destroy",{layer:i,layerView:e})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null}async start(){var n,r;if(this._started)return;this._started=!0;const{_controller:{signal:e},layer:i,view:s}=this;this._map=s.map;try{let o,a;if(await i.load({signal:e}),i.prefetchResources&&await i.prefetchResources({signal:e}),gZe(i))o=await i.createLayerView(s,{signal:e});else{if(!this.layerViewImporter.hasLayerViewModule(i))throw new Se("layer:view-not-supported","No layerview implementation was found");const c=await this.layerViewImporter.importLayerView(i);vr(e),o="default"in c?new c.default({layer:i,view:s}):new c({layer:i,view:s})}const l=()=>{a=sr(a),o.destroyed||o.destroy(),o.layer=null,o.parent=null,o.view=null,this.done=!0};a=Jc(e,l),vr(e);try{await o.when()}catch(c){throw l(),c}if(!((r=(n=this._map)==null?void 0:n.allLayers)==null?void 0:r.includes(i)))return l(),void this._deferred.reject(new Se("view:no-layerview-for-layer","The layer has been removed from the map",{layer:i}));this.layerView=o,i.emit("layerview-create",{view:s,layerView:o}),s.emit("layerview-create",{layer:i,layerView:o}),this.done=!0,this._deferred.resolve(o)}catch(o){i.emit("layerview-create-error",{view:s,error:o}),s.emit("layerview-create-error",{layer:i,error:o}),this.done=!0,this._deferred.reject(new Se("layerview:create-error","layerview creation failed",{layer:i,error:o}))}}},Lc=class extends ei{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new i1,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var s;const i=(s=this.view.map)==null?void 0:s.allLayers;if(i)for(const n of i)this.layerViewImporter.hasLayerViewModule(n)&&this.layerViewImporter.importLayerView(n)},this._reschedule=()=>this.destroyed?Promise.reject():(this._workPromise==null&&(this._workPromise=mc(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(VM(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var l,u,c;if(this.destroyed)return;const i=this.view.map;if(this._map!==i&&(this.clear(),this._map=i),this._workPromise==null)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const s=new Set,n=[],r=this.view.ready,o=h=>{if(h!=null){for(const d of h)if(d){s.add(d);const m=this._layerLayerViewInfoMap.get(d);m&&r?m.start():m||this._recyclingInfoMap.has(d)||n.push(d),"layers"in d&&d.layers&&o(d.layers)}}};for(const h of this._rootCollectionNames)o(Tm(this,h));for(const[h,d]of this._layerLayerViewInfoMap)if(!s.has(h)){this._layerLayerViewInfoMap.delete(d.layer);const m=d.tryRecycle(n);m?(this.notifyChange("updating"),this._recyclingInfoMap.set(d.layer,d),m.then(()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(d.layer),this._layerLayerViewInfoMap.set(d.layer,d),this._reschedule()}).catch(()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(d.layer),d.destroy(),this._reschedule()})):d.destroy()}for(const[h,d]of this._recyclingInfoMap)s.has(h)||(this.notifyChange("updating"),this._recyclingInfoMap.delete(d.layer),d.destroy());for(const h of n)this._createLayerView(h);this._refreshCollections();const a=[(l=i==null?void 0:i.ground)==null?void 0:l.layers,(u=i==null?void 0:i.basemap)==null?void 0:u.baseLayers,(c=i==null?void 0:i.basemap)==null?void 0:c.referenceLayers,i==null?void 0:i.layers].filter(h=>!!h);s.forEach(h=>"layers"in h&&a.push(h.layers)),this.addHandles(a.map(h=>this._watchUpdatingTracking.addOnCollectionChange(()=>h,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.addHandles([yy(()=>{var e,i;return(i=(e=this.view)==null?void 0:e.map)==null?void 0:i.allLayers},"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),Ai(()=>{const e=this.view,i=e==null?void 0:e.map;return[i==null?void 0:i.basemap,i==null?void 0:i.ground,i==null?void 0:i.layers,e==null?void 0:e.ready]},()=>this._reschedule(),uu)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),tV(this._recyclingInfoMap),tV(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,this._workPromise!=null&&(this._workPromise.reject(Vn()),this._workPromise=null)}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return this._workPromise!=null||this._watchUpdatingTracking.updating||_Ee(this._layerLayerViewInfoMap,e=>!e.done)||this._recyclingInfoMap.size>0}get updatingRemaining(){let e=0;for(const i of this._layerLayerViewInfoMap.values())i.done||++e;return e}clear(){this.destroyed||(tV(this._layerLayerViewInfoMap),this._refreshCollections())}async whenLayerView(e){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(e)){if(this._recyclingInfoMap.has(e))return this._recyclingInfoMap.get(e).promise;throw new Se("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e})}return this._layerLayerViewInfoMap.get(e).promise}isCreatingLayerViewsForLayer(e,i){var r;this.commitProperty("updatingRemaining");const s=this._layerLayerViewInfoMap.get(e);if(!(s!=null&&s.done))return!0;const n=s.layerView;return!(!n||!i||n.parent===i)||!!(s.done&&n&&"layers"in e&&((r=e.layers)!=null&&r.length))&&e.layers.some(o=>this.isCreatingLayerViewsForLayer(o,n))}_refreshCollections(){for(const[e,i]of this._layersToLayerViews)this._populateLayerViewsOwners(Tm(this,e),Tm(this,i),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(e,i,s){if(!e||!i)return void(i&&i.removeAll());let n=0;for(const r of e){const o=this._layerLayerViewInfoMap.get(r);if(!(o!=null&&o.layerView))continue;const a=o.layerView;a.layer=r,a.parent=s,i.at(n)!==a&&i.splice(n,0,a),"layers"in r&&mZe(a)&&this._populateLayerViewsOwners(r.layers,a.layerViews,a),n+=1}n<i.length&&i.splice(n,i.length)}_createLayerView(e){e.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const i=new pZe(e,this.view,this.layerViewImporter);i.promise.then(()=>this._refreshCollections(),s=>{s&&(cl(s)||s.name==="cancelled:layerview-create")||ht.getLogger(this).error(`Failed to create layerview for layer title:'${e.title??"no title"}', id:'${e.id??"no id"}' of type '${e.type}'.`,{layer:e,error:s}),this._refreshCollections()}),this._layerLayerViewInfoMap.set(e,i),this.view.ready&&i.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};y([S()],Lc.prototype,"_workPromise",void 0),y([S({readOnly:!0})],Lc.prototype,"_watchUpdatingTracking",void 0),y([S({readOnly:!0})],Lc.prototype,"_layersToLayerViews",null),y([S({readOnly:!0})],Lc.prototype,"_rootCollectionNames",null),y([S()],Lc.prototype,"layerViewImporter",void 0),y([S()],Lc.prototype,"supportsGround",void 0),y([S({readOnly:!0})],Lc.prototype,"updating",null),y([S({readOnly:!0})],Lc.prototype,"updatingRemaining",null),y([S({constructOnly:!0})],Lc.prototype,"view",void 0),Lc=y([se("esri.views.LayerViewManager")],Lc);const fZe=Lc;function gZe(t){return t.createLayerView!==A4.prototype.createLayerView}let ju=class extends ei{constructor(e){super(e),this.factor=1.5,this.offset=oa(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};y([S({type:Number})],ju.prototype,"factor",void 0),y([S({nonNullable:!0})],ju.prototype,"offset",void 0),y([S()],ju.prototype,"position",void 0),y([S({type:Number,range:{min:0}})],ju.prototype,"size",void 0),y([S()],ju.prototype,"maskUrl",void 0),y([S()],ju.prototype,"maskEnabled",void 0),y([S()],ju.prototype,"overlayUrl",void 0),y([S()],ju.prototype,"overlayEnabled",void 0),y([S({readOnly:!0})],ju.prototype,"version",null),y([S({type:Boolean})],ju.prototype,"visible",void 0),ju=y([se("esri.views.Magnifier")],ju);const N0e=ju;let I3=class{constructor(e){this._observable=new HM,this._map=new Map(e)}get size(){return fi(this._observable),this._map.size}clear(){this._map.size>0&&(this._map.clear(),this._observable.notify())}delete(e){const i=this._map.delete(e);return i&&this._observable.notify(),i}entries(){return fi(this._observable),this._map.entries()}forEach(e,i){fi(this._observable),this._map.forEach((s,n)=>e.call(i,s,n,this),i)}get(e){return fi(this._observable),this._map.get(e)}has(e){return fi(this._observable),this._map.has(e)}keys(){return fi(this._observable),this._map.keys()}set(e,i){return this._map.set(e,i),this._observable.notify(),this}values(){return fi(this._observable),this._map.values()}[Symbol.iterator](){return fi(this._observable),this._map[Symbol.iterator]()}[Symbol.dispose](){this._observable.destroy()}get[Symbol.toStringTag](){return this._map[Symbol.toStringTag]}};var X8;let Bv=X8=class extends it{constructor(t){super(t),this.name=null,this.code=null}clone(){return new X8({name:this.name,code:this.code})}};y([S({type:String,json:{write:{isRequired:!0}}})],Bv.prototype,"name",void 0),y([S({type:[String,Number],json:{write:{isRequired:!0}}})],Bv.prototype,"code",void 0),Bv=X8=y([se("esri.layers.support.CodedValue")],Bv);const _Ze=new gs({inherited:"inherited",codedValue:"coded-value",range:"range"});let aT=class extends it{constructor(e){super(e),this.name=null,this.type=null}};y([S({type:String,json:{write:!0}})],aT.prototype,"name",void 0),y([ai(_Ze),S({json:{write:{isRequired:!0}}})],aT.prototype,"type",void 0),aT=y([se("esri.layers.support.Domain")],aT);const Y4=aT;var W8;let lT=W8=class extends Y4{constructor(t){super(t),this.codedValues=null,this.type="coded-value"}getName(t){let e=null;if(this.codedValues){const i=String(t);this.codedValues.some(s=>(String(s.code)===i&&(e=s.name),!!e))}return e}clone(){return new W8({codedValues:be(this.codedValues),name:this.name})}};y([S({type:[Bv],json:{write:{isRequired:!0}}})],lT.prototype,"codedValues",void 0),y([ai({codedValue:"coded-value"})],lT.prototype,"type",void 0),lT=W8=y([se("esri.layers.support.CodedValueDomain")],lT);const X4=lT;var Z8;let D3=Z8=class extends Y4{constructor(t){super(t),this.type="inherited"}clone(){return new Z8}};y([ai({inherited:"inherited"})],D3.prototype,"type",void 0),D3=Z8=y([se("esri.layers.support.InheritedDomain")],D3);const R0e=D3;var K8;let Mb=K8=class extends Y4{constructor(t){super(t),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new K8({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};y([S({json:{type:[Number],read:{source:"range",reader:(t,e)=>{var i;return(i=e.range)==null?void 0:i[1]}},write:{enabled:!1,overridePolicy(){return{enabled:this.maxValue!=null&&this.minValue==null}},target:"range",writer(t,e,i){e[i]=[this.minValue||0,t]},isRequired:!0}}})],Mb.prototype,"maxValue",void 0),y([S({json:{type:[Number],read:{source:"range",reader:(t,e)=>{var i;return(i=e.range)==null?void 0:i[0]}},write:{target:"range",writer(t,e,i){e[i]=[t,this.maxValue||0]},isRequired:!0}}})],Mb.prototype,"minValue",void 0),y([ai({range:"range"})],Mb.prototype,"type",void 0),Mb=K8=y([se("esri.layers.support.RangeDomain")],Mb);const O0e=Mb,L0e={key:"type",base:Y4,typeMap:{range:O0e,"coded-value":X4,inherited:R0e}};function W4(t){if(!(t!=null&&t.type))return null;switch(t.type){case"range":return O0e.fromJSON(t);case"codedValue":return X4.fromJSON(t);case"inherited":return R0e.fromJSON(t)}return null}const yZe=new gs({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});var Q8;const vZe=new gs({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});let Xa=Q8=class extends it{constructor(t){super(t),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=void 0,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(t,{description:e}){let i=null;try{i=e?JSON.parse(e):null}catch{}return(i==null?void 0:i.value)??null}readValueType(t,{description:e}){let i=null;try{i=e?JSON.parse(e):null}catch{}return i?vZe.fromJSON(i.fieldValueType):null}clone(){var t;return new Q8({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:((t=this.domain)==null?void 0:t.clone())??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}};y([S({type:String,json:{write:!0}})],Xa.prototype,"alias",void 0),y([S({type:[String,Number],json:{write:{allowNull:!0}}})],Xa.prototype,"defaultValue",void 0),y([S()],Xa.prototype,"description",void 0),y([mt("description")],Xa.prototype,"readDescription",null),y([S({types:L0e,json:{read:{reader:W4},write:!0}})],Xa.prototype,"domain",void 0),y([S({type:Boolean,json:{write:!0}})],Xa.prototype,"editable",void 0),y([S({type:zs,json:{write:{overridePolicy:t=>({enabled:Number.isFinite(t)})}}})],Xa.prototype,"length",void 0),y([S({type:String,json:{write:!0}})],Xa.prototype,"name",void 0),y([S({type:Boolean,json:{write:!0}})],Xa.prototype,"nullable",void 0),y([ai(yZe)],Xa.prototype,"type",void 0),y([S()],Xa.prototype,"valueType",void 0),y([mt("valueType",["description"])],Xa.prototype,"readValueType",null),y([S({type:Boolean,json:{read:!1}})],Xa.prototype,"visible",void 0),Xa=Q8=y([se("esri.layers.support.Field")],Xa);const vY=Xa;var J8;let Ab=J8=class extends it{constructor(t){super(t),this.type="map-layer"}clone(){const{mapLayerId:t,gdbVersion:e}=this;return new J8({mapLayerId:t,gdbVersion:e})}};y([ai({mapLayer:"map-layer"}),S({json:{write:{isRequired:!0}}})],Ab.prototype,"type",void 0),y([S({type:zs,json:{write:{isRequired:!0}}})],Ab.prototype,"mapLayerId",void 0),y([S({type:String,json:{write:!0}})],Ab.prototype,"gdbVersion",void 0),Ab=J8=y([se("esri.layers.support.source.MapLayerSource")],Ab);var eq;let Yp=eq=class extends it{constructor(t){super(t),this.type="query-table"}clone(){const{workspaceId:t,query:e,oidFields:i,spatialReference:s,geometryType:n}=this,r={workspaceId:t,query:e,oidFields:i,spatialReference:(s==null?void 0:s.clone())??void 0,geometryType:n};return new eq(r)}};y([ai({queryTable:"query-table"}),S({json:{write:{isRequired:!0}}})],Yp.prototype,"type",void 0),y([S({type:String,json:{write:!0}})],Yp.prototype,"workspaceId",void 0),y([S({type:String,json:{write:!0}})],Yp.prototype,"query",void 0),y([S({type:String,json:{write:!0}})],Yp.prototype,"oidFields",void 0),y([S({type:Ri,json:{write:!0}})],Yp.prototype,"spatialReference",void 0),y([ai(uNe)],Yp.prototype,"geometryType",void 0),Yp=eq=y([se("esri.layers.support.source.QueryTableDataSource")],Yp);var tq;let Ib=tq=class extends it{constructor(t){super(t),this.type="raster"}clone(){const{workspaceId:t,dataSourceName:e}=this;return new tq({workspaceId:t,dataSourceName:e})}};y([ai({raster:"raster"}),S({json:{write:{isRequired:!0}}})],Ib.prototype,"type",void 0),y([S({type:String,json:{write:!0}})],Ib.prototype,"dataSourceName",void 0),y([S({type:String,json:{write:!0}})],Ib.prototype,"workspaceId",void 0),Ib=tq=y([se("esri.layers.support.source.RasterDataSource")],Ib);var iq;let tv=iq=class extends it{constructor(t){super(t),this.type="table"}clone(){const{workspaceId:t,gdbVersion:e,dataSourceName:i}=this;return new iq({workspaceId:t,gdbVersion:e,dataSourceName:i})}};y([ai({table:"table"}),S({json:{write:{isRequired:!0}}})],tv.prototype,"type",void 0),y([S({type:String,json:{write:!0}})],tv.prototype,"workspaceId",void 0),y([S({type:String,json:{write:!0}})],tv.prototype,"gdbVersion",void 0),y([S({type:String,json:{write:!0}})],tv.prototype,"dataSourceName",void 0),tv=iq=y([se("esri.layers.support.source.TableDataSource")],tv);var sq,nq;const xZe=ca()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let Yu=sq=class extends it{constructor(t){super(t),this.type="join-table"}readLeftTableSource(t,e,i){return jse()(t,e,i)}castLeftTableSource(t){return _d(rq(),t)}readRightTableSource(t,e,i){return jse()(t,e,i)}castRightTableSource(t){return _d(rq(),t)}clone(){const{leftTableKey:t,rightTableKey:e,leftTableSource:i,rightTableSource:s,joinType:n}=this,r={leftTableKey:t,rightTableKey:e,leftTableSource:(i==null?void 0:i.clone())??void 0,rightTableSource:(s==null?void 0:s.clone())??void 0,joinType:n};return new sq(r)}};y([ai({joinTable:"join-table"}),S({json:{write:{isRequired:!0}}})],Yu.prototype,"type",void 0),y([S({type:String,json:{write:!0}})],Yu.prototype,"leftTableKey",void 0),y([S({type:String,json:{write:!0}})],Yu.prototype,"rightTableKey",void 0),y([S({json:{write:!0}})],Yu.prototype,"leftTableSource",void 0),y([mt("leftTableSource")],Yu.prototype,"readLeftTableSource",null),y([Ls("leftTableSource")],Yu.prototype,"castLeftTableSource",null),y([S({json:{write:!0}})],Yu.prototype,"rightTableSource",void 0),y([mt("rightTableSource")],Yu.prototype,"readRightTableSource",null),y([Ls("rightTableSource")],Yu.prototype,"castRightTableSource",null),y([ai(xZe)],Yu.prototype,"joinType",void 0),Yu=sq=y([se("esri.layers.support.source.JoinTableDataSource")],Yu);let iV=null;function jse(){return iV||(iV=LS({types:rq()})),iV}let sV=null;function rq(){return sV||(sV={key:"type",base:null,typeMap:{"data-layer":ed,"map-layer":Ab}}),sV}const bZe={key:"type",base:null,typeMap:{"join-table":Yu,"query-table":Yp,raster:Ib,table:tv}};let ed=nq=class extends it{constructor(t){super(t),this.type="data-layer"}clone(){const{fields:t,dataSource:e}=this;return new nq({fields:t,dataSource:e})}};y([ai({dataLayer:"data-layer"}),S({json:{write:{isRequired:!0}}})],ed.prototype,"type",void 0),y([S({type:[vY],json:{write:!0}})],ed.prototype,"fields",void 0),y([S({types:bZe,json:{write:!0}})],ed.prototype,"dataSource",void 0),ed=nq=y([se("esri.layers.support.source.DataLayerSource")],ed),ed.from=xo(ed);let iv=class extends bs.ClonableMixin(it){constructor(e){super(e),this.onFields=null,this.operator=null,this.searchTerm=null,this.searchType=null}};y([S({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.onFields!=null&&this.onFields.length>0}}}}})],iv.prototype,"onFields",void 0),y([S({type:String,json:{write:!0}})],iv.prototype,"operator",void 0),y([S({type:String,json:{write:!0}})],iv.prototype,"searchTerm",void 0),y([S({type:String,json:{write:!0}})],iv.prototype,"searchType",void 0),iv=y([se("esri.rest.support.FullTextSearch")],iv);const wZe=iv;var oq;const Yse=new gs({upperLeft:"upper-left",lowerLeft:"lower-left"});let sv=oq=class extends it{constructor(t){super(t),this.extent=null,this.mode="view",this.originPosition="upper-left",this.tolerance=1}clone(){return new oq(be({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};y([S({type:Nn,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],sv.prototype,"extent",void 0),y([S({type:["view","edit"],json:{write:!0}})],sv.prototype,"mode",void 0),y([S({type:String,json:{read:Yse.read,write:Yse.write}})],sv.prototype,"originPosition",void 0),y([S({type:Number,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],sv.prototype,"tolerance",void 0),sv=oq=y([se("esri.rest.support.QuantizationParameters")],sv);const F0e=sv,SZe=new gs({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});var aq;const Xse=new gs({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});let Hh=aq=class extends it{constructor(t){super(t),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(t,e){this.statisticType!=="percentile-continuous"&&this.statisticType!=="percentile-discrete"||(e.statisticParameters=be(t))}clone(){return new aq({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:be(this.statisticParameters)})}};y([S({type:Number,json:{write:!0}})],Hh.prototype,"maxPointCount",void 0),y([S({type:Number,json:{write:!0}})],Hh.prototype,"maxRecordCount",void 0),y([S({type:Number,json:{write:!0}})],Hh.prototype,"maxVertexCount",void 0),y([S({type:String,json:{write:!0}})],Hh.prototype,"onStatisticField",void 0),y([S({type:String,json:{write:!0}})],Hh.prototype,"outStatisticFieldName",void 0),y([S({type:String,json:{read:{source:"statisticType",reader:Xse.read},write:{target:"statisticType",writer:Xse.write}}})],Hh.prototype,"statisticType",void 0),y([S({type:Object})],Hh.prototype,"statisticParameters",void 0),y([yt("statisticParameters")],Hh.prototype,"writeStatisticParameters",null),Hh=aq=y([se("esri.rest.support.StatisticDefinition")],Hh);const EZe=Hh;var N3;const CZe=new gs({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let pi=N3=class extends it{static from(t){return OS(N3,t)}constructor(t){super(t),this.aggregateIds=null,this.cacheHint=void 0,this.compactGeometryEnabled=!1,this.datumTransformation=null,this.defaultSpatialReferenceEnabled=!1,this.distance=void 0,this.dynamicDataSource=void 0,this.formatOf3DObjects=null,this.fullText=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.returnTrueCurves=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.timeReferenceUnknownClient=!1,this.units=null,this.where=null}castDatumTransformation(t){return typeof t=="number"||typeof t=="object"?t:null}writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime()}writeParameterValues(t,e){if(t){const i={};for(const s in t){const n=t[s];Array.isArray(n)?i[s]=n.map(r=>r instanceof Date?r.getTime():r):n instanceof Date?i[s]=n.getTime():i[s]=n}e.parameterValues=i}}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10,e.where="1=1"}writeWhere(t,e){e.where=t||"1=1"}clone(){return new N3(be({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,formatOf3DObjects:this.formatOf3DObjects,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:this.historicMoment!=null?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,returnTrueCurves:this.returnTrueCurves,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}};pi.MAX_MAX_RECORD_COUNT_FACTOR=5,y([S({json:{write:!0}})],pi.prototype,"aggregateIds",void 0),y([S({type:Boolean,json:{write:!0}})],pi.prototype,"cacheHint",void 0),y([S({type:Boolean,json:{default:!1,write:!0}})],pi.prototype,"compactGeometryEnabled",void 0),y([S({json:{write:!0}})],pi.prototype,"datumTransformation",void 0),y([Ls("datumTransformation")],pi.prototype,"castDatumTransformation",null),y([S({type:Boolean,json:{default:!1,write:!0}})],pi.prototype,"defaultSpatialReferenceEnabled",void 0),y([S({type:Number,json:{write:!0}})],pi.prototype,"distance",void 0),y([S({type:ed,json:{write:!0}})],pi.prototype,"dynamicDataSource",void 0),y([S({type:String,json:{write:!0}})],pi.prototype,"formatOf3DObjects",void 0),y([S({type:[wZe],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.fullText!=null&&this.fullText.length>0}}}}})],pi.prototype,"fullText",void 0),y([S({type:String,json:{write:!0}})],pi.prototype,"gdbVersion",void 0),y([S({types:QM,json:{read:f1,write:!0}})],pi.prototype,"geometry",void 0),y([S({type:Number,json:{write:!0}})],pi.prototype,"geometryPrecision",void 0),y([S({type:[String],json:{write:!0}})],pi.prototype,"groupByFieldsForStatistics",void 0),y([S({type:String,json:{write:!0}})],pi.prototype,"having",void 0),y([S({type:Date})],pi.prototype,"historicMoment",void 0),y([yt("historicMoment")],pi.prototype,"writeHistoricMoment",null),y([S({type:Number,json:{write:!0}})],pi.prototype,"maxAllowableOffset",void 0),y([S({type:Number,cast:t=>t<1?1:t>pi.MAX_MAX_RECORD_COUNT_FACTOR?pi.MAX_MAX_RECORD_COUNT_FACTOR:t,json:{write:{overridePolicy:t=>({enabled:t>1})}}})],pi.prototype,"maxRecordCountFactor",void 0),y([S({type:["xyFootprint"],json:{write:!0}})],pi.prototype,"multipatchOption",void 0),y([S({type:Number,json:{read:{source:"resultRecordCount"}}})],pi.prototype,"num",void 0),y([S({json:{write:!0}})],pi.prototype,"objectIds",void 0),y([S({type:[String],json:{write:!0}})],pi.prototype,"orderByFields",void 0),y([S({type:[String],json:{write:!0}})],pi.prototype,"outFields",void 0),y([S({type:Ri,json:{name:"outSR",write:!0}})],pi.prototype,"outSpatialReference",void 0),y([S({type:[EZe],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.outStatistics!=null&&this.outStatistics.length>0}}}}})],pi.prototype,"outStatistics",void 0),y([S({json:{write:!0}})],pi.prototype,"parameterValues",void 0),y([yt("parameterValues")],pi.prototype,"writeParameterValues",null),y([S({type:ki,json:{write:!0}})],pi.prototype,"pixelSize",void 0),y([S({type:F0e,json:{write:!0}})],pi.prototype,"quantizationParameters",void 0),y([S({type:[Object],json:{write:!0}})],pi.prototype,"rangeValues",void 0),y([S({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:this.spatialRelationship==="relation"}}}}})],pi.prototype,"relationParameter",void 0),y([S({type:String,json:{write:!0}})],pi.prototype,"resultType",void 0),y([S({type:Boolean,json:{default:!1,write:!0}})],pi.prototype,"returnCentroid",void 0),y([S({type:Boolean,json:{default:!1,write:!0}})],pi.prototype,"returnDistinctValues",void 0),y([S({type:Boolean,json:{default:!0,write:!0}})],pi.prototype,"returnExceededLimitFeatures",void 0),y([S({type:Boolean,json:{write:!0}})],pi.prototype,"returnGeometry",void 0),y([S({type:Boolean,json:{default:!1,write:!0}})],pi.prototype,"returnQueryGeometry",void 0),y([S({type:Boolean,json:{default:!1,write:!0}})],pi.prototype,"returnM",void 0),y([S({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],pi.prototype,"returnZ",void 0),y([S({type:Boolean,json:{write:!0}})],pi.prototype,"returnTrueCurves",void 0),y([S({type:Ri,json:{write:!0}})],pi.prototype,"sourceSpatialReference",void 0),y([ai(SZe,{ignoreUnknown:!1,name:"spatialRel"})],pi.prototype,"spatialRelationship",void 0),y([S({type:Number,json:{read:{source:"resultOffset"}}})],pi.prototype,"start",void 0),y([yt("start"),yt("num")],pi.prototype,"writeStart",null),y([S({type:String,json:{write:!0}})],pi.prototype,"sqlFormat",void 0),y([S({type:String,json:{write:!0}})],pi.prototype,"text",void 0),y([S({type:Uf,json:{write:!0}})],pi.prototype,"timeExtent",void 0),y([S({type:Boolean,json:{default:!1,write:!0}})],pi.prototype,"timeReferenceUnknownClient",void 0),y([ai(CZe,{ignoreUnknown:!1}),S({json:{write:{overridePolicy(t){return{enabled:!!t&&this.distance!=null}}}}})],pi.prototype,"units",void 0),y([S({type:String,json:{write:{overridePolicy(t){return{enabled:t!=null||this.start!=null&&this.start>0}}}}})],pi.prototype,"where",void 0),y([yt("where")],pi.prototype,"writeWhere",null),pi=N3=y([se("esri.rest.support.Query")],pi);const Gf=pi;function jN(t){return!!(t!=null&&typeof t=="object"&&"createQuery"in t&&t.createQuery&&"on"in t&&t.on)}let rm=class extends vd.EventedAccessor{constructor(e){super(e),this._selectionMap=new I3,this._sources=new Nt,this._trashCan=[],this._layerEditHandles=new Nt,this._vizTaskId=0,this.showHighlight=!0,this.highlightName="default"}initialize(){this.addHandles([Ai(()=>[this.view,this.showHighlight],()=>this._refreshVisualization()),yy(()=>this.sources,"change",i=>{const s=this._selectionMap;for(const n of i.removed)s.delete(n);this._refreshListeners(),this._refreshVisualization()},{onListenerAdd:()=>this._refreshListeners()})]);const e=new Nt;this.view.when().then(()=>{this.view.map&&(this.view.map.allLayers.flatten(i=>"sublayers"in i&&i.sublayers?i.sublayers:null).forEach(i=>{(jN(i)&&!$We(i)||ev(i))&&e.add(i)}),this.sources=e)})}destroy(){this._layerEditHandles.drain(sr)}get selections(){return Array.from(this._selectionMap.entries()).map(e=>{const[i,s]=e;return{layer:i,selection:[...s.selection]}})}get count(){let e=0;for(const i of this._selectionMap.values())e+=i.selection.length;return e}get hasSelection(){return this.count>0}get sources(){return this._sources}set sources(e){Of(e,this._sources)}async getSelectedFeatures(e,i={},s="layerView"){const{view:n,selections:r}=this,o=(e!==void 0?r.filter(a=>e.includes(a.layer)):r).filter(a=>a.selection.length>0).map(async a=>{const{layer:l,selection:u}=a,c=ev(l)?l.parent:l;if(c==null||!Zse(c))return null;if(s==="layer")return Kse(c,u,i);if(Wse(c))return null;const h=await n.whenLayerView(c).catch(()=>null);return h?Kse(h,u,i):null});return(await Promise.all(o)).filter(a=>a!=null)}updateSelection(e){const i=new Map;for(const[r,o]of this._selectionMap)i.set(r,[...o.selection]);let s=!1;const n=e.current.concat(e.added);for(const r of n){const o=r.sourceLayer,a=r.getObjectId();if(this.sources.includes(o)&&(jN(o)||ev(o))&&a!==null){const l=RM(i,o,()=>[]);l.includes(a)||(l.push(a),s=!0)}}for(const r of e.removed){const o=r.sourceLayer,a=r.getObjectId();if(this.sources.includes(o)&&(jN(o)||ev(o))&&a!==null){const l=i.get(o),u=l==null?void 0:l.indexOf(a);u!==void 0&&u>=0&&(l==null||l.splice(u,1),s=!0)}}if(s){const{_selectionMap:r,_trashCan:o}=this,a=[];for(const[l,u]of i){const c=r.get(l);c!==void 0&&o.push(c),r.set(l,{selection:u}),a.push({layer:l,selection:u,...ZZ(c!==void 0?c.selection:[],u)})}this._onSelectionChange(a)}}setSelection(e,i){this._setSelection(e,i)}getSelection(e){const i=this._selectionMap.get(e);return i==null?void 0:i.selection}appendToSelection(e,i){const s=this._selectionMap.get(e),n=s!==void 0?[...s.selection]:[];for(const r of i)n.includes(r)||n.push(r);this._setSelection(e,n)}removeFromSelection(e,i){const s=this._selectionMap.get(e);if(!s)return;const n=[];for(const r of s.selection)i.includes(r)||n.push(r);this._setSelection(e,n)}toggleInSelection(e,i){const s=this._selectionMap.get(e);if(!s||s.selection.length===0)return void this._setSelection(e,i);const n=new Set(s.selection),r=new Set(i),o=Y2e(n,r);this._setSelection(e,Array.from(o))}clear(){const e=this._selectionMap.values();this._trashCan.push(...e);const i=[];for(const[s,n]of this._selectionMap.entries())i.push({layer:s,added:[],removed:[...n.selection],selection:[]});this._selectionMap.clear(),this._onSelectionChange(i)}_onSelectionChange(e){this._refreshVisualization(),this.emit("selection-change",{view:this.view,changes:e})}_refreshVisualization(){var o;if(this.view==null||this.sources==null)return;for(this._vizTaskId++;this._trashCan.length>0;){const a=this._trashCan.pop();(o=a==null?void 0:a.highlightHandle)==null||o.remove()}const{sources:e,view:i,_selectionMap:s,showHighlight:n}=this,r=this._vizTaskId;for(const a of e){const l=s.get(a),u=ev(a)?a.parent:a;if(u!=null&&Zse(u)){if(Wse(u))continue;i.whenLayerView(u).then(c=>{var h;(h=l==null?void 0:l.highlightHandle)==null||h.remove(),l!=null&&n&&r===this._vizTaskId&&"highlight"in c&&typeof c.highlight=="function"&&l.selection.length>0&&(l.highlightHandle=c.highlight(l.selection,this.highlightName))}).catch(()=>{var c;(c=l==null?void 0:l.highlightHandle)==null||c.remove()})}}}_refreshListeners(){this._layerEditHandles.drain(sr);for(const e of this.sources){const i=ev(e)?e.parent:e;if(i!=null&&jN(i)){const s=i.on("edits",n=>{this._handleEditChanges(n,e)});this._layerEditHandles.push(s)}}}_handleEditChanges(e,i){if(e.deletedFeatures!==void 0&&e.deletedFeatures.length>0&&this._selectionMap.has(i)){const s=e.deletedFeatures.filter(n=>n.error==null).map(n=>n.objectId).filter(Df);this.removeFromSelection(i,s)}}_setSelection(e,i){if(!this.sources.includes(e))throw new Error(`Cannot set selection on layer ${e.title} because it is not in 'sources'`);const s=this._selectionMap.get(e);if(s===void 0||!PZe(s,{selection:i})){s!==void 0&&this._trashCan.push(s),this._selectionMap.set(e,{selection:[...i]});const n={layer:e,selection:[...i],...ZZ(s!==void 0?s.selection:[],i)};this._onSelectionChange([n])}}};y([S({readOnly:!0,nonNullable:!0})],rm.prototype,"selections",null),y([S({readOnly:!0,nonNullable:!0})],rm.prototype,"count",null),y([S({constructOnly:!0,nonNullable:!0})],rm.prototype,"view",void 0),y([S({readOnly:!0,nonNullable:!0})],rm.prototype,"hasSelection",null),y([S()],rm.prototype,"showHighlight",void 0),y([S()],rm.prototype,"sources",null),y([S()],rm.prototype,"highlightName",void 0),rm=y([se("esri.views.SelectionManager")],rm);const Wse=t=>{var e;return ev(t)?((e=t.parent)==null?void 0:e.isTable)===!0:t.isTable},TZe=t=>t.layer!==void 0,Zse=t=>(t==null?void 0:t.when)!==void 0,PZe=(t,e)=>{if(t==null&&e==null)return!0;if(t!=null&&e==null||t==null&&e!=null)return!1;if(t!=null&&e!=null&&t.selection!=null&&e.selection!=null){const i=[...t.selection],s=[...e.selection];if(i.length!==s.length)return!1;i.sort(),s.sort();for(let n=0;n<i.length;n++)if(i[n]!==s[n])return!1}return!0},Kse=async(t,e,i={})=>{let s;if(TZe(t)){const n=t;s=n===void 0?null:await n.queryFeatures(new Gf({...i,objectIds:e})).then(r=>({data:r,layer:t.layer}))}else{const n=t;s=n===void 0?null:await n.queryFeatures(new Gf({...i,objectIds:e})).then(r=>({data:r,layer:n}))}return s},MZe=rm;let uT=class extends bs.ClonableMixin(ei){constructor(e){super(e),this.accentColor=new Gt([255,127,0]),this.textColor=new Gt([255,255,255])}};y([S({type:Gt,nonNullable:!0})],uT.prototype,"accentColor",void 0),y([S({type:Gt,nonNullable:!0})],uT.prototype,"textColor",void 0),uT=y([se("esri.views.Theme")],uT);const lq=uT;var Qse;(function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right"})(Qse||(Qse={}));const k0e=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],$0e={};function U0e(t){return!!$0e[t]}function AZe(t){for(const e of t)if(!U0e(e))return!1;return!0}k0e.forEach(t=>{$0e[t]=!0});let V0e=class{constructor(e){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=e,this.inputManager=null}connect(e){e&&this.disconnect(),this.inputManager=e,this._handlers.forEach(({handler:i,priority:s},n)=>{var r;return(r=this.inputManager)==null?void 0:r.installHandlers(n,[i],s)})}disconnect(){this.inputManager&&this._handlers.forEach((e,i)=>{var s;return(s=this.inputManager)==null?void 0:s.uninstallHandlers(i)}),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(e,i,s,n){const r=Array.isArray(e)?e:e.split(",");if(!AZe(r))return r.some(U0e)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let o,a;Array.isArray(i)?a=i:(o=i,a=[]),typeof s=="function"?o=s:n=s,n=n??uy.DEFAULT;const l=this._createUniqueGroupName(),u=new IZe(this.view,r,a,o);this._handlers.set(l,{handler:u,priority:n});for(const c of r){const h=this._handlerCounts.get(c)||0;this._handlerCounts.set(c,h+1)}return this.inputManager&&this.inputManager.installHandlers(l,[u],n),Gs(()=>this._removeHandler(l,r))}hasHandler(e){return!!this._handlerCounts.get(e)}_removeHandler(e,i){if(this._handlers.has(e)){this._handlers.delete(e);for(const s of i){const n=this._handlerCounts.get(s);n===void 0||(n===1?this._handlerCounts.delete(s):this._handlerCounts.set(s,n-1))}}this.inputManager&&this.inputManager.uninstallHandlers(e)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},IZe=class extends zo{constructor(e,i,s,n){super(!0),this._latestDragStart=void 0,this.view=e;for(const r of i)switch(r){case"click":this.registerIncoming("click",s,o=>n(RZe(e,o)));break;case"double-click":this.registerIncoming("double-click",s,o=>n(OZe(e,o)));break;case"immediate-click":this.registerIncoming("immediate-click",s,o=>n(LZe(e,o)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",s,o=>n(FZe(e,o)));break;case"hold":this.registerIncoming("hold",s,o=>n(kZe(e,o)));break;case"drag":this.registerIncoming("drag",s,o=>{const a=this._wrapDrag(o);a&&n(a)});break;case"key-down":this.registerIncoming("key-down",s,o=>n($Ze(o)));break;case"key-up":this.registerIncoming("key-up",s,o=>n(UZe(o)));break;case"pointer-down":this.registerIncoming("pointer-down",s,o=>n(Q2(o,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",s,o=>n(Q2(o,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",s,o=>n(Q2(o,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",s,o=>n(VZe(o)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",s,o=>n(zZe(o)));break;case"pointer-enter":this.registerIncoming("pointer-enter",s,o=>n(Q2(o,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",s,o=>n(Q2(o,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",s,o=>{n(GZe(o))});break;case"focus":this.registerIncoming("focus",s,o=>{n(DZe(o))});break;case"blur":this.registerIncoming("blur",s,o=>{n(NZe(o))})}}_wrapDrag(e){const i=e.data,{x:s,y:n}=i.center,{action:r,pointerType:o,button:a}=i;if(r==="start"&&(this._latestDragStart=i),!this._latestDragStart)return;const l=i.pointer.native,u=i.buttons,{cancelable:c,timestamp:h}=e,d={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return r==="end"&&(this._latestDragStart=void 0),{type:"drag",action:r,x:s,y:n,origin:d,pointerType:o,button:a,buttons:u,radius:i.radius,angle:Xce(i.angle),native:l,timestamp:h,cancelable:c,stopPropagation:()=>e.stopPropagation(),async:m=>e.async(m),preventDefault:()=>e.preventDefault()}}};function DZe(t){return{type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function NZe(t){return{type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}function RZe(t,e){const{pointerType:i,button:s,buttons:n,x:r,y:o,native:a,eventId:l}=e.data,{cancelable:u,timestamp:c}=e;return{type:"click",pointerType:i,button:s,buttons:n,x:r,y:o,native:a,timestamp:c,screenPoint:oa(r,o),mapPoint:EA(t,r,o),eventId:l,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:h=>e.async(h),preventDefault:()=>e.preventDefault()}}function OZe(t,e){const{pointerType:i,button:s,buttons:n,x:r,y:o,native:a,eventId:l}=e.data,{cancelable:u,timestamp:c}=e;return{type:"double-click",pointerType:i,button:s,buttons:n,x:r,y:o,native:a,timestamp:c,mapPoint:EA(t,r,o),eventId:l,cancelable:u,stopPropagation:()=>e.stopPropagation(),async:h=>e.async(h),preventDefault:()=>e.preventDefault()}}function LZe(t,e){const{pointerType:i,button:s,buttons:n,x:r,y:o,native:a,eventId:l}=e.data,u=a.pointerId,{cancelable:c,timestamp:h}=e;return{type:"immediate-click",pointerId:u,pointerType:i,button:s,buttons:n,x:r,y:o,native:a,timestamp:h,mapPoint:EA(t,r,o),eventId:l,cancelable:c,stopPropagation:()=>e.stopPropagation(),async:d=>e.async(d),preventDefault:()=>e.preventDefault()}}function FZe(t,e){const{pointerType:i,button:s,buttons:n,x:r,y:o,native:a,eventId:l}=e.data,u=a.pointerId,{cancelable:c,timestamp:h}=e;return{type:"immediate-double-click",pointerId:u,pointerType:i,button:s,buttons:n,x:r,y:o,native:a,timestamp:h,mapPoint:EA(t,r,o),eventId:l,cancelable:c,stopPropagation:()=>e.stopPropagation(),async:d=>e.async(d),preventDefault:()=>e.preventDefault()}}function kZe(t,e){const{pointerType:i,button:s,buttons:n,x:r,y:o,native:a}=e.data,{cancelable:l,timestamp:u}=e;return{type:"hold",pointerType:i,button:s,buttons:n,x:r,y:o,native:a,timestamp:u,mapPoint:EA(t,r,o),cancelable:l,stopPropagation:()=>e.stopPropagation(),async:c=>e.async(c),preventDefault:()=>e.preventDefault()}}function EA(t,e,i){return t.toMap(oa(e,i),{exclude:[]})}function $Ze(t){const{key:e,repeat:i,native:s}=t.data,{cancelable:n,timestamp:r}=t;return{type:"key-down",key:e,repeat:i,native:s,timestamp:r,cancelable:n,stopPropagation:()=>t.stopPropagation(),async:o=>t.async(o),preventDefault:()=>t.preventDefault()}}function UZe(t){const{key:e,native:i}=t.data,{cancelable:s,timestamp:n}=t;return{type:"key-up",key:e,native:i,timestamp:n,cancelable:s,stopPropagation:()=>t.stopPropagation(),async:r=>t.async(r),preventDefault:()=>t.preventDefault()}}function Q2(t,e){const{x:i,y:s,button:n,buttons:r,native:o,eventId:a}=t.data,l=o.pointerId,u=o.pointerType,{cancelable:c,timestamp:h}=t;return{type:e,x:i,y:s,pointerId:l,pointerType:u,button:n,buttons:r,native:o,timestamp:h,eventId:a,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:d=>t.async(d),preventDefault:()=>t.preventDefault()}}function VZe(t){const{x:e,y:i,buttons:s,native:n,eventId:r}=t.data.currentEvent,{button:o}=t.data.startEvent,a=t.data.startEvent.native.pointerId,l=t.data.startEvent.native.pointerType,u=t.data.action,c={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:h,timestamp:d}=t;return{type:"pointer-drag",x:e,y:i,pointerId:a,pointerType:l,button:o,buttons:s,action:u,origin:c,native:n,timestamp:d,eventId:r,cancelable:h,stopPropagation:()=>t.stopPropagation(),async:m=>t.async(m),preventDefault:()=>t.preventDefault()}}function zZe(t){const{cancelable:e,data:i,timestamp:s}=t,{x:n,y:r,deltaY:o,native:a}=i;return{type:"mouse-wheel",x:n,y:r,deltaY:o,native:a,timestamp:s,cancelable:e,stopPropagation:()=>t.stopPropagation(),async:l=>t.async(l),preventDefault:()=>t.preventDefault()}}function GZe(t){const{action:e,state:i,device:s}=t.data,{cancelable:n,timestamp:r}=t,{buttons:o,axes:a}=i;return{type:"gamepad",device:s,timestamp:r,action:e,buttons:o,axes:a,cancelable:n,stopPropagation:()=>t.stopPropagation(),async:l=>t.async(l),preventDefault:()=>t.preventDefault()}}var xM,Jse,ene;(function(t){t[t.USER=0]="USER",t[t.MANAGER=1]="MANAGER"})(xM||(xM={})),function(t){t[t.None=0]="None",t[t.Unfocused=1]="Unfocused",t[t.Focused=2]="Focused",t[t.Unselected=4]="Unselected",t[t.Selected=8]="Selected",t[t.All=15]="All"}(Jse||(Jse={})),function(t){t[t.None=0]="None",t[t.Custom1=16]="Custom1",t[t.Custom2=32]="Custom2",t[t.Custom3=64]="Custom3",t[t.Custom4=128]="Custom4",t[t.Custom5=256]="Custom5",t[t.Custom6=512]="Custom6",t[t.Custom7=1024]="Custom7",t[t.Custom8=2048]="Custom8",t[t.Custom9=4096]="Custom9",t[t.Custom10=8192]="Custom10",t[t.Custom11=16384]="Custom11",t[t.Custom12=32768]="Custom12",t[t.All=65520]="All"}(ene||(ene={}));function BZe(t){return[t.on("before-add",e=>{const i=e.item;if(i==null||t.includes(i))return ht.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void e.preventDefault();i.onAdd()}),t.on("after-remove",e=>{const i=e.item;i.active&&(i.view.activeTool=null),i.destroy()})]}function uq(t){return t.visible&&t.getEditableFlag!=null&&t.getEditableFlag(xM.USER)&&t.getEditableFlag(xM.MANAGER)}function om(t){return oa(t.x,t.y)}function z0e(t,e){var s;const i=(s=t instanceof HTMLElement?t:t.surface)==null?void 0:s.getBoundingClientRect();return i?oa(e.clientX-i.left,e.clientY-i.top):oa(0,0)}function G0e(t,e){return e instanceof Event?z0e(t,e):om(e)}function B0e(t){if(t instanceof Event)return!0;if(typeof t=="object"&&"type"in t)switch(t.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let qZe=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._externallyDragging=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(e,i){const s=()=>e.stopPropagation();switch(e.type){case"pointer-move":ine(e.pointerType)&&this._pointerLocations.set(e.pointerId,{x:e.x,y:e.y,pointerType:e.pointerType});break;case"drag":this._grabbedManipulators.size>0?this._stopDrag=!0:e.action==="start"?this._externallyDragging=!0:e.action==="end"&&(this._externallyDragging=!1),this._stopDrag&&(s(),e.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!sne(e))break;const n=om(e),r=ob(n,e.pointerType,i.forEachTool);if(r==null)break;const o=r.manipulator,a=r.tool;o==null||a==null||!o.interactive||o.grabbable&&o.grabbableForEvent(e)||!o.grabbing||o.dragging||this._releaseManipulatorBeforeDragging(o,e,i),o!=null&&a!=null&&o.interactive&&o.grabbable&&o.grabbableForEvent(e)&&!o.grabbing&&(this._grabbedManipulators.set(e.pointerId,{manipulator:o,tool:a,start:n,pointerType:e.pointerType}),this._grabbedManipulators.size===1&&i.activeTool==null&&(this._revertToNullActiveTool=!0,i.setActiveTool(r.tool)),o.grabbing=!0,o.events.emit("grab-changed",{action:"start",pointerType:e.pointerType,screenPoint:n}),s());break}case"pointer-up":this._draggedManipulators.has(e.pointerId)||this._handlePointerEnd(e,i);break;case"pointer-drag":{if(!sne(e))break;const n=this._grabbedManipulators.get(e.pointerId),r=n==null?void 0:n.manipulator,o=n==null?void 0:n.tool;if(r==null||o==null)break;const a=om(e);a.x=sh(a.x,0,i.view.width),a.y=sh(a.y,0,i.view.height);const l=n.start,u=this._draggedManipulators.get(e.pointerId);switch(e.action){case"start":case"update":e.action!=="update"&&this._grabbedManipulators.size!==1||(r.dragging=!0,u?r.events.emit("drag",{action:"update",start:l,screenPoint:a}):r.events.emit("drag",{action:"start",start:l,screenPoint:a,pointerType:e.pointerType}),this._draggedManipulators.set(e.pointerId,{tool:o,manipulator:r,start:l}));break;case"end":r.dragging=!1,u&&r.events.emit("drag",{action:"end",start:l,screenPoint:a}),this._draggedManipulators.delete(e.pointerId),this._handlePointerEnd(e,i)}s();break}case"immediate-click":{const n=om(e),r=ob(n,e.pointerType,i.forEachTool);if(HZe(e)||i.forEachTool(u=>{if((r==null||r.tool!==u||u.automaticManipulatorSelection)&&u.manipulators){let c=!1;u.manipulators.forEach(({manipulator:h})=>{h.selected&&(h.selected=!1,c=!0)}),c&&u.onManipulatorSelectionChanged&&u.onManipulatorSelectionChanged()}}),r==null)break;const{manipulator:o,tool:a}=r;if(!o.interactive)break;o.selectable&&a.automaticManipulatorSelection&&(o.selected=!o.selected,a.onManipulatorSelectionChanged&&a.onManipulatorSelectionChanged());const l=e.native.shiftKey;o.events.emit("immediate-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:l,stopPropagation:s}),nV(o,s);break}case"click":{const n=om(e),r=ob(n,e.pointerType,i.forEachTool),o=r==null?void 0:r.manipulator;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit(e.type,{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:a}),s();break}case"double-click":{const n=om(e),r=ob(n,e.pointerType,i.forEachTool),o=r!=null?r.manipulator:null;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit("double-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:a,stopPropagation:s}),nV(o,s);break}case"immediate-double-click":{const n=om(e),r=ob(n,e.pointerType,i.forEachTool),o=r!=null?r.manipulator:null;if(o==null||!o.interactive)break;const a=e.native.shiftKey;o.events.emit("immediate-double-click",{screenPoint:n,button:e.button,pointerType:e.pointerType,shiftKey:a,stopPropagation:s}),e.pointerType==="mouse"&&nV(o,s);break}}this._onFocusChange(i.forEachTool)}_releaseManipulatorBeforeDragging(e,i,s){e.grabbing=!1,e.events.emit("grab-changed",{action:"end",pointerType:i.pointerType,screenPoint:om(i)}),this._grabbedManipulators.forEach(({manipulator:n},r)=>{n===e&&this._grabbedManipulators.delete(r)}),this._afterManipulatorRelease(s.setActiveTool)}_handlePointerEnd(e,i){var n;const s=(n=this._grabbedManipulators.get(e.pointerId))==null?void 0:n.manipulator;s!=null&&s.grabbing&&(s.grabbing=!1,s.events.emit("grab-changed",{action:"end",pointerType:e.pointerType,screenPoint:om(e)}),this._grabbedManipulators.delete(e.pointerId),this._afterManipulatorRelease(i.setActiveTool))}_onFocusChange(e){this._updateCursor(),this._updateFocusedManipulatorTools(e)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=tne(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=tne(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(e){const i=new Set,s=new Set;this._grabbedManipulators.forEach(({tool:n})=>{i.add(n)}),this._hoveredManipulators.forEach(({tool:n})=>{s.add(n)}),e(n=>{n.hasGrabbedManipulators=i.has(n),n.hasHoveredManipulators=s.has(n);const r=this._grabbedManipulators.values(),o=d2e(r,({tool:a})=>a===n);n.firstGrabbedManipulator=o!=null?o.manipulator:null})}clearPointers(e,{forEachTool:i,setActiveTool:s},n=!0,r){const o=(a,l)=>a===e&&(r==null||r===l);this._grabbedManipulators.forEach(({tool:a,manipulator:l,pointerType:u},c)=>{o(a,l)&&(this._grabbedManipulators.delete(c),l.grabbing=!1,l.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:u}))}),this._draggedManipulators.forEach(({tool:a,manipulator:l},u)=>{o(a,l)&&(this._draggedManipulators.delete(u),l.dragging=!1,l.events.emit("drag",{action:"cancel"}))}),n&&this._hoveredManipulators.forEach(({tool:a,manipulator:l},u)=>{o(a,l)&&(this._hoveredManipulators.delete(u),l.hovering=!1)}),this._afterManipulatorRelease(s),this._onFocusChange(i)}updateHoveredStateFromKnownPointers(e){this._pointerLocations.forEach((i,s)=>{this._updateHoveredStateForPointerAtScreenPosition(oa(i.x,i.y),s,i.pointerType,e)})}handleHoverEvent(e,i){const s=e.type;s!=="pointer-up"&&s!=="immediate-click"&&s!=="pointer-move"||!ine(e.pointerType)||(s!=="pointer-up"&&this._externallyDragging?this._clearHoveredManipulatorStates(e.pointerId):this._updateHoveredStateForPointerAtScreenPosition(om(e),e.pointerId,e.pointerType,i))}_updateHoveredStateForPointerAtScreenPosition(e,i,s,n){var a;let r=ob(e,s,n);const o=(a=this._hoveredManipulators.get(i))==null?void 0:a.manipulator;r==null||r.manipulator.interactive||(r=null),r!=null&&o===r.manipulator||(o!=null&&(o.hovering=!1),r!=null?(r.manipulator.hovering=!0,this._hoveredManipulators.set(i,r)):this._hoveredManipulators.delete(i),this._onFocusChange(n))}_afterManipulatorRelease(e){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(e(null),this._revertToNullActiveTool=!1)}_clearHoveredManipulatorStates(e){this._hoveredManipulators.forEach(({manipulator:i},s)=>{e===s&&(this._hoveredManipulators.delete(e),i.hovering=!1)})}};function tne(t){for(const{manipulator:e}of t.values())if(e!=null&&e.interactive){if(e.grabbing&&e.grabCursor)return e.grabCursor;if(e.cursor)return e.cursor}return null}function ob(t,e,i){let s=null;return i(n=>{if(n.manipulators==null||!uq(n))return!1;const r=n.manipulators.intersect(t,e);return r!=null&&(s={tool:n,manipulator:r},!0)}),s}function ine(t){return t==="mouse"}function sne(t){return t.pointerType!=="mouse"||t.button===0}function HZe(t){return!!t.native.shiftKey}function nV(t,e){t!=null&&t.consumesClicks&&e()}const nne="attached",rV="tools",jZe=1e3;let am=class extends ei{constructor(e){super(e),this._updatingHandles=new i1,this._clock=kS,this._manipulatorState=new qZe,this.tools=new Nt,this.cursor=null,this._interacting=!1,this._interactingTimeout=jZe,this._interactingTimeoutHandle=null,this._forEachTool=i=>{for(const s of this.tools.items)if(i(s))return}}initialize(){this.addHandles([this.view.on(k0e,e=>{this._handleInputEvent(e)},uy.TOOL),...BZe(this.tools),this.tools.on("before-add",({item:e})=>{this._updateToolEditableFlag(e)}),this.tools.on("before-remove",({item:e})=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.activeTool=null,this.tools.drain(e=>e.destroy()),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:e=>{this.activeTool=e},view:this.view}}set activeTool(e){if(e!=null&&!this.view.ready)return void ht.getLogger(this).error("Cannot set active tool while view is not ready.");if(e===this.activeTool)return;const i=this.activeTool;this._set("activeTool",e),i!=null&&i.deactivate(),e!=null&&e.activate(),this._removeIncompleteTools(e);for(const s of this.tools){this._updateToolEditableFlag(s);const n=uq(s);this.activeTool!=null&&n||this._manipulatorState.clearPointers(s,this._manipulatorStateEventArgs,!n)}this._updateCursor()}get updating(){return this._updatingHandles.updating||this.tools.some(e=>e.updating)}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=sr(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout(()=>this._interacting=!1,this._interactingTimeout)}attach(){var e;this.view.type==="3d"?this.addHandles([Ai(()=>{const{state:i}=this.view;return"camera"in i&&i.camera},()=>this._forEachManipulator(i=>i.onViewChange())),(e=this.view.elevationProvider)==null?void 0:e.on("elevation-change",i=>this._forEachManipulator(s=>s.onElevationChange(i)))],nne):this.addHandles(Ai(()=>this.view.extent,()=>this._forEachManipulator(i=>i.onViewChange())))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(nne),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(e){this._forEachTool(i=>{i.manipulators&&i.manipulators.forEach(({manipulator:s})=>e(s,i))})}_handleInputEvent(e){let i=!1;const s={...e,stopPropagation:()=>{i=!0,e.stopPropagation()}};this.activeTool!=null?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(s):this._forEachTool(n=>{!i&&n.visible&&n.handleInputEvent(s)}),!i&&e.type==="key-down"&&e.key==="Escape"&&this.activeTool&&(e.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(s,this._manipulatorStateEventArgs),i||this.activeTool==null||this.activeTool.handleInputEventAfter(s),this._manipulatorState.handleHoverEvent(s,this._forEachTool),this._updateCursor(),e.type==="pointer-move"&&(this._manipulatorState.hasFocusedManipulators()||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles(rV),this._forEachTool(e=>{if(e instanceof ei){const i=Ai(()=>[e.cursor,e.visible,e.editable],()=>{uq(e)||this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs),this._updateCursor()});this.addHandles(i,rV)}e.manipulators&&this.addHandles([e.manipulators.on("after-remove",i=>{this._manipulatorState.clearPointers(e,this._manipulatorStateEventArgs,!0,i.item.manipulator)}),e.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()})],rV)}),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(e){var i;(i=e.setEditableFlag)==null||i.call(e,xM.MANAGER,this.activeTool==null||e===this.activeTool)}_updateCursor(){let e=this._manipulatorState.cursor;e==null&&this._forEachTool(i=>!(i.cursor==null||!i.visible)&&(e=i.cursor,!0)),this._get("cursor")!==e&&this._set("cursor",e)}_removeIncompleteTools(e){this.tools.filter(i=>(e==null||i!==e)&&!i.created&&i.removeIncompleteOnCancel).forEach(i=>{this.tools.remove(i)})}get test(){}};y([S({constructOnly:!0,nonNullable:!0})],am.prototype,"view",void 0),y([S({value:null})],am.prototype,"activeTool",null),y([S({readOnly:!0,type:Nt})],am.prototype,"tools",void 0),y([S({readOnly:!0})],am.prototype,"cursor",void 0),y([S({readOnly:!0})],am.prototype,"updating",null),y([S()],am.prototype,"_interacting",void 0),y([S({readOnly:!0})],am.prototype,"interacting",null),am=y([se("esri.views.ToolViewManager")],am);const YZe=new Gt("cyan"),XZe=1,WZe=.25,ZZe=new Gt("black"),KZe=.4,QZe=.2,Xvt=.25,q0e="default",JZe="temporary",eKe=new Gt("yellow");var cq;let Xu=cq=class extends ei{constructor(t){super(t),this.name=q0e,this.color=YZe.clone(),this.haloColor=null,this.haloOpacity=XZe,this.fillOpacity=WZe,this.shadowColor=ZZe.clone(),this.shadowOpacity=KZe,this.shadowDifference=QZe,this.haloWidth=2.1,this.haloBlur=.8/this.haloWidth}equals(t){return this.color.equals(t.color)&&(this.haloColor||this.color).equals(t.haloColor||t.color)&&this.haloOpacity===t.haloOpacity&&this.fillOpacity===t.fillOpacity&&this.haloWidth===t.haloWidth&&this.haloBlur===t.haloBlur&&this.shadowColor.equals(t.shadowColor)&&this.shadowOpacity===t.shadowOpacity&&this.shadowDifference===t.shadowDifference}clone(){var t,e;return new cq({...this,color:this.color.clone(),haloColor:(t=this.haloColor)==null?void 0:t.clone(),shadowColor:(e=this.shadowColor)==null?void 0:e.clone()})}assignFrom(t){var e;this.color=t.color.clone(),this.haloColor=(e=t.haloColor)==null?void 0:e.clone(),this.haloOpacity=t.haloOpacity,this.fillOpacity=t.fillOpacity,this.shadowColor=t.shadowColor.clone(),this.shadowDifference=t.shadowDifference,this.shadowOpacity=t.shadowOpacity,this.haloBlur=t.haloBlur,this.haloWidth=t.haloWidth}};y([S({type:String,constructOnly:!0,nonNullable:!0})],Xu.prototype,"name",void 0),y([S({type:Gt,nonNullable:!0})],Xu.prototype,"color",void 0),y([S({type:Gt})],Xu.prototype,"haloColor",void 0),y([S({nonNullable:!0})],Xu.prototype,"haloOpacity",void 0),y([S({nonNullable:!0})],Xu.prototype,"fillOpacity",void 0),y([S({type:Gt,nonNullable:!0})],Xu.prototype,"shadowColor",void 0),y([S({nonNullable:!0})],Xu.prototype,"shadowOpacity",void 0),y([S({nonNullable:!0})],Xu.prototype,"shadowDifference",void 0),y([S({nonNullable:!0})],Xu.prototype,"haloWidth",void 0),y([S({nonNullable:!0})],Xu.prototype,"haloBlur",void 0),Xu=cq=y([se("esri.views.support.HighlightOptions")],Xu);const cy=Xu;function tKe(){return new(Nt.ofType(cy))([new cy({name:q0e}),new cy({name:JZe,color:eKe})])}let Db=class extends ei{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",e.mapping==="standard"?this._detectedDeviceType="standard":iKe.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index}get native(){const e=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<e.length?e[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return sKe[this.deviceType]}};y([S({nonNullable:!0,readOnly:!0})],Db.prototype,"nativeIndex",void 0),y([S({type:String,readOnly:!0})],Db.prototype,"deviceType",null),y([S({type:Number,readOnly:!0})],Db.prototype,"axisThreshold",null),Db=y([se("esri.views.input.gamepad.GamepadInputDevice")],Db);const xY=Db,iKe=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),sKe={standard:.15,spacemouse:.025,unknown:0};let cT=class extends ei{constructor(...e){super(...e),this.devices=new Nt,this.enabledFocusMode="document"}};y([S({type:Nt.ofType(xY),readOnly:!0})],cT.prototype,"devices",void 0),y([S({type:["document","view","none"]})],cT.prototype,"enabledFocusMode",void 0),cT=y([se("esri.views.input.gamepad.GamepadSettings")],cT);const nKe=cT;let R3=class extends ei{constructor(){super(...arguments),this.gamepad=new nKe}};y([S({readOnly:!0})],R3.prototype,"gamepad",void 0),R3=y([se("esri.views.input.Input")],R3);const rKe=R3,H0e=()=>Ks.respectPrefersReducedMotion&&window.matchMedia("(prefers-reduced-motion: reduce)").matches,oV=()=>S({type:["pan","rotate","zoom","none"],nonNullable:!0});let nv=class extends ei{constructor(e){super(e),this.dragPrimary="pan",this.dragSecondary="rotate",this.dragTertiary="zoom",this.mouseWheel="zoom"}};y([oV()],nv.prototype,"dragPrimary",void 0),y([oV()],nv.prototype,"dragSecondary",void 0),y([oV()],nv.prototype,"dragTertiary",void 0),y([S({type:["zoom","none"],nonNullable:!0})],nv.prototype,"mouseWheel",void 0),nv=y([se("esri.views.navigation.NavigationActionMap")],nv);const bY=nv;let y_=class extends ei{constructor(e){super(e),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};y([S({type:Boolean,nonNullable:!0})],y_.prototype,"enabled",void 0),y([S({type:xY})],y_.prototype,"device",void 0),y([S({type:["pan","zoom"],nonNullable:!0})],y_.prototype,"mode",void 0),y([S({type:["forward-down","forward-up"],nonNullable:!0})],y_.prototype,"tiltDirection",void 0),y([S({type:Number,nonNullable:!0})],y_.prototype,"velocityFactor",void 0),y_=y([se("esri.views.navigation.gamepad.GamepadSettings")],y_);const j0e=y_;let v_=class extends ei{constructor(e){super(e),this.actionMap=new bY,this.browserTouchPanEnabled=!0,this.gamepad=new j0e,this.momentumEnabled=!0}get effectiveMomentumEnabled(){return this.momentumEnabled&&!H0e()}get mouseWheelZoomEnabled(){return this.actionMap.mouseWheel==="zoom"}set mouseWheelZoomEnabled(e){c2e(ht.getLogger(this),"mouseWheelZoomEnabled",{replacement:"actionMap.mouseWheel",version:"4.32",warnOnce:!0}),this.actionMap.mouseWheel=e?"zoom":"none"}};y([S({type:bY,nonNullable:!0})],v_.prototype,"actionMap",void 0),y([S({type:Boolean})],v_.prototype,"browserTouchPanEnabled",void 0),y([S({type:j0e,nonNullable:!0})],v_.prototype,"gamepad",void 0),y([S({type:Boolean})],v_.prototype,"momentumEnabled",void 0),y([S({type:Boolean})],v_.prototype,"mouseWheelZoomEnabled",null),v_=y([se("esri.views.navigation.Navigation")],v_);const Z4=v_;function t1t(t,e,i){const s=Y0e(t),n=e,r=oKe(s,n,i);if(s){const o=SA.deriveUnitFromSR(s,t.spatialReference).heightUnit;if(!i&&o!==s.heightUnit){const a=new Se("layerview:unmatched-height-unit",`The vertical units of the layer must match the horizontal units (${o})`,{horizontalUnit:o});return new Se("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:s,error:a})}}if(!aKe(t)||r===lu.Unsupported)return new Se("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:s});switch(r){case lu.Units:{const o=(s==null?void 0:s.heightUnit)||"unknown",a=(n==null?void 0:n.heightUnit)||"unknown",l=new Se("layerview:incompatible-height-unit",`The vertical units of the layer (${o}) must match the vertical units of the scene (${a})`,{layerUnit:o,sceneUnit:a});return new Se("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:s,sceneHeightModelInfo:n,error:l})}case lu.HeightModel:{const o=(s==null?void 0:s.heightModel)||"unknown",a=(n==null?void 0:n.heightModel)||"unknown",l=new Se("layerview:incompatible-height-model",`The height model of the layer (${o}) must match the height model of the scene (${a})`,{layerHeightModel:o,sceneHeightModel:a});return new Se("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:s,sceneHeightModelInfo:n,error:l})}case lu.CRS:{const o=(s==null?void 0:s.vertCRS)||"unknown",a=(n==null?void 0:n.vertCRS)||"unknown",l=new Se("layerview:incompatible-vertical-datum",`The vertical datum of the layer (${o}) must match the vertical datum of the scene (${a})`,{layerDatum:o,sceneDatum:a});return new Se("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:s,sceneHeightModelInfo:n,error:l})}}return null}function oKe(t,e,i){if(!rne(t)||!rne(e))return lu.Unsupported;if(t==null||e==null)return lu.Ok;if(!i&&t.heightUnit!==e.heightUnit)return lu.Units;if(t.heightModel!==e.heightModel)return lu.HeightModel;switch(t.heightModel){case"gravity-related-height":return lu.Ok;case"ellipsoidal":return t.vertCRS===e.vertCRS?lu.Ok:lu.CRS;default:return lu.Unsupported}}var lu;function rne(t){return t==null||t.heightModel!=null&&t.heightUnit!=null}function aKe(t){return"heightModelInfo"in t&&t.heightModelInfo!=null||t.spatialReference!=null||!Z0e(t)}function Y0e(t){var s;if(t.type==="integrated-mesh-3dtiles")return null;const e=t.url?VS(t.url):void 0;return!(((s=t.spatialReference)==null?void 0:s.vcsWkid)==null&&e!=null&&e.serverType==="ImageServer")&&X0e(t)&&t.heightModelInfo?t.heightModelInfo:Z0e(t)?SA.deriveUnitFromSR(uKe,t.spatialReference):null}function X0e(t){return"heightModelInfo"in t}function W0e(t){if(t.type==="unknown"||!("capabilities"in t))return!1;switch(t.type){case"catalog":case"catalog-footprint":case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function Z0e(t){return W0e(t)?!!(t.capabilities&&t.capabilities.data&&t.capabilities.data.supportsZ):K0e(t)}function lKe(t){return t.layers!=null||K0e(t)||W0e(t)||X0e(t)}function K0e(t){switch(t.type){case"building-scene":case"elevation":case"integrated-mesh":case"integrated-mesh-3dtiles":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"catalog":case"catalog-footprint":case"catalog-dynamic-group":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"parquet":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"viewshed":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(function(t){t[t.Ok=0]="Ok",t[t.Units=1]="Units",t[t.HeightModel=2]="HeightModel",t[t.CRS=3]="CRS",t[t.Unsupported=4]="Unsupported"})(lu||(lu={}));const uKe=new SA({heightModel:"gravity-related-height"});var zL;(function(t){t[t.Global=1]="Global",t[t.Local=2]="Local"})(zL||(zL={}));let hq,aV=null;async function cKe(t){aV||(aV=_e(()=>import("./geometryServiceUtils-F-KSGsY-.js"),__vite__mapDeps([183,184])).then(e=>hq=e)),await aV,vr(t)}async function Q0e(t,e,i,s){if(!t)return null;const n=t.spatialReference;return Hy()||Bm(n,e)?jy(t,e):hq?hq.projectGeometry(t,e,i,s):(await Promise.race([cKe(s),Ay(s)]),Q0e(t,e,i,s))}let Pn=class extends ei{constructor(e){super(e),this.required={extent:!1,heightModelInfo:!1,tileInfo:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=Xw(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference??this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return this.userSpatialReference==null||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){var s,n,r,o;const e=(s=this.map)==null?void 0:s.call(this),i=[];return this.priorityCollection!=null&&i.push(this.priorityCollection),i.push({parent:e==null?void 0:e.basemap,layers:(n=e==null?void 0:e.basemap)==null?void 0:n.baseLayers},{layers:e==null?void 0:e.layers},{parent:e==null?void 0:e.ground,layers:(r=e==null?void 0:e.ground)==null?void 0:r.layers},{parent:e==null?void 0:e.basemap,layers:(o=e==null?void 0:e.basemap)==null?void 0:o.referenceLayers}),i}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};let e;if(this._collectLayers(this.mapCollections,s=>{const n=this._getSupportedSpatialReferences(s);if(n.length>0){const r=this._narrowDownSpatialReferenceCandidates(e,n);r!=null&&(e=r)}return(e==null?void 0:e.length)===1})&&(e==null?void 0:e.length)!==1)return{updating:!0};const i=this._pickSpatialReferenceCandidate(e);return{spatialReference:(i==null?void 0:i.spatialReference)??null,viewingMode:(i==null?void 0:i.viewingMode)??null,updating:!1}}get _tileInfoTask(){var r,o;if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};const e=(r=this.map)==null?void 0:r.call(this),i=this.spatialReference;if(!i)return{updating:this._spatialReferenceTask.updating};let s;const n=this._collectLayers([{parent:e==null?void 0:e.basemap,layers:(o=e==null?void 0:e.basemap)==null?void 0:o.baseLayers},{layers:e==null?void 0:e.layers}],a=>{var l;return!(!("tileInfo"in a)||!((l=a.tileInfo)!=null&&l.spatialReference.equals(i)))&&(s=a,!0)},a=>"tileInfo"in a);return s?{tileInfo:s.tileInfo,updating:!1}:{updating:n}}get _heightModelInfoTask(){var s;if(!this.required.heightModelInfo||this.suspended&&((s=this._get("_heightModelInfoTask"))!=null&&s.heightModelInfo))return this._get("_heightModelInfoTask")??{updating:!1};let e={};const i=this._collectLayers(this.mapCollections,n=>{var o,a;const r=Y0e(n);return!!r&&(e={heightModelInfo:r,vcsWkid:(o=n.spatialReference)==null?void 0:o.vcsWkid,latestVcsWkid:(a=n.spatialReference)==null?void 0:a.latestVcsWkid},!0)},n=>lKe(n));return{...e,updating:i}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const e=[],i=this._collectLayers(this.mapCollections,s=>{const n="fullExtents"in s&&s.fullExtents||(s.fullExtent!=null?[s.fullExtent]:[]),r=this.requiresExtentInSpatialReference?null:n[0],o=n.find(a=>a.spatialReference.equals(this.spatialReference))??r;if(o)return e.push({extent:o,layer:s}),!0;if(this._getSupportedSpatialReferences(s).length>0)for(const a of n)e.push({extent:a,layer:s});return!1});return{candidates:e,updating:i}}get _extentTask(){const{candidates:e,updating:i}=this._extentCandidatesTask;if(i)return{updating:i};if(e==null||e.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const s=this._pickExtentCandidate(e),n=this.spatialReference;return s.extent.equals(this._projectExtentTask.input)&&n.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:this._projectExtentTask.task!=null&&!this._projectExtentTask.task.finished}:(this._projectExtentTask.task!=null&&(this._projectExtentTask.task=Xw(this._projectExtentTask.task)),this._projectExtentTask={input:s.extent.clone(),output:null,spatialReference:n.clone(),task:KM(async r=>{try{const o=await Q0e(s.extent,n,"portalItem"in s.layer?s.layer.portalItem:void 0,r);this._projectExtentTask={...this._projectExtentTask,task:null,output:o}}catch{if(dc(r))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(e,i){if(e==null)return i;const s=new Array;for(const n of e)for(const r of i){if(!n.spatialReference.equals(r.spatialReference))continue;const o=dKe(n.viewingMode,r.viewingMode);if(o!==!1){s.push({spatialReference:n.spatialReference,viewingMode:o});break}}return s.length>0?s:null}_pickSpatialReferenceCandidate(e){const i=this.defaultSpatialReference;return e==null||e.length<1?i?{spatialReference:i,viewingMode:null}:null:(i!=null&&e.length>1&&e.some(({spatialReference:s})=>s.equals(i))&&(e=e.filter(({spatialReference:s})=>s.equals(i))),e.length>1&&e.some(({viewingMode:s})=>s!==zL.Local)&&(e=e.filter(({viewingMode:s})=>s!==zL.Local)),e[0])}_getSupportedSpatialReferences(e){const i="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(i.length===0)return[];const s=[];for(const n of i){const r=this.getSpatialReferenceSupport(n,e);if(r!=null){const o=r.constraints??[{spatialReference:n,viewingMode:null}];for(const{spatialReference:a,viewingMode:l}of o)this.requiresExtentInSpatialReference&&this.userSpatialReference!=null&&!a.equals(this.userSpatialReference)||s.push({spatialReference:a,viewingMode:l})}}return s}_pickExtentCandidate(e){const i=this.spatialReference;return e.find(({extent:s})=>i.equals(s.spatialReference))||e[0]}_collectLayers(e,i,s=()=>!0){var r;switch(this._loadMaybe((r=this.map)==null?void 0:r.call(this))){case"loading":return!0;case"failed":return!1}const n=new hKe(s,i);for(const o of e)if(this._collectCollection(o,n),n.done||n.preloading===this.sourcePreloadCount)break;return n.updating}_collectCollection(e,i){if(e.layers){switch(this._loadMaybe(e.parent)){case"loading":return i.updating=!0,void++i.preloading;case"failed":return}for(const s of e.layers)if(i.layerFilter(s)){switch(this._loadMaybe(s)){case"failed":continue;case"loading":i.updating=!0,++i.preloading;break;case"loaded":if(i.updating||(i.done=i.pushLayer(s)),i.done||i.preloading===this.sourcePreloadCount)break;"layers"in s&&this._collectCollection({layers:s.layers},i)}if(i.done||i.preloading===this.sourcePreloadCount)break}}}_loadMaybe(e){return e&&"loadStatus"in e&&e.loadStatus!=null?e.loadStatus==="not-loaded"?(e.load().catch(i=>{cl(i)}),"loading"):e.loadStatus:"loaded"}};y([S()],Pn.prototype,"required",void 0),y([S({constructOnly:!0})],Pn.prototype,"map",void 0),y([S({constructOnly:!0})],Pn.prototype,"getSpatialReferenceSupport",void 0),y([S()],Pn.prototype,"defaultSpatialReference",void 0),y([S()],Pn.prototype,"userSpatialReference",void 0),y([S()],Pn.prototype,"sourcePreloadCount",void 0),y([S()],Pn.prototype,"priorityCollection",void 0),y([S()],Pn.prototype,"requiresExtentInSpatialReference",void 0),y([S()],Pn.prototype,"suspended",void 0),y([S({readOnly:!0})],Pn.prototype,"ready",null),y([S({readOnly:!0})],Pn.prototype,"heightModelInfoReady",null),y([S({readOnly:!0})],Pn.prototype,"spatialReference",null),y([S({readOnly:!0})],Pn.prototype,"extent",null),y([S({readOnly:!0})],Pn.prototype,"heightModelInfo",null),y([S({readOnly:!0})],Pn.prototype,"vcsWkid",null),y([S({readOnly:!0})],Pn.prototype,"latestVcsWkid",null),y([S({readOnly:!0})],Pn.prototype,"viewingMode",null),y([S({readOnly:!0})],Pn.prototype,"tileInfo",null),y([S({readOnly:!0})],Pn.prototype,"mapCollections",null),y([S({readOnly:!0})],Pn.prototype,"_spatialReferenceTask",null),y([S({readOnly:!0})],Pn.prototype,"_tileInfoTask",null),y([S({readOnly:!0})],Pn.prototype,"_heightModelInfoTask",null),y([S({readOnly:!0})],Pn.prototype,"_extentCandidatesTask",null),y([S()],Pn.prototype,"_extentTask",null),y([S()],Pn.prototype,"_projectExtentTask",void 0),Pn=y([se("esri.views.support.DefaultsFromMap")],Pn);let hKe=class{constructor(e,i){this.layerFilter=e,this.pushLayer=i,this.preloading=-1,this.updating=!1,this.done=!1}};function dKe(t,e){return t!=null?e!=null?t===e&&t:t:e}let Nb=class extends ei{constructor(e){super(e),this.featureTitleFields=!1,this.utilityNetworkFields=!1,this.globalIdField=!1}};y([S()],Nb.prototype,"featureTitleFields",void 0),y([S()],Nb.prototype,"utilityNetworkFields",void 0),y([S()],Nb.prototype,"globalIdField",void 0),Nb=y([se("esri.views.support.RequiredFieldsOptions")],Nb);const mKe=Nb;var hT;let Qt=hT=class extends vd.EventedMixin(JM.EsriPromiseMixin(ei)){constructor(t){super(t),this._userSpatialReference=null,this._cursor=null,this.handles=new FS,this.updatingHandles=new i1,this.allLayerViews=new gM({getCollections:()=>{var e,i,s;return[(e=this.basemapView)==null?void 0:e.baseLayerViews,(i=this.groundView)==null?void 0:i.layerViews,this.layerViews,(s=this.basemapView)==null?void 0:s.referenceLayerViews]},getChildrenFunction:fKe}),this.groundView=null,this.basemapView=null,this.displayFilterEnabled=!0,this.fatalError=null,this.graphics=new e1,this.analyses=new VL,this.typeSpecificPreconditionsReady=!0,this.layerViews=new Nt,this.magnifier=new N0e,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this._readyStateWaitingTask=null,this.supportsGround=!0,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new rKe,this.navigation=new Z4,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new V0e(this),this.persistableViewModels=new Nt,this.requiredFieldsOptions=new mKe,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this._userTimeExtent=null,this._lockedTimeExtent=null,this.theme=null,this.handles.add(Ai(()=>this.preconditionsReady,e=>{var s,n;const i=this.ready;if(e?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,this._lockedTimeExtent=this.timeExtent,hT.views.add(this)):(this._lockedSpatialReference=null,hT.views.remove(this)),this.notifyChange("spatialReference"),!e&&i)(s=this.toolViewManager)==null||s.detach(),this.analysisViewManager!=null&&this.analysisViewManager.detach(),(n=this.layerViewManager)==null||n.clear(),this._teardown();else if(e&&!i){try{this._startup()}catch(r){return void queueMicrotask(()=>{this.fatalError=new Se("startup-error",null,r)})}this.analysisViewManager!=null&&this.analysisViewManager.attach(),this.toolViewManager.attach()}},km))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this.validate()]).then(()=>(this._isValid=!0,h7(()=>this.ready)))),this.basemapView=new hZe({view:this}),this.layerViewManager=new fZe({view:this,layerViewImporter:{importLayerView:t=>this.importLayerView(t),hasLayerViewModule:t=>this.hasLayerViewModule(t)},supportsGround:this.supportsGround}),this.toolViewManager=new am({view:this}),this.selectionManager=new MZe({view:this}),this.addHandles([nh(()=>this.readyState==="map-content-error"&&!this.spatialReference,()=>{ht.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),Ai(()=>this.initialExtentRequired,t=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:t},uu),Ai(()=>this.ready,t=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=t,this.defaultsFromMap.userSpatialReference=t?this.spatialReference:this._userSpatialReference)},km),Ai(()=>this._userSpatialReference,t=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=t)},uu)])}destroy(){var t,e;this.destroyed||(hT.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=er(this.graphics),this.analyses=er(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),er(this.analysisViewManager),this.toolViewManager=er(this.toolViewManager),this.layerViewManager=er(this.layerViewManager),this.selectionManager=er(this.selectionManager),this.basemapView=er(this.basemapView),(t=this.groundView)==null||t.destroy(),(e=this.layerViews)==null||e.forEach(i=>i.destroy()),this.layerViews.length=0,this.invalidate(),this._emitter.clear(),this.handles.destroy(),this.map=er(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return ht.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){var t;return(t=this.toolViewManager)==null?void 0:t.activeTool}set activeTool(t){this.toolViewManager&&(this.toolViewManager.activeTool=t)}get animation(){return this._get("animation")}set animation(t){this._set("animation",t)}get center(){return null}get defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new Pn({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:(t,e)=>this.getSpatialReferenceSupport(t,e),...this.defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(t){this._set("extent",t)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get highlights(){return this._get("highlights")??tKe()}set highlights(t){this._set("highlights",Of(t,this._get("highlights"),Nt.ofType(cy)))}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){var t;return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||Lf.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!((t=this.defaultsFromMap)!=null&&t.ready)||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(t){t!==this._get("map")&&(t!=null&&t.destroyed&&(ht.getLogger(this).warn("#map","The provided map is already destroyed",{map:t}),t=null),Lf.isLoadable(t)&&t.load().catch(()=>{}),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",t))}get readyState(){var t,e,i,s;if(this.destroyed)return this._get("readyState");if(!this.map)return"missing-map";if("container"in this&&!this.container)return"missing-container";if(this.fatalError)return"rendering-error";if((((t=this.defaultsFromMap)==null?void 0:t.ready)??!1)&&!this.spatialReference){const n=!("loaded"in this.map)||this.map.loaded,r=this.map.ground.loaded,o=((e=this.map.basemap)==null?void 0:e.loaded)??!0;return n&&o&&r&&!((i=this.map)!=null&&i.allLayers.length)?"empty-map":(this._readyStateWaitingTask||(this._readyStateWaitingTask=KM(a=>Iue(ke("view-readyState-waiting-delay"),null,a)),this.addHandles(this._readyStateWaitingTask),this.addHandles(this._readyStateWaitingTask,"ready-state-task")),(s=this._readyStateWaitingTask)!=null&&s.finished?"map-content-error":"loading")}return this._readyStateWaitingTask=Xw(this._readyStateWaitingTask),this.removeHandles("ready-state-task"),this.ready?"ready":"loading"}get spatialReference(){var e,i;const t=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;if(t&&((i=(e=this.defaultsFromMap)==null?void 0:e.required)!=null&&i.heightModelInfo)){const s=t.clone();return s.vcsWkid=this.defaultsFromMap.vcsWkid,s.latestVcsWkid=this.defaultsFromMap.latestVcsWkid,s}return t}set spatialReference(t){const e=!$o(t,this._get("spatialReference"));this._set("_userSpatialReference",t),e&&(this._set("spatialReference",t),this._spatialReferenceChanged(t))}_spatialReferenceChanged(t){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeExtent(){return this._userTimeExtent??this._lockedTimeExtent??this.getDefaultTimeExtent()??null}set timeExtent(t){this._userTimeExtent=t}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??Fm}set timeZone(t){this._userTimeZone=t,LDe(t)||ht.getLogger(this).warn("#timeZone",`the parsed value '${t}' may not be a valid IANA time zone`)}get tools(){var t;return(t=this.toolViewManager)==null?void 0:t.tools}get initialExtent(){var t;return(t=this.defaultsFromMap)==null?void 0:t.extent}get cursor(){var t;return((t=this.toolViewManager)==null?void 0:t.cursor)??this._cursor??"default"}set cursor(t){this._cursor=t,this.notifyChange("cursor")}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new lq}whenLayerView(t){var e;return((e=this.layerViewManager)==null?void 0:e.whenLayerView(t))??Promise.reject()}getDefaultSpatialReference(){var t;return(t=this.defaultsFromMap)==null?void 0:t.spatialReference}getDefaultHeightModelInfo(){var t;return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??((t=this.defaultsFromMap)==null?void 0:t.heightModelInfo)??null}getDefaultTimeZone(){return null}getDefaultTimeExtent(){return null}importLayerView(t){throw new Se("importLayerView() not implemented")}hasLayerViewModule(t){return!1}async validate(){}async loadAsyncDependencies(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(t){return this.getSpatialReferenceSupport(t)!=null}when(t,e){return this.isResolved()&&!this.ready&&ht.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(t,e)}forceReadyCycle(){this.ready&&(nh(()=>this.destroyed||this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(t){this.toolViewManager.tools.add(t),this.activeTool=t}tryFatalErrorRecovery(){this.fatalError=null}};Qt.views=new Nt,y([S()],Qt.prototype,"_userSpatialReference",void 0),y([S()],Qt.prototype,"activeTool",null),y([S({readOnly:!0})],Qt.prototype,"allLayerViews",void 0),y([S()],Qt.prototype,"groundView",void 0),y([S()],Qt.prototype,"animation",null),y([S()],Qt.prototype,"basemapView",void 0),y([S()],Qt.prototype,"center",null),y([S()],Qt.prototype,"defaultsFromMapSettings",null),y([S()],Qt.prototype,"defaultsFromMap",null),y([S()],Qt.prototype,"displayFilterEnabled",void 0),y([S()],Qt.prototype,"fatalError",void 0),y([S({type:Nn})],Qt.prototype,"extent",null),y([S(LB(e1,"graphics"))],Qt.prototype,"graphics",void 0),y([S(LB(VL,"analyses"))],Qt.prototype,"analyses",void 0),y([S({readOnly:!0,type:SA})],Qt.prototype,"heightModelInfo",null),y([S({type:Nt.ofType(cy)})],Qt.prototype,"highlights",null),y([S({readOnly:!0})],Qt.prototype,"interacting",null),y([S({readOnly:!0})],Qt.prototype,"navigating",null),y([S({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],Qt.prototype,"preconditionsReady",null),y([S({readOnly:!0})],Qt.prototype,"typeSpecificPreconditionsReady",void 0),y([S({type:Nt,readOnly:!0})],Qt.prototype,"layerViews",void 0),y([S()],Qt.prototype,"resolution",null),y([S({type:N0e})],Qt.prototype,"magnifier",void 0),y([S({value:null,type:I0e})],Qt.prototype,"map",null),y([S()],Qt.prototype,"padding",void 0),y([S({readOnly:!0})],Qt.prototype,"ready",void 0),y([S()],Qt.prototype,"_readyStateWaitingTask",void 0),y([S({readOnly:!0})],Qt.prototype,"readyState",null),y([S({type:Ri})],Qt.prototype,"spatialReference",null),y([S()],Qt.prototype,"stationary",null),y([S({readOnly:!0})],Qt.prototype,"supportsGround",void 0),y([S({type:Uf})],Qt.prototype,"timeExtent",null),y([S({type:String,nonNullable:!0})],Qt.prototype,"timeZone",null),y([S()],Qt.prototype,"tools",null),y([S()],Qt.prototype,"toolViewManager",void 0),y([S({readOnly:!0})],Qt.prototype,"type",void 0),y([S({type:Number})],Qt.prototype,"scale",void 0),y([S({readOnly:!0})],Qt.prototype,"updating",void 0),y([S({readOnly:!0})],Qt.prototype,"initialExtentRequired",void 0),y([S({readOnly:!0})],Qt.prototype,"initialExtent",null),y([S()],Qt.prototype,"cursor",null),y([S({readOnly:!0})],Qt.prototype,"input",void 0),y([S({type:Z4,nonNullable:!0})],Qt.prototype,"navigation",void 0),y([S()],Qt.prototype,"layerViewManager",void 0),y([S()],Qt.prototype,"analysisViewManager",void 0),y([S()],Qt.prototype,"selectionManager",void 0),y([S()],Qt.prototype,"width",void 0),y([S()],Qt.prototype,"height",void 0),y([S({readOnly:!0})],Qt.prototype,"resizing",void 0),y([S({value:null,readOnly:!0})],Qt.prototype,"size",null),y([S({readOnly:!0})],Qt.prototype,"suspended",void 0),y([S({readOnly:!0})],Qt.prototype,"viewEvents",void 0),y([S({readOnly:!0})],Qt.prototype,"persistableViewModels",void 0),y([S()],Qt.prototype,"_isValid",void 0),y([S()],Qt.prototype,"_readyCycleForced",void 0),y([S()],Qt.prototype,"_lockedSpatialReference",void 0),y([S()],Qt.prototype,"_userTimeZone",void 0),y([S()],Qt.prototype,"_lockedTimeZone",void 0),y([S()],Qt.prototype,"_userTimeExtent",void 0),y([S()],Qt.prototype,"_lockedTimeExtent",void 0),y([S({type:lq})],Qt.prototype,"theme",void 0),y([S({readOnly:!0,type:lq})],Qt.prototype,"effectiveTheme",null),Qt=hT=y([se("esri.views.View")],Qt);const lV=globalThis.$arcgis;lV&&!lV.views&&Object.defineProperty(lV,"views",{configurable:!1,enumerable:!0,writable:!1,value:Qt.views});const pKe=Qt;function fKe(t){return t.layerViews}function Gw(t,e){return t[0]=e[0],t[1]=e[1],t}function ea(t,e,i){return t[0]=e,t[1]=i,t}function J0e(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t}function bM(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t}function eve(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t}function tve(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t}function gKe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function _Ke(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function yKe(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t}function vKe(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t}function xKe(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function CA(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t}function bKe(t,e,i,s){return t[0]=e[0]+i[0]*s,t[1]=e[1]+i[1]*s,t}function K4(t,e){const i=e[0]-t[0],s=e[1]-t[1];return Math.sqrt(i*i+s*s)}function GL(t,e){const i=e[0]-t[0],s=e[1]-t[1];return i*i+s*s}function BL(t){const e=t[0],i=t[1];return Math.sqrt(e*e+i*i)}function ive(t){const e=t[0],i=t[1];return e*e+i*i}function sve(t,e){return t[0]=-e[0],t[1]=-e[1],t}function wKe(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function dq(t,e){const i=e[0],s=e[1];let n=i*i+s*s;return n>0&&(n=1/Math.sqrt(n),t[0]=e[0]*n,t[1]=e[1]*n),t}function nve(t,e){return t[0]*e[0]+t[1]*e[1]}function rve(t,e,i){const s=e[0]*i[1]-e[1]*i[0];return t[0]=t[1]=0,t[2]=s,t}function SKe(t,e,i,s){const n=e[0],r=e[1];return t[0]=n+s*(i[0]-n),t[1]=r+s*(i[1]-r),t}function EKe(t,e=1){const i=2*D4()*Math.PI;return t[0]=Math.cos(i)*e,t[1]=Math.sin(i)*e,t}function CKe(t,e,i){const s=e[0],n=e[1];return t[0]=i[0]*s+i[2]*n,t[1]=i[1]*s+i[3]*n,t}function bm(t,e,i){const s=e[0],n=e[1];return t[0]=i[0]*s+i[2]*n+i[4],t[1]=i[1]*s+i[3]*n+i[5],t}function TKe(t,e,i){const s=e[0],n=e[1];return t[0]=i[0]*s+i[3]*n+i[6],t[1]=i[1]*s+i[4]*n+i[7],t}function PKe(t,e,i){const s=e[0],n=e[1];return t[0]=i[0]*s+i[4]*n+i[12],t[1]=i[1]*s+i[5]*n+i[13],t}function MKe(t,e,i,s){const n=e[0]-i[0],r=e[1]-i[1],o=Math.sin(s),a=Math.cos(s);return t[0]=n*a-r*o+i[0],t[1]=n*o+r*a+i[1],t}function AKe(t,e){const i=t[0],s=t[1],n=e[0],r=e[1];let o=i*i+s*s;o>0&&(o=1/Math.sqrt(o));let a=n*n+r*r;a>0&&(a=1/Math.sqrt(a));const l=(i*n+s*r)*o*a;return l>1?0:l<-1?Math.PI:Math.acos(l)}function IKe(t){return"vec2("+t[0]+", "+t[1]+")"}function DKe(t,e){return t[0]===e[0]&&t[1]===e[1]}function NKe(t,e){const i=t[0],s=t[1],n=e[0],r=e[1],o=kl();return Math.abs(i-n)<=o*Math.max(1,Math.abs(i),Math.abs(n))&&Math.abs(s-r)<=o*Math.max(1,Math.abs(s),Math.abs(r))}function RKe(t,e,i,s,n){let r=e[0]-i[0],o=e[1]-i[1];const a=(s[0]*r+s[1]*o)*(n-1);return r=s[0]*a,o=s[1]*a,t[0]=e[0]+r,t[1]=e[1]+o,t}const OKe=BL,wY=bM,LKe=eve,FKe=tve,kKe=K4,$Ke=GL,UKe=ive;Object.freeze(Object.defineProperty({__proto__:null,add:J0e,angle:AKe,ceil:gKe,copy:Gw,cross:rve,dist:kKe,distance:K4,div:FKe,divide:tve,dot:nve,equals:NKe,exactEquals:DKe,floor:_Ke,inverse:wKe,len:OKe,length:BL,lerp:SKe,max:vKe,min:yKe,mul:LKe,multiply:eve,negate:sve,normalize:dq,projectAndScale:RKe,random:EKe,rotate:MKe,round:xKe,scale:CA,scaleAndAdd:bKe,set:ea,sqrDist:$Ke,sqrLen:UKe,squaredDistance:GL,squaredLength:ive,str:IKe,sub:wY,subtract:bM,transformMat2:CKe,transformMat2d:bm,transformMat3:TKe,transformMat4:PKe},Symbol.toStringTag,{value:"Module"}));function Tr(){return[0,0]}function VKe(t){return[t[0],t[1]]}function TA(t,e){return[t,e]}function zKe(t,e){return[t,e]}function GKe(t,e=Tr()){const i=Math.min(2,t.length);for(let s=0;s<i;++s)e[s]=t[s];return e}function BKe(t,e){return new Float64Array(t,e,2)}function ove(){return Tr()}function ave(){return TA(1,1)}function lve(){return TA(1,0)}function uve(){return TA(0,1)}const qKe=ove(),HKe=ave(),jKe=lve(),YKe=uve();Object.freeze(Object.defineProperty({__proto__:null,ONES:HKe,UNIT_X:jKe,UNIT_Y:YKe,ZEROS:qKe,clone:VKe,create:Tr,createView:BKe,freeze:zKe,fromArray:GKe,fromValues:TA,ones:ave,unitX:lve,unitY:uve,zeros:ove},Symbol.toStringTag,{value:"Module"}));function XKe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function WKe(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function ZKe(t,e,i,s,n,r,o){return t[0]=e,t[1]=i,t[2]=s,t[3]=n,t[4]=r,t[5]=o,t}function SY(t,e){const i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5];let l=i*r-s*n;return l?(l=1/l,t[0]=r*l,t[1]=-s*l,t[2]=-n*l,t[3]=i*l,t[4]=(n*a-r*o)*l,t[5]=(s*o-i*a)*l,t):null}function KKe(t){return t[0]*t[3]-t[1]*t[2]}function cve(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=i[0],c=i[1],h=i[2],d=i[3],m=i[4],f=i[5];return t[0]=s*u+r*c,t[1]=n*u+o*c,t[2]=s*h+r*d,t[3]=n*h+o*d,t[4]=s*m+r*f+a,t[5]=n*m+o*f+l,t}function Q4(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=Math.sin(i),c=Math.cos(i);return t[0]=s*c+r*u,t[1]=n*c+o*u,t[2]=s*-u+r*c,t[3]=n*-u+o*c,t[4]=a,t[5]=l,t}function EY(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=i[0],c=i[1];return t[0]=s*u,t[1]=n*u,t[2]=r*c,t[3]=o*c,t[4]=a,t[5]=l,t}function wM(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=i[0],c=i[1];return t[0]=s,t[1]=n,t[2]=r,t[3]=o,t[4]=s*u+r*c+a,t[5]=n*u+o*c+l,t}function hve(t,e){const i=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=i,t[2]=-i,t[3]=s,t[4]=0,t[5]=0,t}function dve(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function CY(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function QKe(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function JKe(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+1)}function eQe(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t}function mve(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t}function tQe(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t}function iQe(t,e,i,s){return t[0]=e[0]+i[0]*s,t[1]=e[1]+i[1]*s,t[2]=e[2]+i[2]*s,t[3]=e[3]+i[3]*s,t[4]=e[4]+i[4]*s,t[5]=e[5]+i[5]*s,t}function sQe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function nQe(t,e){const i=t[0],s=t[1],n=t[2],r=t[3],o=t[4],a=t[5],l=e[0],u=e[1],c=e[2],h=e[3],d=e[4],m=e[5],f=kl();return Math.abs(i-l)<=f*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(s-u)<=f*Math.max(1,Math.abs(s),Math.abs(u))&&Math.abs(n-c)<=f*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(r-h)<=f*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(o-d)<=f*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(a-m)<=f*Math.max(1,Math.abs(a),Math.abs(m))}const rQe=cve,oQe=mve;Object.freeze(Object.defineProperty({__proto__:null,add:eQe,copy:XKe,determinant:KKe,equals:nQe,exactEquals:sQe,frob:JKe,fromRotation:hve,fromScaling:dve,fromTranslation:CY,identity:WKe,invert:SY,mul:rQe,multiply:cve,multiplyScalar:tQe,multiplyScalarAndAdd:iQe,rotate:Q4,scale:EY,set:ZKe,str:QKe,sub:oQe,subtract:mve,translate:wM},Symbol.toStringTag,{value:"Module"}));function Pf(){return[1,0,0,1,0,0]}function aQe(t){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function lQe(t,e,i,s,n,r){return[t,e,i,s,n,r]}function uQe(t,e){return new Float64Array(t,e,6)}const cQe=Pf();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:cQe,clone:aQe,create:Pf,createView:uQe,fromValues:lQe},Symbol.toStringTag,{value:"Module"}));const YN={102100:{maxX:20037508342788905e-9,minX:-20037508342788905e-9,plus180Line:new gu({paths:[[[20037508342788905e-9,-20037508342788905e-9],[20037508342788905e-9,20037508342788905e-9]]],spatialReference:Ri.WebMercator}),minus180Line:new gu({paths:[[[-20037508342788905e-9,-20037508342788905e-9],[-20037508342788905e-9,20037508342788905e-9]]],spatialReference:Ri.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new gu({paths:[[[180,-180],[180,180]]],spatialReference:Ri.WGS84}),minus180Line:new gu({paths:[[[-180,-180],[-180,180]]],spatialReference:Ri.WGS84})}};function qv(t,e){return Math.ceil((t-e)/(2*e))}function pve(t,e){const i=lP(t);for(const s of i)for(const n of s)n[0]+=e;return t}function lP(t){return Xv(t)?t.rings:t.paths}function r1t(t,e){return e?{...e,query:{...t??{},...e.query}}:{query:t}}function hQe(t){return typeof t=="string"?ol(t):be(t)}function dQe(t,e,i){const s={};for(const n in t){if(n==="declaredClass")continue;const r=t[n];if(r!=null&&typeof r!="function")if(Array.isArray(r))s[n]=r.map(o=>dQe(o));else if(typeof r=="object")if(r.toJSON){const o=r.toJSON(i==null?void 0:i[n]);s[n]=e?o:JSON.stringify(o)}else s[n]=e?r:JSON.stringify(r);else s[n]=r}return s}async function mQe(t,e,i,s){const n=hQe(t),r=e[0].spatialReference,o={...s,responseType:"json",query:{...n.query,f:"json",sr:Sce(r),target:JSON.stringify({geometryType:m7(e[0]),geometries:e}),cutter:JSON.stringify(i)}},a=await $n(n.path+"/cut",o),{cutIndexes:l,geometries:u=[]}=a.data;return{cutIndexes:l,geometries:u.map(c=>{const h=f1(c);return h.spatialReference=r,h})}}function pQe(t){return{geometryType:m7(t[0]),geometries:t.map(e=>e.toJSON())}}function fQe(t,e,i){const s=lNe(e);return t.map(n=>{const r=s.fromJSON(n);return r.spatialReference=i,r})}async function gQe(t,e,i){const s=typeof t=="string"?ol(t):t,n=e[0].spatialReference,r=m7(e[0]),o={...i,query:{...s.query,f:"json",sr:Sce(n),geometries:JSON.stringify(pQe(e))}},{data:a}=await $n(s.path+"/simplify",o);return fQe(a.geometries,r,n)}const fve=()=>ht.getLogger("esri.geometry.support.normalizeUtils");function _Qe(t){return t.type==="polygon"}function yQe(t){return t[0].type==="polygon"}function vQe(t){return t[0].type==="polyline"}function one(t){const e=[];let i=0,s=0;for(let n=0;n<t.length;n++){const r=t[n];let o=null;for(let a=0;a<r.length;a++)o=r[a],e.push(o),a===0?(i=o[0],s=i):(i=Math.min(i,o[0]),s=Math.max(s,o[0]));o&&e.push([(i+s)/2,0])}return e}function xQe(t,e){if(!(t instanceof gu||t instanceof Na)){const n="straightLineDensify: the input geometry is neither polyline nor polygon";throw fve().error(n),new Se(n)}const i=lP(t),s=[];for(const n of i){const r=[];s.push(r),r.push([n[0][0],n[0][1]]);for(let o=0;o<n.length-1;o++){const a=n[o][0],l=n[o][1],u=n[o+1][0],c=n[o+1][1],h=Math.sqrt((u-a)*(u-a)+(c-l)*(c-l)),d=(c-l)/h,m=(u-a)/h,f=h/e;if(f>1){for(let w=1;w<=f-1;w++){const T=w*e,C=m*T+a,M=d*T+l;r.push([C,M])}const _=(h+Math.floor(f-1)*e)/2,v=m*_+a,x=d*_+l;r.push([v,x])}r.push([u,c])}}return _Qe(t)?new Na({rings:s,spatialReference:t.spatialReference}):new gu({paths:s,spatialReference:t.spatialReference})}function ane(t,e,i){if(e){const s=xQe(t,1e6);t=Ov(s,!0)}return i&&(t=pve(t,i)),t}function lne(t,e,i){if(Array.isArray(t)){const s=t[0];if(s>e){const n=qv(s,e);t[0]=s+n*(-2*e)}else if(s<i){const n=qv(s,i);t[0]=s+n*(-2*i)}}else{const s=t.x;if(s>e){const n=qv(s,e);t=t.clone().offset(n*(-2*e),0)}else if(s<i){const n=qv(s,i);t=t.clone().offset(n*(-2*i),0)}}return t}function bQe(t,e){let i=-1;for(let s=0;s<e.cutIndexes.length;s++){const n=e.cutIndexes[s],r=e.geometries[s],o=lP(r);for(let a=0;a<o.length;a++){const l=o[a];l.some(u=>{if(u[0]<180)return!0;{let c=0;for(let d=0;d<l.length;d++){const m=l[d][0];c=m>c?m:c}c=Number(c.toFixed(9));const h=-360*qv(c,180);for(let d=0;d<l.length;d++){const m=r.getPoint(a,d);r.setPoint(a,d,m.clone().offset(h,0))}return!0}})}if(n===i){if(yQe(t))for(const a of lP(r))t[n]=t[n].addRing(a);else if(vQe(t))for(const a of lP(r))t[n]=t[n].addPath(a)}else i=n,t[n]=r}return t}async function wQe(t,e,i){if(!Array.isArray(t))return wQe([t],e);e&&typeof e!="string"&&fve().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const s=typeof e=="string"?e:(e==null?void 0:e.url)??Ks.geometryServiceUrl;let n,r,o,a,l,u,c,h,d=0;const m=[],f=[];for(const C of t)if(C!=null)if(n||(n=C.spatialReference,r=Ol(n),o=n.isWebMercator,u=o?102100:4326,a=YN[u].maxX,l=YN[u].minX,c=YN[u].plus180Line,h=YN[u].minus180Line),r)if(C.type==="mesh")f.push(C);else if(C.type==="point")f.push(lne(C.clone(),a,l));else if(C.type==="multipoint"){const M=C.clone();M.points=M.points.map(A=>lne(A,a,l)),f.push(M)}else if(C.type==="extent"){const M=C.clone()._normalize(!1,!1,r);f.push(M.rings?new Na(M):M)}else if(C.extent){const M=C.extent,A=qv(M.xmin,l)*(2*a);let I=A===0?C.clone():pve(C.clone(),A);M.offset(A,0);let{xmin:L,xmax:D}=M;L=Number(L.toFixed(9)),D=Number(D.toFixed(9)),M.intersects(c)&&D!==a?(d=D>d?D:d,I=ane(I,o),m.push(I),f.push("cut")):M.intersects(h)&&L!==l?(d=D*(2*a)>d?D*(2*a):d,I=ane(I,o,360),m.push(I),f.push("cut")):f.push(I)}else f.push(C.clone());else f.push(C);else f.push(C);let _=qv(d,a),v=-90;const x=_,w=new gu;for(;_>0;){const C=360*_-180;w.addPath([[C,v],[C,-1*v]]),v*=-1,_--}if(m.length>0&&x>0){const C=bQe(m,await mQe(s,m,w,i)),M=[],A=[];for(let D=0;D<f.length;D++){const O=f[D];if(O!=="cut")A.push(O);else{const U=C.shift(),$=t[D];$!=null&&$.type==="polygon"&&$.rings&&$.rings.length>1&&U.rings.length>=$.rings.length?(M.push(U),A.push("simplify")):A.push(o?ty(U):U)}}if(!M.length)return A;const I=await gQe(s,M,i),L=[];for(let D=0;D<A.length;D++){const O=A[D];O!=="simplify"?L.push(O):L.push(o?ty(I.shift()):I.shift())}return L}const T=[];for(let C=0;C<f.length;C++){const M=f[C];if(M!=="cut")T.push(M);else{const A=m.shift();T.push(o===!0?ty(A):A)}}return T}function SQe(t){if(!t)return null;const e=t.extent;if(!e)return null;const i=t.spatialReference&&Ol(t.spatialReference);if(!i)return e;const[s,n]=i.valid,r=2*n,{width:o}=e;let a,{xmin:l,xmax:u}=e;if([l,u]=[u,l],t.type==="extent"||o===0||o<=n||o>r||l<s||u>n)return e;switch(t.type){case"polygon":if(!(t.rings.length>1))return e;a=one(t.rings);break;case"polyline":if(!(t.paths.length>1))return e;a=one(t.paths);break;case"multipoint":a=t.points}const c=e.clone();for(let h=0;h<a.length;h++){let d=a[h][0];d<0?(d+=n,u=Math.max(d,u)):(d-=n,l=Math.min(d,l))}return c.xmin=l,c.xmax=u,c.width<o?(c.xmin-=n,c.xmax-=n,c):e}function TY(t,e,i){const s=Ol(i);if(s==null)return t;const[n,r]=s.valid,o=2*r;let a=0,l=0;e>r?a=Math.ceil(Math.abs(e-r)/o):e<n&&(a=-Math.ceil(Math.abs(e-n)/o)),t>r?l=Math.ceil(Math.abs(t-r)/o):t<n&&(l=-Math.ceil(Math.abs(t-n)/o));let u=t+(a-l)*o;const c=u-e;return c>r?u-=o:c<n&&(u+=o),u}function o1t(t,e){const i=Ol(e);if(i){const[s,n]=i.valid,r=n-s;if(t<s)for(;t<s;)t+=r;if(t>n)for(;t>n;)t-=r}return t}const gve=96,_ve=39.37,EQe=180/Math.PI;function yve(t){return t.wkid?t:t.spatialReference||Ri.WGS84}function PY(t,e){return e.type?ea(t,e.x,e.y):Gw(t,e)}function vve(t){return ah(t)}function J4(t,e,i=0){let s=t.width,n=t.height;if(i!==0){const a=qM(i),l=Math.abs(Math.cos(a)),u=Math.abs(Math.sin(a));s=t.width*l+t.height*u,n=t.width*u+t.height*l}const r=Math.max(1,e[0]),o=Math.max(1,e[1]);return Math.max(s/r,n/o)*NQe(t.spatialReference)}async function dT(t,e,i,s){var a,l,u;let n,r;if(!t||Array.isArray(t)&&!t.length)return null;if(Nt.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&typeof t[0]=="object"){const c=t.every(m=>"attributes"in m),h=t.some(m=>!m.geometry);let d=t;if(c&&h&&e&&e.allLayerViews){const m=new Map;for(const x of t){const w=x.layer,T=m.get(w)||[],C=x.attributes[w.objectIdField];C!=null&&T.push(C),m.set(w,T)}const f=[];m.forEach((x,w)=>{var C;const T=(C=e.allLayerViews)==null?void 0:C.find(M=>M.layer.id===w.id);if(T&&"queryFeatures"in T){const M=w.createQuery();M.objectIds=x,M.returnGeometry=!0,f.push(T.queryFeatures(M))}});const _=await Promise.all(f),v=[];for(const x of _)if(x&&x.features&&x.features.length)for(const w of x.features)w.geometry!=null&&v.push(w.geometry);d=v}for(const m of d)s=await dT(m,e,i,s);return s}if(Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number")n=new ki(t);else if(t instanceof jf)n=t;else if("geometry"in t){if(t.geometry)n=t.geometry;else if(t.layer){const c=t.layer,h=(a=e.allLayerViews)==null?void 0:a.find(d=>d.layer.id===c.id);if(h&&"queryFeatures"in h){const d=c.createQuery();d.objectIds=[t.attributes[c.objectIdField]],d.returnGeometry=!0;const m=await h.queryFeatures(d);n=(u=(l=m==null?void 0:m.features)==null?void 0:l[0])==null?void 0:u.geometry}}}if(n==null)return null;switch(n.type){case"point":r=new Nn({xmin:n.x,ymin:n.y,xmax:n.x,ymax:n.y,spatialReference:n.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":r=SQe(n);break;default:r=n.extent}if(!r)return null;Hy()||Bm(r.spatialReference,i)||await Ay();const o=jy(r,i);if(!o)return null;if(s){const c=o.center,h=c.clone();h.x=TY(c.x,s.center.x,i),h.x!==c.x&&o.centerAt(h),s=s.union(o)}else s=o;return s}function CQe(t){var e;if(t&&(!Array.isArray(t)||typeof t[0]!="number")&&(typeof t=="object"||Array.isArray(t)&&typeof t[0]=="object")){if("layer"in t&&((e=t.layer)==null?void 0:e.minScale)!=null&&t.layer.maxScale!=null){const i=t.layer;return{min:i.minScale,max:i.maxScale}}if(Array.isArray(t)&&t.length&&t.every(i=>"layer"in i)){let i=0,s=0;for(const n of t){const r=n.layer;r!=null&&r.minScale&&r.maxScale&&(i=r.minScale<i?r.minScale:i,s=r.maxScale>s?r.maxScale:s)}return i&&s?{min:i,max:s}:null}}}function une(t,e){const i=yve(t);return $o(i,e)||i.imageCoordinateSystem||e.imageCoordinateSystem?t:jy(t,e)}async function TQe(t,e){var v;if(!t||!e)return new th({targetGeometry:new ki,scale:0,rotation:0});let i=e.spatialReference;const{constraints:s,padding:n,viewpoint:r,size:o}=e,a=[n?o[0]-n.left-n.right:o[0],n?o[1]-n.top-n.bottom:o[1]];let l=null;t instanceof th?l=t:t.viewpoint?l=t.viewpoint:t.target&&t.target.declaredClass==="esri.Viewpoint"&&(l=t.target);let u=null;l!=null&&l.targetGeometry?u=l.targetGeometry:t instanceof Nn?u=t:t instanceof jf?u=await dT(t,e,i):t&&(u=await dT(t.center,e,i)||await dT(t.target,e,i)||await dT(t,e,i)),!u&&(r!=null&&r.targetGeometry)?u=r.targetGeometry:!u&&e.extent&&(u=e.extent),i||(i=yve(e.spatialReference||e.extent||u)),Hy()||$o(u.spatialReference,i)||Bm(u.spatialReference,i)||await Ay();const c=une(u,i),h="center"in c?c.center:c;e.pickClosestTarget!==!1&&h.type==="point"&&((v=r.targetGeometry)==null?void 0:v.type)==="point"&&(h.x=TY(h.x,r.targetGeometry.x,h.spatialReference));let d=0;l?d=l.rotation:t.hasOwnProperty("rotation")?d=t.rotation:r&&(d=r.rotation);let m=0;m=(l==null?void 0:l.targetGeometry)!=null&&l.targetGeometry.type==="point"?l.scale:"scale"in t&&t.scale?t.scale:"zoom"in t&&t.zoom!==-1&&s&&s.effectiveLODs?s.zoomToScale(t.zoom):Array.isArray(u)||u.type==="point"||u.type==="extent"&&u.width===0&&u.height===0?r.scale:J4(une(u.extent,i),a,d);const f=CQe(t.target??t);f&&(f.min&&f.min<m?m=f.min:f.max&&f.max>m&&(m=f.max));let _=new th({targetGeometry:h,scale:m,rotation:d});return s&&(_=s.fit(_),s.constrainByGeometry(_),s.rotationEnabled||(_.rotation=r.rotation)),_}function sl(t,e){const i=t.targetGeometry,s=e.targetGeometry;return i.x=s.x,i.y=s.y,i.spatialReference=s.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function PQe(t,e,i){return i?ea(t,.5*(e[0]-i.right+i.left),.5*(e[1]-i.bottom+i.top)):CA(t,e,.5)}const MQe=function(){const t=Tr();return function(e,i,s){const n=i.targetGeometry;PY(t,n);const r=.5*lE(i);return e.xmin=t[0]-r*s[0],e.ymin=t[1]-r*s[1],e.xmax=t[0]+r*s[0],e.ymax=t[1]+r*s[1],e.spatialReference=n.spatialReference,e}}();function AQe(t,e,i,s,n){var r;return mq(t,e,i.center),t.scale=J4(i,s),(r=n==null?void 0:n.constraints)==null||r.constrain(t),t}function IQe(t,e,i,s){return IY(t,e,i,s),SY(t,t)}const xve=function(){const t=Tr();return function(e,i,s){return wY(e,RQe(e,i),PQe(t,i,s))}}(),DQe=function(){const t=Pf(),e=Tr();return function(i,s,n,r){const o=lE(s),a=MY(s);return ea(e,o,o),dve(t,e),Q4(t,t,a),wM(t,t,xve(e,n,r)),wM(t,t,[0,r.top-r.bottom]),ea(i,t[4],t[5])}}();function lE(t){var e;return t.scale*bve((e=t.targetGeometry)==null?void 0:e.spatialReference)}function bve(t){return rc(t)?1/(vve(t)*_ve*gve):1}function MY(t){return Uj(t.rotation)||0}function NQe(t){return rc(t)?vve(t)*_ve*gve:1}function RQe(t,e){return CA(t,e,.5)}const AY=function(){const t=Tr(),e=Tr(),i=Tr();return function(s,n,r,o,a,l){return sve(t,n),CA(e,r,.5*l),ea(i,1/o*l,-1/o*l),CY(s,e),a&&Q4(s,s,a),EY(s,s,i),wM(s,s,t),s}}(),IY=function(){const t=Tr();return function(e,i,s,n){const r=lE(i),o=MY(i);return PY(t,i.targetGeometry),AY(e,t,s,r,o,n)}}(),OQe=function(){const t=Tr();return function(e,i,s,n){const r=lE(i);return PY(t,i.targetGeometry),AY(e,t,s,r,0,n)}}();function wve(t){const e=Ol(t);return e?e.valid[1]-e.valid[0]:0}function LQe(t,e){return Math.round(wve(t)/e)}const FQe=function(){const t=Tr(),e=Tr(),i=[0,0,0];return function(s,n,r){bM(t,s,n),dq(t,t),bM(e,s,r),dq(e,e),rve(i,t,e);let o=Math.acos(nve(t,e)/(BL(t)*BL(e)))*EQe;return i[2]<0&&(o=-o),isNaN(o)&&(o=0),o}}(),kQe=function(){const t=Tr();return function(e,i,s,n){const r=e.targetGeometry;return sl(e,i),DQe(t,i,s,n),r.x+=t[0],r.y+=t[1],e}}(),mq=function(t,e,i){sl(t,e);const s=t.targetGeometry;return s.x=i.x,s.y=i.y,s.spatialReference=i.spatialReference,t},$Qe=function(){const t=Tr();return function(e,i,s,n,r){r||(r="center"),wY(t,s,n),CA(t,t,.5);const o=t[0],a=t[1];switch(r){case"center":ea(t,0,0);break;case"left":ea(t,-o,0);break;case"top":ea(t,0,a);break;case"right":ea(t,o,0);break;case"bottom":ea(t,0,-a);break;case"top-left":ea(t,-o,a);break;case"bottom-left":ea(t,-o,-a);break;case"top-right":ea(t,o,a);break;case"bottom-right":ea(t,o,-a)}return ek(e,i,t),e}}();function a1t(t,e,i){return sl(t,e),t.rotation+=i,t}function UQe(t,e,i){return sl(t,e),t.rotation=i,t}const VQe=function(){const t=Tr();return function(e,i,s,n,r){return sl(e,i),isNaN(s)||s===0||(Eve(t,n,i,r),e.scale=i.scale*s,Cve(t,t,e,r),ek(e,e,ea(t,t[0]-n[0],n[1]-t[1]))),e}}();function cne(t,e,i){return sl(t,e),t.scale=i,t}const Sve=function(){const t=Tr();return function(e,i,s,n,r,o){return sl(e,i),isNaN(s)||s===0||(Eve(t,r,i,o),e.scale=i.scale*s,e.rotation+=n,Cve(t,t,e,o),ek(e,e,ea(t,t[0]-r[0],r[1]-t[1]))),e}}(),l1t=function(){const t=Tr(),e=Tr();return function(i,s,n,r,o,a,l){return xve(e,a,l),J0e(t,o,e),r?Sve(i,s,n,r,t,a):VQe(i,s,n,t,a)}}(),Eve=function(){const t=Pf();return function(e,i,s,n){return bm(e,i,IQe(t,s,n,1))}}(),Cve=function(){const t=Pf();return function(e,i,s,n){return bm(e,i,IY(t,s,n,1))}}(),ek=function(){const t=Tr(),e=Pf();return function(i,s,n){sl(i,s);const r=lE(s),o=i.targetGeometry;return hve(e,MY(s)),EY(e,e,TA(r,r)),bm(t,n,e),o.x+=t[0],o.y+=t[1],i}}();function Tve(){const t=new Float32Array(6);return t[0]=1,t[3]=1,t}function zQe(t){const e=new Float32Array(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function GQe(t,e,i,s,n,r){const o=new Float32Array(6);return o[0]=t,o[1]=e,o[2]=i,o[3]=s,o[4]=n,o[5]=r,o}function BQe(t,e){return new Float32Array(t,e,6)}function Pve(t,e,i,s){const n=e[s],r=e[s+1];t[s]=i[0]*n+i[2]*r+i[4],t[s+1]=i[1]*n+i[3]*r+i[5]}function qQe(t,e,i,s=0,n=0,r=2){const o=n||e.length/r;for(let a=s;a<o;a++)Pve(t,e,i,a*r)}Object.freeze(Object.defineProperty({__proto__:null,clone:zQe,create:Tve,createView:BQe,fromValues:GQe,transform:Pve,transformMany:qQe},Symbol.toStringTag,{value:"Module"}));function HQe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function jQe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Mve(t,e,i,s,n,r,o,a,l,u){return t[0]=e,t[1]=i,t[2]=s,t[3]=n,t[4]=r,t[5]=o,t[6]=a,t[7]=l,t[8]=u,t}function Ave(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function YQe(t,e){if(t===e){const i=e[1],s=e[2],n=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=s,t[7]=n}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function XQe(t,e){const i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=c*o-a*u,d=-c*r+a*l,m=u*r-o*l;let f=i*h+s*d+n*m;return f?(f=1/f,t[0]=h*f,t[1]=(-c*s+n*u)*f,t[2]=(a*s-n*o)*f,t[3]=d*f,t[4]=(c*i-n*l)*f,t[5]=(-a*i+n*r)*f,t[6]=m*f,t[7]=(-u*i+s*l)*f,t[8]=(o*i-s*r)*f,t):null}function WQe(t,e){const i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8];return t[0]=o*c-a*u,t[1]=n*u-s*c,t[2]=s*a-n*o,t[3]=a*l-r*c,t[4]=i*c-n*l,t[5]=n*r-i*a,t[6]=r*u-o*l,t[7]=s*l-i*u,t[8]=i*o-s*r,t}function ZQe(t){const e=t[0],i=t[1],s=t[2],n=t[3],r=t[4],o=t[5],a=t[6],l=t[7],u=t[8];return e*(u*r-o*l)+i*(-u*n+o*a)+s*(l*n-r*a)}function DY(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=i[0],m=i[1],f=i[2],_=i[3],v=i[4],x=i[5],w=i[6],T=i[7],C=i[8];return t[0]=d*s+m*o+f*u,t[1]=d*n+m*a+f*c,t[2]=d*r+m*l+f*h,t[3]=_*s+v*o+x*u,t[4]=_*n+v*a+x*c,t[5]=_*r+v*l+x*h,t[6]=w*s+T*o+C*u,t[7]=w*n+T*a+C*c,t[8]=w*r+T*l+C*h,t}function pq(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=i[0],m=i[1];return t[0]=s,t[1]=n,t[2]=r,t[3]=o,t[4]=a,t[5]=l,t[6]=d*s+m*o+u,t[7]=d*n+m*a+c,t[8]=d*r+m*l+h,t}function Ive(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=Math.sin(i),m=Math.cos(i);return t[0]=m*s+d*o,t[1]=m*n+d*a,t[2]=m*r+d*l,t[3]=m*o-d*s,t[4]=m*a-d*n,t[5]=m*l-d*r,t[6]=u,t[7]=c,t[8]=h,t}function KQe(t,e,i){const s=i[0],n=i[1],r=i[2];return t[0]=s*e[0],t[1]=s*e[1],t[2]=s*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t[6]=r*e[6],t[7]=r*e[7],t[8]=r*e[8],t}function QQe(t,e,i){const s=i[0],n=i[1];return t[0]=s*e[0],t[1]=s*e[1],t[2]=s*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t}function JQe(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function eJe(t,e){const i=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=i,t[2]=0,t[3]=-i,t[4]=s,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function tJe(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function iJe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function sJe(t,e){const i=e[0],s=e[1],n=e[2],r=e[3],o=i+i,a=s+s,l=n+n,u=i*o,c=s*o,h=s*a,d=n*o,m=n*a,f=n*l,_=r*o,v=r*a,x=r*l;return t[0]=1-h-f,t[3]=c-x,t[6]=d+v,t[1]=c+x,t[4]=1-u-f,t[7]=m-_,t[2]=d-v,t[5]=m+_,t[8]=1-u-h,t}function nJe(t,e){const i=e[0],s=e[1],n=e[2],r=e[4],o=e[5],a=e[6],l=e[8],u=e[9],c=e[10],h=c*o-a*u,d=-c*r+a*l,m=u*r-o*l,f=i*h+s*d+n*m;if(!f)return null;const _=1/f;return t[0]=h*_,t[1]=(-c*s+n*u)*_,t[2]=(a*s-n*o)*_,t[3]=d*_,t[4]=(c*i-n*l)*_,t[5]=(-a*i+n*r)*_,t[6]=m*_,t[7]=(-u*i+s*l)*_,t[8]=(o*i-s*r)*_,t}function rJe(t,e){const i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],m=e[11],f=e[12],_=e[13],v=e[14],x=e[15],w=i*a-s*o,T=i*l-n*o,C=i*u-r*o,M=s*l-n*a,A=s*u-r*a,I=n*u-r*l,L=c*_-h*f,D=c*v-d*f,O=c*x-m*f,U=h*v-d*_,$=h*x-m*_,B=d*x-m*v;let V=w*B-T*$+C*U+M*O-A*D+I*L;return V?(V=1/V,t[0]=(a*B-l*$+u*U)*V,t[1]=(l*O-o*B-u*D)*V,t[2]=(o*$-a*O+u*L)*V,t[3]=(n*$-s*B-r*U)*V,t[4]=(i*B-n*O+r*D)*V,t[5]=(s*O-i*$-r*L)*V,t[6]=(_*I-v*A+x*M)*V,t[7]=(v*C-f*I-x*T)*V,t[8]=(f*A-_*C+x*w)*V,t):null}function oJe(t,e,i){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/i,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function aJe(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function lJe(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2)}function uJe(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t}function Dve(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t}function cJe(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t}function hJe(t,e,i,s){return t[0]=e[0]+i[0]*s,t[1]=e[1]+i[1]*s,t[2]=e[2]+i[2]*s,t[3]=e[3]+i[3]*s,t[4]=e[4]+i[4]*s,t[5]=e[5]+i[5]*s,t[6]=e[6]+i[6]*s,t[7]=e[7]+i[7]*s,t[8]=e[8]+i[8]*s,t}function dJe(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function mJe(t,e){const i=t[0],s=t[1],n=t[2],r=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8],h=e[0],d=e[1],m=e[2],f=e[3],_=e[4],v=e[5],x=e[6],w=e[7],T=e[8],C=kl();return Math.abs(i-h)<=C*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(s-d)<=C*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(n-m)<=C*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(r-f)<=C*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(o-_)<=C*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(a-v)<=C*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(l-x)<=C*Math.max(1,Math.abs(l),Math.abs(x))&&Math.abs(u-w)<=C*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(c-T)<=C*Math.max(1,Math.abs(c),Math.abs(T))}function pJe(t){const e=kl(),i=t[0],s=t[1],n=t[2],r=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8];return Math.abs(1-(i*i+r*r+l*l))<=e&&Math.abs(1-(s*s+o*o+u*u))<=e&&Math.abs(1-(n*n+a*a+c*c))<=e}const fJe=DY,gJe=Dve;Object.freeze(Object.defineProperty({__proto__:null,add:uJe,adjoint:WQe,copy:jQe,determinant:ZQe,equals:mJe,exactEquals:dJe,frob:lJe,fromMat2d:iJe,fromMat4:HQe,fromQuat:sJe,fromRotation:eJe,fromScaling:tJe,fromTranslation:JQe,identity:Ave,invert:XQe,isOrthoNormal:pJe,mul:fJe,multiply:DY,multiplyScalar:cJe,multiplyScalarAndAdd:hJe,normalFromMat4:rJe,normalFromMat4Legacy:nJe,projection:oJe,rotate:Ive,scale:KQe,scaleByVec2:QQe,set:Mve,str:aJe,sub:gJe,subtract:Dve,translate:pq,transpose:YQe},Symbol.toStringTag,{value:"Module"}));function O3(){const t=new Float32Array(9);return t[0]=1,t[4]=1,t[8]=1,t}function _Je(t){const e=new Float32Array(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function yJe(t,e,i,s,n,r,o,a,l){const u=new Float32Array(9);return u[0]=t,u[1]=e,u[2]=i,u[3]=s,u[4]=n,u[5]=r,u[6]=o,u[7]=a,u[8]=l,u}function vJe(t,e){return new Float32Array(t,e,9)}Object.freeze(Object.defineProperty({__proto__:null,clone:_Je,create:O3,createView:vJe,fromValues:yJe},Symbol.toStringTag,{value:"Module"}));function Nve(){return new Float32Array(2)}function xJe(t){const e=new Float32Array(2);return e[0]=t[0],e[1]=t[1],e}function NS(t,e){const i=new Float32Array(2);return i[0]=t,i[1]=e,i}function bJe(t,e){return new Float32Array(t,e,2)}function Rve(){return Nve()}function Ove(){return NS(1,1)}function Lve(){return NS(1,0)}function Fve(){return NS(0,1)}const wJe=Rve(),SJe=Ove(),EJe=Lve(),CJe=Fve();Object.freeze(Object.defineProperty({__proto__:null,ONES:SJe,UNIT_X:EJe,UNIT_Y:CJe,ZEROS:wJe,clone:xJe,create:Nve,createView:bJe,fromValues:NS,ones:Ove,unitX:Lve,unitY:Fve,zeros:Rve},Symbol.toStringTag,{value:"Module"}));function TJe(t){return t instanceof Float32Array&&t.length>=2}function PJe(t){return Array.isArray(t)&&t.length>=2}function uV(t){return TJe(t)||PJe(t)}var fq;const Ip=[0,0];let Xp=fq=class extends it{constructor(t){super(t),this._viewpoint2D={center:Tr(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new Nn,this.id=0,this.inverseTransform=Pf(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=Pf(),this.transformNoRotation=Pf(),this.displayMat3=O3(),this.displayViewMat3=O3(),this.viewMat3=O3(),this.viewMat2d=Tve(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(t){this._set("pixelRatio",t),this._update()}set size(t){this._set("size",t),this._update()}set viewpoint(t){if(t){const e=this._viewpoint2D,i=t.targetGeometry;e.center[0]=i.x,e.center[1]=i.y,e.rotation=t.rotation,e.scale=t.scale,e.spatialReference=i.spatialReference}this._update()}get visibleArea(){const[t,e]=this.size;return[this.toMap([0,0],0,0),this.toMap([0,0],0,e),this.toMap([0,0],t,e),this.toMap([0,0],t,0)]}copy(t){const e=this.size,i=this.viewpoint;return i&&e?(this.viewpoint=sl(i,t.viewpoint),this._set("size",Gw(e,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new fq({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,e,i){return uV(e)?bm(t,e,this.inverseTransform):(Ip[0]=e,Ip[1]=i,bm(t,Ip,this.inverseTransform))}toScreen(t,e,i){return uV(e)?bm(t,e,this.transform):(Ip[0]=e,Ip[1]=i,bm(t,Ip,this.transform))}toScreenNoRotation(t,e,i){return uV(e)?bm(t,e,this.transformNoRotation):(Ip[0]=e,Ip[1]=i,bm(t,Ip,this.transformNoRotation))}wrapMapCoordinate(t,e){Gw(t,e);const[i]=e,[s]=this.center,{extent:n,spatialReference:r}=this;let{xmin:o,xmax:a}=n;if(r.isWrappable){const l=wve(r)/2;o=Math.max(o,s-l),a=Math.min(a,s+l)}return(i<o||i>a)&&(t[0]=TY(i,s,r)),t}getScreenTransform(t,e){const{center:i}=this._viewpoint2D,s=this._get("pixelRatio")||1,n=this._get("size");return AY(t,i,n,e,0,s),t}_update(){const{center:t,spatialReference:e,scale:i,rotation:s}=this._viewpoint2D,n=this._get("pixelRatio")||1,r=this._get("size"),o=new th({targetGeometry:new ki(t[0],t[1],e),scale:i,rotation:s});if(this._set("viewpoint",o),!r||!e||!i)return;this.resolution=lE(o),this.rotation=s,this.scale=i,this.spatialReference=e,Gw(this.center,t);const a=r[0]!==0?2/r[0]:0,l=r[1]!==0?-2/r[1]:0;Mve(this.displayMat3,a,0,0,0,l,0,-1,1,1);const u=Ave(this.viewMat3),c=NS(r[0]/2,r[1]/2),h=NS(-r[0]/2,-r[1]/2),d=Uj(s);pq(u,u,c),Ive(u,u,d),pq(u,u,h),DY(this.displayViewMat3,this.displayMat3,u);const m=CY(this.viewMat2d,c);return Q4(m,m,d),wM(m,m,h),MQe(this.extent,o,r),IY(this.transform,o,r,n),SY(this.inverseTransform,this.transform),OQe(this.transformNoRotation,o,r,n),this.worldScreenWidth=LQe(this.spatialReference,this.resolution),this._set("id",this.id+1),this.notifyChange("visibleArea"),this}};y([S({readOnly:!0})],Xp.prototype,"id",void 0),y([S({value:1,json:{write:!0}})],Xp.prototype,"pixelRatio",null),y([S({json:{write:!0}})],Xp.prototype,"size",null),y([S()],Xp.prototype,"spatialReference",void 0),y([S({type:th,json:{write:!0}})],Xp.prototype,"viewpoint",null),y([S({readOnly:!0})],Xp.prototype,"visibleArea",null),Xp=fq=y([se("esri.views.2d.ViewState")],Xp);const hne=Xp;var gq,_q;let ff=gq=class extends ei{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new gq({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};y([S()],ff.prototype,"left",void 0),y([S()],ff.prototype,"top",void 0),y([S()],ff.prototype,"right",void 0),y([S()],ff.prototype,"bottom",void 0),ff=gq=y([se("esri.views.2d.PaddedViewState.Padding")],ff);let Rb=_q=class extends hne{constructor(...t){super(...t),this.paddedViewState=new hne,this._updateContent=(()=>{const e=Tr();return()=>{const i=this._get("size"),s=this._get("padding");if(!i||!s)return;const n=this.paddedViewState;ea(e,s.left+s.right,s.top+s.bottom),bM(e,i,e),Gw(n.size,e);const r=n.viewpoint;r&&(this.viewpoint=r)}})(),this.addHandles(Ai(()=>[this.size,this.padding],()=>this._updateContent(),km)),this.padding=new ff,this.size=[0,0]}set padding(t){this._set("padding",t||new ff)}set viewpoint(t){if(t){this.paddedViewState.viewpoint=t;let e=t;const i=this._get("padding");i&&(e=kQe(t.clone(),t,this._get("size"),i));const{targetGeometry:s,rotation:n,scale:r}=e,{x:o,y:a,spatialReference:l}=s,u=this._viewpoint2D;u.center[0]=o,u.center[1]=a,u.rotation=n,u.scale=r,u.spatialReference=l,this._update()}}clone(){return new _q({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};y([S()],Rb.prototype,"paddedViewState",void 0),y([S({type:ff})],Rb.prototype,"padding",null),y([S()],Rb.prototype,"viewpoint",null),Rb=_q=y([se("esri.views.2d.PaddedViewState")],Rb);const NY=Rb;var Ta;(function(t){t[t.ANIMATING=0]="ANIMATING",t[t.INTERACTING=1]="INTERACTING",t[t.IDLE=2]="IDLE"})(Ta||(Ta={}));const kve=Symbol("Yield");let MJe=class{constructor(){this._tasks=new Array,this._runningTasks=DS(0)}get length(){return this._tasks.length}get running(){return this._runningTasks.value>0}destroy(){this.cancelAll()}runTask(e){if(this.length===0)return kve;for(;!e.done&&this._process(e);)e.madeProgress()}push(e,i,s){return++this._runningTasks.value,new Promise((n,r)=>this._tasks.push(new dne(n,r,e,i,s))).finally(()=>--this._runningTasks.value)}unshift(e,i,s){return++this._runningTasks.value,new Promise((n,r)=>this._tasks.unshift(new dne(n,r,e,i,s))).finally(()=>--this._runningTasks.value)}_process(e){var s;if(this._tasks.length===0)return!1;const i=this._tasks.shift();try{const n=dc(i.signal);if(n&&!i.abortCallback)i.reject(Vn());else{const r=n?(s=i.abortCallback)==null?void 0:s.call(i,Vn()):i.callback(e);Hm(r)?r.then(i.resolve,i.reject):i.resolve(r)}}catch(n){i.reject(n)}return!0}cancelAll(){const e=Vn();for(const i of this._tasks)if(i.abortCallback){const s=i.abortCallback(e);i.resolve(s)}else i.reject(e);this._tasks.length=0}},dne=class{constructor(e,i,s,n=void 0,r=void 0){this.resolve=e,this.reject=i,this.callback=s,this.signal=n,this.abortCallback=r}},mT=class extends ei{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};y([S()],mT.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),y([S()],mT.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),mT=y([se("esri.views.support.debugFlags")],mT);const AJe=new mT;function IJe(){return new qL.Scheduler}var ns;(function(t){t.RESOURCE_CONTROLLER_IMMEDIATE="immediate",t.RESOURCE_CONTROLLER="schedule",t.SLIDE="slide",t.STREAM_DATA_LOADER="stream loader",t.ELEVATION_QUERY="elevation query",t.TERRAIN_SURFACE="terrain",t.SURFACE_GEOMETRY_UPDATES="surface geometry updates",t.LOD_RENDERER="LoD renderer",t.GRAPHICS_CORE="Graphics3D",t.I3S_CONTROLLER="I3S",t.POINT_CLOUD_LAYER="point cloud",t.FEATURE_TILE_FETCHER="feature fetcher",t.OVERLAY="overlay",t.STAGE="stage",t.GRAPHICS_DECONFLICTOR="graphics deconflictor",t.FILTER_VISIBILITY="Graphics3D filter visibility",t.SCALE_VISIBILITY="Graphics3D scale visibility",t.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",t.POINT_OF_INTEREST_FREQUENT="POI frequent",t.POINT_OF_INTEREST_INFREQUENT="POI infrequent",t.LABELER="labeler",t.FEATURE_QUERY_ENGINE="feature query",t.FEATURE_TILE_TREE="feature tile tree",t.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",t.ELEVATION_ALIGNMENT="elevation alignment",t.ELEVATION_ALIGNMENT_SCENE="elevation alignment scene",t.TEXT_TEXTURE_ATLAS="text texture atlas",t.TEXTURE_UNLOAD="texture unload",t.LINE_OF_SIGHT_TOOL="line of sight tool",t.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",t.ELEVATION_PROFILE="elevation profile",t.SNAPPING="snapping",t.SHADOW_ACCUMULATOR="shadow accumulator",t.CLOUDS_GENERATOR="clouds generator",t.MAPVIEW_FETCH_QUEUE="mapview fetch queue",t.MAPVIEW_LAYERVIEW_UPDATE="mapview layerview update",t.MAPVIEW_VECTOR_TILE_PARSING_QUEUE="mapview vector tile parsing queue",t[t.NONE=0]="NONE",t[t.TEST_PRIO=1]="TEST_PRIO"})(ns||(ns={}));const zc=0,mne=new Map([[ns.RESOURCE_CONTROLLER_IMMEDIATE,zc],[ns.RESOURCE_CONTROLLER,4],[ns.SLIDE,zc],[ns.STREAM_DATA_LOADER,zc],[ns.ELEVATION_QUERY,zc],[ns.TERRAIN_SURFACE,1],[ns.SURFACE_GEOMETRY_UPDATES,1],[ns.LOD_RENDERER,2],[ns.GRAPHICS_CORE,2],[ns.I3S_CONTROLLER,2],[ns.POINT_CLOUD_LAYER,2],[ns.FEATURE_TILE_FETCHER,2],[ns.CLOUDS_GENERATOR,2],[ns.OVERLAY,4],[ns.STAGE,4],[ns.GRAPHICS_DECONFLICTOR,4],[ns.FILTER_VISIBILITY,4],[ns.SCALE_VISIBILITY,4],[ns.FRUSTUM_VISIBILITY,4],[ns.POINT_OF_INTEREST_FREQUENT,6],[ns.POINT_OF_INTEREST_INFREQUENT,30],[ns.LABELER,8],[ns.FEATURE_QUERY_ENGINE,8],[ns.FEATURE_TILE_TREE,16],[ns.FEATURE_TILE_TREE_ACTIVE,zc],[ns.ELEVATION_ALIGNMENT,12],[ns.ELEVATION_ALIGNMENT_SCENE,14],[ns.TEXT_TEXTURE_ATLAS,12],[ns.TEXTURE_UNLOAD,12],[ns.LINE_OF_SIGHT_TOOL,16],[ns.LINE_OF_SIGHT_TOOL_INTERACTIVE,zc],[ns.SNAPPING,zc],[ns.SHADOW_ACCUMULATOR,30],[ns.MAPVIEW_FETCH_QUEUE,zc],[ns.MAPVIEW_LAYERVIEW_UPDATE,2],[ns.MAPVIEW_VECTOR_TILE_PARSING_QUEUE,zc]]);function pne(t){return mne.has(t)?mne.get(t):typeof t=="number"?t:1}const DJe=6.5,fne=1,NJe=30,RJe=1e3/30,OJe=100,gne=.9;var qL,M0;(function(t){class e{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some(r=>r.needsUpdate)}constructor(){this._updating=DS(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new kT("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new s,this._state=Ta.INTERACTING,this._tasks=new jv,this._runQueue=new jv,this._load=0,this._idleStateCallbacks=new jv,this._idleUpdatesStartFired=!1,this._forceTask=!1,this._debug=!1,this._debugHandle=Ai(()=>AJe.SCHEDULER_LOG_SLOW_TASKS,r=>this._debug=r,nl);for(const r of Object.keys(ns))this.performanceInfo.tasks.set(ns[r],new kT(ns[r]))}destroy(){this._tasks.toArray().forEach(r=>r.remove()),this._tasks.clear(),sr(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(r){this._updatingChanged(),r&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask(()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this._runFrame())}))}registerTask(r,o){const a=new i(this,r,o);return this._tasks.push(a),this._updatingChanged(),this.performanceInfo.tasks.has(r)||this.performanceInfo.tasks.set(r,new kT(r)),a}registerIdleStateCallbacks(r,o){const a={idleBegin:r,idleEnd:o};this._idleStateCallbacks.push(a),this.state===Ta.IDLE&&this._idleUpdatesStartFired&&a.idleBegin();const l=this;return{remove:()=>this._removeIdleStateCallbacks(a),set idleBegin(u){l._idleUpdatesStartFired&&(a.idleEnd(),l._state===Ta.IDLE&&u()),a.idleBegin=u},set idleEnd(u){a.idleEnd=u}}}get load(){return this._load}set state(r){this._state!==r&&(this._state=r,this.state!==Ta.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll(o=>o.idleEnd())))}get state(){return this._state}frame(r){this._startFrameTaskTimes();const o=this._updateBudget(r);if(o){const a=this._budget.now();this._runFrame(),this._recordFrameTaskTimes(this._budget.now()-a)}else this._recordFrameTaskTimes(0);return o}_updateBudget(r){this._test&&(this._test.usedBudget=0),++this._frameNumber;let o=DJe,a=r.frameDuration,l=fne;switch(this.state){case Ta.IDLE:o=0,a=Math.max(OJe,r.frameDuration),l=NJe;break;case Ta.INTERACTING:a=Math.max(RJe,r.frameDuration);case Ta.ANIMATING:}return a=a-r.elapsedFrameTime-o,this.state!==Ta.IDLE&&a<fne&&!this._forceTask?(this._forceTask=!0,!1):(a=Math.max(a,l),this._budget.reset(a,this.state),this._updateLoad(),this._schedule())}_runFrame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case Ta.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll(r=>r.idleBegin())),this._runIdle();break;case Ta.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test&&(this._test.usedBudget=this._budget.elapsed)}stopFrame(){this._budget.reset(0,this._state),this._budget.madeProgress()}_removeIdleStateCallbacks(r){this._idleUpdatesStartFired&&r.idleEnd(),this._idleStateCallbacks.removeUnordered(r)}removeTask(r){this._tasks.removeUnordered(r),this._runQueue.removeUnordered(r),this._updatingChanged()}_updateTask(r){this._tasks.forAll(o=>{o.name===r&&o.setPriority(r)})}_getState(r){if(this._runQueue.some(a=>a.name===r))return M0.SCHEDULED;let o=M0.IDLE;return this._tasks.forAll(a=>{a.name===r&&a.needsUpdate&&(a.schedulePriority<=1?o=M0.READY:o!==M0.READY&&(o=M0.WAITING))}),o}_getRuntime(r){let o=0;return this._tasks.forAll(a=>{a.name===r&&(o+=a.runtime)}),o}_resetRuntimes(){this._tasks.forAll(r=>r.runtime=0)}_getRunning(){const r=new Map;if(this._tasks.forAll(a=>{a.needsUpdate&&r.set(a.name,(r.get(a.name)||0)+1)}),r.size===0)return null;let o="";return r.forEach((a,l)=>{o+=a>1?` ${a}x ${l}`:` ${l}`}),o}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const r=this._tasks.reduce((o,a)=>a.needsUpdate?++o:o,0);this._load=this._load*gne+r*(1-gne)}_schedule(){for(this._runQueue.filterInPlace(r=>!!r.needsUpdate||(r.schedulePriority=r.basePriority,!1)),this._tasks.forAll(r=>{r.basePriority===zc&&r.needsUpdate&&!this._runQueue.includes(r)&&r.blockFrame!==this._frameNumber&&this._runQueue.unshift(r)});this._runQueue.length===0;){let r=!1,o=0;if(this._tasks.forAll(a=>{a.needsUpdate&&a.schedulePriority!==0&&a.basePriority!==zc&&a.blockFrame!==this._frameNumber&&(r=!0,o=Math.max(o,a.basePriority),a.schedulePriority===1?(a.schedulePriority=0,this._runQueue.push(a)):--a.schedulePriority)}),!r)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){do for(;this._runQueue.length>0;){const r=this._budget.now(),o=this._runQueue.pop();this._budget.resetProgress();try{o.task.runTask(this._budget)===kve&&(o.blockFrame=this._frameNumber)}catch(l){ht.getLogger("esri.views.support.Scheduler").error(`Exception in task "${o.name}"`,l),o.blockFrame=this._frameNumber}!this._budget.hasProgressed&&o.blockFrame!==this._frameNumber&&o.needsUpdate&&(o.name,ns.I3S_CONTROLLER,o.blockFrame=this._frameNumber),o.schedulePriority=o.basePriority;const a=this._budget.now()-r;if(o.runtime+=a,this._frameTaskTimes.set(o.priority,this._frameTaskTimes.get(o.priority)+a),this._budget.remaining<=0)return void this._updatingChanged()}while(this._schedule());this._updatingChanged()}_startFrameTaskTimes(){for(const r of Object.keys(ns))this._frameTaskTimes.set(ns[r],0)}_recordFrameTaskTimes(r){this._frameTaskTimes.forEach((o,a)=>this.performanceInfo.tasks.get(a).push(o)),this.performanceInfo.total.push(r)}get test(){return this._test}}t.Scheduler=e;class i{get task(){return this._task.value}get updating(){return this._queue.running}constructor(r,o,a){this._scheduler=r,this.name=o,this.blockFrame=0,this.runtime=0,this._queue=new MJe,this._handles=new FS,this._basePriority=pne(o),this.schedulePriority=this._basePriority,this._task=DS(a??this._queue),this._handles.add(nh(()=>this.task.running,l=>r.taskRunningChanged(l)))}remove(){this.processQueue($ve),this._scheduler.removeTask(this),this.schedule=_ne.schedule,this.reschedule=_ne.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(r){if(this.name===r)return;this.name=r;const o=pne(r);this._basePriority!==zc&&this.schedulePriority===0||(this.schedulePriority=o),this._basePriority=o}get priority(){return this.name}set priority(r){this.setPriority(r)}get needsUpdate(){return this.updating||this.task.running}schedule(r,o,a){return this._queue.push(r,o,a)}reschedule(r,o,a){return this._queue.unshift(r,o,a)}processQueue(r){return this._queue.runTask(r)}}class s{constructor(){this._begin=typeof performance<"u"?performance.now():0,this._budget=0,this._state=Ta.IDLE,this._done=!1,this._progressed=!1,this._enabled=!0}run(r){return!this.done&&(r()===!0&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get state(){return this._state}get enabled(){return this._enabled}set enabled(r){this._enabled=r}reset(r,o){this._begin=this.now(),this._budget=r,this._state=o,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}}t.Budget=s})(qL||(qL={})),function(t){t.SCHEDULED="s",t.READY="r",t.WAITING="w",t.IDLE="i"}(M0||(M0={}));const $ve=(()=>{const t=new qL.Budget;return t.enabled=!1,t})();let LJe=class{remove(){}processQueue(){}schedule(e,i,s){try{if(dc(i)){const n=Vn();return s?Promise.resolve(s(n)):Promise.reject(n)}return gz(e($ve))}catch(n){return Promise.reject(n)}}reschedule(e,i,s){return this.schedule(e,i,s)}};const _ne=new LJe;let FJe=class{constructor(e){this.view=e,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this._scheduler=IJe(),this._schedulerHandle=nh(()=>this._scheduler.updating,()=>this.requestFrame()),this.stationary=!0,this.prepare=()=>{var i;this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions,this._updateParameters.targetState.copy(this.view.state),((i=this.view.animation)==null?void 0:i.target)==null||Hm(this.view.animation.target)||(this._updateParameters.targetState.viewpoint=this.view.animation.target))},this.update=i=>{var a,l,u;if(this._updateRequested=!1,(a=this.view)==null?void 0:a.destroyed)return;const{allLayerViews:s,graphicsView:n,labelManager:r,state:{id:o}}=this.view;s==null||s.forEach(this._updateLayerView,this),r!=null&&(r.lastUpdateId!==o&&(r.viewChange(),r.lastUpdateId=o),r.updateRequested&&r.processUpdate(this._updateParameters)),n!=null&&(n.lastUpdateId!==o&&(n.viewChange(),n.lastUpdateId=o),n.updateRequested&&n.processUpdate(this._updateParameters)),(l=this.view.graphicsTileStore)==null||l.setViewState(this._updateParameters.state),this.view.animation?this._scheduler.state=Ta.ANIMATING:this.view.interacting?this._scheduler.state=Ta.INTERACTING:this._scheduler.state=Ta.IDLE,this._scheduler.frame(i)||this._updateRequested||this._scheduler.state!==Ta.IDLE||((u=this._frameTaskHandle)==null||u.pause())}}destroy(){this.stop(),this._schedulerHandle.remove(),this._scheduler.destroy()}get scheduler(){return this._scheduler}start(){if(this._frameTaskHandle)return;const e=this.view;this.stationary=e.stationary,this._updateParameters={state:e.state,targetState:new NY,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:e.renderingOptions},this._stationaryHandle=Ai(()=>e.stationary,i=>{this.stationary=i,this.requestFrame()}),this._frameTaskHandle=Ww(this),this.requestUpdate()}stop(){var e;this._frameTaskHandle&&(this._updateRequested=!1,(e=this._stationaryHandle)==null||e.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(e){var n;if(!e.attached)return void this.requestUpdate();const i=this.view.state,s=e.lastUpdateId;s!=null&&(this.stationary||e.moving)||(e.moving=!0),s!==i.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=i.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&((n=e.layerViews)==null||n.forEach(this._updateLayerView,this))}},x_=class extends JM{constructor(e){super(e),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=mc(),this.addResolvingPromise(this._resolver.promise)}get done(){return this.state==="finished"||this.state==="stopped"}stop(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),(e=this._resolver)==null||e.reject(new Se("ViewAnimation stopped")))}finish(){var e;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),(e=this._resolver)==null||e.resolve())}update(e,i){i||(i=Hm(e)?"waiting-for-target":"running"),this._set("target",e),this._set("state",i)}};y([S({readOnly:!0})],x_.prototype,"done",null),y([S({readOnly:!0,type:String})],x_.prototype,"state",void 0),y([S()],x_.prototype,"target",void 0),x_=y([se("esri.views.ViewAnimation")],x_),function(t){t.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(x_||(x_={}));const yq=x_;let L3=class extends ei{constructor(e){super(e),this._gotoTask=null}destroy(){this._gotoTask=null}async goTo(e,i){if(!e)return void ht.getLogger(this).error("#goTo()","target cannot be null or undefined");const s=new yq;this.view.animation=s,await h7(()=>this.view.ready,i);const n={...i,animate:(i==null?void 0:i.animate)??!H0e(),animationMode:(i==null?void 0:i.animationMode)??"auto"},{extent:r,spatialReference:o,size:a,viewpoint:l,constraints:u,padding:c,allLayerViews:h}=this.view,d=TQe(e,{extent:r,spatialReference:o,size:a,viewpoint:l,constraints:u,padding:c,allLayerViews:h,pickClosestTarget:(i==null?void 0:i.pickClosestTarget)??!0});return s==null||s.update(d),this._gotoTask={},n.animate?this._gotoAnimated(d,n):this._gotoImmediate(d,n)}_gotoImmediate(e,i){const s=this._gotoTask,n=this.view.animation,r=e.then(o=>{if(vr(i),s!==this._gotoTask)throw new Se("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=n.target=o,n.finish()});return this._cancellableGoTo(s,n,r,i)}_gotoAnimated(e,i){const s=this._gotoTask,n=this.view.animation;if(!n)return Promise.resolve();const r=e.then(o=>{if(vr(i),s!==this._gotoTask)throw new Se("view:goto-interrupted","Goto was interrupted");return n.update(o),this.view.animationManager.animate(n,this.view.viewpoint,i),n.when().then(()=>{},()=>{})});return this._cancellableGoTo(s,n,r,i)}_cancellableGoTo(e,i,s,n){const r=()=>e===this._gotoTask;return Aue(s,n).finally(()=>{r()&&(i.done||i.stop())})}};y([S({constructOnly:!0})],L3.prototype,"view",void 0),L3=y([se("esri.views.2d.GoToManager")],L3);function kJe(t,e){const{spatialReference:i}=e,s=[e.x,e.y];let n,r,o,a;const l=[0,0],u=$Je(t);for(let d=0;d<u.length;d++){const m=u[d];for(let f=0;f<m.length-1;f++){TPe(l,s,m,f);const _=K4(s,l);(n==null||_<n)&&(n=_,r=[...l],o=d,a=f)}}if(n==null||!r||o==null||a==null)throw new Se("nearest-coordinate:failed","Failed to find the nearest coordinate");const[c,h]=r;return{coordinate:new ki({x:c,y:h,spatialReference:i}),distance:n}}function $Je(t){switch(t.type){case"extent":return[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]];case"polygon":return t.rings;case"polyline":return t.paths}}var vq;let Iv=vq=class extends ZM.NumericIdentifiableMixin(ei){constructor(t){super(t),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(this.geometry==null||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return jy(this.geometry,this.spatialReference)}catch(t){return ht.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:t}),null}return this.geometry}constrain(t,e){if(this.normalizedGeometry==null)return t;const i=t.targetGeometry;if(this.normalizedGeometry.type==="extent"?GM(this.normalizedGeometry,i):LH(this.normalizedGeometry,i))return t;const{coordinate:s}=kJe(this.normalizedGeometry,i);return s&&(t.targetGeometry=s),t}clone(){var t,e;return new vq({geometry:(t=this.geometry)==null?void 0:t.clone(),spatialReference:(e=this.spatialReference)==null?void 0:e.clone()})}};y([S({constructOnly:!0})],Iv.prototype,"geometry",void 0),y([S({readOnly:!0})],Iv.prototype,"normalizedGeometry",null),y([S({constructOnly:!0})],Iv.prototype,"spatialReference",void 0),Iv=vq=y([se("esri.views.2d.constraints.GeometryConstraint")],Iv);var xq;let pT=xq=class extends ZM.NumericIdentifiableMixin(ei){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(t,e){return this.enabled&&e&&(this.rotationEnabled||(t.rotation=e.rotation)),t}clone(){return new xq({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};y([S()],pT.prototype,"enabled",void 0),y([S()],pT.prototype,"rotationEnabled",void 0),pT=xq=y([se("esri.views.2d.constraints.RotationConstraint")],pT);const Uve=pT;var bq;let iu=bq=class extends ZM.NumericIdentifiableMixin(ei){constructor(t){super(t),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let t,{lods:e,minScale:i,maxScale:s,minZoom:n,maxZoom:r}=this,o=-1,a=-1,l=!1,u=!1;if(i!==0&&s!==0&&i<s&&([i,s]=[s,i]),!(e!=null&&e.length))return this._set("effectiveMinScale",i),void this._set("effectiveMaxScale",s);e=e.map(c=>c.clone()),e.sort((c,h)=>h.scale-c.scale),e.forEach((c,h)=>c.level=h);for(const c of e)!l&&i>0&&i>=c.scale&&(o=c.level,l=!0),!u&&s>0&&s>=c.scale&&(a=t?t.level:-1,u=!0),t=c;n===-1&&(n=i===0?0:o),r===-1&&(r=s===0?e.length-1:a),n=Math.max(n,0),n=Math.min(n,e.length-1),r=Math.max(r,0),r=Math.min(r,e.length-1),n>r&&([n,r]=[r,n]),i=e[n].scale,s=e[r].scale,e.splice(0,n),e.splice(r-n+1,e.length),e.forEach((c,h)=>{this._lodByScale[c.scale]=c,this._scales[h]=c.scale}),this._set("effectiveLODs",e),this._set("effectiveMinZoom",n),this._set("effectiveMaxZoom",r),this._set("effectiveMinScale",i),this._set("effectiveMaxScale",s)}constrain(t,e){if(e&&t.scale===e.scale)return t;const i=this.effectiveMinScale,s=this.effectiveMaxScale,n=t.targetGeometry,r=e&&e.targetGeometry,o=s!==0&&t.scale<s,a=i!==0&&t.scale>i;if(o||a){const l=a?i:s;if(e&&r){const u=(l-e.scale)/(t.scale-e.scale);n.x=r.x+(n.x-r.x)*u,n.y=r.y+(n.y-r.y)*u}t.scale=l}return this.snapToZoom&&this.effectiveLODs&&(t.scale=this._getClosestScale(t.scale)),t}fit(t){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(t,null);const e=this.scaleToZoom(t.scale),i=Math.abs(e-Math.floor(e));return t.scale=this.zoomToScale(i>.99?Math.round(e):Math.floor(e)),t}zoomToScale(t){if(!this.effectiveLODs)return 0;t-=this.effectiveMinZoom,t=Math.max(0,t);const e=this._scales;if(t<=0)return e[0];if(t>=e.length)return e[e.length-1];const i=Math.floor(t),s=Math.ceil(t);return e[i]+(t-i)*(e[s]-e[i])}scaleToZoom(t){if(!this.effectiveLODs)return-1;const e=this._scales;let i,s;if(t>=e[0])return this.effectiveMinZoom;if(t<=e[e.length-1])return this.effectiveMaxZoom;for(let n=0;n<e.length-1;n++){if(i=e[n],s=e[n+1],s===t)return n+this.effectiveMinZoom+1;if(i>t&&s<t)return n+this.effectiveMinZoom+1-(t-s)/(i-s)}return-1}snapToClosestScale(t){if(!this.effectiveLODs)return t;const e=this.scaleToZoom(t);return this.zoomToScale(Math.round(e))}snapToNextScale(t,e=.5){if(!this.effectiveLODs)return t*e;const i=Math.round(this.scaleToZoom(t));return this.zoomToScale(i+1)}snapToPreviousScale(t,e=2){if(!this.effectiveLODs)return t*e;const i=Math.round(this.scaleToZoom(t));return this.zoomToScale(i-1)}clone(){return new bq({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(t){return this._lodByScale[t]||(t=this._scales.reduce((e,i)=>Math.abs(i-t)<=Math.abs(e-t)?i:e,this._scales[0])),this._lodByScale[t].scale}};y([S({readOnly:!0})],iu.prototype,"effectiveLODs",void 0),y([S({readOnly:!0})],iu.prototype,"effectiveMinZoom",void 0),y([S({readOnly:!0})],iu.prototype,"effectiveMaxZoom",void 0),y([S({readOnly:!0})],iu.prototype,"effectiveMinScale",void 0),y([S({readOnly:!0})],iu.prototype,"effectiveMaxScale",void 0),y([S()],iu.prototype,"lods",void 0),y([S()],iu.prototype,"minZoom",void 0),y([S()],iu.prototype,"maxZoom",void 0),y([S()],iu.prototype,"minScale",void 0),y([S()],iu.prototype,"maxScale",void 0),y([S()],iu.prototype,"snapToZoom",void 0),iu=bq=y([se("esri.views.2d.constraints.ZoomConstraint")],iu);const Vve=iu,UJe={base:null,key:"type",typeMap:{extent:Nn,polygon:Na}};let Fr=class extends ei{constructor(e){super(e),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new Nt}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(e){e?this._set("geometry",e):this._set("geometry",null)}get version(){var e,i,s;return`${(e=this._zoom)==null?void 0:e.uid}/${(i=this._rotation)==null?void 0:i.uid}/${(s=this._geometry)==null?void 0:s.uid}`}get _geometry(){var i,s;const e=this._get("_geometry");return e&&this.geometry===e.geometry&&((i=this.view)==null?void 0:i.constraintsInfo.spatialReference)===e.spatialReference?e:new Iv({geometry:this.geometry,spatialReference:(s=this.view)==null?void 0:s.constraintsInfo.spatialReference})}get _rotation(){return new Uve({rotationEnabled:this.rotationEnabled})}get _zoom(){var l;const e=this._get("_zoom"),i=this.lods||((l=this.view)==null?void 0:l.constraintsInfo.lods),s=this.minZoom,n=this.maxZoom,r=this.minScale,o=this.maxScale,a=this.snapToZoom;return e&&e.lods===i&&e.minZoom===s&&e.maxZoom===n&&e.minScale===r&&e.maxScale===o&&e.snapToZoom===a?e:new Vve({lods:i,minZoom:s,maxZoom:n,minScale:r,maxScale:o,snapToZoom:a})}canZoomInTo(e){const i=this.effectiveMaxScale;return i===0||e>=i}canZoomOutTo(e){const i=this.effectiveMinScale;return i===0||e<=i}constrain(e,i){return this._zoom.constrain(e,i),this._rotation.constrain(e,i),this._geometry.constrain(e,i),this.customConstraints.forEach(s=>s.constrain(e,i)),e}constrainByGeometry(e){return this._geometry.constrain(e),this.customConstraints.forEach(i=>{var s;return(s=i.applyPanConstraint)==null?void 0:s.call(i,e)}),e}fit(e){return this._zoom.fit(e)}zoomToScale(e){return this._zoom.zoomToScale(e)}scaleToZoom(e){return this._zoom.scaleToZoom(e)}snapScale(e){return this._zoom.snapToClosestScale(e)}snapToNextScale(e){return this._zoom.snapToNextScale(e)}snapToPreviousScale(e){return this._zoom.snapToPreviousScale(e)}};y([S({readOnly:!0})],Fr.prototype,"effectiveLODs",null),y([S({readOnly:!0})],Fr.prototype,"effectiveMinScale",null),y([S({readOnly:!0})],Fr.prototype,"effectiveMaxScale",null),y([S({readOnly:!0})],Fr.prototype,"effectiveMinZoom",null),y([S({readOnly:!0})],Fr.prototype,"effectiveMaxZoom",null),y([S({types:UJe,value:null})],Fr.prototype,"geometry",null),y([S({type:[F_]})],Fr.prototype,"lods",void 0),y([S()],Fr.prototype,"minScale",void 0),y([S()],Fr.prototype,"maxScale",void 0),y([S()],Fr.prototype,"minZoom",void 0),y([S()],Fr.prototype,"maxZoom",void 0),y([S()],Fr.prototype,"rotationEnabled",void 0),y([S()],Fr.prototype,"snapToZoom",void 0),y([S({type:Nt})],Fr.prototype,"customConstraints",void 0),y([S()],Fr.prototype,"view",void 0),y([S({readOnly:!0})],Fr.prototype,"version",null),y([S({type:Iv,readOnly:!0})],Fr.prototype,"_geometry",null),y([S({type:Uve})],Fr.prototype,"_rotation",null),y([S({readOnly:!0,type:Vve})],Fr.prototype,"_zoom",null),Fr=y([se("esri.views.2d.MapViewConstraints")],Fr);const yne=Fr;let Wa=class extends ei{constructor(e){super(e),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([Ai(()=>{var i;return(i=this.constraints)==null?void 0:i.version},i=>{this.constraints&&i&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))},km)])}get center(){if(!this.ready)return this._get("center");const{center:e,spatialReference:i}=this.state.paddedViewState;return this.state.commitProperty("id"),new ki({x:e[0],y:e[1],spatialReference:i})}set center(e){if(e==null)return;if(!this.ready)return void this._set("center",e);let i;try{i=this._project(e,this.state.spatialReference)}catch(n){return void ht.getLogger(this).error(new Se("mapview:invalid-center","could not project the value in the view's spatial reference",{input:e,error:n}))}const s=this.viewpoint;mq(s,s,i),this.viewpoint=s}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(e){if(e==null)return;if(!e.width||!e.height)return void ht.getLogger(this).error(new Se("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",e),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let i;try{i=this._project(e,this.state.spatialReference)}catch(n){return void ht.getLogger(this).error(new Se("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:n}))}const s=this.viewpoint;AQe(s,s,i,this.state.size,{constraints:this.constraints}),this.viewpoint=s}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(e){this.ready?(this.state.padding=e,this._set("padding",this.state.padding)):this._set("padding",e)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(e){if(isNaN(e))return;if(!this.ready)return void this._set("rotation",e);const i=this.viewpoint;UQe(i,i,e),this.viewpoint=i}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(e){if(!e||isNaN(e))return;if(!this.ready){this._set("scale",e),this._set("zoom",void 0);const s=this._get("extent");return void(s&&(this._set("extent",void 0),this._set("center",s.center)))}const i=this.viewpoint;cne(i,i,e),this.viewpoint=i}get viewpoint(){return this.ready?this.state.paddedViewState.viewpoint.clone():this._get("viewpoint")}set viewpoint(e){var r;if(e==null)return;if(!this.ready)return this._set("viewpoint",e),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let i,s;try{i=this._project(e,this.state.spatialReference),!e.scale||isNaN(e.scale)?s=new Se("mapview:invalid-viewpoint",`invalid scale value of ${e.scale}`):e.targetGeometry==null&&(s=new Se("mapview:invalid-viewpoint","geometry not defined"))}catch(o){s=new Se("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:o})}if(s)return void ht.getLogger(this).error(s);this._scaleBeforeChangingSpatialReference=null;const n=new th({targetGeometry:new ki,scale:0,rotation:0});sl(n,i),(r=this.constraints)==null||r.constrain(n,this.state.paddedViewState.viewpoint),this.state.viewpoint=n,this._set("viewpoint",n)}get visibleArea(){return this.ready?this.state.visibleArea:null}get zoom(){var e;return this.ready?((e=this.constraints)==null?void 0:e.scaleToZoom(this.scale))??-1:this._get("zoom")}set zoom(e){var n,r;if(!(e>=0))return;if(!this.ready){this._set("zoom",e),this._set("scale",void 0);const o=this._get("extent");return void(o&&(this._set("extent",void 0),this._set("center",o.center)))}const i=((n=this.constraints)==null?void 0:n.zoomToScale(e))??0;if(!i)return void this._set("zoom",-1);const s=this.viewpoint;cne(s,s,i),this.viewpoint=s,this._set("zoom",((r=this.constraints)==null?void 0:r.scaleToZoom(this.scale))??-1)}getUserStartupOptions(e){if(!e[0]&&!e[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:i,constraints:s}=this,n=this._get("center"),r=this._get("extent"),o=this._get("scale"),a=this._get("rotation"),l=this._get("viewpoint"),u=this._get("zoom"),c=u!=null&&s!=null&&s.zoomToScale(u)||void 0;let h,d,m;const f=l==null?void 0:l.rotation,_=l==null?void 0:l.targetGeometry;(_==null?void 0:_.type)==="extent"?h=_:(_==null?void 0:_.type)==="point"&&(d=_,m=l==null?void 0:l.scale);const v=r??h;return{center:n??d??(v==null?void 0:v.center),rotation:a??f,scale:(o??c??m??(v&&J4(v,[e[0]-i.left-i.right,e[1]-i.top-i.bottom])))||void 0}}startup(e,i,s,n){var o;const r=e.targetGeometry;try{this._project(e,s)}catch(a){ht.getLogger(this).warn(new ih("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:r.toJSON(),spatialReference:s,error:a})),e.targetGeometry=n||new ki({x:0,y:0,spatialReference:s})}(o=this.constraints)==null||o.fit(e),this._set("state",new NY({padding:this.padding,size:i,viewpoint:e})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[e,i],spatialReference:s,rotation:n,scale:r}=this.state.paddedViewState,o=new ki({x:e,y:i,spatialReference:s});this._set("viewpoint",null),this._set("extent",null),this._set("center",o),this._set("zoom",-1),this._set("rotation",n),this._set("scale",r),this._set("state",null)}changeSpatialReference(e){var l;const i=this.state.paddedViewState.clone();if(this._scaleBeforeChangingSpatialReference==null)this._scaleBeforeChangingSpatialReference=i.scale;else{const u=i.viewpoint.clone();u.scale=this._scaleBeforeChangingSpatialReference,i.viewpoint=u}const s=i.clone(),[n,r]=i.center;let o=null;try{o=this._project(new ki({x:n,y:r,spatialReference:i.spatialReference}),e)}catch(u){PF()||ht.getLogger(this).warn(new ih("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:o==null?void 0:o.toJSON(),spatialReference:e,error:u}))}o||(o=new ki({x:0,y:0,spatialReference:e}));const a=mq(new th({targetGeometry:new ki,scale:0,rotation:0}),i.viewpoint,o);s.viewpoint=a;try{const c=[i.size[0]/2,i.size[1]/2],h=[c[0]+20,c[1]],d=i.toMap([0,0],h),{x:m,y:f}=this._project(new ki({x:d[0],y:d[1],spatialReference:i.spatialReference}),e);d[0]=m,d[1]=f,s.toScreen(d,d);const _=FQe(c,d,h),v=Math.hypot(d[0]-c[0],d[1]-c[1])/20;!Number.isFinite(v)||Math.abs(v)>4?(a.rotation=0,a.targetGeometry=new ki({x:0,y:0,spatialReference:e})):(a.scale*=v,a.scale>ke("mapview-srswitch-adjust-rotation-scale-threshold")?a.rotation=0:a.rotation+=Number.isFinite(_)?_:0)}catch{}(l=this._get("constraints"))==null||l.constrain(a,void 0),this._get("state").viewpoint=a}resize(e,i){var o;if(!this.ready)return;const s=this.state;let n=this.state.paddedViewState.viewpoint;const r=this.state.paddedViewState.size.slice();s.size=[e,i],$Qe(n,n,r,this.state.paddedViewState.size,this.resizeAlign),n=((o=this.constraints)==null?void 0:o.constrain(n,void 0))??n,this.state.viewpoint=n}toMap(e){if(!this.ready)return null;const i=[0,0],[s,n]=this.state.toMap(i,[e.x,e.y]),r=this.state.spatialReference;return new ki({x:s,y:n,spatialReference:r})}toScreen(e,i){if(!this.ready)return null;const s=this._project(e,this.state.spatialReference),n=[s.x,s.y];return(i==null?void 0:i.pickClosestTarget)===!1||this.state.paddedViewState.wrapMapCoordinate(n,n),this.state.toScreen(n,n),oa(n[0],n[1])}_project(e,i){var r;const s=(e==null?void 0:e.targetGeometry)||e;if(!i)return e;if(!s)return null;if(i.imageCoordinateSystem||(r=s.spatialReference)!=null&&r.imageCoordinateSystem||$o(i,s.spatialReference))return e;const n=jy(s,i);if(!n)throw new Se("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:s,spatialReference:i});return VJe(e)?(e.targetGeometry=n,e):n}};function VJe(t){return(t==null?void 0:t.declaredClass)==="esri.Viewpoint"}y([S({type:ki})],Wa.prototype,"center",null),y([S()],Wa.prototype,"constraints",void 0),y([S({type:Nn})],Wa.prototype,"extent",null),y([S({value:{top:0,right:0,bottom:0,left:0},cast:t=>({top:0,right:0,bottom:0,left:0,...t})})],Wa.prototype,"padding",null),y([S()],Wa.prototype,"ready",void 0),y([S()],Wa.prototype,"resizeAlign",void 0),y([S({readOnly:!0})],Wa.prototype,"resolution",null),y([S({type:Number})],Wa.prototype,"rotation",null),y([S({type:Number})],Wa.prototype,"scale",null),y([S({readOnly:!0})],Wa.prototype,"state",void 0),y([S({type:th})],Wa.prototype,"viewpoint",null),y([S({readOnly:!0})],Wa.prototype,"visibleArea",null),y([S()],Wa.prototype,"zoom",null),Wa=y([se("esri.views.2d.ViewStateManager")],Wa);function zve(t,e){switch(e){case"primary":return t.pointerType==="touch"||t.button===0;case"secondary":return t.pointerType!=="touch"&&t.button===2;case"tertiary":return t.pointerType!=="touch"&&t.button===1}}function Gve(t,e){return e.some(i=>zve(t,i))}function vne(t,{dragPrimary:e,dragSecondary:i,dragTertiary:s}){return[{key:"primary",value:e},{key:"secondary",value:i},{key:"tertiary",value:s}].filter(n=>n.value===t).map(n=>n.key)}let xne=class extends zo{constructor(e,i){super(!0),this._view=e,this.registerIncoming("double-click",i,s=>this._handleDoubleClick(s,i))}_handleDoubleClick(e,i){zve(e.data,"primary")&&(e.stopPropagation(),i?this._view.mapViewNavigation.zoomOut([e.data.x,e.data.y]):this._view.mapViewNavigation.zoomIn([e.data.x,e.data.y]))}},zJe=class extends zo{constructor(e,i,s){super(!0),this.view=e,this.pointerType=i,this.registerIncoming("double-tap-drag",s,n=>this._handleDoubleTapDrag(n))}_handleDoubleTapDrag(e){const{data:i}=e,{pointerType:s}=i;if(s!==this.pointerType)return;e.stopPropagation();const{action:n,delta:r}=i,{view:o}=this,{mapViewNavigation:a}=o;switch(n){case"begin":{const{scale:l}=o;this._startScale=l,this._currentScale=l,this._previousDelta=r,a.begin();break}case"update":{if(this._previousDelta.y===r.y)return;this._previousDelta=r;const l=1.015**r.y,u=this._startScale*l,c=u/this._currentScale;a.setViewpointImmediate(c),this._currentScale=u;break}case"end":{const{constraints:l}=o,{effectiveLODs:u,snapToZoom:c}=l;if(!c||!u)return void a.end();const h=l.snapScale(this._currentScale),d=(r.y>0?Math.max(h,l.snapToPreviousScale(this._startScale)):Math.min(h,l.snapToNextScale(this._startScale)))/this._currentScale;a.zoom(d).then(()=>{a.end()});break}}}},tk=class{constructor(e){this._callbacks=e,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(e){const i=e.data,s=i.pointers.size;switch(i.action){case"start":this._currentCount=s,this._emitStart(e);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=s,this._emitStart(e);break;case"update":this._emitUpdate(e);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=s,this._emitStart(e);break;case"end":this._emitEnd(e),this._currentCount=0}this._previousEvent=e}_emitStart(e){var i,s;this._startEvent=e,(s=(i=this._callbacks).condition)!=null&&s.call(i,this._currentCount,e)&&this._callbacks.start(this._currentCount,e,this._startEvent)}_emitUpdate(e){var i,s;(s=(i=this._callbacks).condition)!=null&&s.call(i,this._currentCount,e)&&this._callbacks.update(this._currentCount,e,this._startEvent)}_emitEnd(e){var i,s;(s=(i=this._callbacks).condition)!=null&&s.call(i,this._currentCount,e)&&this._callbacks.end(this._currentCount,e,this._startEvent),this._startEvent=null}},GJe=class extends zo{constructor(e,i,s){super(!0),this.view=e,this.pointerActions=i,this.registerIncoming("drag",s,n=>this._handleDrag(n)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(e){super.onInstall(e),this._dragEventSeparator=new tk({start:(i,s)=>{this.view.mapViewNavigation.pan.begin(this.view,s.data),s.stopPropagation()},update:(i,s)=>{this.view.mapViewNavigation.pan.update(this.view,s.data),s.stopPropagation()},end:(i,s)=>{this.view.mapViewNavigation.pan.end(this.view,s.data),s.stopPropagation()},condition:(i,s)=>i===1&&Gve(s.data,this.pointerActions)})}_handleDrag(e){const i=this.view.mapViewNavigation;i.pinch.zoomMomentum||i.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(e)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},BJe=class extends zo{constructor(e,i,s){super(!0),this._view=e,this.pointerActions=i;const n=this._view.mapViewNavigation;this._dragEventSeparator=new tk({start:(r,o)=>{n.rotate.begin(this._view,o.data),o.stopPropagation()},update:(r,o)=>{n.rotate.update(this._view,o.data),o.stopPropagation()},end:(r,o)=>{n.rotate.end(),o.stopPropagation()},condition:(r,o)=>r===1&&Gve(o.data,this.pointerActions)}),this.registerIncoming("drag",s,r=>this._dragEventSeparator.handle(r))}};function Bve(t){const e=t[0],i=t[1],s=t[2];return Math.sqrt(e*e+i*i+s*s)}function qJe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function HJe(t,e,i,s){return t[0]=e,t[1]=i,t[2]=s,t}function jJe(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}function qve(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function Hve(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t}function jve(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t}function YJe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function XJe(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function WJe(t,e){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t}function ZJe(t,e){return t[0]=Math.sign(e[0]),t[1]=Math.sign(e[1]),t[2]=Math.sign(e[2]),t}function KJe(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t}function QJe(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t}function JJe(t,e=0,i=1){return t[0]=Math.min(Math.max(t[0],e),i),t[1]=Math.min(Math.max(t[1],e),i),t[2]=Math.min(Math.max(t[2],e),i),t}function eet(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function Yve(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function tet(t,e,i,s){return t[0]=e[0]+i[0]*s,t[1]=e[1]+i[1]*s,t[2]=e[2]+i[2]*s,t}function Xve(t,e){const i=e[0]-t[0],s=e[1]-t[1],n=e[2]-t[2];return Math.sqrt(i*i+s*s+n*n)}function Wve(t,e){const i=e[0]-t[0],s=e[1]-t[1],n=e[2]-t[2];return i*i+s*s+n*n}function Zve(t){const e=t[0],i=t[1],s=t[2];return e*e+i*i+s*s}function iet(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function set(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function wq(t,e){const i=e[0],s=e[1],n=e[2];let r=i*i+s*s+n*n;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r),t}function Kve(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function net(t,e,i){const s=e[0],n=e[1],r=e[2],o=i[0],a=i[1],l=i[2];return t[0]=n*l-r*a,t[1]=r*o-s*l,t[2]=s*a-n*o,t}function ret(t,e,i){const s=e[0],n=e[1],r=e[2],o=i[0],a=i[1],l=i[2],u=n*l-r*a,c=r*o-s*l,h=s*a-n*o,d=Math.sqrt(u*u+c*c+h*h);return t[0]=u/d,t[1]=c/d,t[2]=h/d,t}function oet(t,e,i,s){const n=e[0],r=e[1],o=e[2];return t[0]=n+s*(i[0]-n),t[1]=r+s*(i[1]-r),t[2]=o+s*(i[2]-o),t}function aet(t,e,i,s,n,r){const o=r*r,a=o*(2*r-3)+1,l=o*(r-2)+r,u=o*(r-1),c=o*(3-2*r);return t[0]=e[0]*a+i[0]*l+s[0]*u+n[0]*c,t[1]=e[1]*a+i[1]*l+s[1]*u+n[1]*c,t[2]=e[2]*a+i[2]*l+s[2]*u+n[2]*c,t}function uet(t,e,i,s,n,r){const o=1-r,a=o*o,l=r*r,u=a*o,c=3*r*a,h=3*l*o,d=l*r;return t[0]=e[0]*u+i[0]*c+s[0]*h+n[0]*d,t[1]=e[1]*u+i[1]*c+s[1]*h+n[1]*d,t[2]=e[2]*u+i[2]*c+s[2]*h+n[2]*d,t}function cet(t,e=1){const i=D4,s=2*i()*Math.PI,n=2*i()-1,r=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(s)*r,t[1]=Math.sin(s)*r,t[2]=n*e,t}function het(t,e,i){const s=e[0],n=e[1],r=e[2];return t[0]=i[0]*s+i[4]*n+i[8]*r+i[12],t[1]=i[1]*s+i[5]*n+i[9]*r+i[13],t[2]=i[2]*s+i[6]*n+i[10]*r+i[14],t}function det(t,e,i){const s=e[0],n=e[1],r=e[2];return t[0]=s*i[0]+n*i[3]+r*i[6],t[1]=s*i[1]+n*i[4]+r*i[7],t[2]=s*i[2]+n*i[5]+r*i[8],t}function met(t,e,i){const s=i[0],n=i[1],r=i[2],o=i[3],a=e[0],l=e[1],u=e[2],c=n*u-r*l,h=r*a-s*u,d=s*l-n*a,m=n*d-r*h,f=r*c-s*d,_=s*h-n*c,v=2*o;return t[0]=a+c*v+2*m,t[1]=l+h*v+2*f,t[2]=u+d*v+2*_,t}function pet(t,e,i,s){const n=[],r=[];return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],r[0]=n[0],r[1]=n[1]*Math.cos(s)-n[2]*Math.sin(s),r[2]=n[1]*Math.sin(s)+n[2]*Math.cos(s),t[0]=r[0]+i[0],t[1]=r[1]+i[1],t[2]=r[2]+i[2],t}function fet(t,e,i,s){const n=[],r=[];return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],r[0]=n[2]*Math.sin(s)+n[0]*Math.cos(s),r[1]=n[1],r[2]=n[2]*Math.cos(s)-n[0]*Math.sin(s),t[0]=r[0]+i[0],t[1]=r[1]+i[1],t[2]=r[2]+i[2],t}function get(t,e,i,s){const n=[],r=[];return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],r[0]=n[0]*Math.cos(s)-n[1]*Math.sin(s),r[1]=n[0]*Math.sin(s)+n[1]*Math.cos(s),r[2]=n[2],t[0]=r[0]+i[0],t[1]=r[1]+i[1],t[2]=r[2]+i[2],t}function _et(t,e){wq(bne,t),wq(wne,e);const i=Kve(bne,wne);return i>1?0:i<-1?Math.PI:Math.acos(i)}const bne=Fy(),wne=Fy();function yet(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function vet(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function xet(t,e){if(t===e)return!0;const i=t[0],s=t[1],n=t[2],r=e[0],o=e[1],a=e[2],l=kl();return Math.abs(i-r)<=l*Math.max(1,Math.abs(i),Math.abs(r))&&Math.abs(s-o)<=l*Math.max(1,Math.abs(s),Math.abs(o))&&Math.abs(n-a)<=l*Math.max(1,Math.abs(n),Math.abs(a))}function bet(t,e,i){const s=i[0]-e[0],n=i[1]-e[1],r=i[2]-e[2];let o=s*s+n*n+r*r;return o>0?(o=1/Math.sqrt(o),t[0]=s*o,t[1]=n*o,t[2]=r*o,t):(t[0]=0,t[1]=0,t[2]=0,t)}const wet=qve,Eet=Hve,Cet=jve,Tet=Xve,Pet=Wve,Met=Bve,Aet=Zve;Object.freeze(Object.defineProperty({__proto__:null,abs:WJe,add:jJe,angle:_et,bezier:uet,ceil:YJe,clamp:JJe,copy:qJe,cross:net,crossAndNormalize:ret,direction:bet,dist:Tet,distance:Xve,div:Cet,divide:jve,dot:Kve,equals:xet,exactEquals:vet,floor:XJe,hermite:aet,inverse:set,len:Met,length:Bve,lerp:oet,max:QJe,min:KJe,mul:Eet,multiply:Hve,negate:iet,normalize:wq,random:cet,rotateX:pet,rotateY:fet,rotateZ:get,round:eet,scale:Yve,scaleAndAdd:tet,set:HJe,sign:ZJe,sqrDist:Pet,sqrLen:Aet,squaredDistance:Wve,squaredLength:Zve,str:yet,sub:wet,subtract:qve,transformMat3:det,transformMat4:het,transformQuat:met},Symbol.toStringTag,{value:"Module"}));function Rh(t){let e=t*t;return t<0&&(e*=-1),e}function Iet(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function Det(t,e,i){const s=i,n=t.state,r=t.device,o=e.tiltDirection==="forward-down"?1:-1,a=1;return r.deviceType==="standard"?(s.translation[0]=Rh(n.axes[0]),s.translation[1]=Rh(n.axes[1]),s.translation[2]=Rh(n.buttons[7])-Rh(n.buttons[6]),s.heading=Rh(n.axes[2]),s.tilt=Rh(n.axes[3])):r.deviceType==="spacemouse"&&(s.translation[0]=1.2*Rh(n.axes[0]),s.translation[1]=1.2*Rh(n.axes[1]),s.translation[2]=2*-Rh(n.axes[2]),s.heading=1.2*Rh(n.axes[5]),s.tilt=1.2*Rh(n.axes[3])),s.tilt*=o,Yve(s.translation,s.translation,a),s}function Net(t){return t.translation[0]===0&&t.translation[1]===0&&t.translation[2]===0&&t.heading===0&&t.tilt===0&&t.zoom===0}let Ret=class extends zo{constructor(e){super(!0),this._view=e,this._frameTask=null,this._watchHandles=new FS,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",i=>this._handleGamePadEvent(i)),this._handle.pause()}onInstall(e){super.onInstall(e),this._watchHandles.add([Ai(()=>{var i;return(i=this._view.navigation.gamepad)==null?void 0:i.enabled},i=>{i?(this._handle.resume(),this._frameTask||(this._frameTask=Ww({update:s=>this._frameUpdate(s.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},nl)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(e){var s;const i=this._view.navigation.gamepad.device;i&&e.data.device!==i||this._currentDevice&&this._currentDevice!==e.data.device||(e.data.action==="end"?(this._currentDevice=null,Iet(this._transformation)):(this._currentDevice=e.data.device,Det(e.data,this._view.navigation.gamepad,this._transformation)),(s=this._frameTask)==null||s.resume())}_frameUpdate(e){var h;const i=this._transformation;if(Net(i))return void((h=this._frameTask)==null?void 0:h.pause());const s=this._view.viewpoint.clone(),n=this._view.navigation.gamepad.velocityFactor,r=Let*n*e;ek(s,s,[i.translation[0]*r,-i.translation[1]*r]);const o=1+i.translation[2]*Fet*e,a=this._view.constraints.rotationEnabled?-i.heading*Oet*e:0,l=this._view.size,u=[l[0]/2,l[1]];Sve(s,s,o,a,u,l);const c=this._view.constraints.constrain(s,this._view.viewpoint);this._view.viewpoint=c}};const Oet=.06,Let=.7,Fet=6e-4;function Qve(t){const e=()=>t(document.visibilityState==="visible");return document.addEventListener("visibilitychange",e),Gs(()=>document.removeEventListener("visibilitychange",e))}let ket=class extends zo{constructor(e,i,s){super(!0),this.view=e,this.keys=i,this._isSticky=!1,this._pressedKeys=new Set,this._timeout=void 0,this._currentDirection=void 0,this._stickyKeyDuration=200,this._handleKey=n=>{const r=this._keyMap[n.data.key];if(n.modifiers.has("Meta")||n.modifiers.has("Control"))return void this._stopMovement();if(r==null)return;n.stopPropagation(),n.preventDefault();const o=n.type==="key-down";if(this._pressedKeys[o?"add":"delete"](r),o){if(this._direction===r)return;this._direction=r,this._isSticky=!1,this._setTimeout(()=>{this._isSticky&&this._handlePopKey()})}else{const a=this._timeout===void 0,l=this._pressedKeys.size>0;a||l?this._handlePopKey():this._isSticky=!0}},this._handlePopKey=()=>{this._direction=Array.from(this._pressedKeys).pop(),this._direction==null&&this._stopMovement()},this._stopMovement=()=>{this._isSticky=!1,this._direction=void 0,this._pressedKeys.clear(),this._setTimeout(void 0)},this._keyMap={[i.left]:"left",[i.right]:"right",[i.up]:"up",[i.down]:"down"},this.registerIncoming("key-down",s,this._handleKey),this.registerIncoming("key-up",s,this._handleKey),this.registerIncoming("blur",s,this._stopMovement),this._visibilityHandle=Qve(n=>n?null:this._stopMovement())}onUninstall(){var e;this._stopMovement(),(e=this._visibilityHandle)==null||e.remove()}get _direction(){return this._currentDirection}set _direction(e){const i=this._currentDirection!=null;if(e!=null){if(i||this.view.mapViewNavigation.begin(),this._currentDirection!==e)switch(e){case"left":this.view.mapViewNavigation.continuousPanLeft();break;case"right":this.view.mapViewNavigation.continuousPanRight();break;case"up":this.view.mapViewNavigation.continuousPanUp();break;case"down":this.view.mapViewNavigation.continuousPanDown()}}else i&&this.view.mapViewNavigation.stop();this._currentDirection=e}_setTimeout(e){clearTimeout(this._timeout),this._timeout=e===void 0?void 0:setTimeout(()=>{this._timeout=void 0,e()},this._stickyKeyDuration)}},$et=class extends zo{constructor(e,i,s){super(!0),this.view=e,this.keys=i,this._keyToDirection=new Map,this._pressed=!1,this._addKeysMapping(i),this.registerIncoming("key-down",s,n=>this._handleKeyDown(n)),this.registerIncoming("key-up",s,n=>this._handleKeyUp(n)),this.registerIncoming("blur",s,()=>this._handleStop()),this._visibilityHandle=Qve(n=>n?null:this._handleStop())}onUninstall(){var e;(e=this._visibilityHandle)==null||e.remove(),this._handleStop()}_addKeysMapping(e){this._addKeyMapping(e.clockwise,"clockwise"),this._addKeyMapping(e.counterClockwise,"counterClockwise"),this._addKeyMapping(e.reset,"reset")}_addKeyMapping(e,i){for(const s of e)this._keyToDirection.set(s,i)}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0)}_handleKeyUp(e){this._handleKey(e,!1)}_handleStop(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(e,i){const s=e.modifiers;if(s.size>0&&!s.has("Shift")||!this.view.constraints.rotationEnabled)return;const n=this._keyToDirection.get(e.data.key);if(this._pressed=n!=null,this._pressed){if(e.preventDefault(),i)switch(this.view.mapViewNavigation.begin(),n){case"clockwise":this.view.mapViewNavigation.continuousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continuousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation()}}};var gw;(function(t){t[t.IN=0]="IN",t[t.OUT=1]="OUT"})(gw||(gw={}));let Uet=class extends zo{constructor(e,i,s){super(!0),this.view=e,this.keys=i,this._keysToZoomAction={},this.registerIncoming("key-down",s,n=>this._handleKeyDown(n)),i.zoomIn.forEach(n=>this._keysToZoomAction[n]=gw.IN),i.zoomOut.forEach(n=>this._keysToZoomAction[n]=gw.OUT)}_handleKeyDown(e){this._handleKey(e)}_handleKey(e){const i=e.modifiers;if(i.size>0&&!i.has("Shift"))return;const{key:s}=e.data;if(!(s in this._keysToZoomAction))return;const n=this._keysToZoomAction[s],{mapViewNavigation:r}=this.view;let o=null;switch(n){case gw.IN:o=r.zoomIn();break;case gw.OUT:o=r.zoomOut();break;default:return}r.begin(),o.then(()=>r.end()),e.stopPropagation()}};const Vet=.6;let zet=class extends zo{constructor(e,i){super(!0),this._view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",i,s=>this._handleMouseWheel(s))}_handleMouseWheel(e){if(this._view.navigation.actionMap.mouseWheel!=="zoom"||(e.preventDefault(),e.stopPropagation(),!this._canZoom))return;const i=this._view.mapViewNavigation,{x:s,y:n,deltaY:r}=e.data,o=1/Vet**(1/60*r),a=i.zoom(o,[s,n]);a&&(this._canZoom=!1,a.catch(()=>{}).then(()=>{this._canZoom=!0,i.end()}))}},Get=class extends zo{constructor(e){super(!0),this.view=e,this.registerIncoming("drag",s=>this._handleDrag(s)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const i=this.view.mapViewNavigation;this._dragEventSeparator=new tk({start:(s,n)=>{i.pinch.begin(this.view,n.data),n.stopPropagation()},update:(s,n)=>{i.pinch.update(this.view,n.data),n.stopPropagation()},end:(s,n)=>{i.pinch.end(this.view),n.stopPropagation()},condition:s=>s>=2})}_handleDrag(e){this._dragEventSeparator.handle(e)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function Sne(t){const e=t.native;return e?{buttons:e.buttons.map(i=>i.pressed?i.value||1:0),axes:e.axes.map(i=>Het(i,t.axisThreshold))}:{buttons:[],axes:[]}}function Bet(t,e){if(t.axes.length!==e.axes.length||t.buttons.length!==e.buttons.length)return!1;for(let i=0;i<t.axes.length;i++)if(t.axes[i]!==e.axes[i])return!1;for(let i=0;i<t.buttons.length;i++)if(t.buttons[i]!==e.buttons[i])return!1;return!0}function qet(t){for(let e=0;e<t.axes.length;e++)if(t.axes[e]!==0)return!1;for(let e=0;e<t.buttons.length;e++)if(t.buttons[e]!==0)return!1;return!0}function Het(t,e){const i=Math.abs(t);return i<e?0:Math.sign(t)*(i-e)/(1-e)}let jet=class{constructor(e,i){this._element=e,this._input=i,this._hasEventListeners=!1,this._onConnectGamepad=r=>{this._connectGamepad(r.gamepad)},this._onDisconnectGamepad=r=>{const o=r.gamepad,a=o.index,l=this._inputDevices[a];l&&(this._emitGamepadEvent(o,Sne(l),!1),this._inputDevices.splice(a,1),this._latestUpdate.splice(a,1),this._input.gamepad.devices.remove(l),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const s="getGamepads"in window.navigator,n=window.isSecureContext;this.supported=s&&n,this.supported&&(Ene(r=>this._connectGamepad(r)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this._callback=e}_connectGamepad(e){const i=new xY(e);i.deviceType!=="unknown"&&(this._inputDevices[e.index]=i,this._input.gamepad.devices.add(i)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=Ww({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const e=document.hasFocus(),i=this._element.contains(document.activeElement),s=this._input.gamepad.enabledFocusMode==="document"&&!e||this._input.gamepad.enabledFocusMode==="view"&&!i;Ene(n=>{const r=this._inputDevices[n.index];if(!r)return;const o=this._latestUpdate[n.index],a=Sne(r),l=s||qet(a);o&&(o.timestamp===n.timestamp||!o.active&&l||Bet(o.state,a))||this._emitGamepadEvent(n,a,!l)})}_emitGamepadEvent(e,i,s){const n=this._latestUpdate[e.index],r=n&&n.active;if(!r&&!s)return;const o=!r&&s?"start":r&&s?"update":"end";this._latestUpdate[e.index]={timestamp:e.timestamp,state:i,active:s},this._callback&&this._callback({device:this._inputDevices[e.index],state:i,action:o})}};function Yet(t){if(!t||!t.connected)return!1;for(let e=0;e<t.axes.length;e++)if(isNaN(t.axes[e]))return!1;return!0}function Ene(t){for(const e of navigator.getGamepads())Yet(e)&&t(e)}const Cne=ke("edge"),Xet=ke("chrome"),Wet=ke("ff"),Zet=ke("safari"),Tne="esri-view-surface",ab={touchNone:`${Tne}--touch-none`,touchPan:`${Tne}--touch-pan`};let Jve=class e1e{constructor(e,i){this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new jet(e,i),this._gamepadSource.onEvent=s=>this._callback("gamepad",s)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach(e=>this._releasePointerCaptureSafe(e)),this._activePointerCaptures.clear(),this._gamepadSource=er(this._gamepadSource),this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(e){this._callback=e}set activeEvents(e){for(const i in this._active)if(!e||!e.has(i)){const s=this._active[i];this._element.removeEventListener(cV[i],s),delete this._active[i]}e&&e.forEach(i=>{if(!this._active[i]&&cV[i]){const s=(this._eventHandlers[i]||this._handleDefault).bind(this,i);this._element.addEventListener(cV[i],s),this._active[i]=s}}),this._gamepadSource&&(this._gamepadSource.hasEventListeners=(e==null?void 0:e.has("gamepad"))??!1)}setPointerCapture(e,i){i?this._setPointerCaptureSafe(e.pointerId):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?ab.touchNone:ab.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?ab.touchPan:ab.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(ab.touchNone),this._element.classList.remove(ab.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCaptureSafe(e){try{this._element.setPointerCapture(e),this._activePointerCaptures.add(e)}catch{}}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e)}catch{}}_updateNormalizedPointerLikeEvent(e,i){const s=z0e(this._element,e);return e1e.test.disableSubpixelCoordinates&&(s.x=Math.round(s.x),s.y=Math.round(s.y)),i.x=s.x,i.y=s.y,i}_handleKey(e,i){const{key:s}=i;s&&e==="key-up"&&this._keyDownState.delete(s);const n={native:i,key:s,repeat:!!s&&this._keyDownState.has(s)};s&&e==="key-down"&&this._keyDownState.add(n.key),this._callback(e,n)}_handlePointer(e,i){const s=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,pointerType:i.pointerType,button:i.button,buttons:i.buttons,eventId:this._eventId++});this._callback(e,s)}_handlePointerPreventDefault(e,i){const s=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,pointerType:i.pointerType,button:i.button,buttons:i.buttons,eventId:this._eventId++});i.preventDefault(),this._callback(e,s)}_getDeltaFromTrackpadOrMouseWheel(e){return e.shiftKey&&ke("mac")&&e.deltaY===0?e.deltaX:e.deltaY}_handleMouseWheel(e,i){let s=this._getDeltaFromTrackpadOrMouseWheel(i);switch(i.deltaMode){case 0:Cne&&(s=s/document.documentElement.clientHeight*600);break;case 1:s*=30;break;case 2:s*=900}Cne?s*=.7:Xet||Zet?s*=.6:Wet&&(s*=1.375);const n=100,r=Math.abs(s);r>n&&(s=s/r*200/(1+Math.exp(-.02*(r-n))));const o=this._updateNormalizedPointerLikeEvent(i,{native:i,x:0,y:0,deltaY:s});this._callback(e,o)}_handlePointerCaptureLost(e,i){this._activePointerCaptures.delete(i.pointerId),this._handleDefault(e,i)}_handleDefault(e,i){const s={native:i};i.preventDefault(),this._callback(e,s)}_preventAltKeyDefault(e){e.key==="Alt"&&e.preventDefault()}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault()}};Jve.test={disableSubpixelCoordinates:!1};const cV={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let Ket=class extends zo{constructor(){super(!0),this.registerIncoming("context-menu",e=>e.data.native.preventDefault())}};const Ia={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};function HL(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function Qet(t,e){const i=e.x-t.x,s=e.y-t.y;return Math.sqrt(i*i+s*s)}function Jet(t,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:oa()},t.length===0)return e;if(t.length===1)return e.center.x=t[0].x,e.center.y=t[0].y,e;if(t.length===2){const[T,C]=t,[M,A]=[C.x-T.x,C.y-T.y];return e.radius=Math.sqrt(M*M+A*A)/2,e.center.x=(T.x+C.x)/2,e.center.y=(T.y+C.y)/2,e}let i=0,s=0;for(let T=0;T<t.length;T++)i+=t[T].x,s+=t[T].y;i/=t.length,s/=t.length;const n=t.map(T=>T.x-i),r=t.map(T=>T.y-s);let o=0,a=0,l=0,u=0,c=0,h=0,d=0;for(let T=0;T<n.length;T++){const C=n[T],M=r[T],A=C*C,I=M*M;o+=A,a+=I,l+=C*M,u+=A*C,c+=I*M,h+=C*I,d+=M*A}const m=.5*(u+h),f=.5*(c+d),_=o*a-l*l,v=(m*a-f*l)/_,x=(o*f-l*m)/_,w=oa(v+i,x+s);return{radius:Math.sqrt(v*v+x*x+(o+a)/t.length),center:w}}function s1(t){const{native:e}=t,{pointerId:i,button:s,pointerType:n}=e;return n==="mouse"?`${i}:${s}`:`${n}`}let ett=class extends zo{constructor(e=Ia.maximumDoubleClickDelay,i=Ia.maximumDoubleClickDistance,s=Ia.maximumDoubleTouchDelay,n=Ia.maximumDoubleTouchDistance,r=kS){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=s,this._maximumDoubleTouchDistance=n,this._clock=r,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=oa(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new tk({start:(o,a)=>this._dragStart(o,a),update:(o,a)=>this._dragUpdate(a),end:(o,a)=>this._dragEnd(a)}),this.registerIncoming("drag",o=>this._dragEventSeparator.handle(o)),this.registerIncoming("pointer-down",o=>this._handlePointerDown(o)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(e=>{e.doubleTapTimeout=sr(e.doubleTapTimeout)})}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleTapTimeout!=null)return!0;return!1}_clearPointerDown(e){const i=this._pointerState.get(e);i&&(i.doubleTapTimeout=sr(i.doubleTapTimeout),this._pointerState.delete(e),this.refreshHasPendingInputs())}_dragStart(e,i){if(!this._doubleTapDragReady||e!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:s,modifiers:n}=i,{center:r}=s;this._dragStartCenter=r;const o=hV("begin",oa(0,0),s);this._doubleTapDrag.emit(o,void 0,n),i.stopPropagation()}_dragUpdate(e){if(!this._doubleTapDragActive)return;const{data:i,modifiers:s}=e,{center:n}=i,r=hV("update",oa(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),i);this._doubleTapDrag.emit(r,void 0,s),e.stopPropagation()}_dragEnd(e){if(!this._doubleTapDragActive)return;const{data:i,modifiers:s}=e,{center:n}=i,r=hV("end",oa(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),i);this._doubleTapDrag.emit(r,void 0,s),this._doubleTapDragActive=!1,e.stopPropagation()}_handlePointerDown(e){const{data:i}=e,s=s1(i),n=this._pointerState.get(s),{pointerType:r}=i.native;if(n){const o=r==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;this._clearPointerDown(s),HL(n.event.data,i)>o?this._storePointerDown(e):this._doubleTapDragReady=!0}else this._storePointerDown(e)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(e){const{data:i}=e,{pointerType:s}=i.native,n=s1(i),r=s==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._clearPointerDown(n),r);this._pointerState.set(n,{event:e,doubleTapTimeout:o}),this.refreshHasPendingInputs()}};function hV(t,e,i){const{button:s,buttons:n,pointer:r,pointers:o,pointerType:a,timestamp:l}=i;return{action:t,delta:e,button:s,buttons:n,pointer:r,pointers:o,pointerType:a,timestamp:l}}let ttt=class extends zo{constructor(e){super(!1),this._navigationTouch=e,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(e,i,s,n){return{action:e,pointerType:this._pointerType,button:this._mouseButton,buttons:i.buttons,timestamp:n,pointers:itt(this._activePointerMap),pointer:i,angle:s.angle,radius:s.radius,center:s.center}}_addPointer(e){const i=e.native.pointerId,s=XN(this._activePointerMap).angle,n={event:e,initialAngle:0,lastAngle:0};this._activePointerMap.set(i,n);const r=F3(n,t1e(this._activePointerMap));n.initialAngle=r,n.lastAngle=r,this._updatePointerAngles(s)}_updatePointer(e){if(e&&e.x==null&&e.y==null)return;const i=e.native.pointerId,s=this._activePointerMap.get(i);s?s.event=e:this._addPointer(e)}_removePointer(e){const i=XN(this._activePointerMap).angle;this._activePointerMap.delete(e),this._updatePointerAngles(i)}_updatePointerAngles(e){const i=XN(this._activePointerMap);this._activePointerMap.forEach(s=>{s.initialAngle=F3(s,i)-e,s.lastAngle=F3(s,i)-e})}_emitEvent(e,i,s){const n=XN(this._activePointerMap);this._drag.emit(this._createPayload(e,i,n,s),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(e){const i=e.data.native.pointerId,s=e.timestamp;this._activePointerMap.get(i)&&(this._activePointerMap.size===1?(this._updatePointer(e.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",e.data,s),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(i)):(this._removePointer(i),this._emitEvent("removed",e.data,e.timestamp)))}_handlePointerDrag(e){const i=e.data,s=i.currentEvent,n=e.timestamp;switch(i.action){case"start":case"update":this._isDragging?this._activePointerMap.has(s.native.pointerId)?(this._updatePointer(s),!this._isCurrentDragSuppressed&&this._emitEvent("update",s,n)):(this._addPointer(s),this._emitEvent("added",s,n),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(s),this._pointerType=e.data.startEvent.pointerType,this._mouseButton=e.data.startEvent.button,this._startStateModifiers=e.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",s,n))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function t1e(t){const e=[];return t.forEach(i=>{e.push(oa(i.event.x,i.event.y))}),Jet(e)}function XN(t){const e=t1e(t);let i=0;return t.forEach(s=>{let n=F3(s,e),r=n-s.lastAngle;for(;r>Math.PI;)r-=2*Math.PI;for(;r<-Math.PI;)r+=2*Math.PI;n=s.lastAngle+r,s.lastAngle=n;const o=n-s.initialAngle;i+=o}),i/=t.size||1,{angle:i,radius:e.radius,center:e.center}}function itt(t){const e=new Map;return t.forEach((i,s)=>e.set(s,i.event)),e}function F3(t,e){const i=t.event,s=i.x-e.center.x,n=i.y-e.center.y;return Math.atan2(n,s)}var Pne;(function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Back=3]="Back",t[t.Forward=4]="Forward",t[t.Undefined=-1]="Undefined"})(Pne||(Pne={}));let stt=class extends zo{constructor(e=Ia.maximumDoubleClickDelay,i=Ia.maximumDoubleClickDistance,s=Ia.maximumDoubleTouchDelay,n=Ia.maximumDoubleTouchDistance,r=kS){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=s,this._maximumDoubleTouchDistance=n,this._clock=r,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(e=>{e.immediateDoubleClick&&e.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(e){const i=e.data,s=s1(i);if(!this._pointerState.has(s)){const n={downButton:i.native.button,x:i.x,y:i.y,immediateDoubleClick:null};this._pointerState.set(s,n),this.startCapturingPointer(i.native)}}_handlePointerUp(e){const i=e.data,s=s1(i),n=this._pointerState.get(s);if(n&&n.downButton===i.native.button){const r=n.immediateDoubleClick,o=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;r?(r.timeoutHandle.remove(),HL(r,e.data)>o?this._startImmediateDoubleClick(e,n):(this._immediateDoubleClick.emit(e.data,void 0,r.modifiers),this._removeState(i))):HL(n,e.data)>o?this._removeState(i):this._startImmediateDoubleClick(e,n)}}_startImmediateDoubleClick(e,i){const s=e.data.native.pointerType==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;i.immediateDoubleClick={x:e.data.x,y:e.data.y,modifiers:e.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(e.data),s)}}_removeState(e){const i=s1(e);this._pointerState.delete(i),this.stopCapturingPointer(e.native),this.refreshHasPendingInputs()}},ntt=class extends zo{constructor(e=Ia.maximumClickDelay,i=Ia.movementUntilMouseDrag,s=Ia.movementUntilPenDrag,n=Ia.movementUntilTouchDrag,r=Ia.holdDelay,o=kS){super(!1),this._maximumClickDelay=e,this._movementUntilMouseDrag=i,this._movementUntilPenDrag=s,this._movementUntilTouchDrag=n,this._holdDelay=r,this._clock=o,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",a=>this._handlePointerDown(a)),this.registerIncoming("pointer-up",a=>this._handlePointerLoss(a,"pointer-up")),this.registerIncoming("pointer-capture-lost",a=>this._handlePointerLoss(a,"pointer-capture-lost")),this.registerIncoming("pointer-cancel",a=>this._handlePointerLoss(a,"pointer-cancel")),this._moveHandle=this.registerIncoming("pointer-move",a=>this._handlePointerMove(a)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(e=>{e.holdTimeout=sr(e.holdTimeout)}),super.onUninstall()}_handlePointerDown(e){const i=e.data,s=i.native.pointerId;let n=null;this._pointerState.size===0&&(n=this._clock.setTimeout(()=>{const o=this._pointerState.get(s);if(o){if(!o.isDragging){const a=o.previousEvent;this._pointerHold.emit(a,void 0,e.modifiers),o.holdEmitted=!0}o.holdTimeout=null}},this._holdDelay));const r={startEvent:i,previousEvent:i,startTimestamp:e.timestamp,isDragging:!1,downButton:i.native.button,holdTimeout:n,modifiers:new Set};this._pointerState.set(s,r),this.startCapturingPointer(i.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(e)}_handlePointerMove(e){const i=e.data,s=i.native.pointerId,n=this._pointerState.get(s);n&&(n.isDragging?this._pointerDrag.emit(WN("update",n,i),void 0,n.modifiers):Qet(i,n.startEvent)>this._getDragThreshold(i.native.pointerType)&&this._startDragging(e),n.previousEvent=i)}_getDragThreshold(e){switch(e){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}_startDragging(e){const i=e.data,s=i.native.pointerId;this._pointerState.forEach(n=>{n.holdTimeout!=null&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging||(n.modifiers=e.modifiers,n.isDragging=!0,s===n.startEvent.native.pointerId?this._pointerDrag.emit(WN("start",n,i)):this._pointerDrag.emit(WN("start",n,n.previousEvent),e.timestamp))})}_handlePointerLoss(e,i){const s=e.data,n=s.native.pointerId,r=this._pointerState.get(n);r&&(r.holdTimeout!=null&&(r.holdTimeout.remove(),r.holdTimeout=null),r.isDragging?this._pointerDrag.emit(WN("end",r,i==="pointer-up"?s:r.previousEvent),void 0,r.modifiers):i==="pointer-up"&&r.downButton===s.native.button&&e.timestamp-r.startTimestamp<=this._maximumClickDelay&&!r.holdEmitted&&this._immediateClick.emit(s),this._pointerState.delete(n),this.stopCapturingPointer(s.native),this._pointerState.size===0&&this._moveHandle.pause())}};function WN(t,e,i){return{action:t,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:i}}let rtt=class extends zo{constructor(e=Ia.maximumDoubleClickDelay,i=Ia.maximumDoubleClickDistance,s=Ia.maximumDoubleTouchDelay,n=Ia.maximumDoubleTouchDistance,r=kS){super(!1),this._maximumDoubleClickDelay=e,this._maximumDoubleClickDistance=i,this._maximumDoubleTouchDelay=s,this._maximumDoubleTouchDistance=n,this._clock=r,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",o=>this._handleImmediateClick(o)),this.registerIncoming("pointer-down",o=>this._handlePointerDown(o))}onUninstall(){this._pointerState.forEach(e=>e.doubleClickTimer=sr(e.doubleClickTimer))}get hasPendingInputs(){for(const e of this._pointerState.values())if(e.doubleClickTimer!=null)return!0;return!1}_clearDoubleClickTimer(e,i){const s=this._pointerState.get(e);s&&(s.doubleClickTimer=sr(s.doubleClickTimer),i&&this._click.emit(s.event.data,void 0,s.event.modifiers),this._pointerState.delete(e),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(e){const i=this._pointerState.get(e);i.pointerDownCount===1&&this._click.emit(i.event.data,void 0,i.event.modifiers),i.doubleClickTimer=null,this._pointerState.delete(e),this.refreshHasPendingInputs()}_handleImmediateClick(e){const i=e.data,{pointerType:s}=i.native,n=ott(i);if(!this._pointerState.has(n))return void this._startClick(e);const r=this._pointerState.get(n),{data:o,modifiers:a}=r.event,l=s==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;HL(o,i)>l?(this._clearDoubleClickTimer(n,!0),this._startClick(e)):(this._clearDoubleClickTimer(n,!1),r.pointerDownCount===2&&this._doubleClick.emit(o,void 0,a))}_handlePointerDown(e){const i=s1(e.data),s=this._pointerState.get(i);s&&(s.pointerDownCount+=1)}_startClick(e){const{data:i}=e,{native:{pointerType:s}}=i,n=s1(i),r=s==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(n),r);this._pointerState.set(n,{event:e,doubleClickTimer:o,pointerDownCount:1}),this.refreshHasPendingInputs()}};function ott(t){const{pointerId:e,pointerType:i,button:s}=t.native;return i==="mouse"?`${e}:${s}`:`${i}`}const ZN={counter:"Control",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwise:["a","A"],counterClockwise:["d","D"],reset:["n","N"]}},Mne=Symbol("handles");let rv=class extends ei{initialize(){const e=()=>{var i;return(i=this.view)==null?void 0:i.ready};this.addHandles([nh(()=>!e(),()=>this._disconnect()),nh(e,()=>this._connect())])}destroy(){this._disconnect()}get latestPointerType(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerType}get latestPointerLocation(){var e;return(e=this._inputManager)==null?void 0:e.latestPointerLocation}get multiTouchActive(){var e;return((e=this._inputManager)==null?void 0:e.multiTouchActive)??!1}isModifierKeyDown(e){var i;return((i=this._inputManager)==null?void 0:i.isModifierKeyDown(e))??!1}_disconnect(){this.view.viewEvents.disconnect(),this.removeHandles(Mne),this._inputManager=er(this._inputManager)}_connect(){const e=this.view.surface,i=new Jve(e,this.view.input),s=[new stt,new ntt,new rtt,new ttt(this.view.navigation),new ett],n=new Oc({eventSource:i,recognizers:s}),r=new GJe(this.view,["primary"]),o=new BJe(this.view,["secondary"]);n.installHandlers("prevent-context-menu",[new Ket],uy.INTERNAL),n.installHandlers("navigation",[new Get(this.view),new Ret(this.view),new zet(this.view),new xne(this.view),new xne(this.view,[ZN.counter]),r,new ket(this.view,ZN.pan),new Uet(this.view,ZN.zoom),new $et(this.view,ZN.rotate),o,new zJe(this.view,"touch")],uy.INTERNAL),this.view.viewEvents.connect(n),this._source=i,this._inputManager=n,this.addHandles([Ai(()=>{var a,l;return(l=(a=this.view)==null?void 0:a.navigation)==null?void 0:l.browserTouchPanEnabled},a=>{this._source&&(this._source.browserTouchPanningEnabled=!a)},nl),Ai(()=>{const{actionMap:a}=this.view.navigation;return{panActions:vne("pan",a),rotateActions:vne("rotate",a)}},({panActions:a,rotateActions:l})=>{r.pointerActions=a,o.pointerActions=l},uu)],Mne)}get test(){}};y([S()],rv.prototype,"view",void 0),y([S()],rv.prototype,"latestPointerType",null),y([S()],rv.prototype,"latestPointerLocation",null),y([S()],rv.prototype,"multiTouchActive",null),rv=y([se("esri.views.2d.input.MapViewInputManager")],rv);const att=rv,Ane=160;let fT=class extends ei{constructor(){super(...arguments),this._timer=void 0}get stationary(){return!this._timer}flip(){this._timestamp=performance.now(),this._timer==null&&(this._timer=setInterval(()=>{performance.now()-this._timestamp>=Ane&&this.clear()},Ane))}clear(){this._timer&&(clearInterval(this._timer),this._timer=void 0)}};y([S()],fT.prototype,"_timer",void 0),y([S()],fT.prototype,"stationary",null),fT=y([se("esri.views.2d.support.StationaryManager")],fT);const ltt=t=>{let e=class extends t{constructor(...i){super(...i),this.fullOpacity=1,this.stateManager=new Wa({constraints:new yne({view:this})}),this.goToManager=new L3({view:this}),this.stationaryManager=new fT,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!1,labelsAnimationTime:0,labelCollisionsEnabled:!1},this.frameTask=new FJe(this),this.inputManager=new att({view:this}),this.viewEvents=new V0e(this),this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([Ai(()=>this.viewpoint,()=>this.stationaryManager.flip(),km),this.on("resize",s=>this.stateManager.resize(s.width,s.height))])}get constraintsInfo(){return{lods:null,spatialReference:null}}get extent(){var i;return((i=this.stateManager)==null?void 0:i.extent)??null}set extent(i){this.stateManager.extent=i}get state(){return this.stateManager.state}get interacting(){return this.navigating}get stationary(){return!this.animation&&!this.navigating&&!this.resizing&&this.stationaryManager.stationary}set animation(i){const s=this._get("animation");if(i===s)return;if(s&&s.stop(),i!==this.animationManager.animation&&this.animationManager.stop(),!i||i.isFulfilled())return void this._set("animation",null);this._set("animation",i);const n=()=>{var r;this.destroyed||i===this._get("animation")&&(this._set("animation",null),(r=this.frameTask)==null||r.requestFrame())};i.when(n,n)}get constraints(){var i;return(i=this.stateManager)==null?void 0:i.constraints}set constraints(i){i.view=this;const s=this.stateManager.constraints;this.stateManager.constraints=i,s==null||s.destroy()}get padding(){var i;return(i=this.stateManager)==null?void 0:i.padding}set padding(i){this.stateManager&&(this.stateManager.padding=i)}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(i){this.stateManager.resizeAlign=i}get rotation(){return this.stateManager.rotation??0}set rotation(i){const{rotationEnabled:s}=this.constraints;this.constraints.rotationEnabled=!0,this.stateManager.rotation=i,this.constraints.rotationEnabled=s}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(i){this.stateManager.viewpoint=i,this.frameTask.requestFrame()}on(i,s,n,r){return this.inputManager&&this.viewEvents.on(i,s,n,r)||super.on(i,s)}hasEventListener(i){return super.hasEventListener(i)||this.viewEvents.hasHandler(i)}goTo(i,s){return this.goToManager.goTo(i,s)}};return y([S({readOnly:!0})],e.prototype,"animationManager",void 0),y([S({readOnly:!0})],e.prototype,"fullOpacity",void 0),y([S()],e.prototype,"stateManager",void 0),y([S()],e.prototype,"constraintsInfo",null),y([S()],e.prototype,"extent",null),y([S()],e.prototype,"goToManager",void 0),y([S({readOnly:!0})],e.prototype,"state",null),y([S({readOnly:!0})],e.prototype,"mapViewNavigation",void 0),y([S()],e.prototype,"renderingOptions",void 0),y([S({readOnly:!0})],e.prototype,"interacting",null),y([S()],e.prototype,"stationary",null),y([S()],e.prototype,"animation",null),y([S({type:yne})],e.prototype,"constraints",null),y([S({readOnly:!0})],e.prototype,"inputManager",void 0),y([S()],e.prototype,"padding",null),y([S()],e.prototype,"resizeAlign",null),y([S()],e.prototype,"rotation",null),y([S({readOnly:!0})],e.prototype,"viewEvents",void 0),y([S({type:th})],e.prototype,"viewpoint",null),e=y([se("esri.views.Viewport2DMixin")],e),e};let Ine=class{constructor(e){this._view=e,this.viewpoint=new th({targetGeometry:new ki,scale:0,rotation:0})}get view(){return this._view}get size(){const[e,i]=this._view.size;return Math.sqrt(e*e+i*i)}get scale(){return this.viewpoint.scale}get rotation(){return this.viewpoint.rotation}get center(){return this.viewpoint.targetGeometry}get scaleToResolutionFactor(){return bve(this.center.spatialReference)}pixelsPerPanAtZoom(e){return 1/(e*this.scaleToResolutionFactor)}zoomAtPixelsPerPan(e){return 1/(e*this.scaleToResolutionFactor)}pixelsPerRotate(){return this.size/2}compareTo(e,i){i.pan=$ce(this.center,e.center);let s=Math.abs(e.rotation-this.rotation);s=s>=180?360-s:s,i.rotate=qM(s),i.sourceZoom=this.scale,i.targetZoom=e.scale}interpolate(e,i,s){const{pan:n,rotate:r,zoom:o,zoomOffset:a}=s,{center:l}=this;l.spatialReference=e.center.spatialReference,l.x=pC(e.center.x,i.center.x,n),l.y=pC(e.center.y,i.center.y,n),this.viewpoint.scale=pC(e.scale,i.scale+a,o);let u=e.rotation;const c=i.rotation;Math.abs(c-u)>=180&&(u+=360*(u<c?1:-1)),this.viewpoint.rotation=pC(u,c,r)}copyFrom(e){sl(this.viewpoint,e.viewpoint),this._view=e.view}};function J2(t,e,i,s){const n=3*t,r=3*(i-t)-n,o=1-n-r,a=3*e,l=3*(s-e)-a,u=1-a-l;function c(f){return((o*f+r)*f+n)*f}function h(f){return((u*f+l)*f+a)*f}function d(f){return(3*o*f+2*r)*f+n}function m(f,_){let v,x,w,T,C,M;for(w=f,M=0;M<8;M++){if(T=c(w)-f,Math.abs(T)<_)return w;if(C=d(w),Math.abs(C)<1e-6)break;w-=T/C}if(v=0,x=1,w=f,w<v)return v;if(w>x)return x;for(;v<x;){if(T=c(w),Math.abs(T-f)<_)return w;f>T?v=w:x=w,w=.5*(x-v)+v}return w}return function(f,_=1e-6){return h(m(f,_))}}const Gc={};Gc.ease=J2(.25,.1,.25,1),Gc.linear=J2(0,0,1,1),Gc.easeIn=Gc["ease-in"]=J2(.42,0,1,1),Gc.easeOut=Gc["ease-out"]=J2(0,0,.58,1),Gc.easeInOut=Gc["ease-in-out"]=J2(.42,0,.58,1);const utt=t=>t,ik=t=>t*t,RY=t=>1-ik(1-t),ctt=t=>t<.5?ik(2*t)/2:(RY(2*(t-.5))+1)/2,OY=t=>t*t*t,i1e=t=>1-OY(1-t),htt=t=>t<.5?OY(2*t)/2:(i1e(2*(t-.5))+1)/2,LY=t=>t*t*t*t,s1e=t=>1-LY(1-t),dtt=t=>t<.5?LY(2*t)/2:(s1e(2*(t-.5))+1)/2,FY=t=>t*t*t*t*t,n1e=t=>1-FY(1-t),mtt=t=>t<.5?FY(2*t)/2:(n1e(2*(t-.5))+1)/2,kY=t=>1-Math.cos(t*Math.PI/2),r1e=t=>1-kY(1-t),ptt=t=>t<.5?kY(2*t)/2:(r1e(2*(t-.5))+1)/2,$Y=t=>2**(10*(t-1)),UY=t=>1-$Y(1-t),ftt=t=>t<.5?$Y(2*t)/2:(UY(2*(t-.5))+1)/2,VY=t=>-(Math.sqrt(1-t*t)-1),o1e=t=>1-VY(1-t),gtt=t=>t<.5?VY(2*t)/2:(o1e(2*(t-.5))+1)/2;function lh(t){const e=2*(t-Math.sqrt((t-1)*t)),i=e/2/t;return s=>s<i?t*s*s:e*s-e+1}function uh(t,e){return(i,s)=>i<e?e*t(i/e,s):1-t((1-i)/(1-e),s)*(1-e)}const _tt=uh(lh(1),1),ytt=uh(lh(1),0),Sq=uh(lh(1),.5),vtt=uh(lh(2),1),xtt=uh(lh(2),0),btt=uh(lh(2),.5),wtt=uh(lh(3),1),Stt=uh(lh(3),0),Ett=uh(lh(3),.5),Ctt=uh(lh(4),1),Ttt=uh(lh(4),0),Ptt=uh(lh(4),.5),Dne={linear:utt,"in-quad":ik,"out-quad":RY,"in-out-quad":ctt,"in-coast-quad":_tt,"out-coast-quad":ytt,"in-out-coast-quad":Sq,"in-cubic":OY,"out-cubic":i1e,"in-out-cubic":htt,"in-coast-cubic":vtt,"out-coast-cubic":xtt,"in-out-coast-cubic":btt,"in-quart":LY,"out-quart":s1e,"in-out-quart":dtt,"in-coast-quart":wtt,"out-coast-quart":Stt,"in-out-coast-quart":Ett,"in-quint":FY,"out-quint":n1e,"in-out-quint":mtt,"in-coast-quint":Ctt,"out-coast-quint":Ttt,"in-out-coast-quint":Ptt,"in-sine":kY,"out-sine":r1e,"in-out-sine":ptt,"in-expo":$Y,"out-expo":UY,"in-out-expo":ftt,"in-circ":VY,"out-circ":o1e,"in-out-circ":gtt,ease:t=>Gc.ease(t),"ease-in":t=>Gc.easeIn(t),"ease-out":t=>Gc.easeOut(t),"ease-in-out":t=>Gc.easeInOut(t)};let Mtt=class{constructor(){this.pan=0,this.rotate=0,this.fov=0,this.sourceZoom=0,this.targetZoom=0}};const jL={desiredScreenFlow:2,minDuration:500,maxDuration:8e3},a1e={maxDuration:4e3};let Att=class l1e{constructor(e){this._createCamera=e,this.compared=new Mtt,this.segmentStart=0,this.segmentEnd=1,this.settings={desiredScreenFlow:jL.desiredScreenFlow},this.source=e(),this.target=e()}clone(){const e=new l1e(this._createCamera);return e.copyFrom(this),e}copyFrom(e){this.update(e.source,e.target,e.settings)}update(e,i,s){this.source!==e&&this.source.copyFrom(e),this.target!==i&&this.target.copyFrom(i),this.source.compareTo(this.target,this.compared),this.settings.desiredScreenFlow=s.desiredScreenFlow??jL.desiredScreenFlow,this.desiredPixelFlow=this.settings.desiredScreenFlow*this.target.size,this.halfWindowSize=this.target.size/2}halfWindowPanAtZoom(e){const i=this.target.pixelsPerPanAtZoom(e);return this.halfWindowSize/i}get hasZoom(){return Math.abs(this.compared.sourceZoom-this.compared.targetZoom)>1e-5}get hasPan(){return this.compared.pan>kl()}get hasFov(){return Math.abs(this.compared.fov)>kl()}get hasRotate(){return this.compared.rotate>kl()}},Itt=class{constructor(){this.pan=0,this.rotate=0,this.zoom=0,this.fov=0,this.zoomOffset=0}},Dtt=class{constructor(){this.segments=new Array}get time(){return this.segments.reduce((e,i)=>e+i.time,0)}interpolateComponentsAt(e,i){e=Math.min(Math.max(e,0),1),e*=this.time;let s=0,n=0;const r=this.definition,o=this.segments.reduce((a,l)=>a||l.definition.hasZoom,!1);for(let a=0;a<this.segments.length;a++){const l=this.segments[a],u=l.definition;if(e<=l.time||a===this.segments.length-1){if(this.segmentInterpolateComponentsAt(l,l.time===0?0:e/l.time,i),r.hasPan&&!isNaN(i.pan)&&isFinite(r.compared.pan)?i.pan=(s+u.compared.pan*i.pan)/r.compared.pan:i.pan=1,r.hasRotate&&!isNaN(i.rotate)&&isFinite(r.compared.rotate)?i.rotate=(n+u.compared.rotate*i.rotate)/r.compared.rotate:i.rotate=1,o&&!isNaN(i.zoom)&&isFinite(u.compared.targetZoom)){const{sourceZoom:c,targetZoom:h}=u.compared,d=i.zoom*(h-c)+c,m=this.segments[0].definition.compared.sourceZoom,f=this.segments[this.segments.length-1].definition.compared.targetZoom,_=Math.abs(h-m)>Math.abs(c-m)?h:c;i.zoomOffset=_-f,i.zoom=(d-m)/(_-m)}else i.zoom=1;return i}e-=l.time,s+=u.compared.pan,n+=u.compared.rotate}}segmentInterpolateComponentsAt(e,i,s){e.interpolateComponentsAt(i,s)}},dV=class{get time(){return this._time}constructor(e){e&&this.update(e)}update(e){e&&(this.definition?this.definition.copyFrom(e):this.definition=e.clone()),this._updatePrecomputedVariables(),this._updatePixelFlow()}_updatePrecomputedVariables(){const e=this.definition,i=e.compared,s=i.sourceZoom,n=i.targetZoom;this._zoomSign=s>n?1:-1,this._panPixelsAtSource=i.pan*e.source.pixelsPerPanAtZoom(s);const r=(e.source.pixelsPerRotate()+e.target.pixelsPerRotate())/2;this._rotatePixels=i.rotate*r}_updatePixelFlow(){const e=this.definition.compared.sourceZoom,i=this.definition.compared.targetZoom,{hasZoom:s,hasPan:n,hasRotate:r}=this.definition;let o=0,a=0;s&&(n&&(o=(i/e-1)/(-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2*this._panPixelsAtSource)),r&&(a=this._zoomSign*(Math.log(e/i)/Math.LN2)*this.definition.halfWindowSize/this._rotatePixels)),this._zoomPixelFlow=0,this._panPixelFlow=0,this._rotatePixelFlow=0;const l=this.definition.desiredPixelFlow;if(s&&n&&r){const u=o+a+o*a;this._zoomPixelFlow=o*a/u*l,this._panPixelFlow=a/u*l,this._rotatePixelFlow=o/u*l}else if(s&&n){const u=1+o;this._zoomPixelFlow=o/u*l,this._panPixelFlow=1/u*l}else if(s&&r){const u=1+a;this._zoomPixelFlow=a/u*l,this._rotatePixelFlow=1/u*l}else if(n&&r){const u=this._panPixelsAtSource/this._rotatePixels,c=1+u;this._panPixelFlow=u/c*l,this._rotatePixelFlow=1/c*l}else n?this._panPixelFlow=l:s?this._zoomPixelFlow=l:r&&(this._rotatePixelFlow=l);if(this._time=Math.max(this.rotateTime,this.zoomTime,this.panTime),this.fovTime>this._time){const u=this.fovTime/this._time;this._time=this.fovTime,this._zoomPixelFlow/=u,this._panPixelFlow/=u,this._rotatePixelFlow/=u}}get rotateTime(){return this.definition.hasRotate?this._rotatePixels/this._rotatePixelFlow:0}get zoomTime(){return this.definition.hasZoom?this._zoomSign*(Math.log(this.definition.compared.sourceZoom/this.definition.compared.targetZoom)/Math.LN2)*this.definition.halfWindowSize/this._zoomPixelFlow:0}get fovTime(){return this.definition.hasFov?Math.abs(this.definition.compared.fov)/Ntt:0}get panTime(){if(!this.definition.hasPan)return 0;if(this.definition.hasZoom){const e=-1/(this._zoomSign*this.definition.halfWindowSize)*Math.LN2,i=e*this._panPixelsAtSource;return Math.log(i*(this._zoomPixelFlow/this._panPixelFlow)+1)/(e*this._zoomPixelFlow)}return this._panPixelsAtSource/this._panPixelFlow}_interpolateComponentsZoom(e){if(e===0||e===1)return e;if(this.definition.hasZoom){const i=this.definition.compared.sourceZoom,s=this.definition.compared.targetZoom;return(i*(i/s)**-e-i)/(s-i)}return e}_interpolateComponentsFov(e){if(e===0)return this.definition.segmentStart;if(e===1)return this.definition.segmentEnd;if(this.definition.hasFov){const{segmentStart:i,segmentEnd:s}=this.definition;return i+e*(s-i)}return this.definition.segmentStart}_interpolateComponentsPan(e){if(e===0||e===1)return e;if(this.definition.hasPan&&this.definition.hasZoom){const i=-1/(this._zoomSign*this.definition.halfWindowSize)*this._zoomPixelFlow;return 1/this._panPixelsAtSource*(this._panPixelFlow*(2**(i*e*this._time)-1))/(i*Math.LN2)}return e}_interpolateComponentsRotate(e){return e}interpolateComponentsAt(e,i){e=Math.min(Math.max(e,0),1),i.zoom=this._interpolateComponentsZoom(e),i.pan=this._interpolateComponentsPan(e),i.rotate=this._interpolateComponentsRotate(e),i.zoomOffset=0,i.fov=this._interpolateComponentsFov(e)}};const Ntt=qM(45);function Rtt(t,e,i){const s=e-t.compared.sourceZoom,n=t.halfWindowPanAtZoom(s);return-t.halfWindowSize*(i.ascensionFactor*Math.LN2*t.compared.pan+n)*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2*n)}function Ott(t,e,i){const s=1/e,n=Math.log(t.compared.sourceZoom*s),r=1/t.desiredPixelFlow,o=1/Math.LN2,a=e-t.compared.sourceZoom,l=1/a,u=(i.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(a))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*s*r*o*l*u-t.halfWindowSize*n*r*o*l+t.halfWindowSize*n*r*o*u/(a*a)}function Ltt(t,e,i){const s=e-t.compared.sourceZoom,n=1/s,r=1/e,o=Math.log(t.compared.sourceZoom*r),a=(i.ascensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(s))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*n*(-2*n*r*a+2*n*o+2*r-2*o*a/(s*s)-a/(e*e))/(t.desiredPixelFlow*Math.LN2)}function Ftt(t,e){return-t.halfWindowSize*Math.log(t.compared.sourceZoom/e)/(t.desiredPixelFlow*Math.LN2)}function ktt(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function $tt(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function Utt(t,e,i){return-t.compared.pan*t.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e))}function Vtt(t,e,i){return t.compared.pan*t.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e))}function ztt(t,e,i){return-2*t.compared.pan*t.halfWindowSize*(i.ascensionFactor+i.descensionFactor-1)/(t.desiredPixelFlow*t.halfWindowPanAtZoom(e*e*e))}function Gtt(t,e,i){return t.halfWindowSize*(-t.halfWindowPanAtZoom(e)-i.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*t.halfWindowPanAtZoom(-e+t.compared.targetZoom))}function Btt(t,e,i){const s=Math.log(e/t.compared.targetZoom),n=1/t.desiredPixelFlow,r=1/Math.LN2,o=-e+t.compared.targetZoom,a=1/o,l=(-t.halfWindowPanAtZoom(e)-i.descensionFactor*Math.LN2*t.compared.pan+t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return-t.halfWindowSize*s*n*r*a+t.halfWindowSize*s*n*r*l/(o*o)+t.halfWindowSize*n*r*a*l/e}function qtt(t,e,i){const s=e-t.compared.targetZoom,n=1/s,r=1/e,o=Math.log(e/t.compared.targetZoom),a=(t.halfWindowPanAtZoom(e)+i.descensionFactor*Math.LN2*t.compared.pan-t.halfWindowPanAtZoom(t.compared.targetZoom))/t.halfWindowPanAtZoom(1);return t.halfWindowSize*n*(-2*n*r*a-2*n*o+2*r+2*o*a/(s*s)-a/(e*e))/(t.desiredPixelFlow*Math.LN2)}function Htt(t,e){return t.halfWindowSize*Math.log(e/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2)}function jtt(t,e){return t.halfWindowSize/(e*t.desiredPixelFlow*Math.LN2)}function Ytt(t,e){return-t.halfWindowSize/(e*e*t.desiredPixelFlow*Math.LN2)}function Xtt(t){const e=t.compared.sourceZoom-t.compared.targetZoom;if(e===0)return t.compared.pan*t.halfWindowSize/(t.desiredPixelFlow*t.halfWindowPanAtZoom(t.compared.sourceZoom));const i=Math.LN2*t.compared.pan,s=e,n=t.halfWindowPanAtZoom(s),r=t.halfWindowSize*Math.log(t.compared.sourceZoom/t.compared.targetZoom)/(t.desiredPixelFlow*Math.LN2*n);return t.compared.sourceZoom<=t.compared.targetZoom?r*(i-n):r*(i+n)}function Wtt(t,e){let i=Ztt(t,e);const s={ascensionFactor:e.ascensionFactor!=null?e.ascensionFactor:.5,descensionFactor:e.descensionFactor!=null?e.descensionFactor:.5},n=s.ascensionFactor===0,r=s.descensionFactor===0,o=n?Ftt:Rtt,a=n?ktt:Ott,l=n?$tt:Ltt,u=r?Htt:Gtt,c=r?jtt:Btt,h=r?Ytt:qtt,d=C=>o(t,C,s)+Utt(t,C,s)+u(t,C,s),m=C=>a(t,C,s)+Vtt(t,C,s)+c(t,C,s),f=C=>l(t,C,s)+ztt(t,C,s)+h(t,C,s);let _=d(i);const v=Xtt(t);let x;const w=e.maximumIterations||20,T=e.maximumDistance!=null?e.maximumDistance:1/0;for(x=0;x<w;x++){const C=e.desiredSlope??1e-6;let M=m(i);Math.abs(M)>C&&(M+=C);const A=M/f(i);if(isNaN(A)||i>=T&&A<0){if(!isFinite(T))return null;i=T,_=d(i);break}if(i-=A,i<t.compared.sourceZoom||i<t.compared.targetZoom)return null;const I=d(i);if(Math.abs(I-_)/_<=.005)break;_=I}return _>v*(1-.3)||i<t.compared.sourceZoom||i<t.compared.targetZoom?null:i}function Ztt(t,e){const i=Math.max(t.compared.sourceZoom,t.compared.targetZoom),s=t.source.zoomAtPixelsPerPan(t.desiredPixelFlow/t.compared.pan)/2;return s<i?e.maximumDistance!=null?i+(e.maximumDistance-i)/2:1.5*i:e.maximumDistance?Math.min(e.maximumDistance,s):s}let Ktt=class extends Dtt{constructor(e,i){super(),this._preallocSegments=[new dV,new dV,new dV],this._ascensionSegment=null,this._descensionSegment=null,this.update(e,i)}update(e,i){if(!e)return;this.definition?this.definition.copyFrom(e):this.definition=e.clone();const s=i!=null&&i.apex?Wtt(e,i.apex):null;this.segments.length=0,this._ascensionSegment=null,this._descensionSegment=null,s?this._updateWithApex(s,i==null?void 0:i.apex):this._updateWithoutApex()}segmentInterpolateComponentsAt(e,i,s){e.interpolateComponentsAt(i,s),e===this._ascensionSegment?s.zoom=RY(s.zoom):e===this._descensionSegment&&(s.zoom=ik(s.zoom))}_updateWithApex(e,i){const[s,n,r]=this._preallocSegments,o=(i==null?void 0:i.ascensionFactor)??.5,a=Math.min(1-o,(i==null?void 0:i.ascensionFactor)!=null&&i.descensionFactor!=null?i.descensionFactor:.5),l=1-o-a;s.definition?s.definition.copyFrom(this.definition):s.definition=this.definition.clone(),s.definition.compared.targetZoom=e,s.definition.compared.pan=this.definition.compared.pan*o,s.definition.compared.rotate=this.definition.compared.rotate*o,s.definition.segmentEnd=o,s.update(),this._ascensionSegment=s,this.segments.push(s),l>0&&(n.definition?n.definition.copyFrom(this.definition):n.definition=this.definition.clone(),n.definition.copyFrom(this.definition),n.definition.compared.sourceZoom=e,n.definition.compared.targetZoom=e,n.definition.compared.pan=this.definition.compared.pan*l,n.definition.compared.rotate=this.definition.compared.rotate*l,n.definition.segmentStart=s.definition.segmentEnd,n.definition.segmentEnd=s.definition.segmentEnd+l,n.update(),this.segments.push(n)),r.definition?r.definition.copyFrom(this.definition):r.definition=this.definition.clone(),r.definition.compared.sourceZoom=e,r.definition.compared.pan=this.definition.compared.pan*a,r.definition.compared.rotate=this.definition.compared.rotate*a,r.definition.segmentStart=o+l,r.update(),this._descensionSegment=r,this.segments.push(r)}_updateWithoutApex(){const[e]=this._preallocSegments;e.update(this.definition),this.segments.push(e)}};const Qtt=new Itt;let Jtt=class{get time(){return this._time}get isLinear(){return this.path.segments.length===1}constructor(e){this._time=0,this._easing=Sq,this.definition=new Att(e),this.path=new Ktt}update(e,i,s){this.definition.update(e,i,s),this.path.update(this.definition,s),this._time=this._applyTimeSettings(R2e(isFinite(this.path.time)?this.path.time:0),s),this._easing=s.easing??(this._time>=1e3?Sq:UY)}cameraAt(e,i){e=Math.min(Math.max(0,e),1),e=this._normalizedEasing(e);const s=this.path.interpolateComponentsAt(e,Qtt);i.interpolate(this.definition.source,this.definition.target,s)}_normalizedEasing(e){const i=this._easing(0,this._time),s=this._easing(1,this._time);return(this._easing(e,this._time)-i)/(s-i)}_applyTimeSettings(e,i){const s=i.speedFactor!=null?i.speedFactor:1,n=i.minDuration??jL.minDuration/s,r=i.maxDuration??jL.maxDuration/s;return e=i.duration!=null?i.duration:Math.min(Math.max(e/s,n),r)}};const eit=2e3,tit=64;let iit=class{constructor(e){this._view=e,this._animation=new Jtt(()=>new Ine(this._view)),this._current=new Ine(this._view)}get _source(){return this._animation.definition.source}get _target(){return this._animation.definition.target}get duration(){return this._animation.time}get animation(){return this._animation}update(e,i,s={}){sl(this._current.viewpoint,e),sl(this._source.viewpoint,e),sl(this._target.viewpoint,i),this._animation.update(this._source,this._target,s)}applyRatio(e,i){this._animation.cameraAt(i,this._current),sl(e,this._current.viewpoint)}},Ob=class extends ei{constructor(e){super(e),this._animation=null,this._destinationViewState=new NY,this.updateFunction=null,this.easing=Dne.ease,this.viewpoint=new th({targetGeometry:new ki,scale:0,rotation:0}),this._updateTask=Ww({postRender:this._postRender.bind(this)}),this._updateTask.pause(),this._transition=new iit(e.view)}destroy(){this._updateTask=sr(this._updateTask)}get animation(){return this._animation}set animation(e){this._animation=e,this.view.animation=e}animate(e,i,s){this.stop();const n=this.viewpoint;sl(n,i);const r=e.target;this._transition.update(this.viewpoint,r,{apex:{maximumDistance:Math.min(Math.min(i.scale,r.scale)*tit,this.view.constraints.effectiveMinScale),desiredSlope:5e-8},duration:s==null?void 0:s.duration,maxDuration:(s==null?void 0:s.animationMode)==="auto"?1/0:(s==null?void 0:s.maxDuration)??a1e.maxDuration,speedFactor:s==null?void 0:s.speedFactor,easing:(typeof(s==null?void 0:s.easing)=="string"?Dne[s.easing]:s==null?void 0:s.easing)||this.easing}),(s==null?void 0:s.animationMode)==="auto"&&(this._destinationViewState.copy(this.view.state),this._destinationViewState.viewpoint=r,sit(this._transition.animation,s,this.view.state,this._destinationViewState)||this._transition.update(this.viewpoint,r,{duration:0}));const o=()=>{this.animation===e&&this._updateTask&&(e.state==="finished"&&(this._transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return e.when(o,o),this._startTime=performance.now(),this._updateTask.resume(),this.animation=e,e}animateContinuous(e,i){this.stop(),this.updateFunction=i,this.viewpoint=e;const s=new yq({target:e.clone()}),n=()=>{this.animation===s&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return s.when(n,n),this._startTime=performance.now(),this._updateTask.resume(),this.animation=s,s}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(e){var s,n;const i=this.animation;if(i&&i.state!==yq.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,e.deltaTime),(s=this.animation)==null||s.update(this.viewpoint);else{const r=performance.now()-this._startTime,o=this._transition.duration,a=o>0?r/o:1,l=a>=1;this._transition.applyRatio(this.viewpoint,a),l&&((n=this.animation)==null||n.finish())}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};function sit(t,e,i,s){if((e==null?void 0:e.duration)!=null)return!0;const{time:n,isLinear:r}=t,o=(e==null?void 0:e.speedFactor)||1;if(n>((e==null?void 0:e.maxDuration)??a1e.maxDuration/o))return!1;if(r){const l=Tr(),u=oa(...s.toScreen(l,...i.center)),c=oa(...i.toScreen(l,...s.center)),h=c!=null&&c.x>-1*i.size[0]&&c.x<(1.5+.5)*i.size[0]&&c.y>-1*i.size[1]&&c.y<(1.5+.5)*i.size[1],d=u!=null&&u.x>-1*s.size[0]&&u.x<(1.5+.5)*s.size[0]&&u.y>-1*s.size[1]&&u.y<(1.5+.5)*s.size[1];if(n>eit/o&&!h&&!d)return!1}return!0}y([S()],Ob.prototype,"easing",void 0),y([S()],Ob.prototype,"view",void 0),y([S()],Ob.prototype,"viewpoint",void 0),Ob=y([se("esri.views.2d.AnimationManager")],Ob);const nit=Ob;function Hn(){return Promise.all([_e(()=>import("./webglDeps-BX2hQHdt.js"),__vite__mapDeps([185,162,15,186,187,188])),_e(()=>import("./mapViewDeps-B8Sv5yJ7.js"),__vite__mapDeps([189,127,94,95,14,15,96,97,98,99,93,66,190,102,191,186,162,187,166,142,192,119,193,149,148,106,13,16,100,108,194,103,104,105,195,34,147,185,188,196,114,197,92,45,41,47,6,198,155,156,140,164,199,82,200,107,201,202,101,203,71,111,90,204,205,206,207,158,208]))])}const eC=()=>Hn().then(()=>_e(()=>import("./TileLayerView2D-BxGm8bHx.js"),__vite__mapDeps([209,127,98,94,95,14,15,96,97,99,93,66,195,34,193,192,187,162,119,149,148,106,13,16,147,196,191,186,166,142,190,102,100,108,114,197,92,45,41,47,6,82,103,104,105,155,156,140,203,71,111,90,210,211,207,212,181,213,205,206,214,215,216,217,218,219]))),A0=()=>Hn().then(()=>_e(()=>import("./FeatureLayerView2D-CfEplTLd.js").then(t=>t.F),__vite__mapDeps([220,193,13,14,15,16,221,222,223,45,41,50,212,181,206,94,95,96,97,98,99,93,66,186,162,207,192,187,119,149,148,106,190,102,191,166,142,100,108,114,194,224,113,216,219,214]))),Nne={"base-dynamic":()=>Hn().then(()=>_e(()=>import("./BaseDynamicLayerView2D-CYXEpEWM.js"),__vite__mapDeps([225,226,192,93,66,187,162,15,119,193,149,148,106,13,14,16,211,191,186,166,142,102,212,181,227,214]))),"base-tile":eC,"bing-maps":eC,catalog:()=>Hn().then(()=>_e(()=>import("./CatalogLayerView2D-DCSCu9eM.js"),__vite__mapDeps([228,212,193,181]))),"catalog-dynamic-group":()=>Hn().then(()=>_e(()=>import("./CatalogDynamicGroupLayerView2D-BPe3gET7.js"),__vite__mapDeps([229,212,193,181]))),"catalog-footprint":()=>Hn().then(()=>_e(()=>import("./CatalogFootprintLayerView2D-BuQriAiO.js"),__vite__mapDeps([230,220,193,13,14,15,16,221,222,223,45,41,50,212,181,206,94,95,96,97,98,99,93,66,186,162,207,192,187,119,149,148,106,190,102,191,166,142,100,108,114,194,224,113,216,219,214]))),csv:A0,"geo-rss":()=>Hn().then(()=>_e(()=>import("./GeoRSSLayerView2D-CRO-MX_X.js"),__vite__mapDeps([231,212,193,181,204,205,206,94,95,14,15,96,97,98,99,93,66,186,162,207,192,187,119,149,148,106,13,16,190,102,191,166,142,100,108,203,195,127,34,92,45,41,47,6,71,111,90]))),feature:A0,geojson:A0,parquet:A0,graphics:()=>Hn().then(()=>_e(()=>import("./GraphicsLayerView2D-D1ho31HK.js"),__vite__mapDeps([232,212,193,181,204,205,206,94,95,14,15,96,97,98,99,93,66,186,162,207,192,187,119,149,148,106,13,16,190,102,191,166,142,100,108,203,195,127,34,92,45,41,47,6,71,111,90]))),group:()=>Hn().then(()=>_e(()=>import("./GroupLayerView2D-BahE_3fb.js"),__vite__mapDeps([233,212,193,181]))),imagery:()=>Hn().then(()=>_e(()=>import("./ImageryLayerView2D-oMWw0PLx.js"),__vite__mapDeps([234,235,162,15,66,125,192,93,187,119,193,149,148,106,13,14,16,212,181,203,94,95,96,97,98,99,195,127,34,92,45,41,47,6,190,102,191,186,166,142,100,108,71,111,90,213,205,206,207,226,211,227,129,221,219,214]))),"imagery-tile":()=>Hn().then(()=>_e(()=>import("./ImageryTileLayerView2D-DqGx-3ZA.js"),__vite__mapDeps([236,237,235,162,15,66,125,192,93,187,119,193,149,148,106,13,14,16,212,181,238,201,105,186,207,239,129,221,219,214]))),kml:()=>Hn().then(()=>_e(()=>import("./KMLLayerView2D-DTGtfYJt.js"),__vite__mapDeps([240,241,211,193,191,186,162,15,187,166,142,102,226,192,93,66,119,149,148,106,13,14,16,212,181,204,205,206,94,95,96,97,98,99,207,190,100,108,203,195,127,34,92,45,41,47,6,71,111,90,129,201,105,198,185,188,155,156,140,197,164,238]))),"knowledge-graph":()=>Hn().then(()=>_e(()=>import("./KnowledgeGraphLayerView2D-BG3iVlX0.js"),__vite__mapDeps([242,212,193,181]))),"link-chart":()=>Hn().then(()=>_e(()=>import("./KnowledgeGraphLayerView2D-BG3iVlX0.js"),__vite__mapDeps([242,212,193,181]))),"knowledge-graph-sublayer":A0,"map-image":()=>Hn().then(()=>_e(()=>import("./MapImageLayerView2D-C-AptPTT.js"),__vite__mapDeps([243,226,192,93,66,187,162,15,119,193,149,148,106,13,14,16,211,191,186,166,142,102,212,181,203,94,95,96,97,98,99,195,127,34,92,45,41,47,6,190,100,108,71,111,90,213,205,206,207,227,244,216,218,221,214,215,217,219]))),"map-notes":()=>Hn().then(()=>_e(()=>import("./MapNotesLayerView2D-Bw8DJ6hY.js"),__vite__mapDeps([245,212,193,181,204,205,206,94,95,14,15,96,97,98,99,93,66,186,162,207,192,187,119,149,148,106,13,16,190,102,191,166,142,100,108,203,195,127,34,92,45,41,47,6,71,111,90]))),media:()=>Hn().then(()=>_e(()=>import("./MediaLayerView2D-BSwb8WEm.js"),__vite__mapDeps([246,247,111,71,127,98,94,95,14,15,96,97,99,93,66,195,34,193,192,187,162,119,149,148,106,13,16,147,196,191,186,166,142,190,102,100,108,114,197,92,45,41,47,6,82,103,104,105,155,156,140,203,90,200,107,248,202,212,181]))),"ogc-feature":()=>Hn().then(()=>_e(()=>import("./OGCFeatureLayerView2D-D82TqbPM.js"),__vite__mapDeps([249,220,193,13,14,15,16,221,222,223,45,41,50,212,181,206,94,95,96,97,98,99,93,66,186,162,207,192,187,119,149,148,106,190,102,191,166,142,100,108,114,194,224,113,216,219,214]))),"open-street-map":eC,"oriented-imagery":A0,route:()=>Hn().then(()=>_e(()=>import("./RouteLayerView2D-CIqMvkVy.js"),__vite__mapDeps([250,251,252,212,193,181,204,205,206,94,95,14,15,96,97,98,99,93,66,186,162,207,192,187,119,149,148,106,13,16,190,102,191,166,142,100,108,203,195,127,34,92,45,41,47,6,71,111,90]))),stream:()=>Hn().then(()=>_e(()=>import("./StreamLayerView2D-BvAbnBmE.js"),__vite__mapDeps([253,220,193,13,14,15,16,221,222,223,45,41,50,212,181,206,94,95,96,97,98,99,93,66,186,162,207,192,187,119,149,148,106,190,102,191,166,142,100,108,114,194,224,113,216,219,214]))),"subtype-group":()=>Hn().then(()=>_e(()=>import("./SubtypeGroupLayerView2D-BIWR-RgE.js"),__vite__mapDeps([254,220,193,13,14,15,16,221,222,223,45,41,50,212,181,206,94,95,96,97,98,99,93,66,186,162,207,192,187,119,149,148,106,190,102,191,166,142,100,108,114,194,224,113,216,219,214]))),tile:eC,"vector-tile":()=>Hn().then(()=>_e(()=>import("./VectorTileLayerView2D-BzWQqGmd.js"),__vite__mapDeps([255,147,99,82,15,97,98,96,162,148,192,93,66,187,119,193,149,106,13,14,16,207,53,150,151,127,212,181,214]))),video:()=>Hn().then(()=>_e(()=>import("./VideoLayerView2D-Cmqt-Bc1.js"),__vite__mapDeps([256,257,248,119,192,93,66,187,162,15,193,149,148,106,13,14,16,190,94,95,96,97,98,99,102,191,186,166,142,100,108,202,212,181,204,205,206,207,203,195,127,34,92,45,41,47,6,71,111,90]))),wcs:()=>Hn().then(()=>_e(()=>import("./ImageryTileLayerView2D-DqGx-3ZA.js"),__vite__mapDeps([236,237,235,162,15,66,125,192,93,187,119,193,149,148,106,13,14,16,212,181,238,201,105,186,207,239,129,221,219,214]))),"web-tile":eC,wfs:A0,wms:()=>Hn().then(()=>_e(()=>import("./WMSLayerView2D-oaZeh1hD.js"),__vite__mapDeps([258,226,192,93,66,187,162,15,119,193,149,148,106,13,14,16,211,191,186,166,142,102,212,181,227,214,259,221]))),wmts:()=>Hn().then(()=>_e(()=>import("./WMTSLayerView2D-DU7T3HEv.js"),__vite__mapDeps([260,210,211,193,191,186,162,15,187,166,142,102,192,93,66,119,149,148,106,13,14,16,207,212,181,214]))),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"integrated-mesh-3dtiles":null,"point-cloud":null,viewshed:null,voxel:null,scene:null,unknown:null,unsupported:null};function rit(t){const e=t.declaredClass?t.declaredClass.slice(t.declaredClass.lastIndexOf(".")+1):"Unknown",i=e.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new Se(`${i}:view-not-supported`,`${e} is not supported in 2D`)}const Rne={hasLayerViewModule:t=>Nne[t.type]!=null,importLayerView:t=>{const e=Nne[t.type];if(e==null)throw rit(t);return e(t)}};let Iy=class ov{static getId(e,i,s,n){return typeof e=="object"?`${e.level}/${e.row}/${e.col}/${e.world}`:`${e}/${i}/${s}/${n}`}constructor(e,i,s,n){this.set(e,i,s,n)}get key(){return this}get id(){return this.toString()}get normalizedId(){return`${this.level}/${this.row}/${this.col}`}set id(e){this.set(e)}get hash(){const e=4095&this.row,i=4095&this.col,s=63&this.level;return(3&this.world)<<30|i<<22|e<<8|s}acquire(e,i,s,n){this.set(e,i,s,n)}contains(e){const i=e.level-this.level;return i>=0&&this.row===e.row>>i&&this.col===e.col>>i&&this.world===e.world}containsChild(e){const i=e.level-this.level;return i>0&&this.row===e.row>>i&&this.col===e.col>>i&&this.world===e.world}equals(e){return this.level===e.level&&this.row===e.row&&this.col===e.col&&this.world===e.world}clone(){return new ov(this)}release(){this.level=0,this.row=0,this.col=0,this.world=0}set(e,i,s,n){if(e==null)this.level=0,this.row=0,this.col=0,this.world=0;else if(typeof e=="object")this.level=e.level||0,this.row=e.row||0,this.col=e.col||0,this.world=e.world||0;else if(typeof e=="string"){const[r,o,a,l]=e.split("/");this.level=parseFloat(r),this.row=parseFloat(o),this.col=parseFloat(a),this.world=parseFloat(l)}else this.level=+e,this.row=+i,this.col=+s,this.world=+n||0;return this}toString(){return`${this.level}/${this.row}/${this.col}/${this.world}`}getParentKey(){return this.level<=0?null:new ov(this.level-1,this.row>>1,this.col>>1,this.world)}getNormalizedNeighbor(e,i,s){const n=this.clone();return n.col+=e,n.row+=i,s.normalizeKey(n),n}getChildKeys(){const e=this.level+1,i=this.row<<1,s=this.col<<1,n=this.world;return[new ov(e,i,s,n),new ov(e,i,s+1,n),new ov(e,i+1,s,n),new ov(e,i+1,s+1,n)]}compareRowMajor(e){return this.row<e.row?-1:this.row>e.row?1:this.col<e.col?-1:this.col>e.col?1:0}};Iy.pool=new F1(Iy,null,null,25,50);function lb(t,e){return[t,e]}function I0(t,e,i){return t[0]=e,t[1]=i,t}function oit(t,e,i,s,n){return t[0]=e,t[1]=i,t[2]=s,t[3]=n,t}const Oh=new Iy("0/0/0/0");let ait=class u1e{static create(e,i,s=null){const n=Ol(e.spatialReference),r=i.origin||lb(e.origin.x,e.origin.y),o=lb(e.size[0]*i.resolution,e.size[1]*i.resolution),a=lb(-1/0,-1/0),l=lb(1/0,1/0),u=lb(1/0,1/0);s!=null&&(I0(a,Math.max(0,Math.floor((s.xmin-r[0])/o[0])),Math.max(0,Math.floor((r[1]-s.ymax)/o[1]))),I0(l,Math.max(0,Math.floor((s.xmax-r[0])/o[0])),Math.max(0,Math.floor((r[1]-s.ymin)/o[1]))),I0(u,l[0]-a[0]+1,l[1]-a[1]+1));const{cols:c,rows:h}=i;let d,m,f,_;return!s&&c&&h&&(I0(a,c[0],h[0]),I0(l,c[1],h[1]),I0(u,c[1]-c[0]+1,h[1]-h[0]+1)),e.isWrappable?(d=lb(Math.ceil(Math.round((n.valid[1]-n.valid[0])/i.resolution)/e.size[0]),u[1]),m=!0,f=n.origin,_=n.valid):(d=u,m=!1),new u1e(i.level,i.resolution,i.scale,r,a,l,u,o,d,m,f,_)}constructor(e,i,s,n,r,o,a,l,u,c,h,d){this.level=e,this.resolution=i,this.scale=s,this.origin=n,this.first=r,this.last=o,this.size=a,this.norm=l,this.worldSize=u,this.wrap=c,this._spatialReferenceOrigin=h,this._spatialReferenceValid=d}normalizeCol(e){if(!this.wrap)return e;const i=this.worldSize[0];return e<0?i-1-Math.abs((e+1)%i):e%i}normalizeKey(e){if(!this.wrap)return;const i=this.worldSize[0],s=e.col;s<0?(e.col=s+i,e.world-=1):s>=i&&(e.col=s-i,e.world+=1)}denormalizeCol(e,i){return this.wrap?this.worldSize[0]*i+e:e}getWorldForColumn(e){return this.wrap?Math.floor(e/this.worldSize[0]):0}getFirstColumnForWorld(e){return e*this.worldSize[0]+this.first[0]}getLastColumnForWorld(e){return e*this.worldSize[0]+this.first[0]+this.size[0]-1}getColumnForX(e){return(e-this.origin[0])/this.norm[0]}getXForColumn(e){const i=this.origin[0]+e*this.norm[0],s=this._spatialReferenceOrigin,n=this._spatialReferenceValid;return this.wrap&&s&&n?i===s[0]?n[0]:this.origin[0]===s[0]&&e===this.worldSize[0]?n[1]:i:i}getRowForY(e){return(this.origin[1]-e)/this.norm[1]}getYForRow(e){return this.origin[1]-e*this.norm[1]}getTileBounds(e,i,s=!1){Oh.set(i);const n=s?Oh.col:this.denormalizeCol(Oh.col,Oh.world),r=Oh.row;return oit(e,this.getXForColumn(n),this.getYForRow(r+1),this.getXForColumn(n+1),this.getYForRow(r)),e}getTileCoords(e,i,s=!1){Oh.set(i);const n=s?Oh.col:this.denormalizeCol(Oh.col,Oh.world);return Array.isArray(e)?I0(e,this.getXForColumn(n),this.getYForRow(Oh.row)):(e.x=this.getXForColumn(n),e.y=this.getYForRow(Oh.row)),e}},SM=class{constructor(){this.spans=[]}acquire(e){this.lodInfo=e}release(){this.lodInfo=null,this.spans.length=0}*keys(){const e=this.lodInfo;for(const{row:i,colFrom:s,colTo:n}of this.spans)for(let r=s;r<=n;r++){const o=e.getWorldForColumn(r);yield new Iy(e.level,i,e.normalizeCol(r),o)}}forEach(e,i){const{spans:s,lodInfo:n}=this,{level:r}=n;if(s.length!==0)for(const{row:o,colFrom:a,colTo:l}of s)for(let u=a;u<=l;u++)e.call(i,r,o,n.normalizeCol(u),n.getWorldForColumn(u))}};SM.pool=new F1(SM);let mV=class{constructor(e,i,s){this.row=e,this.colFrom=i,this.colTo=s}};const Xn=new Iy("0/0/0/0");let lit=class c1e{static create(e,i){e[1]>i[1]&&([e,i]=[i,e]);const[s,n]=e,[r,o]=i,a=r-s,l=o-n,u=l!==0?a/l:0,c=(Math.ceil(n)-n)*u,h=(Math.floor(n)-n)*u;return new c1e(s,Math.floor(n),Math.ceil(o),u,a<0?c:h,a<0?h:c,a<0?r:s,a<0?s:r)}constructor(e,i,s,n,r,o,a,l){this.x=e,this.ymin=i,this.ymax=s,this.invM=n,this.leftAdjust=r,this.rightAdjust=o,this.leftBound=a,this.rightBound=l}incrRow(){this.x+=this.invM}getLeftCol(){return Math.max(this.x+this.leftAdjust,this.leftBound)}getRightCol(){return Math.min(this.x+this.rightAdjust,this.rightBound)}};const zu=[[0,0],[0,0],[0,0],[0,0]],uit=1e-6;let cit=class{constructor(e,i=null,s=e.lods[0].level,n=e.lods[e.lods.length-1].level){this.tileInfo=e,this.fullExtent=i,this.scales=[],this._infoByScale={},this._infoByLevel={};const r=e.lods.filter(a=>a.level>=s&&a.level<=n);this.minScale=r[0].scale,this.maxScale=r[r.length-1].scale;const o=this._lodInfos=r.map(a=>ait.create(e,a,i));r.forEach((a,l)=>{this._infoByLevel[a.level]=o[l],this._infoByScale[a.scale]=o[l],this.scales[l]=a.scale},this),this._wrap=e.isWrappable}get spatialReference(){return this.tileInfo.spatialReference}getLODInfoAt(e){return this._infoByLevel[typeof e=="number"?e:e.level]}getTileBounds(e,i,s=!1){Xn.set(i);const n=this._infoByLevel[Xn.level];return n?n.getTileBounds(e,Xn,s):e}getTileCoords(e,i,s=!1){Xn.set(i);const n=this._infoByLevel[Xn.level];return n?n.getTileCoords(e,Xn,s):e}getTileCoverage(e,i=192,s=!0,n="closest"){if(!s&&(e.scale>this.minScale||e.scale<this.maxScale))return null;const r=n==="closest"?this.getClosestInfoForScale(e.scale):this.getSmallestInfoForScale(e.scale),o=SM.pool.acquire(r),a=this._wrap;let l,u,c,h=1/0,d=-1/0;const m=o.spans;zu[0][0]=zu[0][1]=zu[1][1]=zu[3][0]=-i,zu[1][0]=zu[2][0]=e.size[0]+i,zu[2][1]=zu[3][1]=e.size[1]+i;for(const x of zu)e.toMap(x,x),x[0]=r.getColumnForX(x[0]),x[1]=r.getRowForY(x[1]);const f=[];let _=3;for(let x=0;x<4;x++){if(zu[x][1]===zu[_][1]){_=x;continue}const w=lit.create(zu[x],zu[_]);h=Math.min(w.ymin,h),d=Math.max(w.ymax,d),f[w.ymin]===void 0&&(f[w.ymin]=[]),f[w.ymin].push(w),_=x}if(h==null||d==null||d-h>100)return null;let v=[];for(l=h;l<d;){f[l]!=null&&(v=v.concat(f[l])),u=1/0,c=-1/0;for(let x=v.length-1;x>=0;x--){const w=v[x];u=Math.min(u,w.getLeftCol()),c=Math.max(c,w.getRightCol())}if(u=Math.floor(u),c=Math.floor(c),l>=r.first[1]&&l<=r.last[1])if(a)if(r.size[0]<r.worldSize[0]){const x=Math.floor(c/r.worldSize[0]);for(let w=Math.floor(u/r.worldSize[0]);w<=x;w++)m.push(new mV(l,Math.max(r.getFirstColumnForWorld(w),u),Math.min(r.getLastColumnForWorld(w),c)))}else m.push(new mV(l,u,c));else u>r.last[0]||c<r.first[0]||(u=Math.max(u,r.first[0]),c=Math.min(c,r.last[0]),m.push(new mV(l,u,c)));l+=1;for(let x=v.length-1;x>=0;x--){const w=v[x];w.ymax>=l?w.incrRow():v.splice(x,1)}}return o}getTileParentId(e){Xn.set(e);const i=this._infoByLevel[Xn.level],s=this._lodInfos.indexOf(i)-1;return s<0?null:(this._getTileIdAtLOD(Xn,this._lodInfos[s],Xn),Xn.id)}getTileResolution(e){const i=this._infoByLevel[typeof e=="object"?e.level:e];return i?i.resolution:-1}getTileScale(e){const i=this._infoByLevel[e.level];return i?i.scale:-1}intersects(e,i){Xn.set(i);const s=this._infoByLevel[Xn.level],n=e.lodInfo;if(n.resolution>s.resolution){this._getTileIdAtLOD(Xn,n,Xn);const o=n.denormalizeCol(Xn.col,Xn.world);for(const a of e.spans)if(a.row===Xn.row&&a.colFrom<=o&&a.colTo>=o)return!0}if(n.resolution<s.resolution){const[o,a,l,u]=e.spans.reduce((_,v)=>(_[0]=Math.min(_[0],v.row),_[1]=Math.max(_[1],v.row),_[2]=Math.min(_[2],v.colFrom),_[3]=Math.max(_[3],v.colTo),_),[1/0,-1/0,1/0,-1/0]),c=s.denormalizeCol(Xn.col,Xn.world),h=n.getColumnForX(s.getXForColumn(c)),d=n.getRowForY(s.getYForRow(Xn.row)),m=n.getColumnForX(s.getXForColumn(c+1))-1,f=n.getRowForY(s.getYForRow(Xn.row+1))-1;return!(h>u||m<l||d>a||f<o)}const r=n.denormalizeCol(Xn.col,Xn.world);return e.spans.some(o=>o.row===Xn.row&&o.colFrom<=r&&o.colTo>=r)}normalizeBounds(e,i,s){if(e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],this._wrap){const n=Ol(this.tileInfo.spatialReference),r=-s*(n.valid[1]-n.valid[0]);e[0]+=r,e[2]+=r}return e}getSmallestInfoForScale(e){const i=this.scales;if(this._infoByScale[e])return this._infoByScale[e];if(e>i[0])return this._infoByScale[i[0]];for(let s=1;s<i.length-1;s++)if(e>i[s]+uit)return this._infoByScale[i[s-1]];return this._infoByScale[i[i.length-1]]}getClosestInfoForScale(e){const i=this.scales;return this._infoByScale[e]||(e=i.reduce((s,n)=>Math.abs(n-e)<Math.abs(s-e)?n:s,i[0])),this._infoByScale[e]}scaleToLevel(e){const i=this.scales;if(this._infoByScale[e])return this._infoByScale[e].level;for(let s=i.length-1;s>=0;s--)if(e<i[s])return s===i.length-1?this._infoByScale[i[i.length-1]].level:this._infoByScale[i[s]].level+(i[s]-e)/(i[s]-i[s+1]);return this._infoByScale[i[0]].level}scaleToZoom(e){return this.tileInfo.scaleToZoom(e)}zoomToScale(e){return this.tileInfo.zoomToScale(e)}_getTileIdAtLOD(e,i,s){const n=this._infoByLevel[s.level];return e.set(s),i.resolution<n.resolution?null:(i.resolution===n.resolution||(e.level=i.level,e.col=Math.floor(s.col*n.resolution/i.resolution+.01),e.row=Math.floor(s.row*n.resolution/i.resolution+.01)),e)}},hit=class{constructor(e,i){this.item=e,this.controller=i,this.promise=null}},dit=class{constructor(e){this._schedule=null,this._task=null,this._deferreds=new I3,this._controllers=new I3,this._processingItems=new I3,this._pausedSignal=DS(!1),this.concurrency=1,e.concurrency&&(this.concurrency=e.concurrency),this._queue=new RL(e.peeker),this.process=e.process;const i=e.scheduler;e.priority&&i&&(this._task=i.registerTask(e.priority,this))}destroy(){this.clear(),this._schedule=sr(this._schedule),this._task=sr(this._task)}get updating(){var e;return!!((e=this._task)!=null&&e.updating)||this.running}get length(){return this._processingItems.size+this._queue.length}abort(e){const i=this._controllers.get(e);i&&i.abort()}clear(){this._queue.clear();const e=[];this._controllers.forEach(i=>e.push(i)),this._controllers.clear(),e.forEach(i=>i.abort()),this._processingItems.clear(),this._cancelNext()}forEach(e){this._deferreds.forEach((i,s)=>e(s))}get(e){const i=this._deferreds.get(e);return i?i.promise:void 0}isOngoing(e){return this._processingItems.has(e)}has(e){return this._deferreds.has(e)}pause(){this._pausedSignal.value||(this._pausedSignal.value=!0,this._cancelNext())}push(e,i){const s=this.get(e);if(s)return s;const n=new AbortController;let r=null;i&&(r=Jc(i,()=>n.abort()));const o=()=>{const c=this._processingItems.get(e);c&&c.controller.abort(),a(),u.reject(Vn())},a=()=>{l.remove(),r!=null&&r.remove(),this._removeItem(e),this._queue.remove(e),this._scheduleNext()},l=hH(n.signal,o),u=mc();return this._deferreds.set(e,u),this._controllers.set(e,n),u.promise.then(a,a),this._queue.push(e),this._scheduleNext(),u.promise}last(){return this._queue.last()}lastPromise(){const e=this.last();return e?this.get(e):null}peek(){return this._queue.peek()}popLast(){var i;const e=this._queue.popLast();return e&&((i=this._deferreds.get(e))==null||i.reject(Vn()),this._removeItem(e)),e}reset(){const e=Array.from(this._processingItems.values());this._processingItems.clear();for(const i of e)this._queue.push(i.item),i.controller.abort();this._scheduleNext()}resume(){this._pausedSignal.value&&(this._pausedSignal.value=!1,this._scheduleNext())}takeAll(){const e=[];for(;this._queue.length;)e.push(this._queue.pop());return this.clear(),e}get running(){return!this._pausedSignal.value&&this._queue.length>0&&this._processingItems.size<this.concurrency}runTask(e){for(;!e.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),e.madeProgress()}_removeItem(e){this._deferreds.delete(e),this._controllers.delete(e),this._processingItems.delete(e)}_scheduleNext(){this._task||this._pausedSignal.value||this._schedule||(this._schedule=VM(()=>{this._schedule=null,this._next()}))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(e,i){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).resolve(i))}_processError(e,i){this._canProcessFulfillment(e)&&(this._scheduleNext(),this._deferreds.get(e.item).reject(i))}_canProcessFulfillment(e){return!!this._deferreds.get(e.item)&&this._processingItems.get(e.item)===e}_process(e){if(e==null)return;let i;const s=new AbortController,n=new hit(e,s);this._processingItems.set(e,n);try{i=this.process(e,s.signal)}catch(r){this._processError(n,r)}Hm(i)?(n.promise=i,i.then(r=>this._processResult(n,r),r=>this._processError(n,r))):this._processResult(n,i)}get test(){}};const One=[0,0];let Wp=class extends ei{constructor(e){super(e),this._keyToItem=new Map,this._tilesByScale=new Map,this.concurrency=6}initialize(){const{concurrency:e,process:i,scheduler:s,priority:n}=this;this._queue=new dit({concurrency:e,scheduler:s,priority:n,process:(r,o)=>{const a=this._keyToItem.get(r);return i(a,{signal:o})},peeker:r=>this._peek(r)})}destroy(){this.clear(),this._queue=er(this._queue)}get length(){return this._queue?this._queue.length:0}abort(e){const i=typeof e=="string"?e:e.id;this._queue.abort(i)}clear(){this._queue.clear(),this._keyToItem.clear(),this._tilesByScale.clear()}has(e){return typeof e=="string"?this._keyToItem.has(e):this._keyToItem.has(e.id)}pause(){this._queue.pause()}push(e){const i=e.key.id;if(this._queue.has(i))return this._queue.get(i);const s=this._queue.push(i),n=this.tileInfoView.getTileScale(e.key),r=RM(this._tilesByScale,n,()=>new Set),o=()=>{r.delete(e.key),r.size===0&&this._tilesByScale.delete(n),this._keyToItem.delete(i)};return r.add(e.key),this._keyToItem.set(i,e),s.then(o,o),s}reset(){this._queue.reset()}resume(){this._queue.resume()}_peek(e){if(!this.state)return e.values().next().value;const i=new Set;for(const o of e)i.add(this._keyToItem.get(o).key);const s=this.state.scale;let n,r=Number.POSITIVE_INFINITY;for(const[o,a]of this._tilesByScale)if(Oue(a,l=>i.has(l))){const l=Math.abs(o-s);l<r&&(n=a,r=l)}return this._getClosestTileKey(n,e).id}_getClosestTileKey(e,i){const s=this.tileInfoView,n=this.state.center;let r,o=Number.POSITIVE_INFINITY;for(const a of e)if(i.has(a.id)){s.getTileCoords(One,a);const l=K4(One,n);l<o&&(o=l,r=a)}return r}};y([S({constructOnly:!0})],Wp.prototype,"concurrency",void 0),y([S({constructOnly:!0})],Wp.prototype,"priority",void 0),y([S({constructOnly:!0})],Wp.prototype,"process",void 0),y([S({constructOnly:!0})],Wp.prototype,"scheduler",void 0),y([S()],Wp.prototype,"state",void 0),y([S({constructOnly:!0})],Wp.prototype,"tileInfoView",void 0),Wp=y([se("esri.views.2d.tiling.TileQueue")],Wp);const J1t=Wp;let mit=class{constructor(e,i,s){this.maxSize=e,this._tileInfoView=i,this._removedFunc=s,this._tilePerId=new Map,this._tileKeysPerLevel=[]}clear(){this._tilePerId.clear(),this._tileKeysPerLevel=[]}has(e){return this._tilePerId.has(e)}get(e){return this._tilePerId.get(e)}pop(e){const i=this._tilePerId.get(e);if(!i)return;const s=i.key.level,n=this._tileKeysPerLevel[s];Lne(this._tilePerId,e);for(let r=0;r<n.length;r++)if(n[r].id===e){n.splice(r,1);break}return i.visible=!0,i}add(e){e.visible=!1;const i=e.key,s=i.id;if(this._tilePerId.has(s))return;this._tilePerId.set(s,e);const n=i.level;this._tileKeysPerLevel[n]||(this._tileKeysPerLevel[n]=[]),this._tileKeysPerLevel[n].push(i)}prune(e,i,s){let n=this._tilePerId.size;if(n<=this.maxSize)return;let r=this._tileKeysPerLevel.length-1;for(;n>this.maxSize&&r>=0;)r!==e&&(n=this._pruneAroundCenterTile(n,i,s,r)),r--;n>this.maxSize&&(n=this._pruneAroundCenterTile(n,i,s,e))}_pruneAroundCenterTile(e,i,s,n){const r=this._tileKeysPerLevel[n];if(!r||r.length===0)return e;const{size:o,origin:a}=this._tileInfoView.tileInfo,l=s*o[0],u=s*o[1],c=[0,0],h=[0,0];for(r.sort((d,m)=>(c[0]=a.x+l*(d.col+.5),c[1]=a.y-u*(d.row+.5),h[0]=a.x+l*(m.col+.5),h[1]=a.y-u*(m.row+.5),GL(c,i)-GL(h,i)));r.length>0;){const d=r.pop();if(this._removeTile(d.id),--e===this.maxSize)break}return e}_removeTile(e){const i=this._tilePerId.get(e);this._removedFunc&&i&&this._removedFunc(i),Lne(this._tilePerId,e)}};function Lne(t,e){t.delete(e)}const D0=new Iy(0,0,0,0),Dp=new Map,tC=[],pV=[];let txt=class{constructor(e){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,e.resampling!=null&&(this.resampling=e.resampling),e.cachePolicy&&(this.cachePolicy=e.cachePolicy),e.coveragePolicy&&(this.coveragePolicy=e.coveragePolicy),e.buffer!=null&&(this.buffer=e.buffer),e.cacheSize&&(this._tileCache=new mit(e.cacheSize,this.tileInfoView,i=>{this.releaseTile(i)}))}destroy(){this.tileIndex.clear()}update(e){var x,w;const{resampling:i,tileIndex:s}=this,{scale:n,center:r,resolution:o}=e.state,{minScale:a,maxScale:l}=this.tileInfoView,u=!e.stationary&&n>this._previousScale;if(this._previousScale=n,!i&&(n>a||n<l))return this.tiles.length=0,void this.clear();const c=this.tileInfoView.getTileCoverage(e.state,this.buffer,this.resampling,this.coveragePolicy);if(!c)return this.tiles.length=0,void this.clear();const{spans:h,lodInfo:d}=c,{level:m}=d;this.tiles.length=0,s.forEach(T=>T.visible=!0);let f=0,_=0;if(h.length>0)for(const{row:T,colFrom:C,colTo:M}of h)for(let A=C;A<=M;A++){f++;const I=D0.set(m,T,d.normalizeCol(A),d.getWorldForColumn(A)).id;let L=s.get(I);if(L)L.isReady?(Dp.set(I,L),_++):u||this._addParentTile(I,Dp);else{if((x=this._tileCache)!=null&&x.has(I)){if(L=this._tileCache.pop(I),this.tileIndex.set(I,L),L.isReady){Dp.set(I,L),_++;continue}}else L=this.acquireTile(D0),this.tileIndex.set(I,L);u||this._addParentTile(I,Dp)}}const v=_===f;for(const[T,C]of s){if(Dp.has(T))continue;D0.set(T);const M=this.tileInfoView.intersects(c,D0),A=this.cachePolicy==="purge"?D0.level!==m:D0.level>m;!M||!u&&v?!A&&M||tC.push(C):C.isReady?A&&this.cachePolicy==="purge"&&this._hasReadyAncestor(D0,m)?tC.push(C):pV.push(C):A&&tC.push(C)}for(const T of pV)T.isReady&&Dp.set(T.key.id,T);for(const T of tC)this._tileCache?this._tileCache.add(T):this.releaseTile(T),s.delete(T.key.id);for(const T of Dp.values())this.tiles.push(T);for(const T of s.values())Dp.has(T.key.id)||(T.visible=!1);(w=this._tileCache)==null||w.prune(m,r,o),SM.pool.release(c),pV.length=0,tC.length=0,Dp.clear()}clear(){const{tileIndex:e}=this;for(const i of e.values())this.releaseTile(i);e.clear()}refresh(e){var i;for(const s of this.tileIndex.values())e(s);(i=this._tileCache)==null||i.clear()}updateCacheSize(e){this._tileCache&&(this._tileCache.maxSize=e)}_addParentTile(e,i){var r;let s=e,n=null;for(;s=this.tileInfoView.getTileParentId(s),s;)if(this.tileIndex.has(s)){if(n=this.tileIndex.get(s),n==null?void 0:n.isReady){i.has(n.key.id)||i.set(n.key.id,n);break}}else if((r=this._tileCache)!=null&&r.has(s)&&(n=this._tileCache.pop(s),this.tileIndex.set(s,n),n==null?void 0:n.isReady)){i.has(n.key.id)||i.set(n.key.id,n);break}}_hasReadyAncestor(e,i){const s=Dl();this.tileInfoView.getTileBounds(s,e,!0);for(const n of this.tileIndex.values())if(n.isReady&&n.key.level>=i&&n.key.level<e.level){const r=Dl();if(this.tileInfoView.getTileBounds(r,n.key,!0),jPe(r,s))return!0}return!1}};function pit(t,e,i,s,n){h1e(t,e,i||0,s||t.length-1,n||fit)}function h1e(t,e,i,s,n){for(;s>i;){if(s-i>600){var r=s-i+1,o=e-i+1,a=Math.log(r),l=.5*Math.exp(2*a/3),u=.5*Math.sqrt(a*l*(r-l)/r)*(o-r/2<0?-1:1);h1e(t,e,Math.max(i,Math.floor(e-o*l/r+u)),Math.min(s,Math.floor(e+(r-o)*l/r+u)),n)}var c=t[e],h=i,d=s;for(iC(t,i,e),n(t[s],c)>0&&iC(t,i,s);h<d;){for(iC(t,h,d),h++,d--;n(t[h],c)<0;)h++;for(;n(t[d],c)>0;)d--}n(t[i],c)===0?iC(t,i,d):iC(t,++d,s),d<=e&&(i=d+1),e<=d&&(s=d-1)}}function iC(t,e,i){var s=t[e];t[e]=t[i],t[i]=s}function fit(t,e){return t<e?-1:t>e?1:0}function YL(t,e){if(!(this instanceof YL))return new YL(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&(typeof e=="function"?this.toBBox=e:this._initFormat(e)),this.clear()}function git(t,e,i){if(!i)return e.indexOf(t);for(var s=0;s<e.length;s++)if(i(t,e[s]))return s;return-1}function ub(t,e){gT(t,0,t.children.length,e,t)}function gT(t,e,i,s,n){n||(n=Lb(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var r,o=e;o<i;o++)r=t.children[o],_T(n,t.leaf?s(r):r);return n}function _T(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function Fne(t,e){return t.minX-e.minX}function kne(t,e){return t.minY-e.minY}function fV(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function KN(t){return t.maxX-t.minX+(t.maxY-t.minY)}function _it(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function yit(t,e){var i=Math.max(t.minX,e.minX),s=Math.max(t.minY,e.minY),n=Math.min(t.maxX,e.maxX),r=Math.min(t.maxY,e.maxY);return Math.max(0,n-i)*Math.max(0,r-s)}function gV(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function QN(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function Lb(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function $ne(t,e,i,s,n){for(var r,o=[e,i];o.length;)(i=o.pop())-(e=o.pop())<=s||(r=e+Math.ceil((i-e)/s/2)*s,pit(t,r,e,i,n),o.push(e,r,r,i))}YL.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],s=this.toBBox;if(!QN(t,e))return i;for(var n,r,o,a,l=[];e;){for(n=0,r=e.children.length;n<r;n++)o=e.children[n],QN(t,a=e.leaf?s(o):o)&&(e.leaf?i.push(o):gV(t,a)?this._all(o,i):l.push(o));e=l.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!QN(t,e))return!1;for(var s,n,r,o,a=[];e;){for(s=0,n=e.children.length;s<n;s++)if(r=e.children[s],QN(t,o=e.leaf?i(r):r)){if(e.leaf||gV(t,o))return!0;a.push(r)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var s=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===s.height)this._splitRoot(this.data,s);else{if(this.data.height<s.height){var n=this.data;this.data=s,s=n}this._insert(s,this.data.height-s.height-1,!0)}else this.data=s;return this},insert:function(t){return t!=null&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=Lb([]),this},remove:function(t,e){if(t==null)return this;for(var i,s,n,r,o=this.data,a=this.toBBox(t),l=[],u=[];o||l.length;){if(o||(o=l.pop(),s=l[l.length-1],i=u.pop(),r=!0),o.leaf&&(n=git(t,o.children,e))!==-1)return o.children.splice(n,1),l.push(o),this._condense(l),this;r||o.leaf||!gV(o,a)?s?(i++,o=s.children[i],r=!1):o=null:(l.push(o),u.push(i),i=0,s=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:Fne,compareMinY:kne,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,s){var n,r=i-e+1,o=this._maxEntries;if(r<=o)return ub(n=Lb(t.slice(e,i+1)),this.toBBox),n;s||(s=Math.ceil(Math.log(r)/Math.log(o)),o=Math.ceil(r/Math.pow(o,s-1))),(n=Lb([])).leaf=!1,n.height=s;var a,l,u,c,h=Math.ceil(r/o),d=h*Math.ceil(Math.sqrt(o));for($ne(t,e,i,d,this.compareMinX),a=e;a<=i;a+=d)for($ne(t,a,u=Math.min(a+d-1,i),h,this.compareMinY),l=a;l<=u;l+=h)c=Math.min(l+h-1,u),n.children.push(this._build(t,l,c,s-1));return ub(n,this.toBBox),n},_chooseSubtree:function(t,e,i,s){for(var n,r,o,a,l,u,c,h;s.push(e),!e.leaf&&s.length-1!==i;){for(c=h=1/0,n=0,r=e.children.length;n<r;n++)l=fV(o=e.children[n]),(u=_it(t,o)-l)<h?(h=u,c=l<c?l:c,a=o):u===h&&l<c&&(c=l,a=o);e=a||e.children[0]}return e},_insert:function(t,e,i){var s=this.toBBox,n=i?t:s(t),r=[],o=this._chooseSubtree(n,this.data,e,r);for(o.children.push(t),_T(o,n);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(n,r,e)},_split:function(t,e){var i=t[e],s=i.children.length,n=this._minEntries;this._chooseSplitAxis(i,n,s);var r=this._chooseSplitIndex(i,n,s),o=Lb(i.children.splice(r,i.children.length-r));o.height=i.height,o.leaf=i.leaf,ub(i,this.toBBox),ub(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(i,o)},_splitRoot:function(t,e){this.data=Lb([t,e]),this.data.height=t.height+1,this.data.leaf=!1,ub(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var s,n,r,o,a,l,u,c;for(l=u=1/0,s=e;s<=i-e;s++)o=yit(n=gT(t,0,s,this.toBBox),r=gT(t,s,i,this.toBBox)),a=fV(n)+fV(r),o<l?(l=o,c=s,u=a<u?a:u):o===l&&a<u&&(u=a,c=s);return c},_chooseSplitAxis:function(t,e,i){var s=t.leaf?this.compareMinX:Fne,n=t.leaf?this.compareMinY:kne;this._allDistMargin(t,e,i,s)<this._allDistMargin(t,e,i,n)&&t.children.sort(s)},_allDistMargin:function(t,e,i,s){t.children.sort(s);var n,r,o=this.toBBox,a=gT(t,0,e,o),l=gT(t,i-e,i,o),u=KN(a)+KN(l);for(n=e;n<i-e;n++)r=t.children[n],_T(a,t.leaf?o(r):r),u+=KN(a);for(n=i-e-1;n>=e;n--)r=t.children[n],_T(l,t.leaf?o(r):r),u+=KN(l);return u},_adjustParentBBoxes:function(t,e,i){for(var s=i;s>=0;s--)_T(e[s],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)t[i].children.length===0?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():ub(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};function vit(t,{timeZone:e,timeExtent:i}){return{$view:{scale:t,timeZone:e,timeProperties:{currentStart:i==null?void 0:i.start,currentEnd:i==null?void 0:i.end}}}}let Une=class d1e{constructor(e,i){this.key=new Iy(0,0,0,0),this.bounds=Dl(),this.objectIds=new Set,this.key.set(i);const s=e.getLODInfoAt(this.key);this.tileInfoView=e,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=s.resolution,this.level=s.level,this.scale=s.scale,this.minScale=e.zoomToScale(s.level-1),this.maxScale=e.zoomToScale(s.level+1)}get lod(){return this.tileInfoView.getLODInfoAt(this.key)}get id(){return this.key.id}get extent(){return qPe(this.bounds,this.tileInfoView.tileInfo.spatialReference)}get transform(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}createArcadeEvaluationOptions(e){return vit(this.scale,e)}createChildTiles(){const e=this.key.getChildKeys(),i=Il.acquire();for(let s=0;s<e.length;s++)i[s]=new d1e(this.tileInfoView,e[s]);return i}getQuantizationParameters(){return F0e.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})}};const N0={added:[],removed:[]},_V=new Set,xit=new Iy(0,0,0,0);function bit(t,e){const i=Ol(e);if(!i)return null;const[s,n]=i.valid;return t[2]>n?[Dl([t[0],t[1],n,t[3]]),Dl([s,t[1],s+t[2]-n,t[3]])]:t[0]<s?[Dl([s,t[1],t[2],t[3]]),Dl([n-(s-t[0]),t[1],n,t[3]])]:null}let wit=class extends vd{constructor(e){super(),this._tiles=new Map,this._index=YL(9,ke("esri-csp-restrictions")?i=>({minX:i.bounds[0],minY:i.bounds[1],maxX:i.bounds[2],maxY:i.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=e}destroy(){this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(e){return this._tiles.has(e)}get(e){return this._tiles.get(e)}getIntersectingTiles(e){if(!e||kH(e)===0||$H(e)===0)return[];const i=bit(e,this.tileScheme.spatialReference);return i!=null?[...new Set([...this.boundsIntersections(i[0]),...this.boundsIntersections(i[1])])]:this.boundsIntersections(e)}boundsIntersections(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})}updateTiles(e){const i={added:[],removed:[]};for(const s of e.added)if(!this.has(s)){const n=new Une(this.tileScheme,s);this._tiles.set(s,n),this._index.insert(n),i.added.push(n)}for(const s of e.removed)if(this.has(s)){const n=this.get(s);this._tiles.delete(s),this._index.remove(n),i.removed.push(n)}this.tiles.length=0,this._tiles.forEach(s=>this.tiles.push(s)),(i.added.length||i.removed.length)&&this.emit("update",i)}setViewState(e){const i=this.tileScheme.getTileCoverage(e,0);if(!i)return;const{spans:s,lodInfo:n}=i,{level:r}=n;if(s.length>0)for(const{row:o,colFrom:a,colTo:l}of s)for(let u=a;u<=l;u++){const c=xit.set(r,o,n.normalizeCol(u),n.getWorldForColumn(u)).id;if(_V.add(c),!this.has(c)){const h=new Une(this.tileScheme,c);this._tiles.set(c,h),this._index.insert(h),this.tiles.push(h),N0.added.push(h)}}for(let o=this.tiles.length-1;o>=0;o--){const a=this.tiles[o];_V.has(a.id)||(this._tiles.delete(a.id),this.tiles.splice(o,1),this._index.remove(a),N0.removed.push(a))}(N0.added.length||N0.removed.length)&&this.emit("update",N0),SM.pool.release(i),_V.clear(),N0.added.length=0,N0.removed.length=0}};const nxt=1e-30,Vne=512,JN=16777216,rxt=8,oxt=29,axt=24,lxt=4,uxt=0,cxt=0,hxt=0,dxt=1,mxt=2,pxt=3,fxt=4,gxt=5,_xt=6,yxt=12,vxt=13,xxt=5,Sit=6,bxt=5,wxt=6;var zne;(function(t){t[t.FilterFlags=0]="FilterFlags",t[t.Animation=1]="Animation",t[t.GPGPU=2]="GPGPU",t[t.VV=3]="VV",t[t.DD0=4]="DD0",t[t.DD1=5]="DD1",t[t.DD2=6]="DD2",t[t.LocalTimeOrigin=7]="LocalTimeOrigin"})(zne||(zne={}));const m1e=6,Eit=1<<m1e,Sxt=Eit<<1,Ext=1.05,Cxt=3,Txt=1,Pxt=3,Mxt=3,Axt=5,Ixt=6,Dxt=1.15,Cit=4,Nxt=128,Tit=256,Rxt=Tit-2*Cit,Oxt=2,Lxt=128,Fxt=1,kxt=10,$xt=1024,Uxt=128,Vxt=4,zxt=1,Gxt=1<<20,Bxt=.75,qxt=10,Hxt=.75,jxt=256,Yxt=32,Xxt=512,Wxt=0,Zxt=1,Pit=1,Kxt=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],Qxt=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],sC=256;var Gne,Bne,qne,Hne,Eq,jne,Yne,mm,Cq,uP,Io,XL,Wc,jn,ti,EM,lf,Xne,Wne,Zne;(function(t){t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL",t[t.COLOR=16384]="COLOR"})(Gne||(Gne={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(Bne||(Bne={})),function(t){t[t.ZERO=0]="ZERO",t[t.ONE=1]="ONE",t[t.SRC_COLOR=768]="SRC_COLOR",t[t.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",t[t.SRC_ALPHA=770]="SRC_ALPHA",t[t.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",t[t.DST_ALPHA=772]="DST_ALPHA",t[t.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",t[t.DST_COLOR=774]="DST_COLOR",t[t.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",t[t.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",t[t.CONSTANT_COLOR=32769]="CONSTANT_COLOR",t[t.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",t[t.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",t[t.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA"}(qne||(qne={})),function(t){t[t.ADD=32774]="ADD",t[t.MIN=32775]="MIN",t[t.MAX=32776]="MAX",t[t.SUBTRACT=32778]="SUBTRACT",t[t.REVERSE_SUBTRACT=32779]="REVERSE_SUBTRACT"}(Hne||(Hne={})),function(t){t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",t[t.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",t[t.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",t[t.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",t[t.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",t[t.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER"}(Eq||(Eq={})),function(t){t[t.FRONT=1028]="FRONT",t[t.BACK=1029]="BACK",t[t.FRONT_AND_BACK=1032]="FRONT_AND_BACK"}(jne||(jne={})),function(t){t[t.CW=2304]="CW",t[t.CCW=2305]="CCW"}(Yne||(Yne={})),function(t){t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.INT=5124]="INT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=5131]="HALF_FLOAT"}(mm||(mm={})),function(t){t[t.NEVER=512]="NEVER",t[t.LESS=513]="LESS",t[t.EQUAL=514]="EQUAL",t[t.LEQUAL=515]="LEQUAL",t[t.GREATER=516]="GREATER",t[t.NOTEQUAL=517]="NOTEQUAL",t[t.GEQUAL=518]="GEQUAL",t[t.ALWAYS=519]="ALWAYS"}(Cq||(Cq={})),function(t){t[t.ZERO=0]="ZERO",t[t.KEEP=7680]="KEEP",t[t.REPLACE=7681]="REPLACE",t[t.INCR=7682]="INCR",t[t.DECR=7683]="DECR",t[t.INVERT=5386]="INVERT",t[t.INCR_WRAP=34055]="INCR_WRAP",t[t.DECR_WRAP=34056]="DECR_WRAP"}(uP||(uP={})),function(t){t[t.NEAREST=9728]="NEAREST",t[t.LINEAR=9729]="LINEAR",t[t.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",t[t.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",t[t.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",t[t.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR"}(Io||(Io={})),function(t){t[t.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(XL||(XL={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_3D=32879]="TEXTURE_3D",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY"}(Wc||(Wc={})),function(t){t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.ALPHA=6406]="ALPHA",t[t.RGB=6407]="RGB",t[t.RGBA=6408]="RGBA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.RED=6403]="RED",t[t.RG=33319]="RG",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER"}(jn||(jn={})),function(t){t[t.RGBA4=32854]="RGBA4",t[t.R16F=33325]="R16F",t[t.RG16F=33327]="RG16F",t[t.RGB32F=34837]="RGB32F",t[t.RGBA16F=34842]="RGBA16F",t[t.R32F=33326]="R32F",t[t.RG32F=33328]="RG32F",t[t.RGBA32F=34836]="RGBA32F",t[t.R11F_G11F_B10F=35898]="R11F_G11F_B10F",t[t.RGB8=32849]="RGB8",t[t.RGBA8=32856]="RGBA8",t[t.RGB5_A1=32855]="RGB5_A1",t[t.R8=33321]="R8",t[t.RG8=33323]="RG8",t[t.R8I=33329]="R8I",t[t.R8UI=33330]="R8UI",t[t.R16I=33331]="R16I",t[t.R16UI=33332]="R16UI",t[t.R32I=33333]="R32I",t[t.R32UI=33334]="R32UI",t[t.RG8I=33335]="RG8I",t[t.RG8UI=33336]="RG8UI",t[t.RG16I=33337]="RG16I",t[t.RG16UI=33338]="RG16UI",t[t.RG32I=33339]="RG32I",t[t.RG32UI=33340]="RG32UI",t[t.RGB16F=34843]="RGB16F",t[t.RGB9_E5=35901]="RGB9_E5",t[t.SRGB8=35905]="SRGB8",t[t.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",t[t.RGB565=36194]="RGB565",t[t.RGBA32UI=36208]="RGBA32UI",t[t.RGB32UI=36209]="RGB32UI",t[t.RGBA16UI=36214]="RGBA16UI",t[t.RGB16UI=36215]="RGB16UI",t[t.RGBA8UI=36220]="RGBA8UI",t[t.RGB8UI=36221]="RGB8UI",t[t.RGBA32I=36226]="RGBA32I",t[t.RGB32I=36227]="RGB32I",t[t.RGBA16I=36232]="RGBA16I",t[t.RGB16I=36233]="RGB16I",t[t.RGBA8I=36238]="RGBA8I",t[t.RGB8I=36239]="RGB8I",t[t.R8_SNORM=36756]="R8_SNORM",t[t.RG8_SNORM=36757]="RG8_SNORM",t[t.RGB8_SNORM=36758]="RGB8_SNORM",t[t.RGBA8_SNORM=36759]="RGBA8_SNORM",t[t.RGB10_A2=32857]="RGB10_A2",t[t.RGB10_A2UI=36975]="RGB10_A2UI"}(ti||(ti={})),function(t){t[t.FLOAT=5126]="FLOAT",t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.BYTE=5120]="BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.SHORT=5122]="SHORT",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.INT=5124]="INT",t[t.HALF_FLOAT=5131]="HALF_FLOAT",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV"}(EM||(EM={})),function(t){t[t.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",t[t.STENCIL_INDEX8=36168]="STENCIL_INDEX8",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL",t[t.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",t[t.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",t[t.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",t[t.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8"}(lf||(lf={})),function(t){t[t.STATIC_DRAW=35044]="STATIC_DRAW",t[t.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",t[t.STREAM_DRAW=35040]="STREAM_DRAW",t[t.STATIC_READ=35045]="STATIC_READ",t[t.DYNAMIC_READ=35049]="DYNAMIC_READ",t[t.STREAM_READ=35041]="STREAM_READ",t[t.STATIC_COPY=35046]="STATIC_COPY",t[t.DYNAMIC_COPY=35050]="DYNAMIC_COPY",t[t.STREAM_COPY=35042]="STREAM_COPY"}(Xne||(Xne={})),function(t){t[t.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",t[t.VERTEX_SHADER=35633]="VERTEX_SHADER"}(Wne||(Wne={})),function(t){t[t.FRAMEBUFFER=36160]="FRAMEBUFFER",t[t.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",t[t.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER"}(Zne||(Zne={}));const Jxt=33984;var WL,Kne,Qne;(function(t){t[t.Texture=0]="Texture",t[t.BufferObject=1]="BufferObject",t[t.VertexArrayObject=2]="VertexArrayObject",t[t.Shader=3]="Shader",t[t.Program=4]="Program",t[t.FramebufferObject=5]="FramebufferObject",t[t.Renderbuffer=6]="Renderbuffer",t[t.TransformFeedback=7]="TransformFeedback",t[t.Sync=8]="Sync",t[t.UNCOUNTED=9]="UNCOUNTED",t[t.LinesOfCode=9]="LinesOfCode",t[t.Uniform=10]="Uniform",t[t.COUNT=11]="COUNT"})(WL||(WL={})),function(t){t[t.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",t[t.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",t[t.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",t[t.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",t[t.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",t[t.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",t[t.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",t[t.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",t[t.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",t[t.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",t[t.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",t[t.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",t[t.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",t[t.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",t[t.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",t[t.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15"}(Kne||(Kne={})),function(t){t[t.NONE=0]="NONE",t[t.BACK=1029]="BACK"}(Qne||(Qne={}));const ebt=33306;var Ko,Jne,ere,tre,ire,sre,nre;(function(t){t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC"})(Ko||(Ko={})),function(t){t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_VEC2=35664]="FLOAT_VEC2",t[t.FLOAT_VEC3=35665]="FLOAT_VEC3",t[t.FLOAT_VEC4=35666]="FLOAT_VEC4",t[t.INT=5124]="INT",t[t.INT_VEC2=35667]="INT_VEC2",t[t.INT_VEC3=35668]="INT_VEC3",t[t.INT_VEC4=35669]="INT_VEC4",t[t.BOOL=35670]="BOOL",t[t.BOOL_VEC2=35671]="BOOL_VEC2",t[t.BOOL_VEC3=35672]="BOOL_VEC3",t[t.BOOL_VEC4=35673]="BOOL_VEC4",t[t.FLOAT_MAT2=35674]="FLOAT_MAT2",t[t.FLOAT_MAT3=35675]="FLOAT_MAT3",t[t.FLOAT_MAT4=35676]="FLOAT_MAT4",t[t.SAMPLER_2D=35678]="SAMPLER_2D",t[t.SAMPLER_CUBE=35680]="SAMPLER_CUBE",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",t[t.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",t[t.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",t[t.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",t[t.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",t[t.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",t[t.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",t[t.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",t[t.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",t[t.SAMPLER_3D=35679]="SAMPLER_3D",t[t.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",t[t.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",t[t.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",t[t.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",t[t.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",t[t.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",t[t.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",t[t.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",t[t.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",t[t.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",t[t.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",t[t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY"}(Jne||(Jne={})),function(t){t[t.OBJECT_TYPE=37138]="OBJECT_TYPE",t[t.SYNC_CONDITION=37139]="SYNC_CONDITION",t[t.SYNC_STATUS=37140]="SYNC_STATUS",t[t.SYNC_FLAGS=37141]="SYNC_FLAGS"}(ere||(ere={})),function(t){t[t.UNSIGNALED=37144]="UNSIGNALED",t[t.SIGNALED=37145]="SIGNALED"}(tre||(tre={})),function(t){t[t.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",t[t.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",t[t.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",t[t.WAIT_FAILED=37149]="WAIT_FAILED"}(ire||(ire={})),function(t){t[t.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE"}(sre||(sre={})),function(t){t[t.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT"}(nre||(nre={}));const Mit=()=>ht.getLogger("esri.views.webgl.checkWebGLError");function Ait(t,e){switch(e){case t.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case t.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case t.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case t.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case t.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case t.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}const p1e=!!ke("enable-feature:webgl-debug");function f1e(){return p1e}function tbt(){return p1e}function cb(t){if(f1e()){const e=t.getError();if(e){const i=Ait(t,e),s=new Error().stack;Mit().error(new Se("webgl-error","WebGL error occurred",{message:i,stack:s}))}}}var Tq;(function(t){t[t.Texture=0]="Texture",t[t.RenderBuffer=1]="RenderBuffer"})(Tq||(Tq={}));function Iit(t){switch(t){case mm.BYTE:case mm.UNSIGNED_BYTE:return 1;case mm.SHORT:case mm.UNSIGNED_SHORT:case mm.HALF_FLOAT:return 2;case mm.FLOAT:case mm.INT:case mm.UNSIGNED_INT:return 4}}function Dit(t){const e=t.gl;switch(e.getError()){case e.NO_ERROR:return null;case e.INVALID_ENUM:return"An unacceptable value has been specified for an enumerated argument";case e.INVALID_VALUE:return"An unacceptable value has been specified for an argument";case e.INVALID_OPERATION:return"The specified command is not allowed for the current state";case e.INVALID_FRAMEBUFFER_OPERATION:return"The currently bound framebuffer is not framebuffer complete";case e.OUT_OF_MEMORY:return"Not enough memory is left to execute the command";case e.CONTEXT_LOST_WEBGL:return"WebGL context is lost"}return"Unknown error"}function ibt(t,e,i,s,n=0){var o;const r=t.gl;t.bindBuffer(i);for(const a of s){const l=e.get(a.name);if(l==null){console.warn(`There is no location for vertex attribute '${a.name}' defined.`);continue}const u=n*a.stride;if(a.count<=4)r.vertexAttribPointer(l,a.count,a.type,a.normalized,a.stride,a.offset+u),r.enableVertexAttribArray(l),a.divisor>0&&t.gl.vertexAttribDivisor(l,a.divisor);else if(a.count===9)for(let c=0;c<3;c++)r.vertexAttribPointer(l+c,3,a.type,a.normalized,a.stride,a.offset+12*c+u),r.enableVertexAttribArray(l+c),a.divisor>0&&t.gl.vertexAttribDivisor(l+c,a.divisor);else if(a.count===16)for(let c=0;c<4;c++)r.vertexAttribPointer(l+c,4,a.type,a.normalized,a.stride,a.offset+16*c+u),r.enableVertexAttribArray(l+c),a.divisor>0&&((o=t.gl)==null||o.vertexAttribDivisor(l+c,a.divisor));else console.error("Unsupported vertex attribute element count: "+a.count);if(f1e()){const c=Dit(t),h=Iit(a.type),d=a.offset,m=Math.round(h/d)!==h/d?`. Offset not a multiple of stride. DataType requires ${h} bytes, but descriptor has an offset of ${d}`:"";c&&console.error(`Unable to bind vertex attribute "${a.name}" with baseInstanceOffset ${u}${m}:`,c,a)}}}function sbt(t,e,i,s){var r,o,a;const n=t.gl;t.bindBuffer(i);for(const l of s){const u=e.get(l.name);if(l.count<=4)n.disableVertexAttribArray(u),l.divisor&&l.divisor>0&&((r=t.gl)==null||r.vertexAttribDivisor(u,0));else if(l.count===9)for(let c=0;c<3;c++)n.disableVertexAttribArray(u+c),l.divisor&&l.divisor>0&&((o=t.gl)==null||o.vertexAttribDivisor(u+c,0));else if(l.count===16)for(let c=0;c<4;c++)n.disableVertexAttribArray(u+c),l.divisor&&l.divisor>0&&((a=t.gl)==null||a.vertexAttribDivisor(u+c,0));else console.error("Unsupported vertex attribute element count: "+l.count)}t.unbindBuffer(Eq.ARRAY_BUFFER)}function Nit(t){switch(t){case jn.ALPHA:case jn.LUMINANCE:case jn.RED:case jn.RED_INTEGER:case ti.R8:case ti.R8I:case ti.R8UI:case ti.R8_SNORM:case lf.STENCIL_INDEX8:return 1;case jn.LUMINANCE_ALPHA:case jn.RG:case jn.RG_INTEGER:case ti.RGBA4:case ti.R16F:case ti.R16I:case ti.R16UI:case ti.RG8:case ti.RG8I:case ti.RG8UI:case ti.RG8_SNORM:case ti.RGB565:case ti.RGB5_A1:case lf.DEPTH_COMPONENT16:return 2;case jn.DEPTH_COMPONENT:case jn.RGB:case jn.RGB_INTEGER:case ti.RGB8:case ti.RGB8I:case ti.RGB8UI:case ti.RGB8_SNORM:case ti.SRGB8:case lf.DEPTH_COMPONENT24:return 3;case jn.DEPTH_STENCIL:case jn.DEPTH24_STENCIL8:case jn.RGBA:case jn.RGBA_INTEGER:case ti.RGBA8:case ti.R32F:case ti.R11F_G11F_B10F:case ti.RG16F:case ti.R32I:case ti.R32UI:case ti.RG16I:case ti.RG16UI:case ti.RGBA8I:case ti.RGBA8UI:case ti.RGBA8_SNORM:case ti.SRGB8_ALPHA8:case ti.RGB9_E5:case ti.RGB10_A2UI:case ti.RGB10_A2:case lf.DEPTH_STENCIL:case lf.DEPTH_COMPONENT32F:case lf.DEPTH24_STENCIL8:return 4;case lf.DEPTH32F_STENCIL8:return 5;case ti.RGB16F:case ti.RGB16I:case ti.RGB16UI:return 6;case ti.RG32F:case ti.RG32I:case ti.RG32UI:case ti.RGBA16F:case ti.RGBA16I:case ti.RGBA16UI:return 8;case ti.RGB32F:case ti.RGB32I:case ti.RGB32UI:return 12;case ti.RGBA32F:case ti.RGBA32I:case ti.RGBA32UI:return 16;case Ko.COMPRESSED_RGB_S3TC_DXT1_EXT:case Ko.COMPRESSED_RGBA_S3TC_DXT1_EXT:return .5;case Ko.COMPRESSED_RGBA_S3TC_DXT3_EXT:case Ko.COMPRESSED_RGBA_S3TC_DXT5_EXT:return 1;case Ko.COMPRESSED_R11_EAC:case Ko.COMPRESSED_SIGNED_R11_EAC:case Ko.COMPRESSED_RGB8_ETC2:case Ko.COMPRESSED_SRGB8_ETC2:case Ko.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:case Ko.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:return .5;case Ko.COMPRESSED_RG11_EAC:case Ko.COMPRESSED_SIGNED_RG11_EAC:case Ko.COMPRESSED_RGBA8_ETC2_EAC:case Ko.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:return 1}return 0}let g1e=class{constructor(e=0,i=e){this.width=e,this.height=i,this.target=Wc.TEXTURE_2D,this.pixelFormat=jn.RGBA,this.dataType=EM.UNSIGNED_BYTE,this.samplingMode=Io.LINEAR,this.wrapMode=XL.REPEAT,this.maxAnisotropy=1,this.flipped=!1,this.hasMipmap=!1,this.isOpaque=!1,this.unpackAlignment=4,this.preMultiplyAlpha=!1,this.shouldCompress=!1,this.depth=1,this.isImmutable=!1}};function Rit(t){return t.width<=0||t.height<=0?0:Math.round(t.width*t.height*t.depth*(t.hasMipmap?4/3:1)*(t.internalFormat==null?4:Nit(t.internalFormat))*(t.target===Wc.TEXTURE_CUBE_MAP?6:1))}const Oit=()=>ht.getLogger("esri/views/webgl/textureUtils");function eR(t){(t.width!=null&&t.width<0||t.height!=null&&t.height<0||t.depth!=null&&t.depth<0)&&Oit().error("Negative dimension parameters are not allowed!")}function Lit(t){return t in ti}function Fit(t){return t in Ko}function Fb(t){return t!=null&&"type"in t&&t.type==="compressed"}function kit(t){return t!=null&&"byteLength"in t}function rre(t){return t!=null&&!Fb(t)&&!kit(t)}function hb(t){return t===Wc.TEXTURE_3D||t===Wc.TEXTURE_2D_ARRAY}function ore(t,e,i,s=1){let n=Math.max(e,i);return t===Wc.TEXTURE_3D&&(n=Math.max(n,s)),Math.floor(Math.log2(n))+1}function tR(t){if(t.internalFormat!=null)return t.internalFormat===jn.DEPTH_STENCIL?jn.DEPTH24_STENCIL8:t.internalFormat;switch(t.dataType){case EM.FLOAT:switch(t.pixelFormat){case jn.RGBA:return ti.RGBA32F;case jn.RGB:return ti.RGB32F;default:throw new Se("Unable to derive format")}case EM.UNSIGNED_BYTE:switch(t.pixelFormat){case jn.RGBA:return ti.RGBA8;case jn.RGB:return ti.RGB8}}return t.internalFormat=t.pixelFormat===jn.DEPTH_STENCIL?jn.DEPTH24_STENCIL8:t.pixelFormat}function $it(t){let e="width"in t?t.width:t.codedWidth,i="height"in t?t.height:t.codedHeight;return t instanceof HTMLVideoElement&&(e=t.videoWidth,i=t.videoHeight),{width:e,height:i,depth:1}}let Uit=class _1e extends g1e{constructor(e,i){switch(super(),this.context=e,Object.assign(this,i),this.internalFormat){case ti.R16F:case ti.R16I:case ti.R16UI:case ti.R32F:case ti.R32I:case ti.R32UI:case ti.R8_SNORM:case ti.R8:case ti.R8I:case ti.R8UI:this.pixelFormat=jn.RED}}static validate(e,i){return new _1e(e,i)}};const Qg=()=>ht.getLogger("esri/views/webgl/Texture");let Pq=class wl{constructor(e,i=null,s=null){if(this.type=Tq.Texture,this._glName=null,this._samplingModeDirty=!1,this._wrapModeDirty=!1,this._wasImmutablyAllocated=!1,this._compressionAbortController=DS(null),"context"in e)this._descriptor=e,s=i;else{const n=Uit.validate(e,i);if(!n)throw new Se("Texture descriptor invalid");this._descriptor=n}this._descriptor.target===Wc.TEXTURE_CUBE_MAP?this._setDataCubeMap(s):this.setData(s)}get glName(){return this._glName}get descriptor(){return this._descriptor}get usedMemory(){return Rit(this._descriptor)}get cachedMemory(){return this.usedMemory}get isDirty(){return this._samplingModeDirty||this._wrapModeDirty}get isCompressing(){return this._compressionAbortController.value!==null}dispose(){this.abortCompression(),this._glName&&this._descriptor.context.instanceCounter.decrement(WL.Texture,this),this._descriptor.context.gl&&this._glName&&(this._descriptor.context.unbindTexture(this),this._descriptor.context.gl.deleteTexture(this._glName),this._glName=null)}release(){this.dispose()}resize(e,i){const s=this._descriptor;if(s.width!==e||s.height!==i){if(this._wasImmutablyAllocated)throw new Se("Immutable textures can't be resized!");s.width=e,s.height=i,this._descriptor.target===Wc.TEXTURE_CUBE_MAP?this._setDataCubeMap(null):this.setData(null)}}enableCompression(e){this._descriptor.shouldCompress=e}setData(e){this.abortCompression(),!Fb(e)&&this._descriptor.internalFormat&&this._descriptor.internalFormat in Ko&&(this._descriptor.internalFormat=void 0),this._setData(e),!Fb(e)&&this._descriptor.shouldCompress&&this._compressOnWorker(e)}updateData(e,i,s,n,r,o,a=0){o||Qg().error("An attempt to use uninitialized data!"),this._glName||Qg().error("An attempt to update uninitialized texture!");const l=this._descriptor;l.internalFormat=tR(l);const{context:u,pixelFormat:c,dataType:h,target:d,isImmutable:m}=l;if(m&&!this._wasImmutablyAllocated)throw new Se("Cannot update immutable texture before allocation!");const f=u.bindTexture(this,wl.TEXTURE_UNIT_FOR_UPDATES,!0);(i<0||s<0||i+n>l.width||s+r>l.height)&&Qg().error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:_}=u;a&&(n&&r||Qg().warn("Must pass width and height if `UNPACK_SKIP_ROWS` is used"),_.pixelStorei(_.UNPACK_SKIP_ROWS,a)),rre(o)?_.texSubImage2D(d,e,i,s,n,r,c,h,o):Fb(o)?_.compressedTexSubImage2D(d,e,i,s,n,r,l.internalFormat,o.levels[e]):_.texSubImage2D(d,e,i,s,n,r,c,h,o),a&&_.pixelStorei(_.UNPACK_SKIP_ROWS,0),u.bindTexture(f,wl.TEXTURE_UNIT_FOR_UPDATES)}updateData3D(e,i,s,n,r,o,a,l){l||Qg().error("An attempt to use uninitialized data!"),this._glName||Qg().error("An attempt to update an uninitialized texture!");const u=this._descriptor;u.internalFormat=tR(u);const{context:c,pixelFormat:h,dataType:d,isImmutable:m,target:f}=u;if(m&&!this._wasImmutablyAllocated)throw new Se("Cannot update immutable texture before allocation!");hb(f)||Qg().warn("Attempting to set 3D texture data on a non-3D texture");const _=c.bindTexture(this,wl.TEXTURE_UNIT_FOR_UPDATES);c.setActiveTexture(wl.TEXTURE_UNIT_FOR_UPDATES),(i<0||s<0||n<0||i+r>u.width||s+o>u.height||n+a>u.depth)&&Qg().error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage();const{gl:v}=c;if(Fb(l))l=l.levels[e],v.compressedTexSubImage3D(f,e,i,s,n,r,o,a,u.internalFormat,l);else{const x=l;v.texSubImage3D(f,e,i,s,n,r,o,a,h,d,x)}c.bindTexture(_,wl.TEXTURE_UNIT_FOR_UPDATES)}generateMipmap(){const e=this._descriptor;if(e.width===0||e.height===0)return;if(!e.hasMipmap){if(this._wasImmutablyAllocated)throw new Se("Cannot add mipmaps to immutable texture after allocation");e.hasMipmap=!0,this._samplingModeDirty=!0,eR(e)}e.samplingMode===Io.LINEAR?(this._samplingModeDirty=!0,e.samplingMode=Io.LINEAR_MIPMAP_NEAREST):e.samplingMode===Io.NEAREST&&(this._samplingModeDirty=!0,e.samplingMode=Io.NEAREST_MIPMAP_NEAREST);const i=this._descriptor.context.bindTexture(this,wl.TEXTURE_UNIT_FOR_UPDATES);this._descriptor.context.setActiveTexture(wl.TEXTURE_UNIT_FOR_UPDATES),this._descriptor.context.gl.generateMipmap(e.target),this._descriptor.context.bindTexture(i,wl.TEXTURE_UNIT_FOR_UPDATES)}clearMipmap(){const e=this._descriptor;if(e.hasMipmap){if(this._wasImmutablyAllocated)throw new Se("Cannot delete mipmaps to immutable texture after allocation");e.hasMipmap=!1,this._samplingModeDirty=!0,eR(e)}e.samplingMode===Io.LINEAR_MIPMAP_NEAREST?(this._samplingModeDirty=!0,e.samplingMode=Io.LINEAR):e.samplingMode===Io.NEAREST_MIPMAP_NEAREST&&(this._samplingModeDirty=!0,e.samplingMode=Io.NEAREST)}setSamplingMode(e){e!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=e,this._samplingModeDirty=!0)}setWrapMode(e){e!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=e,eR(this._descriptor),this._wrapModeDirty=!0)}applyChanges(){this._samplingModeDirty&&(this._applySamplingMode(),this._samplingModeDirty=!1),this._wrapModeDirty&&(this._applyWrapMode(),this._wrapModeDirty=!1)}abortCompression(){this.isCompressing&&(this._compressionAbortController.value=Xw(this._compressionAbortController.value))}_setData(e,i){var l;const s=this._descriptor,n=(l=s.context)==null?void 0:l.gl;if(!n)return;cb(n),this._glName||(this._glName=n.createTexture(),this._glName&&s.context.instanceCounter.increment(WL.Texture,this)),eR(s);const r=s.context.bindTexture(this,wl.TEXTURE_UNIT_FOR_UPDATES);s.context.setActiveTexture(wl.TEXTURE_UNIT_FOR_UPDATES),this._configurePixelStorage(),cb(n);const o=i??s.target,a=hb(o);if(rre(e))this._setDataFromTexImageSource(e,o);else{const{width:u,height:c,depth:h}=s;if(u==null||c==null)throw new Se("Width and height must be specified!");if(a&&h==null)throw new Se("Depth must be specified!");if(s.internalFormat=tR(s),s.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(o,s.internalFormat,s.hasMipmap,u,c,h),Fb(e)){if(!Fit(s.internalFormat))throw new Se("Attempting to use compressed data with an uncompressed format!");this._setDataFromCompressedSource(e,s.internalFormat,o)}else this._texImage(o,0,s.internalFormat,u,c,h,e),cb(n),s.hasMipmap&&this.generateMipmap()}this._applySamplingMode(),this._applyWrapMode(),this._applyAnisotropicFilteringParameters(),cb(n),s.context.bindTexture(r,wl.TEXTURE_UNIT_FOR_UPDATES)}_setDataCubeMap(e=null){for(let i=Wc.TEXTURE_CUBE_MAP_POSITIVE_X;i<=Wc.TEXTURE_CUBE_MAP_NEGATIVE_Z;i++)this._setData(e,i)}_configurePixelStorage(){const e=this._descriptor.context.gl,{unpackAlignment:i,flipped:s,preMultiplyAlpha:n}=this._descriptor;e.pixelStorei(e.UNPACK_ALIGNMENT,i),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,s?1:0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n?1:0)}_setDataFromTexImageSource(e,i){const{gl:s}=this._descriptor.context,n=this._descriptor;n.internalFormat=tR(n);const r=hb(i),{width:o,height:a,depth:l}=$it(e);n.width&&n.height,n.width||(n.width=o),n.height||(n.height=a),r&&n.depth,r&&(n.depth=l),n.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(i,n.internalFormat,n.hasMipmap,o,a,l),this._texImage(i,0,n.internalFormat,o,a,l,e),cb(s),n.hasMipmap&&(this.generateMipmap(),cb(s))}_setDataFromCompressedSource(e,i,s){const n=this._descriptor,{width:r,height:o,depth:a}=n,l=e.levels,u=ore(s,r,o,a),c=Math.min(u,l.length)-1;this._descriptor.context.gl.texParameteri(n.target,n.context.gl.TEXTURE_MAX_LEVEL,c),this._forEachMipmapLevel((h,d,m,f)=>{const _=l[Math.min(h,l.length-1)];this._compressedTexImage(s,h,i,d,m,f,_)},c)}_texStorage(e,i,s,n,r,o){const{gl:a}=this._descriptor.context;if(!Lit(i))throw new Se("Immutable textures must have a sized internal format");if(!this._descriptor.isImmutable)return;const l=s?ore(e,n,r,o):1;if(hb(e)){if(o==null)throw new Se("Missing depth dimension for 3D texture upload");a.texStorage3D(e,l,i,n,r,o)}else a.texStorage2D(e,l,i,n,r);this._wasImmutablyAllocated=!0}_texImage(e,i,s,n,r,o,a){const l=this._descriptor.context.gl,u=hb(e),{isImmutable:c,pixelFormat:h,dataType:d}=this._descriptor;if(c){if(a!=null){const m=a;if(u){if(o==null)throw new Se("Missing depth dimension for 3D texture upload");l.texSubImage3D(e,i,0,0,0,n,r,o,h,d,m)}else l.texSubImage2D(e,i,0,0,n,r,h,d,m)}}else{const m=a;if(u){if(o==null)throw new Se("Missing depth dimension for 3D texture upload");l.texImage3D(e,i,s,n,r,o,0,h,d,m)}else l.texImage2D(e,i,s,n,r,0,h,d,m)}}_compressedTexImage(e,i,s,n,r,o,a){const l=this._descriptor.context.gl,u=hb(e);if(this._descriptor.isImmutable){if(a!=null)if(u){if(o==null)throw new Se("Missing depth dimension for 3D texture upload");l.compressedTexSubImage3D(e,i,0,0,0,n,r,o,s,a)}else l.compressedTexSubImage2D(e,i,0,0,n,r,s,a)}else if(u){if(o==null)throw new Se("Missing depth dimension for 3D texture upload");l.compressedTexImage3D(e,i,s,n,r,o,0,a)}else l.compressedTexImage2D(e,i,s,n,r,0,a)}async _compressOnWorker(e){var n,r;if(!wl.compressionWorkerHandle||!wl.compressionWorkerHandle.isCompressible(e))return;const i=(n=this._descriptor.context)==null?void 0:n.gl.getExtension("WEBGL_compressed_texture_etc"),s=(r=this._descriptor.context)==null?void 0:r.gl.getExtension("WEBGL_compressed_texture_s3tc");if(i||s){const o=new AbortController;this._compressionAbortController.value=o;const a={data:await createImageBitmap(e),flipped:this.descriptor.flipped,width:e.width,height:e.height,hasMipmap:this._descriptor.hasMipmap,hasETC:!!i,hasS3TC:!!s};wl.compressionWorkerHandle.invoke(a,this._compressionAbortController.value.signal).then(l=>{l&&this.isCompressing&&this.glName&&(this._descriptor.internalFormat=l.internalFormat,this._setData(l.compressedTexture)),o===this._compressionAbortController.value&&(this._compressionAbortController.value=null)}).catch(l=>{cl(l)||o!==this._compressionAbortController.value||(this._compressionAbortController.value=null)})}}_forEachMipmapLevel(e,i=1/0){let{width:s,height:n,depth:r,hasMipmap:o,target:a}=this._descriptor;const l=a===Wc.TEXTURE_3D;if(s==null||n==null||l&&r==null)throw new Se("Missing texture dimensions for mipmap calculation");for(let u=0;e(u,s,n,r),o&&(s!==1||n!==1||l&&r!==1)&&!(u>=i);++u)s=Math.max(1,s>>1),n=Math.max(1,n>>1),l&&(r=Math.max(1,r>>1))}_applySamplingMode(){var r;const e=this._descriptor,i=(r=e.context)==null?void 0:r.gl;let s=e.samplingMode,n=e.samplingMode;s===Io.LINEAR_MIPMAP_NEAREST||s===Io.LINEAR_MIPMAP_LINEAR?(s=Io.LINEAR,e.hasMipmap||(n=Io.LINEAR)):s!==Io.NEAREST_MIPMAP_NEAREST&&s!==Io.NEAREST_MIPMAP_LINEAR||(s=Io.NEAREST,e.hasMipmap||(n=Io.NEAREST)),i.texParameteri(e.target,i.TEXTURE_MAG_FILTER,s),i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,n)}_applyWrapMode(){var s;const e=this._descriptor,i=(s=e.context)==null?void 0:s.gl;typeof e.wrapMode=="number"?(i.texParameteri(e.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(e.target,i.TEXTURE_WRAP_T,e.wrapMode)):(i.texParameteri(e.target,i.TEXTURE_WRAP_S,e.wrapMode.s),i.texParameteri(e.target,i.TEXTURE_WRAP_T,e.wrapMode.t))}_applyAnisotropicFilteringParameters(){const e=this._descriptor,i=e.context.capabilities.textureFilterAnisotropic;i&&e.context.gl.texParameterf(e.target,i.TEXTURE_MAX_ANISOTROPY,e.maxAnisotropy??1)}};Pq.TEXTURE_UNIT_FOR_UPDATES=0,Pq.compressionWorkerHandle=null;const yV=()=>ht.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient");function Vit(t,e){e.fillColor[0]=t.color.r/255,e.fillColor[1]=t.color.g/255,e.fillColor[2]=t.color.b/255,e.fillColor[3]=t.color.a,t.haloColor?(e.outlineColor[0]=t.haloColor.r/255,e.outlineColor[1]=t.haloColor.g/255,e.outlineColor[2]=t.haloColor.b/255,e.outlineColor[3]=t.haloColor.a):(e.outlineColor[0]=e.fillColor[0],e.outlineColor[1]=e.fillColor[1],e.outlineColor[2]=e.fillColor[2],e.outlineColor[3]=e.fillColor[3]),e.fillColor[3]*=t.fillOpacity,e.outlineColor[3]*=t.haloOpacity,e.fillColor[0]*=e.fillColor[3],e.fillColor[1]*=e.fillColor[3],e.fillColor[2]*=e.fillColor[3],e.outlineColor[0]*=e.outlineColor[3],e.outlineColor[1]*=e.outlineColor[3],e.outlineColor[2]*=e.outlineColor[3],e.outlineWidth=(1-t.haloBlur)*t.haloWidth,e.outerHaloWidth=t.haloBlur*t.haloWidth/2,e.innerHaloWidth=t.haloBlur*t.haloWidth/2,e.outlinePosition=0}const zit=[0,0,0,0];let y1e=class{constructor(){this.type="single",this._highlightOptions=new cy,this._convertedHighlightOptions={fillColor:[0,0,0,0],outlineColor:[0,0,0,0],outlinePosition:0,outlineWidth:0,innerHaloWidth:0,outerHaloWidth:0},this._optionsShadeTexKey="",this._texelData=new Uint8Array(4*sC),this._minMaxDistance=[0,0]}setHighlightOptions(e){this._highlightOptions=e}applyHighlightOptions(e,i){this._updateGradientTexture(e),e.bindTexture(this._shadeTex,Sit),i.setUniform2fv("u_minMaxDistance",this._minMaxDistance)}destroy(){var e;(e=this._shadeTex)==null||e.dispose(),this._shadeTex=null}getReasonsWithGradients(){return[{activeReasons:(1<<m1e)-1,activeGradient:this}]}_updateGradientTexture(e){const i=Git(this._highlightOptions);if(i===this._optionsShadeTexKey)return;this._optionsShadeTexKey=i,Vit(this._highlightOptions,this._convertedHighlightOptions);const s=this._convertedHighlightOptions,n=s.outlinePosition-s.outlineWidth/2-s.outerHaloWidth,r=s.outlinePosition-s.outlineWidth/2,o=s.outlinePosition+s.outlineWidth/2,a=s.outlinePosition+s.outlineWidth/2+s.innerHaloWidth,l=Math.sqrt(Math.PI/2)*Pit,u=Math.abs(n)>l?Math.round(10*(Math.abs(n)-l))/10:0,c=Math.abs(a)>l?Math.round(10*(Math.abs(a)-l))/10:0;let h;u&&!c?yV().error("The outer rim of the highlight is "+u+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!u&&c?yV().error("The inner rim of the highlight is "+c+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):u&&c&&yV().error("The highlight is "+Math.max(u,c)+"px away from the edge of the feature; consider reducing some width values.");const d=[void 0,void 0,void 0,void 0];function m(_,v,x){d[0]=(1-x)*_[0]+x*v[0],d[1]=(1-x)*_[1]+x*v[1],d[2]=(1-x)*_[2]+x*v[2],d[3]=(1-x)*_[3]+x*v[3]}const{_texelData:f}=this;for(let _=0;_<sC;++_)h=n+_/(sC-1)*(a-n),h<n?(d[0]=0,d[1]=0,d[2]=0,d[3]=0):h<r?m(zit,s.outlineColor,(h-n)/(r-n)):h<o?[d[0],d[1],d[2],d[3]]=s.outlineColor:h<a?m(s.outlineColor,s.fillColor,(h-o)/(a-o)):[d[0],d[1],d[2],d[3]]=s.fillColor,f[4*_]=255*d[0],f[4*_+1]=255*d[1],f[4*_+2]=255*d[2],f[4*_+3]=255*d[3];if(this._minMaxDistance[0]=n,this._minMaxDistance[1]=a,!this._shadeTex){const _=new g1e;_.wrapMode=XL.CLAMP_TO_EDGE,_.width=sC,_.height=1,this._shadeTex=new Pq(e,_)}this._shadeTex.updateData(0,0,0,sC,1,this._texelData)}};function Git(t){return`${t.color};${t.haloColor};${t.haloOpacity};${t.fillOpacity};${t.haloWidth};${t.haloBlur}`}let Bit=class{constructor(){this.type="multi",this.gradients=[]}setHighlightOptions(e){for(let i=0;i<e.length;i++)this.gradients[i]||(this.gradients[i]=new y1e),this.gradients[i].setHighlightOptions(e[i]);for(let i=e.length+1;i<this.gradients.length;i++)this.gradients[i].destroy();this.gradients.length=e.length}destroy(){for(const e of this.gradients)e.destroy()}getReasonsWithGradients(){let e=1;const i=[];for(let s=0;s<this.gradients.length;s++){const n=this.gradients[s];i.push({activeReasons:e,activeGradient:n}),e<<=1}return i}};var are,lre,ure,cre,hre,dre,ZL,mre,pre;(function(t){t[t.FILL=0]="FILL",t[t.LINE=1]="LINE",t[t.MARKER=2]="MARKER",t[t.TEXT=3]="TEXT",t[t.LABEL=4]="LABEL"})(are||(are={})),function(t){t[t.NONE=0]="NONE",t[t.MAP=1]="MAP",t[t.LABEL=2]="LABEL",t[t.LABEL_ALPHA=4]="LABEL_ALPHA",t[t.HITTEST=8]="HITTEST",t[t.HIGHLIGHT=16]="HIGHLIGHT",t[t.CLIP=32]="CLIP",t[t.DEBUG=64]="DEBUG",t[t.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"}(lre||(lre={})),function(t){t[t.SIZE=0]="SIZE",t[t.COLOR=1]="COLOR",t[t.OPACITY=2]="OPACITY",t[t.ROTATION=3]="ROTATION"}(ure||(ure={})),function(t){t[t.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE",t[t.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE",t[t.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE",t[t.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"}(cre||(cre={})),function(t){t[t.SPRITE=0]="SPRITE",t[t.GLYPH=1]="GLYPH"}(hre||(hre={})),function(t){t[t.DEFAULT=0]="DEFAULT",t[t.SIMPLE=1]="SIMPLE",t[t.DOT_DENSITY=2]="DOT_DENSITY",t[t.OUTLINE_FILL=3]="OUTLINE_FILL",t[t.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE",t[t.HEATMAP=5]="HEATMAP",t[t.PIE_CHART=6]="PIE_CHART"}(dre||(dre={})),function(t){t[t.All=0]="All",t[t.Highlight=1]="Highlight",t[t.InsideEffect=2]="InsideEffect",t[t.OutsideEffect=3]="OutsideEffect"}(ZL||(ZL={})),function(t){t[t.BATCHING=0]="BATCHING",t[t.STRICT_ORDER=1]="STRICT_ORDER",t[t.STRICT_MARKERS_AND_TEXT=2]="STRICT_MARKERS_AND_TEXT"}(mre||(mre={})),function(t){t[t.FILL=0]="FILL",t[t.LINE=1]="LINE",t[t.MARKER=2]="MARKER",t[t.TEXT=3]="TEXT"}(pre||(pre={}));const v1e={color:{write:[!0,!0,!0,!0],blendMode:"composite"},depth:!1,stencil:{write:!1,test:{ref:t=>t.stencilRef,compare:Cq.EQUAL,mask:255,op:{fail:uP.KEEP,zFail:uP.KEEP,zPass:uP.REPLACE}}}},qit={color:{write:[!0,!0,!0,!0],blendMode:"additive"},depth:!1,stencil:!1},Hit={...v1e,color:{write:[!0,!0,!0,!0],blendMode:"delete"}};function jit({pixelRatio:t,state:e,displayLevel:i,requiredLevel:s},n){const r=1/2**(i-n.key.level),o=1/2**(s-n.key.level);return{displayMat3:e.displayMat3,displayViewMat3:e.displayViewMat3,displayViewScreenMat3:n.transforms.displayViewScreenMat3,viewMat3:e.viewMat3,tileMat3:n.transforms.tileMat3,displayZoomFactor:r,requiredZoomFactor:o,tileOffset:[n.x,n.y],currentScale:e.scale,currentZoom:i,metersPerSRUnit:ah(e.spatialReference),rotation:e.rotation,pixelRatio:t}}function x1e(t){var e;return((e=t.passOptions)==null?void 0:e.type)==="highlight"}function b1e(t){var e;return((e=t.passOptions)==null?void 0:e.type)==="hittest"}function Yit(t){if(!b1e(t))return null;const{position:e,distance:i,smallSymbolDistance:s,smallSymbolSizeThreshold:n}=t.passOptions;return{position:e,distance:i,smallSymbolDistance:s,smallSymbolSizeThreshold:n}}function Xit(t){if(!x1e(t))return null;const{activeReasons:e,highlightAll:i}=t.passOptions;return{activeReasons:e,highlightAll:i?1:0}}function abt(t,e,i){const s={};for(const n in i)i[n]instanceof Function?s[n]=i[n](t,e):s[n]=i[n];return s}function lbt(t,e){const{attributeView:i,context:s}=t;return{storage:i.getUniforms(s),view:jit(t,e),hittestRequest:Yit(t),highlight:Xit(t)}}function ubt(t){return{inside:t.selection===ZL.InsideEffect,outside:t.selection===ZL.OutsideEffect}}function Wit(t){return b1e(t)?qit:x1e(t)&&t.passOptions.stepType==="clear"?Hit:v1e}function cbt(t){const{row:e,col:i}=t.key,s=i*Vne,n=e*Vne;return{tileOffsetFromLocalOrigin:[s%JN,n%JN],maxIntsToLocalOrigin:[Math.floor(s/JN),Math.floor(n/JN)]}}const Zit=new gs({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function hbt(t){return Zit.toJSON(t)}function dbt(t){const{bandCount:e,attributeTable:i,colormap:s,pixelType:n}=t.raster.rasterInfo;return e===1&&(i!=null||s!=null||n==="u8"||n==="s8")}function Kit(t,e){return e==null?(t==null||t.destroy(),null):((t==null?void 0:t.type)==="single"&&Array.isArray(e)&&(t.destroy(),t=null),(t==null?void 0:t.type)!=="multi"||Array.isArray(e)||(t.destroy(),t=null),t||(t=Array.isArray(e)?new Bit:new y1e),Array.isArray(e)?t.type==="multi"&&t.setHighlightOptions(e):t.type==="single"&&t.setHighlightOptions(e),t)}function mbt(t,e,i,s){const{painter:n,highlightGradient:r}=t,{highlight:o}=n.effects;if(!r)return;const a=t.passOptions,l=r.getReasonsWithGradients();for(let u=0;u<l.length;u++){const c={...t,passOptions:{type:"highlight",activeGradient:l[u].activeGradient,activeReasons:l[u].activeReasons,stepType:"burn",highlightAll:e}};if(o.bind(c),i(c),u<l.length-1){let d=0;for(let m=u+1;m<l.length;m++)d|=l[m].activeReasons;i({...t,passOptions:{type:"highlight",activeGradient:l[u].activeGradient,activeReasons:d,stepType:"clear",highlightAll:e}})}const h={...t,passOptions:{type:"highlight",activeGradient:l[u].activeGradient,activeReasons:l[u].activeReasons,stepType:"draw",highlightAll:e}};n.setPipelineState(Wit(t)),n.updatePipelineState(t.context),o.draw(h),o.unbind()}t.passOptions=a}function pbt(t){if(!t)return[];let e=yMe(t)?[t]:Nt.isCollection(t)?t.toArray():Array.isArray(t)?t:[];return e=e==null?void 0:e.filter(Df),((e==null?void 0:e.length)??0)===0?[]:e}const iR=t=>parseFloat(t)/100;function Qit(t,e,i){const s=typeof t.left=="string"?iR(t.left)*e:t.left,n=typeof t.right=="string"?iR(t.right)*e:t.right,r=typeof t.top=="string"?iR(t.top)*i:t.top,o=typeof t.bottom=="string"?iR(t.bottom)*i:t.bottom,a=r;return{xmin:s,xmax:Math.max(e-n,s),ymin:a,ymax:Math.max(i-o,r)}}function w1e(t,e,i,s){switch(e.type){case"rect":{const{width:n,height:r}=t,{xmin:o,xmax:a,ymin:l,ymax:u}=Qit(e,n,r),{x:c,y:h}=i;return c>o&&c<a&&h>l&&h<u}case"path":return e.path.length===0||!Array.isArray(e.path[0][0])||FH(e.path,[i.x,i.y]);case"geometry":return e.geometry==null||(e.geometry.type==="polygon"?LH(e.geometry,s):GM(e.geometry,s))}}function Jit(t){if(!t.highlights)return null;const e=t.highlights.findIndex(i=>i.name==="default");return e===-1?null:t.highlights.items[e]}function est(t,e){if(!t.highlights){if(!e)return;t.highlights=new Nt([new cy])}const i=t.highlights.findIndex(s=>s.name==="default");e?t.highlights.items[i].assignFrom(e):(t.highlights.removeAt(i),t.highlights.length===0&&(t.highlights=null))}async function tst(t,e,i){const s=B0e(e)?G0e(t,e):e;if(!t.ready||isNaN(s.x)||isNaN(s.y))return{screenPoint:s,results:[]};let n=new Set;const r=new Set;let o=!1,a=null,l=null;i!=null&&i.include?gre(i.include,fre(t,d=>{n.add(d),vV(d,m=>r.add(m))},(d,m)=>{r.add(d),n.add(m)},d=>{a||(a=new Set),a.add(d)},d=>n.add(d),()=>o=!0)):(o=!0,n=new Set(t.allLayerViews),n.forEach(d=>{vV(d,m=>r.add(m))})),i!=null&&i.exclude&&gre(i.exclude,fre(t,d=>{n.delete(d),vV(d,m=>r.delete(m))},d=>r.delete(d),d=>{l||(l=new Set),l.add(d)}));const u=t.toMap(s),c=t.allLayerViews.filter(d=>!d.suspended&&n.has(d)&&d.clips.every(m=>w1e(t,m,s,u))).reverse();let h=[...o?t.graphicsView.hitTest(u).map(d=>({type:"graphic",graphic:d,layer:null,mapPoint:u})):[],...await Promise.all(c.map(d=>d.hitTest(u,s)).toArray())].filter(Df).flat().filter(Df);return h=h.filter(d=>{var m;return d.type!=="graphic"||((m=d.layer)==null?void 0:m.type)!=="subtype-group"||r.has(d.graphic.layer)}),a&&(h=h.filter(d=>!("graphic"in d)||!d.graphic||(a==null?void 0:a.has(Mq(d.graphic))))),l&&(h=h.filter(d=>!("graphic"in d)||!d.graphic||!(l!=null&&l.has(Mq(d.graphic))))),{screenPoint:s,results:h}}function fre(t,e,i,s,n,r){return o=>{if(o instanceof Kr){if(o.layer===t)r==null||r();else{const a=t.allLayerViews.find(l=>l.layer===o.layer);a&&(n==null||n(a))}s(Mq(o))}else if(!("layer"in o&&"element"in o))if(o.type==="subtype-sublayer"){const a=t.allLayerViews.find(l=>l.layer===o.parent);a&&i(o,a)}else{const a=t.allLayerViews.find(l=>l.layer===o);a&&e(a)}}}function gre(t,e){if(t)if(yO(t))for(const i of t)if(yO(i))for(const s of i)e(s);else e(i);else e(t)}function Mq(t){var i,s;const e=t.getObjectId();return e?`${((i=t.layer)==null?void 0:i.uid)??((s=t.sourceLayer)==null?void 0:s.uid)??"MapView"}/${e}`:`"MapView/${t.uid}`}function vV({layer:t},e){(t==null?void 0:t.type)==="subtype-group"&&t.sublayers.forEach(i=>{e(i)})}let nC=null,KL=!0;function ist(t,e,i){if(!t||!e)throw new Error("Cannot construct image data without dimensions");if(KL)try{return new ImageData(t,e)}catch{KL=!1}return S1e(t,e,i)}function fbt(t,e,i,s){if(!e||!i)throw new Error("Cannot construct image data without dimensions");if(KL)try{return new ImageData(t,e,i)}catch{KL=!1}const n=S1e(e,i,s);return n.data.set(t,0),n}function sst(){return nC||(nC=document.createElement("canvas"),nC.width=1,nC.height=1),nC}function S1e(t,e,i){return i||(i=sst()),i.getContext("2d").createImageData(t,e)}async function nst(t,e){const i=window.URL.createObjectURL(t);try{const{data:s}=await $n(i,{...e,responseType:"image"});return s}catch(s){throw cl(s)?s:new Se("invalid-image",`Could not fetch requested image at ${i}`)}finally{window.URL.revokeObjectURL(i)}}async function gbt(t,e){const{arrayBuffer:i,mediaType:s}=await rst(t,e),n=s==="image/png";if(s==="image/gif"){const{isAnimatedGIF:r,parseGif:o}=await _e(()=>import("./gif-H4MO2VNp.js"),[]);if(r(i))return o(i,e)}if(n){const{isAnimatedPNG:r,parseApng:o}=await _e(()=>import("./apng-B0YKKZ4U.js"),__vite__mapDeps([261,3]));if(r(i))return o(i,e)}return nst(new Blob([i],{type:s}),e)}async function rst(t,e){var n;const i=Qw(t);if(i!=null&&i.isBase64)return{arrayBuffer:Zue(i.data),mediaType:i.mediaType};const s=await $n(t,{responseType:"array-buffer",...e});return{arrayBuffer:s.data,mediaType:((n=s.getHeader)==null?void 0:n.call(s,"Content-Type"))??""}}function E1e(t,e,i){const{ctx:s,canvas:n}=T1e(t,i),r=s.getImageData(0,0,t.width,t.height),o=M1e(n,e);return P1e(n),{dataUrl:o,data:r}}function C1e(t,e){const{ctx:i,canvas:s}=T1e(t,e),n=i.getImageData(0,0,t.width,t.height);return P1e(s),n}function T1e(t,e){const i=ost();e.premultipliedAlpha&&cst(t),i.width=t.width,i.height=t.height;const s=i.getContext("2d",{willReadFrequently:!0});return s.putImageData(t,0,0),e.flipY&&ust(s),{ctx:s,canvas:i}}function P1e(t){t.width=0,t.height=0}function ost(){return xV==null&&(xV=document.createElement("canvas")),xV}let xV=null;function M1e(t,e){const i=hst[e.format],s=e.quality/100;return t.toDataURL(i,s)}function A1e(t,e){const i=lst(t),s=mst[i];return{format:i,quality:sh(e??s,0,100)}}function I1e(t,e){return e/Math.max(t[0],t[1])}function ast(t,e,i,s=0,n=0,r=t.width-s,o=t.height-n,a=!1){const{data:l}=t,{width:u,height:c,data:h}=e,d=r/u,m=o/c,f=Math.ceil(d/2),_=Math.ceil(m/2),v=t.width;for(let x=0;x<c;x++)for(let w=0;w<u;w++){const T=4*(w+(a?c-x-1:x)*u);let C=0,M=0,A=0,I=0,L=0,D=0;const O=(x+.5)*m;for(let U=Math.floor(x*m);U<(x+1)*m;U++){const $=Math.abs(O-(U+.5))/_,B=(w+.5)*d,V=$*$;for(let H=Math.floor(w*d);H<(w+1)*d;H++){const Y=Math.abs(B-(H+.5))/f,W=Math.sqrt(V+Y*Y);if(W>=1)continue;let ee=2*W*W*W-3*W*W+1;const ne=4*(s+H+(n+U)*v);D+=ee*l[ne+3],M+=ee,!i&&l[ne+3]<255&&(ee=ee*l[ne+3]/255),A+=ee*l[ne],I+=ee*l[ne+1],L+=ee*l[ne+2],C+=ee}}h[T]=A/C,h[T+1]=I/C,h[T+2]=L/C,h[T+3]=D/M}return e}function lst(t){switch(t){case"png":case"jpg":case"jpeg":return t;default:return dst}}function ust(t){t.save(),t.globalCompositeOperation="copy",t.scale(1,-1),t.translate(0,-t.canvas.height),t.drawImage(t.canvas,0,0),t.restore()}function cst(t){const e=t.data,i=e.length;for(let s=0;s<i;s+=4){const n=e[s+3];if(n!==255&&n>0){const r=255/n;e[s]=e[s]*r,e[s+1]=e[s+1]*r,e[s+2]=e[s+2]*r}}}const hst={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},_re=98,dst="png",mst={png:100,jpg:_re,jpeg:_re},_bt=Object.freeze(Object.defineProperty({__proto__:null,createEmptyImageData:ist,encode:E1e,encodeData:C1e,getFormatAndQuality:A1e,getMaximumResolutionScale:I1e,resampleHermite:ast,toDataUrl:M1e},Symbol.toStringTag,{value:"Module"})),D1e={flipY:!0,premultipliedAlpha:!0};async function pst(t,e){const i=await N1e(t,e),{format:s,quality:n}=A1e(e==null?void 0:e.format,e==null?void 0:e.quality);return E1e(i,{format:s,quality:n},D1e)}async function fst(t,e){const i=await N1e(t,e);return C1e(i,D1e)}function N1e(t,e){const i=yst(e||{},_st(t.stage,t.size),t.size,t.padding),s=gst(e,t.allLayerViews);return t.stage.takeScreenshot(i,s,t.backgroundColor,e==null?void 0:e.rotation)}function gst(t={},e){if(!t.layers)return;const i=[];return t.layers.forEach(s=>{const n=e.find(r=>r.layer.id===s.id);n!=null&&n.container&&i.push(n.container)}),i}function _st(t,e){return Math.min(4,I1e(e,Math.min(4096,t.context.parameters.maxTextureSize)))}function yst(t,e,i,s){t.ignorePadding&&(s={left:0,right:0,top:0,bottom:0});let n=null;t.width!=null&&t.height!=null?n=[t.width,t.height]:t.width==null&&t.height!=null?n=[t.height,t.height]:t.width!=null&&t.height==null?n=[t.width,t.width]:t.width==null&&t.height==null&&(n=null);const r=i[0]-(s.left+s.right),o=i[1]-(s.top+s.bottom);let a,l,u=t.area||{x:0,y:0,width:r,height:o};if(n){const c=r/o,h=n[0]/n[1];if(h>c){const d=u.width/h;u={x:u.x,y:Math.round(u.y+(u.height-d)/2),width:u.width,height:Math.round(d)}}else{const d=u.height*h;u={x:Math.round(u.x+(u.width-d)/2),y:u.y,width:Math.round(d),height:u.height}}}else n=[u.width,u.height];return n[0]>u.width?(a=Math.min(n[0]/u.width,e),l=n[0]/u.width/a):(a=1,l=n[0]/u.width),{cropArea:{x:Math.round((u.x+s.left)*a),y:Math.round((u.y+s.top)*a),width:Math.round(u.width*a),height:Math.round(u.height*a)},outputScale:l,resolutionScale:a}}const vst=t=>t.includes("Brush");let R1e=class{constructor(){this._names=new Map}begin(e){this._names.has(e)||(this._names.set(e,!1),vst(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`))}end(e){this._names.has(e)&&!this._names.get(e)&&(this._names.set(e,!0),performance.mark(`Esri.${e}.End`))}record(e){this._names.has(e)||(this._names.set(e,!0),performance.mark(`Esri.${e}`))}};function xst(t,e){const i=e.debugRendererInfo&&t.getExtension("WEBGL_debug_renderer_info");return i?{getUnmaskedRendererWebGL:()=>t.getParameter(i.UNMASKED_RENDERER_WEBGL)}:null}let yre;function bst(){return yre??(yre=Est()),yre}let wst=class{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1,this.unmaskedRenderer="unloaded"}};function Sst(t){if(typeof WebGL2RenderingContext>"u")return null;const e=document.createElement("canvas");if(!e)return null;let i=e.getContext("webgl2",{failIfMajorPerformanceCaveat:!0});if(i==null&&(i=e.getContext("webgl2"),i!=null&&(t.majorPerformanceCaveat=!0)),i==null)return i;t.available=!0,t.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),t.supportsVertexShaderSamplers=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const s=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT);return s&&(t.supportsHighPrecisionFragment=s.precision>0),i}function Est(){var i;const t=new wst,e=Sst(t);return e==null||(t.supportsColorBufferFloat=e.getExtension("EXT_color_buffer_float")!==null,t.supportsColorBufferFloatBlend=e.getExtension("EXT_float_blend")!==null,t.supportsColorBufferHalfFloat=t.supportsColorBufferFloat||e.getExtension("EXT_color_buffer_half_float")!==null,t.unmaskedRenderer=((i=xst(e,{debugRendererInfo:!0}))==null?void 0:i.getUnmaskedRendererWebGL())??"unknown"),t}function Cst(t){const e=bst();return e.available?t==="3d"&&e.majorPerformanceCaveat?new Se("webgl:major-performance-caveat-detected",`Your WebGL implementation (${e.unmaskedRenderer}) doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist.`):e.supportsHighPrecisionFragment?e.supportsVertexShaderSamplers?null:new Se("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new Se("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new Se("webgl:required","WebGL2 is required but not supported.",new Error().stack)}function Tst(t){return t&&"nodeType"in t}function Pst(t){return t&&typeof t.render=="function"}const vre={component:"esri-component"};let av=class extends ei{constructor(){super(...arguments),this.widget=null}destroy(){var e;this.node=null,(e=this.widget)==null||e.destroy()}get id(){var e,i;return this._get("id")??((e=this.widget)==null?void 0:e.id)??((i=this.node)==null?void 0:i.id)}set id(e){this._set("id",e)}set node(e){const i=this._get("node");e!==i&&(e&&e.classList.add(vre.component),i&&i.classList.remove(vre.component),this._set("node",e))}castNode(e){var i;return(i=this.widget)==null||i.destroy(),e?typeof e=="string"||Tst(e)?(this._set("widget",null),mY(e)):(Pst(e)&&!e.domNode&&(e.domNode=document.createElement("div")),this._set("widget",e),e.domNode):(this._set("widget",null),null)}};y([S()],av.prototype,"id",null),y([S()],av.prototype,"node",null),y([Ls("node")],av.prototype,"castNode",null),y([S({readOnly:!0})],av.prototype,"widget",void 0),av=y([se("esri.views.ui.Component")],av);const k3=av,O1e="calcite-mode-";function Mst(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-mode-name").replaceAll(/\s|'|"/g,"")}function Ast(){return Mst().startsWith("dark")}function Ist(){return`${O1e}${Ast()?"dark":"light"}`}function Dst(t){Nst(t),t.classList.add(Ist())}function Nst(t){Array.from(t.classList).forEach(e=>{e.startsWith(O1e)&&t.classList.remove(e)})}const Rst={left:0,top:0,bottom:0,right:0},L1e={bottom:30,top:15,right:15,left:15},Np="esri-ui",Ql={ui:Np,corner:`${Np}-corner`,innerContainer:`${Np}-inner-container`,manualContainer:`${Np}-manual-container`,cornerContainer:`${Np}-corner-container`,topLeft:`${Np}-top-left`,topRight:`${Np}-top-right`,bottomLeft:`${Np}-bottom-left`,bottomRight:`${Np}-bottom-right`};function Ost(t){return t&&!t._started&&typeof t.postMixInProperties=="function"&&typeof t.buildRendering=="function"&&typeof t.postCreate=="function"&&typeof t.startup=="function"}function sR(t){return t===0?"0":`${t}px`}function bV(t){const e=typeof t=="object"&&t!==null&&Object.getPrototypeOf(t);return(e===null||e===Object.prototype)&&("component"in t||"index"in t||"position"in t)?t:null}function wV(t,{top:e,bottom:i,left:s,right:n}){t.style.top=e,t.style.bottom=i,t.style.left=s,t.style.right=n}let lm=class extends vd.EventedAccessor{constructor(e){super(e),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._removeWidgetHandleKey=Symbol("componentOnRemoveSymbol"),this._locale=vu(),this.view=null,this._applyViewPadding=()=>{const i=this.container;i&&wV(i,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const i=this._innerContainer;i&&wV(i,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([Ai(()=>{var e;return[(e=this.view)==null?void 0:e.padding,this.container]},this._applyViewPadding,nl),Ai(()=>this.padding,this._applyUIPadding,nl),Ai(()=>[this.container,this._locale],([e,i])=>{e&&e.setAttribute("lang",i)},nl),Fde(e=>{this._locale=e})])}destroy(){this.container=null;for(const e of this._components)e.destroy();this._components.length=0,this._componentMap.clear()}set container(e){const i=this._get("container");e!==i&&(e&&(e.classList.add(Ql.ui),Dst(e),this._attachContainers(e)),i&&(i.classList.remove(Ql.ui),wV(i,{top:"",bottom:"",left:"",right:""}),i.textContent=""),this._set("container",e))}get height(){var r;const e=((r=this.view)==null?void 0:r.height)??0;if(e===0)return e;const i=this._getViewPadding(),{top:s,bottom:n}=i;return Math.max(e-s-n,0)}get padding(){return this._get("padding")}set padding(e){this._overrideIfSome("padding",e)}castPadding(e){return typeof e=="number"?{bottom:e,top:e,right:e,left:e}:{...L1e,...e}}get width(){var r;const e=((r=this.view)==null?void 0:r.width)??0;if(e===0)return e;const i=this._getViewPadding(),{left:s,right:n}=i;return Math.max(e-s-n,0)}add(e,i){let s,n,r;if(Array.isArray(e))return void e.forEach(a=>this.add(a,i));const o=bV(e);o&&({index:s,position:i,component:e,key:n}=o),i&&typeof i=="object"&&({index:s,key:n,position:i,internal:r}=i),!e||i&&!this._isValidPosition(i)||this._add(e,i,s,n,r)}remove(e,i){var n,r;if(!e)return;if(Array.isArray(e))return e.map(o=>this.remove(o,i));const s=this._find(e);if(s){if(this._componentMap.has(s)&&((n=this._componentMap.get(s))==null?void 0:n.key)!==i)return;const o=this._components.indexOf(s),a=s.node.parentNode;return a==null||a.removeChild(s.node),this._componentMap.delete(s),(r=s.widget)==null||r.removeHandlesReference(this._removeWidgetHandleKey),this._components.splice(o,1)[0]}}empty(e,i={removeInternal:!1}){if(Array.isArray(e)){for(const r of e)this.empty(r,i);return}const s=this._positionNameToContainerLookup[e??"manual"],n=Array.prototype.slice.call(s.children).map(r=>this._findByNode(r)).filter(r=>{var o;return r==null?!1:!(((o=this._componentMap.get(r))==null?void 0:o.internal)??!1)||i.removeInternal});for(const r of n)this.remove(r)}move(e,i){if(Array.isArray(e)&&e.forEach(o=>this.move(o,i)),!e)return;let s;const n=bV(e)||bV(i);if(n&&(s=n.index,i=n.position,e=n.component||e),i&&!this._isValidPosition(i))return;const r=this.remove(e);r&&this.add(r,{position:i,index:s})}find(e){if(!e)return null;const i=this._findById(e);return i&&(i.widget||i.node)}getComponents(e,i={includeInternal:!1}){return e?Array.isArray(e)?e.flatMap(s=>this._getComponentsAtPosition(s,i)):this._getComponentsAtPosition(e,i):this._components.filter(s=>{var n;return i.includeInternal||!((n=this._componentMap.get(s))!=null&&n.internal)}).map(({widget:s,node:n})=>s??n)}getPosition(e){for(const i in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[i].contains(e))return i;return null}_add(e,i,s,n,r){e instanceof k3||(e=new k3({node:e}));const{widget:o}=e;o!=null&&o instanceof ei&&o.addHandles(Gs(()=>{queueMicrotask(()=>this.remove(e))}),this._removeWidgetHandleKey),this._place({component:e,position:i,index:s}),this._components.push(e),this._componentMap.set(e,{key:n,internal:r})}_find(e){return e?e instanceof k3?this._findByComponent(e):typeof e=="string"?this._findById(e):this._findByNode(e.domNode||e):null}_getViewPadding(){var e;return((e=this.view)==null?void 0:e.padding)??Rst}_attachContainers(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}_initContainers(){const e=document.createElement("div");e.classList.add(Ql.innerContainer,Ql.cornerContainer);const i=document.createElement("div");i.classList.add(Ql.innerContainer,Ql.manualContainer);const s=document.createElement("div");s.classList.add(Ql.topLeft,Ql.corner),e.appendChild(s);const n=document.createElement("div");n.classList.add(Ql.topRight,Ql.corner),e.appendChild(n);const r=document.createElement("div");r.classList.add(Ql.bottomLeft,Ql.corner),e.appendChild(r);const o=document.createElement("div");o.classList.add(Ql.bottomRight,Ql.corner),e.appendChild(o),this._innerContainer=e,this._manualContainer=i;const a=XXe();this._cornerNameToContainerLookup={"top-left":s,"top-right":n,"bottom-left":r,"bottom-right":o,"top-leading":a?n:s,"top-trailing":a?s:n,"bottom-leading":a?o:r,"bottom-trailing":a?r:o},this._positionNameToContainerLookup={manual:i,...this._cornerNameToContainerLookup}}_isValidPosition(e){return!!this._positionNameToContainerLookup[e]}_place(e){var u,c;const i=e.position??"manual",{component:s,index:n}=e,r=this._positionNameToContainerLookup[i],o=n!=null&&n>-1;if(Ost(s.widget)&&s.widget.startup(),!o)return void r.appendChild(s.node);const a=Array.from(r.children);if(n===0){const{firstChild:h}=r;return void(h?(u=h.parentNode)==null?void 0:u.insertBefore(s.node,h):r.appendChild(s.node))}if(n>=a.length)return void r.appendChild(s.node);const l=a[n];(c=l.parentNode)==null||c.insertBefore(s.node,l)}_toPixelPosition(e){return{top:sR(e.top),left:sR(e.left),right:sR(e.right),bottom:sR(e.bottom)}}_findByComponent(e){return this._components.find(i=>i===e)??null}_findById(e){return this._components.find(({id:i})=>i===e)??null}_findByNode(e){return this._components.find(({node:i})=>i===e)??null}_getComponentsAtPosition(e,i){const s=this._positionNameToContainerLookup[e];return Array.prototype.slice.call(s.children).map(n=>this._findByNode(n)).filter(Df).filter(n=>{var r;return i.includeInternal||!((r=this._componentMap.get(n))!=null&&r.internal)}).map(({widget:n,node:r})=>n??r)}};y([S()],lm.prototype,"_locale",void 0),y([S()],lm.prototype,"container",null),y([S()],lm.prototype,"height",null),y([S({value:L1e})],lm.prototype,"padding",null),y([Ls("padding")],lm.prototype,"castPadding",null),y([S()],lm.prototype,"view",void 0),y([S()],lm.prototype,"width",null),lm=y([se("esri.views.ui.UI")],lm);const Lst=lm,Fst="randomUUID"in crypto;function sk(){if(Fst)return crypto.randomUUID();const t=crypto.getRandomValues(new Uint16Array(8));t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;const e=i=>t[i].toString(16).padStart(4,"0");return e(0)+e(1)+"-"+e(2)+"-"+e(3)+"-"+e(4)+"-"+e(5)+e(6)+e(7)}function wbt(){return`{${sk().toUpperCase()}}`}function kst(){return`{${sk()}}`}function $st(t){const e=t.toUpperCase();return t[0]!=="{"?`{${e}}`:e}const Ust={handleInterceptedEvent:(t,e,i,s)=>(t.scheduleRender(),e.properties[`on${s.type}`].apply(e.properties.bind||i,[s]))},Vst={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,i)=>{e.charAt(0)==="-"?t.style.setProperty(e,i):t.style[e]=i}},zst=t=>({...Vst,...t}),Gst=(t,e)=>{const i=[];for(;t&&t!==e;)i.push(t),t=t.parentNode;return i},Bst=(t,e)=>t.find(e),xre=(t,e,i=!1)=>{let s=t;return e.forEach((n,r)=>{const o=s!=null&&s.children?Bst(s.children,a=>a.domNode===n):void 0;i&&!o&&r!==e.length-1||(s=o)}),s},qst=t=>{let e;const i={...Ust,...t},s=zst(i),n=s.performanceLogger;let r,o=!0,a=!1;const l=[],u=[],c=(d,m,f)=>{var x;let _;s.eventHandlerInterceptor=(w,T,C,M)=>function(A){let I;n("domEvent",A);const L=Gst(A.currentTarget,_.domNode),D=L.some(U=>{var $;return customElements.get(($=U==null?void 0:U.tagName)==null?void 0:$.toLowerCase())});if(A.eventPhase===Event.CAPTURING_PHASE||!D)L.reverse(),I=xre(_.getLastRender(),L);else{const U=A.composedPath(),$=U.slice(U.indexOf(A.currentTarget),U.indexOf(_.domNode)).reverse();I=xre(_.getLastRender(),$,!0)}let O;return I&&(O=i.handleInterceptedEvent(e,I,this,A)),n("domEventProcessed",A),O},(x=i.postProcessProjectionOptions)==null||x.call(i,s);const v=f();_=d(m,v,s),s.eventHandlerInterceptor=void 0,l.push(_),u.push(f),i.afterFirstVNodeRendered&&i.afterFirstVNodeRendered(_,v)};let h=()=>{if(r=void 0,o){o=!1,n("renderStart",void 0);for(let d=0;d<l.length;d++){const m=u[d]();n("rendered",void 0);try{l[d].update(m)}catch(f){console.error(f)}n("patched",void 0)}n("renderDone",void 0),o=!0}};return i.modifyDoRenderImplementation&&(h=i.modifyDoRenderImplementation(h,l,u)),e={renderNow:h,scheduleRender:()=>{r||a||(r=requestAnimationFrame(h))},stop:()=>{r&&(cancelAnimationFrame(r),r=void 0),a=!0},resume:()=>{a=!1,o=!0,e.scheduleRender()},append:(d,m)=>{c(Q_.append,d,m)},insertBefore:(d,m)=>{c(Q_.insertBefore,d,m)},merge:(d,m)=>{c(Q_.merge,d,m)},replace:(d,m)=>{c(Q_.replace,d,m)},detach:d=>{for(let m=0;m<u.length;m++)if(u[m]===d)return u.splice(m,1),l.splice(m,1)[0];throw new Error("renderFunction was not found")}},e};var Hst=";",SV=",",jst=":",R1=class{resolve(t){}reject(t){}constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}};function Yst(t,e){let i=t;for(;i;){if(i===e)return!0;if(!i.parentNode)return!1;i.parentNode instanceof ShadowRoot?i=i.parentNode.host:i=i.parentNode}return!1}function Xst(t,e,i){const{subscribe:s}=Wst(e);return s(n=>{n.some(o=>Yst(t,o.target))&&i()})}var EV={};function Wst(t){const e=t.join(","),i=EV[e];if(i!==void 0)return i;const s=new Set,n=new MutationObserver(o=>s.forEach(a=>a(o)));globalThis.document&&n.observe(document.documentElement,{attributes:!0,attributeFilter:t,subtree:!0});const r={subscribe(o){return s.add(o),()=>{s.delete(o),s.size===0&&(n.disconnect(),EV[e]=void 0)}}};return EV[e]=r,r}function Zst(t,e){var s,n;let i=t;for(;i;){const r=(s=i.closest)==null?void 0:s.call(i,e);if(r)return r;const o=(n=i.getRootNode)==null?void 0:n.call(i);if(o===globalThis.document)return null;i=o.host}return null}function Kst(t,e,i){const s=Zst(t,`[${e}]`);return(s==null?void 0:s.getAttribute(e))??i}function pr(t,e,...i){try{return t==null?void 0:t.call(e,...i)}catch(s){console.error(s,t)}}async function Aq(t,e,...i){try{const s=t==null?void 0:t.call(e,...i);return s instanceof Promise?await s:s}catch(s){console.error(s,t)}}var Qst=["ar","bg","bs","ca","cs","da","de","el","en","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nl","nb","no","pl","pt-BR","pt-PT","ro","ru","sk","sl","sr","sv","th","tr","uk","vi","zh-CN","zh-HK","zh-TW"],Jst=new Set(Qst),QL="en",ent={pt:"pt-PT",nb:"no",zh:"zh-CN"};async function tnt(t,e,i=""){const s=`${e}/${i}`,n=`${s}${t}.json`;return CV[n]??(CV[n]=F1e(t,s)),await CV[n]}var CV={};async function F1e(t,e){const i=`${e}${t}.json`;try{const s=await fetch(i);if(s.ok)return await s.json()}catch(s){return console.error(s),{}}return t===QL?{}:await F1e(QL,e)}function k1e(t){var i;const e=Kst(t,"lang",((i=globalThis.navigator)==null?void 0:i.language)||QL);return{lang:e,t9nLocale:$1e(e)}}function $1e(t){const[e,i]=t.split("-"),s=e.toLowerCase();let n=s;return i&&(n=`${s}-${i.toUpperCase()}`),n=ent[n]??n,Jst.has(n)?n:i?$1e(s):QL}function int(t,e,i,s){let n;const r=()=>void snt(t,e(),s).then(o=>{((n==null?void 0:n.lang)!==o.lang||n.t9nLocale!==o.t9nLocale||n.t9nStrings!==o.t9nStrings)&&i(o),n=o}).catch(console.error);return queueMicrotask(r),Xst(t,["lang"],r)}async function snt(t,e,i=t.tagName.toLowerCase().split("-").slice(1).join("-")){const{lang:s,t9nLocale:n}=k1e(t),r=`${e}/${i}/t9n`,a=i===null?{}:await tnt(n,r,"messages.");return{lang:s,t9nLocale:n,t9nStrings:a}}var U1e=t=>t.replace(nnt,(e,i)=>`${i===0?"":"-"}${e.toLowerCase()}`),nnt=/[A-Z]+(?![a-z])|[A-Z]/gu;function rnt(t,e){const i=e/ont;let s=0;const n=setInterval(()=>{s+=i,s>=e&&(clearInterval(n),t())},i);return n}var ont=4;function ant(t){return t!==void 0}function V1e(t){var i,s;let e=t;for(;e=e.parentNode??e.host;)if((i=e==null?void 0:e.constructor)!=null&&i.lumina){const n=e;return(s=n.manager)!=null&&s.loadedCalled||n._offspring.push(t),n._postLoad.promise}return!1}var lnt=(t,e)=>function(s,n){if(!globalThis.customElements)return;const o=(n??s??{}).resourcesUrl;o&&t.setAssetPath(o),Object.entries(e).forEach(unt)};function unt([t,[e,i=""]]){var u;if(customElements.get(t))return;const[s,n,r]=i.split(Hst),o=s?s==null?void 0:s.split(SV).map(z1e):void 0,a=o==null?void 0:o.map(([c])=>c),l=(u=class extends hnt{constructor(){!l._loadPromise&&(l._loadPromise=e(),l._initializePrototype()),super()}},u.observedAttributes=o==null?void 0:o.map(([,h])=>h).filter(h=>h!==""),u._properties=a,u._asyncMethods=n?n==null?void 0:n.split(SV):void 0,u._syncMethods=r==null?void 0:r.split(SV),u._name=t,u);customElements.define(t,l)}var $3=Object.defineProperty;function z1e(t){const e=t.split(jst);return e.length===1?[e[0],U1e(e[0])]:e}var cnt=globalThis.HTMLElement??z1e,Yw,hnt=(Yw=class extends cnt{constructor(){super(),this._store={},this._pendingAttributes=[],this._postLoad=new R1,this._postLoaded=new R1,this._offspring=[],this._saveInstanceProperties();const e=this.constructor;e._LitConstructor?this._initializeComponent({a:e._LitConstructor}):e._loadPromise.then(this._initializeComponent.bind(this)).catch(i=>{this._postLoaded.reject(i),setTimeout(()=>{throw i})})}static _initializePrototype(){var e,i,s;(e=this._properties)==null||e.forEach(this._bindProp,this),(i=this._asyncMethods)==null||i.forEach(this._bindAsync,this),(s=this._syncMethods)==null||s.forEach(this._bindSync,this)}static _bindProp(e){$3(this.prototype,e,{configurable:!0,enumerable:!0,get(){return this._store[e]},set(i){this._store[e]=i}})}static _bindAsync(e){$3(this.prototype,e,{async value(...i){return this._litElement||await this._postLoaded.promise,await this._litElement[e](...i)},configurable:!0})}static _bindSync(e){$3(this.prototype,e,{value(...i){return this._litElement[e](...i)},configurable:!0})}get manager(){var e;return(e=this._litElement)==null?void 0:e.manager}_saveInstanceProperties(){var s;const e=this.constructor,i=this;(s=e._properties)==null||s.forEach(n=>{Object.hasOwn(this,n)&&(this._store[n]=i[n],delete i[n])})}attributeChangedCallback(e,i,s){var n;(n=this._litElement)==null||n.attributeChangedCallback(e,i,s),this._litElement||this._pendingAttributes.push(e)}connectedCallback(){var e,i;this._litElement?(i=(e=this._litElement).connectedCallback)==null||i.call(e):queueMicrotask(()=>{this._ancestorLoad=V1e(this)})}disconnectedCallback(){var e,i;(i=(e=this._litElement)==null?void 0:e.disconnectedCallback)==null||i.call(e)}async componentOnReady(){return await this._postLoaded.promise,this}_initializeComponent(e){var h;const i=this.constructor,s=i._name,n=this._store,r=Object.values(e).find(d=>d.tagName===s),o=`${s}--lazy`;let a=r;for(;a&&!Object.hasOwn(a,"lumina");)a=Object.getPrototypeOf(a);mnt(a),!i._LitConstructor&&(i._LitConstructor=r,customElements.define(o,r)),r.lazy=this;const u=document.createElement(o);r.lazy=void 0,this._litElement=u,this._store=u,this._pendingAttributes.forEach(d=>{const m=this.getAttribute(d);u.attributeChangedCallback(d,null,m)}),Object.entries(n).forEach(dnt,u);const c=this.isConnected;(c||this._ancestorLoad)&&((h=u.connectedCallback)==null||h.call(u),c||u.disconnectedCallback())}addController(){}requestUpdate(){var e;(e=this._litElement)==null||e.requestUpdate()}},Yw.lumina=!0,Yw);function dnt([t,e]){this[t]=e}function mnt(t){const e=t.prototype,i=Element.prototype;Object.hasOwn(e,"isConnected")||(e.setAttribute=function(n,r){i.setAttribute.call(this.el,n,r)},e.removeAttribute=function(n){i.removeAttribute.call(this.el,n)},$3(e,"isConnected",{get(){return Reflect.get(i,"isConnected",this.el)}}))}var bre={};function pnt(t,e){var i;if(e){const s=t.constructor.elementProperties;t.manager.internals.members=Object.fromEntries(Array.from(s,([n,r])=>r.noAccessor?void 0:[n,[(r.readOnly?2048:0)|(r.state?32:16)]]).filter(ant))}else{const s=t.constructor,n=((i=s.__registerControllers)==null?void 0:i.call(s,t))??void 0;if(s.__registerControllers=void 0,typeof n!="object")throw new Error("Failed to retrieve component meta");t.manager.internals.members=Object.fromEntries(Object.entries(n).filter(([r,[o]])=>(o&63)!==0))}}function fnt(t,e=8){return t==null||typeof t=="object"||typeof t=="function"?t:(e&4)!==0?t==="false"?!1:t===""||!!t:(e&2)!==0?Number.parseFloat(t):(e&1)!==0?String(t):t}var gnt=(t,e)=>{var i,s;return(s=(i=t.manager.internals.members)==null?void 0:i[e])==null?void 0:s[0]},zY=Symbol.for("controller"),_nt=t=>typeof t=="object"&&t!==null&&(zY in t||"hostConnected"in t||"hostDisconnected"in t||"hostUpdate"in t||"hostUpdated"in t),yT;function _w(t){yT!==t&&(yT=t,queueMicrotask(()=>{yT===t&&(yT=void 0)}))}function nk(t){return yT}var lv=[];function G1e(t){if(t===void 0){lv=[];return}const e=lv.indexOf(t);lv=e===-1?[...lv,t]:lv.slice(0,e+1),queueMicrotask(()=>{lv=[]})}function B1e(){return lv}var yw;function ynt(t){yw!==t&&(yw=t,queueMicrotask(()=>{yw===t&&(yw=void 0)}))}function vnt(){const t=yw;return yw=void 0,t}var xnt=async(t,e)=>{const i=GY(t);if(i===void 0)return t;if(await i.ready,typeof e=="function"){const s=i.watchExports(n=>e(n,s))}return i.exports},bnt=async t=>{const e=GY(t);return await e.ready,e},GY=t=>{const i=nk().manager.internals.resolveExports(t);if(i!==void 0)return i;if(_nt(t))return t;const s=vnt();if(s!==void 0)return s},Iq={readOnly:!1},JL=new WeakMap,q1e;q1e=zY;var BY=class{constructor(t){this._callbacks={hostConnected:[],hostDisconnected:[],hostLoad:[],hostLoaded:[],hostUpdate:[],hostUpdated:[],hostDestroy:[],hostLifecycle:[]},this._ready=new R1,this._lifecycleCleanups=[],this.connectedCalled=!1,this._loadCalled=!1,this.loadedCalled=!1,this[q1e]=!0,this.ready=this._ready.promise,this._exports=Sre(this),this._exportWatchers=new Set;const e=t??nk();this.component=e,this.component.addController(this),this.component.manager===void 0||(G1e(this),queueMicrotask(()=>this.catchUpLifecycle()))}catchUpLifecycle(){const{manager:t}=this.component;t.connectedCalled&&!this.connectedCalled&&this.triggerConnected(),t._loadCalled&&this.triggerLoad().then(()=>{t.loadedCalled&&this.triggerLoaded()}).catch(console.error)}get exports(){return this._exports}set exports(t){const e=this._exports;e!==t&&(this._exports=t,this._exportWatchers.forEach(pr),this.connectedCalled&&this.assignedProperty!==!1&&this.component.requestUpdate(this.assignedProperty,e)),this._ready.resolve(t)}setProvisionalExports(t,e=!0){this._exports=e?Sre(t):t,this._exportWatchers.forEach(pr)}watchExports(t){const e=()=>t(this._exports);return this._exportWatchers.add(e),()=>void this._exportWatchers.delete(e)}get use(){return _w(this.component),xnt}get useRef(){return _w(this.component),bnt}get useRefSync(){return _w(this.component),GY}controllerRemoved(){this.component.el.isConnected&&this.triggerDisconnected(),this.triggerDestroy()}onConnected(t){this._callbacks.hostConnected.push(t)}onDisconnected(t){this._callbacks.hostDisconnected.push(t)}onLoad(t){this._callbacks.hostLoad.push(t)}onLoaded(t){this._callbacks.hostLoaded.push(t)}onUpdate(t){this._callbacks.hostUpdate.push(t)}onUpdated(t){this._callbacks.hostUpdated.push(t)}onDestroy(t){this._callbacks.hostDestroy.push(t)}onLifecycle(t){this._callbacks.hostLifecycle.push(t),this.connectedCalled&&this.component.el.isConnected&&this._callLifecycle(t)}triggerConnected(){const t=this;t.hostConnected&&pr(t.hostConnected,t),this._callbacks.hostConnected.forEach(pr),this.triggerLifecycle(),this.connectedCalled=!0}triggerDisconnected(){const t=this;t.hostDisconnected&&pr(t.hostDisconnected,t),this._callbacks.hostDisconnected.forEach(pr),this._lifecycleCleanups.forEach(pr),this._lifecycleCleanups=[]}async triggerLoad(){if(this._loadCalled)return;this._loadCalled=!0;const t=this;t.hostLoad&&await Aq(t.hostLoad,t),this._callbacks.hostLoad.length>0&&await Promise.allSettled(this._callbacks.hostLoad.map(Aq)),this._ready.resolve(this._exports)}triggerLoaded(){if(this.loadedCalled)return;const t=this;t.hostLoaded&&pr(t.hostLoaded,t),this._callbacks.hostLoaded.forEach(pr),this.loadedCalled=!0}triggerUpdate(t){const e=this;e.hostUpdate&&pr(e.hostUpdate,e,t),this._callbacks.hostUpdate.forEach(wre,t)}triggerUpdated(t){const e=this;e.hostUpdated&&pr(e.hostUpdated,e,t),this._callbacks.hostUpdated.forEach(wre,t)}triggerDestroy(){const t=this;t.hostDestroy&&pr(t.hostDestroy,t),this._callbacks.hostDestroy.forEach(pr)}triggerLifecycle(){const t=this;t.hostLifecycle&&this._callLifecycle(()=>t.hostLifecycle()),this._callbacks.hostLifecycle.forEach(this._callLifecycle,this)}_callLifecycle(t){_w(this.component);const e=pr(t);(Array.isArray(e)?e:[e]).forEach(s=>{typeof s=="function"?this._lifecycleCleanups.push(s):typeof s=="object"&&typeof s.remove=="function"&&this._lifecycleCleanups.push(s.remove)})}};function wre(t){pr(t,void 0,this)}var wnt=BY;function Sre(t){if(typeof t!="object"&&typeof t!="function"||t===null)return t;const e=new Proxy(t,{get(i,s,n){if(!(Snt.has(s)&&s in i&&i[s]===e)&&(s in i||s in Promise.prototype||typeof s=="symbol"))return typeof i=="function"?i[s]:Reflect.get(i,s,n)},set:(i,s,n,r)=>Reflect.set(i,s,n,r)});return e}var Snt=new Set(["exports","_exports"]);function Ent(t,e,i){const s=Object.keys(t),n=s.length;yf===void 0&&queueMicrotask(qY),yf??(yf=new Map);let r=yf.get(t);return r===void 0&&(r={callbacks:[],keyCount:n},yf.set(t,r)),r.keyCount!==n&&(r.callbacks.forEach(o=>o(s)),r.callbacks=[],r.keyCount=n),r.callbacks.push(o=>{const a=u=>pr(e,null,u),l=o[n];l===void 0?a(void 0):t[l]===i?a(l):a(void 0)}),i}var yf=void 0;function qY(){Array.from((yf==null?void 0:yf.entries())??[]).forEach(([t,{callbacks:e}])=>{const i=Object.keys(t);e.forEach(s=>s(i))}),yf=void 0}function HY(t,e,i){var s;const n=e,r=t.manager.internals;(s=r.allWatchers)[n]??(s[n]=[]);const o=r.allWatchers[n],a=i,l=(u,c,h)=>pr(a,null,u,c,h);return o.push(l),()=>{const u=o.indexOf(l);u!==-1&&o.splice(u,1)}}var Cnt=class{constructor(t){this.enabledWatchers={},this.allWatchers={},this.enableReadonly=()=>{if(this.enableReadonly=void 0,!this.component.manager.isLit)return;const e=this.component.manager.internals;Object.entries(e.members).forEach(([i,[s]])=>{var n;s&2048&&((n=e.setters)[i]??(n[i]=[]),e.setters[i].push(e.readonlySetter))})},this.trackedValue=Dq,this.keyTrackers=[],this.getters={},this.setters={},this.accessorGetter={},this.accessorSetter={},this._exports=new WeakMap,this.readonlySetter=(e,i,s)=>{if(Iq.readOnly)return e;throw new Error(`Cannot assign to read-only property "${s}" of ${this.component.el.tagName.toLowerCase()}. Trying to assign "${String(e)}"`)},this.component=t}firePropTrackers(t,e){const i=this.keyTrackers;this.trackedValue=Dq,this.keyTrackers=[],i.forEach(s=>s(t,e))}getSetProxy(t){const e=this.component,i=e.constructor.prototype;if(this._getSetProxy(i,t,"class"),e.manager.isLit)return;const s=e.el.constructor.prototype;i!==s&&this._getSetProxy(s,t,"html")}_getSetProxy(t,e,i){const s=this.component,n=gnt(s,e);let r;do r=Object.getOwnPropertyDescriptor(t,e);while(!r&&(t=Object.getPrototypeOf(t)));if(!r)return;const o=r.get,a=r.set,l=nR in o,u=nR in a;if(l&&u)return;const c=!l,h=!u,d=c?function(){let _=o.call(this);const v=JL.get(this);if(v===void 0)return _;const x=v.manager.internals;_=x.accessorGetter[e](_,e);const w=x.getters[e]??Ere;for(let T=0;T<w.length;T++)_=w[T](_,e);return _}:o,m=h?function(_){var C;const v=o.call(this),x=JL.get(this);if(x===void 0){a.call(this,_);return}let w=x.manager.isLit?_??void 0:fnt(_,n);const T=x.manager.internals;if(w===v)a.call(this,w);else{const M=T.setters[e]??Ere;for(let A=0;A<M.length&&(w=M[A](w,v,e),w!==v);A++);w=T.accessorSetter[e](w,v,e),a.call(this,w),w!==v&&((C=T.enabledWatchers[e])==null||C.forEach(A=>A(w,v,e)))}T.keyTrackers.length>0&&(T==null||T.firePropTrackers(e,_))}:a;c&&(d[nR]=!0),h&&(m[nR]=!0),Object.defineProperty(t,e,{...r,get:d,set:m})}markExports(t,e){(typeof e=="object"&&e!==null||typeof e=="function")&&this._exports.set(e,t)}resolveExports(t){if(typeof t=="object"&&t!==null||typeof t=="function")return this._exports.get(t)}},Ere=[],nR=Symbol(),Dq=Symbol();function Tnt(t,e,i){const s=t.manager.internals;return s.trackedValue!==Dq&&s.trackedValue!==i&&s.firePropTrackers(void 0,void 0),s.keyTrackers.length===0&&queueMicrotask(()=>s.firePropTrackers(void 0,void 0)),s.trackedValue=i,s.keyTrackers.push((n,r)=>pr(e,void 0,i===r?n:void 0)),i}function H1e(t=[nk(),...B1e()],e,i){const s=Array.isArray(t)?t:[t];let n=s.length+1;const r=a=>{n-=1,a!==void 0&&(n=Math.min(n,0)),n===0&&e(a)};s.forEach(a=>Ent(a,l=>r(l===void 0?void 0:{key:l,host:a,isReactive:!1}),i));const o=s.find(a=>"manager"in a&&typeof a.manager=="object"&&a.manager.component===a);return o&&Tnt(o,a=>r(a===void 0?void 0:{key:a,host:o,isReactive:!0}),i),i}function Pnt(t){Iq.readOnly=!0;try{return t()}finally{Iq.readOnly=!1}}var Mnt=t=>(...e)=>{const i=B1e(),s=new t(...e),n=s.exports;G1e(i.at(-1));const r=s.component.manager.internals;r.markExports(s,n),s.watchExports(a=>r.markExports(s,a)),ynt(s);const o=[s.component,...i].reverse();return H1e(o,a=>a===void 0?void 0:Ant(s,a,n),n)};function Ant(t,{host:e,key:i,isReactive:s},n){const r=e,o=r[i]!==t.exports,a=r[i]!==n,l=n!==t.exports;if(o&&!a&&l&&(r[i]=t.exports),e===t.component){if(s){const c=t.component.manager.internals;a&&c.markExports(t,r[i]),HY(t.component,i,h=>{h!==t.exports&&c.markExports(t,h)})}t.assignedProperty=s?void 0:i}t.watchExports(()=>{var d;if(r[i]===t.exports)return;const c=t.component.manager;((d=c.internals.setters[i])==null?void 0:d.includes(c.internals.readonlySetter))?Pnt(()=>{r[i]=t.exports}):r[i]=t.exports})}var Int=(t,e)=>new Dnt(t,e),Dnt=class extends wnt{constructor(t,e){const i="addController"in t,s=new Set;function n(l){var u;s.add(l),!(zY in l)&&t.renderRoot&&t.el.isConnected&&((u=l.hostConnected)==null||u.call(l))}function r(l){var u;s.delete(l),(u=l.controllerRemoved)==null||u.call(l)}const o=t;if(o.addController=n,o.removeController=r,!i){const l=e??t.constructor.__forceUpdate;o.requestUpdate=()=>l(t)}super(t),this.internals=new Cnt(this.component),this.destroyed=!1,this._updatePromise=new R1,this._originalLifecycles={},this.isLit=i,this.component.manager=this,pnt(t,i),this._controllers=s,this.exports=void 0,this.hasDestroy=TV in this.component&&typeof this.component.destroy=="function",this._bindLifecycleMethods();const a=this.internals;Object.keys(a.members).forEach(l=>{a.accessorGetter[l]=Cre,a.accessorSetter[l]=Cre,a.getSetProxy(l)}),i?this.internals.enabledWatchers=this.internals.allWatchers:Object.defineProperty(t,"updateComplete",{get:async()=>await this._updatePromise.promise}),queueMicrotask(a.enableReadonly),_w(t),JL.set(t.el,t),JL.set(t,t)}_bindLifecycleMethods(){const t=this.component,e=this.isLit,i=t.el===t;this._originalLifecycles={_connectedCallback:e||i?void 0:t.connectedCallback,_disconnectedCallback:e||i?void 0:t.disconnectedCallback,_load:e?t.load:t.componentWillLoad,_loaded:e?t.loaded:t.componentDidLoad,_willUpdate:e?void 0:t.componentWillUpdate,_updated:e?void 0:t.componentDidUpdate,_destroy:t.destroy};const s=this._connectedCallback.bind(this),n=this._disconnectedCallback.bind(this),r=this._update.bind(this),o=this._updated.bind(this);e?t.constructor.prototype.addController.call(t,{hostConnected:s,hostDisconnected:n,hostUpdate:r,hostUpdated:o}):(t.connectedCallback=s,t.disconnectedCallback=n,t.componentWillLoad=this._load.bind(this),t.componentDidLoad=this._loaded.bind(this),t.componentWillUpdate=r,t.componentDidUpdate=o),this.hasDestroy&&(t.destroy=this.destroy.bind(this))}_connectedCallback(){var e,i;if(this.destroyed){const s=this.component.el.tagName.toLowerCase();throw this.component.el.remove(),new Error(`The ${s} component has already been destroyed. It cannot be used again. If you meant to disconnect and reconnect a component without automatic destroy, set the ${TV} prop.`)}this._autoDestroyTimeout!==void 0&&clearTimeout(this._autoDestroyTimeout);const t=this.internals;t.enabledWatchers=t.allWatchers,qY(),(e=t.enableReadonly)==null||e.call(t),this._controllers.forEach(Rnt),(i=this._originalLifecycles._connectedCallback)==null||i.call(this.component)}_disconnectedCallback(){var t;this.destroyed||(this._controllers.forEach(Ont),(t=this._originalLifecycles._disconnectedCallback)==null||t.call(this.component),this.hasDestroy&&this._setAutoDestroyTimeout())}async _load(){var t;await Promise.allSettled(Array.from(this._controllers,Lnt)),await((t=this._originalLifecycles._load)==null?void 0:t.call(this.component)),this.hasDestroy&&HY(this.component,TV,()=>this._setAutoDestroyTimeout())}_loaded(){var t;this._controllers.forEach(Fnt),(t=this._originalLifecycles._loaded)==null||t.call(this.component)}_update(){var e;const t=this.component;return this._controllers.forEach(knt,t.$changes),(e=this._originalLifecycles._willUpdate)==null?void 0:e.call(this.component)}_updated(){var e;const t=this.component;if(this._controllers.forEach($nt,t.$changes),(e=this._originalLifecycles._updated)==null||e.call(this.component),this.isLit)t.$changes=new Map;else{const i=this._updatePromise;this._updatePromise=new R1,i.resolve(!0)}}async destroy(){var t;if(!this.destroyed){if(this.component.el.isConnected){this.hasDestroy=!1;try{this.component.el.remove()}finally{this.hasDestroy=!0}}this._autoDestroyTimeout=void 0,this.destroyed=!0,this._controllers.forEach(Unt),this._controllers.clear(),await((t=this._originalLifecycles._destroy)==null?void 0:t.call(this.component))}}_setAutoDestroyTimeout(){if(this._autoDestroyTimeout!==void 0&&clearTimeout(this._autoDestroyTimeout),!this.component.el.isConnected&&!this.component.autoDestroyDisabled){const t=()=>void this.destroy().catch(console.error);this._autoDestroyTimeout=rnt(t,Nnt)}}},TV="autoDestroyDisabled",Nnt=1e3,Cre=t=>t;function Rnt(t){"triggerConnected"in t?t.triggerConnected():pr(t.hostConnected,t)}function Ont(t){"triggerDisconnected"in t?t.triggerDisconnected():pr(t.hostDisconnected,t)}async function Lnt(t){"triggerLoad"in t?await t.triggerLoad():await Aq(t.hostLoad,t)}function Fnt(t){"triggerLoaded"in t?t.triggerLoaded():pr(t.hostLoaded,t)}function knt(t){"triggerUpdate"in t?t.triggerUpdate(this):pr(t.hostUpdate,t,this)}function $nt(t){"triggerUpdated"in t?t.triggerUpdated(this):pr(t.hostUpdated,t,this)}function Unt(t){"triggerDestroy"in t?t.triggerDestroy():pr(t.hostDestroy,t)}var Vnt=t=>j1e(void 0,t),Sbt=t=>e=>j1e(e,t),znt=class extends BY{constructor(t,e){super(t);const i=this.exports;try{_w(this.component);const s=e(this.component,this),n=this.exports!==i;if(s instanceof Promise){n||this.setProvisionalExports(s);const r=s.then(o=>{this.exports=o,super.catchUpLifecycle()}).catch(o=>{this._ready.reject(o),console.error(o)});this.onLoad(async()=>await r)}else(!n||s!==void 0)&&(this.exports=s),queueMicrotask(()=>super.catchUpLifecycle())}catch(s){this._ready.reject(s),console.error(s)}}catchUpLifecycle(){}},j1e=Mnt(znt),Ebt=(t,e)=>new Gnt(t,e),Gnt=class extends BY{constructor(t,e){super(),this._attributes=t,this._callback=e,this._observer=new MutationObserver(i=>{i.forEach(s=>{t.includes(s.attributeName)&&e.call(this.component,this.component.el.getAttribute(s.attributeName),s.oldValue,s.attributeName)})})}hostConnected(){this._attributes.forEach(t=>{this.component.el.hasAttribute(t)&&this._callback.call(this.component,null,this.component.el.getAttribute(t),t)}),this._observer.observe(this.component.el,{attributes:!0,attributeOldValue:!0,attributeFilter:this._attributes})}hostDisconnected(){this._observer.disconnect()}},Cbt=t=>(e={})=>Vnt((i,s)=>{const n=k1e(i.el),r={_lang:n.lang,_t9nLocale:n.t9nLocale,_loading:!0},o=i;s.onLifecycle(()=>int(i.el,()=>t("./assets"),({t9nLocale:l,t9nStrings:u,lang:c})=>{const h={...u,_lang:c,_t9nLocale:l,_loading:!1};s.exports=h;const d=u.componentLabel;typeof d=="string"&&"label"in i&&i.label==null&&(i.label??(i.label=d)),a(o.messageOverrides)},e.name));function a(l){const u=s.exports,c=u._original??u,h=Y1e(c,l);l&&(h._original=c),s.exports=h}return"messageOverrides"in o&&s.onLifecycle(()=>HY(o,"messageOverrides",a)),e.blocking?(s.setProvisionalExports(r,!1),s.ready):r});function Y1e(t,e){if(!e)return t;const i={...t};return Object.entries(e).forEach(([s,n])=>{typeof n=="object"?i[s]=Y1e(t[s],n):i[s]=n??t[s]}),i}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const U3=globalThis,jY=U3.ShadowRoot&&(U3.ShadyCSS===void 0||U3.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,YY=Symbol(),Tre=new WeakMap;let X1e=class{constructor(e,i,s){if(this._$cssResult$=!0,s!==YY)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=i}get styleSheet(){let e=this.o;const i=this.t;if(jY&&e===void 0){const s=i!==void 0&&i.length===1;s&&(e=Tre.get(i)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),s&&Tre.set(i,e))}return e}toString(){return this.cssText}};const Bnt=t=>new X1e(typeof t=="string"?t:t+"",void 0,YY),Pbt=(t,...e)=>{const i=t.length===1?t[0]:e.reduce((s,n,r)=>s+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(n)+t[r+1],t[0]);return new X1e(i,t,YY)},qnt=(t,e)=>{if(jY)t.adoptedStyleSheets=e.map(i=>i instanceof CSSStyleSheet?i:i.styleSheet);else for(const i of e){const s=document.createElement("style"),n=U3.litNonce;n!==void 0&&s.setAttribute("nonce",n),s.textContent=i.cssText,t.appendChild(s)}},Pre=jY?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let i="";for(const s of e.cssRules)i+=s.cssText;return Bnt(i)})(t):t;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:Hnt,defineProperty:jnt,getOwnPropertyDescriptor:Ynt,getOwnPropertyNames:Xnt,getOwnPropertySymbols:Wnt,getPrototypeOf:Znt}=Object,hy=globalThis,Mre=hy.trustedTypes,Knt=Mre?Mre.emptyScript:"",PV=hy.reactiveElementPolyfillSupport,cP=(t,e)=>t,Nq={toAttribute(t,e){switch(e){case Boolean:t=t?Knt:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let i=t;switch(e){case Boolean:i=t!==null;break;case Number:i=t===null?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t)}catch{i=null}}return i}},W1e=(t,e)=>!Hnt(t,e),Are={attribute:!0,type:String,converter:Nq,reflect:!1,hasChanged:W1e};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),hy.litPropertyMetadata??(hy.litPropertyMetadata=new WeakMap);let kb=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,i=Are){if(i.state&&(i.attribute=!1),this._$Ei(),this.elementProperties.set(e,i),!i.noAccessor){const s=Symbol(),n=this.getPropertyDescriptor(e,s,i);n!==void 0&&jnt(this.prototype,e,n)}}static getPropertyDescriptor(e,i,s){const{get:n,set:r}=Ynt(this.prototype,e)??{get(){return this[i]},set(o){this[i]=o}};return{get(){return n==null?void 0:n.call(this)},set(o){const a=n==null?void 0:n.call(this);r.call(this,o),this.requestUpdate(e,a,s)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??Are}static _$Ei(){if(this.hasOwnProperty(cP("elementProperties")))return;const e=Znt(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(cP("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(cP("properties"))){const i=this.properties,s=[...Xnt(i),...Wnt(i)];for(const n of s)this.createProperty(n,i[n])}const e=this[Symbol.metadata];if(e!==null){const i=litPropertyMetadata.get(e);if(i!==void 0)for(const[s,n]of i)this.elementProperties.set(s,n)}this._$Eh=new Map;for(const[i,s]of this.elementProperties){const n=this._$Eu(i,s);n!==void 0&&this._$Eh.set(n,i)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const i=[];if(Array.isArray(e)){const s=new Set(e.flat(1/0).reverse());for(const n of s)i.unshift(Pre(n))}else e!==void 0&&i.push(Pre(e));return i}static _$Eu(e,i){const s=i.attribute;return s===!1?void 0:typeof s=="string"?s:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$ES=new Promise(i=>this.enableUpdating=i),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(i=>i(this))}addController(e){var i;(this._$EO??(this._$EO=new Set)).add(e),this.renderRoot!==void 0&&this.isConnected&&((i=e.hostConnected)==null||i.call(e))}removeController(e){var i;(i=this._$EO)==null||i.delete(e)}_$E_(){const e=new Map,i=this.constructor.elementProperties;for(const s of i.keys())this.hasOwnProperty(s)&&(e.set(s,this[s]),delete this[s]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return qnt(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$EO)==null||e.forEach(i=>{var s;return(s=i.hostConnected)==null?void 0:s.call(i)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$EO)==null||e.forEach(i=>{var s;return(s=i.hostDisconnected)==null?void 0:s.call(i)})}attributeChangedCallback(e,i,s){this._$AK(e,s)}_$EC(e,i){var r;const s=this.constructor.elementProperties.get(e),n=this.constructor._$Eu(e,s);if(n!==void 0&&s.reflect===!0){const o=(((r=s.converter)==null?void 0:r.toAttribute)!==void 0?s.converter:Nq).toAttribute(i,s.type);this._$Em=e,o==null?this.removeAttribute(n):this.setAttribute(n,o),this._$Em=null}}_$AK(e,i){var r;const s=this.constructor,n=s._$Eh.get(e);if(n!==void 0&&this._$Em!==n){const o=s.getPropertyOptions(n),a=typeof o.converter=="function"?{fromAttribute:o.converter}:((r=o.converter)==null?void 0:r.fromAttribute)!==void 0?o.converter:Nq;this._$Em=n,this[n]=a.fromAttribute(i,o.type),this._$Em=null}}requestUpdate(e,i,s){if(e!==void 0){if(s??(s=this.constructor.getPropertyOptions(e)),!(s.hasChanged??W1e)(this[e],i))return;this.P(e,i,s)}this.isUpdatePending===!1&&(this._$ES=this._$ET())}P(e,i,s){this._$AL.has(e)||this._$AL.set(e,i),s.reflect===!0&&this._$Em!==e&&(this._$Ej??(this._$Ej=new Set)).add(e)}async _$ET(){this.isUpdatePending=!0;try{await this._$ES}catch(i){Promise.reject(i)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var s;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[r,o]of this._$Ep)this[r]=o;this._$Ep=void 0}const n=this.constructor.elementProperties;if(n.size>0)for(const[r,o]of n)o.wrapped!==!0||this._$AL.has(r)||this[r]===void 0||this.P(r,this[r],o)}let e=!1;const i=this._$AL;try{e=this.shouldUpdate(i),e?(this.willUpdate(i),(s=this._$EO)==null||s.forEach(n=>{var r;return(r=n.hostUpdate)==null?void 0:r.call(n)}),this.update(i)):this._$EU()}catch(n){throw e=!1,this._$EU(),n}e&&this._$AE(i)}willUpdate(e){}_$AE(e){var i;(i=this._$EO)==null||i.forEach(s=>{var n;return(n=s.hostUpdated)==null?void 0:n.call(s)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Ej&&(this._$Ej=this._$Ej.forEach(i=>this._$EC(i,this[i]))),this._$EU()}updated(e){}firstUpdated(e){}};kb.elementStyles=[],kb.shadowRootOptions={mode:"open"},kb[cP("elementProperties")]=new Map,kb[cP("finalized")]=new Map,PV==null||PV({ReactiveElement:kb}),(hy.reactiveElementVersions??(hy.reactiveElementVersions=[])).push("2.0.4");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const hP=globalThis,eF=hP.trustedTypes,Ire=eF?eF.createPolicy("lit-html",{createHTML:t=>t}):void 0,Z1e="$lit$",B_=`lit$${Math.random().toFixed(9).slice(2)}$`,K1e="?"+B_,Qnt=`<${K1e}>`,O1=document,CM=()=>O1.createComment(""),TM=t=>t===null||typeof t!="object"&&typeof t!="function",XY=Array.isArray,Q1e=t=>XY(t)||typeof(t==null?void 0:t[Symbol.iterator])=="function",MV=`[ 	
\f\r]`,rC=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Dre=/-->/g,Nre=/>/g,R0=RegExp(`>|${MV}(?:([^\\s"'>=/]+)(${MV}*=${MV}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),Rre=/'/g,Ore=/"/g,J1e=/^(?:script|style|textarea|title)$/i,exe=t=>(e,...i)=>({_$litType$:t,strings:e,values:i}),Abt=exe(1),Ibt=exe(2),Bf=Symbol.for("lit-noChange"),Oo=Symbol.for("lit-nothing"),Lre=new WeakMap,Hv=O1.createTreeWalker(O1,129);function txe(t,e){if(!XY(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return Ire!==void 0?Ire.createHTML(e):e}const Jnt=(t,e)=>{const i=t.length-1,s=[];let n,r=e===2?"<svg>":e===3?"<math>":"",o=rC;for(let a=0;a<i;a++){const l=t[a];let u,c,h=-1,d=0;for(;d<l.length&&(o.lastIndex=d,c=o.exec(l),c!==null);)d=o.lastIndex,o===rC?c[1]==="!--"?o=Dre:c[1]!==void 0?o=Nre:c[2]!==void 0?(J1e.test(c[2])&&(n=RegExp("</"+c[2],"g")),o=R0):c[3]!==void 0&&(o=R0):o===R0?c[0]===">"?(o=n??rC,h=-1):c[1]===void 0?h=-2:(h=o.lastIndex-c[2].length,u=c[1],o=c[3]===void 0?R0:c[3]==='"'?Ore:Rre):o===Ore||o===Rre?o=R0:o===Dre||o===Nre?o=rC:(o=R0,n=void 0);const m=o===R0&&t[a+1].startsWith("/>")?" ":"";r+=o===rC?l+Qnt:h>=0?(s.push(u),l.slice(0,h)+Z1e+l.slice(h)+B_+m):l+B_+(h===-2?a:m)}return[txe(t,r+(t[i]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),s]};let Rq=class ixe{constructor({strings:e,_$litType$:i},s){let n;this.parts=[];let r=0,o=0;const a=e.length-1,l=this.parts,[u,c]=Jnt(e,i);if(this.el=ixe.createElement(u,s),Hv.currentNode=this.el.content,i===2||i===3){const h=this.el.content.firstChild;h.replaceWith(...h.childNodes)}for(;(n=Hv.nextNode())!==null&&l.length<a;){if(n.nodeType===1){if(n.hasAttributes())for(const h of n.getAttributeNames())if(h.endsWith(Z1e)){const d=c[o++],m=n.getAttribute(h).split(B_),f=/([.?@])?(.*)/.exec(d);l.push({type:1,index:r,name:f[2],strings:m,ctor:f[1]==="."?ert:f[1]==="?"?trt:f[1]==="@"?irt:ok}),n.removeAttribute(h)}else h.startsWith(B_)&&(l.push({type:6,index:r}),n.removeAttribute(h));if(J1e.test(n.tagName)){const h=n.textContent.split(B_),d=h.length-1;if(d>0){n.textContent=eF?eF.emptyScript:"";for(let m=0;m<d;m++)n.append(h[m],CM()),Hv.nextNode(),l.push({type:2,index:++r});n.append(h[d],CM())}}}else if(n.nodeType===8)if(n.data===K1e)l.push({type:2,index:r});else{let h=-1;for(;(h=n.data.indexOf(B_,h+1))!==-1;)l.push({type:7,index:r}),h+=B_.length-1}r++}}static createElement(e,i){const s=O1.createElement("template");return s.innerHTML=e,s}};function L1(t,e,i=t,s){var o,a;if(e===Bf)return e;let n=s!==void 0?(o=i._$Co)==null?void 0:o[s]:i._$Cl;const r=TM(e)?void 0:e._$litDirective$;return(n==null?void 0:n.constructor)!==r&&((a=n==null?void 0:n._$AO)==null||a.call(n,!1),r===void 0?n=void 0:(n=new r(t),n._$AT(t,i,s)),s!==void 0?(i._$Co??(i._$Co=[]))[s]=n:i._$Cl=n),n!==void 0&&(e=L1(t,n._$AS(t,e.values),n,s)),e}let sxe=class{constructor(e,i){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=i}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:i},parts:s}=this._$AD,n=((e==null?void 0:e.creationScope)??O1).importNode(i,!0);Hv.currentNode=n;let r=Hv.nextNode(),o=0,a=0,l=s[0];for(;l!==void 0;){if(o===l.index){let u;l.type===2?u=new rk(r,r.nextSibling,this,e):l.type===1?u=new l.ctor(r,l.name,l.strings,this,e):l.type===6&&(u=new rxe(r,this,e)),this._$AV.push(u),l=s[++a]}o!==(l==null?void 0:l.index)&&(r=Hv.nextNode(),o++)}return Hv.currentNode=O1,n}p(e){let i=0;for(const s of this._$AV)s!==void 0&&(s.strings!==void 0?(s._$AI(e,s,i),i+=s.strings.length-2):s._$AI(e[i])),i++}},rk=class nxe{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,i,s,n){this.type=2,this._$AH=Oo,this._$AN=void 0,this._$AA=e,this._$AB=i,this._$AM=s,this.options=n,this._$Cv=(n==null?void 0:n.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const i=this._$AM;return i!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=i.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,i=this){e=L1(this,e,i),TM(e)?e===Oo||e==null||e===""?(this._$AH!==Oo&&this._$AR(),this._$AH=Oo):e!==this._$AH&&e!==Bf&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):Q1e(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==Oo&&TM(this._$AH)?this._$AA.nextSibling.data=e:this.T(O1.createTextNode(e)),this._$AH=e}$(e){var r;const{values:i,_$litType$:s}=e,n=typeof s=="number"?this._$AC(e):(s.el===void 0&&(s.el=Rq.createElement(txe(s.h,s.h[0]),this.options)),s);if(((r=this._$AH)==null?void 0:r._$AD)===n)this._$AH.p(i);else{const o=new sxe(n,this),a=o.u(this.options);o.p(i),this.T(a),this._$AH=o}}_$AC(e){let i=Lre.get(e.strings);return i===void 0&&Lre.set(e.strings,i=new Rq(e)),i}k(e){XY(this._$AH)||(this._$AH=[],this._$AR());const i=this._$AH;let s,n=0;for(const r of e)n===i.length?i.push(s=new nxe(this.O(CM()),this.O(CM()),this,this.options)):s=i[n],s._$AI(r),n++;n<i.length&&(this._$AR(s&&s._$AB.nextSibling,n),i.length=n)}_$AR(e=this._$AA.nextSibling,i){var s;for((s=this._$AP)==null?void 0:s.call(this,!1,!0,i);e&&e!==this._$AB;){const n=e.nextSibling;e.remove(),e=n}}setConnected(e){var i;this._$AM===void 0&&(this._$Cv=e,(i=this._$AP)==null||i.call(this,e))}},ok=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,i,s,n,r){this.type=1,this._$AH=Oo,this._$AN=void 0,this.element=e,this.name=i,this._$AM=n,this.options=r,s.length>2||s[0]!==""||s[1]!==""?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=Oo}_$AI(e,i=this,s,n){const r=this.strings;let o=!1;if(r===void 0)e=L1(this,e,i,0),o=!TM(e)||e!==this._$AH&&e!==Bf,o&&(this._$AH=e);else{const a=e;let l,u;for(e=r[0],l=0;l<r.length-1;l++)u=L1(this,a[s+l],i,l),u===Bf&&(u=this._$AH[l]),o||(o=!TM(u)||u!==this._$AH[l]),u===Oo?e=Oo:e!==Oo&&(e+=(u??"")+r[l+1]),this._$AH[l]=u}o&&!n&&this.j(e)}j(e){e===Oo?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}},ert=class extends ok{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===Oo?void 0:e}},trt=class extends ok{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==Oo)}},irt=class extends ok{constructor(e,i,s,n,r){super(e,i,s,n,r),this.type=5}_$AI(e,i=this){if((e=L1(this,e,i,0)??Oo)===Bf)return;const s=this._$AH,n=e===Oo&&s!==Oo||e.capture!==s.capture||e.once!==s.once||e.passive!==s.passive,r=e!==Oo&&(s===Oo||n);n&&this.element.removeEventListener(this.name,this,s),r&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var i;typeof this._$AH=="function"?this._$AH.call(((i=this.options)==null?void 0:i.host)??this.element,e):this._$AH.handleEvent(e)}},rxe=class{constructor(e,i,s){this.element=e,this.type=6,this._$AN=void 0,this._$AM=i,this.options=s}get _$AU(){return this._$AM._$AU}_$AI(e){L1(this,e)}};const $b={R:sxe,D:Q1e,V:L1,I:rk,F:rxe},AV=hP.litHtmlPolyfillSupport;AV==null||AV(Rq,rk),(hP.litHtmlVersions??(hP.litHtmlVersions=[])).push("3.2.1");const oxe=(t,e,i)=>{const s=(i==null?void 0:i.renderBefore)??e;let n=s._$litPart$;if(n===void 0){const r=(i==null?void 0:i.renderBefore)??null;s._$litPart$=n=new rk(e.insertBefore(CM(),r),r,void 0,i??{})}return n._$AI(t),n};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */let Bw=class extends kb{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var i;const e=super.createRenderRoot();return(i=this.renderOptions).renderBefore??(i.renderBefore=e.firstChild),e}update(e){const i=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=oxe(i,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)==null||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)==null||e.setConnected(!1)}render(){return Bf}};var Ole;Bw._$litElement$=!0,Bw.finalized=!0,(Ole=globalThis.litElementHydrateSupport)==null||Ole.call(globalThis,{LitElement:Bw});const IV=globalThis.litElementPolyfillSupport;IV==null||IV({LitElement:Bw});(globalThis.litElementVersions??(globalThis.litElementVersions=[])).push("4.1.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Dv={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},axe=t=>(...e)=>({_$litDirective$:t,values:e});let lxe=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,i,s){this._$Ct=e,this._$AM=i,this._$Ci=s}_$AS(e,i){return this.update(e,i)}update(e,i){return this.render(...i)}};/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const srt=axe(class extends lxe{constructor(t){var e;if(super(t),t.type!==Dv.ATTRIBUTE||t.name!=="class"||((e=t.strings)==null?void 0:e.length)>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(t){return" "+Object.keys(t).filter(e=>t[e]).join(" ")+" "}update(t,[e]){var s,n;if(this.st===void 0){this.st=new Set,t.strings!==void 0&&(this.nt=new Set(t.strings.join(" ").split(/\s/).filter(r=>r!=="")));for(const r in e)e[r]&&!((s=this.nt)!=null&&s.has(r))&&this.st.add(r);return this.render(e)}const i=t.element.classList;for(const r of this.st)r in e||(i.remove(r),this.st.delete(r));for(const r in e){const o=!!e[r];o===this.st.has(r)||(n=this.nt)!=null&&n.has(r)||(o?(i.add(r),this.st.add(r)):(i.remove(r),this.st.delete(r)))}return Bf}});/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const uxe="important",nrt=" !"+uxe,rrt=axe(class extends lxe{constructor(t){var e;if(super(t),t.type!==Dv.ATTRIBUTE||t.name!=="style"||((e=t.strings)==null?void 0:e.length)>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(t){return Object.keys(t).reduce((e,i)=>{const s=t[i];return s==null?e:e+`${i=i.includes("-")?i:i.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${s};`},"")}update(t,[e]){const{style:i}=t.element;if(this.ft===void 0)return this.ft=new Set(Object.keys(e)),this.render(e);for(const s of this.ft)e[s]==null&&(this.ft.delete(s),s.includes("-")?i.removeProperty(s):i[s]=null);for(const s in e){const n=e[s];if(n!=null){this.ft.add(s);const r=typeof n=="string"&&n.endsWith(nrt);s.includes("-")||r?i.setProperty(s,r?n.slice(0,-11):n,r?uxe:""):i[s]=n}}return Bf}});/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{I:ort}=$b,art=t=>t===null||typeof t!="object"&&typeof t!="function",lrt=(t,e)=>(t==null?void 0:t._$litType$)!==void 0,urt=t=>{var e;return((e=t==null?void 0:t._$litType$)==null?void 0:e.h)!=null},crt=t=>t.strings===void 0,Fre=()=>document.createComment(""),Ubt=(t,e,i)=>{var r;const s=t._$AA.parentNode,n=e===void 0?t._$AB:e._$AA;if(i===void 0){const o=s.insertBefore(Fre(),n),a=s.insertBefore(Fre(),n);i=new ort(o,a,t,t.options)}else{const o=i._$AB.nextSibling,a=i._$AM,l=a!==t;if(l){let u;(r=i._$AQ)==null||r.call(i,t),i._$AM=t,i._$AP!==void 0&&(u=t._$AU)!==a._$AU&&i._$AP(u)}if(o!==n||l){let u=i._$AA;for(;u!==o;){const c=u.nextSibling;s.insertBefore(u,n),u=c}}}return i},Vbt=(t,e,i=t)=>(t._$AI(e,i),t),hrt={},zbt=(t,e=hrt)=>t._$AH=e,Gbt=t=>t._$AH,Bbt=t=>{var s;(s=t._$AP)==null||s.call(t,!1,!0);let e=t._$AA;const i=t._$AB.nextSibling;for(;e!==i;){const n=e.nextSibling;e.remove(),e=n}};var cxe=(t="",e={},i=nk())=>{const s={emit:n=>{t===""&&qY();const r=new CustomEvent(t,{detail:n,cancelable:!0,bubbles:!0,composed:!0,...e});return i.el.dispatchEvent(r),r}};return t===""&&H1e(void 0,n=>{t=n.key},s),s},qbt=cxe.bind(null,""),drt=()=>{},n1,mrt=(n1=class extends Bw{constructor(){var i,s,n;super(),this.el=this.constructor.lazy??this,this.manager=Int(this),this._postLoad=((i=this.constructor.lazy)==null?void 0:i._postLoad)??new R1,this._offspring=((s=this.constructor.lazy)==null?void 0:s._offspring)??[],this._postLoaded=((n=this.constructor.lazy)==null?void 0:n._postLoaded)??new R1,this._enableUpdating=this.enableUpdating,this.enableUpdating=drt;const e=n1.prototype.shouldUpdate;this.shouldUpdate!==e&&(this._originalShouldUpdate=this.shouldUpdate,this.shouldUpdate=e)}static finalizeStyles(e){var n;const i=super.finalizeStyles(e),s=this.shadowRootOptions===bre;return((n=this.runtime)==null?void 0:n.commonStyles)===void 0||s?i:[this.runtime.commonStyles,...i]}static createProperty(e,i){const s=typeof i=="number"?i:Array.isArray(i)?i[0]:0,n=Array.isArray(i)?i[1]:void 0;super.createProperty(e,{attribute:s&1&&typeof e=="string"?U1e(e):!1,reflect:!!(s&2),type:s&4?Boolean:s&8?Number:void 0,state:!!(s&16),readOnly:!!(s&32),noAccessor:!!(s&64),...n})}connectedCallback(){if(this.el.hasAttribute("defer-hydration"))return;const e=!this.manager.connectedCalled;super.connectedCallback(),e&&queueMicrotask(()=>this._load().catch(i=>{this._postLoaded.reject(i),setTimeout(()=>{throw i})}))}createRenderRoot(){const e=this.el.shadowRoot,i=this.constructor,s=i.shadowRootOptions,r=e??(s===bre?this.el:this.el.attachShadow(s));if(Object.defineProperty(this,"shadowRoot",{value:r}),e)return Bw.prototype.createRenderRoot.call(this),e;if(this.isConnected){const o=r.getRootNode();o.adoptedStyleSheets=[...o.adoptedStyleSheets,...i.elementStyles.map(a=>"styleSheet"in a?a.styleSheet:a)]}return r}async _load(){const e=this.el._ancestorLoad??V1e(this.el);e&&await e,await this.manager._load(),this._enableUpdating(!0),this.performUpdate(),this._postLoad.resolve(),await Promise.resolve();const i=this._offspring.filter(s=>{var n;return!((n=s.manager)!=null&&n.loadedCalled)});i.length&&await Promise.allSettled(i.map(async s=>await s.componentOnReady())),this._offspring.length=0,this.el.setAttribute(this.constructor.runtime.hydratedAttribute,""),this.manager._loaded(),this._postLoaded.resolve()}shouldUpdate(e){var i;return this.$changes=e,((i=this._originalShouldUpdate)==null?void 0:i.call(this,e))??!0}listen(e,i,s){const n=(i==null?void 0:i.bind(this))??i;this.manager.onLifecycle(()=>(this.el.addEventListener(e,n,s),()=>this.el.removeEventListener(e,n,s)))}listenOn(e,i,s,n){const r=(s==null?void 0:s.bind(this))??s;this.manager.onLifecycle(()=>(e.addEventListener(i,r,n),()=>e.removeEventListener(i,r,n)))}async componentOnReady(){return await this._postLoaded.promise,this}},n1.lumina=!0,n1);mrt.$createEvent=cxe;function prt(t){let e;const i=n=>{var r;e=new URL(n,((r=globalThis.location)==null?void 0:r.href)||void 0).href},s={...t,getAssetPath(n){var o;const r=new URL(n,e);return r.origin!==((o=globalThis.location)==null?void 0:o.origin)?r.href:r.pathname},setAssetPath:i,customElement(n,r){r.runtime=s,r.tagName=n,customElements.get(n)||customElements.define(n,r)}};return i(t.defaultAssetPath),s}var Hbt=t=>typeof t=="object"&&t!=null?srt(t):t,jbt=t=>typeof t=="object"&&t!=null?rrt(t):t,Ybt=Oo;function Xbt(t,e,i){i==null?t.removeAttribute(e):t.setAttribute(e,i)}var Wbt={toAttribute:t=>t===!0?"":t===!1?null:t};/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.1.0 */const hxe="calcite-mode-auto",dxe="calcite-mode-dark",frt="calcite-mode-light",Zbt={autoMode:hxe,darkMode:dxe,lightMode:frt,rtl:"calcite--rtl",calciteAnimate:"calcite-animate",calciteAnimateInUp:"calcite-animate__in-up",calciteAnimateInDown:"calcite-animate__in-down",calciteAnimateInRight:"calcite-animate__in-right",calciteAnimateInLeft:"calcite-animate__in-left"},Kbt={filter:250,nextTick:0,resize:150,reposition:100};function kre(){const{classList:t}=document.body,e=window.matchMedia("(prefers-color-scheme: dark)").matches,i=()=>t.contains(dxe)||t.contains(hxe)&&e?"dark":"light",s=o=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:!0,detail:{mode:o}})),n=o=>{r!==o&&s(o),r=o};let r=i();s(r),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",o=>n(o.matches?"dark":"light")),new MutationObserver(()=>n(i())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}const Mf=globalThis.calciteConfig,Qbt=(Mf==null?void 0:Mf.focusTrapStack)||[],Jbt=(Mf==null?void 0:Mf.logLevel)||"info",$re="3.1.0",grt="2025-03-26",_rt="d5f75fd64";function yrt(){if(Mf&&Mf.version)return;console.info(`Using Calcite Components ${$re} [Date: ${grt}, Revision: ${_rt}]`);const t=Mf||globalThis.calciteConfig||{};Object.defineProperty(t,"version",{value:$re,writable:!1}),globalThis.calciteConfig=t}const mxe=()=>typeof navigator<"u"&&typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document;function vrt(){return navigator.userAgentData}function ewt(){if(!mxe())return"";const t=vrt();return t!=null&&t.brands?t.brands.map(({brand:e,version:i})=>`${e}/${i}`).join(" "):navigator.userAgent}function xrt(){mxe()&&(document.readyState==="interactive"?kre():document.addEventListener("DOMContentLoaded",()=>kre(),{once:!0})),yrt()}xrt();const pxe=prt({defaultAssetPath:"https://js.arcgis.com/calcite-components/3.1.0/",hydratedAttribute:"calcite-hydrated"}),{customElement:twt,getAssetPath:iwt,setAssetPath:brt}=pxe;/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.1.0 */let fxe=!1;const wrt=t=>{fxe=!0,brt(t)};let gxe;function Srt(){fxe||wrt(Yc($r(gxe)))}function WY(t){var i;const e=[];for(const s of Object.keys(t))customElements.get(`calcite-${s}`)||e.push((i=t[s])==null?void 0:i.call(t));return e.length>0?Promise.all(e):null}gxe="components/assets";const _xe=Symbol("widget"),yxe=Symbol("widget-test-data"),Ert=[],Crt={},tF=new WeakMap;function vxe(t,e){let i=e.children;if(i!=null&&i.length)for(let n=0;n<i.length;++n)i[n]=vxe(t,i[n]);else i=Ert;const s=e.vnodeSelector;if(iF(s)){const n=e.properties||Crt,r=n.key||s,o={key:r,afterCreate:Trt,afterUpdate:Prt,afterRemoved:xxe,parentWidget:t,widgetConstructor:s,widgetProperties:{...n,key:r,children:i}};return{vnodeSelector:s.vnodeSelector,properties:o,children:void 0,text:void 0,domNode:null}}return e}function Trt(t,e,i,{parentWidget:s,widgetConstructor:n,widgetProperties:r}){var a;const o=new n(r);o.container=t,tF.set(t,o),(a=o.afterCreate)==null||a.call(o,o,t),s.addHandles(Gs(()=>xxe(t))),queueMicrotask(()=>{o[yxe].projector.renderNow()})}function Prt(t,e,i,{widgetProperties:s}){var r;const n=tF.get(t);n&&(n.set(s),(r=n.afterUpdate)==null||r.call(n,n,t))}function xxe(t){var i;const e=tF.get(t);e&&((i=e.afterRemoved)==null||i.call(e,e,t),e.destroy(),tF.delete(t))}function iF(t){return typeof t=="function"&&t[_xe]}const Ure=new Set;function Mrt(t){Ure.add(t),t.finally(()=>Ure.delete(t))}var bxe;const Art="esri.widgets.Widget";let Irt=0;function wxe(t,e){const i=Object.prototype.hasOwnProperty;for(const s in e)i.call(e,s)&&i.call(t,s)&&(t[s]!=null&&e[s]!=null&&typeof t[s]=="object"&&typeof e[s]=="object"?wxe(t[s],e[s]):t[s]=e[s]);return t}const Drt=qst({postProcessProjectionOptions(t){const e=t.eventHandlerInterceptor,i=/capture$/i;t.eventHandlerInterceptor=(s,n,r,o)=>{const a=e==null?void 0:e(s,n,r,o),l=i.test(s);if(!((s=s.replace(i,"")).toLowerCase()in r)||l){const u=s[2].toLowerCase()+s.slice(3),c=m=>a==null?void 0:a.call(r,m);r.addEventListener(u,c,l);const h=()=>r.removeEventListener(u,c,l),d=o.afterRemoved;o.afterRemoved=m=>{d==null||d(m),h()}}return a}},handleInterceptedEvent(t,e,i,s){const{eventPhase:n,type:r}=s,o=n===Event.CAPTURING_PHASE;let a=`on${r}${o?"capture":""}`;const l=e.properties;(l&&a in l||(a=`on${r[0].toUpperCase()}${r.slice(1)}${o?"Capture":""}`,l&&a in l))&&(g0e(),t.scheduleRender(),l[a].call(l.bind||i,s))}});let DV=!1,uo=class extends JM.EsriPromiseMixin(vd.EventedAccessor){constructor(e,i){super(e,i),this._attached=!1,this._projector=Drt,this._readyForTrueRender=!1,this.key=this,this.autoRenderingEnabled=!0,this._loadLocale=mH(async()=>{var l;if((l=this._messageBundleProps)!=null&&l.length){const u=await Promise.allSettled(this._messageBundleProps.map(async({bundlePath:c,propertyName:h})=>{if(this.destroyed)return;let d=await $ye(c);this.uiStrings&&Object.keys(this.uiStrings)&&(d=wxe(be(d),this.uiStrings)),this[h]=d}));if(this.destroyed)return;for(const c of u)c.status==="rejected"&&ht.getLogger(this).error("widget-intl:locale-error",this.declaredClass,c.reason)}await this.loadLocale()}),Srt();const s="esri-widget-uid-"+sk(),n=this.render.bind(this);this._trackingTarget=new SF(()=>{this.autoRenderingEnabled&&this.scheduleRender()});const r=()=>({vnodeSelector:"div",properties:{key:`${s}-hidden`,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0}),o=()=>{var h,d;if(!this._readyForTrueRender||this.destroyed)return null;const l=n()??r(),u=l.properties??(l.properties={});if(u.key??(u.key=s),iF(l.vnodeSelector)){if(!this.visible)return r()}else this.visible?u.styles||(u.styles={}):(u.class="",u.styles={display:"none"}),(h=u.styles).display??(h.display="");let c=0;return(d=l.children)==null||d.forEach(m=>{var f;iF(m.vnodeSelector)||(m.properties??(m.properties={}),(f=m.properties).key??(f.key=`${this.id}--${c++}`))}),vxe(this,l)};this.render=()=>{if(DV)return o();let l=HXe(this)??null;if(l)return l;this._trackingTarget.clear(),DV=!0;try{l=Nf(this._trackingTarget,o)}catch(u){throw ht.getLogger(this).error(u),u}finally{DV=!1}return l&&jXe(this,l),l};const a=this.beforeFirstRender();a?this._resourcesFetch=a.then(()=>{this._readyForTrueRender=!0,this._postInitialize()}):(this._resourcesFetch=Promise.resolve().then(()=>{this._postInitialize()}),this._readyForTrueRender=!0),this.addResolvingPromise(this._resourcesFetch),Mrt(this._resourcesFetch)}normalizeCtorArgs(e,i){const s={...e};return i&&(s.container=i),s}postInitialize(){}beforeFirstRender(){var i;const e=this.loadDependencies();return(i=this._messageBundleProps)!=null&&i.length||e?Promise.all([e,this._loadLocale()]).then(()=>{}).catch(wK):null}loadDependencies(){return null}loadLocale(){return null}destroy(){this.destroyed||(er(this._trackingTarget),er(this.viewModel),this._detach(this.container),this._set("container",null),this._emitter.clear(),this.render=()=>null,this._projector=null,Z5(this))}set container(e){this._get("container")||this._set("container",e)}castContainer(e){return mY(e)}get domNode(){return this.container}set domNode(e){this.container=e}get icon(){return null}set icon(e){this._overrideIfSome("icon",e)}get id(){var e;return this._get("id")||((e=this.container)==null?void 0:e.id)||Date.now().toString(16)+"-widget-"+Irt++}set id(e){e&&this._set("id",e)}get label(){return this.declaredClass.split(".").pop()}set label(e){this._overrideIfSome("label",e)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(e){this._set("visible",e)}get[(bxe=_xe,yxe)](){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(Z5(this),this._projector.scheduleRender())}classes(...e){return YXe.apply(this,e)}renderNow(){Z5(this),this._projector.renderNow()}_postInitialize(){var i;if(this.destroyed)return;this.scheduleRender(),(i=this._delegatedEventNames)!=null&&i.length&&this.addHandles(Ai(()=>this.viewModel,(s,n)=>{n&&this.removeHandles("delegated-events"),s&&wF(s)&&this.addHandles(this._delegatedEventNames.map(r=>$M(s,r,o=>{this.emit(r,o)})),"delegated-events")},uu)),this.postInitialize();const e=async()=>{await this._loadLocale().catch(wK),this.scheduleRender()};this.addHandles([Fde(e),Ai(()=>this.uiStrings,e),nh(()=>this.container,s=>{this.destroyed||this._attach(s)},{initial:!0,once:!0})])}_attach(e){e&&(this._projector.merge(e,this.render),this._attached=!0)}_detach(e){var i;this._attached&&(this._projector.detach(this.render),this._attached=!1),(i=e==null?void 0:e.parentNode)==null||i.removeChild(e)}};uo[bxe]=!0,uo.vnodeSelector="div",y([S()],uo.prototype,"_readyForTrueRender",void 0),y([S({value:null})],uo.prototype,"container",null),y([Ls("container")],uo.prototype,"castContainer",null),y([S()],uo.prototype,"icon",null),y([S()],uo.prototype,"id",null),y([S()],uo.prototype,"label",null),y([S()],uo.prototype,"renderable",null),y([S()],uo.prototype,"uiStrings",void 0),y([S()],uo.prototype,"viewModel",void 0),y([S({value:!0})],uo.prototype,"visible",null),y([S()],uo.prototype,"key",void 0),y([S()],uo.prototype,"children",void 0),y([S()],uo.prototype,"afterCreate",void 0),y([S()],uo.prototype,"afterUpdate",void 0),y([S()],uo.prototype,"afterRemoved",void 0),uo=y([se(Art)],uo);const ak=uo,Nrt=new Map;function Rrt(t){return Nrt.get(t)}function Vre(t,e){return t&&"copyright"in t&&(!e||typeof t.originOf=="function"&&t.originOf("copyright")==="user")}function Ort(t,e){return t.length!==e.length||t.some((i,s)=>i.text!==e[s].text)}function oC(t,e,i){!i||!e||t.find(s=>s.layerView===e&&s.text===i)||t.push({text:i,layerView:e})}function Lrt(t){return t.type==="bing-maps"}const Rp=[];let Ub=class extends ei{constructor(e){super(e),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new Nt,this.view=null,this._allLayerViewsChange=i=>{var n;this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");const s=(n=this.view)==null?void 0:n.allLayerViews;s&&(this.addHandles(s.map(r=>Ai(()=>{var o;return[r.suspended,(o=r.layer)==null?void 0:o.attributionVisible]},()=>this._updateAttributionItems())).toArray(),"suspension"),s.forEach(r=>{r.declaredClass==="esri.views.3d.layers.Tiles3DLayerView3D"&&this.addHandles(r.on("visible-geometry-changed",()=>this._updateAttributionItems()),"visible-geometry-changed")})),i!=null&&i.removed&&i.removed.forEach(r=>{this._pendingAttributions.delete(r),this._fetchedAttributionData.delete(r)}),this._updateAttributionItems()},this.addHandles([yy(()=>{var i;return(i=this.view)==null?void 0:i.allLayerViews},"change",i=>this._allLayerViewsChange(i),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),nh(()=>{var i;return((i=this.view)==null?void 0:i.stationary)===!0},()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){var e;return(e=this.view)!=null&&e.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const e=this.view,i=e==null?void 0:e.allLayerViews;if(Rp.length=0,!e||!i)return void this._clear();i.forEach(n=>{var a,l;if(n.suspended||!((a=n.layer)!=null&&a.attributionVisible))return;const r=n.layer;if(Vre(r,"user"))return void oC(Rp,n,r.copyright);if(r.hasAttributionData){if(this._fetchedAttributionData.has(n)){const u=this._fetchedAttributionData.get(n);return void(u?oC(Rp,n,this._getDynamicAttribution(u,e,r)):Vre(r)&&oC(Rp,n,r.copyright))}return void this._fetchAttributionData(n)}const o="portalItem"in r?(l=r.portalItem)==null?void 0:l.accessInformation:void 0;oC(Rp,n,o||r.copyright)});const s=i.find(n=>{var r;return((r=n.layer)==null?void 0:r.type)==="integrated-mesh-3dtiles"});if(this.view&&s){const n=Rrt(this.view);if(n){const r=n.getAttributionText();for(let o=0;o<r.length;++o)oC(Rp,s,r[o])}}Ort(this.items,Rp)&&(this.items.removeAll(),this.items.addMany(Rp)),Rp.length=0,this.notifyChange("state")}async _fetchAttributionData(e){if(this._pendingAttributions.has(e))return;this._pendingAttributions.add(e);const i=await qF(e.layer.fetchAttributionData());if(this._pendingAttributions.has(e)){const s=i.ok?this._createContributionIndex(i.value,Lrt(e.layer)):null;this._pendingAttributions.delete(e),this._fetchedAttributionData.set(e,s)}this._updateAttributionItems()}_createContributionIndex(e,i){const s=e.contributors,n={};if(!s)return n;for(let r=0;r<s.length;r++){const o=s[r],a=o.coverageAreas;if(!a)return;for(const l of a){const u=l.bbox,c=l.zoomMin-(i&&l.zoomMin?1:0),h=l.zoomMax-(i&&l.zoomMax?1:0),d=new Nn({xmin:u[1],ymin:u[0],xmax:u[3],ymax:u[2],spatialReference:Ri.WGS84}),m={extent:ty(d),attribution:o.attribution||"",score:l.score!=null?l.score:100,id:r};for(let f=c;f<=h;f++)n[f]??(n[f]=[]),n[f].push(m)}}return n.maxKey=Math.max.apply(null,Object.keys(n)),n}_getDynamicAttribution(e,i,s){var c;const{extent:n,scale:r}=i;let o=((c=s.tileInfo)==null?void 0:c.scaleToZoom(r))??0;if(o=Math.min(e.maxKey??0,Math.round(o)),!n||o==null||o<=-1)return"";const a=e[o],l=DF(n.center.clone().normalize(),Ri.WebMercator),u=new Set;return a?a.filter(h=>{const d=h.id,m=!u.has(d)&&l&&h.extent&&GM(h.extent,l);return m&&u.add(d),m}).sort((h,d)=>d.score-h.score||h.objectId-d.objectId).map(h=>h.attribution).join(", "):""}};y([S({readOnly:!0,type:Nt})],Ub.prototype,"items",void 0),y([S({readOnly:!0})],Ub.prototype,"state",null),y([S()],Ub.prototype,"view",void 0),Ub=y([se("esri.widgets.Attribution.AttributionViewModel")],Ub);const Sxe=Ub,Rm={button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",empty:"esri-widget__content--empty",heading:"esri-widget__heading",interactive:"esri-interactive",panel:"esri-widget--panel",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button"};function Frt(){return function(t,e){if(!t[e])throw new TypeError(`Cannot auto bind undefined function '${String(e)}'`);return{value:$rt(t[e])}}}function krt(t){const e=t==null?void 0:t.type;return t instanceof KeyboardEvent||e==="keyup"||e==="keydown"||e==="keypress"}function $rt(t){return function(e,...i){krt(e)?QXe(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click()):t.call(this,e,...i)}}function lk(t){return(e,i)=>{e.hasOwnProperty("_messageBundleProps")||(e._messageBundleProps=e._messageBundleProps?e._messageBundleProps.slice():[]),e._messageBundleProps.push({bundlePath:t,propertyName:i})}}var Urt=function(t){return{vnodeSelector:"",properties:void 0,children:void 0,text:t.toString(),domNode:null}},Exe=function(t,e){for(var i=0,s=t.length;i<s;i++){var n=t[i];Array.isArray(n)?Exe(n,e):n!=null&&n!==!1&&(n.hasOwnProperty("vnodeSelector")||(n=Urt(n)),e.push(n))}},Vrt=function(t,e){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];if(i.length===1&&typeof i[0]=="string")return{vnodeSelector:t,properties:e||void 0,children:void 0,text:i[0],domNode:null};var n=[];return Exe(i,n),{vnodeSelector:t,properties:e||void 0,children:n,text:void 0,domNode:null}};function yu(t,e,...i){return typeof t!="function"||iF(t)?Vrt(t,e??null,...i):t(e,...i)}function rwt(...t){return t}const db="esri-attribution",mb={base:db,poweredBy:`${db}__powered-by`,sources:`${db}__sources`,open:`${db}--open`,sourcesOpen:`${db}__sources--open`,link:`${db}__link`};let Sl=class extends ak{constructor(e,i){super(e,i),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver(s=>s.forEach(({target:n})=>this._checkSourceTextOverflow(n))),this.itemDelimiter=" | ",this.messages=null,this.viewModel=new Sxe}initialize(){this.addHandles(yy(()=>{var e;return(e=this.viewModel)==null?void 0:e.items},"change",()=>this.scheduleRender()))}destroy(){var e;(e=this._resizeObserver)==null||e.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce((e,i)=>(e.includes(i.text)||e.push(i.text),e),[]).join(this.itemDelimiter)}get icon(){return"description"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){const e={[mb.open]:this._isOpen};return yu("div",{bind:this,class:this.classes(mb.base,Rm.widget,e),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return yu("div",{class:mb.poweredBy},"Powered by"," ",yu("a",{class:mb.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const e=this._isOpen,i=this._isInteractive,s=i?0:void 0,{attributionText:n}=this,r={[mb.sourcesOpen]:e,[Rm.interactive]:i};return yu("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(mb.sources,r),innerHTML:n,tabIndex:s})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth,this._resizeObserver.observe(e)}_checkSourceTextOverflow(e){let i=!1;const{clientHeight:s,clientWidth:n,scrollWidth:r}=e,o=r>n,a=this._attributionTextOverflowed!==o;if(this._attributionTextOverflowed=o,a&&(i=!0),this._isOpen){const l=s<this._prevSourceNodeHeight;this._prevSourceNodeHeight=s,l&&(this._isOpen=!1,i=!0)}i&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};y([S()],Sl.prototype,"_isOpen",void 0),y([S()],Sl.prototype,"_isInteractive",null),y([S()],Sl.prototype,"_attributionTextOverflowed",void 0),y([S()],Sl.prototype,"_prevSourceNodeHeight",void 0),y([S({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],Sl.prototype,"attributionText",null),y([S()],Sl.prototype,"icon",null),y([S()],Sl.prototype,"itemDelimiter",void 0),y([S()],Sl.prototype,"label",null),y([S(),lk("esri/widgets/Attribution/t9n/Attribution")],Sl.prototype,"messages",void 0),y([S()],Sl.prototype,"view",null),y([S({type:Sxe})],Sl.prototype,"viewModel",void 0),y([Frt()],Sl.prototype,"_toggleState",null),Sl=y([se("esri.widgets.Attribution")],Sl);const zrt=Sl;function Grt(){const t=ke("mapview-essential-goto-duration");return t==null?t:t}function Brt(t){var e,i;return((e=t==null?void 0:t.spatialReference)==null?void 0:e.isWebMercator)||((i=t==null?void 0:t.spatialReference)==null?void 0:i.isGeographic)||!1}const qrt=t=>{let e=class extends t{constructor(...i){super(...i),this.goToOverride=null,this.view=null}callGoTo(i){const{view:s}=this;return Sue(s),this.goToOverride?this.goToOverride(s,i):s.goTo(i.target,i.options)}};return y([S()],e.prototype,"goToOverride",void 0),y([S()],e.prototype,"view",void 0),e=y([se("esri.widgets.support.GoTo")],e),e};let uv=class extends qrt(ei){constructor(e){super(e),this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._watchForView(nl)}destroy(){this.view=null}get canShowNorth(){return Brt(this.view)}get state(){var e;return!((e=this.view)!=null&&e.ready)||this.view.type==="2d"&&!this.view.constraints.rotationEnabled?"disabled":this.canShowNorth?"compass":"rotation"}reset(){var e,i;(e=this.view)!=null&&e.ready&&(((i=this.view)==null?void 0:i.type)==="2d"?this.callGoTo({target:{rotation:0},options:{animationMode:"always",duration:Grt()}}):this.callGoTo({target:{heading:0}}))}_updateForRotation(e){e!=null&&this._set("orientation",{z:e})}_updateForCamera(e){if(!e)return;const i=-e.heading;this._set("orientation",{x:0,y:0,z:i})}_updateRotationWatcher(e){this.removeAllHandles(),this._watchForView(),e&&this.addHandles(e.type==="2d"?Ai(()=>e==null?void 0:e.rotation,this._updateForRotation,nl):Ai(()=>e==null?void 0:e.camera,this._updateForCamera,nl))}_watchForView(e){this.addHandles(Ai(()=>this.view,this._updateRotationWatcher,e))}};y([S({readOnly:!0})],uv.prototype,"canShowNorth",null),y([S({readOnly:!0})],uv.prototype,"orientation",void 0),y([S({readOnly:!0})],uv.prototype,"state",null),y([S()],uv.prototype,"view",void 0),uv=y([se("esri.widgets.Compass.CompassViewModel")],uv);const Cxe=uv,zre="esri-compass",Gre={base:zre,iconContainer:`${zre}__icon-container`};let Zp=class extends ak{constructor(e,i){super(e,i),this.messages=null,this.viewModel=new Cxe,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=s=>({transform:`rotateZ(${s.z}deg)`})}loadDependencies(){return WY({button:()=>_e(()=>import("./index-APTdSFoz.js"),__vite__mapDeps([262,263,264,265,266,267,268,269,270,271,272,273,274,275,276])),icon:()=>_e(()=>import("./index-B2mHmePf.js").then(e=>e.i),__vite__mapDeps([266,267,264,268,269]))})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(e){this.viewModel.goToOverride=e}get icon(){return this.viewModel.state==="rotation"?"arrow-up":"compass-needle"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}reset(){return this.viewModel.reset()}render(){const{orientation:e,state:i}=this.viewModel,{messages:s}=this;return yu("div",{class:this.classes(Gre.base,Rm.widget)},yu("calcite-button",{class:Rm.widgetButton,disabled:i==="disabled",kind:"neutral",label:s.reset,onclick:this._reset,round:!0,scale:"s",title:s.reset},yu("div",{"aria-hidden":"true",class:Gre.iconContainer,title:s.reset},yu("calcite-icon",{icon:this.icon,styles:this._toRotationTransform(e)}))))}};y([S()],Zp.prototype,"goToOverride",null),y([S()],Zp.prototype,"icon",null),y([S()],Zp.prototype,"label",null),y([S(),lk("esri/widgets/Compass/t9n/Compass")],Zp.prototype,"messages",void 0),y([S()],Zp.prototype,"view",null),y([S({type:Cxe})],Zp.prototype,"viewModel",void 0),Zp=y([se("esri.widgets.Compass")],Zp);const Hrt=Zp,Bre="esri-navigation-toggle",qre={base:Bre,isLayoutHorizontal:`${Bre}--horizontal`};let Vb=class extends ei{constructor(e){super(e),this._navigationMode="pan",this.view=null}initialize(){this.addHandles(nh(()=>{var e,i;return(i=(e=this.view)==null?void 0:e.navigation)==null?void 0:i.actionMap},()=>this._updateNavigationActionMap()))}destroy(){this.view=null}get state(){var e,i;return(e=this.view)!=null&&e.ready&&((i=this.view)==null?void 0:i.type)==="3d"?"ready":"disabled"}get navigationMode(){return this._navigationMode}set navigationMode(e){this._navigationMode=e,this._updateNavigationActionMap()}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate")}_updateNavigationActionMap(){var s,n;const e=(n=(s=this.view)==null?void 0:s.navigation)==null?void 0:n.actionMap;if(!e)return;const i=this._navigationMode==="pan";e.dragPrimary=i?"pan":"rotate",e.dragSecondary=i?"rotate":"pan"}};y([S({readOnly:!0})],Vb.prototype,"state",null),y([S()],Vb.prototype,"_navigationMode",void 0),y([S()],Vb.prototype,"view",void 0),Vb=y([se("esri.widgets.NavigationToggle.NavigationToggleViewModel")],Vb);const Txe=Vb;let Kp=class extends ak{constructor(e,i){super(e,i),this.messages=null,this.viewModel=new Txe,this.toggle=()=>this.viewModel.toggle(),this._panButton=null,this._rotateButton=null,this._toggle=()=>{var n;const s=((n=this.viewModel)==null?void 0:n.navigationMode)==="pan"?this._rotateButton:this._panButton;JXe(s),this.toggle()}}loadDependencies(){return WY({button:()=>_e(()=>import("./index-APTdSFoz.js"),__vite__mapDeps([262,263,264,265,266,267,268,269,270,271,272,273,274,275,276]))})}get icon(){return"move"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}render(){var n,r;const e=((n=this.viewModel)==null?void 0:n.state)==="disabled",i=((r=this.viewModel)==null?void 0:r.navigationMode)==="pan",s=this.messages.toggle;return yu("div",{class:this.classes(qre.base,Rm.widget,{[qre.isLayoutHorizontal]:this.layout==="horizontal"})},yu("calcite-button",{afterCreate:o=>{this._panButton=o},appearance:i?"outline-fill":"solid",class:Rm.widgetButton,disabled:e,iconStart:"move",kind:"neutral",label:s,onclick:this._toggle,tabIndex:i?void 0:-1,title:s}),yu("calcite-button",{afterCreate:o=>{this._rotateButton=o},appearance:i?"solid":"outline-fill",class:Rm.widgetButton,disabled:e,iconStart:"rotate",kind:"neutral",label:s,onclick:this._toggle,tabIndex:i?-1:void 0,title:s}))}};y([S()],Kp.prototype,"icon",null),y([S()],Kp.prototype,"label",null),y([S({value:"vertical"})],Kp.prototype,"layout",null),y([S(),lk("esri/widgets/NavigationToggle/t9n/NavigationToggle")],Kp.prototype,"messages",void 0),y([S()],Kp.prototype,"view",null),y([S({type:Txe})],Kp.prototype,"viewModel",void 0),Kp=y([se("esri.widgets.NavigationToggle")],Kp);const jrt=Kp;let cv=class extends ei{get canZoomIn(){var s,n,r;if(!((s=this.view)==null?void 0:s.ready))return!1;const i=(r=(n=this.view)==null?void 0:n.constraints)==null?void 0:r.effectiveMaxScale;return i===0||this._scale>i}get canZoomOut(){var n;const{view:e}=this;if(!(e==null?void 0:e.ready))return!1;const s=(n=e.constraints)==null?void 0:n.effectiveMinScale;return s===0||this._scale<s}get _scale(){var i,s,n;const e=(s=(i=this.view)==null?void 0:i.animation)==null?void 0:s.target;return(e&&"then"in e||e==null?void 0:e.scale)??((n=this.view)==null?void 0:n.scale)??0}};y([S({readOnly:!0})],cv.prototype,"canZoomIn",null),y([S({readOnly:!0})],cv.prototype,"canZoomOut",null),y([S()],cv.prototype,"view",void 0),y([S()],cv.prototype,"_scale",null),cv=y([se("esri.widgets.Zoom.ZoomConditions2D")],cv);const Yrt=cv;let zb=class extends ei{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};y([S({readOnly:!0})],zb.prototype,"canZoomIn",null),y([S({readOnly:!0})],zb.prototype,"canZoomOut",null),y([S()],zb.prototype,"view",void 0),zb=y([se("esri.widgets.Zoom.ZoomConditions3D")],zb);const Xrt=zb;let b_=class extends ei{constructor(e){super(e)}destroy(){this.view=null}get canZoomIn(){return this._zoomConditions!=null&&this._zoomConditions.canZoomIn}get canZoomOut(){var e;return this._zoomConditions!=null&&((e=this._zoomConditions)==null?void 0:e.canZoomOut)}get state(){var e;return(e=this.view)!=null&&e.ready?"ready":"disabled"}set view(e){e?e.type==="2d"?this._zoomConditions=new Yrt({view:e}):e.type==="3d"&&(this._zoomConditions=new Xrt({view:e})):this._zoomConditions=null,this._set("view",e)}zoomIn(){const e=this.view;this.canZoomIn&&e&&(e.type==="2d"?e.mapViewNavigation.zoomIn():vP(e.goTo({zoomFactor:2})))}zoomOut(){const e=this.view;this.canZoomOut&&e&&(e.type==="2d"?e.mapViewNavigation.zoomOut():vP(e.goTo({zoomFactor:.5})))}};y([S()],b_.prototype,"_zoomConditions",void 0),y([S()],b_.prototype,"canZoomIn",null),y([S()],b_.prototype,"canZoomOut",null),y([S({readOnly:!0})],b_.prototype,"state",null),y([S()],b_.prototype,"view",null),b_=y([se("esri.widgets.Zoom.ZoomViewModel")],b_);const Pxe=b_,Hre={base:"esri-zoom",horizontalLayout:"esri-zoom--horizontal"};let Qp=class extends ak{constructor(e,i){super(e,i),this.messages=null,this.viewModel=new Pxe,this.zoomIn=()=>this.viewModel.zoomIn(),this.zoomOut=()=>this.viewModel.zoomOut()}loadDependencies(){return WY({button:()=>_e(()=>import("./index-APTdSFoz.js"),__vite__mapDeps([262,263,264,265,266,267,268,269,270,271,272,273,274,275,276]))})}get icon(){return"magnifying-glass-plus"}set icon(e){this._overrideIfSome("icon",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}set layout(e){e!=="horizontal"&&(e="vertical"),this._set("layout",e)}set view(e){this.viewModel.view=e}get view(){return this.viewModel.view}render(){const e={[Hre.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:i,canZoomOut:s}=this.viewModel,{zoomIn:n,zoomOut:r}=this.messages;return yu("div",{class:this.classes(Hre.base,Rm.widget,e)},yu("calcite-button",{class:Rm.widgetButton,disabled:!i,iconStart:"plus",kind:"neutral",label:n,onclick:this.zoomIn,title:n}),yu("calcite-button",{class:Rm.widgetButton,disabled:!s,iconStart:"minus",kind:"neutral",label:r,onclick:this.zoomOut,title:r}))}};y([S()],Qp.prototype,"icon",null),y([S()],Qp.prototype,"label",null),y([S({value:"vertical"})],Qp.prototype,"layout",null),y([S(),lk("esri/widgets/Zoom/t9n/Zoom")],Qp.prototype,"messages",void 0),y([S()],Qp.prototype,"view",null),y([S({type:Pxe})],Qp.prototype,"viewModel",void 0),Qp=y([se("esri.widgets.Zoom")],Qp);const Wrt=Qp;function Zrt(t){return(t==null?void 0:t.view)!==void 0}let V3=class extends Lst{constructor(e){super(e),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=i=>{this.components.forEach(s=>{const n=this._find(s),r=n==null?void 0:n.widget;Zrt(r)&&(r.view=i)})},this._componentsWatcher=(i,s)=>{this._removeComponents(s),this._addComponents(i),this._adjustPadding(i)}}initialize(){this.addHandles([Ai(()=>this.components,this._componentsWatcher,nl),Ai(()=>this.view,this._updateViewAwareWidgets,nl)])}_add(e,i,s,n,r){let o=e;if(typeof e=="string"&&this._defaultPositionLookup[e]){if(this._find(e))return;o=this._createComponent(e)}super._add(o,i,s,n,r)}_removeComponents(e){e.forEach(i=>{const s=this._find(i);s&&(this.remove(s),s.destroy())})}_adjustPadding(e){if(!e.includes("attribution")&&!this._isOverridden("padding")){const{top:i}=this.padding;this.padding=i}}_addComponents(e){this.constructed&&e.forEach(i=>this.add(this._createComponent(i),this._defaultPositionLookup[i]))}_createComponent(e){const i=this._createWidget(e);return new k3({id:e,node:i})}_createWidget(e){const i=this.view;switch(e){case"attribution":return new zrt({view:i});case"compass":return new Hrt({view:i});case"navigation-toggle":return new jrt({view:i});case"zoom":return new Wrt({view:i})}}};y([S()],V3.prototype,"components",void 0),V3=y([se("esri.views.ui.DefaultUI")],V3);const Mxe=V3;let z3=class extends Mxe{constructor(e){super(e),this.components=["attribution","zoom"]}};y([S()],z3.prototype,"components",void 0),z3=y([se("esri.views.ui.2d.DefaultUI2D")],z3);const Axe=z3;let Ixe=class Oq{constructor(e,i,s=""){this.major=e,this.minor=i,this._context=s}lessThan(e,i){return this.major<e||e===this.major&&this.minor<i}greaterEqual(e,i){return!this.lessThan(e,i)}validate(e){if(this.major!==e.major){const i=this._context&&this._context+":",s=this._context&&this._context+" ";throw new Se(i+"unsupported-version",`Required major ${s}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:e})}}clone(){return new Oq(this.major,this.minor,this._context)}static parse(e,i=""){const[s,n]=e.split("."),r=/^\s*\d+\s*$/;if(!(s!=null&&s.match)||!r.test(s))throw new Se((i&&i+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:e});if(!(n!=null&&n.match)||!r.test(n))throw new Se((i&&i+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:e});const o=parseInt(s,10),a=parseInt(n,10);return new Oq(o,a,i)}},Krt=class extends Ixe{constructor(e,i){super(e,i,"webmap")}};function NV(t){return t!=null&&typeof t=="object"&&"declaredClass"in t&&t.declaredClass==="esri.WebMap"}new Krt(2,33);var Lq;let G3=Lq=class extends it{constructor(t){super(t),this.color=new Gt([0,0,0,1])}clone(){return new Lq(be({color:this.color}))}};y([S({type:Gt,json:{write:!0}})],G3.prototype,"color",void 0),G3=Lq=y([se("esri.webmap.background.ColorBackground")],G3);const Qrt=G3;let Dxe,Nxe,Rxe,Oxe,Lxe,Fxe,kxe;async function Jrt(){const[,{GraphicsView2D:t,GraphicContainer:e,LabelManager:i,MapViewNavigation:s,MagnifierView2D:n,GridView2D:r,Stage:o}]=await Promise.all([_e(()=>import("./webglDeps-BX2hQHdt.js"),__vite__mapDeps([185,162,15,186,187,188])),_e(()=>import("./mapViewDeps-B8Sv5yJ7.js"),__vite__mapDeps([189,127,94,95,14,15,96,97,98,99,93,66,190,102,191,186,162,187,166,142,192,119,193,149,148,106,13,16,100,108,194,103,104,105,195,34,147,185,188,196,114,197,92,45,41,47,6,198,155,156,140,164,199,82,200,107,201,202,101,203,71,111,90,204,205,206,207,158,208]))]);Nxe=t,Rxe=e,Oxe=i,Lxe=s,Fxe=n,kxe=r,Dxe=o}let vs=class extends ltt(QYe(MWe(pWe(pKe)))){constructor(e){super(e),this._magnifierView=null,this._gridView=null,this.stage=null,this._resolveWhenReady=[],this.rootLayerViews=new gM({getCollections:()=>{var i,s;return[(i=this.basemapView)==null?void 0:i.baseLayerViews,this.layerViews,(s=this.basemapView)==null?void 0:s.referenceLayerViews]},getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.graphicsView=null,this.labelManager=null,this.navigation=new Z4({actionMap:new bY({dragTertiary:"none"})}),this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.supersampleScreenshotsEnabled=!0,this.supportsGround=!1,this.floors=new Nt,this.grid=null,this.map=null,this.spatialReferenceLocked=!1,this.timeline=new R1e,this.type="2d",this.view2dType=null,this.ui=new Axe,this.test={takeScreenshot:async i=>fst(this._getScreenshotView(i),i)},this.padding={top:0,right:0,bottom:0,left:0},pYe()}destroy(){this.layerViewManager.clear(),this._set("preconditionsReady",!1),this.frameTask=er(this.frameTask),this.goToManager.destroy(),this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new wit(this.featuresTilingScheme)}get constraintsInfo(){var s,n;const e=(s=this.defaultsFromMap)==null?void 0:s.tileInfo,i=this.spatialReference;return{lods:(n=e==null?void 0:e.spatialReference)!=null&&n.equals(i)?e.lods:null,spatialReference:i}}get initialExtentRequired(){var a;if(!this.stateManager)return!1;const{scale:e,constraints:i,center:s,viewpoint:n,extent:r}=this;let o=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&((a=this.map.initialViewProperties)!=null&&a.viewpoint))&&!r&&(i!=null&&i.effectiveLODs||(o=-1),(!s||e===0&&o===-1)&&((n==null?void 0:n.targetGeometry)==null||n.targetGeometry.type!=="extent"&&!n.scale))}get defaultsFromMapSettings(){return{required:{extent:!1,heightModelInfo:!1,tileInfo:!0},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get scheduler(){return this.frameTask.scheduler}get typeSpecificPreconditionsReady(){const e=this._getDefaultViewpoint();if(!e)return!1;const i=e.targetGeometry,s=this.spatialReference;return Yye(i.spatialReference,s)}get background(){return NV(this.map)?this.map.initialViewProperties.background:null}set background(e){this._override("background",e)}get center(){var e;return((e=this.stateManager)==null?void 0:e.center)??null}set center(e){this.stateManager.center=e}get highlightOptions(){return Jit(this)}set highlightOptions(e){est(this,e)}get padding(){var e;return(e=this.stateManager)==null?void 0:e.padding}set padding(e){this.stateManager&&(this.stateManager.padding=e)}get rendering(){var e;return((e=this.stage)==null?void 0:e.renderRequested)??!1}get resolution(){return this.stateManager.resolution??0}get scale(){var e;return((e=this.stateManager)==null?void 0:e.scale)??0}set scale(e){this.stateManager&&(this.stateManager.scale=e)}get tileInfo(){var e;return(e=this.featuresTilingScheme)==null?void 0:e.tileInfo}get updating(){var s,n,r,o;const e=!(!this.magnifier.visible||this.magnifier.position===null||!((s=this._magnifierView)!=null&&s.updatingHandles.updating)),i=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(a=>!a.destroyed&&!("layerViews"in a)&&a.updating===!0)||e);if(ke("esri-2d-log-updating")){const a=this.allLayerViews.reduce((l,u)=>({...l,[`${u.layer.id}(${u.layer.type})`]:!u.destroyed&&!("layerViews"in u)&&u.updating}),{});console.log(`Updating MapView: ${i}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${(n=this.layerViewManager)==null?void 0:n.updating}
-> labelManager.updating: ${(r=this.labelManager)==null?void 0:r.updating}
-> graphicsView.updating: ${(o=this.graphicsView)==null?void 0:o.updating}
-> allLayerViews: ${JSON.stringify(a)}
-> updatingMagnifier: ${e}
`)}return i}get visibleArea(){const e=this.stateManager.visibleArea;return e&&new Na({rings:[e.map(i=>[i[0],i[1]])],spatialReference:this.spatialReference})}get zoom(){return this.stateManager.zoom??-1}set zoom(e){this.stateManager.zoom=e}get navigating(){var e;return((e=this.mapViewNavigation)==null?void 0:e.interacting)??!1}async hitTest(e,i){return tst(this,e,i)}async takeScreenshot(e){return pst(this._getScreenshotView(e),e)}toMap(e){if(!this.ready)return null;const i=B0e(e)?G0e(this,e):e;return this.stateManager.toMap(i)}toScreen(e,i){return this.stateManager.toScreen(e,i)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise(e=>{this.ready?e(this):this._resolveWhenReady.push(e)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){var e;return this.map&&"initialViewProperties"in this.map&&this.map.initialViewProperties.spatialReference||((e=this.defaultsFromMap)==null?void 0:e.spatialReference)||null}getDefaultTimeZone(){return NV(this.map)?this.map.initialViewProperties.timeZone:null}getDefaultTimeExtent(){return NV(this.map)?this.map.initialViewProperties.timeExtent:null}hasLayerViewModule(e){return Rne.hasLayerViewModule(e)}importLayerView(e){return Rne.importLayerView(e)}pixelSizeAt(){return this.ready?this.resolution:(ht.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}async popupHitTest(e){var u;const i=this.toMap(e),s=await this.hitTest(e),n=this.allLayerViews.toArray().filter(c=>c.clips.every(h=>w1e(this,h,e,i))).reverse(),r=new globalThis.Map(n.map(c=>[c.layer.uid,c])),o=[];let a=0,l=0;for(;a<s.results.length||l<n.length;){const c=s.results.at(a);if(c&&c.type!=="graphic"){++a;continue}const h=r.get((u=(c==null?void 0:c.layer)??(c==null?void 0:c.graphic.layer))==null?void 0:u.uid);if((!c||h)&&l<n.length&&n.at(l)!==h){const d=n.at(l);"fetchPopupFeaturesAtLocation"in d&&o.push({mapPoint:i,layerView:d}),++l}else c&&(o.push({graphic:c.graphic,layerView:h}),++a)}return{hits:o,location:i}}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}async validate(){let e=Cst(this.type);if(ke("safari")&&ke("safari")<9&&(e=new Se("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:ke("safari")})),e!=null)throw ht.getLogger(this).warn("#validate()",e.message),e}loadAsyncDependencies(){return Jrt()}_getDefaultViewpoint(){var v;const{constraints:e,initialExtent:i,map:s,padding:n,size:r}=this;if(!e)return null;const o=s&&"initialViewProperties"in s?s.initialViewProperties:void 0,a=this.stateManager.getUserStartupOptions(this.size),l=o==null?void 0:o.viewpoint,u=((v=l==null?void 0:l.targetGeometry)==null?void 0:v.extent)??i,c=u==null?void 0:u.center,h=(l==null?void 0:l.rotation)??0,d=(l==null?void 0:l.scale)||u&&J4(u,[r[0]-n.left-n.right,r[1]-n.top-n.bottom]),m=a.center??c,f=a.rotation??h,_=a.scale??d;return m&&_?new th({targetGeometry:m,scale:_,rotation:f}):null}_startup(){var a;this.timeline.begin("MapView Startup");const e=this._getDefaultViewpoint();this.stateManager.startup(e,this.size,this.spatialReference,(a=this.defaultsFromMap.extent)==null?void 0:a.center),this.graphics.owner=this;const i=new Dxe(this.surface,{canvas:this.renderCanvas,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline});this.stage=i,this._magnifierView=new Fxe,this._magnifierView.magnifier=this.magnifier,this._gridView=new kxe;const s=new Oxe({view:this});this._set("labelManager",s);const n=new nit({view:this});this._set("animationManager",n);const r=new Lxe({view:this,animationManager:n});this._set("mapViewNavigation",r),this._setupSpatialReferenceDependentProperties(),this.addHandles([this.rootLayerViews.on("change",()=>this._updateStageChildren()),i.on("webgl-error",l=>this.fatalError=l.error),Ai(()=>this.stationary,l=>i.stationary=l,uu),Ai(()=>this.background,l=>{i.backgroundColor=l==null?void 0:l.color,this._magnifierView.backgroundColor=l==null?void 0:l.color},uu),Ai(()=>this.magnifier,l=>this._magnifierView.magnifier=l,uu),Ai(()=>this.grid,l=>this._gridView.grid=l,uu),Ai(()=>this.renderingOptions,l=>i.renderingOptions=l,uu),Ai(()=>this.highlights.items.map(l=>({name:l.name,options:{fillColor:l.color,haloColor:l.haloColor,fillOpacity:l.fillOpacity,haloOpacity:l.haloOpacity,haloWidth:l.haloWidth,haloBlur:l.haloBlur}})),()=>{i.highlightGradient=Kit(i.highlightGradient,this.highlights.items)},uu),Ai(()=>this.state.id,()=>i.state=this.state,uu)],"map-view"),this._updateStageChildren();const o=this._resolveWhenReady;this._resolveWhenReady=[],o.forEach(l=>l(this)),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.removeHandles("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animation=null,this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._gridView.destroy(),this.stage.destroy(),this.stage=null,this._set("graphicsView",null),this._magnifierView=null,this._gridView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this.stationaryManager.clear(),this._set("ready",!1),this.stateManager.teardown()}_updateStageChildren(){this.stage.removeAllChildren(),this.rootLayerViews.forEach(i=>{this.stage.addChild(i.container)});const e=this.graphicsView;this.stage.addChild(e.container),this.stage.addChild(this._magnifierView),this.stage.addChild(this._gridView)}_setupSpatialReferenceDependentProperties(){const e=new cit(ZYe.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",e);const i=new Nxe({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new Rxe(e)});this._set("graphicsView",i)}_destroySpatialReferenceDependentProperties(){const e=this.graphicsView;this._set("graphicsView",null),e.destroy(),this._set("featuresTilingScheme",null)}_getScreenshotView(e){var o;const{allLayerViews:i,padding:s,size:n,stage:r}=this;return{allLayerViews:i,backgroundColor:e!=null&&e.ignoreBackground?null:(o=this.background)==null?void 0:o.color,padding:s,size:n,stage:r}}_spatialReferenceChanged(e){if(this.ready){this.frameTask.stop();for(const i of this.allLayerViews)i.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(e),this.stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const i of this.allLayerViews)i.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}};vs.type="2d",y([S({constructOnly:!0})],vs.prototype,"deactivatedWebGLExtensions",void 0),y([S({constructOnly:!0})],vs.prototype,"debugWebGLExtensions",void 0),y([S({readOnly:!0})],vs.prototype,"featuresTilingScheme",void 0),y([S({readOnly:!0})],vs.prototype,"graphicsTileStore",null),y([S()],vs.prototype,"graphicsView",void 0),y([S()],vs.prototype,"constraintsInfo",null),y([S()],vs.prototype,"initialExtentRequired",null),y([S()],vs.prototype,"labelManager",void 0),y([S({type:Z4,nonNullable:!0})],vs.prototype,"navigation",void 0),y([S({constructOnly:!0})],vs.prototype,"renderCanvas",void 0),y([S()],vs.prototype,"renderingOptions",void 0),y([S({constructOnly:!0})],vs.prototype,"supersampleScreenshotsEnabled",void 0),y([S({readOnly:!0})],vs.prototype,"supportsGround",void 0),y([S()],vs.prototype,"defaultsFromMapSettings",null),y([S({readOnly:!0})],vs.prototype,"typeSpecificPreconditionsReady",null),y([S({type:Qrt})],vs.prototype,"background",null),y([S()],vs.prototype,"center",null),y([S({type:Nt})],vs.prototype,"floors",void 0),y([S()],vs.prototype,"grid",void 0),y([S({type:cy})],vs.prototype,"highlightOptions",null),y([S()],vs.prototype,"map",void 0),y([S()],vs.prototype,"padding",null),y([S({readOnly:!0})],vs.prototype,"rendering",null),y([S({readOnly:!0})],vs.prototype,"resolution",null),y([S()],vs.prototype,"scale",null),y([S({constructOnly:!0})],vs.prototype,"spatialReferenceLocked",void 0),y([S({readOnly:!0})],vs.prototype,"tileInfo",null),y([S({type:R1e,readOnly:!0})],vs.prototype,"timeline",void 0),y([S({readOnly:!0})],vs.prototype,"type",void 0),y([S({readOnly:!0})],vs.prototype,"updating",null),y([S({readOnly:!0})],vs.prototype,"view2dType",void 0),y([S({readOnly:!0})],vs.prototype,"visibleArea",null),y([S()],vs.prototype,"zoom",null),y([S({readOnly:!0})],vs.prototype,"navigating",null),y([S(),Ls(t=>t instanceof Mxe?t:OS(Axe,t))],vs.prototype,"ui",void 0),vs=y([se("esri.views.View2D")],vs);const eot=vs;let B3=class extends eot{constructor(e){super(e),this.view2dType="map"}};y([S({readOnly:!0})],B3.prototype,"view2dType",void 0),B3=y([se("esri.views.MapView")],B3);const tot=B3;let iot=class $xe{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array(pz),this._values=new Map,this.multipleOriginsSupported=!0}clone(e){const i=new $xe,s=this._originStores[ds.DEFAULTS];s&&s.forEach((n,r)=>{i.set(r,be(n),ds.DEFAULTS)});for(let n=ds.SERVICE;n<pz;n++){const r=this._originStores[n];r&&r.forEach((o,a)=>{e&&e.has(a)||i.set(a,be(o),n)})}return i}get(e,i){const s=i===void 0?this._values:this._originStores[i];return s?s.get(e):void 0}keys(e){const i=e==null?this._values:this._originStores[e];return i?[...i.keys()]:[]}set(e,i,s=ds.USER){let n=this._originStores[s];if(n||(n=new Map,this._originStores[s]=n),n.set(e,i),!this._values.has(e)||this._propertyOriginMap.get(e)<=s){const r=this._values.get(e);return this._values.set(e,i),this._propertyOriginMap.set(e,s),r!==i}return!1}delete(e,i=ds.USER){const s=this._originStores[i];if(!s)return;const n=s.get(e);if(s.delete(e),this._values.has(e)&&this._propertyOriginMap.get(e)===i){this._values.delete(e);for(let r=i-1;r>=0;r--){const o=this._originStores[r];if(o&&o.has(e)){this._values.set(e,o.get(e)),this._propertyOriginMap.set(e,r);break}}}return n}has(e,i){const s=i===void 0?this._values:this._originStores[i];return!!s&&s.has(e)}revert(e,i){for(;i>0&&!this.has(e,i);)--i;const s=this._originStores[i],n=s==null?void 0:s.get(e),r=this._values.get(e);return this._values.set(e,n),this._propertyOriginMap.set(e,i),r!==n}originOf(e){return this._propertyOriginMap.get(e)||ds.DEFAULTS}forEach(e){this._values.forEach(e)}};const Uxe=t=>{let e=class extends t{constructor(...i){super(...i);const s=Su(this),n=s.store,r=new iot;s.store=r,Bue(s,n,r)}read(i,s){Hue(this,i,s)}getAtOrigin(i,s){const n=RV(this),r=H_(s);if(typeof i=="string")return n.get(i,r);const o={};return i.forEach(a=>{o[a]=n.get(a,r)}),o}originOf(i){return vO(this.originIdOf(i))}originIdOf(i){return RV(this).originOf(i)}revert(i,s){const n=RV(this),r=H_(s),o=Su(this);let a;a=typeof i=="string"?i==="*"?n.keys(r):[i]:i,a.forEach(l=>{o.invalidate(l),n.revert(l,r),o.commit(l)})}};return e=y([se("esri.core.ReadOnlyMultiOriginJSONSupport")],e),e};function RV(t){return Su(t).store}let jre=class extends Uxe(ei){};jre=y([se("esri.core.ReadOnlyMultiOriginJSONSupport")],jre);const sot=t=>{let e=class extends t{constructor(...i){super(...i)}clear(i,s="user"){return OV(this).delete(i,H_(s))}write(i,s){return Yue(this,i=i||{},s),i}setAtOrigin(i,s,n){Su(this).setAtOrigin(i,s,H_(n))}removeOrigin(i){const s=OV(this),n=H_(i),r=s.keys(n);for(const o of r)s.originOf(o)===n&&s.set(o,s.get(o,n),ds.USER)}updateOrigin(i,s){const n=OV(this),r=H_(s),o=Tm(this,i);for(let a=r+1;a<pz;++a)n.delete(i,a);n.set(i,o,r)}toJSON(i){return this.write({},i)}};return e=y([se("esri.core.MultiOriginJSONSupport.WriteableMultiOriginJSONSupport")],e),e.prototype.toJSON.isDefaultToJSON=!0,e};function OV(t){return Su(t).store}const Vxe=t=>{let e=class extends sot(Uxe(t)){constructor(...i){super(...i)}};return e=y([se("esri.core.MultiOriginJSONSupport")],e),e};let Yre=class extends Vxe(ei){};Yre=y([se("esri.core.MultiOriginJSONSupport")],Yre);var Fq;let hv=Fq=class extends it{constructor(t){super(t),this.expression=null,this.name=null,this.returnType="boolean",this.title=null}clone(){return new Fq({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};y([S({type:String,json:{write:!0}})],hv.prototype,"expression",void 0),y([S({type:String,json:{write:!0}})],hv.prototype,"name",void 0),y([S({type:["boolean","date","number","string"],json:{write:!0}})],hv.prototype,"returnType",void 0),y([S({type:String,json:{write:!0}})],hv.prototype,"title",void 0),hv=Fq=y([se("esri.form.ExpressionInfo")],hv);const not=hv;let dv=class extends it{constructor(e){super(e),this.description=null,this.label=null,this.type=null,this.visibilityExpression=null}};y([S({type:String,json:{write:!0}})],dv.prototype,"description",void 0),y([S({type:String,json:{write:!0}})],dv.prototype,"label",void 0),y([S()],dv.prototype,"type",void 0),y([S({type:String,json:{write:!0}})],dv.prototype,"visibilityExpression",void 0),dv=y([se("esri.form.elements.Element")],dv);const Dy=dv;let q3=class extends bs.ClonableMixin(it){constructor(e){super(e),this.type=null}};y([S()],q3.prototype,"type",void 0),q3=y([se("esri.form.elements.inputs.attachments.Input")],q3);const Ny=q3,uk=["any","capture","upload"];let Gb=class extends Ny{constructor(e){super(e),this.type="audio",this.inputMethod="any",this.maxDuration=null}};y([S({type:["audio"],readOnly:!0,json:{write:!0}})],Gb.prototype,"type",void 0),y([S({type:uk,json:{write:!0}})],Gb.prototype,"inputMethod",void 0),y([S({type:Number,json:{write:!0}})],Gb.prototype,"maxDuration",void 0),Gb=y([se("esri.form.elements.inputs.attachments.AudioInput")],Gb);const Xre=Gb;let vT=class extends Ny{constructor(e){super(e),this.type="document",this.maxFileSize=null}};y([S({type:["document"],readOnly:!0,json:{write:!0}})],vT.prototype,"type",void 0),y([S({type:Number,json:{write:!0}})],vT.prototype,"maxFileSize",void 0),vT=y([se("esri.form.elements.inputs.attachments.DocumentInput")],vT);const Wre=vT;let Bb=class extends Ny{constructor(e){super(e),this.type="image",this.inputMethod="any",this.maxImageSize=null}};y([S({type:["image"],readOnly:!0,json:{write:!0}})],Bb.prototype,"type",void 0),y([S({type:uk,json:{write:!0}})],Bb.prototype,"inputMethod",void 0),y([S({type:Number,json:{write:!0}})],Bb.prototype,"maxImageSize",void 0),Bb=y([se("esri.form.elements.inputs.attachments.ImageInput")],Bb);const Zre=Bb;let xT=class extends Ny{constructor(e){super(e),this.type="signature",this.inputMethod="any"}};y([S({type:["signature"],readOnly:!0,json:{write:!0}})],xT.prototype,"type",void 0),y([S({type:uk,json:{write:!0}})],xT.prototype,"inputMethod",void 0),xT=y([se("esri.form.elements.inputs.attachments.SignatureInput")],xT);const Kre=xT;let qb=class extends Ny{constructor(e){super(e),this.type="video",this.inputMethod="any",this.maxDuration=null}};y([S({type:["video"],readOnly:!0,json:{write:!0}})],qb.prototype,"type",void 0),y([S({type:uk,json:{write:!0}})],qb.prototype,"inputMethod",void 0),y([S({type:Number,json:{write:!0}})],qb.prototype,"maxDuration",void 0),qb=y([se("esri.form.elements.inputs.attachments.VideoInput")],qb);const Qre=qb;function zxe(t){return{nestableTypes:{base:Ny,key:"type",typeMap:{audio:Xre,document:Wre,image:Zre,signature:Kre,video:Qre}},allTypes:{base:Ny,key:"type",typeMap:{attachment:t,audio:Xre,document:Wre,image:Zre,signature:Kre,video:Qre}}}}function rot(t,e,i){return t?t.map(s=>_d(e.nestableTypes,s)):null}function oot(t,e,i){if(!t)return null;const s=e.nestableTypes.typeMap;return t.filter(n=>s[n.type]).map(n=>s[n.type].fromJSON(n))}function aot(t,e,i){if(!t)return null;const s=e.nestableTypes.typeMap;return t.filter(n=>s[n.type]).map(n=>n.toJSON())}let pm=class extends Ny{constructor(e){super(e),this.type="attachment",this.attachmentAssociationType="exact",this.inputTypes=null}castInputs(e){return rot(e,LV)}readInputs(e,i){return oot(i.inputTypes,LV)}writeInputs(e,i){i.inputTypes=aot(e,LV)}};y([S({type:["attachment"],readOnly:!0,json:{write:!0}})],pm.prototype,"type",void 0),y([S({type:["any","exact","exactOrNone"],json:{write:!0}})],pm.prototype,"attachmentAssociationType",void 0),y([S({json:{write:{isRequired:!0}}})],pm.prototype,"inputTypes",void 0),y([Ls("inputTypes")],pm.prototype,"castInputs",null),y([mt("inputTypes")],pm.prototype,"readInputs",null),y([yt("inputTypes")],pm.prototype,"writeInputs",null),pm=y([se("esri.form.elements.inputs.attachments.AttachmentInput")],pm);const LV=zxe(pm),lot=pm;var kq;const uot=zxe(lot);let Wu=kq=class extends Dy{constructor(t){super(t),this.allowUserRename=!0,this.attachmentKeyword=null,this.displayFilename=!1,this.editableExpression=null,this.filenameExpression="{attachmentKeyword}_{now}",this.input=null,this.maxAttachmentCount=null,this.minAttachmentCount=null,this.type="attachment",this.useOriginalFilename=!0}clone(){var t;return new kq({allowUserRename:this.allowUserRename,attachmentKeyword:this.attachmentKeyword,description:this.description,displayFilename:this.displayFilename,editableExpression:this.editableExpression,filenameExpression:this.filenameExpression,input:(t=this.input)==null?void 0:t.clone(),label:this.label,maxAttachmentCount:this.maxAttachmentCount,minAttachmentCount:this.minAttachmentCount,useOriginalFilename:this.useOriginalFilename,visibilityExpression:this.visibilityExpression})}};y([S({type:Boolean,json:{write:!0}})],Wu.prototype,"allowUserRename",void 0),y([S({type:String,json:{write:{isRequired:!0}}})],Wu.prototype,"attachmentKeyword",void 0),y([S({type:Boolean,json:{write:!0}})],Wu.prototype,"displayFilename",void 0),y([S({type:String,json:{write:!0}})],Wu.prototype,"editableExpression",void 0),y([S({type:String,json:{write:!0}})],Wu.prototype,"filenameExpression",void 0),y([S({types:uot.allTypes,json:{read:{source:"inputType"},write:{target:"inputType",isRequired:!0}}})],Wu.prototype,"input",void 0),y([S({type:Number,json:{write:!0}})],Wu.prototype,"maxAttachmentCount",void 0),y([S({type:Number,json:{write:!0}})],Wu.prototype,"minAttachmentCount",void 0),y([S({type:["attachment"],readOnly:!0,json:{read:!1,write:!0}})],Wu.prototype,"type",void 0),y([S({type:Boolean,json:{write:!0}})],Wu.prototype,"useOriginalFilename",void 0),Wu=kq=y([se("esri.form.elements.AttachmentElement")],Wu);const Jre=Wu;let H3=class extends it{constructor(e){super(e),this.type=null}};y([S()],H3.prototype,"type",void 0),H3=y([se("esri.form.elements.inputs.Input")],H3);const Zf=H3;let bT=class extends Zf{constructor(e){super(e),this.maxLength=null,this.minLength=0}};y([S({type:Number,json:{write:!0}})],bT.prototype,"maxLength",void 0),y([S({type:Number,json:{write:!0}})],bT.prototype,"minLength",void 0),bT=y([se("esri.form.elements.inputs.TextInput")],bT);const ZY=bT;var $q;let j3=$q=class extends ZY{constructor(t){super(t),this.type="barcode-scanner"}clone(){return new $q({maxLength:this.maxLength,minLength:this.minLength})}};y([S({type:["barcode-scanner"],json:{read:!1,write:!0}})],j3.prototype,"type",void 0),j3=$q=y([se("esri.form.elements.inputs.BarcodeScannerInput")],j3);const cot=j3;var Uq;let Hb=Uq=class extends Zf{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="combo-box"}clone(){return new Uq({showNoValueOption:this.showNoValueOption,noValueOptionLabel:this.noValueOptionLabel})}};y([S({type:String,json:{write:!0}})],Hb.prototype,"noValueOptionLabel",void 0),y([S({type:Boolean,json:{write:!0}})],Hb.prototype,"showNoValueOption",void 0),y([S({type:["combo-box"],json:{read:!1,write:!0}})],Hb.prototype,"type",void 0),Hb=Uq=y([se("esri.form.elements.inputs.ComboBoxInput")],Hb);const hot=Hb;var Vq;function eoe(t){return t??null}function toe(t){return t??null}let um=Vq=class extends Zf{constructor(t){super(t),this.max=null,this.min=null,this.type="date-picker"}readMax(t,e){return eoe(e.max)}writeMax(t,e){e.max=toe(t)}readMin(t,e){return eoe(e.min)}writeMin(t,e){e.min=toe(t)}clone(){return new Vq({max:this.max,min:this.min})}};y([S({type:String,json:{type:String,write:!0}})],um.prototype,"max",void 0),y([mt("max")],um.prototype,"readMax",null),y([yt("max")],um.prototype,"writeMax",null),y([S({type:String,json:{type:String,write:!0}})],um.prototype,"min",void 0),y([mt("min")],um.prototype,"readMin",null),y([yt("min")],um.prototype,"writeMin",null),y([S({type:["date-picker"],json:{read:!1,write:!0}})],um.prototype,"type",void 0),um=Vq=y([se("esri.form.elements.inputs.DatePickerInput")],um);const dot=um;var zq;function FV(t){return t??null}function kV(t){return t??null}let su=zq=class extends Zf{constructor(t){super(t),this.includeTimeOffset=!0,this.max=null,this.min=null,this.timeResolution="minutes",this.type="datetimeoffset-picker"}readMax(t,e){return FV(e.max)}writeMax(t,e){e.max=kV(t)}readMin(t,e){return FV(e.min)}writeMin(t,e){e.min=kV(t)}readTimeResolution(t,e){return FV(e.timeResolution)}writeTimeResolution(t,e){e.timeResolution=kV(t)}clone(){return new zq({includeTimeOffset:this.includeTimeOffset,max:this.max,min:this.min,timeResolution:this.timeResolution})}};y([S({type:Boolean,json:{write:!0}})],su.prototype,"includeTimeOffset",void 0),y([S({type:String,json:{type:String,write:!0}})],su.prototype,"max",void 0),y([mt("max")],su.prototype,"readMax",null),y([yt("max")],su.prototype,"writeMax",null),y([S({type:String,json:{type:String,write:!0}})],su.prototype,"min",void 0),y([mt("min")],su.prototype,"readMin",null),y([yt("min")],su.prototype,"writeMin",null),y([S({type:String,json:{type:String,write:!0}})],su.prototype,"timeResolution",void 0),y([mt("timeResolution")],su.prototype,"readTimeResolution",null),y([yt("timeResolution")],su.prototype,"writeTimeResolution",null),y([S({type:["datetimeoffset-picker"],json:{read:!1,write:!0}})],su.prototype,"type",void 0),su=zq=y([se("esri.form.elements.inputs.DateTimeOffsetPickerInput")],su);const mot=su;var Gq;function ioe(t){return t!=null?new Date(t):null}function soe(t){return t?t.getTime():null}let jh=Gq=class extends Zf{constructor(t){super(t),this.includeTime=!1,this.max=null,this.min=null,this.type="datetime-picker"}readMax(t,e){return ioe(e.max)}writeMax(t,e){e.max=soe(t)}readMin(t,e){return ioe(e.min)}writeMin(t,e){e.min=soe(t)}clone(){return new Gq({includeTime:this.includeTime,max:this.max,min:this.min})}};y([S({type:Boolean,json:{write:!0}})],jh.prototype,"includeTime",void 0),y([S({type:Date,json:{type:Number,write:!0}})],jh.prototype,"max",void 0),y([mt("max")],jh.prototype,"readMax",null),y([yt("max")],jh.prototype,"writeMax",null),y([S({type:Date,json:{type:Number,write:!0}})],jh.prototype,"min",void 0),y([mt("min")],jh.prototype,"readMin",null),y([yt("min")],jh.prototype,"writeMin",null),y([S({type:["datetime-picker"],json:{read:!1,write:!0}})],jh.prototype,"type",void 0),jh=Gq=y([se("esri.form.elements.inputs.DateTimePickerInput")],jh);const pot=jh;var Bq;let jb=Bq=class extends Zf{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="radio-buttons"}clone(){return new Bq({noValueOptionLabel:this.noValueOptionLabel,showNoValueOption:this.showNoValueOption})}};y([S({type:String,json:{write:!0}})],jb.prototype,"noValueOptionLabel",void 0),y([S({type:Boolean,json:{write:!0}})],jb.prototype,"showNoValueOption",void 0),y([S({type:["radio-buttons"],json:{read:!1,write:!0}})],jb.prototype,"type",void 0),jb=Bq=y([se("esri.form.elements.inputs.RadioButtonsInput")],jb);const fot=jb;var qq;let Yb=qq=class extends Zf{constructor(t){super(t),this.offValue=null,this.onValue=null,this.type="switch"}clone(){return new qq({offValue:this.offValue,onValue:this.onValue})}};y([S({type:[String,Number],json:{write:!0}})],Yb.prototype,"offValue",void 0),y([S({type:[String,Number],json:{write:!0}})],Yb.prototype,"onValue",void 0),y([S({type:["switch"],json:{read:!1,write:!0}})],Yb.prototype,"type",void 0),Yb=qq=y([se("esri.form.elements.inputs.SwitchInput")],Yb);const got=Yb;var Hq;let Y3=Hq=class extends ZY{constructor(t){super(t),this.type="text-area"}clone(){return new Hq({maxLength:this.maxLength,minLength:this.minLength})}};y([S({type:["text-area"],json:{read:!1,write:!0}})],Y3.prototype,"type",void 0),Y3=Hq=y([se("esri.form.elements.inputs.TextAreaInput")],Y3);const _ot=Y3;var jq;let X3=jq=class extends ZY{constructor(t){super(t),this.type="text-box"}clone(){return new jq({maxLength:this.maxLength,minLength:this.minLength})}};y([S({type:["text-box"],json:{read:!1,write:!0}})],X3.prototype,"type",void 0),X3=jq=y([se("esri.form.elements.inputs.TextBoxInput")],X3);const yot=X3;var Yq;function $V(t){return t??null}function UV(t){return t??null}let Zu=Yq=class extends Zf{constructor(t){super(t),this.max=null,this.min=null,this.timeResolution="minutes",this.type="time-picker"}readMax(t,e){return $V(e.max)}writeMax(t,e){e.max=UV(t)}readMin(t,e){return $V(e.min)}writeMin(t,e){e.min=UV(t)}readTimeResolution(t,e){return $V(e.timeResolution)}writeTimeResolution(t,e){e.timeResolution=UV(t)}clone(){return new Yq({max:this.max,min:this.min,timeResolution:this.timeResolution})}};y([S({type:String,json:{type:String,write:!0}})],Zu.prototype,"max",void 0),y([mt("max")],Zu.prototype,"readMax",null),y([yt("max")],Zu.prototype,"writeMax",null),y([S({type:String,json:{type:String,write:!0}})],Zu.prototype,"min",void 0),y([mt("min")],Zu.prototype,"readMin",null),y([yt("min")],Zu.prototype,"writeMin",null),y([S({type:String,json:{type:String,write:!0}})],Zu.prototype,"timeResolution",void 0),y([mt("timeResolution")],Zu.prototype,"readTimeResolution",null),y([yt("timeResolution")],Zu.prototype,"writeTimeResolution",null),y([S({type:["time-picker"],json:{read:!1,write:!0}})],Zu.prototype,"type",void 0),Zu=Yq=y([se("esri.form.elements.inputs.TimePickerInput")],Zu);const vot=Zu,xot={base:Zf,key:"type",typeMap:{"barcode-scanner":cot,"combo-box":hot,"date-picker":dot,"datetime-picker":pot,"datetimeoffset-picker":mot,"radio-buttons":fot,switch:got,"text-area":_ot,"text-box":yot,"time-picker":vot}};var Xq;let Fc=Xq=class extends Dy{constructor(t){super(t),this.domain=null,this.editable=null,this.editableExpression=null,this.fieldName=null,this.hint=null,this.input=null,this.requiredExpression=null,this.type="field",this.valueExpression=null}clone(){return new Xq({description:this.description,domain:this.domain,editable:this.editable,editableExpression:this.editableExpression,fieldName:this.fieldName,hint:this.hint,input:this.input,label:this.label,requiredExpression:this.requiredExpression,valueExpression:this.valueExpression,visibilityExpression:this.visibilityExpression})}};y([S({types:L0e,json:{read:{reader:W4},write:!0}})],Fc.prototype,"domain",void 0),y([S({type:Boolean,json:{write:!0}})],Fc.prototype,"editable",void 0),y([S({type:String,json:{write:!0}})],Fc.prototype,"editableExpression",void 0),y([S({type:String,json:{write:!0}})],Fc.prototype,"fieldName",void 0),y([S({type:String,json:{write:!0}})],Fc.prototype,"hint",void 0),y([S({types:xot,json:{read:{source:"inputType"},write:{target:"inputType"}}})],Fc.prototype,"input",void 0),y([S({type:String,json:{write:!0}})],Fc.prototype,"requiredExpression",void 0),y([S({type:String,json:{read:!1,write:!0}})],Fc.prototype,"type",void 0),y([S({type:String,json:{write:!0}})],Fc.prototype,"valueExpression",void 0),Fc=Xq=y([se("esri.form.elements.FieldElement")],Fc);const noe=Fc;var Wq;let Jp=Wq=class extends Dy{constructor(t){super(t),this.displayCount=null,this.displayType="list",this.editableExpression=null,this.orderByFields=null,this.relationshipId=null,this.type="relationship"}clone(){return new Wq({description:this.description,displayCount:this.displayCount,displayType:this.displayType,editableExpression:this.editableExpression,label:this.label,orderByFields:be(this.orderByFields),relationshipId:this.relationshipId,visibilityExpression:this.visibilityExpression})}};y([S({type:Number,json:{write:!0}})],Jp.prototype,"displayCount",void 0),y([S({type:["list"],json:{write:!0}})],Jp.prototype,"displayType",void 0),y([S({type:String,json:{write:!0}})],Jp.prototype,"editableExpression",void 0),y([S({type:[r7],json:{write:!0}})],Jp.prototype,"orderByFields",void 0),y([S({type:Number,json:{write:!0}})],Jp.prototype,"relationshipId",void 0),y([S({type:["relationship"],json:{read:!1,write:!0}})],Jp.prototype,"type",void 0),Jp=Wq=y([se("esri.form.elements.RelationshipElement")],Jp);const roe=Jp;var Zq;let Xb=Zq=class extends Dy{constructor(t){super(t),this.text=null,this.textFormat="plain-text",this.type="text"}clone(){return new Zq({text:this.text,textFormat:this.textFormat,visibilityExpression:this.visibilityExpression})}};y([S({type:String,json:{write:!0}})],Xb.prototype,"text",void 0),y([S({type:String,json:{write:!0}})],Xb.prototype,"textFormat",void 0),y([S({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],Xb.prototype,"type",void 0),Xb=Zq=y([se("esri.form.elements.TextElement")],Xb);const ooe=Xb;let Wb=class extends bs.ClonableMixin(Dy){constructor(e){super(e),this.associationTypes=null,this.editableExpression=null,this.type="utilityNetworkAssociations"}};y([S({type:[Xde],json:{write:{isRequired:!0}}})],Wb.prototype,"associationTypes",void 0),y([S({type:String,json:{write:!0}})],Wb.prototype,"editableExpression",void 0),y([S({type:["utilityNetworkAssociations"],json:{read:!1,write:!0}})],Wb.prototype,"type",void 0),Wb=y([se("esri.form.elements.UtilityNetworkAssociationsElement")],Wb);const aoe=Wb,bot=t=>t.type==="field",wot=t=>t.type==="group",Sot=t=>t.type==="text";function Gxe(t){return{typesWithGroup:{base:Dy,key:"type",typeMap:{attachment:Jre,field:noe,group:t,relationship:roe,text:ooe,utilityNetworkAssociations:aoe}},typesWithoutGroup:{base:Dy,key:"type",typeMap:{attachment:Jre,field:noe,relationship:roe,text:ooe,utilityNetworkAssociations:aoe}}}}function Bxe(t,e,i=!0){if(!t)return null;const s=i?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter(n=>s[n.type]).map(n=>s[n.type].fromJSON(n))}function qxe(t,e,i=!0){if(!t)return null;const s=i?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter(n=>s[n.type]).map(n=>n.toJSON())}function Hxe(t,e,i=!0){return t?t.map(s=>_d(i?e.typesWithGroup:e.typesWithoutGroup,s)):null}var Kq;let fm=Kq=class extends Dy{constructor(t){super(t),this.elements=null,this.initialState="expanded",this.type="group"}castElements(t){return Hxe(t,VV,!1)}readElements(t,e){return Bxe(e.formElements,VV,!1)}writeElements(t,e){e.formElements=qxe(t,VV,!1)}clone(){return new Kq({description:this.description,elements:be(this.elements),initialState:this.initialState,label:this.label,visibilityExpression:this.visibilityExpression})}};y([S({json:{write:!0}})],fm.prototype,"elements",void 0),y([Ls("elements")],fm.prototype,"castElements",null),y([mt("elements",["formElements"])],fm.prototype,"readElements",null),y([yt("elements")],fm.prototype,"writeElements",null),y([S({type:["collapsed","expanded"],json:{write:!0}})],fm.prototype,"initialState",void 0),y([S({type:String,json:{read:!1,write:!0}})],fm.prototype,"type",void 0),fm=Kq=y([se("esri.form.elements.GroupElement")],fm);const VV=Gxe(fm),Eot=fm;var Qq;const zV=Gxe(Eot);let Yh=Qq=class extends it{constructor(t){super(t),this.description=null,this.elements=null,this.expressionInfos=null,this.preserveFieldValuesWhenHidden=!1,this.title=null}castElements(t){return Hxe(t,zV)}readElements(t,e){return Bxe(e.formElements,zV)}writeElements(t,e){e.formElements=qxe(t,zV)}clone(){return new Qq({description:this.description,expressionInfos:be(this.expressionInfos),elements:be(this.elements),title:this.title,preserveFieldValuesWhenHidden:this.preserveFieldValuesWhenHidden})}async getFieldsUsed(t,e){const i=new Set,{description:s,elements:n,expressionInfos:r,title:o}=this;if(dP(i,t,s),dP(i,t,o),!n)return[];const a=Cot(n,r).map(l=>al(i,t,l));await Promise.all(a);for(const l of n)jxe(i,{fieldsIndex:t,relationships:e},l);return Array.from(i).sort()}};function jxe(t,e,i){var n;const{fieldsIndex:s}=e;if(!s||s.fields.length!==t.size)switch(dP(t,s,i.label),dP(t,s,i.description),i.type){case"field":Ll(t,s,i.fieldName);break;case"group":i.elements.forEach(r=>jxe(t,e,r));break;case"relationship":if(e.relationships){const r=e.relationships.find(o=>o.id===i.relationshipId);r&&Ll(t,s,r.keyField)}m1(t,s,(n=i.orderByFields)==null?void 0:n.map(r=>r.field));break;case"text":dP(t,s,i.text)}}function Cot(t,e){if(!e||e.length===0)return[];const i=Yxe(t),s=[];for(const n of e)i.has(n.name)&&s.push(n.expression);return s}function Yxe(t){const e=new Set;for(const i of t)if(EK(e,i.visibilityExpression),!Sot(i)){if(wot(i))wO(e,Yxe(i.elements));else if(EK(e,i.editableExpression),bot(i)){const{requiredExpression:s,valueExpression:n}=i;wO(e,[s,n])}}return e}function dP(t,e,i){m1(t,e,QH(i))}y([S({type:String,json:{write:!0}})],Yh.prototype,"description",void 0),y([S({json:{write:!0}})],Yh.prototype,"elements",void 0),y([Ls("elements")],Yh.prototype,"castElements",null),y([mt("elements",["formElements"])],Yh.prototype,"readElements",null),y([yt("elements")],Yh.prototype,"writeElements",null),y([S({type:[not],json:{write:!0}})],Yh.prototype,"expressionInfos",void 0),y([S({type:Boolean,json:{default:!1,write:!0}})],Yh.prototype,"preserveFieldValuesWhenHidden",void 0),y([S({type:String,json:{write:!0}})],Yh.prototype,"title",void 0),Yh=Qq=y([se("esri.form.FormTemplate")],Yh);const Tot=Yh;function loe(t,e,i){if(t.hasM==null||t.hasZ)for(const s of e)for(const n of s)n.length>2&&(n[2]*=i)}function Pot(t,e,i){if(!t&&!e||!i)return;const s=FO(i);uoe(t,i,s),uoe(e,i,s)}function uoe(t,e,i){if(t)for(const s of t)Mot(s.geometry,e,i)}function Mot(t,e,i){if(!(t!=null&&t.spatialReference)||$o(t.spatialReference,e))return;const s=FO(t.spatialReference)/i;if(s!==1){if("x"in t)t.z!=null&&(t.z*=s);else if("rings"in t)loe(t,t.rings,s);else if("paths"in t)loe(t,t.paths,s);else if("points"in t&&(t.hasM==null||t.hasZ))for(const n of t.points)n.length>2&&(n[2]*=s)}}function coe(t,e,i){if(!(i!=null&&i.features)||!i.hasZ)return;const s=Hye(i.geometryType,e,t.outSpatialReference);if(s!=null)for(const n of i.features)s(n.geometry)}var Jq;const e9=new gs({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let Xo=Jq=class extends it{constructor(t){super(t),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(t,e){return this.readFeaturesWithClass(t,e,Kr)}writeGeometryType(t,e,i,s){if(t)return void e9.write(t,e,i,s);const{features:n}=this;if(n){for(const r of n)if((r==null?void 0:r.geometry)!=null)return void e9.write(r.geometry.type,e,i,s)}}readQueryGeometry(t,e){if(!t)return null;const i=!!t.spatialReference,s=f1(t);return s&&!i&&e.spatialReference&&(s.spatialReference=Ri.fromJSON(e.spatialReference)),s}writeSpatialReference(t,e){if(t)return void(e.spatialReference=t.toJSON());const{features:i}=this;if(i){for(const s of i)if(s&&s.geometry!=null&&s.geometry.spatialReference)return void(e.spatialReference=s.geometry.spatialReference.toJSON())}}clone(){return new Jq(this.cloneProperties())}cloneProperties(){return be({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(t){const e=this.write();if(e.features&&Array.isArray(t)&&t.length>0)for(let i=0;i<e.features.length;i++){const s=e.features[i];if(s.geometry){const n=t==null?void 0:t[i];s.geometry=(n==null?void 0:n.toJSON())||s.geometry}}return e}quantize(t){const{scale:[e,i],translate:[s,n]}=t,r=u=>Math.round((u-s)/e),o=u=>Math.round((n-u)/i),a=this.features,l=this._getQuantizationFunction(this.geometryType,r,o);for(let u=0,c=a.length;u<c;u++)l!=null&&l(a[u].geometry)||(a.splice(u,1),u--,c--);return this.transform=t,this}unquantize(){var d,m;const{geometryType:t,features:e,transform:i}=this;if(!i)return this;const{translate:[s,n],scale:[r,o]}=i,a=f=>f*r+s,l=f=>n-f*o;let u=null,c=null;if(this.hasZ&&((d=i==null?void 0:i.scale)==null?void 0:d[2])!=null){const{translate:[,,f],scale:[,,_]}=i;u=v=>v*_+f}if(this.hasM&&((m=i==null?void 0:i.scale)==null?void 0:m[3])!=null){const{translate:[,,,f],scale:[,,,_]}=i;c=v=>v==null?v:v*_+f}const h=this._getHydrationFunction(t,a,l,u,c);for(const{geometry:f}of e)f!=null&&h&&h(f);return this.transform=null,this}readFeaturesWithClass(t,e,i){var r;const s=Ri.fromJSON(e.spatialReference),n=[];for(let o=0;o<t.length;o++){const a=t[o],l=i.fromJSON(a),u=(r=a.geometry)==null?void 0:r.spatialReference;l.geometry==null||u||(l.geometry.spatialReference=s);const c=a.aggregateGeometries,h=l.aggregateGeometries;if(c&&h!=null)for(const d in h){const m=h[d],f=c[d],_=f==null?void 0:f.spatialReference;m==null||_||(m.spatialReference=s)}n.push(l)}return n}_quantizePoints(t,e,i){let s,n;const r=[];for(let o=0,a=t.length;o<a;o++){const l=t[o];if(o>0){const u=e(l[0]),c=i(l[1]);u===s&&c===n||(r.push([u-s,c-n]),s=u,n=c)}else s=e(l[0]),n=i(l[1]),r.push([s,n])}return r.length>0?r:null}_getQuantizationFunction(t,e,i){return t==="point"?s=>(s.x=e(s.x),s.y=i(s.y),s):t==="polyline"||t==="polygon"?s=>{const n=Xv(s)?s.rings:s.paths,r=[];for(let o=0,a=n.length;o<a;o++){const l=n[o],u=this._quantizePoints(l,e,i);u&&r.push(u)}return r.length>0?(Xv(s)?s.rings=r:s.paths=r,s):null}:t==="multipoint"?s=>{const n=this._quantizePoints(s.points,e,i);return n&&n.length>0?(s.points=n,s):null}:t==="extent"?s=>s:null}_getHydrationFunction(t,e,i,s,n){return t==="point"?r=>{r.x=e(r.x),r.y=i(r.y),s&&(r.z=s(r.z))}:t==="polyline"||t==="polygon"?r=>{const o=Xv(r)?r.rings:r.paths;let a,l;for(let u=0,c=o.length;u<c;u++){const h=o[u];for(let d=0,m=h.length;d<m;d++){const f=h[d];d>0?(a+=f[0],l+=f[1]):(a=f[0],l=f[1]),f[0]=e(a),f[1]=i(l)}}if(s&&n)for(let u=0,c=o.length;u<c;u++){const h=o[u];for(let d=0,m=h.length;d<m;d++){const f=h[d];f[2]=s(f[2]),f[3]=n(f[3])}}else if(s)for(let u=0,c=o.length;u<c;u++){const h=o[u];for(let d=0,m=h.length;d<m;d++){const f=h[d];f[2]=s(f[2])}}else if(n)for(let u=0,c=o.length;u<c;u++){const h=o[u];for(let d=0,m=h.length;d<m;d++){const f=h[d];f[2]=n(f[2])}}}:t==="extent"?r=>{r.xmin=e(r.xmin),r.ymin=i(r.ymin),r.xmax=e(r.xmax),r.ymax=i(r.ymax),s&&r.zmax!=null&&r.zmin!=null&&(r.zmax=s(r.zmax),r.zmin=s(r.zmin)),n&&r.mmax!=null&&r.mmin!=null&&(r.mmax=n(r.mmax),r.mmin=n(r.mmin))}:t==="multipoint"?r=>{const o=r.points;let a,l;for(let u=0,c=o.length;u<c;u++){const h=o[u];u>0?(a+=h[0],l+=h[1]):(a=h[0],l=h[1]),h[0]=e(a),h[1]=i(l)}if(s&&n)for(let u=0,c=o.length;u<c;u++){const h=o[u];h[2]=s(h[2]),h[3]=n(h[3])}else if(s)for(let u=0,c=o.length;u<c;u++){const h=o[u];h[2]=s(h[2])}else if(n)for(let u=0,c=o.length;u<c;u++){const h=o[u];h[2]=n(h[2])}}:null}};y([S({type:String,json:{write:!0}})],Xo.prototype,"displayFieldName",void 0),y([S({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Xo.prototype,"exceededTransferLimit",void 0),y([S({type:[Kr],json:{write:!0}})],Xo.prototype,"features",void 0),y([mt("features")],Xo.prototype,"readFeatures",null),y([S({type:[vY],json:{write:!0}})],Xo.prototype,"fields",void 0),y([S({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:e9.read}}})],Xo.prototype,"geometryType",void 0),y([yt("geometryType")],Xo.prototype,"writeGeometryType",null),y([S({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Xo.prototype,"hasM",void 0),y([S({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Xo.prototype,"hasZ",void 0),y([S({types:QM,json:{write:!0}})],Xo.prototype,"queryGeometry",void 0),y([mt("queryGeometry")],Xo.prototype,"readQueryGeometry",null),y([S({type:Ri,json:{write:!0}})],Xo.prototype,"spatialReference",void 0),y([yt("spatialReference")],Xo.prototype,"writeSpatialReference",null),y([S({json:{write:!0}})],Xo.prototype,"transform",void 0),Xo=Jq=y([se("esri.rest.support.FeatureSet")],Xo),Xo.prototype.toJSON.isDefaultToJSON=!0;const Xxe=Xo;let Aot=0,uf=class extends Lf.LoadableMixin(JM.EsriPromiseMixin(Nt)){constructor(e){super(e),this._idToClientGraphic=null,this.type="memory"}load(e){const i=e!=null?e.signal:null;return this.addResolvingPromise(this._startWorker(i)),Promise.resolve(this)}destroy(){var e;(e=this._connection)==null||e.close(),this._connection=null}get _workerGeometryType(){var i;const e=(i=this.layer)==null?void 0:i.geometryType;return e?this._geometryTypeRequiresClientGraphicMapping(e)?"polygon":e:null}applyEdits(e){return this.load().then(()=>this._applyEdits(e))}openPorts(){return this.load().then(()=>this._connection.openPorts())}async queryFeatures(e,i={}){await this.load(i);const s=await this._connection.invoke("queryFeatures",e?e.toJSON():null,i);coe(e,this.layer.spatialReference,s);const n=Xxe.fromJSON(s);if(!this._requiresClientGraphicMapping())return n;const r=this.layer.objectIdField;for(const o of n.features){const a=o.attributes[r],l=this._idToClientGraphic.get(a);l&&(o.geometry=l.geometry)}return n.geometryType=this.layer.geometryType,n}async queryFeaturesJSON(e,i={}){if(this._requiresClientGraphicMapping())throw new Se("query-features-json:unsupported","Cannot query in JSON format for client only geometry types (mesh and extent)");await this.load(i);const s=await this._connection.invoke("queryFeatures",e?e.toJSON():null,i);return coe(e,this.layer.spatialReference,s),s}queryFeatureCount(e,i={}){return this.load(i).then(()=>this._connection.invoke("queryFeatureCount",e?e.toJSON():null,i))}queryObjectIds(e,i={}){return this.load(i).then(()=>this._connection.invoke("queryObjectIds",e?e.toJSON():null,i))}queryExtent(e,i={}){return this.load(i).then(()=>this._connection.invoke("queryExtent",e?e.toJSON():null,i)).then(s=>({count:s.count,extent:Nn.fromJSON(s.extent)}))}querySnapping(e,i={}){return this.load(i).then(()=>this._connection.invoke("querySnapping",e,i))}async queryAttributeBins(e,i={}){return await this.load(),this._connection.invoke("queryAttributeBins",e==null?void 0:e.toJSON(),i)}async _applyEdits(e){if(!this._connection)throw new Se("feature-layer-source:edit-failure","Memory source not loaded");const i=this.layer.objectIdField;let s=null;const n=[],r=[];await Promise.all([this._prepareClientMapping(e.addFeatures,null),this._prepareClientMapping(e.updateFeatures,null)]);const o=c=>"objectId"in c&&c.objectId!=null?c.objectId:"attributes"in c&&c.attributes[i]!=null?c.attributes[i]:null;if(e.addFeatures&&(s=this._prepareAddFeatures(e.addFeatures)),e.deleteFeatures)for(const c of e.deleteFeatures){const h=o(c);h!=null&&n.push(h)}const a=e.updateFeatures&&this._idToClientGraphic?new Map:null;if(e.updateFeatures){for(const c of e.updateFeatures)if(r.push(this._serializeFeature(c)),a){const h=o(c);h!=null&&a.set(h,c)}}Pot(s?s.features:null,r,this.layer.spatialReference);const{fullExtent:l,featureEditResults:u}=await this._connection.invoke("applyEdits",{adds:s?s.features:[],updates:r,deletes:n});return this.fullExtent=l,s&&s.finish(u.uidToObjectId),this._updateClientGraphicIds(a,u),this._createEditsResult(u)}async _prepareClientMapping(e,i){if(this._layerOrSourceGeometryType!=="mesh"||e==null)return;const s=[];for(const{geometry:n}of e)n==null||n.type!=="mesh"||n.hasExtent||n.loaded||s.push(n.load({signal:i}));s.length&&await Promise.all(s)}_updateClientGraphicIds(e,i){if(this._idToClientGraphic){if(e)for(const s of i.updateResults){if(!s.success)continue;const n=e.get(s.objectId);n!=null&&this._addIdToClientGraphic(n)}for(const s of i.deleteResults)s.success&&this._idToClientGraphic.delete(s.objectId)}}_createEditsResult(e){return{addFeatureResults:e.addResults?e.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:e.updateResults?e.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:e.deleteResults?e.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}_createFeatureEditResult(e){const i=e.success===!0?null:e.error||{code:void 0,description:void 0};return{objectId:e.objectId,globalId:e.globalId,error:i?new Se("feature-layer-source:edit-failure",i.description,{code:i.code}):null}}_prepareAddFeatures(e){const i=new Map,s=new Array(e.length);let n=null;for(let o=0;o<e.length;o++){const a=e[o],l=this._serializeFeature(a);n||a.geometry==null||(n=a.geometry.type),s[o]=l,i.set(`${l.uid}`,a)}const r=this;return{features:s,inferredGeometryType:n,finish(o){const a=r.sourceJSON.objectIdField;for(const l in o){const u=o[l],c=i.get(l);c&&(c.attributes||(c.attributes={}),u===-1?delete c.attributes[a]:c.attributes[a]=u,r._addIdToClientGraphic(c))}}}}_addIdToClientGraphic(e){var n;if(!this._idToClientGraphic)return;const i=this.sourceJSON.objectIdField,s=(n=e.attributes)==null?void 0:n[i];s!=null&&this._idToClientGraphic.set(s,e)}get _layerOrSourceGeometryType(){var e,i;return((e=this.layer)==null?void 0:e.geometryType)??((i=this.sourceJSON)==null?void 0:i.geometryType)}_requiresClientGraphicMapping(){return this._geometryTypeRequiresClientGraphicMapping(this._layerOrSourceGeometryType)}_geometryRequiresClientGraphicMapping(e){return this._geometryTypeRequiresClientGraphicMapping(e.type)}_geometryTypeRequiresClientGraphicMapping(e){return e==="mesh"||e==="multipatch"||e==="extent"}_serializeFeature(e){const{attributes:i}=e,s=this._geometryForSerialization(e),n=(Aot++).toString();return s?{uid:n,geometry:s.toJSON(),attributes:i}:{uid:n,attributes:i}}_geometryForSerialization(e){const{geometry:i}=e;return i==null?null:this._geometryRequiresClientGraphicMapping(i)?i.extent?Na.fromExtent(i.extent):null:i}async _startWorker(e){this._connection=await fYe("MemorySourceWorker",{strategy:ke("feature-layers-workers")?"dedicated":"local",signal:e,registryTarget:this});const{fields:i,spatialReference:s,objectIdField:n,hasM:r,hasZ:o,timeInfo:a,dateFieldsTimeZone:l}=this.layer,u=this.layer.originOf("spatialReference")==="defaults";await this._prepareClientMapping(this.items,e);const c=this._prepareAddFeatures(this.items);this.addHandles(this.on("before-changes",f=>{ht.getLogger(this).error("Source modifications will not propagate after layer has been loaded. Please use .applyEdits() instead"),f.preventDefault()}));const h={features:c.features,fields:i==null?void 0:i.map(f=>f.toJSON()),geometryType:kQ.toJSON(this._workerGeometryType),hasM:this._layerOrSourceGeometryType!=="mesh"&&r,hasZ:this._layerOrSourceGeometryType==="mesh"||o,objectIdField:n,spatialReference:u?null:s&&s.toJSON(),timeInfo:(a==null?void 0:a.toJSON())??null,dateFieldsTimeZone:l},d=await this._connection.invoke("load",h,{signal:e});for(const f of d.warnings)ht.getLogger(this.layer).warn("#load()",`${f.message} (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{warning:f});d.featureErrors.length&&ht.getLogger(this.layer).warn("#load()",`Encountered ${d.featureErrors.length} validation errors while loading features. (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{errors:d.featureErrors});const m=d.layerDefinition;this._geometryTypeRequiresClientGraphicMapping(c.inferredGeometryType)&&(m.geometryType=kQ.toJSON(c.inferredGeometryType)),this.sourceJSON=m,this._requiresClientGraphicMapping()&&(this._idToClientGraphic=new Map),c.finish(d.assignedObjectIds)}};y([GH({Type:Kr,ensureType:xo(Kr)})],uf.prototype,"itemType",void 0),y([S()],uf.prototype,"type",void 0),y([S({constructOnly:!0})],uf.prototype,"layer",void 0),y([S({readOnly:!0})],uf.prototype,"_workerGeometryType",null),y([S()],uf.prototype,"sourceJSON",void 0),uf=y([se("esri.layers.graphics.sources.MemorySource")],uf);function Iot(t){return"portalItem"in t}const Dot=t=>{let e=class extends t{get apiKey(){var i;return this._isOverridden("apiKey")?this._get("apiKey"):Iot(this)?(i=this.portalItem)==null?void 0:i.apiKey:null}set apiKey(i){i!=null?this._override("apiKey",i):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return y([S({type:String})],e.prototype,"apiKey",null),e=y([se("esri.layers.mixins.APIKeyMixin")],e),e},Not=t=>{let e=class extends t{get title(){if(this._get("title")&&this.originOf("title")!=="defaults")return this._get("title");if(this.url){const i=VS(this.url);if(i!=null&&i.title)return i.title}return this._get("title")||""}set title(i){this._set("title",i)}set url(i){this._set("url",lTe(i,ht.getLogger(this)))}};return y([S()],e.prototype,"title",null),y([S({type:String})],e.prototype,"url",null),e=y([se("esri.layers.mixins.ArcGISService")],e),e},Rot=t=>{let e=class extends t{constructor(){super(...arguments),this.customParameters=null}};return y([S({type:Object,json:{write:{overridePolicy:i=>({enabled:!!(i&&Object.keys(i).length>0)})}}})],e.prototype,"customParameters",void 0),e=y([se("esri.layers.mixins.CustomParametersMixin")],e),e},Wxe=96;function Owt(t,e){const i=t.extent,s=t.width,n=ah(i==null?void 0:i.spatialReference);return i&&s?i.width/s*n*Ace*Wxe:0}function Lwt(t,e){return t/(ah(e)*Ace*Wxe)}function Fwt(t,e,i){return Oot(t,e)&&Lot(t,i)}function Oot(t,e){return e===0||md(t,e)||t<e}function Lot(t,e){return e===0||md(t,e)||t>e}function Fot(t,e){return md(t,e)?0:(t||Number.POSITIVE_INFINITY)>(e||Number.POSITIVE_INFINITY)?1:-1}const hoe={write:{overridePolicy:(t,e,i)=>({enabled:!i||i.filterMode==="scale"})}};let w_=class extends bs.ClonableMixin(it){constructor(e){super(e),this.id=sk(),this.maxScale=0,this.minScale=0,this.title="",this.where=null}};y([S({type:String,json:{write:!0}})],w_.prototype,"id",void 0),y([S({type:Number,json:hoe})],w_.prototype,"maxScale",void 0),y([S({type:Number,json:hoe})],w_.prototype,"minScale",void 0),y([S({type:String,json:{write:!0}})],w_.prototype,"title",void 0),y([S({type:String,json:{write:!0}})],w_.prototype,"where",void 0),w_=y([se("esri.layers.support.DisplayFilter")],w_);const Zxe=w_;function kot(t,e){return{...e,filterMode:t.mode}}function $wt(t,e){return Kxe(t,e).next().value??null}function Uwt(t,e,i){const s=$ot(t);if(s&&(Wce(e,s[0])||Bz(i,s[1])))return"";const n=Array.from(Kxe(t,e,i)),r=Uot(n,e,i)?"1=1":n.map(o=>o.where||"1=1").reduce((o,a)=>pMe(o,a),"");return r&&r!=="1=1"?r:""}function $ot(t){if(Qxe(t)==="manual")return null;const e=[Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY];for(const{minScale:i,maxScale:s}of t.filters)e[0]=Math.max(e[0],PM(i)),e[1]=Math.min(e[1],sF(s));return e}function*Kxe(t,e,i){if(Qxe(t)==="manual"){const s=t.filters.find(n=>n.id===t.activeFilterId);s&&(yield s)}else{typeof e=="object"&&(e=e.scale);for(const s of t.filters)Vot(s.minScale,s.maxScale,e,i)&&(yield s)}}function Uot(t,e,i){var r,o;if(t.length===0)return!0;const s=PM((r=t.at(0))==null?void 0:r.minScale),n=sF((o=t.at(-1))==null?void 0:o.maxScale);if(Bz(s,e)||Wce(n,i))return!0;for(let a=0;a<t.length-1;a++){const l=t[a],u=t[a+1];if(Bz(PM(u.minScale),sF(l.maxScale)))return!0}return!1}function Vot(t,e,i,s){return t=PM(t),i=PM(i),e=sF(e),!(!md(i,t)&&(s??i)>t)&&!zPe(e,i)&&(s===void 0||!md(s,t))}function Qxe(t){return"mode"in t?t.mode:t.filterMode}function PM(t){return t||Number.POSITIVE_INFINITY}function sF(t){return t||0}let mv=class extends bs.ClonableMixin(it){constructor(e){super(e),this.activeFilterId=null,this.filters=new(Nt.ofType(Zxe)),this.mode="manual"}writeFilters(e,i,s,n){const r=e.toArray();this.mode==="scale"&&r.sort((o,a)=>{const l=Fot(a.minScale,o.minScale),u=o.maxScale-a.maxScale;return l===0?u:l}),i[s]=r.map(o=>o.toJSON(n))}write(e,i){return super.write(e,kot(this,i))}};y([S({type:String,json:{write:{overridePolicy:(t,e,i)=>({enabled:i.filterMode==="manual",isRequired:!0})}}})],mv.prototype,"activeFilterId",void 0),y([S({type:Nt.ofType(Zxe),nonNullable:!0,json:{write:!0}})],mv.prototype,"filters",void 0),y([yt("filters")],mv.prototype,"writeFilters",null),y([S({type:["manual","scale"],nonNullable:!0,json:{name:"filterMode",write:!0}})],mv.prototype,"mode",void 0),mv=y([se("esri.layers.support.DisplayFilterInfo")],mv);const zot=mv,Got=t=>{let e=class extends t{constructor(){super(...arguments),this.displayFilterEnabled=!0,this.displayFilterInfo=null}};return y([S(Bot)],e.prototype,"displayFilterEnabled",void 0),y([S(qot)],e.prototype,"displayFilterInfo",void 0),e=y([se("esri.layers.mixins.DisplayFilteredLayer")],e),e},Bot={type:Boolean,json:{name:"layerDefinition.disableDisplayFilter",read:{reader:t=>!t},write:{layerContainerTypes:rr,writer(t,e,i){la(i,!t,e)}},origins:{"web-scene":{write:!1,read:!1}}}},qot={type:zot,json:{name:"layerDefinition.displayFilterInfo",write:{enabled:!0,allowNull:!0,layerContainerTypes:rr},origins:{"web-scene":{write:!1,read:!1}}}},Hot=kst(),Jxe=new Map,ebe=new Map;async function zwt(t,e,i){if(!t||!i)return!1;if(!e)return!0;const s=new URL(t).host;let n=Jxe.get(s);if(!n){const r=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,"");n=(await $n(r,{responseType:"json",query:{f:"json"}})).data.defaultVersionName}return n===e}async function Gwt(t,e,i=!1){var r,o,a;if(!t||!e)return!0;const s=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),n=(r=ebe.get(s))==null?void 0:r.entries();if(n){for(const[l,u]of n)if(u.name===e){const c=!((o=u.stack)!=null&&o.hasForwardEdits());if(!c&&i){const[{deleteForwardEdits:h},{default:d}]=await Promise.all([_e(()=>import("./deleteForwardEdits-Byvwd_OA.js"),[]),_e(()=>import("./DeleteForwardEditsParameters-DAUUPmwj.js"),[])]),m=await h(s,l,new d({sessionId:Hot,moment:u.moment}));return m.success&&((a=u.stack)==null||a.clearForwardEdits()),m.success}return c}}return!0}function jot(t,e){var n;if(!t)return!1;const i=t.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),s=(n=ebe.get(i))==null?void 0:n.entries();if(s){for(const[r,o]of s)if(o.name===e)return o.lockType==="edit"}return!1}const KY=new vd.EventEmitter;function Yot(t){return KY.on("apply-edits",new WeakRef(t))}function Xot(t){return KY.on("update-moment",new WeakRef(t))}function Bwt(t,e,i=null,s=!1){const n=mc();return s=e==null||s,KY.emit("apply-edits",{serviceUrl:t,layerId:e,gdbVersion:i,mayReceiveServiceEdits:s,result:n.promise}),n}const tbe=Symbol();function qwt(t){return t!=null&&typeof t=="object"&&tbe in t}function aC(t){return t!=null&&typeof t=="object"&&"gdbVersion"in t}function GV(t,e,i){const s=new URL(t).host,n=Jxe.get(s),r=o=>!o||o===n;return r(e)&&r(i)||e===i}const Wot=t=>{var e;let i=class extends t{constructor(...s){super(...s),this[e]=!0,this._applyEditsHandler=n=>{const{serviceUrl:r,layerId:o,gdbVersion:a,mayReceiveServiceEdits:l,result:u}=n,c=r===this.url,h=o!=null&&this.layerId!=null&&o===this.layerId,d=aC(this),m=aC(this)&&GV(r,a,this.gdbVersion);if(!c||d&&!m||!h&&!l)return;const f=u.then(_=>{var w;if(this.lastEditsEventDate=new Date,h&&(_.addedFeatures.length||_.updatedFeatures.length||_.deletedFeatures.length||_.addedAttachments.length||_.updatedAttachments.length||_.deletedAttachments.length))return this.emit("edits",be(_)),_;const v=(w=_.editedFeatures)==null?void 0:w.find(({layerId:T})=>T===this.layerId);if(v){const{adds:T,updates:C,deletes:M}=v.editedFeatures,A={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:T?T.map(({attributes:I})=>({objectId:this.objectIdField&&I[this.objectIdField],globalId:this.globalIdField&&I[this.globalIdField]})):[],deletedFeatures:M?M.map(({attributes:I})=>({objectId:this.objectIdField&&I[this.objectIdField],globalId:this.globalIdField&&I[this.globalIdField]})):[],updatedFeatures:C?C.map(({current:{attributes:I}})=>({objectId:this.objectIdField&&I[this.objectIdField],globalId:this.globalIdField&&I[this.globalIdField]})):[],editedFeatures:be(_.editedFeatures),exceededTransferLimit:!1,historicMoment:be(_.historicMoment)};return this.emit("edits",A),A}const x={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:[],deletedFeatures:[],updatedFeatures:[],editedFeatures:be(_.editedFeatures),exceededTransferLimit:!1,historicMoment:be(_.historicMoment)};return"historicMoment"in this&&this._shouldUpdateHistoricMoment(r,a,x.historicMoment)&&this.emit("edits",x),x}).then(_=>("historicMoment"in this&&this._shouldUpdateHistoricMoment(r,a,_.historicMoment)&&(this.historicMoment=_.historicMoment),_));this.emit("apply-edits",{result:f})},this._updateMomentHandler=n=>{const{serviceUrl:r,gdbVersion:o,moment:a}=n,l=r===this.url,u=aC(this),c=aC(this)&&GV(r,o,this.gdbVersion),h=aC(this)&&!GV(r,this.gdbVersion,null);l&&u&&c&&h&&"historicMoment"in this&&this.historicMoment!==a&&(this.historicMoment=a)},this.when().then(()=>{this.addHandles(Yot(this._applyEditsHandler)),"historicMoment"in this&&this.addHandles(Xot(this._updateMomentHandler))},()=>{})}_shouldUpdateHistoricMoment(s,n,r){return"historicMoment"in this&&this.historicMoment!==r&&jot(s,n)}};return e=tbe,y([S()],i.prototype,"lastEditsEventDate",void 0),i=y([se("esri.layers.mixins.EditBusLayer")],i),i};var t9;const BV=new gs({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),qV=new gs({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let cm=t9=class extends it{constructor(t){super(t),this.where=null,this.geometry=null,this.spatialRelationship="intersects",this.distance=void 0,this.objectIds=null,this.units=null,this.timeExtent=null}createQuery(t={}){const{where:e,geometry:i,spatialRelationship:s,timeExtent:n,objectIds:r,units:o,distance:a}=this;return new Gf({geometry:be(i),objectIds:be(r),spatialRelationship:s,timeExtent:be(n),where:e,units:o,distance:a,...t})}clone(){const{where:t,geometry:e,spatialRelationship:i,timeExtent:s,objectIds:n,units:r,distance:o}=this;return new t9({geometry:be(e),objectIds:be(n),spatialRelationship:i,timeExtent:be(s),where:t,units:r,distance:o})}};y([S({type:String,json:{write:!0}})],cm.prototype,"where",void 0),y([S({types:QM,json:{write:!0}})],cm.prototype,"geometry",void 0),y([S({type:BV.apiValues,json:{name:"spatialRel",read:{reader:BV.read},write:{allowNull:!1,writer:BV.write,overridePolicy(){return{enabled:this.geometry!=null}}}}})],cm.prototype,"spatialRelationship",void 0),y([S({type:Number,json:{write:{overridePolicy(t){return{enabled:t!=null&&this.geometry!=null}}}}})],cm.prototype,"distance",void 0),y([S({type:[Number],json:{write:!0}})],cm.prototype,"objectIds",void 0),y([S({type:qV.apiValues,json:{read:qV.read,write:{writer:qV.write,overridePolicy(t){return{enabled:t!=null&&this.geometry!=null}}}}})],cm.prototype,"units",void 0),y([S({type:Uf,json:{write:!0}})],cm.prototype,"timeExtent",void 0),cm=t9=y([se("esri.layers.support.FeatureFilter")],cm);const Zot=cm;var i9;const doe={read:{reader:uM},write:{writer:cM,overridePolicy(){return{allowNull:this.excludedEffect!=null,isRequired:this.excludedEffect==null}}}},moe={read:{reader:uM},write:{writer:cM,overridePolicy(){return{allowNull:this.includedEffect!=null,isRequired:this.includedEffect==null}}}},poe={name:"showExcludedLabels",default:!0};let pv=i9=class extends it{constructor(t){super(t),this.filter=null,this.includedEffect=null,this.excludedEffect=null,this.excludedLabelsVisible=!1}write(t,e){var s,n;const i=super.write(t,e);if(e!=null&&e.origin){if(i.filter){const r=Object.keys(i.filter);if(r.length>1||r[0]!=="where")return(s=e.messages)==null||s.push(new Se("web-document-write:unsupported-feature-effect","Invalid feature effect 'filter'. A filter can only contain a 'where' property",{layer:e.layer,effect:this})),null}if("showExcludedLabels"in i)return(n=e.messages)==null||n.push(new Se("web-document-write:unsupported-feature-effect","Invalid value for property 'excludedLabelsVisible' which should always be 'true'",{layer:e.layer,effect:this})),null}return i}clone(){return new i9({filter:this.filter!=null?this.filter.clone():null,includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})}};y([S({type:Zot,json:{write:{allowNull:!0,writer(t,e,i,s){const n=t==null?void 0:t.write({},s);n&&Object.keys(n).length!==0?la(i,n,e):la(i,null,e)}}}})],pv.prototype,"filter",void 0),y([S({json:{read:uM,write:{writer:cM,allowNull:!0},origins:{"web-map":doe,"portal-item":doe}}})],pv.prototype,"includedEffect",void 0),y([S({json:{read:uM,write:{writer:cM,allowNull:!0},origins:{"web-map":moe,"portal-item":moe}}})],pv.prototype,"excludedEffect",void 0),y([S({type:Boolean,json:{write:!0,name:"showExcludedLabels",origins:{"web-map":poe,"portal-item":poe}}})],pv.prototype,"excludedLabelsVisible",void 0),pv=i9=y([se("esri.layers.support.FeatureEffect")],pv);const Kot=pv,foe={write:{allowNull:!0}},Qot={type:Kot,json:{origins:{"web-map":foe,"portal-item":foe}}},Jot=t=>{let e=class extends t{constructor(){super(...arguments),this.featureEffect=null}};return y([S(Qot)],e.prototype,"featureEffect",void 0),e=y([se("esri.layers.mixins.FeatureEffectLayer")],e),e};let Zb=class extends it{constructor(e){super(e),this.description=null,this.label=null,this.type=null}};y([S({type:String,json:{write:!0}})],Zb.prototype,"description",void 0),y([S({type:String,json:{write:!0}})],Zb.prototype,"label",void 0),y([S()],Zb.prototype,"type",void 0),Zb=y([se("esri.tables.elements.AttributeTableElement")],Zb);const RS=Zb;var s9;let wT=s9=class extends RS{constructor(t){super(t),this.displayType="auto",this.type="attachment"}clone(){return new s9({description:this.description,displayType:this.displayType,label:this.label})}};y([S({type:["auto"],json:{write:!0}})],wT.prototype,"displayType",void 0),y([S({type:["attachment"],readOnly:!0,json:{read:!1,write:!0}})],wT.prototype,"type",void 0),wT=s9=y([se("esri.tables.elements.AttributeTableAttachmentElement")],wT);const goe=wT;var n9;let ST=n9=class extends RS{constructor(t){super(t),this.fieldName=null,this.type="field"}clone(){return new n9({description:this.description,fieldName:this.fieldName,label:this.label})}};y([S({type:String,json:{write:!0}})],ST.prototype,"fieldName",void 0),y([S({type:String,json:{read:!1,write:!0}})],ST.prototype,"type",void 0),ST=n9=y([se("esri.tables.elements.AttributeTableFieldElement")],ST);const _oe=ST;var r9;let ET=r9=class extends RS{constructor(t){super(t),this.relationshipId=null,this.type="relationship"}clone(){return new r9({description:this.description,label:this.label,relationshipId:this.relationshipId})}};y([S({type:Number,json:{write:!0}})],ET.prototype,"relationshipId",void 0),y([S({type:["relationship"],json:{read:!1,write:!0}})],ET.prototype,"type",void 0),ET=r9=y([se("esri.tables.elements.AttributeTableRelationshipElement")],ET);const yoe=ET;function ibe(t){return{typesWithGroup:{base:RS,key:"type",typeMap:{attachment:goe,field:_oe,group:t,relationship:yoe}},typesWithoutGroup:{base:RS,key:"type",typeMap:{attachment:goe,field:_oe,relationship:yoe}}}}function sbe(t,e,i=!0){if(!t)return null;const s=i?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter(n=>s[n.type]).map(n=>s[n.type].fromJSON(n))}function nbe(t,e,i=!0){if(!t)return null;const s=i?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter(n=>s[n.type]).map(n=>n.toJSON())}function rbe(t,e,i=!0){return t?t.map(s=>_d(i?e.typesWithGroup:e.typesWithoutGroup,s)):null}var o9;let cf=o9=class extends RS{constructor(t){super(t),this.elements=null,this.type="group"}castElements(t){return rbe(t,HV,!1)}readElements(t,e){return sbe(e.attributeTableElements,HV,!1)}writeElements(t,e){e.attributeTableElements=nbe(t,HV,!1)}clone(){return new o9({description:this.description,elements:be(this.elements),label:this.label})}};y([S({json:{write:!0}})],cf.prototype,"elements",void 0),y([Ls("elements")],cf.prototype,"castElements",null),y([mt("elements",["attributeTableElements"])],cf.prototype,"readElements",null),y([yt("elements")],cf.prototype,"writeElements",null),y([S({type:String,json:{read:!1,write:!0}})],cf.prototype,"type",void 0),cf=o9=y([se("esri.tables.elements.AttributeTableGroupElement")],cf);const HV=ibe(cf),eat=cf;var a9;const jV=ibe(eat);let S_=a9=class extends it{constructor(t){super(t),this.elements=null,this.orderByFields=null}castElements(t){return rbe(t,jV)}readElements(t,e){return sbe(e.attributeTableElements,jV)}writeElements(t,e){e.attributeTableElements=nbe(t,jV)}clone(){return new a9({elements:be(this.elements),orderByFields:this.orderByFields})}};y([S({json:{write:!0}})],S_.prototype,"elements",void 0),y([Ls("elements")],S_.prototype,"castElements",null),y([mt("elements",["attributeTableElements"])],S_.prototype,"readElements",null),y([yt("elements")],S_.prototype,"writeElements",null),y([S({type:[Object],json:{write:!0}})],S_.prototype,"orderByFields",void 0),S_=a9=y([se("esri.tables.AttributeTableTemplate")],S_);const tat=S_,iat={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:{enabled:!0,layerContainerTypes:rr}}},ck={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(t,e)=>!e.disablePopup},write:{enabled:!0,writer(t,e,i){e[i]=!t}}}},hk={type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",write:{enabled:!0,layerContainerTypes:rr}}},sat={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:o1}}},nat={type:Boolean,value:!0,nonNullable:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:{enabled:!0,layerContainerTypes:rr}}},rat={value:null,type:R_e,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:{enabled:!0,layerContainerTypes:rr}}};function jwt(t){return{type:t,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const obe={write:{enabled:!0,layerContainerTypes:rr},read:!0},l9={type:Number,json:{origins:{"web-document":obe,"portal-item":{write:{layerContainerTypes:rr}}}}},oat={...l9,json:{...l9.json,origins:{"web-document":{...obe,write:{enabled:!0,layerContainerTypes:rr,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}}},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(t,e,i)=>{var s;return i&&i.origin!=="service"||!e.drawingInfo||e.drawingInfo.transparency===void 0?(s=e.layerDefinition)!=null&&s.drawingInfo&&e.layerDefinition.drawingInfo.transparency!==void 0?IP(e.layerDefinition.drawingInfo.transparency):void 0:IP(e.drawingInfo.transparency)}}}},Ywt={type:Nn,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:(t,e)=>{const i=Nn.fromJSON(t);return e.spatialReference!=null&&typeof e.spatialReference=="object"&&(i.spatialReference=Ri.fromJSON(e.spatialReference)),i}}}},read:!1}},aat={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},lat={type:Number,json:{origins:{service:{write:{enabled:!1}}},name:"layerDefinition.minScale",write:{layerContainerTypes:rr}}},uat={type:Number,json:{origins:{service:{write:{enabled:!1}}},name:"layerDefinition.maxScale",write:{layerContainerTypes:rr}}},abe={json:{write:{ignoreOrigin:!0,layerContainerTypes:rr},origins:{"web-map":{read:!1,write:!1}}}},cat={type:tat,json:{name:"attributeTableInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}};let ef=class extends bs.ClonableMixin(it){constructor(e){super(e),this.creatorField=null,this.creationDateField=null,this.editorField=null,this.editDateField=null,this.realm=null,this.timeZone=null}};y([S()],ef.prototype,"creatorField",void 0),y([S()],ef.prototype,"creationDateField",void 0),y([S()],ef.prototype,"editorField",void 0),y([S()],ef.prototype,"editDateField",void 0),y([S()],ef.prototype,"realm",void 0),y([S(XO("dateFieldsTimeReference",!0))],ef.prototype,"timeZone",void 0),ef=y([se("esri.layers.support.EditFieldsInfo")],ef);const hat=ef;let gm=class extends bs.ClonableMixin(it){constructor(e){super(e)}};y([S({constructOnly:!0,json:{write:!0}})],gm.prototype,"name",void 0),y([S({constructOnly:!0,json:{write:!0}})],gm.prototype,"fields",void 0),y([S({constructOnly:!0,json:{write:!0}})],gm.prototype,"isAscending",void 0),y([S({constructOnly:!0,json:{write:!0}})],gm.prototype,"indexType",void 0),y([S({constructOnly:!0,json:{write:!0}})],gm.prototype,"isUnique",void 0),y([S({constructOnly:!0,json:{write:!0}})],gm.prototype,"description",void 0),gm=y([se("esri.layers.support.FeatureIndex")],gm);async function dat(t,e,i){e=e.clone(),t.capabilities.query.supportsMaxRecordCountFactor&&(e.maxRecordCountFactor=lbe(t));const s=mat(t),n=t.capabilities.query.supportsPagination;e.start=0,e.num=s;let r=null;for(;;){const o=await t.source.queryFeaturesJSON(e,i);if(r==null?r=o:r.features=r.features.concat(o.features),r.exceededTransferLimit=o.exceededTransferLimit,!n||!o.exceededTransferLimit)break;e.start+=s}return r}function mat(t){return lbe(t)*pat(t)}function pat(t){return t.capabilities.query.maxRecordCount||2e3}function lbe(t){return t.capabilities.query.supportsMaxRecordCountFactor?Gf.MAX_MAX_RECORD_COUNT_FACTOR:1}var u9;let CT=u9=class extends it{constructor(t){super(t),this.minValue=0,this.maxValue=0}clone(){return new u9({minValue:this.minValue,maxValue:this.maxValue})}};y([S({type:Number,json:{write:!0}})],CT.prototype,"minValue",void 0),y([S({type:Number,json:{write:!0}})],CT.prototype,"maxValue",void 0),CT=u9=y([se("esri.renderers.support.AuthoringInfoClassBreakInfo")],CT);var c9;let U_=c9=class extends it{constructor(t){super(t),this.field="",this.normalizationField="",this.label="",this.classBreakInfos=new Array}clone(){return new c9({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:be(this.classBreakInfos)})}};y([S({type:String,json:{write:!0}})],U_.prototype,"field",void 0),y([S({type:String,json:{write:!0}})],U_.prototype,"normalizationField",void 0),y([S({type:String,json:{write:!0}})],U_.prototype,"label",void 0),y([S({type:[CT],json:{write:!0}})],U_.prototype,"classBreakInfos",void 0),U_=c9=y([se("esri.renderers.support.AuthoringInfoFieldInfo")],U_);var h9;let Kb=h9=class extends it{constructor(t){super(t),this.label=null,this.size=null,this.value=null}clone(){return new h9({label:this.label,value:this.value,size:this.size})}};y([S({type:String,json:{write:!0}})],Kb.prototype,"label",void 0),y([S({type:Number,json:{write:!0}})],Kb.prototype,"size",void 0),y([S({type:Number,json:{write:!0}})],Kb.prototype,"value",void 0),Kb=h9=y([se("esri.renderers.support.AuthoringInfoSizeStop")],Kb);const fat=Kb;var d9;const rR=new gs({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),oR=new gs({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),voe={key:t=>typeof t=="number"?"number":"string",typeMap:{number:Number,string:String},base:null},xoe=["high-to-low","above-and-below","centered-on","extremes"],boe=[...new Set(["high-to-low","above-and-below","centered-on","extremes","above","below","high-to-low","above-and-below","above","below","reference-size"])],woe=["seconds","minutes","hours","days","months","years"],gat=["circle","diamond","hexagon-flat","hexagon-pointy","square"];let Wo=d9=class extends it{constructor(t){super(t),this.endTime=null,this.field=null,this.maxSliderValue=null,this.minSliderValue=null,this.startTime=null,this.type=null,this.units=null}castEndTime(t){return typeof t=="string"||typeof t=="number"?t:null}get normalizationField(){return this.theme==="reference-size"?this._get("normalizationField"):null}set normalizationField(t){this._set("normalizationField",t)}get referenceSizeScale(){return this.theme==="reference-size"?this._get("referenceSizeScale"):null}set referenceSizeScale(t){this._set("referenceSizeScale",t)}get referenceSizeSymbolStyle(){return this.theme==="reference-size"?this._get("referenceSizeSymbolStyle"):null}set referenceSizeSymbolStyle(t){this._set("referenceSizeSymbolStyle",t)}castStartTime(t){return typeof t=="string"||typeof t=="number"?t:null}get sizeStops(){return this.theme==="reference-size"?this._get("sizeStops"):null}set sizeStops(t){this._set("sizeStops",t)}get style(){return this.type==="color"?this._get("style"):null}set style(t){this._set("style",t)}get theme(){return this.type==="color"||this.type==="size"?this._get("theme")||"high-to-low":null}set theme(t){this._set("theme",t)}clone(){return new d9({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,normalizationField:this.normalizationField,referenceSizeScale:this.referenceSizeScale,referenceSizeSymbolStyle:this.referenceSizeSymbolStyle,sizeStops:be(this.sizeStops),startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}};y([S({types:voe,json:{write:!0}})],Wo.prototype,"endTime",void 0),y([Ls("endTime")],Wo.prototype,"castEndTime",null),y([S({type:String,json:{write:!0}})],Wo.prototype,"field",void 0),y([S({type:Number,json:{write:!0}})],Wo.prototype,"maxSliderValue",void 0),y([S({type:Number,json:{write:!0}})],Wo.prototype,"minSliderValue",void 0),y([S({type:String,json:{origins:{"web-scene":{write:!1}},write:!0}})],Wo.prototype,"normalizationField",null),y([S({type:Number,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],Wo.prototype,"referenceSizeScale",null),y([S({type:gat,value:null,json:{origins:{"web-scene":{write:!1}},write:!0}})],Wo.prototype,"referenceSizeSymbolStyle",null),y([S({types:voe,json:{write:!0}})],Wo.prototype,"startTime",void 0),y([Ls("startTime")],Wo.prototype,"castStartTime",null),y([S({type:[fat],json:{origins:{"web-scene":{write:!1}},write:!0}})],Wo.prototype,"sizeStops",null),y([S({type:rR.apiValues,value:null,json:{type:rR.jsonValues,read:rR.read,write:rR.write}})],Wo.prototype,"style",null),y([S({type:boe,value:null,json:{type:boe,origins:{"web-scene":{type:xoe,write:{writer:(t,e)=>{xoe.includes(t)&&(e.theme=t)}}}},write:!0}})],Wo.prototype,"theme",null),y([S({type:oR.apiValues,json:{type:oR.jsonValues,read:oR.read,write:oR.write}})],Wo.prototype,"type",void 0),y([S({type:woe,json:{type:woe,write:!0}})],Wo.prototype,"units",void 0),Wo=d9=y([se("esri.renderers.support.AuthoringInfoVisualVariable")],Wo);const _at=Wo;let W3=class extends it{constructor(e){super(e),this.type=null}};y([S({readOnly:!0,json:{read:!1,write:!0}})],W3.prototype,"type",void 0),W3=y([se("esri.rest.support.ColorRamp")],W3);const QY=W3;var m9;let fv=m9=class extends QY{constructor(t){super(t),this.algorithm=null,this.fromColor=null,this.toColor=null,this.type="algorithmic"}clone(){return new m9({fromColor:be(this.fromColor),toColor:be(this.toColor),algorithm:this.algorithm})}};y([ai({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],fv.prototype,"algorithm",void 0),y([S({type:Gt,json:{type:[zs],write:!0}})],fv.prototype,"fromColor",void 0),y([S({type:Gt,json:{type:[zs],write:!0}})],fv.prototype,"toColor",void 0),y([S({type:["algorithmic"]})],fv.prototype,"type",void 0),fv=m9=y([se("esri.rest.support.AlgorithmicColorRamp")],fv);const JY=fv;var p9;let TT=p9=class extends QY{constructor(t){super(t),this.colorRamps=null,this.type="multipart"}clone(){return new p9({colorRamps:be(this.colorRamps)})}};y([S({type:[JY],json:{write:!0}})],TT.prototype,"colorRamps",void 0),y([S({type:["multipart"]})],TT.prototype,"type",void 0),TT=p9=y([se("esri.rest.support.MultipartColorRamp")],TT);const ube=TT,yat={key:"type",base:QY,typeMap:{algorithmic:JY,multipart:ube}};function vat(t){return t!=null&&t.type?t.type==="algorithmic"?JY.fromJSON(t):t.type==="multipart"?ube.fromJSON(t):null:null}var f9;const O0=new gs({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),aR=new gs({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density",flow:"flow"}),Soe=new gs({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),Eoe=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers"],xat=["high-to-low","above-and-below","above","below"],bat=["flow-line","wave-front"],wat=["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"];let Er=f9=class extends it{constructor(t){super(t),this.colorRamp=null,this.fadeRatio=null,this.isAutoGenerated=!1,this.lengthUnit=null,this.maxSliderValue=null,this.minSliderValue=null,this.visualVariables=null}get classificationMethod(){const t=this._get("classificationMethod"),e=this.type;return e&&e!=="relationship"?e==="class-breaks-size"||e==="class-breaks-color"?t||"manual":null:t}set classificationMethod(t){this._set("classificationMethod",t)}readColorRamp(t){return t?vat(t):void 0}get fields(){return this.type&&this.type!=="predominance"?null:this._get("fields")}set fields(t){this._set("fields",t)}get field1(){return this.type&&this.type!=="relationship"?null:this._get("field1")}set field1(t){this._set("field1",t)}get field2(){return this.type&&this.type!=="relationship"?null:this._get("field2")}set field2(t){this._set("field2",t)}get flowTheme(){return this.type==="flow"?this._get("flowTheme"):null}set flowTheme(t){this._set("flowTheme",t)}get focus(){return this.type&&this.type!=="relationship"?null:this._get("focus")}set focus(t){this._set("focus",t)}get numClasses(){return this.type&&this.type!=="relationship"?null:this._get("numClasses")}set numClasses(t){this._set("numClasses",t)}get statistics(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("statistics"):null}set statistics(t){this._set("statistics",t)}get standardDeviationInterval(){const t=this.type;return t&&t!=="relationship"&&t!=="class-breaks-size"&&t!=="class-breaks-color"||this.classificationMethod&&this.classificationMethod!=="standard-deviation"?null:this._get("standardDeviationInterval")}set standardDeviationInterval(t){this._set("standardDeviationInterval",t)}get type(){return this._get("type")}set type(t){let e=t;t==="classed-size"?e="class-breaks-size":t==="classed-color"&&(e="class-breaks-color"),this._set("type",e)}get univariateSymbolStyle(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("univariateSymbolStyle"):null}set univariateSymbolStyle(t){this._set("univariateSymbolStyle",t)}get univariateTheme(){return this.type==="univariate-color-size"?this._get("univariateTheme"):null}set univariateTheme(t){this._set("univariateTheme",t)}clone(){var t;return new f9({classificationMethod:this.classificationMethod,colorRamp:be(this.colorRamp),fadeRatio:be(this.fadeRatio),fields:(t=this.fields)==null?void 0:t.slice(),field1:be(this.field1),field2:be(this.field2),isAutoGenerated:this.isAutoGenerated,focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map(e=>e.clone()),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme,flowTheme:this.flowTheme})}};y([S({type:O0.apiValues,value:null,json:{type:O0.jsonValues,read:O0.read,write:O0.write,origins:{"web-document":{default:"manual",type:O0.jsonValues,read:O0.read,write:O0.write}}}})],Er.prototype,"classificationMethod",null),y([S({types:yat,json:{write:!0}})],Er.prototype,"colorRamp",void 0),y([mt("colorRamp")],Er.prototype,"readColorRamp",null),y([S({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Er.prototype,"fadeRatio",void 0),y([S({type:[String],value:null,json:{write:!0}})],Er.prototype,"fields",null),y([S({type:U_,value:null,json:{write:!0}})],Er.prototype,"field1",null),y([S({type:U_,value:null,json:{write:!0}})],Er.prototype,"field2",null),y([S({type:bat,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Er.prototype,"flowTheme",null),y([S({type:["HH","HL","LH","LL"],value:null,json:{write:!0}})],Er.prototype,"focus",null),y([S({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1}}}})],Er.prototype,"isAutoGenerated",void 0),y([S({type:Number,value:null,json:{type:zs,write:!0}})],Er.prototype,"numClasses",null),y([S({type:Eoe,json:{type:Eoe,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],Er.prototype,"lengthUnit",void 0),y([S({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Er.prototype,"maxSliderValue",void 0),y([S({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Er.prototype,"minSliderValue",void 0),y([S({type:Object,value:null,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Er.prototype,"statistics",null),y([S({type:[.25,.33,.5,1],value:null,json:{type:[.25,.33,.5,1],write:!0}})],Er.prototype,"standardDeviationInterval",null),y([S({type:aR.apiValues,value:null,json:{type:aR.jsonValues,read:aR.read,write:aR.write,origins:{"web-scene":{type:Soe.jsonValues,write:{writer:Soe.write,overridePolicy:t=>({enabled:t!=="flow"})}}}}})],Er.prototype,"type",null),y([S({type:[_at],json:{write:!0}})],Er.prototype,"visualVariables",void 0),y([S({type:wat,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Er.prototype,"univariateSymbolStyle",null),y([S({type:xat,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Er.prototype,"univariateTheme",null),Er=f9=y([se("esri.renderers.support.AuthoringInfo")],Er);const eX=Er,YV=new gs({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary",pieChart:"pie-chart"},{ignoreUnknown:!0});let PT=class extends it{constructor(e){super(e),this.authoringInfo=null,this.type=null}async getRequiredFields(e){if(!this.collectRequiredFields)return[];const i=new Set;return await this.collectRequiredFields(i,e),Array.from(i).sort()}getSymbol(e,i){}async getSymbolAsync(e,i){}get symbols(){return[]}get arcadeRequired(){return!1}getAttributeHash(){return JSON.stringify(this)}getMeshHash(){return JSON.stringify(this)}};y([S({type:eX,json:{write:!0}})],PT.prototype,"authoringInfo",void 0),y([S({type:YV.apiValues,readOnly:!0,json:{type:YV.jsonValues,read:!1,write:{writer:YV.write,ignoreOrigin:!0,isRequired:!0}}})],PT.prototype,"type",void 0),PT=y([se("esri.renderers.Renderer")],PT);const Kf=PT;let MT=class extends bs.ClonableMixin(it){constructor(){super(...arguments),this.showLegend=null,this.title=null}};y([S({type:Boolean,json:{write:!0}})],MT.prototype,"showLegend",void 0),y([S({type:String,json:{write:!0}})],MT.prototype,"title",void 0),MT=y([se("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],MT);const cbe=MT,XV=new gs({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let Xh=class extends it{constructor(e){super(e),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null}castField(e){return e==null?e:typeof e=="function"?(ht.getLogger(this).error(".field: field must be a string value"),null):OM(e)}get arcadeRequired(){return!!this.valueExpression}clone(){}getAttributeHash(){return`${this.type}-${this.field}-${this.valueExpression}`}};y([S()],Xh.prototype,"index",void 0),y([S({type:XV.apiValues,readOnly:!0,json:{read:XV.read,write:{writer:XV.write,isRequired:!0}}})],Xh.prototype,"type",void 0),y([S({type:String,json:{write:!0}})],Xh.prototype,"field",void 0),y([Ls("field")],Xh.prototype,"castField",null),y([S({type:String,json:{write:!0}})],Xh.prototype,"valueExpression",void 0),y([S({type:String,json:{write:!0}})],Xh.prototype,"valueExpressionTitle",void 0),y([S({readOnly:!0})],Xh.prototype,"arcadeRequired",null),y([S({type:cbe,json:{write:!0}})],Xh.prototype,"legendOptions",void 0),Xh=y([se("esri.renderers.visualVariables.VisualVariable")],Xh);const uE=Xh;var g9;let gv=g9=class extends it{constructor(t){super(t),this.color=null,this.label=null,this.value=null}writeValue(t,e,i){e[i]=t??0}clone(){return new g9({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};y([S({type:Gt,json:{type:[zs],write:{isRequired:!0}}})],gv.prototype,"color",void 0),y([S({type:String,json:{write:!0}})],gv.prototype,"label",void 0),y([S({type:Number,json:{write:{writerEnsuresNonNull:!0}}})],gv.prototype,"value",void 0),y([yt("value")],gv.prototype,"writeValue",null),gv=g9=y([se("esri.renderers.visualVariables.support.ColorStop")],gv);const Sat=gv;var _9;let _v=_9=class extends uE{constructor(t){super(t),this.type="color",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,i)=>e.value-i.value),this._set("stops",t)}clone(){var t;return new _9({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(e=>e.clone()),legendOptions:(t=this.legendOptions)==null?void 0:t.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(t=>t.value||0)}};y([S({readOnly:!0})],_v.prototype,"cache",null),y([S({type:["color"],json:{type:["colorInfo"]}})],_v.prototype,"type",void 0),y([S({type:String,json:{write:!0}})],_v.prototype,"normalizationField",void 0),y([S({type:[Sat],json:{write:!0}})],_v.prototype,"stops",null),_v=_9=y([se("esri.renderers.visualVariables.ColorVariable")],_v);const hbe=_v;var y9;let E_=y9=class extends it{constructor(t){super(t),this.label=null,this.opacity=null,this.value=null}readOpacity(t,e){return IP(e.transparency)}writeOpacity(t,e,i){e[i]=HF(t)}clone(){return new y9({label:this.label,opacity:this.opacity,value:this.value})}};y([S({type:String,json:{write:!0}})],E_.prototype,"label",void 0),y([S({type:Number,json:{type:zs,write:{target:"transparency",isRequired:!0}}})],E_.prototype,"opacity",void 0),y([mt("opacity",["transparency"])],E_.prototype,"readOpacity",null),y([yt("opacity")],E_.prototype,"writeOpacity",null),y([S({type:Number,json:{write:{isRequired:!0}}})],E_.prototype,"value",void 0),E_=y9=y([se("esri.renderers.visualVariables.support.OpacityStop")],E_);const Eat=E_;var v9;let yv=v9=class extends uE{constructor(t){super(t),this.type="opacity",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,i)=>e.value-i.value),this._set("stops",t)}clone(){var t;return new v9({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(e=>e.clone()),legendOptions:(t=this.legendOptions)==null?void 0:t.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(t=>t.value||0)}};y([S({readOnly:!0})],yv.prototype,"cache",null),y([S({type:["opacity"],json:{type:["transparencyInfo"]}})],yv.prototype,"type",void 0),y([S({type:String,json:{write:!0}})],yv.prototype,"normalizationField",void 0),y([S({type:[Eat],json:{write:!0}})],yv.prototype,"stops",null),yv=v9=y([se("esri.renderers.visualVariables.OpacityVariable")],yv);const tX=yv;var x9;let vv=x9=class extends uE{constructor(t){super(t),this.axis=null,this.type="rotation",this.rotationType="geographic"}get cache(){return{hasExpression:!!this.valueExpression,compiledFunc:null}}clone(){var t;return new x9({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:(t=this.legendOptions)==null?void 0:t.clone()})}};y([S({readOnly:!0})],vv.prototype,"cache",null),y([S({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],vv.prototype,"axis",void 0),y([S({type:["rotation"],json:{type:["rotationInfo"]}})],vv.prototype,"type",void 0),y([S({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],vv.prototype,"rotationType",void 0),vv=x9=y([se("esri.renderers.visualVariables.RotationVariable")],vv);const dbe=vv;function Cat(t){return Ps(t)}var b9;let C_=b9=class extends it{constructor(t){super(t),this.label=null,this.size=null,this.value=null,this.useMinValue=null,this.useMaxValue=null}clone(){return new b9({label:this.label,size:this.size,value:this.value,useMaxValue:this.useMaxValue,useMinValue:this.useMinValue})}};y([S({type:String,json:{write:!0}})],C_.prototype,"label",void 0),y([S({type:Number,cast:Ps,json:{write:{isRequired:!0}}})],C_.prototype,"size",void 0),y([S({type:Number,json:{write:{isRequired:!0}}})],C_.prototype,"value",void 0),y([S({type:Boolean,json:{write:!1}})],C_.prototype,"useMinValue",void 0),y([S({type:Boolean,json:{write:!1}})],C_.prototype,"useMaxValue",void 0),C_=b9=y([se("esri.renderers.visualVariables.support.SizeStop")],C_);const Z3=C_;let K3=class extends cbe{constructor(){super(...arguments),this.customValues=null}};y([S({type:[Number],json:{write:!0}})],K3.prototype,"customValues",void 0),K3=y([se("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],K3);const Tat=K3;var Af,No;function vw(t){return t&&t.declaredClass==="esri.renderers.visualVariables.SizeVariable"}function MM(t){return t!=null&&!isNaN(t)&&isFinite(t)}function mbe(t){return t.valueExpression?Af.Expression:t.field&&typeof t.field=="string"?Af.Field:Af.Unknown}function Pat(t,e){const i=e||mbe(t),s=t.valueUnit||"unknown";return i===Af.Unknown?No.Constant:t.stops?No.Stops:t.minSize!=null&&t.maxSize!=null&&t.minDataValue!=null&&t.maxDataValue!=null?No.ClampedLinear:s==="unknown"?t.minSize!=null&&t.minDataValue!=null?t.minSize&&t.minDataValue?No.Proportional:No.Additive:No.Identity:No.RealWorldSize}(function(t){t.Unknown="unknown",t.Expression="expression",t.Field="field"})(Af||(Af={})),function(t){t.Unknown="unknown",t.Stops="stops",t.ClampedLinear="clamped-linear",t.Proportional="proportional",t.Additive="additive",t.Constant="constant",t.Identity="identity",t.RealWorldSize="real-world-size"}(No||(No={}));const pbe=()=>ht.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),dk=t=>pbe().warn(`The visualVariable should be an instance of esri.renderers.visualVariables.${t}`),mk=()=>pbe().error("Use of arcade expressions requires an arcade context"),Coe=new Kr,Q3=Math.PI,fbe=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function gbe(t,e,i){const s="visualVariables"in t&&t.visualVariables?t.visualVariables.find(f=>f.type==="color"):t;if(!s)return;if(s.declaredClass!=="esri.renderers.visualVariables.ColorVariable")return void dk("ColorVariable");const n=typeof e=="number",r=n?null:e,o=r==null?void 0:r.attributes;let a=n?e:null;const l=s.field,{ipData:u,hasExpression:c}=s.cache;let h=s.cache.compiledFunc;if(!l&&!c){const f=s.stops;return f&&f[0]&&f[0].color}if(typeof a!="number")if(c){if((i==null?void 0:i.arcade)==null)return void mk();const f={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},_=i.arcade.arcadeUtils,v=_.getViewInfo(f),x=_.createExecContext(r,v,i.timeZone);if(!h){const w=_.createSyntaxTree(s.valueExpression);h=_.createFunction(w),s.cache.compiledFunc=h}a=_.executeFunction(h,x)}else o&&(a=o[l]);const d=s.normalizationField,m=o!=null&&d!=null?parseFloat(o[d]):void 0;if(a!=null&&(!d||n||!isNaN(m)&&m!==0)){isNaN(m)||n||(a/=m);const f=iX(a,u);if(f){const _=f[0],v=f[1],x=_===v?s.stops[_].color:Gt.blendColors(s.stops[_].color,s.stops[v].color,f[2],i!=null?i.color:void 0);return new Gt(x)}}}function _be(t,e,i){const s="visualVariables"in t&&t.visualVariables?t.visualVariables.find(f=>f.type==="opacity"):t;if(!s)return;if(s.declaredClass!=="esri.renderers.visualVariables.OpacityVariable")return void dk("OpacityVariable");const n=typeof e=="number",r=n?null:e,o=r==null?void 0:r.attributes;let a=n?e:null;const l=s.field,{ipData:u,hasExpression:c}=s.cache;let h=s.cache.compiledFunc;if(!l&&!c){const f=s.stops;return f&&f[0]&&f[0].opacity}if(typeof a!="number")if(c){if((i==null?void 0:i.arcade)==null)return void mk();const f={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},_=i.arcade.arcadeUtils,v=_.getViewInfo(f),x=_.createExecContext(r,v,i.timeZone);if(!h){const w=_.createSyntaxTree(s.valueExpression);h=_.createFunction(w),s.cache.compiledFunc=h}a=_.executeFunction(h,x)}else o&&(a=o[l]);const d=s.normalizationField,m=o!=null&&d!=null?parseFloat(o[d]):void 0;if(a!=null&&(!d||n||!isNaN(m)&&m!==0)){isNaN(m)||n||(a/=m);const f=iX(a,u);if(f){const _=f[0],v=f[1];if(_===v)return s.stops[_].opacity;{const x=s.stops[_].opacity;return x+(s.stops[v].opacity-x)*f[2]}}}}function ybe(t,e,i){const s="visualVariables"in t&&t.visualVariables?t.visualVariables.find(m=>m.type==="rotation"):t;if(!s)return;if(s.declaredClass!=="esri.renderers.visualVariables.RotationVariable")return void dk("RotationVariable");const n=s.axis||"heading",r=n==="heading"&&s.rotationType==="arithmetic"?90:0,o=n==="heading"&&s.rotationType==="arithmetic"?-1:1,a=typeof e=="number"?null:e,l=a==null?void 0:a.attributes,u=s.field,{hasExpression:c}=s.cache;let h=s.cache.compiledFunc,d=0;if(!u&&!c)return d;if(c){if((i==null?void 0:i.arcade)==null)return void mk();const m={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},f=i.arcade.arcadeUtils,_=f.getViewInfo(m),v=f.createExecContext(a,_,i.timeZone);if(!h){const x=f.createSyntaxTree(s.valueExpression);h=f.createFunction(x),s.cache.compiledFunc=h}d=f.executeFunction(h,v)}else l&&(d=l[u]||0);return d=typeof d!="number"||isNaN(d)?null:r+o*d,d}function Mat(t,e,i){const s=typeof e=="number",n=s?null:e,r=n==null?void 0:n.attributes;let o=s?e:null;const{isScaleDriven:a}=t.cache;let l=t.cache.compiledFunc;if(a){const c=i!=null?i.scale:void 0,h=i!=null?i.view:void 0;o=c==null||h==="3d"?Aat(t):c}else if(!s)switch(t.inputValueType){case Af.Expression:{if((i==null?void 0:i.arcade)==null)return void mk();const c={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},h=i.arcade.arcadeUtils,d=h.getViewInfo(c),m=h.createExecContext(n,d,i.timeZone);if(!l){const f=h.createSyntaxTree(t.valueExpression);l=h.createFunction(f),t.cache.compiledFunc=l}o=h.executeFunction(l,m);break}case Af.Field:r&&(o=r[t.field]);break;case Af.Unknown:o=null}if(!MM(o))return null;if(s||!t.normalizationField)return o;const u=r?parseFloat(r[t.normalizationField]):null;return MM(u)&&u!==0?o/u:null}function Aat(t){let e=null,i=null;const s=t.stops;return s?(e=s[0].value,i=s[s.length-1].value):(e=t.minDataValue||0,i=t.maxDataValue||0),(e+i)/2}function pk(t,e,i){const s="visualVariables"in t&&t.visualVariables?t.visualVariables.find(r=>r.type==="size"):t;if(!s)return;if(s.declaredClass!=="esri.renderers.visualVariables.SizeVariable")return void dk("SizeVariable");const n=xbe(Mat(s,e,i),s,e,i,s.cache.ipData);return n==null||isNaN(n)?0:n}function wu(t,e,i){return t==null?null:vw(t)?pk(t,e,i):MM(t)?t:null}function vbe(t,e,i){return MM(i)&&t>i?i:MM(e)&&t<e?e:t}function Iat(t,e,i,s){return t+((wu(e.minSize,i,s)||e.minDataValue)??0)}function Dat(t,e,i){const s=t.stops;let n=(s==null?void 0:s.length)&&s[0].size;return n==null&&(n=t.minSize),wu(n,e,i)}function Nat(t,e,i,s){const n=(t-e.minDataValue)/(e.maxDataValue-e.minDataValue),r=wu(e.minSize,i,s),o=wu(e.maxSize,i,s),a=s!=null?s.shape:void 0;if(t<=e.minDataValue)return r;if(t>=e.maxDataValue)return o;if(r==null||o==null)return null;if(e.scaleBy==="area"&&a){const l=a==="circle",u=l?Q3*(r/2)**2:r*r,c=u+n*((l?Q3*(o/2)**2:o*o)-u);return l?2*Math.sqrt(c/Q3):Math.sqrt(c)}return r+n*(o-r)}function Rat(t,e,i,s){const n=s!=null?s.shape:void 0,r=t/e.minDataValue,o=wu(e.minSize,i,s),a=wu(e.maxSize,i,s);let l=null;return l=n==="circle"?2*Math.sqrt(r*(o/2)**2):n==="square"||n==="diamond"||n==="image"?Math.sqrt(r*o**2):r*o,vbe(l,o,a)}function Oat(t,e,i,s,n){var l,u,c;const[r,o,a]=iX(t,n);if(r===o)return wu((l=e.stops)==null?void 0:l[r].size,i,s);{const h=wu((u=e.stops)==null?void 0:u[r].size,i,s);return h+(wu((c=e.stops)==null?void 0:c[o].size,i,s)-h)*a}}function Lat(t,e,i,s){const n=((s==null?void 0:s.resolution)??1)*O4[e.valueUnit],r=wu(e.minSize,i,s),o=wu(e.maxSize,i,s),{valueRepresentation:a}=e;let l=null;return l=a==="area"?2*Math.sqrt(t/Q3)/n:a==="radius"||a==="distance"?2*t/n:t/n,vbe(l,r,o)}function xbe(t,e,i,s,n){switch(e.transformationType){case No.Additive:return Iat(t,e,i,s);case No.Constant:return Dat(e,i,s);case No.ClampedLinear:return Nat(t,e,i,s);case No.Proportional:return Rat(t,e,i,s);case No.Stops:return Oat(t,e,i,s,n);case No.RealWorldSize:return Lat(t,e,i,s);case No.Identity:return t;case No.Unknown:return null}}function Fat(t,e,i){const{isScaleDriven:s}=t.cache;if(!(s&&i==="3d"||e))return null;const n={scale:e,view:i};let r=wu(t.minSize,Coe,n),o=wu(t.maxSize,Coe,n);if(r!=null||o!=null){if(r>o){const a=o;o=r,r=a}return{minSize:r,maxSize:o}}}function kat(t,e,i){if(!t.visualVariables)return;const s=[],n=[],r=[],o=[],a=[];for(const l of t.visualVariables)switch(l.type){case"color":n.push(l);break;case"opacity":r.push(l);break;case"rotation":a.push(l);break;case"size":o.push(l)}return n.forEach(l=>{const u=gbe(l,e,i);s.push({variable:l,value:u})}),r.forEach(l=>{const u=_be(l,e,i);s.push({variable:l,value:u})}),a.forEach(l=>{const u=ybe(l,e,i);s.push({variable:l,value:u})}),o.forEach(l=>{const u=pk(l,e,i);s.push({variable:l,value:u})}),s.filter(l=>l.value!=null)}function iX(t,e){if(!e)return;let i=0,s=e.length-1;return e.some((n,r)=>t<n?(s=r,!0):(i=r,!1)),[i,s,(t-e[i])/(e[s]-e[i])]}function $at(t,e,i){const s=["proportional","proportional","proportional"];for(const n of t){const r=n.useSymbolValue?"symbol-value":pk(n,e,i);switch(n.axis){case"width":s[0]=r;break;case"depth":s[1]=r;break;case"height":s[2]=r;break;case"width-and-depth":s[0]=r,s[1]=r;break;case"all":case void 0:case null:s[0]=r,s[1]=r,s[2]=r;break;default:n.axis}}return s}const tSt=Object.freeze(Object.defineProperty({__proto__:null,getAllSizes:$at,getColor:gbe,getOpacity:_be,getRotationAngle:ybe,getSize:pk,getSizeForValue:xbe,getSizeFromNumberOrVariable:wu,getSizeRangeAtScale:Fat,getVisualVariableValues:kat,viewScaleRE:fbe},Symbol.toStringTag,{value:"Module"}));var w9;const lR=new gs({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),S9=new gs({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers"});function Toe(t){if(t!=null)return typeof t=="string"||typeof t=="number"?Cat(t):t.type==="size"?vw(t)?t:(delete(t={...t}).type,new Ws(t)):void 0}function Poe(t,e,i){if(typeof t!="object")return t;const s=new Ws;return s.read(t,i),s}let Ws=w9=class extends uE{constructor(t){super(t),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:this.valueExpression!=null&&fbe.test(this.valueExpression)}}set index(t){vw(this.maxSize)&&(this.maxSize.index=`visualVariables[${t}].maxSize`),vw(this.minSize)&&(this.minSize.index=`visualVariables[${t}].minSize`),this._set("index",t)}get inputValueType(){return mbe(this)}set maxDataValue(t){t&&this.stops&&(ht.getLogger(this).warn("cannot set maxDataValue when stops is not null."),t=null),this._set("maxDataValue",t)}set maxSize(t){t&&this.stops&&(ht.getLogger(this).warn("cannot set maxSize when stops is not null."),t=null),this._set("maxSize",t)}castMaxSize(t){return Toe(t)}readMaxSize(t,e,i){return Poe(t,e,i)}set minDataValue(t){t&&this.stops&&(ht.getLogger(this).warn("cannot set minDataValue when stops is not null."),t=null),this._set("minDataValue",t)}set minSize(t){t&&this.stops&&(ht.getLogger(this).warn("cannot set minSize when stops is not null."),t=null),this._set("minSize",t)}castMinSize(t){return Toe(t)}readMinSize(t,e,i){return Poe(t,e,i)}get arcadeRequired(){return!!this.valueExpression||this.minSize!=null&&typeof this.minSize=="object"&&this.minSize.arcadeRequired||this.maxSize!=null&&typeof this.maxSize=="object"&&this.maxSize.arcadeRequired}set stops(t){this.minDataValue==null&&this.maxDataValue==null&&this.minSize==null&&this.maxSize==null?t&&Array.isArray(t)&&(t=t.filter(e=>!!e)).sort((e,i)=>e.value-i.value):t&&(ht.getLogger(this).warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),t=null),this._set("stops",t)}get transformationType(){return Pat(this,this.inputValueType)}readValueExpression(t,e){return t||e.expression&&"$view.scale"}writeValueExpressionWebScene(t,e,i,s){if(t==="$view.scale"){if(s!=null&&s.messages){const n=this.index,r=typeof n=="string"?n:`visualVariables[${n}]`;s.messages.push(new Se("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:r+".valueExpression",context:s}))}}else e[i]=t}readValueUnit(t){return t?S9.read(t):null}clone(){var t,e;return new w9({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:vw(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:vw(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:(t=this.stops)==null?void 0:t.map(i=>i.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:(e=this.legendOptions)==null?void 0:e.clone()})}flipSizes(){if(this.transformationType===No.ClampedLinear){const{minSize:t,maxSize:e}=this;return this.minSize=e,this.maxSize=t,this}if(this.transformationType===No.Stops){const t=this.stops;if(!t)return this;const e=t.map(s=>s.size).reverse(),i=t.length;for(let s=0;s<i;s++)t[s].size=e[s];return this}return this}getAttributeHash(){return`${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){var t;return(t=this.stops)==null?void 0:t.map(e=>e.value||0)}};y([S({readOnly:!0})],Ws.prototype,"cache",null),y([S({type:lR.apiValues,json:{type:lR.jsonValues,origins:{"web-map":{read:!1}},read:lR.read,write:lR.write}})],Ws.prototype,"axis",void 0),y([S()],Ws.prototype,"index",null),y([S({type:String,readOnly:!0})],Ws.prototype,"inputValueType",null),y([S({type:Tat,json:{write:!0}})],Ws.prototype,"legendOptions",void 0),y([S({type:Number,value:null,json:{write:!0}})],Ws.prototype,"maxDataValue",null),y([S({type:Number,value:null,json:{write:!0}})],Ws.prototype,"maxSize",null),y([Ls("maxSize")],Ws.prototype,"castMaxSize",null),y([mt("maxSize")],Ws.prototype,"readMaxSize",null),y([S({type:Number,value:null,json:{write:!0}})],Ws.prototype,"minDataValue",null),y([S({type:Number,value:null,json:{write:!0}})],Ws.prototype,"minSize",null),y([Ls("minSize")],Ws.prototype,"castMinSize",null),y([mt("minSize")],Ws.prototype,"readMinSize",null),y([S({type:String,json:{write:!0}})],Ws.prototype,"normalizationField",void 0),y([S({readOnly:!0})],Ws.prototype,"arcadeRequired",null),y([S({type:String})],Ws.prototype,"scaleBy",void 0),y([S({type:[Z3],value:null,json:{write:!0}})],Ws.prototype,"stops",null),y([S({type:["outline"],json:{write:!0}})],Ws.prototype,"target",void 0),y([S({type:String,readOnly:!0})],Ws.prototype,"transformationType",null),y([S({type:["size"],json:{type:["sizeInfo"]}})],Ws.prototype,"type",void 0),y([S({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],Ws.prototype,"useSymbolValue",void 0),y([S({type:String,json:{write:!0}})],Ws.prototype,"valueExpression",void 0),y([mt("valueExpression",["valueExpression","expression"])],Ws.prototype,"readValueExpression",null),y([yt("web-scene","valueExpression")],Ws.prototype,"writeValueExpressionWebScene",null),y([S({type:["radius","diameter","area","width","distance"],json:{write:!0}})],Ws.prototype,"valueRepresentation",void 0),y([S({type:S9.apiValues,json:{write:S9.write,origins:{"web-map":{read:!1},"web-scene":{write:!0},"portal-item":{write:!0}}}})],Ws.prototype,"valueUnit",void 0),y([mt("valueUnit")],Ws.prototype,"readValueUnit",null),Ws=w9=y([se("esri.renderers.visualVariables.SizeVariable")],Ws);const fk=Ws,Uat={color:hbe,size:fk,opacity:tX,rotation:dbe},Vat=new gs({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),zat=/^\[([^\]]+)\]$/i;let J3=class extends ei{constructor(){super(...arguments),this.colorVariables=null,this.opacityVariables=null,this.rotationVariables=null,this.sizeVariables=null}set visualVariables(e){if(this._resetVariables(),e=e==null?void 0:e.filter(i=>!!i),e==null?void 0:e.length){for(const i of e)switch(i.type){case"color":this.colorVariables.push(i);break;case"opacity":this.opacityVariables.push(i);break;case"rotation":this.rotationVariables.push(i);break;case"size":this.sizeVariables.push(i)}this.sizeVariables.length&&this.sizeVariables.some(i=>!!i.target)&&e.sort((i,s)=>{let n=null;return n=i.target===s.target?0:i.target?1:-1,n});for(let i=0;i<e.length;i++)e[i].index=i;this._set("visualVariables",e)}else this._set("visualVariables",e)}readVariables(e,i,s){const{rotationExpression:n,rotationType:r}=i,o=n==null?void 0:n.match(zat),a=o==null?void 0:o[1];if(a&&(e||(e=[]),e.push({type:"rotationInfo",rotationType:r,field:a})),e)return e.map(l=>{const u=Vat.read(l.type),c=Uat[u];c||(ht.getLogger(this).warn(`Unknown variable type: ${u}`),s!=null&&s.messages&&s.messages.push(new ih("visual-variable:unsupported",`visualVariable of type '${u}' is not supported`,{definition:l,context:s})));const h=new c;return h.read(l,s),h})}writeVariables(e,i){const s=[];for(const n of e){const r=n.toJSON(i);r&&s.push(r)}return s}_resetVariables(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[]}};y([S()],J3.prototype,"visualVariables",null),J3=y([se("esri.renderers.visualVariables.VisualVariableFactory")],J3);const Gat=J3,Bat={base:uE,key:"type",typeMap:{opacity:tX,color:hbe,rotation:dbe,size:fk}},cE=t=>{let e=class extends t{constructor(){super(...arguments),this._vvFactory=new Gat}set visualVariables(i){this._vvFactory.visualVariables=i,this._set("visualVariables",this._vvFactory.visualVariables)}readVisualVariables(i,s,n){return this._vvFactory.readVariables(i,s,n)}writeVisualVariables(i,s,n,r){s[n]=this._vvFactory.writeVariables(i,r)}get arcadeRequiredForVisualVariables(){var i;return((i=this.visualVariables)==null?void 0:i.some(({arcadeRequired:s})=>s))??!1}hasVisualVariables(i,s){return i?this.getVisualVariablesForType(i,s).length>0:this.getVisualVariablesForType("size",s).length>0||this.getVisualVariablesForType("color",s).length>0||this.getVisualVariablesForType("opacity",s).length>0||this.getVisualVariablesForType("rotation",s).length>0}getVisualVariablesForType(i,s){var n;return((n=this.visualVariables)==null?void 0:n.filter(r=>r.type===i&&(typeof s=="string"?r.target===s:s!==!1||!r.target)))??[]}async collectVVRequiredFields(i,s){let n=[];this.visualVariables&&(n=n.concat(this.visualVariables));for(const r of n)r&&(r.field&&Ll(i,s,r.field),r.normalizationField&&Ll(i,s,r.normalizationField),r.valueExpression&&(qat(r.valueExpression,i,s)||await al(i,s,r.valueExpression)))}};return y([S({types:[Bat],value:null,json:{write:!0}})],e.prototype,"visualVariables",null),y([mt("visualVariables",["visualVariables","rotationType","rotationExpression"])],e.prototype,"readVisualVariables",null),y([yt("visualVariables")],e.prototype,"writeVisualVariables",null),e=y([se("esri.renderers.mixins.VisualVariablesMixin")],e),e};function qat(t,e,i){const s=DIe(t);return s!=null&&(Ll(e,i,s),!0)}const sX=[252,146,31,255],Hat=[153,153,153,255],jat={type:"esriSMS",style:"esriSMSCircle",size:6,color:sX,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},Yat={type:"esriSLS",style:"esriSLSSolid",width:.75,color:sX},Xat={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},Wat={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},Zat={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},Kat={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},Qat={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null},nF=_u.fromJSON(jat),nX=Tu.fromJSON(Yat),bbe=bd.fromJSON(Xat),Jat=WS.fromJSON(Wat);function sSt(t){if(t==null)return null;switch(t.type){case"mesh":return null;case"point":case"multipoint":return nF;case"polyline":return nX;case"polygon":case"extent":return bbe}return null}const nSt=_u.fromJSON(Zat),rSt=Tu.fromJSON(Kat),oSt=bd.fromJSON(Qat),elt=vf.fromSimpleMarkerSymbol(nF),tlt=G1.fromSimpleLineSymbol(nX),ilt=ky.fromSimpleFillSymbol(bbe),slt=new rA({symbolLayers:new Nt([new z1({material:{color:sX},edges:new ame({size:rh(1),color:new Gt(Hat)})})])}),nlt=new G1({symbolLayers:new Nt([new YS({material:{color:new Gt([0,0,0])},size:rh(1)})])}),rlt=new ky({symbolLayers:new Nt([new z1({outline:{color:new Gt([0,0,0]),size:rh(1)}})])});function aSt(t){if(t==null)return null;switch(t.type){case"mesh":return slt;case"point":case"multipoint":return elt;case"polyline":return tlt;case"polygon":case"extent":return ilt}return null}const Moe="#useCIMFallbackSymbology()",pb={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function olt(t,e=pb){var l,u,c,h;if(!t)return{symbol:null};const{retainId:i=pb.retainId,ignoreDrivers:s=pb.ignoreDrivers,hasLabelingContext:n=pb.hasLabelingContext,retainCIM:r=pb.retainCIM,cimFallbackEnabled:o=pb.cimFallbackEnabled}=e;let a=null;if(Gme(t)||t instanceof vy)a=t.clone();else if(t.type==="cim"){const d=(u=(l=t.data)==null?void 0:l.symbol)==null?void 0:u.type;switch(d){case"CIMPointSymbol":a=r?t.clone():vf.fromCIMSymbol(t);break;case"CIMLineSymbol":o&&(a=nlt.clone(),(c=e==null?void 0:e.logWarning)==null||c.call(e,Moe,"Unsupported CIM line symbology converted to fallback 3D line symbology"));break;case"CIMPolygonSymbol":o&&(a=rlt.clone(),(h=e==null?void 0:e.logWarning)==null||h.call(e,Moe,"Unsupported CIM polygon symbology converted to fallback 3D polygon symbology"))}if(!a)return{error:new Se("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${d||"unknown"}' is unsupported in 3D`,{symbol:t})}}else if(t instanceof Tu)a=G1.fromSimpleLineSymbol(t);else if(t instanceof _u)a=vf.fromSimpleMarkerSymbol(t);else if(t instanceof oA)a=vf.fromPictureMarkerSymbol(t);else if(t instanceof bd)a=e.geometryType&&e.geometryType==="mesh"?rA.fromSimpleFillSymbol(t):ky.fromSimpleFillSymbol(t);else{if(!(t instanceof WS))return{error:new Se("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${t.type||t.declaredClass}' is unsupported in 3D`,{symbol:t})};a=n?YF.fromTextSymbol(t):vf.fromTextSymbol(t)}return i&&a&&a.type!=="cim"&&(a.id=t.id),!s||a.type==="cim"||a instanceof vy||a.symbolLayers.forEach(d=>d.ignoreDrivers=!0),{symbol:a}}function rF(t,e,i,s){const n=wbe(t,{},{context:s,isLabelSymbol:!1});n!=null&&(e[i]=n)}function Aoe(t,e,i,s){const n=wbe(t,{},{context:s,isLabelSymbol:!0});n!=null&&(e[i]=n)}function Ioe(t){return Gme(t)||t instanceof vy}function alt(t){return(t==null?void 0:t.type)==="polygon-3d"||(t==null?void 0:t.type)==="line-3d"}function wbe(t,e,i){var a;if(t==null)return null;const{context:s,isLabelSymbol:n}=i,r=s==null?void 0:s.origin,o=s==null?void 0:s.messages;if(r==="web-scene"&&!Ioe(t)){const l=olt(t,{retainCIM:!0,hasLabelingContext:n});return l.symbol!=null?l.symbol.write(e,s):(o==null||o.push(new Se("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:t,context:s,error:l.error})),null)}return B8(s==null?void 0:s.layer)&&alt(t)?(o==null||o.push(new Se("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported on layers of type '${(a=s==null?void 0:s.layer)==null?void 0:a.declaredClass}'.`,{symbol:t,context:s})),null):(r==="web-map"||r==="portal-item"&&!B8(s==null?void 0:s.layer))&&Ioe(t)?(o==null||o.push(new Se("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`,{symbol:t,context:s})),null):t.write(e,s)}function lSt(t,e){return gRe(t,null,e)}const gk={types:Bme,json:{write:{writer:rF},origins:{"web-scene":{types:HQ,write:{writer:rF},read:{reader:LS({types:HQ})}}}}},rX=rH({json:{origins:{"web-scene":{write:{isRequired:!0}}}}},gk),oX={types:{base:Oa,key:"type",typeMap:{"simple-fill":X_.typeMap["simple-fill"],"picture-fill":X_.typeMap["picture-fill"],"polygon-3d":X_.typeMap["polygon-3d"],cim:X_.typeMap.cim}},json:{write:{writer:rF},origins:{"web-scene":{type:ky,write:{writer:rF}}}}},eO={cast:t=>t==null||typeof t=="string"||typeof t=="number"?t:`${t}`,json:{type:String,write:{writer:(t,e)=>{e.value=t==null?void 0:t.toString()}}}};var E9;let xv=E9=class extends cE(Kf){constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.type="simple"}async collectRequiredFields(t,e){await Promise.all([this.collectSymbolFields(t,e),this.collectVVRequiredFields(t,e)])}async collectSymbolFields(t,e){await Promise.all(this.symbols.map(i=>i.collectRequiredFields(t,e)))}getSymbol(t,e){return this.symbol}async getSymbolAsync(t,e){return this.symbol}get symbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){var t;return((t=this.visualVariables)==null?void 0:t.reduce((e,i)=>e+i.getAttributeHash(),""))??""}getMeshHash(){return this.symbols.reduce((t,e)=>t+JSON.stringify(e),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new E9({description:this.description,label:this.label,symbol:be(this.symbol),visualVariables:be(this.visualVariables),authoringInfo:be(this.authoringInfo)})}};y([S({type:String,json:{write:!0}})],xv.prototype,"description",void 0),y([S({type:String,json:{write:!0}})],xv.prototype,"label",void 0),y([S(rX)],xv.prototype,"symbol",void 0),y([ai({simple:"simple"})],xv.prototype,"type",void 0),xv=E9=y([se("esri.renderers.SimpleRenderer")],xv);const Om=xv,llt=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function C9(t){return t instanceof ei}function Doe(t){return t instanceof Nt?Object.keys(t.items):C9(t)?Su(t).keys():t?Object.keys(t):[]}function uR(t,e){return t instanceof Nt?t.items[e]:t[e]}function ult(t,e){return!(!Array.isArray(t)||!Array.isArray(e))&&t.length!==e.length}function mP(t){return t?t.declaredClass:null}function Sbe(t,e){var h;const i=t.diff;if(i&&typeof i=="function")return i(t,e);const s=Doe(t),n=Doe(e);if(s.length===0&&n.length===0)return;if(!s.length||!n.length||ult(t,e))return{type:"complete",oldValue:t,newValue:e};const r=n.filter(d=>!s.includes(d)),o=s.filter(d=>!n.includes(d)),a=s.filter(d=>n.includes(d)&&uR(t,d)!==uR(e,d)).concat(r,o).sort(),l=mP(t);if(l&&llt.has(l)&&a.length)return{type:"complete",oldValue:t,newValue:e};let u;const c=C9(t)&&C9(e);for(const d of a){const m=uR(t,d),f=uR(e,d);let _;if((c||typeof m!="function"&&typeof f!="function")&&m!==f&&(m!=null||f!=null)){if(i&&i[d]&&typeof i[d]=="function")_=(h=i[d])==null?void 0:h.call(i,m,f);else if(m instanceof Date&&f instanceof Date){if(m.getTime()===f.getTime())continue;_={type:"complete",oldValue:m,newValue:f}}else _=typeof m=="object"&&typeof f=="object"&&mP(m)===mP(f)?Sbe(m,f):{type:"complete",oldValue:m,newValue:f};_!=null&&(u!=null?u.diff[d]=_:u={type:"partial",diff:{[d]:_}})}}return u}function uSt(t,e){return clt(t,e)}function clt(t,e){if(t==null)return!1;const i=e.split(".");let s=t;for(const n of i){if(s.type==="complete")return!0;if(s.type!=="partial")return!1;{const r=s.diff[n];if(!r)return!1;s=r}}return!0}function cSt(t,e){if(!t)return!1;if(t.type==="partial"){const i=Object.keys(t.diff);return i.length===1&&i[0]===e}return!1}function hlt(t,e){if(typeof t!="function"&&typeof e!="function"&&(t!=null||e!=null))return t==null||e==null||typeof t=="object"&&typeof e=="object"&&mP(t)!==mP(e)?{type:"complete",oldValue:t,newValue:e}:Sbe(t,e)}function cR(t){if(t==null)return!0;switch(t.type){case"complete":return!1;case"collection":{const e=t;for(const i of e.added)if(!cR(i))return!1;for(const i of e.removed)if(!cR(i))return!1;for(const i of e.changed)if(!cR(i))return!1;return!0}case"partial":for(const e in t.diff)if(!cR(t.diff[e]))return!1;return!0}}var T9;const dlt=ca()({ascendingValues:"ascending-values",descendingValues:"descending-values"});let AT=T9=class extends bs.ClonableMixin(it){static from(t){return OS(T9,t)}constructor(t){super(t),this.title=null,this.order=null}};y([S({type:String,json:{write:!0}})],AT.prototype,"title",void 0),y([ai(dlt)],AT.prototype,"order",void 0),AT=T9=y([se("esri.renderers.support.RendererLegendOptions")],AT);const aX=AT;let Qb=class extends bs.ClonableMixin(it){constructor(e){super(e),this.value=null,this.value2=null,this.value3=null}};y([S(eO)],Qb.prototype,"value",void 0),y([S(eO)],Qb.prototype,"value2",void 0),y([S(eO)],Qb.prototype,"value3",void 0),Qb=y([se("esri.renderers.support.UniqueValue")],Qb);const qw=Qb;let T_=class extends bs.ClonableMixin(it){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.values=null}castValues(e){if(e==null)return null;const i=typeof(e=Array.isArray(e)?e:[e])[0];return i==="string"||i==="number"?e.map(s=>new qw({value:s})):i==="object"?e[0]instanceof qw?e:e.map(s=>new qw(s)):null}};y([S({type:String,json:{write:!0}})],T_.prototype,"description",void 0),y([S({type:String,json:{write:!0}})],T_.prototype,"label",void 0),y([S(gk)],T_.prototype,"symbol",void 0),y([S({type:[qw],json:{type:[[String]],read:{reader:t=>t?t.map(e=>new qw({value:e[0],value2:e[1],value3:e[2]})):null},write:{writer:(t,e)=>{const i=[];for(const s of t){const n=[s.value,s.value2,s.value3].filter(Df).map(r=>r.toString());i.push(n)}e.values=i}}}})],T_.prototype,"values",void 0),y([Ls("values")],T_.prototype,"castValues",null),T_=y([se("esri.renderers.support.UniqueValueClass")],T_);const Ebe=T_;let IT=class extends bs.ClonableMixin(it){constructor(e){super(e),this.heading=null,this.classes=null}};y([S({type:String,json:{write:!0}})],IT.prototype,"heading",void 0),y([S({type:[Ebe],json:{write:{isRequired:!0}}})],IT.prototype,"classes",void 0),IT=y([se("esri.renderers.support.UniqueValueGroup")],IT);const P9=IT;var M9;let bv=M9=class extends it{constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.value=null}clone(){return new M9({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){var e;const t=JSON.stringify((e=this.symbol)==null?void 0:e.toJSON());return`${this.value}.${t}`}};y([S({type:String,json:{write:!0}})],bv.prototype,"description",void 0),y([S({type:String,json:{write:!0}})],bv.prototype,"label",void 0),y([S(rX)],bv.prototype,"symbol",void 0),y([S(eO)],bv.prototype,"value",void 0),bv=M9=y([se("esri.renderers.support.UniqueValueInfo")],bv);const pP=bv,Noe=new Map;async function mlt(t,e){try{return{data:(await _lt(t,e)).data,baseUrl:YCe(t),styleUrl:t}}catch(i){return ym(i),null}}function plt(t,e,i){var l;const s=e.portal!=null?e.portal:Cu.getDefault();let n;const r=`${s.url} - ${(l=s.user)==null?void 0:l.username} - ${t}`,o=Noe.get(r);if(o)return o;const a=flt(t,s,i).then(u=>(n=u,u.fetchData())).then(u=>({data:u,baseUrl:n.itemUrl??"",styleName:t}));return Noe.set(r,a),a}function flt(t,e,i){return e.load(i).then(()=>{const s=new sd({disableExtraQuery:!0,query:`owner:${Roe} AND type:${Ooe} AND typekeywords:"${t}"`});return e.queryItems(s,i)}).then(({results:s})=>{var o;let n=null;const r=t.toLowerCase();if(s&&Array.isArray(s)){for(const a of s)if(((o=a.typeKeywords)==null?void 0:o.some(u=>u.toLowerCase()===r))&&a.type===Ooe&&a.owner===Roe){n=a;break}}if(!n)throw new Se("symbolstyleutils:style-not-found",`The style '${t}' could not be found`,{styleName:t});return n.load(i)})}function glt(t,e,i){return(t==null?void 0:t.styleUrl)!=null?mlt(t.styleUrl,i):(t==null?void 0:t.styleName)!=null?plt(t.styleName,e,i):Promise.reject(new Se("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function pSt(t){return t===null||t.type==="CIMSymbolReference"?t:{type:"CIMSymbolReference",symbol:t}}function fSt(t,e){for(const i of e)switch(i){case"cim":if(t.cimRef)return{format:i,url:encodeURI(t.cimRef)};break;case"web-gltf-basisu":{const s=WV(t,"gltf_basisu");if(s)return{format:i,url:s};break}case"web-gltf":{const s=WV(t,"gltf");if(s)return{format:i,url:s};break}case"web":{const s=WV(t,"gltf");if(s)return{format:"web-gltf",url:s};if(t.webRef)return{format:i,url:encodeURI(t.webRef)};break}}}function WV(t,e){var i,s;if(!ke("enable-feature:force-wosr"))return(s=(i=t.formatInfos)==null?void 0:i.find(n=>n.type===e))==null?void 0:s.href}function _lt(t,e){const i={responseType:"json",query:{f:"json"},...e};return $n(hd(t),i)}const Roe="esri_en",Ooe="Style",gSt="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";var DT;const Cbe="esri.renderers.UniqueValueRenderer",Jg=()=>ht.getLogger(Cbe),Loe="uvInfos-watcher",Foe="uvGroups-watcher",ylt=",",vlt=xo(pP);function xlt(t){const{field1:e,field2:i,field3:s,fieldDelimiter:n,uniqueValueInfos:r,valueExpression:o}=t,a=!(!e||!i);return[{classes:(r??[]).map(l=>{var x;const{symbol:u,label:c,value:h,description:d}=l,[m,f,_]=a?((x=h==null?void 0:h.toString())==null?void 0:x.split(n||""))||[]:[h],v=[];return(e||o)&&v.push(m),i&&v.push(f),s&&v.push(_),{symbol:u,label:c,values:[v],description:d}})}]}function fb(t){return t!=null&&t!==""&&(typeof t!="string"||t.trim()!==""&&t.toLowerCase()!=="<null>")||(t=null),t+""}let Zn=DT=class extends cE(Kf){constructor(t){super(t),this._valueInfoMap={},this._isDefaultSymbolDerived=!1,this._isInfosSource=null,this.type="unique-value",this.backgroundFillSymbol=null,this.orderByClassesEnabled=!1,this.valueExpressionTitle=null,this.legendOptions=null,this.defaultLabel=null,this.portal=null,this.styleOrigin=null,this.diff={uniqueValueInfos(e,i){if(!e&&!i)return;if(!e||!i)return{type:"complete",oldValue:e,newValue:i};let s=!1;const n={type:"collection",added:[],removed:[],changed:[],unchanged:[]};for(let r=0;r<i.length;r++){const o=e.find(a=>a.value===i[r].value);o?hlt(o,i[r])?(n.changed.push({type:"complete",oldValue:o,newValue:i[r]}),s=!0):n.unchanged.push({oldValue:o,newValue:i[r]}):(n.added.push(i[r]),s=!0)}for(let r=0;r<e.length;r++)i.find(o=>o.value===e[r].value)||(n.removed.push(e[r]),s=!0);return s?n:void 0}},this._set("uniqueValueInfos",[]),this._set("uniqueValueGroups",[])}get _cache(){return{compiledFunc:null}}set field(t){this._set("field",t),this._updateFieldDelimiter(),this._updateUniqueValues()}castField(t){return t==null||typeof t=="function"?t:OM(t)}writeField(t,e,i,s){typeof t=="string"?e[i]=t:s!=null&&s.messages?s.messages.push(new Se("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):Jg().error(".field: cannot write field to JSON since it's not a string value")}set field2(t){this._set("field2",t),this._updateFieldDelimiter(),this._updateUniqueValues()}set field3(t){this._set("field3",t),this._updateUniqueValues()}set valueExpression(t){this._set("valueExpression",t),this._updateUniqueValues()}set defaultSymbol(t){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",t)}set fieldDelimiter(t){this._set("fieldDelimiter",t),this._updateUniqueValues()}readPortal(t,e,i){return i.portal||Cu.getDefault()}readStyleOrigin(t,e,i){if(e.styleName)return Object.freeze({styleName:e.styleName});if(e.styleUrl){const s=US(e.styleUrl,i);return Object.freeze({styleUrl:s})}}writeStyleOrigin(t,e,i,s){t.styleName?e.styleName=t.styleName:t.styleUrl&&(e.styleUrl=zM(t.styleUrl,s))}set uniqueValueGroups(t){this.styleOrigin?Jg().error("#uniqueValueGroups=","Cannot modify unique value groups of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueGroups",t),this._updateInfosFromGroups(),this._isInfosSource=!1,this._watchUniqueValueGroups())}set uniqueValueInfos(t){this.styleOrigin?Jg().error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",t),this._updateValueInfoMap(),this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos())}addUniqueValueInfo(t,e){var s;if(this.styleOrigin)return void Jg().error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");let i;i=typeof t=="object"?vlt(t):new pP({value:t,symbol:qme(e)}),(s=this.uniqueValueInfos)==null||s.push(i),this._valueInfoMap[fb(i.value)]=i,this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}removeUniqueValueInfo(t){if(this.styleOrigin)return void Jg().error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");const e=this.uniqueValueInfos;if(e)for(let i=0;i<e.length;i++){const s=e[i];if(String(s.value)===String(t)){delete this._valueInfoMap[fb(t)],e.splice(i,1);break}}this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}async getUniqueValueInfo(t,e){let i=e;return this.valueExpression&&(e==null?void 0:e.arcade)==null&&(i={...i,arcade:await gy()}),this._getUniqueValueInfo(t,i)}getSymbol(t,e){if(this.valueExpression&&(e==null?void 0:e.arcade)==null)return void Jg().error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this._getUniqueValueInfo(t,e);return(i==null?void 0:i.symbol)||this.defaultSymbol}async getSymbolAsync(t,e){let i=e;if(this.valueExpression&&(i==null?void 0:i.arcade)==null){const n=await gy(),{arcadeUtils:r}=n;r.hasGeometryOperations(this.valueExpression)&&await r.enableGeometryOperations(),i={...i,arcade:n}}const s=this._getUniqueValueInfo(t,i);return(s==null?void 0:s.symbol)||this.defaultSymbol}get symbols(){const t=[];for(const e of this.uniqueValueInfos??[])e.symbol&&t.push(e.symbol);return this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){var t;return((t=this.visualVariables)==null?void 0:t.reduce((e,i)=>e+i.getAttributeHash(),""))??""}getMeshHash(){var s;const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),i=(s=this.uniqueValueInfos)==null?void 0:s.reduce((n,r)=>n+r.getMeshHash(),"");return`${t}.${e}.${i}.${`${this.field}.${this.field2}.${this.field3}.${this.fieldDelimiter}`}.${this.valueExpression}`}clone(){const t=new DT({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:be(this.defaultSymbol),orderByClassesEnabled:this.orderByClassesEnabled,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:be(this.visualVariables),legendOptions:be(this.legendOptions),authoringInfo:be(this.authoringInfo),backgroundFillSymbol:be(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(t._isDefaultSymbolDerived=!0),t._set("portal",this.portal);const e=be(this.uniqueValueInfos),i=be(this.uniqueValueGroups);return this.styleOrigin&&(t._set("styleOrigin",Object.freeze(be(this.styleOrigin))),Object.freeze(e),Object.freeze(i)),t._set("uniqueValueInfos",e),t._updateValueInfoMap(),t._set("uniqueValueGroups",i),t._isInfosSource=this._isInfosSource,t._watchUniqueValueInfosAndGroups(),t}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}async collectRequiredFields(t,e){const i=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(i)}async collectSymbolFields(t,e){const i=[...this.symbols.map(s=>s.collectRequiredFields(t,e)),al(t,e,this.valueExpression)];Ll(t,e,this.field),Ll(t,e,this.field2),Ll(t,e,this.field3),await Promise.all(i)}populateFromStyle(){return glt(this.styleOrigin,{portal:this.portal}).then(t=>{var i;const e=[];return this._valueInfoMap={},t!=null&&t.data&&Array.isArray(t.data.items)&&t.data.items.forEach(s=>{const n=new vy({styleUrl:t.styleUrl,styleName:t.styleName,portal:this.portal,name:s.name});this.defaultSymbol||s.name!==t.data.defaultItem||(this.defaultSymbol=n,this._isDefaultSymbolDerived=!0);const r=new pP({value:s.name,symbol:n});e.push(r),this._valueInfoMap[fb(s.name)]=r}),this._set("uniqueValueInfos",Object.freeze(e)),this._updateGroupsFromInfos(!0),this._isInfosSource=null,this._watchUniqueValueInfos(),!this.defaultSymbol&&((i=this.uniqueValueInfos)!=null&&i.length)&&(this.defaultSymbol=this.uniqueValueInfos[0].symbol,this._isDefaultSymbolDerived=!0),this})}_updateFieldDelimiter(){this.field&&this.field2&&!this.fieldDelimiter&&this._set("fieldDelimiter",ylt)}_updateUniqueValues(){this._isInfosSource!=null&&(this._isInfosSource?this._updateGroupsFromInfos():this._updateInfosFromGroups())}_updateValueInfoMap(){this._valueInfoMap={};const{uniqueValueInfos:t}=this;if(t)for(const e of t)this._valueInfoMap[fb(e.value)]=e}_watchUniqueValueInfosAndGroups(){this._watchUniqueValueInfos(),this._watchUniqueValueGroups()}_watchUniqueValueInfos(){this.removeHandles(Loe);const{uniqueValueInfos:t}=this;if(t){const e=[];for(const i of t)e.push(Ai(()=>({symbol:i.symbol,value:i.value,label:i.label,description:i.description}),(s,n)=>{s!==n&&(this._updateGroupsFromInfos(),this._isInfosSource=!0)},{sync:!0}));this.addHandles(e,Loe)}}_watchUniqueValueGroups(){this.removeHandles(Foe);const{uniqueValueGroups:t}=this;if(t){const e=[];for(const i of t){e.push(Ai(()=>({classes:i.classes}),(s,n)=>{s!==n&&(this._updateInfosFromGroups(),this._isInfosSource=!1)},{sync:!0}));for(const s of i.classes??[])e.push(Ai(()=>({symbol:s.symbol,values:s.values,label:s.label,description:s.description}),(n,r)=>{n!==r&&(this._updateInfosFromGroups(),this._isInfosSource=!1)},{sync:!0}))}this.addHandles(e,Foe)}}_updateInfosFromGroups(){if(!this.uniqueValueGroups)return this._set("uniqueValueInfos",null),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const t=[],{field:e,field2:i,field3:s,fieldDelimiter:n,uniqueValueGroups:r,valueExpression:o}=this;if(!e&&!o)return this._set("uniqueValueInfos",t),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const a=!(!e||!i);for(const l of r)for(const u of l.classes??[]){const{symbol:c,label:h,values:d,description:m}=u;for(const f of d??[]){const{value:_,value2:v,value3:x}=f,w=[_];i&&w.push(v),s&&w.push(x);const T=a?w.join(n||""):w[0]??void 0;t.push(new pP({symbol:c,label:h,value:T,description:m}))}}this._set("uniqueValueInfos",t),this._updateValueInfoMap(),this._watchUniqueValueInfos()}_updateGroupsFromInfos(t=!1){if(!this.uniqueValueInfos)return this._set("uniqueValueGroups",null),void this._watchUniqueValueGroups();const{field:e,field2:i,valueExpression:s,fieldDelimiter:n,uniqueValueInfos:r}=this;if(!e&&!s||!r.length)return this._set("uniqueValueGroups",[]),void this._watchUniqueValueGroups();const o=!(!e||!i),a=r.map(u=>{var x;const{symbol:c,label:h,value:d,description:m}=u,[f,_,v]=o?((x=d==null?void 0:d.toString())==null?void 0:x.split(n||""))||[]:[d];return new Ebe({symbol:c,label:h,description:m,values:[new qw({value:f,value2:_,value3:v})]})}),l=[new P9({classes:a})];t&&Object.freeze(l),this._set("uniqueValueGroups",l),this._watchUniqueValueGroups()}_getUniqueValueInfo(t,e){return this.valueExpression?this._getUnqiueValueInfoForExpression(t,e):this._getUnqiueValueInfoForFields(t)}_getUnqiueValueInfoForExpression(t,e){const{viewingMode:i,scale:s,spatialReference:n,arcade:r,timeZone:o}=e??{};let a=this._cache.compiledFunc;const l=r.arcadeUtils;if(!a){const c=l.createSyntaxTree(this.valueExpression);a=l.createFunction(c),this._cache.compiledFunc=a}const u=l.executeFunction(a,l.createExecContext(t,l.getViewInfo({viewingMode:i,scale:s,spatialReference:n}),o));return this._valueInfoMap[fb(u)]}_getUnqiueValueInfoForFields(t){const e=this.field,i=t.attributes;let s;if(this.field2){const n=this.field2,r=this.field3,o=[];e&&o.push(i[e]),n&&o.push(i[n]),r&&o.push(i[r]),s=o.join(this.fieldDelimiter||"")}else e&&(s=i[e]);return this._valueInfoMap[fb(s)]}static fromPortalStyle(t,e){const i=new DT(e==null?void 0:e.properties);i._set("styleOrigin",Object.freeze({styleName:t})),i._set("portal",(e==null?void 0:e.portal)||Cu.getDefault());const s=i.populateFromStyle();return s.catch(n=>{Jg().error(`#fromPortalStyle('${t}'[, ...])`,"Failed to create unique value renderer from style name",n)}),s}static fromStyleUrl(t,e){const i=new DT(e==null?void 0:e.properties);i._set("styleOrigin",Object.freeze({styleUrl:t}));const s=i.populateFromStyle();return s.catch(n=>{Jg().error(`#fromStyleUrl('${t}'[, ...])`,"Failed to create unique value renderer from style URL",n)}),s}};y([S({readOnly:!0})],Zn.prototype,"_cache",null),y([ai({uniqueValue:"unique-value"})],Zn.prototype,"type",void 0),y([S(oX)],Zn.prototype,"backgroundFillSymbol",void 0),y([S({value:null,json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],Zn.prototype,"field",null),y([Ls("field")],Zn.prototype,"castField",null),y([yt("field")],Zn.prototype,"writeField",null),y([S({type:String,value:null,json:{write:!0}})],Zn.prototype,"field2",null),y([S({type:String,value:null,json:{write:!0}})],Zn.prototype,"field3",null),y([S({type:Boolean,json:{name:"drawInClassOrder",default:!1,write:!0,origins:{"web-scene":{write:!1}}}})],Zn.prototype,"orderByClassesEnabled",void 0),y([S({type:String,value:null,json:{write:!0}})],Zn.prototype,"valueExpression",null),y([S({type:String,json:{write:!0}})],Zn.prototype,"valueExpressionTitle",void 0),y([S({type:aX,json:{write:!0}})],Zn.prototype,"legendOptions",void 0),y([S({type:String,json:{write:!0}})],Zn.prototype,"defaultLabel",void 0),y([S(rH({...gk},{json:{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}}}}}}))],Zn.prototype,"defaultSymbol",null),y([S({type:String,value:null,json:{write:!0}})],Zn.prototype,"fieldDelimiter",null),y([S({type:Cu,readOnly:!0})],Zn.prototype,"portal",void 0),y([mt("portal",["styleName"])],Zn.prototype,"readPortal",null),y([S({readOnly:!0,json:{write:{enabled:!1,overridePolicy:()=>({enabled:!0})}}})],Zn.prototype,"styleOrigin",void 0),y([mt("styleOrigin",["styleName","styleUrl"])],Zn.prototype,"readStyleOrigin",null),y([yt("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],Zn.prototype,"writeStyleOrigin",null),y([S({type:[P9],json:{read:{source:["uniqueValueGroups","uniqueValueInfos"],reader:(t,e,i)=>(e.uniqueValueGroups||xlt(e)).map(s=>P9.fromJSON(s,i))},write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],Zn.prototype,"uniqueValueGroups",null),y([S({type:[pP],json:{read:!1,write:{isRequired:!0,overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0,isRequired:!0}}}}})],Zn.prototype,"uniqueValueInfos",null),Zn=DT=y([se(Cbe)],Zn);const lX=Zn;var A9;let Mo=A9=class extends it{constructor(t){super(t),this.attachmentTypes=null,this.attachmentsWhere=null,this.cacheHint=void 0,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.orderByFields=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10}clone(){return new A9(be({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,cacheHint:this.cacheHint,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}};y([S({type:[String],json:{write:!0}})],Mo.prototype,"attachmentTypes",void 0),y([S({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],Mo.prototype,"attachmentsWhere",void 0),y([S({type:Boolean,json:{write:!0}})],Mo.prototype,"cacheHint",void 0),y([S({type:[String],json:{write:!0}})],Mo.prototype,"keywords",void 0),y([S({type:[String],json:{write:!0}})],Mo.prototype,"globalIds",void 0),y([S({json:{write:!0}})],Mo.prototype,"name",void 0),y([S({type:Number,json:{read:{source:"resultRecordCount"}}})],Mo.prototype,"num",void 0),y([S({type:[Number],json:{write:!0}})],Mo.prototype,"objectIds",void 0),y([S({type:[String],json:{write:!0}})],Mo.prototype,"orderByFields",void 0),y([S({type:Boolean,json:{default:!1,write:!0}})],Mo.prototype,"returnMetadata",void 0),y([S({type:[Number],json:{write:!0}})],Mo.prototype,"size",void 0),y([S({type:Number,json:{read:{source:"resultOffset"}}})],Mo.prototype,"start",void 0),y([yt("start"),yt("num")],Mo.prototype,"writeStart",null),y([S({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],Mo.prototype,"where",void 0),Mo=A9=y([se("esri.rest.support.AttachmentQuery")],Mo),Mo.from=xo(Mo);const blt=Mo,Tbe=ca()({naturalLog:"natural-log",squareRoot:"square-root",percentOfTotal:"percent-of-total",log:"log",field:"field"}),koe="percent-of-total",$oe="field",_St=t=>{let e=class extends t{constructor(){super(...arguments),this.normalizationField=null,this.normalizationMaxValue=null,this.normalizationMinValue=null,this.normalizationTotal=null}get normalizationType(){let i=this._get("normalizationType");const s=!!this.normalizationField,n=this.normalizationTotal!=null;return s||n?(i=s&&$oe||n&&koe||null,s&&n&&ht.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):i!==$oe&&i!==koe||(i=null),i}set normalizationType(i){this._set("normalizationType",i)}};return y([S({type:String,json:{name:"parameters.normalizationField",write:!0}})],e.prototype,"normalizationField",void 0),y([S({type:Number,json:{name:"parameters.normalizationMaxValue",write:!0}})],e.prototype,"normalizationMaxValue",void 0),y([S({type:Number,json:{name:"parameters.normalizationMinValue",write:!0}})],e.prototype,"normalizationMinValue",void 0),y([S({type:Number,json:{name:"parameters.normalizationTotal",write:!0}})],e.prototype,"normalizationTotal",void 0),y([ai(Tbe,{name:"parameters.normalizationType"})],e.prototype,"normalizationType",null),e=y([se("esri.rest.support.NormalizationBinParametersMixin")],e),e};var I9;let hr=I9=class extends it{constructor(t){super(t),this.cacheHint=void 0,this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime()}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10,this.start>0&&this.where==null&&(e.definitionExpression="1=1")}clone(){return new I9(be({cacheHint:this.cacheHint,dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment.getTime()),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}};y([S({type:Boolean,json:{write:!0}})],hr.prototype,"cacheHint",void 0),y([S({type:ed,json:{write:!0}})],hr.prototype,"dynamicDataSource",void 0),y([S({type:String,json:{write:!0}})],hr.prototype,"gdbVersion",void 0),y([S({type:Number,json:{write:!0}})],hr.prototype,"geometryPrecision",void 0),y([S({type:Date})],hr.prototype,"historicMoment",void 0),y([yt("historicMoment")],hr.prototype,"_writeHistoricMoment",null),y([S({type:Number,json:{write:!0}})],hr.prototype,"maxAllowableOffset",void 0),y([S({json:{write:!0}})],hr.prototype,"objectIds",void 0),y([S({type:[String],json:{write:!0}})],hr.prototype,"orderByFields",void 0),y([S({type:[String],json:{write:!0}})],hr.prototype,"outFields",void 0),y([S({type:Ri,json:{read:{source:"outSR"},write:{target:"outSR"}}})],hr.prototype,"outSpatialReference",void 0),y([S({json:{write:!0}})],hr.prototype,"relationshipId",void 0),y([S({type:Number,json:{read:{source:"resultOffset"}}})],hr.prototype,"start",void 0),y([yt("start"),yt("num")],hr.prototype,"writeStart",null),y([S({type:Number,json:{read:{source:"resultRecordCount"}}})],hr.prototype,"num",void 0),y([S({json:{write:!0}})],hr.prototype,"returnGeometry",void 0),y([S({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],hr.prototype,"returnM",void 0),y([S({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],hr.prototype,"returnZ",void 0),y([S({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],hr.prototype,"where",void 0),hr=I9=y([se("esri.rest.support.RelationshipQuery")],hr),hr.from=xo(hr);const uX=hr,ySt=Object.freeze(Object.defineProperty({__proto__:null,default:uX},Symbol.toStringTag,{value:"Module"})),D9=new gs({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});async function wlt(t,e,i,s){const n=await Yy(t);if(await cX(t,e,s),!n.addAttachment)throw new Se(s,"Layer source does not support addAttachment capability");return n.addAttachment(e,i)}function cX(t,e,i){var r,o;const{attributes:s}=e,{objectIdField:n}=t;return(o=(r=t.capabilities)==null?void 0:r.data)!=null&&o.supportsAttachment?e?s?n&&s[n]?Promise.resolve():Promise.reject(new Se(i,`feature is missing the identifying attribute ${n}`)):Promise.reject(new Se(i,"'attributes' are required on a feature to query attachments")):Promise.reject(new Se(i,"A feature is required to add/delete/update attachments")):Promise.reject(new Se(i,"this layer doesn't support attachments"))}async function Slt(t,e,i,s,n){const r=await Yy(t);if(await cX(t,e,n),!r.updateAttachment)throw new Se(n,"Layer source does not support updateAttachment capability");return r.updateAttachment(e,i,s)}async function Elt(t,e,i){const{applyEdits:s}=await _e(()=>import("./editingSupport-DtprcNhQ.js"),[]),n=await t.load();let r=i;return n.type==="feature"&&n.infoFor3D&&e.deleteFeatures!=null&&n.globalIdField!=null&&(r={...r,globalIdToObjectId:await jlt(n,e.deleteFeatures,n.globalIdField)}),s(n,n.source,e,i)}async function Clt(t,e,i){const{uploadAssets:s}=await _e(()=>import("./editingSupport-DtprcNhQ.js"),[]),n=await t.load();return s(n,n.source,e,i)}async function Tlt(t,e,i,s){const n=await Yy(t);if(await cX(t,e,s),!n.deleteAttachments)throw new Se(s,"Layer source does not support deleteAttachments capability");return n.deleteAttachments(e,i)}async function Plt(t,e,i){const s=(await t.load({signal:e==null?void 0:e.signal})).source;if(!s.fetchRecomputedExtents)throw new Se(i,"Layer source does not support fetchUpdates capability");return s.fetchRecomputedExtents(e)}async function Mlt(t,e,i,s){var m,f,_,v;e=blt.from(e),await t.load();const n=t.source,r=t.capabilities;if(!((m=r==null?void 0:r.data)!=null&&m.supportsAttachment))throw new Se(s,"this layer doesn't support attachments");const{attachmentTypes:o,objectIds:a,globalIds:l,num:u,size:c,start:h,where:d}=e;if(!((f=r==null?void 0:r.operations)!=null&&f.supportsQueryAttachments)&&((o==null?void 0:o.length)>0||(l==null?void 0:l.length)>0||(c==null?void 0:c.length)>0||u||h||d))throw new Se(s,"when 'capabilities.operations.supportsQueryAttachments' is false, only objectIds is supported",e);if(!(a!=null&&a.length||l!=null&&l.length||d))throw new Se(s,"'objectIds', 'globalIds', or 'where' are required to perform attachment query",e);if(!n.queryAttachments)throw new Se(s,"Layer source does not support queryAttachments capability",e);return!((_=r==null?void 0:r.attachment)!=null&&_.supportsOrderByFields)&&((v=e.orderByFields)!=null&&v.length)&&((e=e.clone()).orderByFields=null),n.queryAttachments(e)}async function Alt(t,e,i,s){const n=await Yy(t);if(!n.queryObjectIds)throw new Se(s,"Layer source does not support queryObjectIds capability");return n.queryObjectIds(Gf.from(e)??t.createQuery(),i)}async function Ilt(t,e,i,s){const n=await Yy(t);if(!n.queryFeatureCount)throw new Se(s,"Layer source does not support queryFeatureCount capability");return n.queryFeatureCount(Gf.from(e)??t.createQuery(),i)}async function Dlt(t,e,i,s){const n=await Yy(t);if(!n.queryExtent)throw new Se(s,"Layer source does not support queryExtent capability");return n.queryExtent(Gf.from(e)??t.createQuery(),i)}async function Nlt(t,e,i,s){const n=await Yy(t);if(!n.queryRelatedFeatures)throw new Se(s,"Layer source does not support queryRelatedFeatures capability");return n.queryRelatedFeatures(uX.from(e),i)}async function Rlt(t,e,i,s){const n=await Yy(t);if(!n.queryRelatedFeaturesCount)throw new Se(s,"Layer source does not support queryRelatedFeaturesCount capability");return n.queryRelatedFeaturesCount(uX.from(e),i)}async function Olt(t){const e=t.source;if(e!=null&&e.refresh)try{const{dataChanged:i,updates:s}=await e.refresh();if(s!=null&&(t.sourceJSON={...t.sourceJSON,...s},t.read(s,{origin:"service",url:t.parsedUrl})),i)return!0}catch{}if(t.definitionExpression)try{return(await ghe(t.definitionExpression,t.fieldsIndex)).hasDateFunctions}catch{}return!1}function Llt(t){var o,a;const e=new Gf,i=(o=t.capabilities)==null?void 0:o.data,s=(a=t.capabilities)==null?void 0:a.query;e.historicMoment=t.historicMoment,e.gdbVersion=t.gdbVersion,e.returnGeometry=!0,s&&(e.compactGeometryEnabled=s.supportsCompactGeometry,e.defaultSpatialReferenceEnabled=s.supportsDefaultSpatialReference),i&&(i.supportsZ&&t.returnZ!=null&&(e.returnZ=t.returnZ),i.supportsM&&t.returnM!=null&&(e.returnM=t.returnM)),e.outFields=["*"];const{timeOffset:n,timeExtent:r}=t;return e.timeExtent=n!=null&&r!=null?r.offset(-n.value,n.unit):r||null,e.multipatchOption=t.geometryType==="multipatch"?"xyFootprint":null,e}function Pbe(t){const{globalIdField:e,fields:i}=t;if(e)return e;if(i){for(const s of i)if(s.type==="esriFieldTypeGlobalID")return s.name}}function Mbe(t){const{objectIdField:e,fields:i}=t;if(e)return e;if(i){for(const s of i)if(s.type==="esriFieldTypeOID")return s.name}}function Flt(t){return t.currentVersion?t.currentVersion:t.hasOwnProperty("capabilities")||t.hasOwnProperty("drawingInfo")||t.hasOwnProperty("hasAttachments")||t.hasOwnProperty("htmlPopupType")||t.hasOwnProperty("relationships")||t.hasOwnProperty("timeInfo")||t.hasOwnProperty("typeIdField")||t.hasOwnProperty("types")?10:9.3}function klt(t,e,i,s){var l,u;const n=i==null?void 0:i.feature,r=!!((l=t.subtypes)!=null&&l.length);if(r&&!(i!=null&&i.excludeImpliedDomains)){const c=Ult(t,e);if(c)return c}const o=r&&$lt(t,n);if(o){const c=(u=o==null?void 0:o.domains)==null?void 0:u[e];return(c==null?void 0:c.type)==="inherited"?s:c}const a=Dbe(t.types,t.typeIdField,n);if(a){const c=a.domains&&a.domains[e];if(c&&(c==null?void 0:c.type)!=="inherited")return c}if(s)return s;if(!(i!=null&&i.excludeImpliedDomains)){const c=Vlt(t,e);if(c)return c}return null}function $lt(t,e){const{subtypes:i,subtypeField:s}=t;if(!(e!=null&&e.attributes)||!(i!=null&&i.length)||!s)return null;const n=e.attributes[s];return n==null?null:i.find(r=>r.code===n)}function Ult(t,e){var o,a;const{fieldsIndex:i,subtypeField:s}=t,{name:n,type:r}=i.get(e)??{};if(!n)return null;if((s&&((o=i.get(s))==null?void 0:o.name))===n&&((a=t.subtypes)!=null&&a.length)){const l=t.subtypes.map(u=>new Bv({code:Abe(u.code,r),name:u.name}));if(l!=null&&l.length)return new X4({codedValues:l})}return null}function Vlt(t,e){var r,o;const{fieldsIndex:i}=t,{name:s,type:n}=i.get(e)??{};if(!s)return null;if(("typeIdField"in t?(r=i.get(t.typeIdField))==null?void 0:r.name:null)===s&&"types"in t&&((o=t.types)!=null&&o.length)){const a=t.types.map(l=>new Bv({code:Abe(l.id,n),name:l.name}));return new X4({codedValues:a})}return null}function Abe(t,e){return e?Rde({type:e})&&typeof t=="number"?`${t}`:hDe({type:e})&&typeof t=="string"?Number.parseInt(t,10):t:t}async function Yy(t){return(await t.load()).source}async function vSt(t,e){if(!Yi)return;const i=Yi.findCredential(t);if(i)return i.userId;let s;try{const n=await yY(t,e);n&&(s=await Yi.checkSignInStatus(`${n}/sharing`))}catch{}return s?s.userId:null}async function Ibe(t,e){if(!Yi||Yi.findCredential(t))return;let i;try{const s=await yY(t,e);s&&(i=await Yi.checkSignInStatus(`${s}/sharing`))}catch{}if(i)try{const s=e!=null?e.signal:null;await Yi.getCredential(t,{signal:s})}catch{}}async function zlt(t,e,i){var n;const s=(n=t.parsedUrl)==null?void 0:n.path;s&&t.authenticationTriggerEvent===e&&await Ibe(s,i)}async function xSt(t){var i;const e=(i=t.parsedUrl)==null?void 0:i.path;e&&Glt(t)&&await Ibe(e)}function Glt(t){return Blt(t)&&("serviceDefinitionExpression"in t&&oF(t.serviceDefinitionExpression)||"definitionExpression"in t&&oF(t.definitionExpression))}function Blt(t){var e;return!(!T0e(t)||!((e=t.capabilities)!=null&&e.query.supportsCurrentUser))}function oF(t){return!!(t!=null&&t.toLowerCase().includes("current_user"))}function qlt(t){return!tO(t)&&(t.userHasUpdateItemPrivileges||t.editingEnabled)}const ZV=LS({types:Bme});function hX(t,e){var i;if(t.defaultSymbol)return(i=t.types)!=null&&i.length?new lX({defaultSymbol:ZV(t.defaultSymbol,t,e),field:t.typeIdField,uniqueValueInfos:t.types.map(s=>({id:s.id,symbol:ZV(s.symbol,s,e)}))}):new Om({symbol:ZV(t.defaultSymbol,t,e)})}function Hlt(t){var s,n,r;let e=(s=t.sourceJSON)==null?void 0:s.cacheMaxAge;if(!e)return!1;const i=(r=(n=t.editingInfo)==null?void 0:n.lastEditDate)==null?void 0:r.getTime();return i==null||(e*=1e3,Date.now()-i<e)}async function jlt(t,e,i){if(e==null)return null;const s=[],{objectIdField:n}=t;if(e.forEach(u=>{let c=null;if("attributes"in u){const{attributes:h}=u;c={globalId:h[i],objectId:h[n]!=null&&h[n]!==-1?h[n]:null}}else c={globalId:u.globalId,objectId:u.objectId!=null&&u.objectId!==-1?u.objectId:null};c.globalId!=null&&(c.objectId!=null&&c.objectId!==-1||s.push(c.globalId))}),s.length===0)return null;const r=t.createQuery();r.where=s.map(u=>`${i}='${u}'`).join(" OR "),r.returnGeometry=!1,r.outFields=[n,i],r.cacheHint=!1;const o=await nNe(dat(t,r));if(!o.ok)return null;const a=new Map,l=o.value.features;for(const u of l){const c=u.attributes[i],h=u.attributes[n];c!=null&&h!=null&&h!==-1&&a.set($st(c),h)}return a}function Dbe(t,e,i){if(!e||!i||!t)return null;const s=i.getAttribute(e);return s==null?null:t.find(n=>{const{id:r}=n;return r!=null&&r.toString()===s.toString()})??null}function tO(t){var e;return((e=t.sourceJSON)==null?void 0:e.isMultiServicesView)||Ylt(t)}function Ylt(t){var e,i;return!!((i=(e=t.sourceJSON)==null?void 0:e.capabilities)!=null&&i.toLowerCase().split(",").map(s=>s.trim()).includes("map"))}function Xlt(t,e,i){const s=e==null?void 0:e.queryAttributeBins;if(!s)throw new Se(i,"Layer source does not support binning");switch(t.binParameters.type){case"auto-interval":if(!s.supportsAutoInterval)throw new Se(i,"Layer source does not support auto-interval binning");if(t.binParameters.normalizationType&&(!s.supportsNormalization||!Uoe(t.binParameters.normalizationType,s.supportedNormalizationTypes)))throw new Se(i,"Layer source does not support normalization binning");break;case"date":if(!s.supportsDate)throw new Se(i,"Layer source does not support date binning");if(t.binParameters.snapToData&&!s.supportsSnapToData)throw new Se(i,"Layer source does not support snapToData binning");if(t.binParameters.returnFullIntervalBin&&!s.supportsReturnFullIntervalBin)throw new Se(i,"Layer source does not support returnFullIntervalBin binning");break;case"fixed-boundaries":if(!s.supportsFixedBoundaries)throw new Se(i,"Layer source does not support fixed-boundaries binning");break;case"fixed-interval":if(!s.supportsFixedInterval)throw new Se(i,"Layer source does not support fixed-interval binning");if(t.binParameters.normalizationType&&(!s.supportsNormalization||!Uoe(t.binParameters.normalizationType,s.supportedNormalizationTypes)))throw new Se(i,"Layer source does not support normalization binning")}if(t.binParameters.stackBy&&!s.supportsStackBy)throw new Se(i,"Layer source does not support stackBy binning");if(t.binParameters.splitBy&&!s.supportsSplitBy)throw new Se(i,"Layer source does not support splitBy binning");if(t.binParameters.firstDayOfWeek&&!s.supportsFirstDayOfWeek)throw new Se(i,"Layer source does not support firstDayOfWeek binning");const n=s==null?void 0:s.supportedStatistics;if(t.outStatistics&&n){const r=new Map([["count","count"],["sum","sum"],["min","min"],["max","max"],["avg","avg"],["stddev","stddev"],["var","var"],["percentile-continuous","percentileContinuous"],["percentile-discrete","percentileDiscrete"],["centroid-aggregate","centroid"],["convex-hull-aggregate","convexHull"],["envelope-aggregate","envelope"]]);for(const{statisticType:o}of t.outStatistics){const a=r.get(o);if(a&&!n[a])throw new Se(i,`Layer source does not support ${o} statistic type`)}}}function Uoe(t,e){return t!=null&&!!(e!=null&&e[Tbe.toJSON(t)])}let Jb=class extends bs.ClonableMixin(it){constructor(e){super(e),this.shapeAreaField=null,this.shapeLengthField=null,this.units=null}};y([S({type:String,json:{read:{source:"shapeAreaFieldName"}}})],Jb.prototype,"shapeAreaField",void 0),y([S({type:String,json:{read:{source:"shapeLengthFieldName"}}})],Jb.prototype,"shapeLengthField",void 0),y([S({type:String,json:{read:t=>JTe.read(t)||ePe.read(t)}})],Jb.prototype,"units",void 0),Jb=y([se("esri.layers.support.GeometryFieldsInfo")],Jb);const Wlt=Jb;var N9;let ew=N9=class extends it{constructor(t){super(t),this.floorField=null,this.viewAllMode=!1,this.viewAllLevelIds=new Nt}clone(){return new N9({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}};y([S({type:String,json:{write:{isRequired:!0}}})],ew.prototype,"floorField",void 0),y([S({json:{read:!1,write:!1}})],ew.prototype,"viewAllMode",void 0),y([S({json:{read:!1,write:!1}})],ew.prototype,"viewAllLevelIds",void 0),ew=N9=y([se("esri.layers.support.LayerFloorInfo")],ew);const Zlt=ew,Voe=new gs({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"}),zoe=new gs({esriRelRoleOrigin:"origin",esriRelRoleDestination:"destination"});let Ku=class extends bs.ClonableMixin(it){constructor(e){super(e),this.cardinality=null,this.catalogId=null,this.composite=null,this.id=null,this.keyField=null,this.keyFieldInRelationshipTable=null,this.name=null,this.relatedTableId=null,this.relationshipTableId=null,this.role=null}};y([S({json:{read:Voe.read,write:Voe.write}})],Ku.prototype,"cardinality",void 0),y([S({json:{name:"catalogID"}})],Ku.prototype,"catalogId",void 0),y([S({json:{read:!0,write:!0}})],Ku.prototype,"composite",void 0),y([S({json:{read:!0,write:!0}})],Ku.prototype,"id",void 0),y([S({json:{read:!0,write:!0}})],Ku.prototype,"keyField",void 0),y([S({json:{read:!0,write:!0}})],Ku.prototype,"keyFieldInRelationshipTable",void 0),y([S({json:{read:!0,write:!0}})],Ku.prototype,"name",void 0),y([S({json:{read:!0,write:!0}})],Ku.prototype,"relatedTableId",void 0),y([S({json:{read:!0,write:!0}})],Ku.prototype,"relationshipTableId",void 0),y([S({json:{read:zoe.read,write:zoe.write}})],Ku.prototype,"role",void 0),Ku=y([se("esri.layers.support.Relationship")],Ku);const Klt=Ku,Qlt=[["binary","application/octet-stream","bin",""]];function SSt(t,e){return Lbe(e.name,(t==null?void 0:t.supportedFormats)??[])!=null}function ESt(t,e){if(!t)return!1;const i=Jlt(e,t.supportedFormats??[]);return i!=null&&t.editFormats.includes(i)}function Nbe(t,e){return mX(sut(t,e))}function Rbe(t,e){return mX(Lbe(t,e))}function CSt(t,e){return Fbe(iut(t,e))}function Jlt(t,e){return Rbe(t.name,e)??Nbe(t.type,e)}function _k(t,e,i){return Nbe(t,i)??Rbe(e,i)}function Obe({supportedFormats:t}){return _k("model/gltf-binary","glb",t)}function TSt(t){const e=Obe(t);return e!=null&&t.editFormats.includes(e)}function eut({supportedFormats:t}){return _k("model/gltf+json","gltf",t)}function tut(t){if(!t)return null;const e=Obe(t),i=eut(t);let s=null;for(const n of t.queryFormats){if(n===e)return n;n===i&&(s=n)}return s}function PSt({supportedFormats:t}){return _k("application/esri3do-SR_world","wld",t)}function MSt({supportedFormats:t}){return _k("application/esri3do-SR_prj","prj",t)}function dX(t){return[...Qlt,...t]}function iut(t,e){return dX(e).find(i=>mX(i)===t)}function sut(t,e){const i=t.toLowerCase();return dX(e).find(s=>Fbe(s)===i)}function Lbe(t,e){const i=t.toLowerCase();return dX(e).find(s=>nut(s).some(n=>i.endsWith(n)))}function mX(t){return t==null?void 0:t[0]}function Fbe(t){return t==null?void 0:t[1].toLowerCase()}function nut(t){return(t==null?void 0:t[2].split(",").map(e=>e.toLowerCase()))??[]}function ASt(t){var e;return(e=t.tables)==null?void 0:e.find(i=>i.role==="assetMaps")}function Vt(t,e,i){return!!kbe(t,e,i)}function NT(t,e,i){return kbe(t,e,i)}function kbe(t,e,i){return t&&t.hasOwnProperty(e)?t[e]:i}const rut={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"};function out(t){var i;const e=(i=t==null?void 0:t.supportedSpatialAggregationStatistics)==null?void 0:i.map(s=>s.toLowerCase());return{envelope:!!(e!=null&&e.includes("envelopeaggregate")),centroid:!!(e!=null&&e.includes("centroidaggregate")),convexHull:!!(e!=null&&e.includes("convexhullaggregate"))}}function PA(t,e){var s;const i=(s=t==null?void 0:t.supportedOperationsWithCacheHint)==null?void 0:s.map(n=>n.toLowerCase());return!!(i!=null&&i.includes(e.toLowerCase()))}function aut(t){var i;const e=(i=t==null?void 0:t.supportedStatisticTypes)==null?void 0:i.map(s=>s.toLowerCase());return{count:!!(e!=null&&e.includes("count")),sum:!!(e!=null&&e.includes("sum")),min:!!(e!=null&&e.includes("min")),max:!!(e!=null&&e.includes("max")),avg:!!(e!=null&&e.includes("avg")),var:!!(e!=null&&e.includes("var")),stddev:!!(e!=null&&e.includes("stddev")),percentileContinuous:!!(e!=null&&e.includes("percentile_continuous")),percentileDiscrete:!!(e!=null&&e.includes("percentile_discrete")),envelope:!!(e!=null&&e.includes("envelopeaggregate")),centroid:!!(e!=null&&e.includes("centroidaggregate")),convexHull:!!(e!=null&&e.includes("convexhullaggregate"))}}function lut(t){var i;const e=(i=t==null?void 0:t.supportedNormalizationTypes)==null?void 0:i.map(s=>s.toLowerCase());return{field:!!(e!=null&&e.includes("field")),log:!!(e!=null&&e.includes("log")),naturalLog:!!(e!=null&&e.includes("naturallog")),percentOfTotal:!!(e!=null&&e.includes("percentoftotal")),squareRoot:!!(e!=null&&e.includes("squareroot"))}}function $be(t,e){return{analytics:uut(t),attachment:cut(t),data:hut(t),metadata:dut(t),operations:mut(t.capabilities,t,e),query:put(t,e),queryAttributeBins:_ut(t),queryRelated:fut(t),queryTopFeatures:gut(t),editing:yut(t)}}function uut(t){return{supportsCacheHint:PA(t.advancedQueryCapabilities,"queryAnalytics")}}function cut(t){const e=t.attachmentProperties,i={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1,supportsCacheHint:PA(t.advancedQueryCapabilities,"queryAttachments"),supportsOrderByFields:Vt(t.advancedQueryCapabilities,"supportsQueryAttachmentOrderByFields",!1),supportsResize:Vt(t,"supportsAttachmentsResizing",!1)};return e&&Array.isArray(e)&&e.forEach(s=>{const n=rut[s.name];n&&(i[n]=!!s.isEnabled)}),i}function hut(t){return{isVersioned:Vt(t,"isDataVersioned",!1),isBranchVersioned:Vt(t,"isDataBranchVersioned",!1),supportsAttachment:Vt(t,"hasAttachments",!1),supportsM:Vt(t,"hasM",!1),supportsZ:Vt(t,"hasZ",!1)}}function dut(t){return{supportsAdvancedFieldProperties:Vt(t,"supportsFieldDescriptionProperty",!1)}}function mut(t,e,i){const s=t?t.toLowerCase().split(",").map(d=>d.trim()):[],n=i?VS(i):null,r=s.includes(n!=null&&n.serverType==="MapServer"?"data":"query"),o=s.includes("editing")&&!e.datesInUnknownTimezone;let a=o&&s.includes("create"),l=o&&s.includes("delete"),u=o&&s.includes("update");const c=s.includes("changetracking"),h=e.advancedQueryCapabilities;return o&&!(a||l||u)&&(a=l=u=!0),{supportsCalculate:Vt(e,"supportsCalculate",!1),supportsTruncate:Vt(e,"supportsTruncate",!1),supportsValidateSql:Vt(e,"supportsValidateSql",!1),supportsAdd:a,supportsDelete:l,supportsEditing:o,supportsChangeTracking:c,supportsQuery:r,supportsQueryAnalytics:Vt(h,"supportsQueryAnalytic",!1),supportsQueryAttachments:Vt(h,"supportsQueryAttachments",!1),supportsQueryBins:Vt(h,"supportsQueryBins",!1),supportsQueryTopFeatures:Vt(h,"supportsTopFeaturesQuery",!1),supportsResizeAttachments:Vt(e,"supportsAttachmentsResizing",!1),supportsSync:s.includes("sync"),supportsUpdate:u,supportsExceedsLimitStatistics:Vt(e,"supportsExceedsLimitStatistics",!1),supportsAsyncConvert3D:Vt(e,"supportsAsyncConvert3D",!1)}}function put(t,e){const i=t.advancedQueryCapabilities,s=t.ownershipBasedAccessControlForFeatures,n=t.archivingInfo,r=t.currentVersion,o=e==null?void 0:e.includes("MapServer"),a=!o||r>=ke("mapserver-pbf-version-support"),l=MO(e),u=new Set((t.supportedQueryFormats??"").split(",").map(c=>c.toLowerCase().trim()));return{maxRecordCount:NT(t,"maxRecordCount",void 0),maxRecordCountFactor:NT(t,"maxRecordCountFactor",void 0),standardMaxRecordCount:NT(t,"standardMaxRecordCount",void 0),supportedSpatialAggregationStatistics:out(i),supportsCacheHint:Vt(i,"supportsQueryWithCacheHint",!1)||PA(i,"query"),supportsCentroid:Vt(i,"supportsReturningGeometryCentroid",!1),supportsCompactGeometry:l,supportsCurrentUser:Vt(i,"supportsCurrentUserQueries",!1),supportsDefaultSpatialReference:Vt(i,"supportsDefaultSR",!1),supportsDisjointSpatialRelationship:Vt(i,"supportsDisjointSpatialRel",!1),supportsDistance:Vt(i,"supportsQueryWithDistance",!1),supportsDistinct:Vt(i,"supportsDistinct",t.supportsAdvancedQueries),supportsExtent:Vt(i,"supportsReturningQueryExtent",!1),supportsFormatPBF:a&&u.has("pbf"),supportsFullTextSearch:Vt(i,"supportsFullTextSearch",!1),supportsGeometryProperties:Vt(i,"supportsReturningGeometryProperties",!1),supportsHavingClause:Vt(i,"supportsHavingClause",!1),supportsHistoricMoment:Vt(n,"supportsQueryWithHistoricMoment",!1),supportsMaxRecordCountFactor:Vt(i,"supportsMaxRecordCountFactor",!1),supportsOrderBy:Vt(i,"supportsOrderBy",t.supportsAdvancedQueries),supportsPagination:Vt(i,"supportsPagination",!1),supportsPercentileStatistics:Vt(i,"supportsPercentileStatistics",!1),supportsQuantization:Vt(t,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:Vt(t,"supportsQuantizationEditMode",!1),supportsQueryByAnonymous:Vt(s,"allowAnonymousToQuery",!0),supportsQueryByOthers:Vt(s,"allowOthersToQuery",!0),supportsQueryGeometry:Vt(t,"supportsReturningQueryGeometry",!1),supportsResultType:Vt(i,"supportsQueryWithResultType",!1),supportsReturnMesh:!!tut(t.infoFor3D),supportsSpatialAggregationStatistics:Vt(i,"supportsSpatialAggregationStatistics",!1),supportsSqlExpression:Vt(i,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:Vt(t,"useStandardizedQueries",!1),supportsStatistics:Vt(i,"supportsStatistics",t.supportsStatistics),supportsTopFeaturesQuery:Vt(i,"supportsTopFeaturesQuery",!1),supportsTrueCurve:Vt(i,"supportsTrueCurve",!1),tileMaxRecordCount:NT(t,"tileMaxRecordCount",void 0)}}function fut(t){const e=t.advancedQueryCapabilities,i=Vt(e,"supportsAdvancedQueryRelated",!1);return{supportsPagination:Vt(e,"supportsQueryRelatedPagination",!1),supportsCount:i,supportsOrderBy:i,supportsCacheHint:PA(e,"queryRelated")}}function gut(t){return{supportsCacheHint:PA(t.advancedQueryCapabilities,"queryTopFilter")}}function _ut(t){const e=t?t.queryBinsCapabilities:void 0;return{supportsDate:Vt(e,"supportsDateBin",!1),supportsFixedInterval:Vt(e,"supportsFixedIntervalBin",!1),supportsAutoInterval:Vt(e,"supportsAutoIntervalBin",!1),supportsFixedBoundaries:Vt(e,"supportsFixedBoundariesBin",!1),supportsStackBy:Vt(e,"supportsStackBy",!1),supportsSplitBy:Vt(e,"supportsSplitBy",!1),supportsSnapToData:Vt(e,"supportsSnapToData",!1),supportsReturnFullIntervalBin:Vt(e,"supportsReturnFullIntervalBin",!1),supportsFirstDayOfWeek:Vt(e,"supportsFirstDayOfWeek",!1),supportsNormalization:Vt(e,"supportsNormalization",!1),supportedStatistics:aut(e),supportedNormalizationTypes:lut(e)}}function yut(t){const e=t.ownershipBasedAccessControlForFeatures,i=t?t.advancedEditingCapabilities:void 0;return{supportsGeometryUpdate:Vt(t,"allowGeometryUpdates",!0),supportsGlobalId:Vt(t,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:Vt(t,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:Vt(t,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:Vt(t,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:Vt(t,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:Vt(e,"allowAnonymousToDelete",!0),supportsDeleteByOthers:Vt(e,"allowOthersToDelete",!0),supportsUpdateByAnonymous:Vt(e,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:Vt(e,"allowOthersToUpdate",!0),supportsAsyncApplyEdits:Vt(i,"supportsAsyncApplyEdits",!1),zDefault:NT(t,"zDefault",void 0)}}function ISt(t){var e;return{operations:{supportsAppend:Vt(t,"supportsAppend",!1),supportsCoverageQuery:((e=t==null?void 0:t.playbackInfo)==null?void 0:e.klv["0601"])??!1,supportsExportClip:Vt(t,"supportsExportClip",!1),supportsExportFrameset:Vt(t,"supportsExportFrameset",!1),supportsMensuration:Vt(t,"supportsMensuration",!1),supportsUpdate:Vt(t,"supportsUpdate",!1)}}}let tf=class extends bs.ClonableMixin(it){constructor(e){super(e),this.code=null,this.defaultValues={},this.domains=null,this.name=null}readDomains(e){if(!e)return null;const i={};for(const s of Object.keys(e))i[s]=W4(e[s]);return i}writeDomains(e,i){var n;if(!e)return;const s={};for(const r of Object.keys(e))e[r]&&(s[r]=(n=e[r])==null?void 0:n.toJSON());i.domains=s}};y([S({type:Number,json:{write:!0}})],tf.prototype,"code",void 0),y([S({type:Object,json:{write:!0}})],tf.prototype,"defaultValues",void 0),y([S({json:{write:!0}})],tf.prototype,"domains",void 0),y([mt("domains")],tf.prototype,"readDomains",null),y([yt("domains")],tf.prototype,"writeDomains",null),y([S({type:String,json:{write:!0}})],tf.prototype,"name",void 0),tf=y([se("esri.layers.support.Subtype")],tf);const vut=tf,xut=t=>{let e=class extends t{constructor(){super(...arguments),this.copyright=null,this.capabilities=null,this.dateFieldsTimeZone=null,this.datesInUnknownTimezone=!1,this.definitionExpression=null,this.displayField=null,this.editFieldsInfo=null,this.editingInfo=null,this.elevationInfo=null,this.fieldsIndex=null,this.floorInfo=null,this.fullExtent=null,this.gdbVersion=null,this.geometryFieldsInfo=null,this.geometryType=null,this.globalIdField=null,this.hasM=void 0,this.hasZ=void 0,this.heightModelInfo=null,this.historicMoment=null,this.indexes=new(Nt.ofType(gm)),this.isTable=!1,this.layerId=void 0,this.maxScale=0,this.minScale=0,this.objectIdField=null,this.preferredTimeZone=null,this.relationships=null,this.returnM=void 0,this.returnZ=void 0,this.serviceDefinitionExpression=null,this.serviceItemId=null,this.sourceJSON=null,this.spatialReference=Ri.WGS84,this.subtypeField=null,this.subtypes=null,this.trackIdField=null,this.version=void 0}getFieldDomain(){throw new Error("Not implemented")}getField(i){return this.fieldsIndex.get(i)}get authenticationTriggerEvent(){if(!this.url)return null;const{capabilities:i}=this;if(i){const{query:n,operations:r,editing:o}=i;if(!n.supportsQueryByOthers||!n.supportsQueryByAnonymous||r.supportsEditing&&!(o.supportsUpdateByOthers&&o.supportsUpdateByAnonymous&&o.supportsDeleteByOthers&&o.supportsDeleteByAnonymous))return"load"}if(oF(this.serviceDefinitionExpression)||oF(this.definitionExpression))return"load";if(this.userHasUpdateItemPrivileges){if(Hlt(this))return"load";if(this.hasUpdateItemRestrictions)return i.operations.supportsQuery?"editing":"load"}if(this.userHasFullEditingPrivileges&&this.hasFullEditingRestrictions)return"editing";const s=this.editFieldsInfo;return(s!=null&&s.creatorField||s!=null&&s.editorField)&&(i!=null&&i.operations.supportsEditing)?"editing":null}readCapabilitiesFromService(i,s){return $be(s,this.url)}readEditingInfo(i,s){const{editingInfo:n}=s;return n?{lastEditDate:n.lastEditDate!=null?new Date(n.lastEditDate):null}:null}get effectiveCapabilities(){const i=this.capabilities;if(!i)return null;const s=be(i),{operations:n,editing:r}=s;return tO(this)?(this.userHasUpdateItemPrivileges&&(n.supportsQuery=!0),s):this.userHasUpdateItemPrivileges?(n.supportsAdd=n.supportsDelete=n.supportsEditing=n.supportsQuery=n.supportsUpdate=r.supportsDeleteByOthers=r.supportsGeometryUpdate=r.supportsUpdateByOthers=!0,s):(this.userHasFullEditingPrivileges&&n.supportsEditing&&(n.supportsAdd=n.supportsDelete=n.supportsUpdate=r.supportsGeometryUpdate=!0),s)}get effectiveEditingEnabled(){return!1}readGlobalIdFieldFromService(i,s){return Pbe(s)}get hasFullEditingRestrictions(){const i=this.capabilities;if(!i||tO(this))return!1;const{operations:s,editing:n}=i;return s.supportsEditing&&!(s.supportsAdd&&s.supportsDelete&&s.supportsUpdate&&n.supportsGeometryUpdate)}get hasUpdateItemRestrictions(){const i=this.capabilities;if(!i)return!1;const{operations:s,editing:n}=i;return tO(this)?!s.supportsQuery:!(s.supportsAdd&&s.supportsDelete&&s.supportsEditing&&s.supportsQuery&&s.supportsUpdate&&n.supportsDeleteByOthers&&n.supportsGeometryUpdate&&n.supportsUpdateByOthers)}readIsTableFromService(i,s){return s.type==="Table"}readMaxScale(i,s){return s.effectiveMaxScale||i||0}readMinScale(i,s){return s.effectiveMinScale||i||0}readObjectIdFieldFromService(i,s){return Mbe(s)}readServiceDefinitionExpression(i,s){return s.definitionQuery||s.definitionExpression}set url(i){if(i==null)return void this._set("url",i);const s=uTe({layer:this,url:i,nonStandardUrlAllowed:!0,logger:ht.getLogger(this)});this._set("url",s.url),s.layerId!=null&&this._set("layerId",s.layerId)}writeUrl(i,s,n,r){cTe(this,i,null,s,r)}readVersion(i,s){return Flt(s)}};return y([S({readOnly:!0})],e.prototype,"authenticationTriggerEvent",null),y([S({type:String,json:{origins:{service:{read:{source:"copyrightText"}}}}})],e.prototype,"copyright",void 0),y([S({readOnly:!0,json:{read:!1,origins:{service:{read:{source:["advancedQueryCapabilities","allowGeometryUpdates","allowUpdateWithoutMValues","archivingInfo","capabilities","datesInUnknownTimezone","hasAttachments","hasM","hasZ","isDataBranchVersioned","isDataVersioned","maxRecordCount","maxRecordCountFactor","ownershipBasedAccessControlForFeatures","standardMaxRecordCount","supportedQueryFormats","supportsAdvancedQueries","supportsApplyEditsWithGlobalIds","supportsAttachmentsByUploadId","supportsAttachmentsResizing","supportsCalculate","supportsCoordinatesQuantization","supportsExceedsLimitStatistics","supportsFieldDescriptionProperty","supportsQuantizationEditMode","supportsRollbackOnFailureParameter","supportsStatistics","supportsTruncate","supportsValidateSql","tileMaxRecordCount","useStandardizedQueries"]}}}}})],e.prototype,"capabilities",void 0),y([mt("service","capabilities")],e.prototype,"readCapabilitiesFromService",null),y([S(XO("dateFieldsTimeReference"))],e.prototype,"dateFieldsTimeZone",void 0),y([S({type:Boolean})],e.prototype,"datesInUnknownTimezone",void 0),y([S({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],e.prototype,"definitionExpression",void 0),y([S({type:String,json:{origins:{service:{read:{source:"displayField"}}}}})],e.prototype,"displayField",void 0),y([S({readOnly:!0,type:hat})],e.prototype,"editFieldsInfo",void 0),y([S({readOnly:!0})],e.prototype,"editingInfo",void 0),y([mt("editingInfo")],e.prototype,"readEditingInfo",null),y([S({readOnly:!0})],e.prototype,"effectiveCapabilities",null),y([S()],e.prototype,"effectiveEditingEnabled",null),y([S((()=>{const i=be(rat),s=i.json.origins;return s["web-map"]={read:!1,write:!1},s["portal-item"]={read:!1,write:!1},i})())],e.prototype,"elevationInfo",void 0),y([S()],e.prototype,"fieldsIndex",void 0),y([S({type:Zlt,json:{name:"layerDefinition.floorInfo",write:{layerContainerTypes:rr}}})],e.prototype,"floorInfo",void 0),y([S({type:Nn,json:{origins:{service:{read:{source:"extent"}}}}})],e.prototype,"fullExtent",void 0),y([S()],e.prototype,"gdbVersion",void 0),y([S({readOnly:!0,type:Wlt,json:{read:{source:"geometryProperties"}}})],e.prototype,"geometryFieldsInfo",void 0),y([S({type:["point","polygon","polyline","multipoint","multipatch","mesh"],json:{origins:{service:{read:D9.read}}}})],e.prototype,"geometryType",void 0),y([S({type:String})],e.prototype,"globalIdField",void 0),y([mt("service","globalIdField",["globalIdField","fields"])],e.prototype,"readGlobalIdFieldFromService",null),y([S({readOnly:!0})],e.prototype,"hasFullEditingRestrictions",null),y([S({type:Boolean,json:{origins:{service:{read:!0}}}})],e.prototype,"hasM",void 0),y([S({readOnly:!0})],e.prototype,"hasUpdateItemRestrictions",null),y([S({type:Boolean,json:{origins:{service:{read:!0}}}})],e.prototype,"hasZ",void 0),y([S({readOnly:!0,type:SA})],e.prototype,"heightModelInfo",void 0),y([S({type:Date})],e.prototype,"historicMoment",void 0),y([S({type:Nt.ofType(gm),readOnly:!0})],e.prototype,"indexes",void 0),y([S({readOnly:!0})],e.prototype,"isTable",void 0),y([mt("service","isTable",["type"])],e.prototype,"readIsTableFromService",null),y([S({type:Number,json:{origins:{service:{read:{source:"id"}},"portal-item":{read:!1,write:{target:"id"}}},read:!1}})],e.prototype,"layerId",void 0),y([S(uat)],e.prototype,"maxScale",void 0),y([mt("service","maxScale",["maxScale","effectiveMaxScale"])],e.prototype,"readMaxScale",null),y([S(lat)],e.prototype,"minScale",void 0),y([mt("service","minScale",["minScale","effectiveMinScale"])],e.prototype,"readMinScale",null),y([S({type:String})],e.prototype,"objectIdField",void 0),y([mt("service","objectIdField",["objectIdField","fields"])],e.prototype,"readObjectIdFieldFromService",null),y([S(XO("preferredTimeReference"))],e.prototype,"preferredTimeZone",void 0),y([S({type:[Klt],readOnly:!0})],e.prototype,"relationships",void 0),y([S({type:Boolean})],e.prototype,"returnM",void 0),y([S({type:Boolean})],e.prototype,"returnZ",void 0),y([S({readOnly:!0,json:{write:!1}})],e.prototype,"serverGens",void 0),y([S({readOnly:!0})],e.prototype,"serviceDefinitionExpression",void 0),y([mt("service","serviceDefinitionExpression",["definitionQuery","definitionExpression"])],e.prototype,"readServiceDefinitionExpression",null),y([S({type:String,readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],e.prototype,"serviceItemId",void 0),y([S()],e.prototype,"sourceJSON",void 0),y([S({type:Ri,json:{origins:{service:{read:{source:"extent.spatialReference"}}}}})],e.prototype,"spatialReference",void 0),y([S({type:String,readOnly:!0,json:{origins:{service:{read:!0}}}})],e.prototype,"subtypeField",void 0),y([S({type:[vut],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],e.prototype,"subtypes",void 0),y([S({type:String,json:{read:{source:"timeInfo.trackIdField"}}})],e.prototype,"trackIdField",void 0),y([S(sat)],e.prototype,"url",null),y([yt("url")],e.prototype,"writeUrl",null),y([S({json:{origins:{service:{read:!0}},read:!1}})],e.prototype,"version",void 0),y([mt("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"])],e.prototype,"readVersion",null),e=y([se("esri.layers.mixins.FeatureLayerBase")],e),e};let tw=class extends bs.ClonableMixin(it){constructor(e){super(e),this.expression=null,this.title=null,this.returnType=null}};y([S({type:String,json:{write:!0}})],tw.prototype,"expression",void 0),y([S({type:String,json:{write:!0}})],tw.prototype,"title",void 0),y([S({type:String,json:{write:!0}})],tw.prototype,"returnType",void 0),tw=y([se("esri.layers.support.ExpressionInfo")],tw);const pX=tw;var R9;let sf=R9=class extends it{constructor(t){super(t),this.isAutoGenerated=!1,this.name=null,this.alias=null,this.onStatisticField=null,this.onStatisticExpression=null,this.statisticType=null}clone(){return new R9({name:this.name,alias:this.alias,isAutoGenerated:this.isAutoGenerated,onStatisticExpression:be(this.onStatisticExpression),onStatisticField:this.onStatisticField,statisticType:this.statisticType})}};y([S({type:Boolean,json:{write:!0}})],sf.prototype,"isAutoGenerated",void 0),y([S({type:String,json:{write:!0}})],sf.prototype,"name",void 0),y([S({type:String,json:{write:!0}})],sf.prototype,"alias",void 0),y([S({type:String,json:{write:!0}})],sf.prototype,"onStatisticField",void 0),y([S({type:pX,json:{write:!0}})],sf.prototype,"onStatisticExpression",void 0),y([S({type:String,json:{write:!0}})],sf.prototype,"statisticType",void 0),sf=R9=y([se("esri.layers.support.AggregateField")],sf);const Ry=sf;let dy=class extends it{constructor(){super(...arguments),this.type=null}};y([S({type:["selection","cluster","binning"],readOnly:!0,json:{read:!1,write:!0}})],dy.prototype,"type",void 0),dy=y([se("esri.layers.support.FeatureReduction")],dy);const fX="__begin__",gX="__end__",but=new RegExp(fX,"ig"),wut=new RegExp(gX,"ig"),Goe=new RegExp("^"+fX,"i"),Boe=new RegExp(gX+"$","i"),aF='"',Sut=aF+" + ",Eut=" + "+aF;function Cut(t){return t.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function Tut(t){return t.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function _X(t){const e={expression:"",type:"none"};return t.labelExpressionInfo?t.labelExpressionInfo.value?(e.expression=t.labelExpressionInfo.value,e.type="conventional"):t.labelExpressionInfo.expression&&(e.expression=t.labelExpressionInfo.expression,e.type="arcade"):t.labelExpression!=null&&(e.expression=Cut(t.labelExpression),e.type="conventional"),e}function Put(t){const e=_X(t);switch(e.type){case"conventional":return O9(e.expression);case"arcade":return e.expression}return null}function Mut(t){const e=_X(t);switch(e.type){case"conventional":return Iut(e.expression);case"arcade":return Ube(e.expression)}return null}function O9(t){let e;return t?(e=_F(t,i=>fX+'$feature["'+i+'"]'+gX),e=Goe.test(e)?e.replace(Goe,""):aF+e,e=Boe.test(e)?e.replace(Boe,""):e+aF,e=e.replaceAll(but,Sut).replaceAll(wut,Eut)):e='""',e}const Aut=/^\s*\{([^}]+)\}\s*$/i;function Iut(t){const e=t==null?void 0:t.match(Aut);return(e==null?void 0:e[1].trim())||null}const Dut=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*$/i,Nut=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])(.+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,Rut=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(.+)(\1)\s*\));?\s*$/i;function Ube(t){if(!t)return null;let e=Dut.exec(t)||Nut.exec(t);return e?e[1]||e[3]:(e=Rut.exec(t),e?e[2]:null)}var L9;let P_=L9=class extends it{constructor(){super(...arguments),this.expression=null,this.title=null,this.value=null}readExpression(t,e){return e.value?O9(e.value):t}writeExpression(t,e,i){this.value!=null&&(t=O9(this.value)),t!=null&&(e[i]=t)}clone(){return new L9({expression:this.expression,title:this.title,value:this.value})}};y([S({type:String,json:{write:{writerEnsuresNonNull:!0}}})],P_.prototype,"expression",void 0),y([mt("expression",["expression","value"])],P_.prototype,"readExpression",null),y([yt("expression")],P_.prototype,"writeExpression",null),y([S({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],P_.prototype,"title",void 0),y([S({json:{read:!1,write:!1}})],P_.prototype,"value",void 0),P_=L9=y([se("esri.layers.support.LabelExpressionInfo")],P_);const Vbe=P_;var F9;const hR=new gs({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function dR(t,e,i){return{enabled:!B8(i==null?void 0:i.layer)}}function zbe(t){var e;return!t||t.origin!=="service"&&((e=t.layer)==null?void 0:e.type)!=="map-image"}function Out(t){return(t==null?void 0:t.type)==="map-image"}function Gbe(t){var e,i;return!!Out(t)&&!!((i=(e=t.capabilities)==null?void 0:e.exportMap)!=null&&i.supportsArcadeExpressionForLabeling)}function Lut(t){return zbe(t)||Gbe(t==null?void 0:t.layer)}let kr=F9=class extends it{static evaluateWhere(t,e){const i=(s,n,r)=>{switch(n){case"=":return s==r;case"<>":return s!=r;case">":return s>r;case">=":return s>=r;case"<":return s<r;case"<=":return s<=r}return!1};try{if(t==null)return!0;const s=t.split(" ");if(s.length===3)return i(e[s[0]],s[1],s[2]);if(s.length===7){const n=i(e[s[0]],s[1],s[2]),r=s[3],o=i(e[s[4]],s[5],s[6]);switch(r){case"AND":return n&&o;case"OR":return n||o}}return!1}catch{}}constructor(t){super(t),this.type="label",this.name=null,this.allowOverrun=!1,this.deconflictionStrategy="static",this.labelExpression=null,this.labelExpressionInfo=null,this.labelPlacement=null,this.labelPosition="curved",this.maxScale=0,this.minScale=0,this.repeatLabel=!0,this.repeatLabelDistance=null,this.symbol=Jat,this.useCodedValues=void 0,this.where=null}readLabelExpression(t,e){const i=e.labelExpressionInfo;if(!i||!i.value&&!i.expression)return t}writeLabelExpression(t,e,i){if(this.labelExpressionInfo){if(this.labelExpressionInfo.value!=null)t=Tut(this.labelExpressionInfo.value);else if(this.labelExpressionInfo.expression!=null){const s=Ube(this.labelExpressionInfo.expression);s&&(t="["+s+"]")}}t!=null&&(e[i]=t)}writeLabelExpressionInfo(t,e,i,s){if(t==null&&this.labelExpression!=null&&zbe(s))t=new Vbe({expression:this.getLabelExpressionArcade()});else if(!t)return;const n=t.toJSON(s);n.expression&&(e[i]=n)}writeMaxScale(t,e){(t||this.minScale)&&(e.maxScale=t)}writeMinScale(t,e){(t||this.maxScale)&&(e.minScale=t)}getLabelExpression(){return _X(this)}getLabelExpressionArcade(){return Put(this)}getLabelExpressionSingleField(){return Mut(this)}hash(){return JSON.stringify(this)}clone(){return new F9({allowOverrun:this.allowOverrun,deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:be(this.labelExpressionInfo),labelPosition:this.labelPosition,labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,repeatLabel:this.repeatLabel,repeatLabelDistance:this.repeatLabelDistance,symbol:be(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}};y([S({type:String,json:{write:!0}})],kr.prototype,"name",void 0),y([S({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1},"portal-item":{default:!1,write:{overridePolicy:dR}}}}})],kr.prototype,"allowOverrun",void 0),y([S({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1},"portal-item":{default:"static",write:{overridePolicy:dR}}}}})],kr.prototype,"deconflictionStrategy",void 0),y([S({type:String,json:{write:{overridePolicy(t,e,i){return this.labelExpressionInfo&&(i==null?void 0:i.origin)==="service"&&Gbe(i.layer)?{enabled:!1}:{allowNull:!0}}}}})],kr.prototype,"labelExpression",void 0),y([mt("labelExpression")],kr.prototype,"readLabelExpression",null),y([yt("labelExpression")],kr.prototype,"writeLabelExpression",null),y([S({type:Vbe,json:{write:{overridePolicy:(t,e,i)=>Lut(i)?{allowNull:!0}:{enabled:!1}}}})],kr.prototype,"labelExpressionInfo",void 0),y([yt("labelExpressionInfo")],kr.prototype,"writeLabelExpressionInfo",null),y([S({type:hR.apiValues,json:{type:hR.jsonValues,read:hR.read,write:hR.write}})],kr.prototype,"labelPlacement",void 0),y([S({type:["curved","parallel"],json:{write:!0,origins:{"web-map":{write:!1},"web-scene":{write:!1},"portal-item":{write:!1}}}})],kr.prototype,"labelPosition",void 0),y([S({type:Number})],kr.prototype,"maxScale",void 0),y([yt("maxScale")],kr.prototype,"writeMaxScale",null),y([S({type:Number})],kr.prototype,"minScale",void 0),y([yt("minScale")],kr.prototype,"writeMinScale",null),y([S({type:Boolean,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:dR}}}}})],kr.prototype,"repeatLabel",void 0),y([S({type:Number,cast:Ps,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:dR}}}}})],kr.prototype,"repeatLabelDistance",void 0),y([S({types:_Re,json:{origins:{"web-scene":{types:yRe,write:Aoe,default:null}},write:Aoe,default:null}})],kr.prototype,"symbol",void 0),y([S({type:Boolean,json:{write:!0}})],kr.prototype,"useCodedValues",void 0),y([S({type:String,json:{write:!0}})],kr.prototype,"where",void 0),kr=F9=y([se("esri.layers.support.LabelClass")],kr);const MA=kr;var k9;let M_=k9=class extends it{constructor(t){super(t),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){var t;return new k9({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:((t=this.symbol)==null?void 0:t.clone())??null})}getMeshHash(){const t=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${t}`}};y([S({type:String,json:{write:!0}})],M_.prototype,"description",void 0),y([S({type:String,json:{write:!0}})],M_.prototype,"label",void 0),y([S({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],M_.prototype,"minValue",void 0),y([S({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],M_.prototype,"maxValue",void 0),y([S(rX)],M_.prototype,"symbol",void 0),M_=k9=y([se("esri.renderers.support.ClassBreakInfo")],M_);const lF=M_;var $9;const Bbe="log",iO="percent-of-total",sO="field",mR=new gs({esriNormalizeByLog:Bbe,esriNormalizeByPercentOfTotal:iO,esriNormalizeByField:sO}),Fut=xo(lF);let co=$9=class extends cE(Kf){constructor(t){super(t),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(t,e,i){if(!Array.isArray(t))return;let s=e.minValue;return t.map(n=>{const r=new lF;return r.read(n,i),r.minValue==null&&(r.minValue=s),r.maxValue==null&&(r.maxValue=r.minValue),s=r.maxValue,r})}writeClassBreakInfos(t,e,i,s){const n=t.map(r=>r.write({},s));this._areClassBreaksConsecutive()&&n.forEach(r=>delete r.classMinValue),e[i]=n}castField(t){return t==null?t:typeof t=="function"?(ht.getLogger(this).error(".field: field must be a string value"),null):OM(t)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let t=this._get("normalizationType");const e=!!this.normalizationField,i=this.normalizationTotal!=null;return e||i?(t=e&&sO||i&&iO||null,e&&i&&ht.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):t!==sO&&t!==iO||(t=null),t}set normalizationType(t){this._set("normalizationType",t)}addClassBreakInfo(t,e,i){let s=null;s=typeof t=="number"?new lF({minValue:t,maxValue:e,symbol:qme(i)}):Fut(be(t)),this.classBreakInfos.push(s),this.classBreakInfos.length===1&&this.notifyChange("minValue")}removeClassBreakInfo(t,e){const i=this.classBreakInfos.length;for(let s=0;s<i;s++){const n=[this.classBreakInfos[s].minValue,this.classBreakInfos[s].maxValue];if(n[0]===t&&n[1]===e){this.classBreakInfos.splice(s,1);break}}}getBreakIndex(t,e){return this.valueExpression&&(e==null?void 0:e.arcade)==null&&ht.getLogger(this).warn(""),this.valueExpression?this._getBreakIndexForExpression(t,e):this._getBreakIndexForField(t)}async getClassBreakInfo(t,e){let i=e;this.valueExpression&&(e==null?void 0:e.arcade)==null&&(i={...i,arcade:await gy()});const s=this.getBreakIndex(t,i);return s!==-1?this.classBreakInfos[s]:null}getSymbol(t,e){if(this.valueExpression&&(e==null?void 0:e.arcade)==null)return void ht.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this.getBreakIndex(t,e);return i>-1?this.classBreakInfos[i].symbol:this.defaultSymbol}async getSymbolAsync(t,e){let i=e;if(this.valueExpression&&(e==null?void 0:e.arcade)==null){const n=await gy(),{arcadeUtils:r}=n;r.hasGeometryOperations(this.valueExpression)&&await r.enableGeometryOperations(),i={...i,arcade:n}}const s=this.getBreakIndex(t,i);return s>-1?this.classBreakInfos[s].symbol:this.defaultSymbol}get symbols(){const t=[];return this.classBreakInfos.forEach(e=>{e.symbol&&t.push(e.symbol)}),this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){var t;return((t=this.visualVariables)==null?void 0:t.reduce((e,i)=>e+i.getAttributeHash(),""))??""}getMeshHash(){const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),i=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${t}.${e}.${this.classBreakInfos.reduce((s,n)=>s+n.getMeshHash(),"")}.${i}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){var t,e;return new $9({field:this.field,backgroundFillSymbol:(t=this.backgroundFillSymbol)==null?void 0:t.clone(),defaultLabel:this.defaultLabel,defaultSymbol:(e=this.defaultSymbol)==null?void 0:e.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:be(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:be(this.visualVariables),legendOptions:be(this.legendOptions),authoringInfo:be(this.authoringInfo)})}async collectRequiredFields(t,e){const i=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(i)}async collectSymbolFields(t,e){const i=[...this.symbols.map(s=>s.collectRequiredFields(t,e)),al(t,e,this.valueExpression)];Ll(t,e,this.field),Ll(t,e,this.normalizationField),await Promise.all(i)}_getBreakIndexForExpression(t,e){const{viewingMode:i,scale:s,spatialReference:n,arcade:r,timeZone:o}=e??{},{valueExpression:a}=this;let l=this._compiledValueExpression.valueExpression===a?this._compiledValueExpression.compiledFunction:null;const u=r.arcadeUtils;if(!l){const h=u.createSyntaxTree(a);l=u.createFunction(h),this._compiledValueExpression.compiledFunction=l}this._compiledValueExpression.valueExpression=a;const c=u.executeFunction(l,u.createExecContext(t,u.getViewInfo({viewingMode:i,scale:s,spatialReference:n}),o));return this._getBreakIndexfromInfos(c)}_getBreakIndexForField(t){const e=this.field,i=t.attributes,s=this.normalizationType;let n=parseFloat(i[e]);if(s){const r=this.normalizationTotal,o=parseFloat(this.normalizationField?i[this.normalizationField]:void 0);if(s===Bbe)n=Math.log(n)*Math.LOG10E;else if(s!==iO||r==null||isNaN(r)){if(s===sO&&!isNaN(o)){if(isNaN(n)||isNaN(o))return-1;n/=o}}else n=n/r*100}return this._getBreakIndexfromInfos(n)}_getBreakIndexfromInfos(t){const e=this.isMaxInclusive;if(t!=null&&typeof t=="number"&&!isNaN(t))for(let i=0;i<this.classBreakInfos.length;i++){const s=[this.classBreakInfos[i].minValue,this.classBreakInfos[i].maxValue];if(s[0]<=t&&(e?t<=s[1]:t<s[1]))return i}return-1}_areClassBreaksConsecutive(){const t=this.classBreakInfos,e=t.length;for(let i=1;i<e;i++)if(t[i-1].maxValue!==t[i].minValue)return!1;return!0}};y([S(oX)],co.prototype,"backgroundFillSymbol",void 0),y([S({type:[lF],json:{write:{isRequired:!0}}})],co.prototype,"classBreakInfos",void 0),y([mt("classBreakInfos")],co.prototype,"readClassBreakInfos",null),y([yt("classBreakInfos")],co.prototype,"writeClassBreakInfos",null),y([S({type:String,json:{write:!0}})],co.prototype,"defaultLabel",void 0),y([S(gk)],co.prototype,"defaultSymbol",void 0),y([S({type:String,json:{write:!0}})],co.prototype,"field",void 0),y([Ls("field")],co.prototype,"castField",null),y([S({type:Boolean})],co.prototype,"isMaxInclusive",void 0),y([S({type:aX,json:{write:!0}})],co.prototype,"legendOptions",void 0),y([S({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return this.classBreakInfos.length!==0&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],co.prototype,"minValue",null),y([S({type:String,json:{write:!0}})],co.prototype,"normalizationField",void 0),y([S({type:Number,json:{write:!0}})],co.prototype,"normalizationTotal",void 0),y([S({type:mR.apiValues,value:null,json:{type:mR.jsonValues,read:mR.read,write:mR.write}})],co.prototype,"normalizationType",null),y([ai({classBreaks:"class-breaks"})],co.prototype,"type",void 0),y([S({type:String,json:{write:!0}})],co.prototype,"valueExpression",void 0),y([S({type:String,json:{write:!0}})],co.prototype,"valueExpressionTitle",void 0),co=$9=y([se("esri.renderers.ClassBreaksRenderer")],co);const qbe=co,U9=-3,kut=U9-1;var hf;(function(t){t[t.ALL=0]="ALL",t[t.SOME=1]="SOME"})(hf||(hf={}));let $ut=class{get size(){return this._size}constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new jv,this._users=new jv}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear()}register(e){this._users.push(e)}deregister(e){this._users.removeUnordered(e)}registerRemoveFunc(e,i){this._removeFuncs.push([e,i])}deregisterRemoveFunc(e){this._removeFuncs.filterInPlace(i=>i[0]!==e)}get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=Math.max(e,-1),this._checkSize()}getSize(e,i){const s=this._db.get(e.id+i);return(s==null?void 0:s.size)??0}put(e,i,s,n,r){i=e.id+i;const o=this._db.get(i);if(o&&(this._size-=o.size,e.size-=o.size,this._db.delete(i),o.entry!==s&&this._notifyRemove(i,o.entry,o.size,hf.ALL)),n>this._maxSize)return void this._notifyRemove(i,s,n,hf.ALL);if(s===void 0)return void console.warn("Refusing to cache undefined entry ");if(!n||n<0)return console.warn(`Refusing to cache entry with size ${n} for key ${i}`),void this._notifyRemove(i,s,0,hf.ALL);const a=1+Math.max(r,kut)-U9;this._db.set(i,new Uut(s,n,a)),this._size+=n,e.size+=n,this._checkSize()}updateSize(e,i,s,n){i=e.id+i;const r=this._db.get(i);if(r&&r.entry===s){for(this._size-=r.size,e.size-=r.size;n>this._maxSize;){const o=this._notifyRemove(i,s,n,hf.SOME);if(!(o!=null&&o>0))return void this._db.delete(i);n=o}r.size=n,this._size+=n,e.size+=n,this._checkSize()}}pop(e,i){i=e.id+i;const s=this._db.get(i);if(s)return this._size-=s.size,e.size-=s.size,this._db.delete(i),++this._hit,s.entry;++this._miss}get(e,i){i=e.id+i;const s=this._db.get(i);if(s!==void 0)return this._db.delete(i),s.lives=s.lifetime,this._db.set(i,s),++this._hit,s.entry;++this._miss}peek(e,i){const s=this._db.get(e.id+i);return s?++this._hit:++this._miss,s==null?void 0:s.entry}get performanceInfo(){const e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},i={},s=new Array;this._db.forEach((o,a)=>{const l=o.lifetime;s[l]=(s[l]||0)+o.size,this._users.forAll(u=>{const{id:c,name:h}=u;if(a.startsWith(c)){const d=i[h]||0;i[h]=d+o.size}})});const n={};this._users.forAll(o=>{const a=o.name;if("hitRate"in o&&typeof o.hitRate=="number"&&!isNaN(o.hitRate)&&o.hitRate>0){const l=i[a]||0;i[a]=l,n[a]=Math.round(100*o.hitRate)+"%"}else n[a]="0%"});const r=Object.keys(i);r.sort((o,a)=>i[a]-i[o]),r.forEach(o=>e[o]=Math.round(i[o]/2**20)+"MB / "+n[o]);for(let o=s.length-1;o>=0;--o){const a=s[o];a&&(e["Priority "+(o+U9-1)]=Math.round(a/this._size*100)+"%")}return e}resetStats(){this._hit=this._miss=0,this._users.forAll(e=>e.resetHitRate())}clear(e){const i=e.id;this._db.forEach((s,n)=>{n.startsWith(i)&&(this._size-=s.size,this._db.delete(n),this._notifyRemove(n,s.entry,s.size,hf.ALL))}),e.size=0}clearAll(){this._db.forEach((e,i)=>this._notifyRemove(i,e.entry,e.size,hf.ALL)),this._users.forAll(e=>e.size=0),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(e,i,s,n){let r;return this._removeFuncs.some(o=>{if(e.startsWith(o[0])){const a=o[1](i,n,s);return typeof a=="number"&&(r=a),!0}return!1}),r}_checkSize(){this._users.forAll(e=>this._checkSizeLimits(e)),this._checkSizeLimits()}_checkSizeLimits(e){const i=e??this;if(i.maxSize<0||i.size<=i.maxSize)return;const s=e==null?void 0:e.id;let n=!0;for(;n;){n=!1;for(const[r,o]of this._db)if(o.lifetime===0&&(!s||r.startsWith(s))){if(this._purgeItem(r,o,e),i.size<=.9*i.maxSize)return;n||(n=this._db.has(r))}}for(const[r,o]of this._db)if((!s||r.startsWith(s))&&(this._purgeItem(r,o,e),i.size<=.9*i.maxSize))return}_purgeItem(e,i,s=this._users.find(n=>e.startsWith(n.id))){if(this._db.delete(e),i.lives<=1){this._size-=i.size,s&&(s.size-=i.size);const n=this._notifyRemove(e,i.entry,i.size,hf.SOME);n!=null&&n>0&&(this._size+=n,s&&(s.size+=n),i.lives=i.lifetime,i.size=n,this._db.set(e,i))}else--i.lives,this._db.set(e,i)}},Uut=class{constructor(e,i,s){this.entry=e,this.size=i,this.lifetime=s,this.lives=s}},Vut=class{constructor(e,i){this._storage=new $ut,this.id="",this.name="",this.size=0,this._storage.maxSize=e,this._storage.register(this),i&&this._storage.registerRemoveFunc("",i)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(e,i,s=1){this._storage.put(this,e,i,s,1)}pop(e){return this._storage.pop(this,e)}get(e){return this._storage.get(this,e)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(e){this._storage.maxSize=e}resetHitRate(){}};function zut(t){return"timeZone"in t}function Gut(t){return"timeZone"in t}function But(t){return"dateFieldsTimeZone"in t}const qut=new Map;let Hbe=class nO{static fromJSON(e){return new nO(e.fields,e.timeZoneByFieldName)}static fromLayer(e){return new nO(e.fields??[],Hoe(e))}static fromLayerJSON(e){return new nO(e.fields??[],Hoe(e))}constructor(e=[],i){var n;this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=e||[],this._timeZoneByFieldName=i?new Map(i):null;const s=[];for(const r of this.fields){const o=r==null?void 0:r.name,a=qoe(o);if(o&&a){const l=Nv(o);this._fieldsMap.set(o,r),this._fieldsMap.set(l,r),this._normalizedFieldsMap.set(a,r),s.push(`${l}:${r.type}:${(n=this._timeZoneByFieldName)==null?void 0:n.get(o)}`),dDe(r)?(this.dateFields.push(r),this._dateFieldsSet.add(r)):Nde(r)&&(this._numericFieldsSet.add(r),this.numericFields.push(r)),DQ(r)||NQ(r)||(r.editable=r.editable==null||!!r.editable,r.nullable=r.nullable==null||!!r.nullable)}}s.sort(),this.uid=s.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const e of this.fields)DQ(e)||NQ(e)||e.nullable||tDe(e)!==void 0||this._requiredFields.push(e)}return this._requiredFields}equals(e){return this.uid===(e==null?void 0:e.uid)}has(e){return this.get(e)!=null}get(e){if(!e)return;let i=this._fieldsMap.get(e);return i||(i=this._fieldsMap.get(Nv(e))??this._normalizedFieldsMap.get(qoe(e)),i&&this._fieldsMap.set(e,i),i)}getTimeZone(e){const i=this.get(e&&typeof e!="string"?e.name:e);return i?this._timeZoneByFieldName?this._timeZoneByFieldName.get(i.name):i.type==="date"||i.type==="esriFieldTypeDate"?(ht.getLogger("esri.layers.support.FieldsIndex").errorOnce(new Se("getTimeZone:no-timezone-information",`no time zone information for field '${i.name}'`)),_y):jbe.has(i.type)?p1:null:null}getLuxonTimeZone(e){const i=this.getTimeZone(e);return i?i===p1?td.instance:i===_y?ra.utcInstance:RM(qut,i,()=>Eu.create(i)):null}isDateField(e){return this._dateFieldsSet.has(this.get(e))}isTimeOnlyField(e){return mDe(this.get(e))}isNumericField(e){return this._numericFieldsSet.has(this.get(e))}normalizeFieldName(e){var i;return((i=this.get(e))==null?void 0:i.name)??void 0}toJSON(){return{fields:this.fields.map(e=>it.isSerializable(e)?e.toJSON():e),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}};function Nv(t){return t.trim().toLowerCase()}function qoe(t){var e;return((e=zIe(t))==null?void 0:e.toLowerCase())??""}const jbe=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function Hoe(t){const e=new Map;if(!t.fields)return e;const i=t.datesInUnknownTimezone===!0,{timeInfo:s,editFieldsInfo:n}=t,r=(s?"startField"in s?s.startField:s.startTimeField:"")??"",o=(s?"endField"in s?s.endField:s.endTimeField:"")??"",a=But(t)?t.dateFieldsTimeZone??null:t.dateFieldsTimeReference?kR(t.dateFieldsTimeReference):null,l=n?zut(n)?n.timeZone??a:n.dateFieldsTimeReference?kR(n.dateFieldsTimeReference):a??_y:null,u=s?Gut(s)?s.timeZone??a:s.timeReference?kR(s.timeReference):a:null,c=new Map([[Nv((n==null?void 0:n.creationDateField)??""),l],[Nv((n==null?void 0:n.editDateField)??""),l],[Nv(r),u],[Nv(o),u]]);for(const{name:h,type:d}of t.fields)if(jbe.has(d))e.set(h,p1);else if(d!=="date"&&d!=="esriFieldTypeDate")e.set(h,null);else if(i)e.set(h,p1);else{const m=c.get(Nv(h??""))??a;e.set(h,m)}return e}var joe,Yoe,Xoe,Woe,Zoe,Koe,Qoe,Joe,eae,tae,V9,z9,iae,sae,nae,rae,oae,aae,lae,uae,cae,hae,dae,mae,pae,fae,gae,_ae,yae,vae,xae,bae,wae,Sae,Eae,Cae,Tae,Pae,Mae,Aae,Iae,Dae,Nae,Rae,Oae,Lae,Fae,kae,$ae,Uae,Vae,zae,Gae,Bae,qae,uF,Hae,jae,Yae,Xae,Wae,Zae,Kae;(function(t){t[t.BUTT=0]="BUTT",t[t.ROUND=1]="ROUND",t[t.SQUARE=2]="SQUARE",t[t.UNKNOWN=4]="UNKNOWN"})(joe||(joe={})),function(t){t[t.BEVEL=0]="BEVEL",t[t.ROUND=1]="ROUND",t[t.MITER=2]="MITER",t[t.UNKNOWN=4]="UNKNOWN"}(Yoe||(Yoe={})),function(t){t[t.SCREEN=0]="SCREEN",t[t.MAP=1]="MAP"}(Xoe||(Xoe={})),function(t){t[t.Tint=0]="Tint",t[t.Ignore=1]="Ignore",t[t.Multiply=99]="Multiply"}(Woe||(Woe={})),function(t){t.Both="Both",t.JustBegin="JustBegin",t.JustEnd="JustEnd",t.None="None"}(Zoe||(Zoe={})),function(t){t[t.Mosaic=0]="Mosaic",t[t.Centered=1]="Centered"}(Koe||(Koe={})),function(t){t[t.Normal=0]="Normal",t[t.Superscript=1]="Superscript",t[t.Subscript=2]="Subscript"}(Qoe||(Qoe={})),function(t){t[t.MSSymbol=0]="MSSymbol",t[t.Unicode=1]="Unicode"}(Joe||(Joe={})),function(t){t[t.Unspecified=0]="Unspecified",t[t.TrueType=1]="TrueType",t[t.PSOpenType=2]="PSOpenType",t[t.TTOpenType=3]="TTOpenType",t[t.Type1=4]="Type1"}(eae||(eae={})),function(t){t[t.Display=0]="Display",t[t.Map=1]="Map"}(tae||(tae={})),function(t){t.None="None",t.Loop="Loop",t.Oscillate="Oscillate"}(V9||(V9={})),function(t){t.Linear="Linear",t.EaseIn="EaseIn",t.EaseOut="EaseOut",t.EaseInOut="EaseInOut"}(z9||(z9={})),function(t){t[t.Z=0]="Z",t[t.X=1]="X",t[t.Y=2]="Y"}(iae||(iae={})),function(t){t[t.XYZ=0]="XYZ",t[t.ZXY=1]="ZXY",t[t.YXZ=2]="YXZ"}(sae||(sae={})),function(t){t[t.Rectangle=0]="Rectangle",t[t.RoundedRectangle=1]="RoundedRectangle",t[t.Oval=2]="Oval"}(nae||(nae={})),function(t){t[t.None=0]="None",t[t.Alpha=1]="Alpha",t[t.Screen=2]="Screen",t[t.Multiply=3]="Multiply",t[t.Add=4]="Add"}(rae||(rae={})),function(t){t[t.TTB=0]="TTB",t[t.RTL=1]="RTL",t[t.BTT=2]="BTT"}(oae||(oae={})),function(t){t[t.None=0]="None",t[t.SignPost=1]="SignPost",t[t.FaceNearPlane=2]="FaceNearPlane"}(aae||(aae={})),function(t){t[t.Float=0]="Float",t[t.String=1]="String",t[t.Boolean=2]="Boolean"}(lae||(lae={})),function(t){t[t.Intersect=0]="Intersect",t[t.Subtract=1]="Subtract"}(uae||(uae={})),function(t){t.OpenEnded="OpenEnded",t.Block="Block",t.Crossed="Crossed"}(cae||(cae={})),function(t){t.FullGeometry="FullGeometry",t.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment",t.ReversedFirstSegment="ReversedFirstSegment",t.PerpendicularToSecondSegment="PerpendicularToSecondSegment",t.SecondSegmentWithTicks="SecondSegmentWithTicks",t.DoublePerpendicular="DoublePerpendicular",t.OppositeToFirstSegment="OppositeToFirstSegment",t.TriplePerpendicular="TriplePerpendicular",t.HalfCircleFirstSegment="HalfCircleFirstSegment",t.HalfCircleSecondSegment="HalfCircleSecondSegment",t.HalfCircleExtended="HalfCircleExtended",t.OpenCircle="OpenCircle",t.CoverageEdgesWithTicks="CoverageEdgesWithTicks",t.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks",t.GapExtentMidline="GapExtentMidline",t.Chevron="Chevron",t.PerpendicularWithArc="PerpendicularWithArc",t.ClosedHalfCircle="ClosedHalfCircle",t.TripleParallelExtended="TripleParallelExtended",t.ParallelWithTicks="ParallelWithTicks",t.Parallel="Parallel",t.PerpendicularToFirstSegment="PerpendicularToFirstSegment",t.ParallelOffset="ParallelOffset",t.OffsetOpposite="OffsetOpposite",t.OffsetSame="OffsetSame",t.CircleWithArc="CircleWithArc",t.DoubleJog="DoubleJog",t.PerpendicularOffset="PerpendicularOffset",t.LineExcludingLastSegment="LineExcludingLastSegment",t.MultivertexArrow="MultivertexArrow",t.CrossedArrow="CrossedArrow",t.ChevronArrow="ChevronArrow",t.ChevronArrowOffset="ChevronArrowOffset",t.PartialFirstSegment="PartialFirstSegment",t.Arch="Arch",t.CurvedParallelTicks="CurvedParallelTicks",t.Arc90Degrees="Arc90Degrees",t.TipWithPerpendicularAndTicks="TipWithPerpendicularAndTicks",t.ConcentricCircles="ConcentricCircles",t.DoubleJogArrow="DoubleJogArrow",t.LinkedChevrons="LinkedChevrons",t.SegmentThenHalfCircle="SegmentThenHalfCircle",t.LineWithStraightTicks="LineWithStraightTicks",t.DoubleCurve="DoubleCurve",t.ParallelWithTicksByWidth="ParallelWithTicksByWidth",t.EnclosingRoundedRectangle="EnclosingRoundedRectangle"}(hae||(hae={})),function(t){t.Mitered="Mitered",t.Bevelled="Bevelled",t.Rounded="Rounded",t.Square="Square",t.TrueBuffer="TrueBuffer"}(dae||(dae={})),function(t){t.ClosePath="ClosePath",t.ConvexHull="ConvexHull",t.RectangularBox="RectangularBox"}(mae||(mae={})),function(t){t.BeginningOfLine="BeginningOfLine",t.EndOfLine="EndOfLine"}(pae||(pae={})),function(t){t.Mitered="Mitered",t.Bevelled="Bevelled",t.Rounded="Rounded",t.Square="Square"}(fae||(fae={})),function(t){t.Fast="Fast",t.Accurate="Accurate"}(gae||(gae={})),function(t){t.BeginningOfLine="BeginningOfLine",t.EndOfLine="EndOfLine"}(_ae||(_ae={})),function(t){t.Sinus="Sinus",t.Square="Square",t.Triangle="Triangle",t.Random="Random"}(yae||(yae={})),function(t){t[t.None=0]="None",t[t.Default=1]="Default",t[t.Force=2]="Force"}(vae||(vae={})),function(t){t[t.Buffered=0]="Buffered",t[t.Left=1]="Left",t[t.Right=2]="Right",t[t.AlongLine=3]="AlongLine"}(xae||(xae={})),function(t){t[t.Linear=0]="Linear",t[t.Rectangular=1]="Rectangular",t[t.Circular=2]="Circular",t[t.Buffered=3]="Buffered"}(bae||(bae={})),function(t){t[t.Discrete=0]="Discrete",t[t.Continuous=1]="Continuous"}(wae||(wae={})),function(t){t[t.AcrossLine=0]="AcrossLine",t[t.AlongLine=1]="AlongLine"}(Sae||(Sae={})),function(t){t[t.Auto=0]="Auto",t[t.Clockwise=1]="Clockwise",t[t.Counterclockwise=2]="Counterclockwise"}(Eae||(Eae={})),function(t){t[t.Left=0]="Left",t[t.Right=1]="Right",t[t.Center=2]="Center",t[t.Justify=3]="Justify"}(Cae||(Cae={})),function(t){t[t.Base=0]="Base",t[t.MidPoint=1]="MidPoint",t[t.ThreePoint=2]="ThreePoint",t[t.FourPoint=3]="FourPoint",t[t.Underline=4]="Underline",t[t.CircularCW=5]="CircularCW",t[t.CircularCCW=6]="CircularCCW"}(Tae||(Tae={})),function(t){t.Butt="Butt",t.Round="Round",t.Square="Square"}(Pae||(Pae={})),function(t){t.NoConstraint="NoConstraint",t.HalfPattern="HalfPattern",t.HalfGap="HalfGap",t.FullPattern="FullPattern",t.FullGap="FullGap",t.Custom="Custom"}(Mae||(Mae={})),function(t){t[t.None=-1]="None",t[t.Custom=0]="Custom",t[t.Circle=1]="Circle",t[t.OpenArrow=2]="OpenArrow",t[t.ClosedArrow=3]="ClosedArrow",t[t.Diamond=4]="Diamond"}(Aae||(Aae={})),function(t){t[t.ExtraLeading=0]="ExtraLeading",t[t.Multiple=1]="Multiple",t[t.Exact=2]="Exact"}(Iae||(Iae={})),function(t){t.Bevel="Bevel",t.Round="Round",t.Miter="Miter"}(Dae||(Dae={})),function(t){t[t.Default=0]="Default",t[t.String=1]="String",t[t.Numeric=2]="Numeric"}(Nae||(Nae={})),function(t){t[t.InsidePolygon=0]="InsidePolygon",t[t.PolygonCenter=1]="PolygonCenter",t[t.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"}(Rae||(Rae={})),function(t){t[t.Tint=0]="Tint",t[t.Replace=1]="Replace",t[t.Multiply=2]="Multiply"}(Oae||(Oae={})),function(t){t[t.ClipAtBoundary=0]="ClipAtBoundary",t[t.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary",t[t.DoNotTouchBoundary=2]="DoNotTouchBoundary",t[t.DoNotClip=3]="DoNotClip"}(Lae||(Lae={})),function(t){t.NoConstraint="NoConstraint",t.WithMarkers="WithMarkers",t.WithFullGap="WithFullGap",t.WithHalfGap="WithHalfGap",t.Custom="Custom"}(Fae||(Fae={})),function(t){t.Fixed="Fixed",t.Random="Random",t.RandomFixedQuantity="RandomFixedQuantity"}(kae||(kae={})),function(t){t.LineMiddle="LineMiddle",t.LineBeginning="LineBeginning",t.LineEnd="LineEnd",t.SegmentMidpoint="SegmentMidpoint"}($ae||($ae={})),function(t){t.OnPolygon="OnPolygon",t.CenterOfMass="CenterOfMass",t.BoundingBoxCenter="BoundingBoxCenter"}(Uae||(Uae={})),function(t){t[t.Low=0]="Low",t[t.Medium=1]="Medium",t[t.High=2]="High"}(Vae||(Vae={})),function(t){t[t.MarkerCenter=0]="MarkerCenter",t[t.MarkerBounds=1]="MarkerBounds"}(zae||(zae={})),function(t){t[t.None=0]="None",t[t.PropUniform=1]="PropUniform",t[t.PropNonuniform=2]="PropNonuniform",t[t.DifUniform=3]="DifUniform",t[t.DifNonuniform=4]="DifNonuniform"}(Gae||(Gae={})),function(t){t.Tube="Tube",t.Strip="Strip",t.Wall="Wall"}(Bae||(Bae={})),function(t){t[t.Random=0]="Random",t[t.Increasing=1]="Increasing",t[t.Decreasing=2]="Decreasing",t[t.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"}(qae||(qae={})),function(t){t[t.Relative=0]="Relative",t[t.Absolute=1]="Absolute"}(uF||(uF={})),function(t){t[t.Normal=0]="Normal",t[t.LowerCase=1]="LowerCase",t[t.Allcaps=2]="Allcaps"}(Hae||(Hae={})),function(t){t[t.LTR=0]="LTR",t[t.RTL=1]="RTL"}(jae||(jae={})),function(t){t.Draft="Draft",t.Picture="Picture",t.Text="Text"}(Yae||(Yae={})),function(t){t[t.Top=0]="Top",t[t.Center=1]="Center",t[t.Baseline=2]="Baseline",t[t.Bottom=3]="Bottom"}(Xae||(Xae={})),function(t){t[t.Right=0]="Right",t[t.Upright=1]="Upright"}(Wae||(Wae={})),function(t){t[t.Small=0]="Small",t[t.Medium=1]="Medium",t[t.Large=2]="Large"}(Zae||(Zae={})),function(t){t[t.Calm=0]="Calm",t[t.Rippled=1]="Rippled",t[t.Slight=2]="Slight",t[t.Moderate=3]="Moderate"}(Kae||(Kae={}));const Hut={color:[128,128,128,1],outlinecolor:[0,0,0,1],backgroundcolor:[128,128,128,1],borderlinecolor:[0,0,0,1],tintcolor:[255,255,255,1]},G9={CIMVectorMarker:{scalesymbolsproportionally:!1,respectframe:!0,anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMPictureMarker:{scalex:1,texturefilter:"Draft",anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMTextSymbol:{angle:0,anglex:0,angley:0,halosize:1,height:10,horizontalalignment:"Left",kerning:!0,letterspacing:0,letterwidth:100,ligatures:!0,linegap:0,offsetx:0,offsety:0,strikethrough:!1,textcase:"Normal",textstring:"",underline:!1,verticalalignment:"Bottom",enable:!0,colorlocked:!1},CIMSolidStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMPictureStroke:{texturefilter:"Draft",capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMGradientStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1,gradientMethod:"AcrossLine",gradientSize:75,gradientSizeUnits:uF.Relative,gradientType:"Discrete",interval:5},CIMSolidFill:{enable:!0,colorlocked:!1},CIMPictureFill:{offsetx:0,offsety:0,rotation:0,scalex:1,height:10,texturefilter:"Draft",enable:!0,colorlocked:!1},CIMHatchFill:{offsetx:0,offsety:0,rotation:0,separation:4,enable:!0,colorlocked:!1},CIMGradientFill:{enable:!0,angle:90,gradientMethod:"Linear",gradientSize:75,gradientSizeUnits:uF.Relative,gradientType:"Discrete",interval:5},CIMGeometricEffectAddControlPoints:{angletolerance:120},CIMGeometricEffectArrow:{arrowtype:"OpenEnded",width:5},CIMGeometricEffectBuffer:{size:1},CIMGeometricEffectCut:{begincut:1,endcut:1,middlecut:0,invert:!1},CIMGeometricEffectDashes:{customendingoffset:0,linedashending:"NoConstraint",offsetalongline:0},CIMGeometricEffectDonut:{method:"Mitered",option:"Accurate",width:2},CIMGeometricEffectJog:{angle:225,length:20,position:50},CIMGeometricEffectControlMeasureLine:{rule:"FullGeometry"},CIMGeometricEffectMove:{offsetx:1,offsety:-1},CIMGeometricEffectOffset:{method:"Square",offset:1,option:"Fast"},CIMGeometricEffectRotate:{angle:15},CIMGeometricEffectScale:{xscalefactor:1.15,yscalefactor:1.15},CIMGeometricEffectWave:{amplitude:2,period:3,seed:1,waveform:"Sinus"},CIMMarkerPlacementAlongLine:{customendingoffset:0,endings:"WithHalfGap",offsetalongline:0,placeperpart:!0,angletoline:!0,offset:0},CIMMarkerPlacementAtExtremities:{extremityplacement:"Both",offsetalongline:0,angletoline:!0,offset:0},CIMMarkerPlacementAtRatioPositions:{beginposition:0,endposition:0,flipfirst:!0,angletoline:!0,offset:0},CIMMarkerPlacementInsidePolygon:{gridangle:0,gridtype:"Fixed",offsetx:0,offsety:0,randomness:100,seed:0,shiftoddrows:!1,stepx:16,stepy:16,clipping:"ClipAtBoundary"},CIMMarkerPlacementOnLine:{relativeto:"LineMiddle",startpointoffset:0,angletoline:!0,offset:0},CIMMarkerPlacementOnVertices:{placeperpart:!0,placeoncontrolpoints:!0,placeonendpoints:!0,placeonregularvertices:!0,angletoline:!0,offset:0},CIMMarkerPlacementPolygonCenter:{method:"OnPolygon",offsetx:0,offsety:0,clipatboundary:!1},CIMAnimatedSymbolProperties:{playanimation:!1,reverseanimation:!1,randomizestarttime:!1,randomizestartseed:0,starttimeoffset:0,duration:3,endingduration:3,useendingduration:!1,repeattype:V9.Loop,repeatdelay:0,easing:z9.Linear},CIMSymbolAnimationSize:{tosize:10},CIMSymbolAnimationScale:{scalefactor:1},CIMSymbolAnimationColor:{tocolor:[255,255,255,1]},CIMSymbolAnimationTransparency:{totransparency:0},CIMSymbolAnimationRotation:{torotation:0,rotateclockwise:!1},CIMSymbolAnimationOffset:{offsetx:0,offsety:0}};function jut(t){return typeof t=="function"}function kSt(t,e,i,s){return jut(t)?t(e,i,s):t}function $St(t){return[t.r,t.g,t.b,t.a]}const Yut=` /-,
`;function Qae(t){let e=t.length;for(;e--;)if(!Yut.includes(t.charAt(e)))return!1;return!0}function USt(t,e){const i=[];let s=0,n=-1;do if(n=t.indexOf("[",s),n>=s){if(n>s){const r=t.slice(s,n);i.push([r,null,Qae(r)])}if(s=n+1,n=t.indexOf("]",s),n>=s){if(n>s){const r=e[t.slice(s,n)];r&&i.push([null,r,!1])}s=n+1}}while(n!==-1);if(s<t.length){const r=t.slice(s);i.push([r,null,Qae(r)])}return i}function VSt(t,e,i,s){let n="",r=null;for(const o of e){const[a,l,u]=o;if(a)u?r=a:(r&&(n+=r,r=null),n+=a);else{let c=l;i!=null&&(c=Ybe(l,i));const h=t.attributes[c];h&&(r&&(n+=r,r=null),n+=h)}}return Xut(n,s)}function Xut(t,e){switch(typeof t!="string"&&(t=String(t)),e){case"LowerCase":return t.toLowerCase();case"Allcaps":return t.toUpperCase();default:return t}}function zSt(t,e,i,s,n,r,o=!0){const a=e/n,l=i/r,u=Math.ceil(a/2),c=Math.ceil(l/2);for(let h=0;h<r;h++)for(let d=0;d<n;d++){const m=4*(d+(o?r-h-1:h)*n);let f=0,_=0,v=0,x=0,w=0,T=0,C=0;const M=(h+.5)*l;for(let A=Math.floor(h*l);A<(h+1)*l;A++){const I=Math.abs(M-(A+.5))/c,L=(d+.5)*a,D=I*I;for(let O=Math.floor(d*a);O<(d+1)*a;O++){let U=Math.abs(L-(O+.5))/u;const $=Math.sqrt(D+U*U);$>=-1&&$<=1&&(f=2*$*$*$-3*$*$+1,f>0&&(U=4*(O+A*e),C+=f*t[U+3],v+=f,t[U+3]<255&&(f=f*t[U+3]/250),x+=f*t[U],w+=f*t[U+1],T+=f*t[U+2],_+=f))}}s[m]=x/_,s[m+1]=w/_,s[m+2]=T/_,s[m+3]=C/v}}function Wut(t){return t?[t[0],t[1],t[2],t[3]/255]:[0,0,0,0]}function GSt(t){var e;return((e=t.data)==null?void 0:e.symbol)??null}function BSt(t){return t.type==="CIMVectorMarker"||t.type==="CIMPictureMarker"||t.type==="CIMBarChartMarker"||t.type==="CIMCharacterMarker"||t.type==="CIMPieChartMarker"||t.type==="CIMStackedBarChartMarker"}function qSt(t){return t.type==="CIMGradientStroke"||t.type==="CIMPictureStroke"||t.type==="CIMSolidStroke"}function HSt(t){return t!=null&&(t.type==="CIMGradientFill"||t.type==="CIMHatchFill"||t.type==="CIMPictureFill"||t.type==="CIMSolidFill"||t.type==="CIMWaterFill")}function Zut(t){return t!=null&&(t.type==="CIMMarkerPlacementAlongLineRandomSize"||t.type==="CIMMarkerPlacementAlongLineSameSize"||t.type==="CIMMarkerPlacementAlongLineVariableSize"||t.type==="CIMMarkerPlacementAtExtremities"||t.type==="CIMMarkerPlacementAtMeasuredUnits"||t.type==="CIMMarkerPlacementAtRatioPositions"||t.type==="CIMMarkerPlacementOnLine"||t.type==="CIMMarkerPlacementOnVertices")}const jSt=(t,e=0)=>t==null||isNaN(t)?e:t,YSt=(t,e)=>t??e,XSt=(t,e)=>t??e,WSt=t=>t.tintColor?Wut(t.tintColor):[255,255,255,1],ZSt=t=>{if(!t)return!1;for(const e of t)switch(e.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1};function KSt(){return _e(()=>import("./geometryEngineJSON-Bvf5zUh7.js").then(t=>t.g),__vite__mapDeps([39,40,3,41]))}function QSt(t){if(!t)return"normal";switch(t.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function JSt(t){if(!t)return"normal";switch(t.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function eEt(t){let e="normal",i="normal";if(t){const s=t.toLowerCase();s.includes("italic")?e="italic":s.includes("oblique")&&(e="oblique"),s.includes("bold")?i="bold":s.includes("light")&&(i="lighter")}return{style:e,weight:i}}function tEt(t){return t.underline?"underline":t.strikethrough?"line-through":"none"}function Jae(t){if(!t)return null;switch(t.type){case"CIMPolygonSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const i=Jae(e);if(i!=null)return i}break;case"CIMTextSymbol":return Jae(t.symbol);case"CIMSolidFill":return t.color}return null}function ele(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const e=t.symbolLayers;if(e)for(const i of e){const s=ele(i);if(s!=null)return s}break}case"CIMTextSymbol":return ele(t.symbol);case"CIMSolidStroke":return t.color}}function tle(t){if(t)switch(t.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(t.symbolLayers)for(const e of t.symbolLayers){const i=tle(e);if(i!==void 0)return i}break;case"CIMTextSymbol":return tle(t.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return t.width}}function iEt(t){switch(t){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function sEt(t){switch(t){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function nEt(t){return(t?Object.keys(t):[]).map(e=>({name:e,alias:e,type:typeof t[e]=="string"?"esriFieldTypeString":"esriFieldTypeDouble"}))}const rEt=t=>t.includes("data:image/svg+xml");function oEt(t){if(!t)return null;switch(t.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}function yX(t){return t&&t.charAt(0).toLowerCase()+t.slice(1)}function aEt(t,e,i,s,n,r,o=!0){const{infos:a}=r;let l=1,u=0,c=0,h=0,d=1;for(const{absoluteAnchorPoint:_,offsetX:v,offsetY:x,rotation:w,size:T,frameHeight:C,rotateClockWise:M,scaleSymbolsProportionally:A}of a)d=_?1:l,c=sle(v,x,u,d,c),h=ile(v,x,u,d,h),C&&(A||o)&&(l*=T/C),u=nle(w,M,u);const m=sle(s,n,u,d,c),f=ile(s,n,u,d,h);return{size:t*l,rotation:nle(e,i,u),offsetX:m,offsetY:f}}function Kut(t){if(t==null)return!1;if(Array.isArray(t))return t.every(e=>Kut(e));switch(typeof t){case"string":return!!t;case"number":return!isNaN(t)}}function Qut(t,e){if(e==="color"||e==="outlinecolor"||e==="backgroundcolor"||e==="borderlinecolor"||e==="tintcolor")return[...Hut[e]];const i=G9[t];if(!i)throw new Error(`InternalError: default value for type ${t}.`);return i[e]}function Jut(t){return t.split(" ").map(e=>Number(e))}function ect(t){return typeof t=="string"?Jut(t):t}function lEt(t){return t!=null&&t.dashTemplate&&(t.dashTemplate=ect(t.dashTemplate)),t}function B9(t){if(t==null)return"Normal";switch(t.type){case"CIMTextSymbol":return t.textCase??"Normal";case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const e=t.symbolLayers;if(!e)return"Normal";for(const i of e)if(i.type==="CIMVectorMarker")return B9(i)}break;case"CIMVectorMarker":{const e=t.markerGraphics;if(!e)return"Normal";for(const i of e)if(i.symbol)return B9(i.symbol)}}return"Normal"}function uEt(t){if(t)switch(t.type){case"CIMTextSymbol":return t.height;case"CIMPointSymbol":{let e=0;if(t.symbolLayers){for(const i of t.symbolLayers)if(i)switch(i.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const s=i.size??G9.CIMVectorMarker.size;s>e&&(e=s);break}}}return e}case"CIMLineSymbol":case"CIMPolygonSymbol":{let e=0;if(t.symbolLayers){for(const i of t.symbolLayers)if(i)switch(i.type){case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const s=i.width;s!=null&&s>e&&(e=s);break}case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":if(i.markerPlacement&&Zut(i.markerPlacement)){const s=i.size??G9.CIMVectorMarker.size;s>e&&(e=s)}break;case"CIMPictureFill":{const s=i.height;s!=null&&s>e&&(e=s)}}}return e}}}function Ybe(t,e){if(e!==null){const i=e.get(t);return i?i.name:t}return t}function cEt(t){return t.map(e=>({...e,propertyName:yX(e.propertyName)}))}function hEt(t){const e={};for(const i in t){const s=t[i];e[yX(i)]=s}return e}function ile(t,e,i,s,n){const r=i*Math.PI/180;if(r){const o=Math.cos(r);return(Math.sin(r)*t+o*e)*s+n}return e*s+n}function sle(t,e,i,s,n){const r=i*Math.PI/180;return r?(Math.cos(r)*t-Math.sin(r)*e)*s+n:t*s+n}function nle(t,e,i){return e?i-t:i+t}function dEt(t,e,i){const s=i==="Color"||i==="TintColor"||i==="ToColor",n=i==="Rotation"||i==="Angle"||i==="ToRotation";let r=e[yX(i)];if(r!=null&&(s?r=[r[0]/255,r[1]/255,r[2]/255,r[3]/255]:n&&(r*=Math.PI/180)),r==null&&(r=Qut(e.type,i.toLowerCase()),r!=null&&(s?r=[r[0]/255,r[1]/255,r[2]/255,r[3]]:n&&(r*=Math.PI/180))),e.primitiveName!=null){const o=t[e.primitiveName];if(o!=null){const a=o[i];a==null||(typeof a=="string"||typeof a=="number"||Array.isArray(a)?(r=a,r!=null&&(s?r=[r[0]/255,r[1]/255,r[2]/255,r[3]/255]:n&&(r*=Math.PI/180))):(r={valueExpressionInfo:a,defaultValue:r},r!=null&&(s?r={type:"Process",op:"ArcadeColor",value:r}:n&&(r={type:"Process",op:"Divide",left:r,right:180/Math.PI}))))}}if(r==null)throw new Error(`Failed to derive a value or an expression for "${i}".`);return r}function mEt(t,e){return Math.max(Math.min((t??e)/100,1),0)}const rle="esri.renderers.support.DictionaryLoader",tct={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}};let Xbe=class{constructor(e,i,s){this.config=null,this.fieldMap=null,this.url=null,this._ongoingRequests=new Map,this._symbolCache=new Vut(100),this._dictionaryVersion=null,this._fieldIndex=null,this._dictionaryPromise=null,this.url=e,this.config=i,this.fieldMap=s}getSymbolFields(){return this._symbolFields}async getSymbolAsync(e,i){var h;let s;this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(i));try{s=await this._dictionaryPromise}catch(d){if(cl(d))return this._dictionaryPromise=null,null}const n=(h=this._dictionaryVersion)==null?void 0:h.greaterEqual(4,0),r={};if(this.fieldMap)for(const d of this._symbolFields){const m=Ybe(this.fieldMap[d],this._fieldIndex);if(m){const f=e.attributes[m];r[d]=n?f:f!=null?""+e.attributes[m]:""}else r[d]=""}let o=null;try{o=s==null?void 0:s(r,i)}catch{return null}if(!o||typeof o!="string"||o==="invalid")return null;const a=o.split(";"),l=[],u=[];for(let d=0;d<a.length;d++){const m=a[d];if(m){if(m.includes("po:")){const f=m.slice(3).split("|");if(f.length===3){const _=f[0],v=f[1];let x=f[2];const w="countrylabel";if(_===w&&v==="TextString"){if(this.fieldMap!=null){let T=this.fieldMap[w];T==null&&(T=w,this.fieldMap[T]=T),e.attributes[T]=x}continue}if(v==="DashTemplate")x=x.split(" ").map(T=>Number(T));else if(v==="Color"){const T=new Gt(x).toRgba();x=[T[0],T[1],T[2],255*T[3]]}else x=Number(x);u.push({primitiveName:_,propertyName:v,value:x,defaultValue:null})}}else if(m.includes("|")){for(const f of m.split("|"))if(this._itemNames.has(f)){l.push(f);break}}else if(this._itemNames.has(m))l.push(m);else if(d===0){l.length=0;let f="Invalid_P";e.geometry!=null&&(Xv(e.geometry)?f="Invalid_A":d7(e.geometry)&&(f="Invalid_L")),l.push(f);break}}}const c=e.geometry==null||!e.geometry.hasZ&&e.geometry.type==="point";return this._cimPartsToCIMSymbol(e,l,u,c,i)}async fetchResources(e){if(this._dictionaryPromise)return this._dictionaryPromise;if(!this.url)return void ht.getLogger(rle).error("no valid URL!");const i=$n(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"},signal:e!=null?e.signal:null}),[{data:s}]=await Promise.all([i,gy()]);if(!s)throw this._dictionaryPromise=null,new Se("esri.renderers.DictionaryRenderer","Bad dictionary data!");const{authoringInfo:n,dictionary_version:r,expression:o,itemsNames:a}=s,l=o;let u=!1;r&&(this._dictionaryVersion=Ixe.parse(r),u=this._dictionaryVersion.greaterEqual(4,0)),this._refSymbolUrlTemplate=this.url+"/"+s.cimRefTemplateUrl,this._itemNames=new Set(a),this._symbolFields=n.symbol;const c={};if(this.config){const m=this.config;for(const f in m)c[f]=m[f]}if(n.configuration)for(const m of n.configuration)c.hasOwnProperty(m.name)||(c[m.name]=m.value);const h=[];if(e!=null&&e.fields&&this.fieldMap)for(const m in this.fieldMap){const f=this.fieldMap[m],_=e.fields.filter(v=>v.name.toLowerCase()===(f==null?void 0:f.toLowerCase()));_.length>0&&h.push({..._[0],type:u?_[0].type:"esriFieldTypeString"})}h.length>0&&(this._fieldIndex=new Hbe(h));const d=$Ie(l,e!=null?e.spatialReference:null,h,c).then(m=>{const f={scale:0};return(_,v)=>{if(m==null)return null;const x=m.repurposeFeature({geometry:null,attributes:_});return f.scale=v!=null?v.scale??void 0:void 0,m.evaluate({$feature:x,$view:f},m.services)}}).catch(m=>(ht.getLogger(rle).error("Creating dictionary expression failed:",m),null));return this._dictionaryPromise=d,d}async _cimPartsToCIMSymbol(e,i,s,n,r){const o=new Array(i.length);for(let u=0;u<i.length;u++)o[u]=this._getSymbolPart(i[u],r);let a=await Promise.all(o);const l=this.fieldMap;if(l&&a.length>0){const{OverrideHelper:u}=await _e(()=>import("./OverrideHelper-BZUnkwZ3.js").then(c=>c.O),__vite__mapDeps([195,127,34]));a=be(a);for(const c of a)u.applyDictionaryTextOverrides(c,e,l,this._fieldIndex,B9(c))}return new Oy({data:ict(a,s,n)})}async _getSymbolPart(e,i){const s=this._symbolCache.get(e);if(s)return s;if(this._ongoingRequests.has(e))return this._ongoingRequests.get(e).then(o=>o.data);const n=this._refSymbolUrlTemplate.replaceAll(/\{itemName\}/gi,e),r=$n(n,{responseType:"json",query:{f:"json"},...i});this._ongoingRequests.set(e,r),r.finally(()=>this._ongoingRequests.delete(e));try{const o=await r;return this._symbolCache.put(e,o.data),o.data}catch(o){throw o}}};function ict(t,e,i){if(!t||t.length===0)return null;const s={...t[0]};if(t.length>1){s.effects=null,s.symbolLayers=[];for(const n of t){const r=n;if(r.effects!=null)for(const o of r.symbolLayers)o.effects==null?o.effects=r.effects:o.effects.unshift(...r.effects);s.symbolLayers.unshift(...r.symbolLayers)}}return i&&(s.callout=tct),{type:"CIMSymbolReference",symbol:s,primitiveOverrides:e}}var q9;let Wh=q9=class extends cE(Kf){constructor(t){super(t),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}get _loader(){return new Xbe(this.url,this.config,this.fieldMap)}writeData(t,e){t&&(e.scalingExpressionInfo={expression:t,returnType:"number"})}writeVisualVariables(t,e,i,s){s!=null&&s.origin||super.writeVisualVariables(t,e,i,s)}clone(){return new q9({config:be(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:be(this.fieldMap),url:be(this.url),visualVariables:be(this.visualVariables)})}async getSymbolAsync(t,e){return this._loader.getSymbolAsync(t,e)}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e),this.scaleExpression&&await al(t,e,this.scaleExpression);for(const i in this.fieldMap){const s=this.fieldMap[i];e.has(s)&&t.add(s)}}get arcadeRequired(){return!0}getSymbol(){return null}get symbols(){return[]}getAttributeHash(){var t;return((t=this.visualVariables)==null?void 0:t.reduce((e,i)=>e+i.getAttributeHash(),""))??""}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}getSymbolFields(){return this._loader.getSymbolFields()}};y([S({type:Xbe})],Wh.prototype,"_loader",null),y([S({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],Wh.prototype,"config",void 0),y([S({type:Object,json:{write:!0}})],Wh.prototype,"fieldMap",void 0),y([S({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],Wh.prototype,"scaleExpression",void 0),y([yt("scaleExpression")],Wh.prototype,"writeData",null),y([S({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(t){return{enabled:!!t&&!!this.scaleExpression}}}}})],Wh.prototype,"scaleExpressionTitle",void 0),y([S({type:String,json:{write:!0}})],Wh.prototype,"url",void 0),y([yt("visualVariables")],Wh.prototype,"writeVisualVariables",null),Wh=q9=y([se("esri.renderers.DictionaryRenderer")],Wh);const sct=Wh;var H9;let nf=H9=class extends it{constructor(t){super(t),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(t){return t==null?t:typeof t=="function"?(ht.getLogger(this).error(".field: field must be a string value"),null):OM(t)}getAttributeHash(){return`${this.field}-${this.valueExpression}`}clone(){var t;return new H9({color:(t=this.color)==null?void 0:t.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};y([S({type:Gt,json:{type:[Number],write:!0}})],nf.prototype,"color",void 0),y([S({type:String,json:{write:!0}})],nf.prototype,"field",void 0),y([Ls("field")],nf.prototype,"castField",null),y([S({type:String,json:{write:!0}})],nf.prototype,"label",void 0),y([S({type:String,json:{write:!0}})],nf.prototype,"valueExpression",void 0),y([S({type:String,json:{write:!0}})],nf.prototype,"valueExpressionTitle",void 0),nf=H9=y([se("esri.renderers.support.AttributeColorInfo")],nf);const Wbe=nf;var j9;let rO=j9=class extends it{constructor(){super(...arguments),this.unit=null}clone(){return new j9({unit:this.unit})}};y([S({type:String,json:{write:!0}})],rO.prototype,"unit",void 0),rO=j9=y([se("esri.renderers.support.DotDensityLegendOptions")],rO);const nct=rO;var Y9;let nu=Y9=class extends cE(Kf){constructor(t){super(t),this.attributes=null,this.backgroundColor=new Gt([0,0,0,0]),this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new Tu,this.dotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}calculateDotValue(t){if(this.referenceScale==null)return this.dotValue;const e=t/this.referenceScale*this.dotValue;return e<1?1:e}getSymbol(){return new bd({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol()]}getAttributeHash(){var t;return((t=this.attributes)==null?void 0:t.reduce((e,i)=>e+i.getAttributeHash(),""))??""}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new Y9({attributes:be(this.attributes),backgroundColor:be(this.backgroundColor),dotBlendingEnabled:be(this.dotBlendingEnabled),dotShape:be(this.dotShape),dotSize:be(this.dotSize),dotValue:be(this.dotValue),legendOptions:be(this.legendOptions),outline:be(this.outline),referenceScale:be(this.referenceScale),seed:be(this.seed),visualVariables:be(this.visualVariables),authoringInfo:be(this.authoringInfo)})}getControllerHash(){var e;return`${(e=this.attributes)==null?void 0:e.map(i=>i.field||i.valueExpression||"")}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e);for(const i of this.attributes??[])i.valueExpression&&await al(t,e,i.valueExpression),i.field&&t.add(i.field)}};y([S({type:[Wbe],json:{write:!0}})],nu.prototype,"attributes",void 0),y([S({type:Gt,json:{write:!0}})],nu.prototype,"backgroundColor",void 0),y([S({type:Boolean,json:{write:!0}})],nu.prototype,"dotBlendingEnabled",void 0),y([S({type:String,json:{write:!1}})],nu.prototype,"dotShape",void 0),y([S({type:Number,json:{write:!0}})],nu.prototype,"dotSize",void 0),y([S({type:nct,json:{write:!0}})],nu.prototype,"legendOptions",void 0),y([S({type:Tu,json:{default:null,write:!0}})],nu.prototype,"outline",void 0),y([S({type:Number,json:{write:!0}})],nu.prototype,"dotValue",void 0),y([S({type:Number,json:{write:!0}})],nu.prototype,"referenceScale",void 0),y([S({type:Number,json:{write:!0}})],nu.prototype,"seed",void 0),y([ai({dotDensity:"dot-density"})],nu.prototype,"type",void 0),nu=Y9=y([se("esri.renderers.DotDensityRenderer")],nu);const rct=nu;var X9;let RT=X9=class extends it{constructor(t){super(t),this.color=null,this.ratio=null}clone(){return new X9({color:this.color&&this.color.clone(),ratio:this.ratio})}};y([S({type:Gt,json:{type:[zs],default:null,write:{isRequired:!0}}})],RT.prototype,"color",void 0),y([S({type:Number,json:{write:{isRequired:!0}}})],RT.prototype,"ratio",void 0),RT=X9=y([se("esri.renderers.support.HeatmapColorStop")],RT);const oO=RT;let iw=class extends bs.ClonableMixin(it){constructor(){super(...arguments),this.minLabel=null,this.maxLabel=null,this.title=null}};y([S({type:String,json:{write:!0}})],iw.prototype,"minLabel",void 0),y([S({type:String,json:{write:!0}})],iw.prototype,"maxLabel",void 0),y([S({type:String,json:{write:!0}})],iw.prototype,"title",void 0),iw=y([se("esri.renderers.support.HeatmapLegendOptions")],iw);function oct(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function act(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function lct(t,e,i,s,n){return t[0]=e,t[1]=i,t[2]=s,t[3]=n,t}function uct(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t}function Zbe(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t}function Kbe(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t}function Qbe(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t[3]=e[3]/i[3],t}function cct(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function hct(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function dct(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t[3]=Math.min(e[3],i[3]),t}function mct(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t[3]=Math.max(e[3],i[3]),t}function pct(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function fct(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t}function gct(t,e,i,s){return t[0]=e[0]+i[0]*s,t[1]=e[1]+i[1]*s,t[2]=e[2]+i[2]*s,t[3]=e[3]+i[3]*s,t}function Jbe(t,e){const i=e[0]-t[0],s=e[1]-t[1],n=e[2]-t[2],r=e[3]-t[3];return Math.sqrt(i*i+s*s+n*n+r*r)}function ewe(t,e){const i=e[0]-t[0],s=e[1]-t[1],n=e[2]-t[2],r=e[3]-t[3];return i*i+s*s+n*n+r*r}function twe(t){const e=t[0],i=t[1],s=t[2],n=t[3];return Math.sqrt(e*e+i*i+s*s+n*n)}function iwe(t){const e=t[0],i=t[1],s=t[2],n=t[3];return e*e+i*i+s*s+n*n}function _ct(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function yct(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function vct(t,e){const i=e[0],s=e[1],n=e[2],r=e[3];let o=i*i+s*s+n*n+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=i*o,t[1]=s*o,t[2]=n*o,t[3]=r*o),t}function xct(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function swe(t,e,i,s){const n=e[0],r=e[1],o=e[2],a=e[3];return t[0]=n+s*(i[0]-n),t[1]=r+s*(i[1]-r),t[2]=o+s*(i[2]-o),t[3]=a+s*(i[3]-a),t}function bct(t,e=1){const i=D4;let s,n,r,o,a,l;do s=2*i()-1,n=2*i()-1,a=s*s+n*n;while(a>=1);do r=2*i()-1,o=2*i()-1,l=r*r+o*o;while(l>=1);const u=Math.sqrt((1-a)/l);return t[0]=e*s,t[1]=e*n,t[2]=e*r*u,t[3]=e*o*u,t}function wct(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3];return t[0]=i[0]*s+i[4]*n+i[8]*r+i[12]*o,t[1]=i[1]*s+i[5]*n+i[9]*r+i[13]*o,t[2]=i[2]*s+i[6]*n+i[10]*r+i[14]*o,t[3]=i[3]*s+i[7]*n+i[11]*r+i[15]*o,t}function Sct(t,e,i){const s=e[0],n=e[1],r=e[2],o=i[0],a=i[1],l=i[2],u=i[3],c=u*s+a*r-l*n,h=u*n+l*s-o*r,d=u*r+o*n-a*s,m=-o*s-a*n-l*r;return t[0]=c*u+m*-o+h*-l-d*-a,t[1]=h*u+m*-a+d*-o-c*-l,t[2]=d*u+m*-l+c*-a-h*-o,t[3]=e[3],t}function Ect(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function Cct(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function Tct(t,e){const i=t[0],s=t[1],n=t[2],r=t[3],o=e[0],a=e[1],l=e[2],u=e[3],c=kl();return Math.abs(i-o)<=c*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(s-a)<=c*Math.max(1,Math.abs(s),Math.abs(a))&&Math.abs(n-l)<=c*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(r-u)<=c*Math.max(1,Math.abs(r),Math.abs(u))}const Pct=Zbe,Mct=Kbe,Act=Qbe,Ict=Jbe,Dct=ewe,Nct=twe,Rct=iwe;Object.freeze(Object.defineProperty({__proto__:null,add:uct,ceil:cct,copy:oct,copyVec3:act,dist:Ict,distance:Jbe,div:Act,divide:Qbe,dot:xct,equals:Tct,exactEquals:Cct,floor:hct,inverse:yct,len:Nct,length:twe,lerp:swe,max:mct,min:dct,mul:Mct,multiply:Kbe,negate:_ct,normalize:vct,random:bct,round:pct,scale:fct,scaleAndAdd:gct,set:lct,sqrDist:Dct,sqrLen:Rct,squaredDistance:ewe,squaredLength:iwe,str:Ect,sub:Pct,subtract:Zbe,transformMat4:wct,transformQuat:Sct},Symbol.toStringTag,{value:"Module"}));function yk(){return[0,0,0,0]}function Oct(t){return[t[0],t[1],t[2],t[3]]}function hE(t,e,i,s){return[t,e,i,s]}function Lct(t,e,i,s){return[t,e,i,s]}function Fct(t,e=yk()){const i=Math.min(4,t.length);for(let s=0;s<i;++s)e[s]=t[s];return e}function kct(t,e){return new Float64Array(t,e,4)}function nwe(){return yk()}function rwe(){return hE(1,1,1,1)}function owe(){return hE(1,0,0,0)}function awe(){return hE(0,1,0,0)}function lwe(){return hE(0,0,1,0)}function uwe(){return hE(0,0,0,1)}const $ct=nwe(),Uct=rwe(),Vct=owe(),zct=awe(),Gct=lwe(),Bct=uwe();Object.freeze(Object.defineProperty({__proto__:null,ONES:Uct,UNIT_W:Bct,UNIT_X:Vct,UNIT_Y:zct,UNIT_Z:Gct,ZEROS:$ct,clone:Oct,create:yk,createView:kct,freeze:Lct,fromArray:Fct,fromValues:hE,ones:rwe,unitW:uwe,unitX:owe,unitY:awe,unitZ:lwe,zeros:nwe},Symbol.toStringTag,{value:"Module"}));const vX=2.4;function qct(t){return rh(t*vX)}function Hct(t){return SNe(t)/vX}function jct(t,e,i,s){let{color:n,ratio:r}=e,{color:o,ratio:a}=i;a===r&&(a===1?r-=1e-6:a+=1e-6);const l=sh((s-r)/(a-r),0,1);swe(t,n.toArray(),o.toArray(),l)}function gEt(t){const i=new Uint8ClampedArray(2048);if(t=t.filter(({ratio:a})=>a>=0&&a<=1).sort((a,l)=>a.ratio-l.ratio).map(({color:a,ratio:l})=>({color:a,ratio:Math.max(l,.001)})),t.length<1)return i;let s=t[0],n=t[0],r=1;const o=yk();for(let a=0;a<512;a++){const l=(a+.5)/512;for(;l>n.ratio&&r<t.length;)s=n,n=t[r++];jct(o,s,n,l),i.set(o,4*a)}return i}function _Et(t,e,i){const s=Math.sqrt(t**2+e**2)/i;return s>1?0:3/(Math.PI*i**2)*(1-s**2)**2}function yEt(t){return typeof t=="function"?t:t?e=>+e[t]:()=>1}var W9;function ole(t){if(t!=null){const{maxDensity:e,minDensity:i,radius:s}=t;if(e!=null||i!=null||s!=null){const{blurRadius:n,maxPixelIntensity:r,minPixelIntensity:o,...a}=t;return a}}return t}let Zo=W9=class extends Kf{constructor(t){super(t),this.authoringInfo=null,this.colorStops=[new oO({ratio:0,color:new Gt("rgba(255, 140, 0, 0)")}),new oO({ratio:.75,color:new Gt("rgba(255, 140, 0, 1)")}),new oO({ratio:.9,color:new Gt("rgba(255, 0,   0, 1)")})],this.field=null,this.legendOptions=null,this.maxDensity=.04,this.minDensity=0,this.radius=18,this.referenceScale=0,this.type="heatmap",this.valueExpression=null,this.valueExpressionTitle=null}normalizeCtorArgs(t){return ole(t)}get blurRadius(){return Hct(this.radius)}set blurRadius(t){const e=this.maxPixelIntensity,i=this.minPixelIntensity;this._set("radius",qct(t)),this._set("maxDensity",e*this._pixelIntensityToDensity),this._set("minDensity",i*this._pixelIntensityToDensity)}get maxPixelIntensity(){return this.maxDensity/this._pixelIntensityToDensity}set maxPixelIntensity(t){this._set("maxDensity",t*this._pixelIntensityToDensity)}get minPixelIntensity(){return this.minDensity/this._pixelIntensityToDensity}set minPixelIntensity(t){this._set("minDensity",t*this._pixelIntensityToDensity)}get _pixelIntensityToDensity(){return 24/(vX**2*this.blurRadius**4)}read(t,e){t=ole(t),super.read(t,e)}getSymbol(){return new _u}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol()]}async collectRequiredFields(t,e){const i=this.field,s=this.valueExpression;i&&typeof i=="string"&&Ll(t,e,i),s&&typeof s=="string"&&await al(t,e,s)}getAttributeHash(){return""}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new W9({authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),colorStops:be(this.colorStops),field:this.field,legendOptions:be(this.legendOptions),maxDensity:this.maxDensity,minDensity:this.minDensity,radius:this.radius,referenceScale:this.referenceScale,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};y([S({type:eX,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Zo.prototype,"authoringInfo",void 0),y([S({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Zo.prototype,"blurRadius",null),y([S({type:[oO],json:{write:{isRequired:!0}}})],Zo.prototype,"colorStops",void 0),y([S({type:String,json:{write:!0}})],Zo.prototype,"field",void 0),y([S({type:iw,json:{write:!0}})],Zo.prototype,"legendOptions",void 0),y([S({type:Number,json:{write:!0}})],Zo.prototype,"maxDensity",void 0),y([S({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Zo.prototype,"maxPixelIntensity",null),y([S({type:Number,json:{write:!0}})],Zo.prototype,"minDensity",void 0),y([S({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Zo.prototype,"minPixelIntensity",null),y([S({type:Number,cast:Ps,json:{write:!0}})],Zo.prototype,"radius",void 0),y([S({type:Number,range:{min:0},json:{default:0,write:!0}})],Zo.prototype,"referenceScale",void 0),y([ai({heatmap:"heatmap"})],Zo.prototype,"type",void 0),y([S({type:String,json:{write:!0,origins:{"web-document":{write:!1},"portal-item":{write:!1}}}})],Zo.prototype,"valueExpression",void 0),y([S({type:String})],Zo.prototype,"valueExpressionTitle",void 0),y([S({readOnly:!0})],Zo.prototype,"_pixelIntensityToDensity",null),Zo=W9=y([se("esri.renderers.HeatmapRenderer")],Zo);const cwe=Zo;let Rv=class extends bs.ClonableMixin(it){constructor(){super(...arguments),this.color=new Gt([0,0,0,0]),this.label=null,this.threshold=0}};y([S({type:Gt,json:{write:!0}})],Rv.prototype,"color",void 0),y([S({type:String,json:{write:!0}})],Rv.prototype,"label",void 0),y([S({type:Number,range:{min:0,max:1},json:{write:!0}})],Rv.prototype,"threshold",void 0),Rv=y([se("esri.renderers.support.OthersCategory")],Rv);const Yct={base:uE,key:"type",typeMap:{size:fk,opacity:tX}};let ru=class extends cE(bs.ClonableMixin(Kf)){constructor(e){super(e),this.attributes=null,this.backgroundFillSymbol=null,this.defaultColor=new Gt([0,0,0,0]),this.defaultLabel=null,this.holePercentage=0,this.othersCategory=new Rv,this.legendOptions=null,this.outline=null,this.size=12,this.type="pie-chart",this.visualVariables=null}getSymbol(){var e;return new _u({size:this.size?this.size/2+(((e=this.outline)==null?void 0:e.width)||0):0})}async getSymbolAsync(){return this.getSymbol()}get symbols(){return[this.getSymbol(),this.backgroundFillSymbol].filter(Df)}getAttributeHash(){var e;return((e=this.visualVariables)==null?void 0:e.reduce((i,s)=>i+s.getAttributeHash(),""))??""}getMeshHash(){return this.symbols.reduce((e,i)=>e+JSON.stringify(i),"")}async collectRequiredFields(e,i){await this.collectVVRequiredFields(e,i);for(const s of this.attributes)s.valueExpression&&await al(e,i,s.valueExpression),s.field&&e.add(s.field)}};y([S({type:[Wbe],json:{write:!0}})],ru.prototype,"attributes",void 0),y([S(oX)],ru.prototype,"backgroundFillSymbol",void 0),y([S({type:Gt,json:{write:!0}})],ru.prototype,"defaultColor",void 0),y([S({type:String,json:{write:!0}})],ru.prototype,"defaultLabel",void 0),y([S({type:Number,range:{min:0,max:1},json:{write:!0}})],ru.prototype,"holePercentage",void 0),y([S({type:Rv,json:{write:!0}})],ru.prototype,"othersCategory",void 0),y([S({type:aX,json:{write:!0}})],ru.prototype,"legendOptions",void 0),y([S({type:Tu,json:{default:null,write:!0}})],ru.prototype,"outline",void 0),y([S({type:Number,cast:Ps,json:{write:!0}})],ru.prototype,"size",void 0),y([ai({pieChart:"pie-chart"})],ru.prototype,"type",void 0),y([S({types:[Yct]})],ru.prototype,"visualVariables",void 0),ru=y([se("esri.renderers.PieChartRenderer")],ru);const Xct=ru,AA={key:"type",base:Kf,typeMap:{heatmap:cwe,simple:Om,"unique-value":lX,"class-breaks":qbe,"dot-density":rct,dictionary:sct,"pie-chart":Xct},errorContext:"renderer"},Wct={key:"type",base:Kf,typeMap:{simple:Om,"unique-value":lX,"class-breaks":qbe,heatmap:cwe},errorContext:"renderer",validate:Zct};function Zct(t){switch(t.type){case"simple":return Kct(t);case"unique-value":return Qct(t);case"class-breaks":return Jct(t);case"heatmap":return t}}function Kct(t){if(t.symbol)return t;ht.getLogger("esri.renderers.support.types").error("Removed invalid 'simple' renderer without a symbol from web scene.")}function Qct(t){const e=t.uniqueValueInfos,i=e==null?void 0:e.filter(({symbol:s,label:n},r)=>(s||ht.getLogger("esri.renderers.support.types").error(`Removed invalid unique value info ([${r}] ${n}) without a symbol from web scene.`),!!s));return(i==null?void 0:i.length)!==(e==null?void 0:e.length)&&(t.uniqueValueInfos=i),t}function Jct(t){const e=t.classBreakInfos,i=e==null?void 0:e.filter(({symbol:s,label:n},r)=>(s||ht.getLogger("esri.renderers.support.types").error(`Removed invalid class break info ([${r}] ${n}) without a symbol from web scene.`),!!s));return(i==null?void 0:i.length)!==(e==null?void 0:e.length)&&(t.classBreakInfos=i),t}function bEt(t,e){return AM(t,null,e)}const eht=LS({types:AA});function AM(t,e,i){return t?t&&(t.styleName||t.styleUrl)&&t.type!=="uniqueValue"?(i!=null&&i.messages&&i.messages.push(new ih("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+t.type+"'",{definition:t,context:i})),null):eht(t,e,i):null}var Z9;let Za=Z9=class extends dy{constructor(t){super(t),this.type="binning",this.binType="geohash",this.fixedBinLevel=null,this.labelingInfo=null,this.labelsVisible=!0,this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.size=Ps("12px"),this.fields=[],this.renderer=null}writeFields(t,e,i){const s=t.filter(n=>n.statisticType!=="avg_angle").map(n=>n.toJSON());la(i,s,e)}readRenderer(t,e,i){var n;const s=(n=e.drawingInfo)==null?void 0:n.renderer;return s?AM(s,e,i)??void 0:hX(e,i)}clone(){return new Z9({fields:be(this.fields),fixedBinLevel:this.fixedBinLevel,labelingInfo:be(this.labelingInfo),labelsVisible:this.labelsVisible,maxScale:this.maxScale,popupEnabled:this.popupEnabled,popupTemplate:be(this.popupTemplate),renderer:be(this.renderer),binType:be(this.binType),size:this.size})}};y([ai({binning:"binning"})],Za.prototype,"type",void 0),y([ai({geohash:"geohash",square:"square"}),S({type:["geohash","square"]})],Za.prototype,"binType",void 0),y([S({type:Number,json:{write:!0}})],Za.prototype,"fixedBinLevel",void 0),y([S({type:[MA],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],Za.prototype,"labelingInfo",void 0),y([S(hk)],Za.prototype,"labelsVisible",void 0),y([S({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],Za.prototype,"maxScale",void 0),y([S(ck)],Za.prototype,"popupEnabled",void 0),y([S({type:HS,json:{name:"popupInfo",write:!0}})],Za.prototype,"popupTemplate",void 0),y([S({cast:t=>t==="auto"?t:Al(Ps(t))})],Za.prototype,"size",void 0),y([S({type:[Ry],json:{write:!0}})],Za.prototype,"fields",void 0),y([yt("fields")],Za.prototype,"writeFields",null),y([S({types:AA,json:{write:{target:"drawingInfo.renderer"}}})],Za.prototype,"renderer",void 0),y([mt("renderer",["drawingInfo.renderer"])],Za.prototype,"readRenderer",null),Za=Z9=y([se("esri.layers.support.FeatureReductionBinning")],Za);const hwe=Za;var K9;function ale(t){var e;return t.type==="simple"&&!((e=t.visualVariables)!=null&&e.length)}let ho=K9=class extends it{constructor(t){super(t),this.type="cluster",this.clusterRadius=Ps("80px"),this.clusterMinSize=Ps("12px"),this.clusterMaxSize=Ps("50px"),this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.renderer=null,this.symbol=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=[]}readRenderer(t,e,i){var n,r;const s=(n=e.drawingInfo)==null?void 0:n.renderer;return(r=s==null?void 0:s.authoringInfo)!=null&&r.isAutoGenerated?null:s?ale(s)?null:AM(s,e,i)??void 0:hX(e,i)}readSymbol(t,e,i){var n,r;const s=(n=e.drawingInfo)==null?void 0:n.renderer;if((r=s==null?void 0:s.authoringInfo)!=null&&r.isAutoGenerated)return null;if(s&&ale(s)){const o=AM(s,e,i);return o==null?void 0:o.symbol}return null}writeSymbol(t,e,i,s){var r,o;const n=(o=(r=this.renderer)==null?void 0:r.authoringInfo)==null?void 0:o.isAutoGenerated;if(!this.renderer||n){const a=new Om({symbol:t});e.drawingInfo={renderer:a.write({},s)}}}writeFields(t,e,i){const s=t.filter(n=>n.statisticType!=="avg_angle").map(n=>n.toJSON());la(i,s,e)}readFields(t,e,i){return t.filter(s=>!s.isAutoGenerated).map(s=>Ry.fromJSON(s))}clone(){return new K9({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:be(this.labelingInfo),labelsVisible:this.labelsVisible,fields:be(this.fields),maxScale:this.maxScale,renderer:be(this.renderer),symbol:be(this.symbol),popupEnabled:this.popupEnabled,popupTemplate:be(this.popupTemplate)})}};y([S({type:["cluster"],readOnly:!0,json:{write:!0}})],ho.prototype,"type",void 0),y([S({cast:t=>t==="auto"?t:Al(Ps(t)),json:{write:!0}})],ho.prototype,"clusterRadius",void 0),y([S({type:Number,cast:Ps,json:{write:!0}})],ho.prototype,"clusterMinSize",void 0),y([S({type:Number,cast:Ps,json:{write:!0}})],ho.prototype,"clusterMaxSize",void 0),y([S({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],ho.prototype,"maxScale",void 0),y([S(ck)],ho.prototype,"popupEnabled",void 0),y([S({type:HS,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],ho.prototype,"popupTemplate",void 0),y([S({types:AA,json:{write:{target:"drawingInfo.renderer"}}})],ho.prototype,"renderer",void 0),y([mt("renderer",["drawingInfo.renderer"])],ho.prototype,"readRenderer",null),y([S({types:fRe})],ho.prototype,"symbol",void 0),y([mt("symbol",["drawingInfo.renderer"])],ho.prototype,"readSymbol",null),y([yt("symbol")],ho.prototype,"writeSymbol",null),y([S({type:[MA],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],ho.prototype,"labelingInfo",void 0),y([S(hk)],ho.prototype,"labelsVisible",void 0),y([S({type:[Ry],json:{write:!0}})],ho.prototype,"fields",void 0),y([yt("fields")],ho.prototype,"writeFields",null),y([mt("fields")],ho.prototype,"readFields",null),ho=K9=y([se("esri.layers.support.FeatureReductionCluster")],ho);const dwe=ho;var Q9;let aO=Q9=class extends dy{constructor(t){super(t),this.type="selection"}clone(){return new Q9}};y([S({type:["selection"]})],aO.prototype,"type",void 0),aO=Q9=y([se("esri.layers.support.FeatureReductionSelection")],aO);const lle=aO,ule={key:"type",base:dy,typeMap:{cluster:dwe,binning:hwe}},tht={types:{key:"type",base:dy,typeMap:{selection:lle,cluster:dwe,binning:hwe}},json:{name:"layerDefinition.featureReduction",write:{allowNull:!0},origins:{"web-map":{types:ule},"portal-item":{types:ule},"web-scene":{types:{key:"type",base:dy,typeMap:{selection:lle}},name:"layerDefinition.featureReduction",write:{layerContainerTypes:rr}}}}},gb={Base64:0,Hex:1,String:2,Raw:3},Hw=8,mwe=(1<<Hw)-1;function J_(t,e){const i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}function iht(t){const e=[];for(let i=0,s=t.length*Hw;i<s;i+=Hw)e[i>>5]|=(t.charCodeAt(i/Hw)&mwe)<<i%32;return e}function sht(t){const e=[];for(let i=0,s=32*t.length;i<s;i+=Hw)e.push(String.fromCharCode(t[i>>5]>>>i%32&mwe));return e.join("")}function nht(t){const e="0123456789abcdef",i=[];for(let s=0,n=4*t.length;s<n;s++)i.push(e.charAt(t[s>>2]>>s%4*8+4&15)+e.charAt(t[s>>2]>>s%4*8&15));return i.join("")}function rht(t){const e="=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=[];for(let n=0,r=4*t.length;n<r;n+=3){const o=(t[n>>2]>>n%4*8&255)<<16|(t[n+1>>2]>>(n+1)%4*8&255)<<8|t[n+2>>2]>>(n+2)%4*8&255;for(let a=0;a<4;a++)8*n+6*a>32*t.length?s.push(e):s.push(i.charAt(o>>6*(3-a)&63))}return s.join("")}function oht(t,e){return t<<e|t>>>32-e}function vk(t,e,i,s,n,r){return J_(oht(J_(J_(e,t),J_(s,r)),n),i)}function Ga(t,e,i,s,n,r,o){return vk(e&i|~e&s,t,e,n,r,o)}function Ba(t,e,i,s,n,r,o){return vk(e&s|i&~s,t,e,n,r,o)}function qa(t,e,i,s,n,r,o){return vk(e^i^s,t,e,n,r,o)}function Ha(t,e,i,s,n,r,o){return vk(i^(e|~s),t,e,n,r,o)}function aht(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;let i=1732584193,s=-271733879,n=-1732584194,r=271733878;for(let o=0;o<t.length;o+=16){const a=i,l=s,u=n,c=r;i=Ga(i,s,n,r,t[o],7,-680876936),r=Ga(r,i,s,n,t[o+1],12,-389564586),n=Ga(n,r,i,s,t[o+2],17,606105819),s=Ga(s,n,r,i,t[o+3],22,-1044525330),i=Ga(i,s,n,r,t[o+4],7,-176418897),r=Ga(r,i,s,n,t[o+5],12,1200080426),n=Ga(n,r,i,s,t[o+6],17,-1473231341),s=Ga(s,n,r,i,t[o+7],22,-45705983),i=Ga(i,s,n,r,t[o+8],7,1770035416),r=Ga(r,i,s,n,t[o+9],12,-1958414417),n=Ga(n,r,i,s,t[o+10],17,-42063),s=Ga(s,n,r,i,t[o+11],22,-1990404162),i=Ga(i,s,n,r,t[o+12],7,1804603682),r=Ga(r,i,s,n,t[o+13],12,-40341101),n=Ga(n,r,i,s,t[o+14],17,-1502002290),s=Ga(s,n,r,i,t[o+15],22,1236535329),i=Ba(i,s,n,r,t[o+1],5,-165796510),r=Ba(r,i,s,n,t[o+6],9,-1069501632),n=Ba(n,r,i,s,t[o+11],14,643717713),s=Ba(s,n,r,i,t[o],20,-373897302),i=Ba(i,s,n,r,t[o+5],5,-701558691),r=Ba(r,i,s,n,t[o+10],9,38016083),n=Ba(n,r,i,s,t[o+15],14,-660478335),s=Ba(s,n,r,i,t[o+4],20,-405537848),i=Ba(i,s,n,r,t[o+9],5,568446438),r=Ba(r,i,s,n,t[o+14],9,-1019803690),n=Ba(n,r,i,s,t[o+3],14,-187363961),s=Ba(s,n,r,i,t[o+8],20,1163531501),i=Ba(i,s,n,r,t[o+13],5,-1444681467),r=Ba(r,i,s,n,t[o+2],9,-51403784),n=Ba(n,r,i,s,t[o+7],14,1735328473),s=Ba(s,n,r,i,t[o+12],20,-1926607734),i=qa(i,s,n,r,t[o+5],4,-378558),r=qa(r,i,s,n,t[o+8],11,-2022574463),n=qa(n,r,i,s,t[o+11],16,1839030562),s=qa(s,n,r,i,t[o+14],23,-35309556),i=qa(i,s,n,r,t[o+1],4,-1530992060),r=qa(r,i,s,n,t[o+4],11,1272893353),n=qa(n,r,i,s,t[o+7],16,-155497632),s=qa(s,n,r,i,t[o+10],23,-1094730640),i=qa(i,s,n,r,t[o+13],4,681279174),r=qa(r,i,s,n,t[o],11,-358537222),n=qa(n,r,i,s,t[o+3],16,-722521979),s=qa(s,n,r,i,t[o+6],23,76029189),i=qa(i,s,n,r,t[o+9],4,-640364487),r=qa(r,i,s,n,t[o+12],11,-421815835),n=qa(n,r,i,s,t[o+15],16,530742520),s=qa(s,n,r,i,t[o+2],23,-995338651),i=Ha(i,s,n,r,t[o],6,-198630844),r=Ha(r,i,s,n,t[o+7],10,1126891415),n=Ha(n,r,i,s,t[o+14],15,-1416354905),s=Ha(s,n,r,i,t[o+5],21,-57434055),i=Ha(i,s,n,r,t[o+12],6,1700485571),r=Ha(r,i,s,n,t[o+3],10,-1894986606),n=Ha(n,r,i,s,t[o+10],15,-1051523),s=Ha(s,n,r,i,t[o+1],21,-2054922799),i=Ha(i,s,n,r,t[o+8],6,1873313359),r=Ha(r,i,s,n,t[o+15],10,-30611744),n=Ha(n,r,i,s,t[o+6],15,-1560198380),s=Ha(s,n,r,i,t[o+13],21,1309151649),i=Ha(i,s,n,r,t[o+4],6,-145523070),r=Ha(r,i,s,n,t[o+11],10,-1120210379),n=Ha(n,r,i,s,t[o+2],15,718787259),s=Ha(s,n,r,i,t[o+9],21,-343485551),i=J_(i,a),s=J_(s,l),n=J_(n,u),r=J_(r,c)}return[i,s,n,r]}function pwe(t,e=gb.Hex){const i=e||gb.Base64,s=aht(iht(t),t.length*Hw);switch(i){case gb.Raw:return s;case gb.Hex:return nht(s);case gb.String:return sht(s);case gb.Base64:return rht(s)}}const lht=()=>ht.getLogger("esri.views.2d.layers.support.clusterUtils");ke.add("esri-cluster-arcade-enabled",!0);const uht=ke("esri-cluster-arcade-enabled"),cht=new Set(["simple-line","simple-fill","picture-fill"]);function cle(t,e){let i=e.clone();if(!hht(i))return i;if(e.symbols.some(s=>cht.has(s.type))&&(i=new Om({symbol:new _u})),i.authoringInfo||(i.authoringInfo=new eX),i.authoringInfo.isAutoGenerated=!0,"visualVariables"in i){const s=(i.visualVariables||[]).filter(n=>n.valueExpression!=="$view.scale");s.forEach(n=>{n.type==="rotation"?n.field?n.field=L0(t,n.field,"avg_angle","number"):n.valueExpression&&(n.field=lC(t,n.valueExpression,"avg_angle","number"),n.valueExpression=null):n.normalizationField?(n.field=L0(t,n.field,"avg_norm","number",n.normalizationField),n.normalizationField=null):n.field?n.field=L0(t,n.field,"avg","number"):n.valueExpression&&(n.field=lC(t,n.valueExpression,"avg","number"),n.valueExpression=null)}),i.visualVariables=s}switch(i.type){case"simple":break;case"pie-chart":for(const s of i.attributes)s.field?s.field=L0(t,s.field,"sum","number"):s.valueExpression&&(s.field=lC(t,s.valueExpression,"sum","number"),s.valueExpression=null);break;case"unique-value":i.field?i.field=L0(t,i.field,"mode","string"):i.valueExpression&&(i.field=lC(t,i.valueExpression,"mode","string"),i.valueExpression=null);break;case"class-breaks":i.normalizationField?(i.field=L0(t,i.field,"avg_norm","number",i.normalizationField),i.normalizationField=null):i.field?i.field=L0(t,i.field,"avg","number"):i.valueExpression&&(i.field=lC(t,i.valueExpression,"avg","number"),i.valueExpression=null)}return i}const hht=t=>{const e=i=>lht().error(new Se("Unsupported-renderer",i,{renderer:t}));if(!t)return!1;switch(t.type){case"unique-value":if(t.field2||t.field3)return e("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1;break;case"class-breaks":if(t.normalizationField){const i=t.normalizationType;if(i!=="field")return e(`FeatureReductionCluster does not support a normalizationType of ${i}`),!1}break;case"simple":case"pie-chart":break;default:return e(`FeatureReductionCluster does not support renderers of type ${t.type}`),!1}if(!uht){if("valueExpression"in t&&t.valueExpression)return e("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in t&&t.visualVariables||[]).some(i=>!(!("valueExpression"in i)||!i.valueExpression)))return e("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function dht(t,e,i){switch(t){case"sum":return`cluster_sum_${e}`;case"avg":case"avg_angle":return`cluster_avg_${e}`;case"mode":return`cluster_type_${e}`;case"avg_norm":{const s=i,n="field",r=e.toLowerCase()+",norm:"+n+","+s.toLowerCase();return"cluster_avg_"+pwe(r)}}}function lC(t,e,i,s){const n=pwe(e),r=i==="mode"?`cluster_type_${n}`:i==="sum"?`cluster_sum_${n}`:`cluster_avg_${n}`;return t.some(o=>o.name===r)||t.push(new Ry({name:r,isAutoGenerated:!0,onStatisticExpression:new pX({expression:e,returnType:s}),statisticType:i})),r}function L0(t,e,i,s,n){if(e==="cluster_count"||t.some(o=>o.name===e))return e;const r=dht(i,e,n);return t.some(o=>o.name===r)||(i==="avg_norm"?t.push(new Ry({name:r,isAutoGenerated:!0,onStatisticExpression:new pX({expression:`$feature.${e} / $feature.${n}`,returnType:s}),statisticType:"avg"})):t.push(new Ry({name:r,isAutoGenerated:!0,onStatisticField:e,statisticType:i}))),r}const mht=t=>{let e=class extends t{constructor(...i){super(...i),this.addHandles(Ai(()=>this.renderer,()=>{if(this.featureReduction){const s=this._normalizeFeatureReduction(this.featureReduction);this._set("featureReduction",s)}},km))}set featureReduction(i){const s=this._normalizeFeatureReduction(i);this._set("featureReduction",s)}set renderer(i){}_withClusterVariable(i,s,n){const r=i.clone();return"visualVariables"in r&&(r.visualVariables||(r.visualVariables=[]),r.visualVariables.some(o=>o.type==="size")||r.visualVariables.push(new fk({field:"cluster_count",stops:[new Z3({value:1}),new Z3({useMinValue:!0,size:s}),new Z3({useMaxValue:!0,size:n})]}))),r}_normalizeFeatureReduction(i){var h;if((i==null?void 0:i.type)!=="cluster")return i;const s=i.clone(),n=[new Ry({name:"cluster_count",alias:"cluster_count",isAutoGenerated:!0,statisticType:"count"})],r=(s.fields??[]).filter(d=>!d.isAutoGenerated),o=i.renderer&&!((h=i.renderer.authoringInfo)!=null&&h.isAutoGenerated),{clusterMinSize:a,clusterMaxSize:l}=s;if(o){s.fields=[...n,...r];const d=this._withClusterVariable(s.renderer,a,l);return s.effectiveFeatureRenderer=d,s.effectiveClusterRenderer=d,s}if(i.symbol){if(s.fields=[...n,...r],s.renderer=null,!this.renderer)return s.effectiveFeatureRenderer=null,s.effectiveClusterRenderer=null,s;const d=cle(n,this.renderer),m=this._withClusterVariable(d,a,l),f="visualVariables"in m&&m.visualVariables?m.visualVariables:[],_=new Om({symbol:i.symbol,visualVariables:f});return s.fields=[...n,...r],s.effectiveFeatureRenderer=m,s.effectiveClusterRenderer=_,s}if(!this.renderer)return i;const u=cle(n,this.renderer);s.fields=[...n,...r],s.renderer=u;const c=this._withClusterVariable(u,a,l);return s.effectiveFeatureRenderer=c,s.effectiveClusterRenderer=c,s}};return y([S(tht)],e.prototype,"featureReduction",null),e=y([se("esri.layers.mixins.FeatureReductionLayer")],e),e},hle={ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GeoRSS:!0,GroupLayer:!0,KML:!0,KnowledgeGraphLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WCS:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},dle={ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,OpenStreetMap:!0,VectorTileLayer:!0,WCS:!0,WMS:!0,WebTiledLayer:!0},mle={ArcGISFeatureLayer:!0,SubtypeGroupTable:!0},pht={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,CatalogLayer:!0,CSV:!0,GeoJSON:!0,GroupLayer:!0,IntegratedMesh3DTilesLayer:!0,Object3DTilesLayer:!0,IntegratedMeshLayer:!0,KML:!0,LineOfSightLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,RasterDataLayer:!0,VectorTileLayer:!0,ViewshedLayer:!0,Voxel:!0,WCS:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},"web-scene/basemap":{ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WCS:!0,WMS:!0,WebTiledLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-scene/tables":{ArcGISFeatureLayer:!0},"web-map/operational-layers":hle,"web-map/basemap":dle,"web-map/tables":mle,"link-chart/operational-layers":{...hle,LinkChartLayer:!0},"link-chart/basemap":dle,"link-chart/tables":mle,"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,BuildingSceneLayer:!0,IntegratedMesh3DTilesLayer:!0,IntegratedMeshLayer:!0,MediaLayer:!0,OrientedImageryLayer:!0,PointCloudLayer:!0,SubtypeGroupLayer:!0,WCS:!0},"portal-item/tables":{ArcGISFeatureLayer:!0,SubtypeGroupTable:!0}},fht=t=>{let e=class extends t{constructor(){super(...arguments),this.persistenceEnabled=!0,this.title=null}readId(i,s,n){var r;return((r=n==null?void 0:n.portalItem)==null?void 0:r.type)==="Group Layer"?void 0:i}writeListMode(i,s,n,r){(r&&r.layerContainerType==="ground"||i&&yCe(this,n,{},r))&&(s[n]=i)}writeOperationalLayerType(i,s,n){i&&(s[n]=i)}writeTitle(i,s){s.title=i??"Layer"}readVisibilityTimeExtent(i){return i?Uf.fromArray(i):null}writeVisibilityTimeExtent(i,s,n,r){i&&r.layerContainerType!=="tables"&&(i.isEmpty?r!=null&&r.messages&&r.messages.push(new Se("layer:invalid-visibilityTimeExtent","visibilityTimeExtent cannot be empty")):s[n]=i.toArray())}read(i,s){s&&(s.layer=this),fCe(this,i,n=>super.read(i,n),s)}write(i,s){var o,a;if(!this.persistenceEnabled&&!(s!=null&&s.ignorePersistenceEnabled))return null;if(s!=null&&s.origin){const l=`${s.origin}/${s.layerContainerType||"operational-layers"}`,u=pht[l];let c=!!(u!=null&&u[this.operationalLayerType]);if(this.operationalLayerType==="ArcGISTiledElevationServiceLayer"&&l==="web-scene/operational-layers"&&(c=!1),this.operationalLayerType==="ArcGISDimensionLayer"&&l==="web-map/operational-layers"&&(c=!1),!c)return(o=s.messages)==null||o.push(new Se("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${l}'`,{layer:this})),null}const n=super.write(i,{...s,layer:this}),r=!!s&&!!s.messages&&!!s.messages.filter(l=>l instanceof Se&&l.name==="web-document-write:property-required").length;return CF(n==null?void 0:n.url)?((a=s==null?void 0:s.messages)==null||a.push(new Se("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&r?null:n}beforeSave(){}};return y([S({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],e.prototype,"id",void 0),y([mt("id",["id"])],e.prototype,"readId",null),y([S(abe)],e.prototype,"listMode",void 0),y([yt("listMode")],e.prototype,"writeListMode",null),y([S({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1},"web-scene":{name:"layerType",read:!1,write:{enabled:!0,ignoreOrigin:!0,layerContainerTypes:rr,isRequired:!0}}}}})],e.prototype,"operationalLayerType",void 0),y([yt("operationalLayerType")],e.prototype,"writeOperationalLayerType",null),y([S(l9)],e.prototype,"opacity",void 0),y([S({type:Boolean,readOnly:!1})],e.prototype,"persistenceEnabled",void 0),y([S({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],e.prototype,"title",void 0),y([yt("title"),yt(["web-scene"],"title")],e.prototype,"writeTitle",null),y([S({type:Uf,json:{origins:{"web-scene":{write:{layerContainerTypes:rr}}}}})],e.prototype,"visibilityTimeExtent",void 0),y([mt("visibilityTimeExtent")],e.prototype,"readVisibilityTimeExtent",null),y([yt(["portal-item","web-map","web-scene"],"visibilityTimeExtent",{visibilityTimeExtent:{type:[[zs,vF]]}})],e.prototype,"writeVisibilityTimeExtent",null),y([S({type:Boolean,json:{name:"visibility",write:{layerContainerTypes:rr}}})],e.prototype,"visible",void 0),e=y([se("esri.layers.mixins.OperationalLayer")],e),e};var J9;const pR=new gs({asc:"ascending",desc:"descending"});let sw=J9=class extends it{constructor(t){super(t),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new J9({field:this.field,valueExpression:this.valueExpression,order:this.order})}};y([S({type:String,json:{write:!0}})],sw.prototype,"field",void 0),y([S({type:String,json:{write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],sw.prototype,"valueExpression",void 0),y([S({type:pR.apiValues,json:{type:pR.jsonValues,read:pR.read,write:pR.write}})],sw.prototype,"order",void 0),sw=J9=y([se("esri.layers.support.OrderByInfo")],sw);const fwe=sw;function ght(t,e,i){if(!t)return null;const s=t.find(r=>!!r.field);if(!s)return null;const n=new fwe;return n.read(s,i),[n]}function _ht(t,e,i,s){const n=t.find(r=>!!r.field);n&&la(i,[n.toJSON()],e)}const yht={type:[fwe],json:{origins:{"web-scene":{write:!1,read:!1}},name:"layerDefinition.orderBy",read:{reader:ght},write:{writer:_ht}}},vht=t=>{let e=class extends t{constructor(){super(...arguments),this.orderBy=null}};return y([S(yht)],e.prototype,"orderBy",void 0),e=y([se("esri.layers.mixins.OrderedLayer")],e),e};async function xht(t){const e=t.spatialReference;if(e.isWGS84)return t.clone();if(e.isWebMercator)return Ov(t);const i=Ri.WGS84;return await dY(e,i),jy(t,i)}function bht(t,e){if(!gwe(t,e)){const i=t.typeKeywords;i?i.push(e):t.typeKeywords=[e]}}function gwe(t,e){var i;return!!((i=t.typeKeywords)!=null&&i.includes(e))}function wEt(t){return gwe(t,Sht.HOSTED_SERVICE)}function wht(t,e){const i=t.typeKeywords;if(i){const s=i.indexOf(e);s>-1&&i.splice(s,1)}}function SEt(t,e,i){i?bht(t,e):wht(t,e)}async function EEt(t){const e=t.clone().normalize();let i;if(e.length>1)for(const s of e)i?s.width>i.width&&(i=s):i=s;else i=e[0];return xht(i)}const Sht={GROUP_LAYER_MAP:"Map",HOSTED_SERVICE:"Hosted Service",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",ORIENTED_IMAGERY_LAYER:"OrientedImageryLayer",SINGLE_LAYER:"Singlelayer",SUBTYPE_GROUP_LAYER:"SubtypeGroupLayer",SUBTYPE_GROUP_TABLE:"SubtypeGroupTable",TABLE:"Table",TILED_IMAGERY:"Tiled Imagery"};function Eht(t){var l;const{portal:e,isOrgItem:i,itemControl:s}=t,n=(l=e.user)==null?void 0:l.privileges;let r=!n||n.includes("features:user:edit"),o=!!i&&!!(n!=null&&n.includes("features:user:fullEdit"));const a=s==="update"||s==="admin";return a?o=r=!0:o&&(r=!0),{features:{edit:r,fullEdit:o},content:{updateItem:a}}}const Cht=t=>{let e=class extends t{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=er(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(i){i!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",i))}readPortalItem(i,s,n){if(s.itemId)return new rP({id:s.itemId,portal:n==null?void 0:n.portal})}writePortalItem(i,s){i!=null&&i.id&&(s.itemId=i.id)}async loadFromPortal(i,s){var n;if((n=this.portalItem)!=null&&n.id)try{const{load:r}=await _e(()=>import("./layersLoader-Bcl2Dpj-.js"),__vite__mapDeps([277,28,29,27,278]));return vr(s),await r({instance:this,supportedTypes:i.supportedTypes,validateItem:i.validateItem,supportsData:i.supportsData,layerModuleTypeMap:i.layerModuleTypeMap,populateGroupLayer:i.populateGroupLayer},s)}catch(r){throw cl(r)||ht.getLogger(this).warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})
  ${r}`),r}}async finishLoadEditablePortalLayer(i){this._set("userHasEditingPrivileges",await this._fetchUserHasEditingPrivileges(i).catch(s=>(ym(s),!0)))}async setUserPrivileges(i,s){if(!Ks.userPrivilegesApplied)return this.finishLoadEditablePortalLayer(s);if(this.url)try{const{features:{edit:n,fullEdit:r},content:{updateItem:o}}=await this._fetchUserPrivileges(i,s);this._set("userHasEditingPrivileges",n),this._set("userHasFullEditingPrivileges",r),this._set("userHasUpdateItemPrivileges",o)}catch(n){ym(n)}}async _fetchUserPrivileges(i,s){let n=this.portalItem;if(!i||!n||!n.loaded||n.sourceUrl)return this._fetchFallbackUserPrivileges(s);const r=!(Yi!=null&&Yi.findCredential(this.url)),o=i===n.id;if(o&&n.portal.user)return this._getUserPrivileges(n,r);let a,l;if(o)a=n.portal.url;else try{a=await yY(this.url,s)}catch(d){ym(d)}if(!a||!$Ce(a,n.portal.url))return this._fetchFallbackUserPrivileges(s);try{const d=s!=null?s.signal:null;l=await(Yi==null?void 0:Yi.getCredential(`${a}/sharing`,{prompt:!1,signal:d}))}catch(d){ym(d)}const u=!0,c=!1,h=!1;if(!l)return{features:{edit:u,fullEdit:c},content:{updateItem:h}};try{if(o?await n.reload():(n=new rP({id:i,portal:{url:a}}),await n.load(s)),n.portal.user)return this._getUserPrivileges(n,r)}catch(d){ym(d)}return{features:{edit:u,fullEdit:c},content:{updateItem:h}}}_getUserPrivileges(i,s){const n=Eht(i);return s&&(n.features.edit=!0),n}async _fetchFallbackUserPrivileges(i){let s=!0;try{s=await this._fetchUserHasEditingPrivileges(i)}catch(n){ym(n)}return{features:{edit:s,fullEdit:!1},content:{updateItem:!1}}}async _fetchUserHasEditingPrivileges(i){const s=this.url?Yi==null?void 0:Yi.findCredential(this.url):null;if(!s)return!0;const n=fR.credential===s?fR.user:await this._fetchEditingUser(i);return fR.credential=s,fR.user=n,(n==null?void 0:n.privileges)==null||n.privileges.includes("features:user:edit")}async _fetchEditingUser(i){var c,h;const s=(h=(c=this.portalItem)==null?void 0:c.portal)==null?void 0:h.user;if(s)return s;const n=Yi==null?void 0:Yi.findServerInfo(this.url??"");if(!(n!=null&&n.owningSystemUrl))return null;const r=`${n.owningSystemUrl}/sharing/rest`,o=Cu.getDefault();if(o&&o.loaded&&hd(o.restUrl)===hd(r))return o.user;const a=`${r}/community/self`,l=i!=null?i.signal:null,u=await qF($n(a,{authMode:"no-prompt",query:{f:"json"},signal:l}));return u.ok?p7.fromJSON(u.value.data):null}read(i,s){s&&(s.layer=this),super.read(i,s)}write(i,s){var o;const n=s==null?void 0:s.portal,r=((o=this.portalItem)==null?void 0:o.id)&&(this.portalItem.portal||Cu.getDefault());return n&&r&&!tce(r.restUrl,n.restUrl)?(s.messages&&s.messages.push(new Se("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(i,{...s,layer:this})}};return y([S({type:rP})],e.prototype,"portalItem",null),y([mt("web-document","portalItem",["itemId"])],e.prototype,"readPortalItem",null),y([yt("web-document","portalItem",{itemId:{type:String}})],e.prototype,"writePortalItem",null),y([S({clonable:!1})],e.prototype,"resourceReferences",void 0),y([S({type:Boolean,readOnly:!0})],e.prototype,"userHasEditingPrivileges",void 0),y([S({type:Boolean,readOnly:!0})],e.prototype,"userHasFullEditingPrivileges",void 0),y([S({type:Boolean,readOnly:!0})],e.prototype,"userHasUpdateItemPrivileges",void 0),e=y([se("esri.layers.mixins.PortalLayer")],e),e},fR={credential:null,user:null};let OT=class extends ei{constructor(){super(...arguments),this.updating=!1,this.status="unknown"}};y([S()],OT.prototype,"updating",void 0),y([S()],OT.prototype,"status",void 0),OT=y([se("esri.layers.support.PublishingInfo")],OT);const Tht=OT,Pht=Symbol(),Mht=t=>{var e;let i=class extends t{constructor(){super(...arguments),this[e]=!0}get publishingInfo(){if(this.destroyed)return null;const s=this._get("publishingInfo");if(s)return s;const n=new Tht;return this._checkPublishingStatus(n),n}_checkPublishingStatus(s){let o=0;const a=async u=>{let c;s.updating=!0;try{c=await this.fetchPublishingStatus()}catch{c="unavailable"}c!=="published"&&c!=="unavailable"||(s.status==="publishing"&&this.refresh(),l.remove()),s.status=c,s.updating=!1,l.removed||(o=setTimeout(a,u,u+125))},l={removed:!1,remove(){this.removed=!0,clearTimeout(o)}};this.when().catch(()=>l.remove()),a(250),this.addHandles(l)}};return e=Pht,y([S({readOnly:!0,clonable:!1})],i.prototype,"publishingInfo",null),i=y([se("esri.layers.mixins.PublishableLayer")],i),i},ey=new Nt,fP=new WeakMap;function Aht(t){Dht(t)&&ey.push(new WeakRef(t))}function Iht(t){const e=ey.find(i=>i.deref()===t);e&&ey.remove(e)}function Dht(t){return t!=null&&typeof t=="object"&&"refreshInterval"in t&&"refresh"in t}function _we(t,e){return Number.isFinite(t)&&Number.isFinite(e)?e<=0?t:_we(e,t%e):0}let KV=0,gR=0;function Nht(){const t=Date.now();let e=!1;for(const i of ey){const s=i.deref();s?s.refreshInterval&&t-(fP.get(s)??0)+5>=6e4*s.refreshInterval&&(fP.set(s,t),s.refresh(t)):e=!0}if(e)for(let i=ey.length-1;i>=0;i--)ey.at(i).deref()||ey.removeAt(i)}kue(()=>{const t=Date.now();let e=0;for(const i of ey){const s=i.deref();s&&(e=_we(Math.round(6e4*s.refreshInterval),e),s.refreshInterval?fP.get(s)||fP.set(s,t):fP.delete(s))}if(e!==gR){if(gR=e,clearInterval(KV),gR===0)return void(KV=0);KV=setInterval(Nht,gR)}},km);const ple=.1,Rht=t=>{let e=class extends t{constructor(...i){super(...i),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=mH(()=>this.hasDataChanged()),this.when().then(()=>{this.destroyed||Aht(this)},()=>{})}destroy(){Iht(this)}castRefreshInterval(i){return i>=ple?i:i<=0?0:ple}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(i=Date.now()){vP(this._debounceHasDataChanged()).then(s=>{s&&this._set("refreshTimestamp",i),this.emit("refresh",{dataChanged:s})},s=>{ht.getLogger(this).error(s),this.emit("refresh",{dataChanged:!1,error:s})})}async hasDataChanged(){return!0}get test(){}};return y([S({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:rr}}}}})],e.prototype,"refreshInterval",void 0),y([Ls("refreshInterval")],e.prototype,"castRefreshInterval",null),y([S({readOnly:!0})],e.prototype,"refreshTimestamp",void 0),y([S({readOnly:!0})],e.prototype,"refreshParameters",null),e=y([se("esri.layers.mixins.RefreshableLayer")],e),e},ywe=ca()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0});let LT=class extends bs.ClonableMixin(it){constructor(e){super(e),this.unit="milliseconds",this.value=0}toMilliseconds(){return h_e(this.value,this.unit,"milliseconds")}};y([ai(ywe,{nonNullable:!0})],LT.prototype,"unit",void 0),y([S({type:Number,json:{write:!0},nonNullable:!0})],LT.prototype,"value",void 0),LT=y([se("esri.time.TimeInterval")],LT);const IM=LT;function fle(t,e){return IM.fromJSON({value:t,unit:e})}let Ea=class extends bs.ClonableMixin(it){constructor(e){super(e),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeZone=null,this.trackIdField=null,this.useTime=!0,this.stops=null}readFullTimeExtent(e,i){return i.timeExtent&&Array.isArray(i.timeExtent)&&i.timeExtent.length===2?Uf.fromArray(i.timeExtent):null}writeFullTimeExtent(e,i){(e==null?void 0:e.start)!=null&&e.end!=null?i.timeExtent=e.toArray():i.timeExtent=null}readInterval(e,i){return i.timeInterval&&i.timeIntervalUnits?fle(i.timeInterval,i.timeIntervalUnits):i.defaultTimeInterval&&i.defaultTimeIntervalUnits?fle(i.defaultTimeInterval,i.defaultTimeIntervalUnits):null}writeInterval(e,i){i.timeInterval=(e==null?void 0:e.toJSON().value)??null,i.timeIntervalUnits=(e==null?void 0:e.toJSON().unit)??null}};y([S({type:Boolean,json:{name:"exportOptions.timeDataCumulative",write:!0}})],Ea.prototype,"cumulative",void 0),y([S({type:String,json:{name:"endTimeField",write:{enabled:!0,allowNull:!0}}})],Ea.prototype,"endField",void 0),y([S({type:Uf,json:{write:{enabled:!0,allowNull:!0}}})],Ea.prototype,"fullTimeExtent",void 0),y([mt("fullTimeExtent",["timeExtent"])],Ea.prototype,"readFullTimeExtent",null),y([yt("fullTimeExtent")],Ea.prototype,"writeFullTimeExtent",null),y([S({type:Boolean,json:{write:!0}})],Ea.prototype,"hasLiveData",void 0),y([S({type:IM,json:{write:{enabled:!0,allowNull:!0}}})],Ea.prototype,"interval",void 0),y([mt("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],Ea.prototype,"readInterval",null),y([yt("interval")],Ea.prototype,"writeInterval",null),y([S({type:String,json:{name:"startTimeField",write:{enabled:!0,allowNull:!0}}})],Ea.prototype,"startField",void 0),y([S(XO("timeReference",!0))],Ea.prototype,"timeZone",void 0),y([S({type:String,json:{write:{enabled:!0,allowNull:!0}}})],Ea.prototype,"trackIdField",void 0),y([S({type:Boolean,json:{name:"exportOptions.useTime",write:!0}})],Ea.prototype,"useTime",void 0),y([S({type:[Date],json:{read:!1}})],Ea.prototype,"stops",void 0),Ea=y([se("esri.layers.support.TimeInfo")],Ea);const vwe=Ea,Oht={type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation",layerContainerTypes:rr}}},Lht=t=>{let e=class extends t{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(i,s){const n=s.timeInfo.exportOptions;if(!n)return null;const r=n.timeOffset,o=ywe.fromJSON(n.timeOffsetUnits);return r&&o?new IM({value:r,unit:o}):null}set timeInfo(i){Ede(i,this.fieldsIndex),this._set("timeInfo",i)}};return y([S({type:Uf,json:{write:!1}})],e.prototype,"timeExtent",void 0),y([S({type:IM})],e.prototype,"timeOffset",void 0),y([mt("service","timeOffset",["timeInfo.exportOptions"])],e.prototype,"readOffset",null),y([S({value:null,type:vwe,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],e.prototype,"timeInfo",null),y([S(Oht)],e.prototype,"useViewTime",void 0),e=y([se("esri.layers.mixins.TemporalLayer")],e),e};let wv=class extends bs.ClonableMixin(it){constructor(e){super(e),this.labelingInfo=null,this.labelsVisible=!0,this.renderer=null,this.visible=!0}};y([S({type:[MA],json:{write:!0}})],wv.prototype,"labelingInfo",void 0),y([S(hk)],wv.prototype,"labelsVisible",void 0),y([S({types:AA,json:{write:!0}})],wv.prototype,"renderer",void 0),y([S({type:Boolean,json:{write:!0}})],wv.prototype,"visible",void 0),wv=y([se("esri.layers.support.TrackPartInfo")],wv);const jw=wv;let ou=class extends bs.ClonableMixin(it){constructor(e){super(e),this.enabled=!0,this.fields=[],this.latestObservations=new jw({renderer:new Om({symbol:nF.clone()})}),this.maxDisplayDuration=null,this.maxDisplayObservationsPerTrack=0,this.popupEnabled=!0,this.popupTemplate=null,this.previousObservations=new jw({renderer:new Om({symbol:nF.clone()})}),this.trackLines=new jw({renderer:new Om({symbol:nX.clone()})}),this.timeField="startTimeField"}writeFields(e,i,s){const n=e.filter(r=>r.statisticType!=="avg_angle").map(r=>r.toJSON());la(s,n,i)}};y([S({type:Boolean,json:{write:!0}})],ou.prototype,"enabled",void 0),y([S({type:[Ry],json:{write:!0}})],ou.prototype,"fields",void 0),y([yt("fields")],ou.prototype,"writeFields",null),y([S({type:jw,json:{write:!0}})],ou.prototype,"latestObservations",void 0),y([S({type:IM,json:{write:!0}})],ou.prototype,"maxDisplayDuration",void 0),y([S({type:Number,json:{write:!0}})],ou.prototype,"maxDisplayObservationsPerTrack",void 0),y([S(ck)],ou.prototype,"popupEnabled",void 0),y([S({type:HS,json:{name:"popupInfo",write:!0}})],ou.prototype,"popupTemplate",void 0),y([S({type:jw,json:{write:!0}})],ou.prototype,"previousObservations",void 0),y([S({type:jw,json:{write:!0}})],ou.prototype,"trackLines",void 0),y([S({type:["timeReceived","startTimeField","endTimeField"],json:{read:!0,write:!0}})],ou.prototype,"timeField",void 0),ou=y([se("esri.layers.support.TrackInfo")],ou);const Fht=ou,kht=t=>{let e=class extends t{constructor(){super(...arguments),this.trackInfo=null}};return y([S({type:Fht})],e.prototype,"trackInfo",void 0),e=y([se("esri.layers.mixins.TrackableLayer")],e),e},gle=new gs({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});let A_=class extends bs.ClonableMixin(it){constructor(e){super(e),this.name=null,this.description=null,this.drawingTool=null,this.prototype=null,this.thumbnail=null}};y([S({json:{write:!0}})],A_.prototype,"name",void 0),y([S({json:{write:!0}})],A_.prototype,"description",void 0),y([S({json:{read:gle.read,write:gle.write}})],A_.prototype,"drawingTool",void 0),y([S({json:{write:!0}})],A_.prototype,"prototype",void 0),y([S({json:{write:!0}})],A_.prototype,"thumbnail",void 0),A_=y([se("esri.layers.support.FeatureTemplate")],A_);const xX=A_;let rf=class extends bs.ClonableMixin(it){constructor(e){super(e),this.id=null,this.name=null,this.domains=null,this.templates=null}readDomains(e){const i={};for(const s of Object.keys(e))i[s]=W4(e[s]);return i}writeDomains(e,i){var n;const s={};for(const r of Object.keys(e))e[r]&&(s[r]=(n=e[r])==null?void 0:n.toJSON());i.domains=s}};y([S({json:{write:!0}})],rf.prototype,"id",void 0),y([S({json:{write:!0}})],rf.prototype,"name",void 0),y([S({json:{write:!0}})],rf.prototype,"domains",void 0),y([mt("domains")],rf.prototype,"readDomains",null),y([yt("domains")],rf.prototype,"writeDomains",null),y([S({type:[xX],json:{write:!0}})],rf.prototype,"templates",void 0),rf=y([se("esri.layers.support.FeatureType")],rf);const xwe=rf;function $ht(){return{fields:{type:[vY],value:null,set:function(t){if(t&&ke("big-integer-warning-enabled")){const e=t.filter(i=>i.type==="big-integer"||i.type==="oid"&&(i.length||0)>=8);if(e.length){const i=e.map(s=>`'${s.name}'`).join(", ");ht.getLogger(this).warn("#fields",`Layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}') references big-integer field(s): ${i}, support for which is experimental. Only integers less than ${Number.MAX_SAFE_INTEGER} (Number.MAX_SAFE_INTEGER) are supported.`)}}this._set("fields",t)}},fieldsIndex:{readOnly:!0,get(){return Hbe.fromLayer(this)}},outFields:{type:[String],json:{read:!1},set:function(t){this._userOutFields=t,this.notifyChange("outFields")},get:function(){var e;const t=this._userOutFields;if(!(t!=null&&t.length))return null;if(t.includes("*"))return["*"];if(!this.fields)return t;for(const i of t)((e=this.fieldsIndex)==null?void 0:e.has(i))||ht.getLogger("esri.layers.support.fieldProperties").error("field-attributes-layer:invalid-field",`Invalid field ${i} found in outFields`,{layer:this,outFields:t});return UF(this.fieldsIndex,t)}}}}const QV=()=>ht.getLogger("esri.layers.support.labelingInfo"),Uht=/\[([^[\]]+)\]/gi;function JV(t,e,i){return t?t.map(s=>{var r;const n=new MA;if(n.read(s,i),n.labelExpression){const o=e.fields||((r=e.layerDefinition)==null?void 0:r.fields)||this.fields;n.labelExpression=n.labelExpression.replaceAll(Uht,(a,l)=>`[${Vht(l,o)}]`)}return n}):null}function Vht(t,e){if(!e)return t;const i=t.toLowerCase();for(let s=0;s<e.length;s++){const n=e[s].name;if(n.toLowerCase()===i)return n}return t}const zht={esriGeometryPoint:["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],esriGeometryMultiPatch:["always-horizontal"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along","above-along","below-along"],esriGeometryMultipoint:null,esriGeometryEnvelope:null};function NEt(t,e){const i=[];for(const s of t){const n=s.labelPlacement,r=zht[e];if(!s.symbol)return QV().warn("No ILabelClass symbol specified."),[];if(!r)return QV().error(new Se("labeling:unsupported-geometry-type",`Unable to create labels for layer, geometry type '${e}' is not supported`)),[];if(r.includes(n))i.push(s);else{const o=r[0];n&&QV().warn(`Found invalid label placement type ${n} for ${e}. Defaulting to ${o}`);const a=s.clone();a.labelPlacement=o,i.push(a)}}return i}const Ght="relationships/",Bht="expression/";let El=class extends ei{constructor(e){super(e),this._featureUtils=null,this.effectivePopupTemplate=null}get _arcadeTask(){return this.expressionsUsedInTitle.length>0?this._get("_arcadeTask")||KM(()=>gy()):null}get featureUtilsPromise(){return this._get("featureUtilsPromise")??_e(()=>import("./featureUtils-sTpFvq4B.js"),__vite__mapDeps([175,35])).then(e=>this._featureUtils=e)}get calculatedExpressions(){var i;const e=new Nt;if(!this.expressionsUsedInTitle.length)return e;if(!((i=this._arcadeTask)!=null&&i.value)){for(const s of this.expressionsUsedInTitle??[])e.push({name:s.name,invalid:!0});return e}for(const s of this.expressionsUsedInTitle)try{const n=this._arcadeTask.value.arcade.parseScript(s.expression,["$layer","$map","$datastore"]);if(n.isAsync){e.push({name:s.name,invalid:!0});break}e.push({name:s.name,syntax:n,invalid:!1,func:this._arcadeTask.value.arcade.compileScript(n,{vars:{$feature:"any"}})})}catch{e.push({name:s.name,invalid:!0});break}return e}get expressionsUsedInTitle(){var i,s,n;let e=((i=this.effectivePopupTemplate)==null?void 0:i.title)??"";return typeof e!="string"?[]:(e=e.toLowerCase(),((n=(s=this.effectivePopupTemplate)==null?void 0:s.expressionInfos)==null?void 0:n.filter(r=>e.includes(`{expression/${r.name.toLowerCase()}}`)))??[])}get fieldInfoMap(){return this._featureUtils?this._createFieldInfoMap(this._featureUtils.getAllFieldInfos(this.effectivePopupTemplate)):null}get hasBadExpressions(){return this.calculatedExpressions.some(e=>e.invalid===!0)}get requiredFields(){var s,n;const e=new Set;if((s=this._arcadeTask)!=null&&s.value&&!this.hasBadExpressions)for(const r of((n=this.calculatedExpressions)==null?void 0:n.toArray())??[])try{const o=this._arcadeTask.value.arcade.extractFieldLiterals(r.syntax);for(const a of o){const l=a.split("."),u=this.fieldsIndex.get(l.at(-1)??"");u&&e.add(u.name)}}catch{}const i=this._extractFieldNames(this.workingTitle);for(const r of i){const o=this.fieldsIndex.get(r);o&&e.add(o.name)}return e}get titleFromDisplayField(){var i,s;let e="";return this.displayField&&(e=((i=this.fieldsIndex.get(this.displayField))==null?void 0:i.name)??""),e||(e=((s=this.fieldsIndex.get(this.objectIdField))==null?void 0:s.name)??""),e?`{${e}}`:""}get workingTitle(){const e=this.effectivePopupTemplate?this.effectivePopupTemplate.title:"";return e===""||e==null||this.hasBadExpressions||typeof e!="string"?this.titleFromDisplayField:e}async getTitle(e,i,s){var n;try{const{attributes:r}=i,o=(s==null?void 0:s.timeZone)??"system",[{substituteFieldsInLinksAndAttributes:a}]=await Promise.all([this.featureUtilsPromise,(n=this._arcadeTask)==null?void 0:n.promise]);if(s.fetchMissingFields&&(i=await this._checkAndReQueryGraphic(e,i)),this.workingTitle&&this.fieldInfoMap){const l=this._createFormattedAttributes(e,i,o).global;return a({attributes:r,expressionAttributes:null,fieldInfoMap:this.fieldInfoMap,globalAttributes:l,layer:e,text:this.workingTitle})}return""}catch{}return""}async _checkAndReQueryGraphic(e,i){const s=i.getObjectId();if(s==null)return i;if(!bDe(this.requiredFields,i)){const n=e.createQuery();n.where="1=1",n.outFields=[...this.requiredFields],n.objectIds=[s];const r=await e.queryFeatures(n);if((r==null?void 0:r.features.length)===1)return r.features[0]}return i}_createFieldInfoMap(e){const i=new Map;if(!e)return i;for(const s of e){if(!s.fieldName)continue;const n=this.fieldsIndex.get(s.fieldName),r=(n==null?void 0:n.name)??s.fieldName;s.fieldName=r,i.set(r.toLowerCase(),s)}return i}_createFormattedAttributes(e,i,s="system"){var a,l;const n=((a=this.effectivePopupTemplate)==null?void 0:a.fieldInfos)??[],r={};if(!this._featureUtils)return{};if(!this.hasBadExpressions&&this.calculatedExpressions.length>0&&((l=this._arcadeTask)!=null&&l.value)){const u=this._arcadeTask.value.Feature.createFromGraphicLikeObject(i.geometry,i.attributes,e,null);for(const c of this.calculatedExpressions)try{r[`expression/${c.name}`]=c.func({vars:{$feature:u}})}catch{}}const o={...i.attributes,...r};return{global:this._featureUtils.formatAttributes({fieldInfos:n,attributes:o,graphic:i,timeZone:s,layer:e,fieldInfoMap:this.fieldInfoMap}),content:[]}}_extractFieldNames(e){return QH(e).filter(i=>!(i.indexOf(Ght)===0||i.indexOf(Bht)===0))}};y([S({readOnly:!0})],El.prototype,"_arcadeTask",null),y([S()],El.prototype,"_featureUtils",void 0),y([S({readOnly:!0})],El.prototype,"featureUtilsPromise",null),y([S({readOnly:!0})],El.prototype,"calculatedExpressions",null),y([S()],El.prototype,"displayField",void 0),y([S()],El.prototype,"effectivePopupTemplate",void 0),y([S()],El.prototype,"expressionsUsedInTitle",null),y([S()],El.prototype,"fieldsIndex",void 0),y([S()],El.prototype,"fieldInfoMap",null),y([S()],El.prototype,"fields",void 0),y([S()],El.prototype,"objectIdField",void 0),y([S()],El.prototype,"requiredFields",null),El=y([se("esri.layers.support.TitleCreator")],El);const qht=El,nw=[];function Hht(t,e){if(MO(t.url??""))return!0;const{wkid:i}=e;for(const s of nw){if((t.version??0)>=s[0])return!0;if(typeof s[1]=="function"&&(s[1]=s[1]()),s[1].has(i))return!1}return!0}nw.push([10.91,()=>{const t=new Set([9709,9716,9741,9761,9766]);for(let e=9712;e<=9713;e++)t.add(e);for(let e=9748;e<=9749;e++)t.add(e);for(let e=20904;e<=20932;e++)t.add(e);for(let e=21004;e<=21032;e++)t.add(e);for(let e=21207;e<=21264;e++)t.add(e);for(let e=21307;e<=21364;e++)t.add(e);for(let e=23301;e<=23333;e++)t.add(e);for(let e=102759;e<=102760;e++)t.add(e);for(let e=102934;e<=102955;e++)t.add(e);return t}]),nw.push([10.9,()=>{const t=new Set([9300,9354,9364,9367,9373,9377,9387,9456,9473,9498,9678,9680,29874,103599,103872,104028]);for(let e=9356;e<=9360;e++)t.add(e);for(let e=9404;e<=9407;e++)t.add(e);for(let e=9476;e<=9482;e++)t.add(e);for(let e=9487;e<=9494;e++)t.add(e);for(let e=9697;e<=9699;e++)t.add(e);return t}]),nw.push([10.81,()=>{const t=new Set([9265,9333,103598,103699]);for(let e=9248;e<=9254;e++)t.add(e);for(let e=9271;e<=9273;e++)t.add(e);for(let e=9284;e<=9285;e++)t.add(e);for(let e=21453;e<=21463;e++)t.add(e);return t}]),nw.push([10.8,()=>{const t=new Set([8088,8395,8428,8433,8531,8687,8692,8694,8699,8900,9003,9006,9009,9012,9017,9191]);for(let e=8035;e<=8036;e++)t.add(e);for(let e=8455;e<=8456;e++)t.add(e);for(let e=8518;e<=8529;e++)t.add(e);for(let e=8533;e<=8536;e++)t.add(e);for(let e=8538;e<=8540;e++)t.add(e);for(let e=8677;e<=8679;e++)t.add(e);for(let e=8902;e<=8903;e++)t.add(e);for(let e=8907;e<=8910;e++)t.add(e);for(let e=8949;e<=8951;e++)t.add(e);for(let e=8972;e<=8987;e++)t.add(e);for(let e=9039;e<=9040;e++)t.add(e);for(let e=9068;e<=9069;e++)t.add(e);for(let e=9140;e<=9141;e++)t.add(e);for(let e=9148;e<=9150;e++)t.add(e);for(let e=9153;e<=9159;e++)t.add(e);for(let e=9205;e<=9218;e++)t.add(e);for(let e=9221;e<=9222;e++)t.add(e);for(let e=54098;e<=54101;e++)t.add(e);return t}]),nw.push([10.71,()=>{const t=new Set([6316]);for(let e=8351;e<=8353;e++)t.add(e);for(let e=9294;e<=9297;e++)t.add(e);for(let e=22619;e<=22621;e++)t.add(e);for(let e=103586;e<=103594;e++)t.add(e);return t}]);async function jht(t,e,i){const s=t&&t.getAtOrigin&&t.getAtOrigin("renderer",e.origin);if(s&&s.type==="unique-value"&&s.styleOrigin){const n=await qF(s.populateFromStyle());if(vr(i),n.ok===!1){const r=n.error;e!=null&&e.messages&&e.messages.push(new ih("renderer:style-reference",`Failed to create unique value renderer from style reference: ${r.message}`,{error:r,context:e})),t.clear("renderer",e==null?void 0:e.origin)}}}function Yht({displayField:t,editFieldsInfo:e,fields:i,objectIdField:s,title:n},r){if(!i)return null;const o=Kht({editFieldsInfo:e,fields:i,objectIdField:s},r);if(!o.length)return null;const a=edt({titleBase:n,fields:i,displayField:t}),l=Jht();return new HS({title:a,content:l,fieldInfos:o})}function OEt(t){var u;const{title:e,graphic:i}=t??{},{attributes:s,sourceLayer:n}=i??{},r=n&&"displayField"in n?n.displayField:null,o=r?s==null?void 0:s[r]:null,a=o!=null?JSON.stringify(o):null,l=(u=i==null?void 0:i.getObjectId())==null?void 0:u.toString();return e||a||l||""}const Xht=(t,e)=>e.visibleFieldNames?e.visibleFieldNames.has(t.name):eDe(t,e);function Wht({fields:t,ignoreFieldTypes:e,sortDisabled:i}){const s=t;return e&&(t=t.filter(n=>!e.includes(n.type))),t===s&&(t=t.slice()),i!==!0&&t.sort(Zht),t}function Zht(t,e){return t.type==="oid"?-1:e.type==="oid"?1:_le(t)?-1:_le(e)?1:(t.alias||t.name).toLocaleLowerCase().localeCompare((e.alias||e.name).toLocaleLowerCase())}function Kht(t,e){const i=e==null?void 0:e.visibleFieldNames;return Wht({fields:t.fields??[],ignoreFieldTypes:(e==null?void 0:e.ignoreFieldTypes)||tdt,sortDisabled:e==null?void 0:e.sortDisabled}).map(s=>new i7({fieldName:s.name,isEditable:JIe(s,t),label:s.alias,format:Qht(s),visible:Xht(s,{...t,visibleFieldNames:i})}))}function Qht(t){switch(t.type){case"small-integer":case"integer":case"single":return new $R({digitSeparator:!0,places:0});case"double":return new $R({digitSeparator:!0,places:2});case"string":return SDe(t.name)?new $R({digitSeparator:!0,places:0}):void 0;default:return}}function Jht(){return[new aS,new oS]}function edt(t){const e=qIe(t),{titleBase:i}=t;return e?`${i}: {${e.trim()}}`:i??""}function _le(t){var i;return(t.name&&t.name.toLowerCase())==="name"?!0:((i=t.alias)==null?void 0:i.toLowerCase())==="name"}const tdt=["geometry","blob","raster","guid","xml"];var xw;(function(t){t[t.SAVE=0]="SAVE",t[t.SAVE_AS=1]="SAVE_AS"})(xw||(xw={}));const wa="FeatureLayer";function _R(t,e){return new Se("layer:unsupported",`Layer (${t.title}, ${t.id}) of type '${t.declaredClass}' ${e}`,{layer:t})}function yle(t){return t&&t instanceof Nt}const ez=$ht();function tz(t,e,i){const s=!!(i!=null&&i.writeLayerSchema);return{enabled:s,ignoreOrigin:s}}let Wt=class extends xut(mht(Jot(Mht(Wot(Got(D_e(vht(Lht(kht(N_e(Rht(Not(fht(Cht(Vxe(Rot(Dot(bs.ClonableMixin(A4))))))))))))))))))){constructor(...t){super(...t),this.attributeTableTemplate=null,this.charts=null,this.copyright=null,this.displayField=null,this.dynamicDataSource=null,this.fields=null,this.fieldsIndex=null,this.formTemplate=null,this.fullExtent=null,this.geometryType=null,this.hasM=void 0,this.hasZ=void 0,this.infoFor3D=null,this.isTable=!1,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.objectIdField=null,this.operationalLayerType="ArcGISFeatureLayer",this.outFields=null,this.path=null,this.popupEnabled=!0,this.popupTemplate=null,this.resourceInfo=null,this.screenSizePerspectiveEnabled=!0,this.spatialReference=Ri.WGS84,this.subtypeCode=null,this.supportedSourceTypes=new Set(["Feature Layer","Oriented Imagery Layer","Table","Catalog Layer"]),this.templates=null,this.timeInfo=null,this.title=null,this.sublayerTitleMode="item-title",this.type="feature",this.typeIdField=null,this.types=null,this.visible=!0,this._debouncedSaveOperations=mH(async(e,i,s)=>{const{save:n,saveAs:r}=await _e(()=>import("./featureLayerUtils-CztLS3i_.js"),__vite__mapDeps([279,280,281,282,278,283,28]));switch(e){case xw.SAVE:return n(this,i);case xw.SAVE_AS:return r(this,s,i)}})}destroy(){var t;(t=this.source)==null||t.destroy()}normalizeCtorArgs(t,e){return typeof t=="string"?{url:t,...e}:t}load(t){var s;const e=t!=null?t.signal:null;if((s=this.portalItem)!=null&&s.loaded&&this.source)return this.addResolvingPromise(this.createGraphicsSource(e).then(n=>this.initLayerProperties(n))),Promise.resolve(this);const i=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection","Scene Service"]},t).catch(ym).then(async()=>{if(this.url&&this.layerId==null&&/FeatureServer|MapServer\/*$/i.test(this.url)){const n=await this._fetchFirstValidLayerId(e);n!=null&&(this.layerId=n)}if(!this.url&&!this._hasMemorySource())throw new Se("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");return this.initLayerProperties(await this.createGraphicsSource(e))}).then(()=>zlt(this,"load",t));return this.addResolvingPromise(i),Promise.resolve(this)}get _titleCreator(){const t=this._get("_titleCreator");return er(t),new qht({fieldsIndex:this.fieldsIndex,objectIdField:this.objectIdField,fields:this.fields,displayField:this.displayField,effectivePopupTemplate:this.popupTemplate??this.defaultPopupTemplate})}readCapabilities(t,e){return e=e.layerDefinition||e,$be(e,this.url)}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("dynamicDataSource"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("gdbVersion"),this.commitProperty("historicMoment"),this.commitProperty("returnZ"),this.commitProperty("capabilities"),this.commitProperty("returnM"),(this._get("createQueryVersion")??0)+1}get editingEnabled(){var t;return!(this.loaded&&!((t=this.capabilities)!=null&&t.operations.supportsEditing))&&(this._isOverridden("editingEnabled")?this._get("editingEnabled"):this._hasMemorySource()||this.userHasEditingPrivileges)}set editingEnabled(t){this._overrideIfSome("editingEnabled",t)}readEditingEnabled(t,e){return this._readEditingEnabled(e,!1)}readEditingEnabledFromWebMap(t,e,i){return this._readEditingEnabled(e,!0,i)}writeEditingEnabled(t,e){this._writeEditingEnabled(t,e,!1)}writeEditingEnabledToWebMap(t,e,i,s){this._writeEditingEnabled(t,e,!0,s)}get effectiveEditingEnabled(){return qlt(this)}get featureTitleFields(){return[...this._titleCreator.requiredFields]}readIsTable(t,e){return(e=(e==null?void 0:e.layerDefinition)??e).type==="Table"||!e.geometryType}writeIsTable(t,e,i,s){s!=null&&s.writeLayerSchema&&la(i,t?"Table":"Feature Layer",e)}readGlobalIdField(t,e){return Pbe(e.layerDefinition||e)}readObjectIdField(t,e){return Mbe(e.layerDefinition||e)}get parsedUrl(){const t=ol(this.url);return t!=null&&(this.dynamicDataSource!=null?t.path=Kw(t.path,"dynamicLayer"):this.layerId!=null&&(t.path=Kw(t.path,this.layerId.toString()))),t}get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(t){AQ(t,this.fieldsIndex),this._set("renderer",t)}readRenderer(t,e,i){var n;e=e.layerDefinition||e;const s=(n=e.drawingInfo)==null?void 0:n.renderer;if(s){const r=AM(s,e,i)??void 0;return r||ht.getLogger(this).error("Failed to create renderer",{rendererDefinition:e.drawingInfo.renderer,layer:this,context:i}),r}return hX(e,i)}set source(t){const e=this._get("source");e!==t&&(yle(e)&&this._resetMemorySource(e),yle(t)&&this._initMemorySource(t),this._set("source",t))}castSource(t){return t?Array.isArray(t)||t instanceof Nt?new uf({layer:this,items:t}):t:null}readSource(t,e){const i=Xxe.fromJSON(e.featureSet);return new uf({layer:this,items:(i==null?void 0:i.features)??[]})}readTemplates(t,e){const i=e.editFieldsInfo,s=i==null?void 0:i.creatorField,n=i==null?void 0:i.editorField;return t=t==null?void 0:t.map(r=>xX.fromJSON(r)),this._fixTemplates(t,s),this._fixTemplates(t,n),t}readTitle(t,e){var n,r,o;const i=((n=e.layerDefinition)==null?void 0:n.name)??e.name,s=e.title||((r=e.layerDefinition)==null?void 0:r.title);if(i){const a=(o=this.portalItem)==null?void 0:o.title;if(this.sublayerTitleMode==="item-title")return this.url?aTe(this.url,i):i;let l=i;if(!l&&this.url){const u=VS(this.url);u!=null&&(l=u.title)}return l?(this.sublayerTitleMode==="item-title-and-service-name"&&a&&a!==l&&(l=a+" - "+l),MH(l)):void 0}if(this.sublayerTitleMode==="item-title"&&s)return s}readTitleFromWebMap(t,e){var i;return e.title||((i=e.layerDefinition)==null?void 0:i.name)}readTypeIdField(t,e){let i=(e=e.layerDefinition||e).typeIdField;if(i&&e.fields){i=i.toLowerCase();const s=e.fields.find(n=>n.name.toLowerCase()===i);s&&(i=s.name)}return i}readTypes(t,e){t=(e=e.layerDefinition||e).types;const i=e.editFieldsInfo,s=i==null?void 0:i.creatorField,n=i==null?void 0:i.editorField;return t==null?void 0:t.map(r=>(r=xwe.fromJSON(r),this._fixTemplates(r.templates,s),this._fixTemplates(r.templates,n),r))}readVisible(t,e){var i;return((i=e.layerDefinition)==null?void 0:i.defaultVisibility)!=null?!!e.layerDefinition.defaultVisibility:e.visibility!=null?!!e.visibility:void 0}async addAttachment(t,e){const i=await wlt(this,t,e,wa);return this.lastEditsEventDate=new Date,i}async updateAttachment(t,e,i){const s=await Slt(this,t,e,i,wa);return this.lastEditsEventDate=new Date,s}async applyEdits(t,e){return Elt(this,t,e)}async uploadAssets(t,e){return Clt(this,t,e)}on(t,e){return super.on(t,e)}createPopupTemplate(t){return Yht(this,t)}async createGraphicsSource(t){if(this._hasMemorySource()&&this.source)return this.source.load({signal:t});const{default:e}=await Aue(_e(()=>import("./FeatureLayerSource-CCk7ZwTi.js"),__vite__mapDeps([284,69,76,285,286,72,117,71,118,287,288,55,48,289,290,83,81,82,15,14,16,178,13])),t);return new e({layer:this,supportedSourceTypes:this.supportedSourceTypes}).load({signal:t})}createQuery(){const t=Llt(this);t.dynamicDataSource=this.dynamicDataSource;const e=this.subtypeCode!=null?`${this.subtypeField} = ${this.subtypeCode}`:null,i=mMe(this.definitionExpression,e);return t.where=i||"1=1",t}async deleteAttachments(t,e){const i=await Tlt(this,t,e,wa);return this.lastEditsEventDate=new Date,i}async fetchRecomputedExtents(t){return Plt(this,t,wa)}getFeatureTitle(t,e={timeZone:"system",fetchMissingFields:!1}){return this._titleCreator.getTitle(this,t,e)}getFeatureType(t){return Dbe(this.types,this.typeIdField,t)}getFieldDomain(t,e){var i;return klt(this,t,e,((i=this.getField(t))==null?void 0:i.domain)??null)}async queryAttachments(t,e){return Mlt(this,t,e,wa)}async queryFeatures(t,e){const i=await this.load(),s=await i.source.queryFeatures(Gf.from(t)??i.createQuery(),e);if(s!=null&&s.features)for(const n of s.features)n.layer=n.sourceLayer=i;return s}async queryObjectIds(t,e){return(await Alt(this,t,e,wa)).filter(ZK)}async queryFeatureCount(t,e){return Ilt(this,t,e,wa)}async queryExtent(t,e){return Dlt(this,t,e,wa)}async queryRelatedFeatures(t,e){return Nlt(this,t,e,wa)}async queryRelatedFeaturesCount(t,e){return Rlt(this,t,e,wa)}async queryTopFeatures(t,e){var o;const{source:i,capabilities:s}=await this.load();if(!i.queryTopFeatures||!((o=s==null?void 0:s.query)!=null&&o.supportsTopFeaturesQuery))throw new Se(wa,"Layer source does not support queryTopFeatures capability");const n=await _e(()=>import("./TopFeaturesQuery-BPnW3AM3.js"),[]),r=await i.queryTopFeatures(n.default.from(t),e);if(r!=null&&r.features)for(const a of r.features)a.layer=a.sourceLayer=this;return r}async queryAttributeBins(t,e){var o;const{source:i,capabilities:s}=await this.load();if(!i.queryAttributeBins||!((o=s==null?void 0:s.operations)!=null&&o.supportsQueryBins))throw new Se(wa,"Layer source does not support queryAttributeBins capability");Xlt(t,s,wa);const n=await _e(()=>import("./AttributeBinsQuery-BiuNQ2A0.js"),__vite__mapDeps([223,45,41,50])),r=await i.queryAttributeBins(n.default.from(t),e);if(r.features)for(const a of r.features)a.layer=a.sourceLayer=this;return r}async queryTopObjectIds(t,e){const{source:i,capabilities:s}=await this.load();if(!i.queryTopObjectIds||!(s!=null&&s.query.supportsTopFeaturesQuery))throw new Se(wa,"Layer source does not support queryTopObjectIds capability");const n=await _e(()=>import("./TopFeaturesQuery-BPnW3AM3.js"),[]);return(await i.queryTopObjectIds(n.default.from(t),e)).filter(ZK)}async queryTopFeaturesExtent(t,e){var r;const{source:i,capabilities:s}=await this.load();if(!i.queryTopExtents||!((r=s==null?void 0:s.query)!=null&&r.supportsTopFeaturesQuery))throw new Se(wa,"Layer source does not support queryTopExtents capability");const n=await _e(()=>import("./TopFeaturesQuery-BPnW3AM3.js"),[]);return i.queryTopExtents(n.default.from(t),e)}async queryTopFeatureCount(t,e){var r;const{source:i,capabilities:s}=await this.load();if(!i.queryTopCount||!((r=s==null?void 0:s.query)!=null&&r.supportsTopFeaturesQuery))throw new Se(wa,"Layer source does not support queryFeatureCount capability");const n=await _e(()=>import("./TopFeaturesQuery-BPnW3AM3.js"),[]);return i.queryTopCount(n.default.from(t),e)}read(t,e){const i=t.featureCollection;if((i||t.type==="Feature Collection")&&(this.resourceInfo=t),i){const s=i.layers;s&&s.length===1&&(super.read(s[0],e),i.showLegend!=null&&super.read({showLegend:i.showLegend},e))}super.read(t,e),e&&e.origin==="service"&&(this.revert(["objectIdField","fields","timeInfo","dateFieldsTimeZone"],"service"),this.spatialReference||this.revert(["spatialReference"],"service"))}write(t,e){e={...e,origin:(e==null?void 0:e.origin)??void 0,writeLayerSchema:(e==null?void 0:e.writeLayerSchema)??this._hasMemorySource()};const{origin:i,layerContainerType:s,messages:n}=e;if(this.dynamicDataSource)return n==null||n.push(_R(this,"using a dynamic data source cannot be written to web scenes, web maps and feature service items")),null;if(this.isTable){if((i==="web-map"||i==="web-scene")&&s!=="tables")return n==null||n.push(_R(this,`a table source can only be written to tables, not ${s}`)),null;if(this._hasMemorySource())return n==null||n.push(_R(this,"using an in-memory table source cannot be written to web scenes and web maps")),null}else if(this.loaded&&(i==="web-map"||i==="web-scene")&&s==="tables")return n==null||n.push(_R(this,"using a non-table source cannot be written to tables in web maps or web scenes")),null;return super.write(t,e)}clone(){if(this._hasMemorySource())throw new Se(wa,`FeatureLayer (title: ${this.title}, id: ${this.id}) created using in-memory source cannot be cloned`);return super.clone()}serviceSupportsSpatialReference(t){var e;return!!this.loaded&&(((e=this.source)==null?void 0:e.type)==="memory"||Hht(this,t))}async save(t){return this._debouncedSaveOperations(xw.SAVE,t)}async saveAs(t,e){return this._debouncedSaveOperations(xw.SAVE_AS,e,t)}_readEditingEnabled(t,e,i){var n;let s=(n=t.layerDefinition)==null?void 0:n.capabilities;return s?this._hasEditingCapability(s):(s=t.capabilities,e&&(i==null?void 0:i.origin)==="web-map"&&!this._hasMemorySource()&&s?this._hasEditingCapability(s):void 0)}_hasEditingCapability(t){return t.toLowerCase().split(",").map(e=>e.trim()).includes("editing")}_writeEditingEnabled(t,e,i,s){var n,r;if(!t){const o=(r=(n=this.capabilities)==null?void 0:n.operations)!=null&&r.supportsSync?"Query,Sync":"Query";la("layerDefinition.capabilities",o,e),i&&!(s!=null&&s.writeLayerSchema)&&(e.capabilities=o)}}_fetchFirstValidLayerId(t){return $n(this.url??"",{query:{f:"json",...this.customParameters,token:this.apiKey},responseType:"json",signal:t}).then(e=>{const i=e.data;if(i)return this.findFirstValidLayerId(i)})}async initLayerProperties(t){var e;return this._set("source",t),t.sourceJSON&&(this.sourceJSON=t.sourceJSON,this.read(t.sourceJSON,{origin:"service",portalItem:this.portalItem,portal:(e=this.portalItem)==null?void 0:e.portal,url:this.parsedUrl})),this._verifySource(),this._verifyFields(),AQ(this.renderer,this.fieldsIndex),Ede(this.timeInfo,this.fieldsIndex),this._hasMemorySource()&&this.geometryType==="mesh"&&(this.capabilities.query.supportsReturnMesh=!0),jht(this,{origin:"service"})}async hasDataChanged(){return Olt(this)}async fetchPublishingStatus(){const t=this.source;return t!=null&&t.fetchPublishingStatus?t.fetchPublishingStatus():"unavailable"}_verifyFields(){var e,i;const t=((e=this.parsedUrl)==null?void 0:e.path)??"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+t+")"),this.isTable||this._hasMemorySource()||t.search(/\/FeatureServer\//i)!==-1||(i=this.fields)!=null&&i.some(s=>s.type==="geometry")||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+t+")")}_fixTemplates(t,e){t&&t.forEach(i=>{var n;const s=(n=i.prototype)==null?void 0:n.attributes;s&&e&&delete s[e]})}_verifySource(){if(this._hasMemorySource()){if(this.url)throw new Se("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url")}else if(!this.url)throw new Se("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source")}_initMemorySource(t){t.forEach(e=>{e.layer=this,e.sourceLayer=this}),this.addHandles([t.on("after-add",e=>{e.item.layer=this,e.item.sourceLayer=this}),t.on("after-remove",e=>{e.item.layer=null,e.item.sourceLayer=null})],"fl-source")}_resetMemorySource(t){t.forEach(e=>{e.layer=null,e.sourceLayer=null}),this.removeHandles("fl-source")}_hasMemorySource(){return!(this.url||!this.source)}findFirstValidLayerId(t){return Array.isArray(t.layers)&&t.layers.length>0?t.layers[0].id:Array.isArray(t.tables)&&t.tables.length>0?t.tables[0].id:void 0}};y([S({clonable:!1,readOnly:!0})],Wt.prototype,"_titleCreator",null),y([S(cat)],Wt.prototype,"attributeTableTemplate",void 0),y([mt("service","capabilities")],Wt.prototype,"readCapabilities",null),y([S({json:{origins:{"web-scene":{write:!1}},write:!0}})],Wt.prototype,"charts",void 0),y([S({readOnly:!0})],Wt.prototype,"createQueryVersion",null),y([S({json:{read:{source:"layerDefinition.copyrightText"}}})],Wt.prototype,"copyright",void 0),y([S({json:{read:{source:"layerDefinition.displayField"}}})],Wt.prototype,"displayField",void 0),y([S({types:X_,readOnly:!0})],Wt.prototype,"defaultSymbol",void 0),y([S({type:ed})],Wt.prototype,"dynamicDataSource",void 0),y([S({type:Boolean})],Wt.prototype,"editingEnabled",null),y([mt(["portal-item","web-scene"],"editingEnabled",["layerDefinition.capabilities"])],Wt.prototype,"readEditingEnabled",null),y([mt("web-map","editingEnabled",["capabilities","layerDefinition.capabilities"])],Wt.prototype,"readEditingEnabledFromWebMap",null),y([yt(["portal-item","web-scene"],"editingEnabled",{"layerDefinition.capabilities":{type:String}})],Wt.prototype,"writeEditingEnabled",null),y([yt("web-map","editingEnabled",{capabilities:{type:String},"layerDefinition.capabilities":{type:String}})],Wt.prototype,"writeEditingEnabledToWebMap",null),y([S({readOnly:!0})],Wt.prototype,"effectiveEditingEnabled",null),y([S({clonable:!1,readOnly:!0})],Wt.prototype,"featureTitleFields",null),y([S({...ez.fields,json:{read:{source:"layerDefinition.fields"},origins:{service:{name:"fields"},"web-map":{write:{target:"layerDefinition.fields",overridePolicy:tz}}}}})],Wt.prototype,"fields",void 0),y([S(ez.fieldsIndex)],Wt.prototype,"fieldsIndex",void 0),y([S({type:Tot,json:{name:"formInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],Wt.prototype,"formTemplate",void 0),y([S({json:{read:{source:"layerDefinition.extent"}}})],Wt.prototype,"fullExtent",void 0),y([S({json:{origins:{"web-map":{write:{target:"layerDefinition.geometryType",overridePolicy:tz,writer(t,e,i){const s=t?D9.toJSON(t):null;s&&la(i,s,e)}}}},read:{source:"layerDefinition.geometryType",reader:D9.read}}})],Wt.prototype,"geometryType",void 0),y([S({json:{read:{source:"layerDefinition.hasM"}}})],Wt.prototype,"hasM",void 0),y([S({json:{read:{source:"layerDefinition.hasZ"}}})],Wt.prototype,"hasZ",void 0),y([S(aat)],Wt.prototype,"id",void 0),y([S({readOnly:!0,json:{origins:{service:{read:!0}},read:!1}})],Wt.prototype,"infoFor3D",void 0),y([S({json:{origins:{"web-map":{write:{target:"layerDefinition.type"}}}}})],Wt.prototype,"isTable",void 0),y([mt("service","isTable",["type","geometryType"]),mt("isTable",["layerDefinition.type","layerDefinition.geometryType"])],Wt.prototype,"readIsTable",null),y([yt("web-map","isTable")],Wt.prototype,"writeIsTable",null),y([S(hk)],Wt.prototype,"labelsVisible",void 0),y([S({type:[MA],json:{origins:{service:{name:"drawingInfo.labelingInfo",read:JV,write:!1},"web-scene":{name:"layerDefinition.drawingInfo.labelingInfo",read:JV,write:{enabled:!0,layerContainerTypes:rr}}},name:"layerDefinition.drawingInfo.labelingInfo",read:JV,write:!0}})],Wt.prototype,"labelingInfo",void 0),y([S((()=>{const t=be(oat);return t.json.origins["portal-item"]={write:{target:"layerDefinition.drawingInfo.transparency",writer(e,i,s){la(s,HF(e),i)}}},t})())],Wt.prototype,"opacity",void 0),y([S(nat)],Wt.prototype,"legendEnabled",void 0),y([S({type:["show","hide"],json:(()=>{const t=be(abe.json);return t.origins["portal-item"]={read:!1,write:!1},t})()})],Wt.prototype,"listMode",void 0),y([mt("globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],Wt.prototype,"readGlobalIdField",null),y([S({json:{origins:{"web-map":{write:{target:"layerDefinition.objectIdField",overridePolicy:tz}}}}})],Wt.prototype,"objectIdField",void 0),y([mt("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],Wt.prototype,"readObjectIdField",null),y([S({type:["ArcGISFeatureLayer"],json:{write:{target:"layerType",ignoreOrigin:!0,layerContainerTypes:rr}}})],Wt.prototype,"operationalLayerType",void 0),y([S(ez.outFields)],Wt.prototype,"outFields",void 0),y([S({readOnly:!0})],Wt.prototype,"parsedUrl",null),y([S({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],Wt.prototype,"path",void 0),y([S(ck)],Wt.prototype,"popupEnabled",void 0),y([S({type:HS,json:{name:"popupInfo",write:!0}})],Wt.prototype,"popupTemplate",void 0),y([S({readOnly:!0})],Wt.prototype,"defaultPopupTemplate",null),y([S({types:AA,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{types:Wct,name:"layerDefinition.drawingInfo.renderer",write:{layerContainerTypes:rr,overridePolicy:(t,e,i)=>({ignoreOrigin:i==null?void 0:i.writeLayerSchema})}}},write:{target:"layerDefinition.drawingInfo.renderer",overridePolicy:(t,e,i)=>({ignoreOrigin:i==null?void 0:i.writeLayerSchema})}}})],Wt.prototype,"renderer",null),y([mt("service","renderer",["drawingInfo.renderer","defaultSymbol"]),mt("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],Wt.prototype,"readRenderer",null),y([S()],Wt.prototype,"resourceInfo",void 0),y([S((()=>{const t=be(iat);return t.json.origins["portal-item"]={read:!1,write:!1},t})())],Wt.prototype,"screenSizePerspectiveEnabled",void 0),y([S({clonable:!1})],Wt.prototype,"source",null),y([Ls("source")],Wt.prototype,"castSource",null),y([mt("portal-item","source",["featureSet"]),mt("web-map","source",["featureSet"])],Wt.prototype,"readSource",null),y([S({json:{read:{source:"layerDefinition.extent.spatialReference"}}})],Wt.prototype,"spatialReference",void 0),y([S({type:Number})],Wt.prototype,"subtypeCode",void 0),y([S({type:[xX]})],Wt.prototype,"templates",void 0),y([mt("templates",["editFieldsInfo","creatorField","editorField","templates"])],Wt.prototype,"readTemplates",null),y([S({type:vwe})],Wt.prototype,"timeInfo",void 0),y([S()],Wt.prototype,"title",void 0),y([mt("service","title",["name"]),mt("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],Wt.prototype,"readTitle",null),y([mt("web-map","title",["layerDefinition.name","title"])],Wt.prototype,"readTitleFromWebMap",null),y([S({type:String})],Wt.prototype,"sublayerTitleMode",void 0),y([S({json:{read:!1}})],Wt.prototype,"type",void 0),y([S({type:String})],Wt.prototype,"typeIdField",void 0),y([mt("service","typeIdField"),mt("typeIdField",["layerDefinition.typeIdField"])],Wt.prototype,"readTypeIdField",null),y([S({type:[xwe]})],Wt.prototype,"types",void 0),y([mt("service","types",["types"]),mt("types",["layerDefinition.types"])],Wt.prototype,"readTypes",null),y([S({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility"}}}}})],Wt.prototype,"visible",void 0),y([mt("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],Wt.prototype,"readVisible",null),Wt=y([se("esri.layers.FeatureLayer")],Wt);const bwe=Wt,LEt=Object.freeze(Object.defineProperty({__proto__:null,default:bwe},Symbol.toStringTag,{value:"Module"})),idt={resolveDirective:$b.V,ElementPart:$b.F,TemplateInstance:$b.R,isIterable:$b.D,ChildPart:$b.I};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{TemplateInstance:sdt,isIterable:ndt,resolveDirective:wwe,ChildPart:uC,ElementPart:rdt}=idt,odt=(t,e,i={})=>{if(e._$litPart$!==void 0)throw Error("container already contains a live render");let s,n,r;const o=[],a=document.createTreeWalker(e,NodeFilter.SHOW_COMMENT);let l;for(;(l=a.nextNode())!==null;){const u=l.data;if(u.startsWith("lit-part")){if(o.length===0&&s!==void 0)throw Error(`There must be only one root part per container. Found a part marker (${l}) when we already have a root part marker (${n})`);r=adt(t,l,o,i),s===void 0&&(s=r),n??(n=l)}else if(u.startsWith("lit-node"))udt(l,o,i);else if(u.startsWith("/lit-part")){if(o.length===1&&r!==s)throw Error("internal error");r=ldt(l,r,o)}}if(s===void 0){const u=e instanceof ShadowRoot?"{container.host.localName}'s shadow root":e instanceof DocumentFragment?"DocumentFragment":e.localName;console.error(`There should be exactly one root part in a render container, but we didn't find any in ${u}.`)}e._$litPart$=s},adt=(t,e,i,s)=>{let n,r;if(i.length===0)r=new uC(e,null,void 0,s),n=t;else{const o=i[i.length-1];if(o.type==="template-instance")r=new uC(e,null,o.instance,s),o.instance._$AV.push(r),n=o.result.values[o.instancePartIndex++],o.templatePartIndex++;else if(o.type==="iterable"){r=new uC(e,null,o.part,s);const a=o.iterator.next();if(a.done)throw n=void 0,o.done=!0,Error("Unhandled shorter than expected iterable");n=a.value,o.part._$AH.push(r)}else r=new uC(e,null,o.part,s)}if(n=wwe(r,n),n===Bf)i.push({part:r,type:"leaf"});else if(art(n))i.push({part:r,type:"leaf"}),r._$AH=n;else if(lrt(n)){if(urt(n))throw Error("compiled templates are not supported");const o="lit-part "+cdt(n);if(e.data!==o)throw Error("Hydration value mismatch: Unexpected TemplateResult rendered to part");{const a=uC.prototype._$AC(n),l=new sdt(a,r);i.push({type:"template-instance",instance:l,part:r,templatePartIndex:0,instancePartIndex:0,result:n}),r._$AH=l}}else ndt(n)?(i.push({part:r,type:"iterable",value:n,iterator:n[Symbol.iterator](),done:!1}),r._$AH=[]):(i.push({part:r,type:"leaf"}),r._$AH=n??"");return r},ldt=(t,e,i)=>{if(e===void 0)throw Error("unbalanced part marker");e._$AB=t;const s=i.pop();if(s.type==="iterable"&&!s.iterator.next().done)throw Error("unexpected longer than expected iterable");if(i.length>0)return i[i.length-1].part},udt=(t,e,i)=>{const s=/lit-node (\d+)/.exec(t.data),n=parseInt(s[1]),r=t.nextElementSibling;if(r===null)throw Error("could not find node for attribute parts");r.removeAttribute("defer-hydration");const o=e[e.length-1];if(o.type!=="template-instance")throw Error("Hydration value mismatch: Primitive found where TemplateResult expected. This usually occurs due to conditional rendering that resulted in a different value or template being rendered between the server and client.");{const a=o.instance;for(;;){const l=a._$AD.parts[o.templatePartIndex];if(l===void 0||l.type!==Dv.ATTRIBUTE&&l.type!==Dv.ELEMENT||l.index!==n)break;if(l.type===Dv.ATTRIBUTE){const u=new l.ctor(r,l.name,l.strings,o.instance,i),c=crt(u)?o.result.values[o.instancePartIndex]:o.result.values,h=!(u.type===Dv.EVENT||u.type===Dv.PROPERTY);u._$AI(c,u,o.instancePartIndex,h),o.instancePartIndex+=l.strings.length-1,a._$AV.push(u)}else{const u=new rdt(r,o.instance,i);wwe(u,o.result.values[o.instancePartIndex++]),a._$AV.push(u)}o.templatePartIndex++}}},cdt=t=>{const e=new Uint32Array(2).fill(5381);for(const s of t.strings)for(let n=0;n<s.length;n++)e[n%2]=33*e[n%2]^s.charCodeAt(n);const i=String.fromCharCode(...new Uint8Array(e.buffer));return btoa(i)};globalThis.litElementHydrateSupport=({LitElement:t})=>{const e=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(t),"observedAttributes").get;Object.defineProperty(t,"observedAttributes",{get(){return[...e.call(this),"defer-hydration"]}});const i=t.prototype.attributeChangedCallback;t.prototype.attributeChangedCallback=function(o,a,l){o==="defer-hydration"&&l===null&&s.call(this),i.call(this,o,a,l)};const s=t.prototype.connectedCallback;t.prototype.connectedCallback=function(){this.hasAttribute("defer-hydration")||s.call(this)};const n=t.prototype.createRenderRoot;t.prototype.createRenderRoot=function(){return this.shadowRoot?(this._$AG=!0,this.shadowRoot):n.call(this)};const r=Object.getPrototypeOf(t.prototype).update;t.prototype.update=function(o){const a=this.render();if(r.call(this,o),this._$AG){this._$AG=!1;for(let l=0;l<this.attributes.length;l++){const u=this.attributes[l];if(u.name.startsWith("hydrate-internals-")){const c=u.name.slice(18);this.removeAttribute(c),this.removeAttribute(u.name)}}odt(a,this.renderRoot,this.renderOptions)}else oxe(a,this.renderRoot,this.renderOptions)}};/*! All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://github.com/Esri/calcite-design-system/blob/dev/LICENSE.md for details.
v3.1.0 */const hdt=lnt(pxe,{"calcite-accordion":[()=>_e(()=>import("./customElement-CgMorMaW.js"),__vite__mapDeps([291,268])),"appearance,iconPosition,iconType,scale,selectionMode"],"calcite-accordion-item":[()=>_e(()=>import("./customElement-BlWHRNLK.js"),__vite__mapDeps([292,293,271,267,264,276,269])),"accordionParent:,description,expanded,heading,iconEnd,iconFlipRtl,iconPosition,iconStart,iconType,scale;setFocus"],"calcite-action":[()=>_e(()=>import("./customElement-DTGpm0km.js"),__vite__mapDeps([294,293,271,264,274,276,269,268,265])),"active,alignment,appearance,compact,disabled,dragHandle,icon,iconFlipRtl,indicator,label,loading,messageOverrides:,scale,text,textEnabled;setFocus"],"calcite-action-bar":[()=>_e(()=>import("./customElement-DFHwCj0R.js"),__vite__mapDeps([295,267,264,276,269,268,296,271,297,298,265,299])),"actionsEndGroupLabel,expandDisabled,expanded,layout,messageOverrides:,overflowActionsDisabled,overlayPositioning,position,scale;overflowActions,setFocus"],"calcite-action-group":[()=>_e(()=>import("./customElement-D0n3wHTl.js"),__vite__mapDeps([300,276,269,298,267,264,265,297])),"columns,expanded,label,layout,menuFlipPlacements:,menuOpen,menuPlacement,messageOverrides:,overlayPositioning,scale;setFocus"],"calcite-action-menu":[()=>_e(()=>import("./customElement-CCHfs5Wg.js"),__vite__mapDeps([301,271,302,267,264,303,276,269,298])),"appearance,expanded,flipPlacements:,label,open,overlayPositioning,placement,scale;setFocus"],"calcite-action-pad":[()=>_e(()=>import("./customElement-fn84Utza.js"),__vite__mapDeps([304,267,264,276,269,296,271,297,298,268,265])),"actionsEndGroupLabel,expandDisabled,expanded,layout,messageOverrides:,overlayPositioning,position,scale;setFocus"],"calcite-alert":[()=>_e(()=>import("./customElement-CCBjuIro.js"),__vite__mapDeps([305,271,293,267,264,276,269,306,303,307,308,265])),"active,autoClose,autoCloseDuration,embedded,icon,iconFlipRtl,kind,label,messageOverrides:,numberingSystem,open,openAlertCount,placement,queue,scale;setFocus"],"calcite-autocomplete":[()=>_e(()=>import("./customElement-Ch3aFRkR.js"),__vite__mapDeps([309,271,310,311,312,267,264,299,274,307,275,273,265,313,268,314])),"alignment,autocomplete:,disabled,flipPlacements:,form,icon,iconFlipRtl,inputValue,label,loading,maxLength,messageOverrides:,minLength,name,open,overlayPositioning,pattern,placeholder,placement,prefixText,readOnly,required,scale,status,suffixText,validationIcon,validationMessage,validity:,value;reposition,scrollContentTo,selectText,setFocus"],"calcite-autocomplete-item":[()=>_e(()=>import("./customElement-CLpT4TXO.js"),__vite__mapDeps([315,276,269,274,264,316])),"active,description,disabled,guid,heading,iconEnd,iconFlipRtl,iconStart,inputValueMatchPattern:,label,scale,value"],"calcite-autocomplete-item-group":[()=>_e(()=>import("./customElement-B1fDleP5.js"),[]),"disableSpacing,heading,label,scale"],"calcite-avatar":[()=>_e(()=>import("./customElement-Bq0XUq7G.js"),__vite__mapDeps([317,267,264,318,319])),"fullName,label,scale,thumbnail,userId,username"],"calcite-block":[()=>_e(()=>import("./customElement-DS5IEYjY.js"),__vite__mapDeps([320,293,271,267,264,274,321,272,276,269,307,311,312,299,265])),"collapsible,description,disabled,dragDisabled,dragHandle,expanded,heading,headingLevel,iconEnd,iconFlipRtl,iconStart,label,loading,menuFlipPlacements:,menuPlacement,messageOverrides:,moveToItems:,open,overlayPositioning,setPosition,setSize,sortHandleOpen,status;setFocus"],"calcite-block-group":[()=>_e(()=>import("./customElement-Z3P_BTgj.js"),__vite__mapDeps([322,274,268,323,276,269,267,264,299])),"canPull:,canPut:,disabled,dragEnabled,group,label,loading;setFocus"],"calcite-block-section":[()=>_e(()=>import("./customElement-BCpjNOYM.js"),__vite__mapDeps([324,293,267,264,303,276,269,265])),"expanded,iconEnd,iconFlipRtl,iconStart,messageOverrides:,open,status,text,toggleDisplay;setFocus"],"calcite-button":[()=>_e(()=>import("./customElement-DtaX0itU.js"),__vite__mapDeps([270,271,272,273,267,264,274,275,276,269,268,265])),"alignment,appearance,disabled,download,form,href,iconEnd,iconFlipRtl,iconStart,kind,label,loading,messageOverrides:,name,rel,round,scale,splitChild,target,type,width;setFocus"],"calcite-card":[()=>_e(()=>import("./customElement-BSaSTrDW.js"),__vite__mapDeps([325,271,267,264,276,269,274,303,265])),"disabled,label,loading,messageOverrides:,selectable,selected,selectionMode,thumbnailPosition;setFocus"],"calcite-card-group":[()=>_e(()=>import("./customElement-CZeGza0-.js"),__vite__mapDeps([326,271,267,264,274])),"disabled,label,selectedItems:,selectionMode;setFocus"],"calcite-carousel":[()=>_e(()=>import("./customElement-CMKyTXd3.js"),__vite__mapDeps([327,271,310,267,264,274,276,269,268,328,319,302,265])),"arrowType,autoplay,autoplayDuration,controlOverlay,disabled,label,messageOverrides:,paused,selectedItem:;play,setFocus,stop"],"calcite-carousel-item":[()=>_e(()=>import("./customElement-B2YV5XZJ.js"),__vite__mapDeps([329,264])),"label,selected"],"calcite-checkbox":[()=>_e(()=>import("./customElement-ziTCZoCg.js"),__vite__mapDeps([330,271,267,264,273,274,303,275,276,269])),"checked,disabled,form,hovered,indeterminate,label,name,required,scale,status,validity:,value;setFocus"],"calcite-chip":[()=>_e(()=>import("./customElement-D-go6cM5.js"),__vite__mapDeps([331,271,267,264,276,269,274,303,265])),"appearance,closable,closed,closeOnDelete,disabled,icon,iconFlipRtl,interactive,kind,label,messageOverrides:,parentChipGroup:,scale,selected,selectionMode,value;setFocus"],"calcite-chip-group":[()=>_e(()=>import("./customElement-DReingST.js"),__vite__mapDeps([332,271,267,264,274,276,269])),"disabled,label,scale,selectedItems:,selectionMode;setFocus"],"calcite-color-picker":[()=>_e(()=>import("./customElement-Dz3sAqBP.js"),__vite__mapDeps([333,271,310,293,318,319,267,264,274,303,276,269,334,265,268,335,299])),"allowEmpty,alphaChannel,channelsDisabled,clearable,color:,disabled,format,hexDisabled,messageOverrides:,numberingSystem,savedDisabled,scale,storageId,value;setFocus"],"calcite-color-picker-hex-input":[()=>_e(()=>import("./customElement-Cs2qK68d.js"),__vite__mapDeps([336,271,293,318,319,267,264,276,269])),"allowEmpty,alphaChannel,hexLabel,messages:,numberingSystem,scale,value;setFocus"],"calcite-color-picker-swatch":[()=>_e(()=>import("./customElement-C68BrKiC.js"),__vite__mapDeps([337,293,318,319,267,264])),"active,color,scale"],"calcite-combobox":[()=>_e(()=>import("./customElement-C2ylg09N.js"),__vite__mapDeps([338,293,339,340,271,341,314,299,267,264,311,312,273,274,275,276,269,268,307,313,265,342])),"allowCustomValues,clearDisabled,disabled,filteredItems:,filterProps:,filterText,flipPlacements:,form,label,maxItems,messageOverrides:,name,open,overlayPositioning,placeholder,placeholderIcon,placeholderIconFlipRtl,readOnly,required,scale,selectedItems:,selectionDisplay,selectionMode,status,validationIcon,validationMessage,validity:,value;reposition,setFocus"],"calcite-combobox-item":[()=>_e(()=>import("./customElement-D9M48WYW.js"),__vite__mapDeps([343,293,264,274,342,267,276,269,316])),"active,ancestors:,description,disabled,filterDisabled,filterTextMatchPattern:,guid,heading,icon,iconFlipRtl,itemHidden,label,metadata:,scale,selected,selectionMode,shortHeading,textLabel,value"],"calcite-combobox-item-group":[()=>_e(()=>import("./customElement-D3JpAJB7.js"),__vite__mapDeps([344,264,342,267])),"afterEmptyGroup,ancestors:,itemHidden,label,scale"],"calcite-date-picker":[()=>_e(()=>import("./customElement-BtBX9xi2.js"),__vite__mapDeps([345,346,306,303,276,269,267,264,265,347])),"activeDate:,activeRange,headingLevel,layout,max,maxAsDate:,messageOverrides:,min,minAsDate:,monthStyle,numberingSystem,proximitySelectionDisabled,range,scale,value,valueAsDate:;reset,setFocus"],"calcite-date-picker-day":[()=>_e(()=>import("./customElement-axAlP8Gu.js"),__vite__mapDeps([348,346,306,303,267,264,274,276,269])),"active,currentMonth,dateTimeFormat:,day,disabled,endOfRange,highlighted,range,rangeEdge,rangeHover,scale,selected,startOfRange,value:;setFocus"],"calcite-date-picker-month":[()=>_e(()=>import("./customElement-Dvy_dOqm.js"),__vite__mapDeps([349,271,293,346,306,303])),"activeDate:,dateTimeFormat:,endDate:,headingLevel,hoverRange:,layout,localeData:,max:,messages:,min:,monthStyle,range,scale,selectedDate:,startDate:"],"calcite-date-picker-month-header":[()=>_e(()=>import("./customElement-DYPMtHd7.js"),__vite__mapDeps([350,339,319,271,346,306,303,267,264])),"activeDate:,headingLevel,localeData:,max:,messages:,min:,monthStyle,position,scale,selectedDate:"],"calcite-dialog":[()=>_e(()=>import("./customElement-D6RJx0Zk.js"),__vite__mapDeps([351,293,352,271,267,264,276,269,268,353,307,354,265,355])),"beforeClose:,closeDisabled,description,dragEnabled,embedded,escapeDisabled,focusTrapDisabled,focusTrapOptions:,heading,headingLevel,kind,loading,menuOpen,messageOverrides:,modal,open,outsideCloseDisabled,overlayPositioning,placement,resizable,scale,width,widthScale;scrollContentTo,setFocus,updateFocusTrapElements"],"calcite-dropdown":[()=>_e(()=>import("./index-CDuxeKTe.js").then(t=>t.c),__vite__mapDeps([356,271,267,264,311,312,299,274,303,276,269,268,307,353])),"closeOnSelectDisabled,disabled,flipPlacements:,maxItems,offsetDistance,offsetSkidding,open,overlayPositioning,placement,scale,selectedItems:,type,width,widthScale;reposition,setFocus"],"calcite-dropdown-group":[()=>_e(()=>import("./index-Cjtbbwve.js").then(t=>t.c),__vite__mapDeps([357,268,358])),"groupTitle,position,scale,selectionMode"],"calcite-dropdown-item":[()=>_e(()=>import("./customElement-B4s55E5r.js"),__vite__mapDeps([359,271,267,264,276,269,274,358])),"disabled,href,iconEnd,iconFlipRtl,iconStart,label,rel,scale,selected,selectionMode,target;setFocus"],"calcite-fab":[()=>_e(()=>import("./customElement-BQNSROUc.js"),__vite__mapDeps([360,271,267,264,274,276,269])),"appearance,disabled,icon,iconFlipRtl,kind,label,loading,scale,text,textEnabled;setFocus"],"calcite-filter":[()=>_e(()=>import("./customElement-DSJabRxZ.js"),__vite__mapDeps([361,271,341,314,299,274,276,269,265])),"disabled,filteredItems:,filterProps:,items:,label,messageOverrides:,placeholder,scale,value;filter,setFocus"],"calcite-flow":[()=>_e(()=>import("./index-Bwspjnwr.js").then(t=>t.c),__vite__mapDeps([362,271,268,276,269,267,264])),"customItemSelectors;back,setFocus"],"calcite-flow-item":[()=>_e(()=>import("./customElement-CtS-sP_r.js"),__vite__mapDeps([363,271,293,267,264,274,276,269,354,265])),"beforeBack:,beforeClose:,closable,closed,collapsed,collapseDirection,collapsible,description,disabled,heading,headingLevel,loading,menuOpen,messageOverrides:,overlayPositioning,scale,selected,showBackButton;scrollContentTo,setFocus"],"calcite-graph":[()=>_e(()=>import("./customElement-DBUVFmrV.js"),__vite__mapDeps([364,264,268])),"colorStops:,data:,highlightMax,highlightMin,max,min"],"calcite-handle":[()=>_e(()=>import("./customElement-CtHuQL5w.js"),__vite__mapDeps([365,271,276,269,274,265])),"blurUnselectDisabled,disabled,dragHandle,label,messageOverrides:,selected,setPosition,setSize;setFocus"],"calcite-icon":[()=>_e(()=>import("./index-B2mHmePf.js").then(t=>t.c),__vite__mapDeps([266,267,264,268,269])),"flipRtl,icon,preload,scale,textLabel"],"calcite-inline-editable":[()=>_e(()=>import("./customElement-oIUM3g5A.js"),__vite__mapDeps([366,271,274,275,267,264,276,269,265])),"afterConfirm:,controls,disabled,editingEnabled,loading,messageOverrides:,scale;setFocus"],"calcite-input":[()=>_e(()=>import("./customElement-ePn5nvF1.js"),__vite__mapDeps([367,339,293,271,272,267,264,273,274,303,275,276,269,306,313,265,368])),"accept,alignment,autocomplete:,clearable,disabled,editingEnabled,files:,form,groupSeparator,icon,iconFlipRtl,label,loading,localeFormat,max,maxLength,messageOverrides:,min,minLength,multiple,name,numberButtonType,numberingSystem,pattern,placeholder,prefixText,readOnly,required,scale,status,step,suffixText,type,validationIcon,validationMessage,validity:,value;selectText,setFocus"],"calcite-input-date-picker":[()=>_e(()=>import("./customElement-V0T1ZYeW.js"),__vite__mapDeps([369,271,355,267,264,346,306,303,311,312,299,273,274,275,276,269,307,347,313,368,265])),"disabled,flipPlacements:,focusTrapDisabled,form,headingLevel,layout,max,maxAsDate:,messageOverrides:,min,minAsDate:,monthStyle,name,numberingSystem,open,overlayPositioning,placement,proximitySelectionDisabled,range,readOnly,required,scale,status,validationIcon,validationMessage,validity:,value,valueAsDate:;reposition,setFocus"],"calcite-input-message":[()=>_e(()=>import("./customElement-DdyJSEpv.js"),__vite__mapDeps([370,267,264])),"icon,iconFlipRtl,scale,status"],"calcite-input-number":[()=>_e(()=>import("./customElement-B5WUgAYJ.js"),__vite__mapDeps([371,339,293,271,267,264,273,274,303,275,276,269,306,313,368,265])),"alignment,autocomplete:,clearable,disabled,editingEnabled,form,groupSeparator,icon,iconFlipRtl,integer,label,loading,localeFormat,max,maxLength,messageOverrides:,min,minLength,name,numberButtonType,numberingSystem,placeholder,prefixText,readOnly,required,scale,status,step,suffixText,validationIcon,validationMessage,validity:,value;selectText,setFocus"],"calcite-input-text":[()=>_e(()=>import("./customElement-BWfvbLf3.js"),__vite__mapDeps([372,339,271,267,264,273,274,275,276,269,313,368,265])),"alignment,autocomplete:,clearable,disabled,editingEnabled,form,icon,iconFlipRtl,label,loading,maxLength,messageOverrides:,minLength,name,pattern,placeholder,prefixText,readOnly,required,scale,status,suffixText,validationIcon,validationMessage,validity:,value;selectText,setFocus"],"calcite-input-time-picker":[()=>_e(()=>import("./customElement-DLZMJKtD.js").then(t=>t.c),__vite__mapDeps([373,271,273,267,264,274,303,275,276,269,306,374,334,313,368,265])),"disabled,focusTrapDisabled,form,hourFormat,max,messageOverrides:,min,name,numberingSystem,open,overlayPositioning,placement,readOnly,required,scale,status,step,validationIcon,validationMessage,validity:,value;reposition,setFocus"],"calcite-input-time-zone":[()=>_e(()=>import("./customElement-jnHoq94-.js"),__vite__mapDeps([375,271,310,293,275,267,264,274,276,269,273,265,306,303])),"clearable,disabled,form,maxItems,messageOverrides:,mode,name,offsetStyle,open,overlayPositioning,readOnly,referenceDate,required,scale,status,validationIcon,validationMessage,validity:,value;setFocus"],"calcite-label":[()=>_e(()=>import("./index-C1Er7W-g.js").then(t=>t.c),__vite__mapDeps([376,275,267,264])),"alignment,for,layout,scale"],"calcite-link":[()=>_e(()=>import("./customElement-CrSwFn5r.js"),__vite__mapDeps([377,271,272,267,264,274,276,269])),"disabled,download,href,iconEnd,iconFlipRtl,iconStart,rel,target;setFocus"],"calcite-list":[()=>_e(()=>import("./customElement-ByX6J9uM.js"),__vite__mapDeps([378,271,293,267,264,274,268,379,323,380,276,269,306,303,265,299])),"canPull:,canPut:,disabled,displayMode,dragEnabled,filteredData:,filteredItems:,filterEnabled,filterLabel,filterPlaceholder,filterPredicate:,filterProps:,filterText,group,interactionMode,label,loading,messageOverrides:,numberingSystem,scale,selectedItems:,selectionAppearance,selectionMode;setFocus"],"calcite-list-item":[()=>_e(()=>import("./customElement-TXWxc97e.js"),__vite__mapDeps([381,293,271,267,264,274,276,269,265,379,382])),"active,bordered,closable,closed,description,disabled,displayMode,dragDisabled,dragHandle,expanded,filterHidden,iconEnd,iconFlipRtl,iconStart,interactionMode,label,messageOverrides:,metadata:,moveToItems:,open,scale,selected,selectionAppearance,selectionMode,setPosition,setSize,sortHandleOpen,unavailable,value;setFocus"],"calcite-list-item-group":[()=>_e(()=>import("./index-DnkLIP2d.js").then(t=>t.c),__vite__mapDeps([383,274,382])),"disabled,filterHidden,heading,scale"],"calcite-loader":[()=>_e(()=>import("./index-ByThslJp.js").then(t=>t.c),__vite__mapDeps([263,264,265])),"complete,inline,label,scale,text,type,value"],"calcite-menu":[()=>_e(()=>import("./customElement-DnueI8Ae.js"),__vite__mapDeps([384,267,264,276,269,265])),"label,layout,messageOverrides:;setFocus"],"calcite-menu-item":[()=>_e(()=>import("./customElement-NiXo7aHg.js"),__vite__mapDeps([385,293,271,267,264,276,269,265])),"active,breadcrumb,href,iconEnd,iconFlipRtl,iconStart,isTopLevelItem,label,layout,messageOverrides:,open,rel,target,text,topLevelMenuLayout;setFocus"],"calcite-meter":[()=>_e(()=>import("./customElement-DO0vbq6D.js"),__vite__mapDeps([386,293,271,273,267,264,306,303,268,265])),"appearance,disabled,fillType,form,groupSeparator,high,label,low,max,min,name,numberingSystem,rangeLabels,rangeLabelType,scale,unitLabel,value,valueLabel,valueLabelType"],"calcite-modal":[()=>_e(()=>import("./customElement-CDMoLhq3.js"),__vite__mapDeps([387,293,271,312,267,264,276,269,268,307,265,355])),"beforeClose:,closeButtonDisabled,docked,escapeDisabled,focusTrapDisabled,focusTrapOptions:,fullscreen,kind,messageOverrides:,open,opened,outsideCloseDisabled,scale,widthScale;scrollContent,setFocus,updateFocusTrapElements"],"calcite-navigation":[()=>_e(()=>import("./customElement-CQSH61c2.js"),__vite__mapDeps([388,271,267,264,276,269])),"label,navigationAction;setFocus"],"calcite-navigation-logo":[()=>_e(()=>import("./customElement-_jqU-XOl.js"),__vite__mapDeps([389,293,276,269,321,272])),"active,description,heading,headingLevel,href,icon,iconFlipRtl,label,rel,target,thumbnail;setFocus"],"calcite-navigation-user":[()=>_e(()=>import("./customElement-WSB341dj.js"),__vite__mapDeps([390,293,276,269])),"active,fullName,label,textDisabled,thumbnail,userId,username;setFocus"],"calcite-notice":[()=>_e(()=>import("./customElement-C9saBoPe.js"),__vite__mapDeps([391,271,267,264,276,269,308,307,265])),"closable,icon,iconFlipRtl,kind,messageOverrides:,open,scale,width;setFocus"],"calcite-option":[()=>_e(()=>import("./customElement-Q82Jcscn.js"),__vite__mapDeps([392,268])),"disabled,label,selected,value"],"calcite-option-group":[()=>_e(()=>import("./customElement-CVby4Dxs.js"),[]),"disabled,label"],"calcite-pagination":[()=>_e(()=>import("./customElement-CfEAJuFv.js"),__vite__mapDeps([393,293,276,269,306,303,268,328,319,265])),"groupSeparator,messageOverrides:,numberingSystem,pageSize,scale,startItem,totalItems;goTo,nextPage,previousPage,setFocus"],"calcite-panel":[()=>_e(()=>import("./customElement-H6Q5okC-.js"),__vite__mapDeps([394,293,271,267,264,274,276,269,268,298,321,272,311,312,299,265,354])),"beforeClose:,closable,closed,collapsed,collapseDirection,collapsible,description,disabled,heading,headingLevel,loading,menuFlipPlacements:,menuOpen,menuPlacement,messageOverrides:,overlayPositioning,scale;scrollContentTo,setFocus"],"calcite-popover":[()=>_e(()=>import("./customElement-CwS5qx96.js"),__vite__mapDeps([395,293,271,311,312,267,264,299,307,321,272,276,269,268,396,265,355,303])),"autoClose,closable,flipDisabled,flipPlacements:,focusTrapDisabled,focusTrapOptions:,heading,headingLevel,label,messageOverrides:,offsetDistance,offsetSkidding,open,overlayPositioning,placement,pointerDisabled,referenceElement,scale,triggerDisabled;reposition,setFocus,updateFocusTrapElements"],"calcite-progress":[()=>_e(()=>import("./customElement-Bmh7Su2J.js"),__vite__mapDeps([397,267,264])),"label,reversed,text,type,value"],"calcite-radio-button":[()=>_e(()=>import("./customElement-vJ0c-PAu.js"),__vite__mapDeps([398,271,302,267,264,273,274,275,276,269])),"checked,disabled,focused,form,hovered,label,name,required,scale,value;emitCheckedChange,setFocus"],"calcite-radio-button-group":[()=>_e(()=>import("./customElement-K-uCxDfa.js"),__vite__mapDeps([399,268,276,269,313,267,264])),"disabled,layout,name,required,scale,selectedItem:,status,validationIcon,validationMessage;setFocus"],"calcite-rating":[()=>_e(()=>import("./customElement-D_YMIMSA.js"),__vite__mapDeps([400,339,273,267,264,274,275,276,269,313,265])),"average,count,disabled,form,messageOverrides:,name,readOnly,required,scale,showChip,status,validationIcon,validationMessage,validity:,value;setFocus"],"calcite-scrim":[()=>_e(()=>import("./customElement-C-VQTuUh.js"),__vite__mapDeps([401,271,268,267,264,265])),"loading,messageOverrides:"],"calcite-segmented-control":[()=>_e(()=>import("./customElement-CtMz5cpf.js"),__vite__mapDeps([402,267,264,273,274,275,276,269,313])),"appearance,disabled,form,layout,name,required,scale,selectedItem:,status,validationIcon,validationMessage,validity:,value,width;setFocus"],"calcite-segmented-control-item":[()=>_e(()=>import("./customElement-C5HyMSUN.js"),__vite__mapDeps([403,267,264])),"appearance,checked,iconEnd,iconFlipRtl,iconStart,layout,scale,value"],"calcite-select":[()=>_e(()=>import("./customElement-_FojWzL8.js"),__vite__mapDeps([404,271,267,264,273,274,275,276,269,268,313])),"disabled,form,label,name,required,scale,selectedOption:,status,validationIcon,validationMessage,validity:,value,width;setFocus"],"calcite-sheet":[()=>_e(()=>import("./customElement-CLtKaUYM.js"),__vite__mapDeps([405,271,293,352,267,264,276,269,268,307,353,334,265,355])),"beforeClose:,displayMode,embedded,escapeDisabled,focusTrapDisabled,focusTrapOptions:,height,heightScale,label,messageOverrides:,open,opened,outsideCloseDisabled,position,resizable,width,widthScale;setFocus,updateFocusTrapElements"],"calcite-shell":[()=>_e(()=>import("./customElement-CWQbrT2Q.js"),__vite__mapDeps([406,293,267,264])),"contentBehind"],"calcite-shell-center-row":[()=>_e(()=>import("./customElement-IhT3zrHU.js"),__vite__mapDeps([407,293,267,264,269])),"detached,heightScale,position"],"calcite-shell-panel":[()=>_e(()=>import("./customElement-ClGqISpx.js"),__vite__mapDeps([408,293,271,267,264,334,353,265])),"collapsed,displayMode,height,heightScale,layout,messageOverrides:,position,resizable,width,widthScale"],"calcite-slider":[()=>_e(()=>import("./customElement-hVt-bkMR.js"),__vite__mapDeps([409,271,293,264,267,313,273,274,303,275,276,269,306,334,265])),"disabled,fillPlacement,form,groupSeparator,hasHistogram,histogram:,histogramStops:,labelFormatter:,labelHandles,labelTicks,max,maxLabel,maxValue,min,minLabel,minValue,mirrored,name,numberingSystem,pageStep,precise,required,scale,snap,status,step,ticks,validationIcon,validationMessage,validity:,value;setFocus"],"calcite-sort-handle":[()=>_e(()=>import("./customElement-Bzi6rZRj.js"),__vite__mapDeps([410,271,293,276,269,274,311,312,267,264,299,265])),"disabled,flipPlacements:,label,messageOverrides:,messages:,moveToItems:,open,overlayPositioning,placement,scale,setPosition,setSize,widthScale;setFocus"],"calcite-sortable-list":[()=>_e(()=>import("./customElement-DV5JjLQP.js"),__vite__mapDeps([411,274,268,323,267,264,269])),"canPull:,canPut:,disabled,dragSelector,group,handleSelector,layout,loading"],"calcite-split-button":[()=>_e(()=>import("./customElement-BjMhP9i8.js"),__vite__mapDeps([412,274,276,269,267,264])),"active,appearance,disabled,download,dropdownIconType,dropdownLabel,flipPlacements:,href,kind,loading,overlayPositioning,placement,primaryIconEnd,primaryIconFlipRtl,primaryIconStart,primaryLabel,primaryText,rel,scale,target,width;setFocus"],"calcite-stack":[()=>_e(()=>import("./customElement-BElpJGpk.js"),__vite__mapDeps([413,293,267,264,380])),"disabled"],"calcite-stepper":[()=>_e(()=>import("./customElement-Bdd4oJzt.js"),__vite__mapDeps([414,271,267,264,268,265,276,269])),"icon,layout,messageOverrides:,numbered,numberingSystem,scale,selectedItem:;endStep,goToStep,nextStep,prevStep,startStep"],"calcite-stepper-item":[()=>_e(()=>import("./customElement-i1dmsapE.js"),__vite__mapDeps([415,271,274,306,303,276,269,265])),"complete,description,disabled,error,heading,icon,iconFlipRtl,itemHidden,layout,messageOverrides:,numbered,numberingSystem,scale,selected;setFocus"],"calcite-switch":[()=>_e(()=>import("./customElement-FCL_5RS0.js"),__vite__mapDeps([416,271,267,264,273,274,303,275,276,269])),"checked,disabled,form,label,name,scale,value;setFocus"],"calcite-tab":[()=>_e(()=>import("./customElement-CNRkeZ0k.js"),__vite__mapDeps([417,267,264])),"scale,selected,tab;getTabIndex;_updateAriaInfo"],"calcite-tab-nav":[()=>_e(()=>import("./customElement-CrNd-Yv6.js"),__vite__mapDeps([418,271,293,340,267,264,268,265])),"bordered,layout,messageOverrides:,position,scale,selectedTitle:,storageId,syncId"],"calcite-tab-title":[()=>_e(()=>import("./customElement-CHnS_JmU.js"),__vite__mapDeps([419,293,271,267,264,274,268,276,269,265])),"bordered,closable,closed,disabled,iconEnd,iconFlipRtl,iconStart,layout,messageOverrides:,position,scale,selected,tab;activateTab,getTabIdentifier,getTabIndex;_updateAriaInfo"],"calcite-table":[()=>_e(()=>import("./customElement-H4SmhlzG.js"),__vite__mapDeps([420,271,306,303,265,276,269])),"bordered,caption,groupSeparator,interactionMode,layout,messageOverrides:,numbered,numberingSystem,pageSize,scale,selectedItems:,selectionDisplay,selectionMode,striped"],"calcite-table-cell":[()=>_e(()=>import("./customElement-DkZweSwJ.js"),__vite__mapDeps([421,271,276,269,274,267,264,265])),"alignment,colSpan,disabled,interactionMode,lastCell,messageOverrides:,numberCell,parentRowAlignment,parentRowIsSelected,parentRowPositionLocalized,parentRowType,positionInRow,readCellContentsToAT,rowSpan,scale,selectionCell;setFocus"],"calcite-table-header":[()=>_e(()=>import("./customElement-BAtnbfY7.js"),__vite__mapDeps([422,271,276,269,265])),"alignment,bodyRowCount,colSpan,description,heading,interactionMode,lastCell,messageOverrides:,numberCell,parentRowAlignment,parentRowIsSelected,parentRowType,positionInRow,rowSpan,scale,selectedRowCount,selectedRowCountLocalized,selectionCell,selectionMode;setFocus"],"calcite-table-row":[()=>_e(()=>import("./customElement-Bz7c1FX_.js"),__vite__mapDeps([423,293,271,267,264,303,274,276,269])),"alignment,bodyRowCount,cellCount,disabled,interactionMode,itemHidden,lastVisibleRow,numbered,positionAll,positionSection,positionSectionLocalized,readCellContentsToAT,rowType,scale,selected,selectedRowCount,selectedRowCountLocalized,selectionMode"],"calcite-tabs":[()=>_e(()=>import("./customElement-0zaPMBoq.js"),__vite__mapDeps([424,271,267,264])),"bordered,layout,position,scale"],"calcite-text-area":[()=>_e(()=>import("./customElement-uP6lCP8q.js"),__vite__mapDeps([425,339,271,273,267,264,275,306,303,268,276,269,274,313,368,265,335,299])),"columns,disabled,form,groupSeparator,label,limitText,maxLength,messageOverrides:,minLength,name,numberingSystem,placeholder,readOnly,required,resize,rows,scale,status,validationIcon,validationMessage,validity:,value,wrap;selectText,setFocus"],"calcite-tile":[()=>_e(()=>import("./customElement-Dwg1FIJ5.js"),__vite__mapDeps([426,271,274,267,264,276,269])),"active,alignment,description,disabled,embed,heading,href,icon,iconFlipRtl,interactive,label,layout,scale,selected,selectionAppearance,selectionMode;setFocus"],"calcite-tile-group":[()=>_e(()=>import("./customElement-DV9CMoYo.js"),__vite__mapDeps([427,271,274,268,267,264])),"alignment,disabled,label,layout,scale,selectedItems:,selectionAppearance,selectionMode"],"calcite-tile-select":[()=>_e(()=>import("./customElement-BksUVrNH.js"),__vite__mapDeps([428,264,274,276,269])),"checked,description,disabled,heading,icon,iconFlipRtl,inputAlignment,inputEnabled,name,type,value,width;setFocus"],"calcite-tile-select-group":[()=>_e(()=>import("./customElement-CMA_pTJq.js"),__vite__mapDeps([429,274,269])),"disabled,layout"],"calcite-time-picker":[()=>_e(()=>import("./customElement-B43FRdz6.js"),__vite__mapDeps([430,271,303,306,374,334,276,269,267,264,265])),"hourFormat,messageOverrides:,numberingSystem,scale,step,value;setFocus"],"calcite-tip":[()=>_e(()=>import("./customElement-7yDP6OB-.js"),__vite__mapDeps([431,293,321,272,269,267,264,265])),"closed,closeDisabled,heading,headingLevel,messageOverrides:,selected"],"calcite-tip-group":[()=>_e(()=>import("./customElement-DvDjJfXC.js"),__vite__mapDeps([432,269])),"groupTitle"],"calcite-tip-manager":[()=>_e(()=>import("./customElement-CcKhteDh.js"),__vite__mapDeps([433,271,293,267,264,268,321,272,269,265])),"closed,headingLevel,messageOverrides:;nextTip,previousTip"],"calcite-tooltip":[()=>_e(()=>import("./index-XfTTzDdH.js").then(t=>t.c),__vite__mapDeps([434,271,311,312,267,264,299,307,396,293])),"closeOnClick,label,offsetDistance,offsetSkidding,open,overlayPositioning,placement,referenceElement;reposition"],"calcite-tree":[()=>_e(()=>import("./customElement-CQsBGuAz.js"),__vite__mapDeps([435,267,264])),"child,lines,parentExpanded,scale,selectedItems:,selectionMode"],"calcite-tree-item":[()=>_e(()=>import("./customElement-8uMsXBhx.js"),__vite__mapDeps([436,293,271,267,264,274,276,269])),"depth,disabled,expanded,hasChildren,iconFlipRtl,iconStart,indeterminate,label,lines,parentExpanded,scale,selected,selectionMode"]});class ddt{static test(e){const i=q_e(e.view.center,e.statePlane),s=8e3/2,n=new fy({rings:[[[i.x-s,i.y+s],[i.x-s,i.y-s],[i.x+s,i.y-s],[i.x+s,i.y+s]]],spatialReference:e.statePlane}),r=new Fj(n.rings[0].map(o=>new Mm({x:o[0],y:o[1],spatialReference:e.statePlane})));e.graphicsLayer.add(new Kr({geometry:n,symbol:wS.green(),attributes:{modelAttributes:new xu(r,Zr.Boundary,0)}}))}}hdt(window);const mdt=Ve.forwardRef((t,e)=>{Ve.useImperativeHandle(e,()=>({setCurrentMode:o=>n.setMode(o)}));const i=Ve.useRef(null),s=Ve.useRef(null),n=Ve.use(Hj),r=()=>{n.statePlane=new aMe({wkid:32039}),n.statePlaneName="NAD27 - Texas Central";const o=new I0e({basemap:"gray-vector"});n.view=new tot({container:i.current,map:o,center:[-102.55,31.02],zoom:12}),n.view.ui.remove("zoom"),n.view.ui.remove("attribution"),s.current=n.view;const a=new bwe({url:"https://services.arcgis.com/jDGuO8tYggdCCnUJ/arcgis/rest/services/Leases/FeatureServer/0",renderer:new Om({symbol:new bd({color:[255,255,0,.2],outline:{color:[0,0,0,.2],width:1}})})});o.add(a),o.add(n.graphicsLayer),n.view.on("click",l=>{n.click(l)}),n.view.on("double-click",l=>{n.dblclick(l)}),n.view.on("pointer-move",l=>{n.move(l)}),n.view.on("drag",l=>{n.drag(l)}),document.addEventListener("keydown",l=>{l.key==="Escape"&&n.escape()}),ddt.test(n)};return Ve.useEffect(()=>(n.view?n.view.container=i.current:SGe().then(()=>{r()}).catch(o=>{console.error("Error loading projection:",o)}),()=>{s.current&&(s.current.container=null)}),[]),ri.jsx("div",{style:{height:"100%",width:"100%"},children:ri.jsx("div",{className:"mapDiv",ref:i,style:{display:"flex",flex:1,height:"100%",width:"100%"}})})}),pdt=()=>{const t=Ve.useRef(null),e=Ve.useRef(null),i=Ve.useRef(null),s=Ve.useRef(null),n=Ve.useRef(["map","three"]),r=(l,u)=>{var c,h;u!=="map"&&((c=i.current)==null||c.setBackPanelCode(l)),u!="three"&&((h=s.current)==null||h.setBackPanelCode(l)),e.current.resize()},o=l=>{var u,c;n.current.splice(n.current.indexOf(l),1),n.current.push(l),(u=i.current)==null||u.setZOrder(n.current),(c=s.current)==null||c.setZOrder(n.current)},a=l=>{t.current.setCurrentMode(l)};return Ve.useEffect(()=>{r("map","main")},[]),ri.jsxs("div",{className:"container-fluid",style:{padding:"0px",zIndex:100},children:[ri.jsx("nav",{className:"navbar navbar-expand-lg bg-primary bg-gradient",style:{padding:"0px"},children:ri.jsxs("div",{className:"container-fluid text-white",style:{padding:"0px 20px"},children:[ri.jsx("a",{className:"navbar-brand",href:"#",children:"Styx"}),ri.jsx("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:ri.jsx("span",{className:"navbar-toggler-icon"})}),ri.jsx("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",children:ri.jsxs("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:[ri.jsxs("li",{className:"nav-item dropdown",children:[ri.jsx("a",{className:"nav-link dropdown-toggle text-white",href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:"Layout"}),ri.jsxs("ul",{className:"dropdown-menu",children:[ri.jsx("li",{children:ri.jsx("a",{className:"dropdown-item",href:"#",onClick:()=>r("map","main"),children:"Expand Map"})}),ri.jsx("li",{children:ri.jsx("a",{className:"dropdown-item",href:"#",onClick:()=>r("three","main"),children:"Expand 3-D"})}),ri.jsx("li",{children:ri.jsx("a",{className:"dropdown-item",href:"#",onClick:()=>r("none","main"),children:"Float All"})}),ri.jsx("li",{children:ri.jsx("hr",{className:"dropdown-divider"})}),ri.jsx("li",{children:ri.jsx("a",{className:"dropdown-item",href:"#",onClick:()=>o("map"),children:"Bring Map to Front"})}),ri.jsx("li",{children:ri.jsx("a",{className:"dropdown-item",href:"#",onClick:()=>o("three"),children:"Bring 3-D to Front"})}),ri.jsx("li",{children:ri.jsx("hr",{className:"dropdown-divider"})}),ri.jsx("li",{children:ri.jsx("a",{className:"dropdown-item",href:"#",onClick:()=>i.current.hide(),children:"Hide Map"})}),ri.jsx("li",{children:ri.jsx("a",{className:"dropdown-item",href:"#",onClick:()=>s.current.hide(),children:"Hide 3-D"})})]})]}),ri.jsxs("li",{className:"nav-item dropdown",children:[ri.jsx("a",{className:"nav-link dropdown-toggle text-white",href:"#",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:"New"}),ri.jsxs("ul",{className:"dropdown-menu",children:[ri.jsx("li",{children:ri.jsx("a",{className:"dropdown-item",href:"#",onClick:()=>a(dr.DrawLine),children:"Wellbore"})}),ri.jsx("li",{children:ri.jsx("a",{className:"dropdown-item",href:"#",onClick:()=>a(dr.DrawPolygon),children:"Block"})}),ri.jsx("li",{children:ri.jsx("a",{className:"dropdown-item",href:"#",onClick:()=>a(dr.DrawRect),children:"Rectangular"})})]})]})]})})]})}),ri.jsx(Jie,{ref:i,panelCode:"map",title:"Map View",defaults:{position:{x:0,y:50},size:{width:"50vw",height:"50vh"}},onSetToBackPanel:()=>{r("map","map")},onBringToFront:()=>{o("map")},onResize:l=>{},children:ri.jsx(mdt,{ref:t})}),ri.jsx(Jie,{ref:s,panelCode:"three",title:"3-D View",defaults:{position:{x:20,y:parent.innerHeight/2-20},size:{width:"50vw",height:parent.innerHeight/2+"px"}},onSetToBackPanel:()=>{r("three","three")},onBringToFront:()=>{o("three")},onResize:l=>{e.current.resize()},children:ri.jsx(cje,{ref:e})})]})};function fdt(){Ve.useEffect(()=>{document.title="Styx"},[]);const t=IL.instance;return ri.jsx(ri.Fragment,{children:ri.jsx(Hj,{value:t,children:ri.jsx(pdt,{})})})}var cC={},vle;function gdt(){if(vle)return cC;vle=1,Object.defineProperty(cC,"__esModule",{value:!0}),cC.parse=o,cC.serialize=u;const t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,i=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,s=/^[\u0020-\u003A\u003D-\u007E]*$/,n=Object.prototype.toString,r=(()=>{const d=function(){};return d.prototype=Object.create(null),d})();function o(d,m){const f=new r,_=d.length;if(_<2)return f;const v=(m==null?void 0:m.decode)||c;let x=0;do{const w=d.indexOf("=",x);if(w===-1)break;const T=d.indexOf(";",x),C=T===-1?_:T;if(w>C){x=d.lastIndexOf(";",w-1)+1;continue}const M=a(d,x,w),A=l(d,w,M),I=d.slice(M,A);if(f[I]===void 0){let L=a(d,w+1,C),D=l(d,C,L);const O=v(d.slice(L,D));f[I]=O}x=C+1}while(x<_);return f}function a(d,m,f){do{const _=d.charCodeAt(m);if(_!==32&&_!==9)return m}while(++m<f);return f}function l(d,m,f){for(;m>f;){const _=d.charCodeAt(--m);if(_!==32&&_!==9)return m+1}return f}function u(d,m,f){const _=(f==null?void 0:f.encode)||encodeURIComponent;if(!t.test(d))throw new TypeError(`argument name is invalid: ${d}`);const v=_(m);if(!e.test(v))throw new TypeError(`argument val is invalid: ${m}`);let x=d+"="+v;if(!f)return x;if(f.maxAge!==void 0){if(!Number.isInteger(f.maxAge))throw new TypeError(`option maxAge is invalid: ${f.maxAge}`);x+="; Max-Age="+f.maxAge}if(f.domain){if(!i.test(f.domain))throw new TypeError(`option domain is invalid: ${f.domain}`);x+="; Domain="+f.domain}if(f.path){if(!s.test(f.path))throw new TypeError(`option path is invalid: ${f.path}`);x+="; Path="+f.path}if(f.expires){if(!h(f.expires)||!Number.isFinite(f.expires.valueOf()))throw new TypeError(`option expires is invalid: ${f.expires}`);x+="; Expires="+f.expires.toUTCString()}if(f.httpOnly&&(x+="; HttpOnly"),f.secure&&(x+="; Secure"),f.partitioned&&(x+="; Partitioned"),f.priority)switch(typeof f.priority=="string"?f.priority.toLowerCase():void 0){case"low":x+="; Priority=Low";break;case"medium":x+="; Priority=Medium";break;case"high":x+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${f.priority}`)}if(f.sameSite)switch(typeof f.sameSite=="string"?f.sameSite.toLowerCase():f.sameSite){case!0:case"strict":x+="; SameSite=Strict";break;case"lax":x+="; SameSite=Lax";break;case"none":x+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${f.sameSite}`)}return x}function c(d){if(d.indexOf("%")===-1)return d;try{return decodeURIComponent(d)}catch{return d}}function h(d){return n.call(d)==="[object Date]"}return cC}gdt();var xle="popstate";function _dt(t={}){function e(s,n){let{pathname:r,search:o,hash:a}=s.location;return eH("",{pathname:r,search:o,hash:a},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function i(s,n){return typeof n=="string"?n:DM(n)}return vdt(e,i,null,t)}function ko(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function qm(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function ydt(){return Math.random().toString(36).substring(2,10)}function ble(t,e){return{usr:t.state,key:t.key,idx:e}}function eH(t,e,i=null,s){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?IA(e):e,state:i,key:e&&e.key||s||ydt()}}function DM({pathname:t="/",search:e="",hash:i=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),i&&i!=="#"&&(t+=i.charAt(0)==="#"?i:"#"+i),t}function IA(t){let e={};if(t){let i=t.indexOf("#");i>=0&&(e.hash=t.substring(i),t=t.substring(0,i));let s=t.indexOf("?");s>=0&&(e.search=t.substring(s),t=t.substring(0,s)),t&&(e.pathname=t)}return e}function vdt(t,e,i,s={}){let{window:n=document.defaultView,v5Compat:r=!1}=s,o=n.history,a="POP",l=null,u=c();u==null&&(u=0,o.replaceState({...o.state,idx:u},""));function c(){return(o.state||{idx:null}).idx}function h(){a="POP";let v=c(),x=v==null?null:v-u;u=v,l&&l({action:a,location:_.location,delta:x})}function d(v,x){a="PUSH";let w=eH(_.location,v,x);u=c()+1;let T=ble(w,u),C=_.createHref(w);try{o.pushState(T,"",C)}catch(M){if(M instanceof DOMException&&M.name==="DataCloneError")throw M;n.location.assign(C)}r&&l&&l({action:a,location:_.location,delta:1})}function m(v,x){a="REPLACE";let w=eH(_.location,v,x);u=c();let T=ble(w,u),C=_.createHref(w);o.replaceState(T,"",C),r&&l&&l({action:a,location:_.location,delta:0})}function f(v){return xdt(v)}let _={get action(){return a},get location(){return t(n,o)},listen(v){if(l)throw new Error("A history only accepts one active listener");return n.addEventListener(xle,h),l=v,()=>{n.removeEventListener(xle,h),l=null}},createHref(v){return e(n,v)},createURL:f,encodeLocation(v){let x=f(v);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:d,replace:m,go(v){return o.go(v)}};return _}function xdt(t,e=!1){let i="http://localhost";typeof window<"u"&&(i=window.location.origin!=="null"?window.location.origin:window.location.href),ko(i,"No window.location.(origin|href) available to create URL");let s=typeof t=="string"?t:DM(t);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=i+s),new URL(s,i)}function Swe(t,e,i="/"){return bdt(t,e,i,!1)}function bdt(t,e,i,s){let n=typeof e=="string"?IA(e):e,r=qf(n.pathname||"/",i);if(r==null)return null;let o=Ewe(t);wdt(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let u=Rdt(r);a=Ddt(o[l],u,s)}return a}function Ewe(t,e=[],i=[],s=""){let n=(r,o,a)=>{let l={relativePath:a===void 0?r.path||"":a,caseSensitive:r.caseSensitive===!0,childrenIndex:o,route:r};l.relativePath.startsWith("/")&&(ko(l.relativePath.startsWith(s),`Absolute route path "${l.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(s.length));let u=If([s,l.relativePath]),c=i.concat(l);r.children&&r.children.length>0&&(ko(r.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),Ewe(r.children,e,c,u)),!(r.path==null&&!r.index)&&e.push({path:u,score:Adt(u,r.index),routesMeta:c})};return t.forEach((r,o)=>{var a;if(r.path===""||!((a=r.path)!=null&&a.includes("?")))n(r,o);else for(let l of Cwe(r.path))n(r,o,l)}),e}function Cwe(t){let e=t.split("/");if(e.length===0)return[];let[i,...s]=e,n=i.endsWith("?"),r=i.replace(/\?$/,"");if(s.length===0)return n?[r,""]:[r];let o=Cwe(s.join("/")),a=[];return a.push(...o.map(l=>l===""?r:[r,l].join("/"))),n&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function wdt(t){t.sort((e,i)=>e.score!==i.score?i.score-e.score:Idt(e.routesMeta.map(s=>s.childrenIndex),i.routesMeta.map(s=>s.childrenIndex)))}var Sdt=/^:[\w-]+$/,Edt=3,Cdt=2,Tdt=1,Pdt=10,Mdt=-2,wle=t=>t==="*";function Adt(t,e){let i=t.split("/"),s=i.length;return i.some(wle)&&(s+=Mdt),e&&(s+=Cdt),i.filter(n=>!wle(n)).reduce((n,r)=>n+(Sdt.test(r)?Edt:r===""?Tdt:Pdt),s)}function Idt(t,e){return t.length===e.length&&t.slice(0,-1).every((s,n)=>s===e[n])?t[t.length-1]-e[e.length-1]:0}function Ddt(t,e,i=!1){let{routesMeta:s}=t,n={},r="/",o=[];for(let a=0;a<s.length;++a){let l=s[a],u=a===s.length-1,c=r==="/"?e:e.slice(r.length)||"/",h=cF({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),d=l.route;if(!h&&u&&i&&!s[s.length-1].route.index&&(h=cF({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},c)),!h)return null;Object.assign(n,h.params),o.push({params:n,pathname:If([r,h.pathname]),pathnameBase:kdt(If([r,h.pathnameBase])),route:d}),h.pathnameBase!=="/"&&(r=If([r,h.pathnameBase]))}return o}function cF(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[i,s]=Ndt(t.path,t.caseSensitive,t.end),n=e.match(i);if(!n)return null;let r=n[0],o=r.replace(/(.)\/+$/,"$1"),a=n.slice(1);return{params:s.reduce((u,{paramName:c,isOptional:h},d)=>{if(c==="*"){let f=a[d]||"";o=r.slice(0,r.length-f.length).replace(/(.)\/+$/,"$1")}const m=a[d];return h&&!m?u[c]=void 0:u[c]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:r,pathnameBase:o,pattern:t}}function Ndt(t,e=!1,i=!0){qm(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let s=[],n="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(s.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),n+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?n+="\\/*$":t!==""&&t!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,e?void 0:"i"),s]}function Rdt(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return qm(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function qf(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let i=e.endsWith("/")?e.length-1:e.length,s=t.charAt(i);return s&&s!=="/"?null:t.slice(i)||"/"}function Odt(t,e="/"){let{pathname:i,search:s="",hash:n=""}=typeof t=="string"?IA(t):t;return{pathname:i?i.startsWith("/")?i:Ldt(i,e):e,search:$dt(s),hash:Udt(n)}}function Ldt(t,e){let i=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(n=>{n===".."?i.length>1&&i.pop():n!=="."&&i.push(n)}),i.length>1?i.join("/"):"/"}function iz(t,e,i,s){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${i}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Fdt(t){return t.filter((e,i)=>i===0||e.route.path&&e.route.path.length>0)}function Twe(t){let e=Fdt(t);return e.map((i,s)=>s===e.length-1?i.pathname:i.pathnameBase)}function Pwe(t,e,i,s=!1){let n;typeof t=="string"?n=IA(t):(n={...t},ko(!n.pathname||!n.pathname.includes("?"),iz("?","pathname","search",n)),ko(!n.pathname||!n.pathname.includes("#"),iz("#","pathname","hash",n)),ko(!n.search||!n.search.includes("#"),iz("#","search","hash",n)));let r=t===""||n.pathname==="",o=r?"/":n.pathname,a;if(o==null)a=i;else{let h=e.length-1;if(!s&&o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),h-=1;n.pathname=d.join("/")}a=h>=0?e[h]:"/"}let l=Odt(n,a),u=o&&o!=="/"&&o.endsWith("/"),c=(r||o===".")&&i.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}var If=t=>t.join("/").replace(/\/\/+/g,"/"),kdt=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),$dt=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Udt=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Vdt(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var Mwe=["POST","PUT","PATCH","DELETE"];new Set(Mwe);var zdt=["GET",...Mwe];new Set(zdt);var dE=Ve.createContext(null);dE.displayName="DataRouter";var xk=Ve.createContext(null);xk.displayName="DataRouterState";var Awe=Ve.createContext({isTransitioning:!1});Awe.displayName="ViewTransition";var Gdt=Ve.createContext(new Map);Gdt.displayName="Fetchers";var Bdt=Ve.createContext(null);Bdt.displayName="Await";var Xm=Ve.createContext(null);Xm.displayName="Navigation";var bk=Ve.createContext(null);bk.displayName="Location";var Qf=Ve.createContext({outlet:null,matches:[],isDataRoute:!1});Qf.displayName="Route";var bX=Ve.createContext(null);bX.displayName="RouteError";function qdt(t,{relative:e}={}){ko(DA(),"useHref() may be used only in the context of a <Router> component.");let{basename:i,navigator:s}=Ve.useContext(Xm),{hash:n,pathname:r,search:o}=NA(t,{relative:e}),a=r;return i!=="/"&&(a=r==="/"?i:If([i,r])),s.createHref({pathname:a,search:o,hash:n})}function DA(){return Ve.useContext(bk)!=null}function X1(){return ko(DA(),"useLocation() may be used only in the context of a <Router> component."),Ve.useContext(bk).location}var Iwe="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Dwe(t){Ve.useContext(Xm).static||Ve.useLayoutEffect(t)}function Hdt(){let{isDataRoute:t}=Ve.useContext(Qf);return t?nmt():jdt()}function jdt(){ko(DA(),"useNavigate() may be used only in the context of a <Router> component.");let t=Ve.useContext(dE),{basename:e,navigator:i}=Ve.useContext(Xm),{matches:s}=Ve.useContext(Qf),{pathname:n}=X1(),r=JSON.stringify(Twe(s)),o=Ve.useRef(!1);return Dwe(()=>{o.current=!0}),Ve.useCallback((l,u={})=>{if(qm(o.current,Iwe),!o.current)return;if(typeof l=="number"){i.go(l);return}let c=Pwe(l,JSON.parse(r),n,u.relative==="path");t==null&&e!=="/"&&(c.pathname=c.pathname==="/"?e:If([e,c.pathname])),(u.replace?i.replace:i.push)(c,u.state,u)},[e,i,r,n,t])}Ve.createContext(null);function NA(t,{relative:e}={}){let{matches:i}=Ve.useContext(Qf),{pathname:s}=X1(),n=JSON.stringify(Twe(i));return Ve.useMemo(()=>Pwe(t,JSON.parse(n),s,e==="path"),[t,n,s,e])}function Ydt(t,e,i,s){ko(DA(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:n,static:r}=Ve.useContext(Xm),{matches:o}=Ve.useContext(Qf),a=o[o.length-1],l=a?a.params:{},u=a?a.pathname:"/",c=a?a.pathnameBase:"/",h=a&&a.route;{let w=h&&h.path||"";Nwe(u,!h||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let d=X1(),m;m=d;let f=m.pathname||"/",_=f;if(c!=="/"){let w=c.replace(/^\//,"").split("/");_="/"+f.replace(/^\//,"").split("/").slice(w.length).join("/")}let v=!r&&i&&i.matches&&i.matches.length>0?i.matches:Swe(t,{pathname:_});return qm(h||v!=null,`No routes matched location "${m.pathname}${m.search}${m.hash}" `),qm(v==null||v[v.length-1].route.element!==void 0||v[v.length-1].route.Component!==void 0||v[v.length-1].route.lazy!==void 0,`Matched leaf route at location "${m.pathname}${m.search}${m.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),Qdt(v&&v.map(w=>Object.assign({},w,{params:Object.assign({},l,w.params),pathname:If([c,n.encodeLocation?n.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?c:If([c,n.encodeLocation?n.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),o,i,s)}function Xdt(){let t=smt(),e=Vdt(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),i=t instanceof Error?t.stack:null,s="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:s},r={padding:"2px 4px",backgroundColor:s},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=Ve.createElement(Ve.Fragment,null,Ve.createElement("p",null,"💿 Hey developer 👋"),Ve.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",Ve.createElement("code",{style:r},"ErrorBoundary")," or"," ",Ve.createElement("code",{style:r},"errorElement")," prop on your route.")),Ve.createElement(Ve.Fragment,null,Ve.createElement("h2",null,"Unexpected Application Error!"),Ve.createElement("h3",{style:{fontStyle:"italic"}},e),i?Ve.createElement("pre",{style:n},i):null,o)}var Wdt=Ve.createElement(Xdt,null),Zdt=class extends Ve.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?Ve.createElement(Qf.Provider,{value:this.props.routeContext},Ve.createElement(bX.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Kdt({routeContext:t,match:e,children:i}){let s=Ve.useContext(dE);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),Ve.createElement(Qf.Provider,{value:t},i)}function Qdt(t,e=[],i=null,s=null){if(t==null){if(!i)return null;if(i.errors)t=i.matches;else if(e.length===0&&!i.initialized&&i.matches.length>0)t=i.matches;else return null}let n=t,r=i==null?void 0:i.errors;if(r!=null){let l=n.findIndex(u=>u.route.id&&(r==null?void 0:r[u.route.id])!==void 0);ko(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(r).join(",")}`),n=n.slice(0,Math.min(n.length,l+1))}let o=!1,a=-1;if(i)for(let l=0;l<n.length;l++){let u=n[l];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(a=l),u.route.id){let{loaderData:c,errors:h}=i,d=u.route.loader&&!c.hasOwnProperty(u.route.id)&&(!h||h[u.route.id]===void 0);if(u.route.lazy||d){o=!0,a>=0?n=n.slice(0,a+1):n=[n[0]];break}}}return n.reduceRight((l,u,c)=>{let h,d=!1,m=null,f=null;i&&(h=r&&u.route.id?r[u.route.id]:void 0,m=u.route.errorElement||Wdt,o&&(a<0&&c===0?(Nwe("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,f=null):a===c&&(d=!0,f=u.route.hydrateFallbackElement||null)));let _=e.concat(n.slice(0,c+1)),v=()=>{let x;return h?x=m:d?x=f:u.route.Component?x=Ve.createElement(u.route.Component,null):u.route.element?x=u.route.element:x=l,Ve.createElement(Kdt,{match:u,routeContext:{outlet:l,matches:_,isDataRoute:i!=null},children:x})};return i&&(u.route.ErrorBoundary||u.route.errorElement||c===0)?Ve.createElement(Zdt,{location:i.location,revalidation:i.revalidation,component:m,error:h,children:v(),routeContext:{outlet:null,matches:_,isDataRoute:!0}}):v()},null)}function wX(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Jdt(t){let e=Ve.useContext(dE);return ko(e,wX(t)),e}function emt(t){let e=Ve.useContext(xk);return ko(e,wX(t)),e}function tmt(t){let e=Ve.useContext(Qf);return ko(e,wX(t)),e}function SX(t){let e=tmt(t),i=e.matches[e.matches.length-1];return ko(i.route.id,`${t} can only be used on routes that contain a unique "id"`),i.route.id}function imt(){return SX("useRouteId")}function smt(){var s;let t=Ve.useContext(bX),e=emt("useRouteError"),i=SX("useRouteError");return t!==void 0?t:(s=e.errors)==null?void 0:s[i]}function nmt(){let{router:t}=Jdt("useNavigate"),e=SX("useNavigate"),i=Ve.useRef(!1);return Dwe(()=>{i.current=!0}),Ve.useCallback(async(n,r={})=>{qm(i.current,Iwe),i.current&&(typeof n=="number"?t.navigate(n):await t.navigate(n,{fromRouteId:e,...r}))},[t,e])}var Sle={};function Nwe(t,e,i){!e&&!Sle[t]&&(Sle[t]=!0,qm(!1,i))}Ve.memo(rmt);function rmt({routes:t,future:e,state:i}){return Ydt(t,void 0,i,e)}function omt({basename:t="/",children:e=null,location:i,navigationType:s="POP",navigator:n,static:r=!1}){ko(!DA(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),a=Ve.useMemo(()=>({basename:o,navigator:n,static:r,future:{}}),[o,n,r]);typeof i=="string"&&(i=IA(i));let{pathname:l="/",search:u="",hash:c="",state:h=null,key:d="default"}=i,m=Ve.useMemo(()=>{let f=qf(l,o);return f==null?null:{location:{pathname:f,search:u,hash:c,state:h,key:d},navigationType:s}},[o,l,u,c,h,d,s]);return qm(m!=null,`<Router basename="${o}"> is not able to match the URL "${l}${u}${c}" because it does not start with the basename, so the <Router> won't render anything.`),m==null?null:Ve.createElement(Xm.Provider,{value:a},Ve.createElement(bk.Provider,{children:e,value:m}))}var lO="get",uO="application/x-www-form-urlencoded";function wk(t){return t!=null&&typeof t.tagName=="string"}function amt(t){return wk(t)&&t.tagName.toLowerCase()==="button"}function lmt(t){return wk(t)&&t.tagName.toLowerCase()==="form"}function umt(t){return wk(t)&&t.tagName.toLowerCase()==="input"}function cmt(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function hmt(t,e){return t.button===0&&(!e||e==="_self")&&!cmt(t)}var yR=null;function dmt(){if(yR===null)try{new FormData(document.createElement("form"),0),yR=!1}catch{yR=!0}return yR}var mmt=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function sz(t){return t!=null&&!mmt.has(t)?(qm(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${uO}"`),null):t}function pmt(t,e){let i,s,n,r,o;if(lmt(t)){let a=t.getAttribute("action");s=a?qf(a,e):null,i=t.getAttribute("method")||lO,n=sz(t.getAttribute("enctype"))||uO,r=new FormData(t)}else if(amt(t)||umt(t)&&(t.type==="submit"||t.type==="image")){let a=t.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||a.getAttribute("action");if(s=l?qf(l,e):null,i=t.getAttribute("formmethod")||a.getAttribute("method")||lO,n=sz(t.getAttribute("formenctype"))||sz(a.getAttribute("enctype"))||uO,r=new FormData(a,t),!dmt()){let{name:u,type:c,value:h}=t;if(c==="image"){let d=u?`${u}.`:"";r.append(`${d}x`,"0"),r.append(`${d}y`,"0")}else u&&r.append(u,h)}}else{if(wk(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');i=lO,s=null,n=uO,o=t}return r&&n==="text/plain"&&(o=r,r=void 0),{action:s,method:i.toLowerCase(),encType:n,formData:r,body:o}}function EX(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function fmt(t,e){if(t.id in e)return e[t.id];try{let i=await import(t.module);return e[t.id]=i,i}catch(i){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(i),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function gmt(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function _mt(t,e,i){let s=await Promise.all(t.map(async n=>{let r=e.routes[n.route.id];if(r){let o=await fmt(r,i);return o.links?o.links():[]}return[]}));return bmt(s.flat(1).filter(gmt).filter(n=>n.rel==="stylesheet"||n.rel==="preload").map(n=>n.rel==="stylesheet"?{...n,rel:"prefetch",as:"style"}:{...n,rel:"prefetch"}))}function Ele(t,e,i,s,n,r){let o=(l,u)=>i[u]?l.route.id!==i[u].route.id:!0,a=(l,u)=>{var c;return i[u].pathname!==l.pathname||((c=i[u].route.path)==null?void 0:c.endsWith("*"))&&i[u].params["*"]!==l.params["*"]};return r==="assets"?e.filter((l,u)=>o(l,u)||a(l,u)):r==="data"?e.filter((l,u)=>{var h;let c=s.routes[l.route.id];if(!c||!c.hasLoader)return!1;if(o(l,u)||a(l,u))return!0;if(l.route.shouldRevalidate){let d=l.route.shouldRevalidate({currentUrl:new URL(n.pathname+n.search+n.hash,window.origin),currentParams:((h=i[0])==null?void 0:h.params)||{},nextUrl:new URL(t,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof d=="boolean")return d}return!0}):[]}function ymt(t,e,{includeHydrateFallback:i}={}){return vmt(t.map(s=>{let n=e.routes[s.route.id];if(!n)return[];let r=[n.module];return n.clientActionModule&&(r=r.concat(n.clientActionModule)),n.clientLoaderModule&&(r=r.concat(n.clientLoaderModule)),i&&n.hydrateFallbackModule&&(r=r.concat(n.hydrateFallbackModule)),n.imports&&(r=r.concat(n.imports)),r}).flat(1))}function vmt(t){return[...new Set(t)]}function xmt(t){let e={},i=Object.keys(t).sort();for(let s of i)e[s]=t[s];return e}function bmt(t,e){let i=new Set;return new Set(e),t.reduce((s,n)=>{let r=JSON.stringify(xmt(n));return i.has(r)||(i.add(r),s.push({key:r,link:n})),s},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var wmt=new Set([100,101,204,205]);function Smt(t,e){let i=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return i.pathname==="/"?i.pathname="_root.data":e&&qf(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.data`:i.pathname=`${i.pathname.replace(/\/$/,"")}.data`,i}function Rwe(){let t=Ve.useContext(dE);return EX(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function Emt(){let t=Ve.useContext(xk);return EX(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var CX=Ve.createContext(void 0);CX.displayName="FrameworkContext";function Owe(){let t=Ve.useContext(CX);return EX(t,"You must render this element inside a <HydratedRouter> element"),t}function Cmt(t,e){let i=Ve.useContext(CX),[s,n]=Ve.useState(!1),[r,o]=Ve.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:u,onMouseLeave:c,onTouchStart:h}=e,d=Ve.useRef(null);Ve.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let _=x=>{x.forEach(w=>{o(w.isIntersecting)})},v=new IntersectionObserver(_,{threshold:.5});return d.current&&v.observe(d.current),()=>{v.disconnect()}}},[t]),Ve.useEffect(()=>{if(s){let _=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(_)}}},[s]);let m=()=>{n(!0)},f=()=>{n(!1),o(!1)};return i?t!=="intent"?[r,d,{}]:[r,d,{onFocus:hC(a,m),onBlur:hC(l,f),onMouseEnter:hC(u,m),onMouseLeave:hC(c,f),onTouchStart:hC(h,m)}]:[!1,d,{}]}function hC(t,e){return i=>{t&&t(i),i.defaultPrevented||e(i)}}function Tmt({page:t,...e}){let{router:i}=Rwe(),s=Ve.useMemo(()=>Swe(i.routes,t,i.basename),[i.routes,t,i.basename]);return s?Ve.createElement(Mmt,{page:t,matches:s,...e}):null}function Pmt(t){let{manifest:e,routeModules:i}=Owe(),[s,n]=Ve.useState([]);return Ve.useEffect(()=>{let r=!1;return _mt(t,e,i).then(o=>{r||n(o)}),()=>{r=!0}},[t,e,i]),s}function Mmt({page:t,matches:e,...i}){let s=X1(),{manifest:n,routeModules:r}=Owe(),{basename:o}=Rwe(),{loaderData:a,matches:l}=Emt(),u=Ve.useMemo(()=>Ele(t,e,l,n,s,"data"),[t,e,l,n,s]),c=Ve.useMemo(()=>Ele(t,e,l,n,s,"assets"),[t,e,l,n,s]),h=Ve.useMemo(()=>{if(t===s.pathname+s.search+s.hash)return[];let f=new Set,_=!1;if(e.forEach(x=>{var T;let w=n.routes[x.route.id];!w||!w.hasLoader||(!u.some(C=>C.route.id===x.route.id)&&x.route.id in a&&((T=r[x.route.id])!=null&&T.shouldRevalidate)||w.hasClientLoader?_=!0:f.add(x.route.id))}),f.size===0)return[];let v=Smt(t,o);return _&&f.size>0&&v.searchParams.set("_routes",e.filter(x=>f.has(x.route.id)).map(x=>x.route.id).join(",")),[v.pathname+v.search]},[o,a,s,n,u,e,t,r]),d=Ve.useMemo(()=>ymt(c,n),[c,n]),m=Pmt(c);return Ve.createElement(Ve.Fragment,null,h.map(f=>Ve.createElement("link",{key:f,rel:"prefetch",as:"fetch",href:f,...i})),d.map(f=>Ve.createElement("link",{key:f,rel:"modulepreload",href:f,...i})),m.map(({key:f,link:_})=>Ve.createElement("link",{key:f,..._})))}function Amt(...t){return e=>{t.forEach(i=>{typeof i=="function"?i(e):i!=null&&(i.current=e)})}}var Lwe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Lwe&&(window.__reactRouterVersion="7.6.0")}catch{}function Imt({basename:t,children:e,window:i}){let s=Ve.useRef();s.current==null&&(s.current=_dt({window:i,v5Compat:!0}));let n=s.current,[r,o]=Ve.useState({action:n.action,location:n.location}),a=Ve.useCallback(l=>{Ve.startTransition(()=>o(l))},[o]);return Ve.useLayoutEffect(()=>n.listen(a),[n,a]),Ve.createElement(omt,{basename:t,children:e,location:r.location,navigationType:r.action,navigator:n})}var Fwe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,kwe=Ve.forwardRef(function({onClick:e,discover:i="render",prefetch:s="none",relative:n,reloadDocument:r,replace:o,state:a,target:l,to:u,preventScrollReset:c,viewTransition:h,...d},m){let{basename:f}=Ve.useContext(Xm),_=typeof u=="string"&&Fwe.test(u),v,x=!1;if(typeof u=="string"&&_&&(v=u,Lwe))try{let D=new URL(window.location.href),O=u.startsWith("//")?new URL(D.protocol+u):new URL(u),U=qf(O.pathname,f);O.origin===D.origin&&U!=null?u=U+O.search+O.hash:x=!0}catch{qm(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let w=qdt(u,{relative:n}),[T,C,M]=Cmt(s,d),A=Omt(u,{replace:o,state:a,target:l,preventScrollReset:c,relative:n,viewTransition:h});function I(D){e&&e(D),D.defaultPrevented||A(D)}let L=Ve.createElement("a",{...d,...M,href:v||w,onClick:x||r?e:I,ref:Amt(m,C),target:l,"data-discover":!_&&i==="render"?"true":void 0});return T&&!_?Ve.createElement(Ve.Fragment,null,L,Ve.createElement(Tmt,{page:w})):L});kwe.displayName="Link";var Dmt=Ve.forwardRef(function({"aria-current":e="page",caseSensitive:i=!1,className:s="",end:n=!1,style:r,to:o,viewTransition:a,children:l,...u},c){let h=NA(o,{relative:u.relative}),d=X1(),m=Ve.useContext(xk),{navigator:f,basename:_}=Ve.useContext(Xm),v=m!=null&&Umt(h)&&a===!0,x=f.encodeLocation?f.encodeLocation(h).pathname:h.pathname,w=d.pathname,T=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;i||(w=w.toLowerCase(),T=T?T.toLowerCase():null,x=x.toLowerCase()),T&&_&&(T=qf(T,_)||T);const C=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let M=w===x||!n&&w.startsWith(x)&&w.charAt(C)==="/",A=T!=null&&(T===x||!n&&T.startsWith(x)&&T.charAt(x.length)==="/"),I={isActive:M,isPending:A,isTransitioning:v},L=M?e:void 0,D;typeof s=="function"?D=s(I):D=[s,M?"active":null,A?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let O=typeof r=="function"?r(I):r;return Ve.createElement(kwe,{...u,"aria-current":L,className:D,ref:c,style:O,to:o,viewTransition:a},typeof l=="function"?l(I):l)});Dmt.displayName="NavLink";var Nmt=Ve.forwardRef(({discover:t="render",fetcherKey:e,navigate:i,reloadDocument:s,replace:n,state:r,method:o=lO,action:a,onSubmit:l,relative:u,preventScrollReset:c,viewTransition:h,...d},m)=>{let f=kmt(),_=$mt(a,{relative:u}),v=o.toLowerCase()==="get"?"get":"post",x=typeof a=="string"&&Fwe.test(a),w=T=>{if(l&&l(T),T.defaultPrevented)return;T.preventDefault();let C=T.nativeEvent.submitter,M=(C==null?void 0:C.getAttribute("formmethod"))||o;f(C||T.currentTarget,{fetcherKey:e,method:M,navigate:i,replace:n,state:r,relative:u,preventScrollReset:c,viewTransition:h})};return Ve.createElement("form",{ref:m,method:v,action:_,onSubmit:s?l:w,...d,"data-discover":!x&&t==="render"?"true":void 0})});Nmt.displayName="Form";function Rmt(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function $we(t){let e=Ve.useContext(dE);return ko(e,Rmt(t)),e}function Omt(t,{target:e,replace:i,state:s,preventScrollReset:n,relative:r,viewTransition:o}={}){let a=Hdt(),l=X1(),u=NA(t,{relative:r});return Ve.useCallback(c=>{if(hmt(c,e)){c.preventDefault();let h=i!==void 0?i:DM(l)===DM(u);a(t,{replace:h,state:s,preventScrollReset:n,relative:r,viewTransition:o})}},[l,a,u,i,s,e,t,n,r,o])}var Lmt=0,Fmt=()=>`__${String(++Lmt)}__`;function kmt(){let{router:t}=$we("useSubmit"),{basename:e}=Ve.useContext(Xm),i=imt();return Ve.useCallback(async(s,n={})=>{let{action:r,method:o,encType:a,formData:l,body:u}=pmt(s,e);if(n.navigate===!1){let c=n.fetcherKey||Fmt();await t.fetch(c,i,n.action||r,{preventScrollReset:n.preventScrollReset,formData:l,body:u,formMethod:n.method||o,formEncType:n.encType||a,flushSync:n.flushSync})}else await t.navigate(n.action||r,{preventScrollReset:n.preventScrollReset,formData:l,body:u,formMethod:n.method||o,formEncType:n.encType||a,replace:n.replace,state:n.state,fromRouteId:i,flushSync:n.flushSync,viewTransition:n.viewTransition})},[t,e,i])}function $mt(t,{relative:e}={}){let{basename:i}=Ve.useContext(Xm),s=Ve.useContext(Qf);ko(s,"useFormAction must be used inside a RouteContext");let[n]=s.matches.slice(-1),r={...NA(t||".",{relative:e})},o=X1();if(t==null){r.search=o.search;let a=new URLSearchParams(r.search),l=a.getAll("index");if(l.some(c=>c==="")){a.delete("index"),l.filter(h=>h).forEach(h=>a.append("index",h));let c=a.toString();r.search=c?`?${c}`:""}}return(!t||t===".")&&n.route.index&&(r.search=r.search?r.search.replace(/^\?/,"?index&"):"?index"),i!=="/"&&(r.pathname=r.pathname==="/"?i:If([i,r.pathname])),DM(r)}function Umt(t,e={}){let i=Ve.useContext(Awe);ko(i!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=$we("useViewTransitionState"),n=NA(t,{relative:e.relative});if(!i.isTransitioning)return!1;let r=qf(i.currentLocation.pathname,s)||i.currentLocation.pathname,o=qf(i.nextLocation.pathname,s)||i.nextLocation.pathname;return cF(n.pathname,o)!=null||cF(n.pathname,r)!=null}[...wmt];sEe.createRoot(document.getElementById("root")).render(ri.jsx(Imt,{children:ri.jsx(fdt,{})}));export{g7 as $,ki as A,vr as B,Cu as C,Zbt as D,Sht as E,Jlt as F,Df as G,vet as H,ol as I,_k as J,jat as K,Nvt as L,Kbt as M,Yat as N,Xat as O,$n as P,ke as Q,be as R,twt as S,Xxe as T,hQe as U,Gf as V,it as W,Fy as X,MNe as Y,jS as Z,_e as _,wht as a,f1 as a$,m6e as a0,p_e as a1,P6e as a2,y as a3,S as a4,se as a5,qwt as a6,Bwt as a7,mc as a8,Nt as a9,xct as aA,oct as aB,uct as aC,D4 as aD,qJe as aE,qM as aF,NNe as aG,RNe as aH,ONe as aI,Xce as aJ,d6e as aK,_et as aL,Sue as aM,ime as aN,Xv as aO,d7 as aP,tme as aQ,GQ as aR,eyt as aS,Kft as aT,F1 as aU,uEe as aV,bs as aW,LDe as aX,gs as aY,ai as aZ,Ri as a_,wQe as aa,Kr as ab,zWe as ac,UWe as ad,ht as ae,wbt as af,Qw as ag,TSt as ah,Bgt as ai,Rf as aj,$o as ak,l1 as al,yd as am,lct as an,kl as ao,Cct as ap,Kve as aq,vct as ar,net as as,Met as at,wq as au,iwe as av,fct as aw,swe as ax,twe as ay,Tct as az,mF as b,Xne as b$,QM as b0,EZe as b1,SZe as b2,Uf as b3,xo as b4,mxe as b5,axe as b6,lxe as b7,zbt as b8,Jbt as b9,YCe as bA,_lt as bB,pSt as bC,lSt as bD,Gme as bE,HT as bF,Z6 as bG,glt as bH,fSt as bI,gSt as bJ,lre as bK,ZL as bL,mbt as bM,Gt as bN,hE as bO,Kmt as bP,kle as bQ,eme as bR,Nxt as bS,Cit as bT,Yne as bU,jne as bV,Hne as bW,qne as bX,sh as bY,gbt as bZ,mm as b_,Cbt as ba,iwt as bb,Dv as bc,Gbt as bd,Vbt as be,Ubt as bf,Bbt as bg,Bf as bh,crt as bi,ewt as bj,oxe as bk,_F as bl,gF as bm,tvt as bn,e7 as bo,I3 as bp,DS as bq,RL as br,sr as bs,Jc as bt,hH as bu,Vn as bv,VM as bw,Hm as bx,gwe as by,US as bz,ZZ as c,J1t as c$,Bne as c0,Zle as c1,Ol as c2,YN as c3,dgt as c4,Dl as c5,pve as c6,qv as c7,MPe as c8,Yoe as c9,ZYe as cA,SK as cB,cl as cC,fYe as cD,$le as cE,Nn as cF,BM as cG,gu as cH,Na as cI,HM as cJ,fi as cK,GSt as cL,qSt as cM,BSt as cN,Zut as cO,Wut as cP,Lje as cQ,gft as cR,Qn as cS,yft as cT,_ft as cU,vft as cV,xft as cW,bft as cX,Uz as cY,e1 as cZ,cit as c_,joe as ca,Gs as cb,V9 as cc,Rpt as cd,Vut as ce,jht as cf,Zgt as cg,Kgt as ch,SDe as ci,evt as cj,bDe as ck,mDe as cl,gy as cm,e_t as cn,Jgt as co,Qgt as cp,dDe as cq,zgt as cr,Ggt as cs,_y as ct,vY as cu,ui as cv,bD as cw,vu as cx,spt as cy,mt as cz,VS as d,LTe as d$,ns as d0,txt as d1,pbt as d2,q0e as d3,Iy as d4,yy as d5,kgt as d6,UF as d7,ds as d8,$r as d9,jn as dA,Jne as dB,tU as dC,Ks as dD,eA as dE,L6 as dF,pgt as dG,F_t as dH,iyt as dI,Of as dJ,sme as dK,ei as dL,mMe as dM,Fwt as dN,gM as dO,uu as dP,ca as dQ,jv as dR,nz as dS,qmt as dT,pit as dU,Lle as dV,Kw as dW,ift as dX,r1t as dY,dQe as dZ,OS as d_,Ai as da,nl as db,HS as dc,bEt as dd,Om as de,nh as df,er as dg,Bm as dh,Hy as di,Ay as dj,jy as dk,Iz as dl,Jn as dm,ah as dn,OO as dp,Az as dq,Nz as dr,Wye as ds,g1e as dt,ti as du,EM as dv,Io as dw,XL as dx,Pq as dy,qKe as dz,mrt as e,bet as e$,yEt as e0,Tte as e1,_Et as e2,SNe as e3,UM as e4,vd as e5,J_t as e6,cgt as e7,Gft as e8,Ble as e9,xce as eA,PF as eB,zm as eC,Yc as eD,DF as eE,qve as eF,Zve as eG,jJe as eH,Yve as eI,Wve as eJ,iH as eK,sH as eL,ZK as eM,ih as eN,aft as eO,d2e as eP,ypt as eQ,GCe as eR,Zw as eS,EH as eT,uNe as eU,Bve as eV,By as eW,het as eX,n6e as eY,HJe as eZ,Xve as e_,MF as ea,AF as eb,$Te as ec,DH as ed,NH as ee,kTe as ef,wA as eg,vM as eh,dY as ei,s_t as ej,Tce as ek,Hbe as el,yZe as em,tDe as en,Vgt as eo,KM as ep,m7 as eq,zIe as er,Nde as es,pDe as et,Hgt as eu,rc as ev,qgt as ew,Rde as ex,Xft as ey,AH as ez,qbt as f,yGe as f$,jft as f0,$O as f1,pF as f2,fF as f3,Eft as f4,k0t as f5,sk as f6,Dpt as f7,dH as f8,ZM as f9,wP as fA,H_ as fB,uc as fC,iTe as fD,CF as fE,TH as fF,sTe as fG,pwe as fH,Qpt as fI,km as fJ,vO as fK,RM as fL,yt as fM,Lht as fN,Owt as fO,Sce as fP,E0e as fQ,Hht as fR,XO as fS,zs as fT,WS as fU,bwe as fV,egt as fW,$Ye as fX,qPe as fY,hgt as fZ,la as f_,D_e as fa,Rht as fb,fht as fc,Cht as fd,N_e as fe,Vxe as ff,A4 as fg,aat as fh,nat as fi,Tu as fj,Oa as fk,_u as fl,oA as fm,bd as fn,sat as fo,Not as fp,Rot as fq,Dot as fr,KJe as fs,QJe as ft,wet as fu,rat as fv,uue as fw,oft as fx,xF as fy,zM as fz,Ivt as g,tS as g$,YK as g0,F_ as g1,bP as g2,MO as g3,Ls as g4,CSt as g5,Zpt as g6,rft as g7,coe as g8,Kge as g9,J as gA,Ci as gB,gOe as gC,p0t as gD,gfe as gE,P1 as gF,Fl as gG,_i as gH,zi as gI,GC as gJ,TFe as gK,Ayt as gL,In as gM,Am as gN,wL as gO,lS as gP,Ei as gQ,Tv as gR,mi as gS,Da as gT,Jme as gU,Hf as gV,Ge as gW,Gmt as gX,B_t as gY,nyt as gZ,yP as g_,M4 as ga,dj as gb,_f as gc,bge as gd,pj as ge,yMe as gf,jM as gg,wgt as gh,jf as gi,Sgt as gj,Ov as gk,Egt as gl,ty as gm,N as gn,q as go,Wr as gp,We as gq,NP as gr,Um as gs,nr as gt,f0t as gu,g0t as gv,Pd as gw,ce as gx,Jt as gy,Qi as gz,oTe as h,Nft as h$,i1 as h0,mH as h1,IEe as h2,uy as h3,ppt as h4,Dj as h5,Aze as h6,Mze as h7,dft as h8,mft as h9,r3e as hA,Lo as hB,zl as hC,VUe as hD,hge as hE,dge as hF,NUe as hG,vB as hH,J3e as hI,qyt as hJ,_ge as hK,yo as hL,_S as hM,eJ as hN,gi as hO,Cr as hP,pd as hQ,Me as hR,a3 as hS,U5e as hT,bM as hU,Tr as hV,rve as hW,Oy as hX,rh as hY,Dae as hZ,Pae as h_,yB as ha,ll as hb,Hme as hc,Qv as hd,H1 as he,lM as hf,Pu as hg,yr as hh,Cd as hi,nE as hj,cge as hk,jme as hl,vL as hm,Pj as hn,l4e as ho,Nge as hp,st as hq,he as hr,Gi as hs,f4 as ht,L7 as hu,Is as hv,gge as hw,wn as hx,xS as hy,Ts as hz,Hbt as i,LM as i$,nS as i0,Yye as i1,TY as i2,Lwt as i3,get as i4,Aue as i5,D2e as i6,aEe as i7,oEt as i8,BYe as i9,Xmt as iA,xpt as iB,ibt as iC,lEt as iD,hEt as iE,cEt as iF,nEt as iG,Agt as iH,USt as iI,VSt as iJ,yX as iK,k4 as iL,xQe as iM,V0t as iN,Rft as iO,Ext as iP,G9 as iQ,Bft as iR,Fxt as iS,K_t as iT,U_t as iU,tgt as iV,_yt as iW,oc as iX,c_t as iY,DNe as iZ,a5 as i_,T3 as ia,wft as ib,sft as ic,Lf as id,zlt as ie,Pot as ig,Gwt as ih,jot as ii,zwt as ij,Hot as ik,Iue as il,ASt as im,TR as io,O8 as ip,rw as iq,NF as ir,fgt as is,$1 as it,Eq as iu,WL as iv,cb as iw,Ule as ix,zle as iy,Gle as iz,Pbt as j,xX as j$,vP as j0,Zot as j1,FS as j2,$M as j3,oa as j4,rJe as j5,Wft as j6,HQe as j7,det as j8,Aft as j9,Gse as jA,Su as jB,WYe as jC,SA as jD,aTe as jE,MH as jF,uTe as jG,cTe as jH,o1 as jI,vht as jJ,Got as jK,mht as jL,Jot as jM,kht as jN,AQ as jO,Ede as jP,Yht as jQ,cat as jR,$ht as jS,hk as jT,JV as jU,MA as jV,l9 as jW,ck as jX,Wct as jY,AA as jZ,iat as j_,kK as ja,Ece as jb,Cce as jc,Pr as jd,Yft as je,Kze as jf,m_e as jg,iet as jh,f_e as ji,RTe as jj,_Ye as jk,Re as jl,i6e as jm,gYe as jn,N4 as jo,Hye as jp,Bmt as jq,SR as jr,Jmt as js,met as jt,tet as ju,fQe as jv,uZe as jw,aZe as jx,rZe as jy,xw as jz,Wbt as k,ebt as k$,h7 as k0,npt as k1,kQ as k2,xwe as k3,Sw as k4,XCe as k5,Lm as k6,hd as k7,AM as k8,hX as k9,xr as kA,k5e as kB,kf as kC,E4e as kD,Uge as kE,$t as kF,nj as kG,ZRe as kH,hS as kI,XRe as kJ,Myt as kK,gr as kL,bS as kM,sSt as kN,P_t as kO,GL as kP,w_t as kQ,Y_e as kR,j_e as kS,$We as kT,Avt as kU,m_t as kV,Sbt as kW,Qbt as kX,Nit as kY,Tq as kZ,Kne as k_,R_e as ka,uat as kb,lat as kc,oat as kd,FO as ke,N_t as kf,D_t as kg,zNe as kh,Hce as ki,uX as kj,pc as kk,lfe as kl,C7 as km,Pyt as kn,MRe as ko,fo as kp,Fo as kq,z as kr,G as ks,oge as kt,lge as ku,Di as kv,ul as kw,Vy as kx,y4 as ky,yS as kz,EEt as l,$be as l$,Zne as l0,Wc as l1,f1e as l2,lf as l3,O3 as l4,o1t as l5,Ave as l6,DY as l7,pq as l8,NS as l9,Pet as lA,Aet as lB,sJe as lC,yk as lD,wct as lE,Bye as lF,OTe as lG,Mce as lH,zL as lI,ZJe as lJ,Hve as lK,OL as lL,oet as lM,Ko as lN,fwe as lO,_Ee as lP,Tot as lQ,xut as lR,Wot as lS,Elt as lT,Dbe as lU,Olt as lV,Wue as lW,tce as lX,YYe as lY,Ixe as lZ,wEt as l_,KQe as la,Ive as lb,mre as lc,Gne as ld,y0 as le,ra as lf,bpt as lg,V2e as lh,dc as li,hpt as lj,Xw as lk,vH as ll,eTe as lm,Qft as ln,ea as lo,YQe as lp,WQe as lq,Mve as lr,zmt as ls,uP as lt,Cq as lu,wve as lv,Uj as lw,INe as lx,PNe as ly,WJe as lz,Ebt as m,HPe as m$,oH as m0,Ab as m1,blt as m2,NEt as m3,Zlt as m4,ght as m5,Klt as m6,ed as m7,LS as m8,qbe as m9,Xye as mA,Yre as mB,lft as mC,yCe as mD,tpt as mE,ipt as mF,ept as mG,VCe as mH,k1 as mI,qF as mJ,om as mK,d_t as mL,Fft as mM,qce as mN,tut as mO,A_e as mP,z6e as mQ,G6e as mR,zne as mS,_xt as mT,gxt as mU,fxt as mV,pxt as mW,vxt as mX,yxt as mY,mxt as mZ,dxt as m_,lX as ma,Kf as mb,qht as mc,Llt as md,Ult as me,bbe as mf,nX as mg,nF as mh,tat as mi,rr as mj,qlt as mk,wlt as ml,Slt as mm,Tlt as mn,Plt as mo,$lt as mp,Mlt as mq,Alt as mr,Ilt as ms,Dlt as mt,Nlt as mu,Rlt as mv,vwe as mw,ISt as mx,m2e as my,Al as mz,Oo as n,vme as n$,jPe as n0,K as n1,Nce as n2,FH as n3,yPe as n4,xO as n5,VPe as n6,lTe as n7,y7 as n8,$_t as n9,$st as nA,j2e as nB,H2e as nC,sgt as nD,Fct as nE,Ymt as nF,Ps as nG,hft as nH,fbt as nI,ak as nJ,WY as nK,yu as nL,lk as nM,rwt as nN,Rm as nO,OEt as nP,Ist as nQ,JXe as nR,cEe as nS,Kpt as nT,CCe as nU,EF as nV,nft as nW,vR as nX,che as nY,NPe as nZ,Uft as n_,L_t as na,R2e as nb,Opt as nc,MSt as nd,PSt as ne,Obe as nf,Nbe as ng,wJe as nh,SJe as ni,jve as nj,HKe as nk,Wne as nl,tbt as nm,fPe as nn,wPe as no,GM as np,Ift as nq,m1 as nr,QQe as ns,wK as nt,hxt as nu,nNe as nv,agt as nw,fH as nx,Vpt as ny,Upt as nz,Ybt as o,J0e as o$,$ve as o0,uft as o1,c2e as o2,bgt as o3,K4 as o4,Y0t as o5,j0t as o6,nve as o7,ive as o8,bKe as o9,klt as oA,Igt as oB,jlt as oC,ESt as oD,SSt as oE,lle as oF,dy as oG,IP as oH,Oht as oI,r6e as oJ,Zze as oK,Qze as oL,pC as oM,vf as oN,Ame as oO,S7 as oP,XS as oQ,lRe as oR,AJe as oS,kxt as oT,lpt as oU,hve as oV,Tve as oW,wM as oX,bm as oY,wY as oZ,dq as o_,SKe as oa,_St as ob,Vne as oc,RPe as od,ZQe as oe,md as of,kH as og,$H as oh,YL as oi,Qce as oj,Pxt as ok,Cxt as ol,Txt as om,Eit as on,rSt as oo,oSt as op,nSt as oq,Nve as or,Iit as os,cy as ot,Kit as ou,Jit as ov,est as ow,JM as ox,YDe as oy,IM as oz,jbt as p,JQe as p$,CA as p0,Mgt as p1,Vle as p2,sce as p3,Wpt as p4,Pce as p5,AK as p6,lce as p7,bst as p8,Pgt as p9,h6e as pA,set as pB,c6e as pC,HNe as pD,fWe as pE,jKe as pF,aX as pG,Sat as pH,Wgt as pI,cft as pJ,ghe as pK,Vbe as pL,Py as pM,mGe as pN,Bot as pO,qot as pP,pGe as pQ,Qot as pR,tht as pS,yht as pT,gb as pU,Qne as pV,xst as pW,Jxt as pX,Dit as pY,sre as pZ,ire as p_,V1 as pa,td as pb,RIe as pc,Zft as pd,X_ as pe,qYe as pf,Lft as pg,Oft as ph,tA as pi,iA as pj,sA as pk,Oct as pl,Uct as pm,t6e as pn,Jze as po,e6e as pp,XQe as pq,TA as pr,MKe as ps,qft as pt,Jpt as pu,Mue as pv,O_t as pw,R_t as px,wH as py,p6e as pz,eft as q,G0t as q$,J2 as q0,Il as q1,g6e as q2,M6e as q3,Gw as q4,DKe as q5,ewe as q6,S_t as q7,x6e as q8,Lct as q9,clt as qA,Bv as qB,X4 as qC,t7 as qD,Npt as qE,F0e as qF,Zmt as qG,bve as qH,yyt as qI,vyt as qJ,xyt as qK,Tm as qL,Sxt as qM,ure as qN,lxt as qO,Grt as qP,th as qQ,ek as qR,xve as qS,Sve as qT,PQe as qU,a1t as qV,FQe as qW,l1t as qX,Hze as qY,N0t as qZ,aY as q_,$ct as qa,jwt as qb,DWe as qc,lme as qd,Ywt as qe,Nj as qf,Rj as qg,Ize as qh,l_e as qi,Oj as qj,iL as qk,mw as ql,cE as qm,eX as qn,vat as qo,yat as qp,fk as qq,dbe as qr,$at as qs,ybe as qt,lF as qu,ube as qv,pP as qw,SM as qx,_Je as qy,hlt as qz,Xbt as r,ivt as r$,AKe as r0,YKe as r1,d3 as r2,NV as r3,R0t as r4,BL as r5,xet as r6,hu as r7,rA as r8,z1 as r9,RKe as rA,$ft as rB,Pf as rC,aQe as rD,SY as rE,IPe as rF,DGe as rG,kft as rH,Sft as rI,xM as rJ,kue as rK,_ne as rL,yKe as rM,vKe as rN,ZKe as rO,cve as rP,pre as rQ,b1e as rR,Gxt as rS,Bxt as rT,qxt as rU,Hxt as rV,Axt as rW,Dxt as rX,Ixt as rY,Qit as rZ,Lz as r_,Dvt as ra,dpt as rb,ngt as rc,syt as rd,Gy as re,Cgt as rf,Cut as rg,Fm as rh,p1 as ri,jxt as rj,m1e as rk,Dft as rl,uF as rm,aEt as rn,Xxt as ro,Yxt as rp,oxt as rq,axt as rr,Xoe as rs,WKe as rt,Q4 as ru,Uce as rv,Cft as rw,U0t as rx,GKe as ry,NKe as rz,Se as s,Uxt as s$,Tft as s0,fft as s1,pft as s2,YTe as s3,YXe as s4,H0e as s5,G2e as s6,z2e as s7,XXe as s8,Dst as s9,z9 as sA,YSt as sB,uEt as sC,$St as sD,WSt as sE,jSt as sF,Qut as sG,XSt as sH,tle as sI,Jae as sJ,ele as sK,tEt as sL,eEt as sM,sEt as sN,iEt as sO,Lxt as sP,Kut as sQ,$xt as sR,EY as sS,ect as sT,Oxt as sU,zSt as sV,Uit as sW,Rxt as sX,hre as sY,uxt as sZ,cxt as s_,b_t as sa,LO as sb,dbt as sc,No as sd,O4 as se,gEt as sf,rxt as sg,Zoe as sh,Kot as si,$wt as sj,vSt as sk,Ugt as sl,Ngt as sm,Lgt as sn,Rgt as so,Fgt as sp,Ogt as sq,$gt as sr,Ll as ss,pMe as st,xgt as su,hbt as sv,xSt as sw,JZ as sx,Dgt as sy,dEt as sz,Ibt as t,kKe as t$,Vxt as t0,Wxt as t1,Zxt as t2,xxt as t3,Kxt as t4,Qxt as t5,Sit as t6,Pit as t7,Mxt as t8,R1e as t9,qQe as tA,HSt as tB,rEt as tC,Jft as tD,mEt as tE,rgt as tF,JSt as tG,QSt as tH,Yae as tI,aae as tJ,Wae as tK,jae as tL,vae as tM,eae as tN,Joe as tO,Qoe as tP,oae as tQ,jF as tR,ZSt as tS,KSt as tT,ugt as tU,Xvt as tV,sve as tW,cme as tX,Oue as tY,v6e as tZ,xYe as t_,Ww as ta,zxt as tb,tft as tc,eJe as td,ePe as te,JTe as tf,Pft as tg,bEe as th,fae as ti,cae as tj,CPe as tk,hae as tl,Mae as tm,dae as tn,mgt as to,yae as tp,Fae as tq,kae as tr,$ae as ts,XPe as tt,Vft as tu,PPe as tv,zz as tw,Uae as tx,zft as ty,lyt as tz,SEt as u,ii as u$,EDe as u0,hvt as u1,dvt as u2,i7 as u3,oO as u4,GDe as u5,Ast as u6,PP as u7,AP as u8,aS as u9,cbt as uA,nxt as uB,_Me as uC,ume as uD,nJe as uE,mTe as uF,W_t as uG,Z_t as uH,I6e as uI,A6e as uJ,Tet as uK,fc as uL,Lfe as uM,xge as uN,mj as uO,nUe as uP,Dn as uQ,e_e as uR,ID as uS,od as uT,mu as uU,nc as uV,Vl as uW,Q$e as uX,pu as uY,n_e as uZ,Os as u_,TDe as ua,rpt as ub,ev as uc,ZDe as ud,KDe as ue,a7 as uf,Fse as ug,qrt as uh,jK as ui,K0t as uj,vit as uk,Ace as ul,lgt as um,Uwt as un,Yje as uo,cSt as up,uSt as uq,Une as ur,ubt as us,lbt as ut,abt as uu,Wit as uv,x1e as uw,wxt as ux,bxt as uy,jit as uz,rP as v,Jse as v$,DP as v0,Aa as v1,uOe as v2,a_e as v3,V$e as v4,es as v5,h3e as v6,i_e as v7,F0t as v8,lKe as v9,jmt as vA,oEe as vB,Hmt as vC,z_t as vD,sbt as vE,JJe as vF,H_t as vG,Yze as vH,k_t as vI,kSt as vJ,aw as vK,ryt as vL,BNe as vM,VKe as vN,Hft as vO,CKe as vP,GNe as vQ,Lpt as vR,Fde as vS,$ye as vT,OH as vU,T_t as vV,Y_t as vW,C_t as vX,ene as vY,E_t as vZ,ogt as v_,t1t as va,kat as vb,pb as vc,olt as vd,ayt as ve,tyt as vf,G_t as vg,j_t as vh,q_t as vi,opt as vj,myt as vk,dyt as vl,Qmt as vm,V_t as vn,igt as vo,Q_t as vp,EWe as vq,MJe as vr,kve as vs,apt as vt,cR as vu,Cse as vv,YF as vw,aSt as vx,vy,U9 as vz,ym as w,cY as w0,iue as w1,mpt as w2,X_t as w3,a6e as w4,s6e as w5,Qse as w6,f6e as w7,Oyt as w8,ZT as w9,A0t as wa,Dze as wb,I0t as wc,ovt as wd,lvt as we,_bt as wf,tSt as wg,ySt as wh,LEt as wi,Abt as x,Yi as y,bht as z};
