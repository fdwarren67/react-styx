import {
  _,
  i as i2
} from "./chunk-FHPPD5YQ.js";
import "./chunk-775A6HBK.js";
import "./chunk-FJBOCRBW.js";
import "./chunk-BG4U4RTY.js";
import {
  e as e2
} from "./chunk-ZKYO2ICX.js";
import {
  O,
  c as c2,
  e
} from "./chunk-FLGJHA67.js";
import {
  i2 as i,
  n2 as n
} from "./chunk-FJTIPVNU.js";
import "./chunk-SXKP4T6J.js";
import {
  s as s2
} from "./chunk-YUQ6PSJ2.js";
import "./chunk-B7E2AREE.js";
import "./chunk-MALSDV7D.js";
import {
  c as c3
} from "./chunk-S4QLDBOB.js";
import "./chunk-4JVIG75S.js";
import "./chunk-HZLSEOMW.js";
import "./chunk-L2AVI4MN.js";
import "./chunk-4JHPTLMD.js";
import "./chunk-35I4PBUK.js";
import "./chunk-BBPRJCMB.js";
import "./chunk-GNZ342SJ.js";
import "./chunk-EO3ETQWH.js";
import {
  s
} from "./chunk-PMTDIWAP.js";
import {
  l
} from "./chunk-ACBQ6NOA.js";
import "./chunk-QW7P5D76.js";
import "./chunk-GSNLF6RP.js";
import "./chunk-LILYILCM.js";
import "./chunk-WBBL3X3F.js";
import "./chunk-OJGPUKVG.js";
import "./chunk-GFEMKR2U.js";
import "./chunk-G2OXL5Y3.js";
import "./chunk-BLF64HON.js";
import "./chunk-I3JB2EVB.js";
import "./chunk-TCV7UF6X.js";
import "./chunk-BMNRD4FO.js";
import "./chunk-W7QCICS6.js";
import "./chunk-AYLNWVVJ.js";
import "./chunk-PQVKYMOX.js";
import "./chunk-DCSYHXZG.js";
import "./chunk-ZSBMFGDQ.js";
import "./chunk-NAGFHISJ.js";
import "./chunk-QCS4ZI2R.js";
import "./chunk-2SOWSOAE.js";
import "./chunk-KSQSVLSQ.js";
import "./chunk-SPVEONZ2.js";
import "./chunk-BMNDO4JW.js";
import "./chunk-RAVPBO4Z.js";
import "./chunk-PHADC6NW.js";
import "./chunk-3ODJ3YKN.js";
import "./chunk-P6IUM5K3.js";
import "./chunk-KGTLNUPW.js";
import "./chunk-GY7XU54K.js";
import "./chunk-P4D4HTH2.js";
import "./chunk-GDR4JYWU.js";
import "./chunk-Y4AQXF4J.js";
import "./chunk-D3P3E2RE.js";
import {
  d
} from "./chunk-UKY33OJN.js";
import "./chunk-HAWCNM3C.js";
import "./chunk-BQYXRSVC.js";
import "./chunk-BJEQ2APY.js";
import "./chunk-WKNMEFRQ.js";
import "./chunk-Q7TEBZSN.js";
import "./chunk-CIALVDRG.js";
import "./chunk-N5E3DEQN.js";
import "./chunk-GTN3PVPB.js";
import "./chunk-BF5PIC2K.js";
import "./chunk-K7TZXQ7O.js";
import "./chunk-FZPO5AYT.js";
import "./chunk-5VM3BO4P.js";
import "./chunk-EYUJRAXJ.js";
import "./chunk-552ZCNNH.js";
import "./chunk-XG7T2Y7N.js";
import "./chunk-SQOMDKJS.js";
import "./chunk-HB6TKF6E.js";
import "./chunk-OXPM753Y.js";
import "./chunk-N4U5VIP2.js";
import "./chunk-IVS2JCO6.js";
import "./chunk-4GOW35CM.js";
import "./chunk-TEJXT4W6.js";
import "./chunk-LW62SPEN.js";
import "./chunk-LSOJIRW6.js";
import "./chunk-FSFEOCO5.js";
import "./chunk-ZVIMKAJW.js";
import "./chunk-BIURGGHV.js";
import "./chunk-VSLEAHOZ.js";
import "./chunk-6K2FAOQG.js";
import "./chunk-N5DN7S3H.js";
import "./chunk-BECTSF5P.js";
import "./chunk-FX46DC27.js";
import "./chunk-2FUEBHWI.js";
import {
  m
} from "./chunk-VTWDBFQT.js";
import {
  a2 as a
} from "./chunk-BM4B3CH5.js";
import "./chunk-G2YC5GCV.js";
import "./chunk-GD5AHXAI.js";
import "./chunk-YWGYHRSH.js";
import "./chunk-DP2IAJQN.js";
import "./chunk-EAFC6V23.js";
import "./chunk-SMH2GUF6.js";
import "./chunk-AZP4AFW7.js";
import {
  r
} from "./chunk-SCZRL2WP.js";
import "./chunk-OSHCNHH7.js";
import "./chunk-7LCEUMDD.js";
import {
  c
} from "./chunk-6II7WQ2F.js";
import "./chunk-L7QO6TDW.js";
import "./chunk-EWTE5DHJ.js";

// node_modules/@arcgis/core/widgets/support/UtilityNetworkAssociations/UtilityNetworkAssociationList.js
var d2 = "esri-utility-network-association-list";
var p = { featureObserver: `${d2}__feature-observer`, filterContainer: `${d2}__filter-container`, limitNoticeContainer: `${d2}__limit-notice-container`, loadingContainer: `${d2}__loading-container` };
var m2 = class extends O {
  constructor(e3, o) {
    super(e3, o), this._isFeatureCountNoticeOpen = true, this._observer = new IntersectionObserver(([e4]) => {
      (e4 == null ? void 0 : e4.isIntersecting) && this._increaseFeaturePage();
    }, { root: window.document }), this._observerNode = null, this.featuresPerPage = 50, this.filterText = "", this.headingLevel = 5, this.maxFeatureCount = 1e3, this.messagesFeature = null, this.messagesCommon = null, this.selectedLayer = null, this.tooltipReferenceMap = new s2(), this.viewModel = new _();
  }
  initialize() {
    this.setUpObserver();
  }
  loadDependencies() {
    return c2({ icon: () => import("./calcite-icon-IDR3G5OX.js"), input: () => import("./calcite-input-GU5Y2KXZ.js"), loader: () => import("./calcite-loader-JLWU6EVT.js"), notice: () => import("./calcite-notice-ZJGBVXUG.js") });
  }
  destroy() {
    this.tooltipReferenceMap.clear();
  }
  get associatedFeatureCount() {
    const e3 = this.viewModel.associationViewModels, t = this.selectedLayer ? e3.get(this.selectedLayer) : null;
    return t ? t.length : 0;
  }
  set currentFeaturePage(e3) {
    const { featuresPerPage: t, associatedFeatureCount: o } = this, i3 = Math.ceil(o / t) || 1, r2 = Math.max(Math.min(e3, i3), 1);
    this._set("currentFeaturePage", r2);
  }
  get currentFeaturePage() {
    return this._get("currentFeaturePage") ?? 1;
  }
  get endIndex() {
    const { currentFeaturePage: e3, featuresPerPage: t, maxFeatureCount: o } = this;
    return Math.min(e3 * t, o);
  }
  renderConnectivityIcon(e3, t) {
    const { tooltipReferenceMap: o } = this;
    let i3;
    switch (e3) {
      case "junction-edge-from-connectivity":
        i3 = "connection-end-left";
        break;
      case "junction-edge-to-connectivity":
        i3 = "connection-end-right";
        break;
      case "junction-edge-midspan-connectivity":
        i3 = "connection-middle";
        break;
      default:
        i3 = "connection-to-connection";
    }
    return n("calcite-icon", { afterCreate: (e4) => o.set(t, e4), afterRemoved: () => o.delete(t), icon: i3, scale: "s", slot: "content-start" });
  }
  renderFeatureCountWarning() {
    const { associatedFeatureCount: e3, maxFeatureCount: t, messagesFeature: o } = this;
    return e3 > t ? n("calcite-notice", { class: this._isFeatureCountNoticeOpen ? p.limitNoticeContainer : void 0, closable: true, icon: "information", kind: "info", open: true, scale: "s", width: "full", onCalciteNoticeBeforeOpen: () => this._isFeatureCountNoticeOpen = true, onCalciteNoticeClose: () => this._isFeatureCountNoticeOpen = false }, n("div", { slot: "title" }, o.associationsLimitNoticeTitle), n("div", { slot: "message" }, s(o.associationsLimitNoticeMessage, { number: t }))) : null;
  }
  renderFeatureObserver() {
    return n("div", { afterCreate: this._onObserverCreate, bind: this, class: p.featureObserver, key: "feature-observer" });
  }
  renderFilter() {
    return n("div", { class: p.filterContainer, key: "filter" }, n("calcite-input", { icon: "search", placeholder: this.messagesFeature.associationFilterPlaceholder, type: "search", onCalciteInputInput: (e3) => {
      this.filterText = e3.currentTarget.value.trim().toLowerCase(), this.currentFeaturePage = 1;
    } }));
  }
  renderLoading() {
    return n("div", { class: p.loadingContainer, key: "loading-container" }, this.renderLoadingIcon());
  }
  renderLoadingIcon() {
    return n("calcite-loader", { inline: true, label: this.messagesCommon.loading });
  }
  getConnectivityTooltip(e3) {
    const { messagesFeature: t } = this;
    switch (e3) {
      case "connectivity":
      case "junction-junction-connectivity":
        return t.associationsJunctionJunction;
      case "junction-edge-from-connectivity":
        return t.associationsJunctionEdgeFrom;
      case "junction-edge-midspan-connectivity":
        return t.associationsJunctionEdgeMidspan;
      case "junction-edge-to-connectivity":
        return t.associationsJunctionEdgeTo;
      default:
        return "";
    }
  }
  setUpObserver() {
    this.addHandles(d(() => this._observerNode, () => this._onObserverChange()));
  }
  _increaseFeaturePage() {
    this.currentFeaturePage++;
  }
  async _onObserverChange() {
    this._observerNode && this._observer.unobserve(this._observerNode);
    const { state: e3, showAllEnabled: t } = this.viewModel;
    this._observerNode && "ready" === e3 && t && this._observer.observe(this._observerNode);
  }
  _onObserverCreate(e3) {
    this._observerNode = e3;
  }
};
r([m()], m2.prototype, "_observer", void 0), r([m()], m2.prototype, "_observerNode", void 0), r([m()], m2.prototype, "associatedFeatureCount", null), r([m()], m2.prototype, "currentFeaturePage", null), r([m()], m2.prototype, "endIndex", null), r([m()], m2.prototype, "featuresPerPage", void 0), r([m()], m2.prototype, "filterText", void 0), r([m()], m2.prototype, "headingLevel", void 0), r([m()], m2.prototype, "maxFeatureCount", void 0), r([m(), e("esri/widgets/Feature/t9n/Feature")], m2.prototype, "messagesFeature", void 0), r([m(), e("esri/t9n/common")], m2.prototype, "messagesCommon", void 0), r([m()], m2.prototype, "selectedLayer", void 0), r([m()], m2.prototype, "tooltipReferenceMap", void 0), r([m({ type: _ })], m2.prototype, "viewModel", void 0), m2 = r([a("esri.widgets.support.UtilityNetworkAssociations.UtilityNetworkAssociationList")], m2);
var h = m2;

// node_modules/@arcgis/core/widgets/support/UtilityNetworkAssociations/utils/formatPercentAlong.js
function n2(n5) {
  const { percentAlong: r2 } = n5;
  return null == r2 ? "" : l(r2, { style: "percent", maximumFractionDigits: 2 });
}

// node_modules/@arcgis/core/widgets/support/UtilityNetworkAssociations/utils/isConnectivity.js
function n3(n5) {
  const { associationType: t } = n5;
  return "connectivity" === t || "junction-junction-connectivity" === t || "junction-edge-from-connectivity" === t || "junction-edge-midspan-connectivity" === t || "junction-edge-to-connectivity" === t;
}

// node_modules/@arcgis/core/widgets/support/UtilityNetworkAssociations/utils/isConnectivityMidspan.js
function n4(n5) {
  return "junction-edge-midspan-connectivity" === n5.associationType;
}

// node_modules/@arcgis/core/widgets/Feature/FeatureUtilityNetworkAssociationList.js
var f;
var y = "esri-feature-utility-network-associations";
var b = { base: y, listItemHidden: `${y}__list-item--hidden` };
var v = "nested";
var g = f = class extends h {
  constructor(e3, t) {
    super(e3, t), this.description = null, this.flowItems = null, this.flowType = "feature-utility-network-association-type", this.listType = null, this.parentFeatureViewModel = null, this.title = null, this.viewModel = new _(), this.visibleElements = new i2();
  }
  initialize() {
    this.setUpObserver();
  }
  loadDependencies() {
    return c2({ chip: () => import("./calcite-chip-WK7WESLT.js"), icon: () => import("./calcite-icon-IDR3G5OX.js"), list: () => import("./calcite-list-ZW5MU5XE.js"), "list-item": () => import("./calcite-list-item-G27TAKVG.js"), tooltip: () => import("./calcite-tooltip-53LFBXH5.js") });
  }
  destroy() {
    this.tooltipReferenceMap.clear();
  }
  render() {
    var _a;
    const e3 = this.viewModel.associationViewModels, { state: t, showAllEnabled: i3 } = this.viewModel, { state: s3 } = this.parentFeatureViewModel ?? {};
    return n("div", { class: this.classes(b.base, e2.widget) }, "loading" === t || "querying" === t || "loading" === s3 ? this.renderLoading() : n("calcite-list", { displayMode: v, label: ((_a = this.selectedLayer) == null ? void 0 : _a.title) ?? this.messagesCommon.untitled }, i3 && this.selectedLayer ? n(i, null, this.renderFilter(), this.renderFeatureCountWarning(), this._renderAssociatedFeatureListPage(), this.renderFeatureObserver()) : Array.from(e3.keys(), (t2) => this._renderTypeList(t2, e3.get(t2)))));
  }
  _showAllAssociations(e3) {
    const { flowItems: t, viewModel: i3, description: s3 } = this;
    if (!t || !e3) return;
    i3.showAllEnabled = true;
    const o = new f({ selectedLayer: e3, title: e3 == null ? void 0 : e3.title, flowItems: t, parentFeatureViewModel: this.parentFeatureViewModel, featureVisibleElements: this.featureVisibleElements, description: s3, visibleElements: new i2({ title: false, description: false }), viewModel: i3 });
    t.push(o);
  }
  _renderAssociatedFeatureListPage() {
    const e3 = this.viewModel.associationViewModels.get(this.selectedLayer).filter((e4) => c3(e4.featureViewModel).toLowerCase().includes(this.filterText)).slice(0, this.endIndex);
    return [...this._renderTooltips(e3), ...this._renderAssociatedFeatureList(e3)];
  }
  _renderItemTooltip(e3) {
    const { tooltipReferenceMap: t } = this;
    return n3(e3.association) ? n("calcite-tooltip", { key: `tooltip-${e3.featureViewModel.uid}`, overlayPositioning: "fixed", referenceElement: t.get(e3.featureViewModel.uid) }, this.getConnectivityTooltip(e3.association.associationType)) : null;
  }
  _renderAssociatedFeature(e3) {
    const { featureViewModel: i3 } = e3, s3 = c3(i3), l2 = "loading" === i3.state, r2 = this._findFlowItem(i3), n5 = r2 < 0 && this._isParentFeature(i3), c4 = n5 || r2 >= 0;
    return n("calcite-list-item", { class: l2 ? b.listItemHidden : void 0, description: c(e3.terminalName ?? ""), key: `associated-feature-type-${i3.uid}`, label: c(s3), onCalciteListItemSelect: () => this._handleFeatureClick(n5, r2, i3) }, n3(e3.association) ? this.renderConnectivityIcon(e3.association.associationType, e3.featureViewModel.uid) : null, n4(e3.association) ? n("calcite-chip", { label: n2(e3.association), scale: "s", slot: "content-end" }, n2(e3.association)) : null, this._renderChevronIconNode(c4));
  }
  async _selectAssociation(e3) {
    const { flowItems: t, featureVisibleElements: i3 } = this;
    if (!t) return;
    e3.abilities = { utilityNetworkAssociationsContent: true };
    const { default: s3 } = await import("./Feature-Z57LO3EX.js");
    t.push(new s3({ flowItems: t, flowType: "feature-association", viewModel: e3, visibleElements: i3 }));
  }
  _handleFeatureClick(e3, t, i3) {
    if (e3) this.flowItems.drain((e4) => {
      "showAllEnabled" in e4.viewModel && (e4.viewModel.showAllEnabled = false), e4.viewModel = null, e4.destroy();
    });
    else if (t < 0 || !this.flowItems) this._selectAssociation(i3);
    else for (; this.flowItems.length > t + 1; ) {
      const e4 = this.flowItems.pop();
      e4 && ("showAllEnabled" in e4.viewModel && (e4.viewModel.showAllEnabled = false), e4.viewModel = null, e4.destroy());
    }
  }
  _featureViewModelMatch(e3, t) {
    const i3 = e3.graphic, s3 = i3 == null ? void 0 : i3.layer;
    let o = null;
    "subtype-sublayer" === (s3 == null ? void 0 : s3.type) && s3.parent ? o = s3.parent.globalIdField ?? null : s3 && "globalIdField" in s3 && (o = s3.globalIdField);
    const l2 = o ? i3 == null ? void 0 : i3.attributes[o] : null, r2 = t.graphic, n5 = r2 == null ? void 0 : r2.layer;
    let a2 = null;
    "subtype-sublayer" === (n5 == null ? void 0 : n5.type) && n5.parent ? a2 = n5.parent.globalIdField ?? null : n5 && "globalIdField" in n5 && (a2 = n5.globalIdField);
    const c4 = a2 ? r2 == null ? void 0 : r2.attributes[a2] : null;
    return l2 && c4 && l2 === c4;
  }
  _isParentFeature(e3) {
    var _a;
    const t = (_a = this.flowItems) == null ? void 0 : _a.getItemAt(0);
    if (!t) return false;
    const i3 = t.parentFeatureViewModel;
    return this._featureViewModelMatch(i3, e3);
  }
  _findFlowItem(e3) {
    var _a;
    return ((_a = this.flowItems) == null ? void 0 : _a.findIndex((t) => {
      if ("feature-association" !== t.flowType) return false;
      const i3 = t.viewModel;
      return this._featureViewModelMatch(i3, e3);
    })) ?? -1;
  }
  _renderTooltips(e3) {
    return e3.toArray().map((e4) => this._renderItemTooltip(e4));
  }
  _renderAssociatedFeatureList(e3) {
    return e3.toArray().map((e4) => this._renderAssociatedFeature(e4));
  }
  _renderChevronIconNode(e3) {
    return n("calcite-icon", { flipRtl: true, icon: e3 ? "move-up" : "chevron-right", scale: "s", slot: "content-end" });
  }
  _renderTypeList(e3, t) {
    const { messagesFeature: i3 } = this, { displayCount: s3 } = this.viewModel, o = t.slice(0, s3), l2 = o.length < t.length;
    return n("calcite-list-item", { key: "show-all", label: e3.title, open: true, value: e3.id }, n("calcite-chip", { label: String(t.length), scale: "s", slot: "content-end" }, t.length), n("calcite-list", { group: e3.id, label: e3.title ?? "" }, [this._renderTooltips(o), this._renderAssociatedFeatureList(o)], l2 ? n("calcite-list-item", { description: s(i3 == null ? void 0 : i3.numberRecords, { number: t.length.toString() }), key: "show-all-item", label: i3.showAll, onCalciteListItemSelect: () => this._showAllAssociations(e3) }, n("calcite-icon", { icon: "list", scale: "s", slot: "content-end" })) : null));
  }
};
r([m()], g.prototype, "description", void 0), r([m()], g.prototype, "featureVisibleElements", void 0), r([m()], g.prototype, "flowItems", void 0), r([m()], g.prototype, "flowType", void 0), r([m()], g.prototype, "listType", void 0), r([m()], g.prototype, "parentFeatureViewModel", void 0), r([m()], g.prototype, "title", void 0), r([m({ type: _ })], g.prototype, "viewModel", void 0), r([m({ type: i2, nonNullable: true })], g.prototype, "visibleElements", void 0), g = f = r([a("esri.widgets.Feature.FeatureUtilityNetworkAssociationList")], g);
var M = g;
export {
  M as default
};
//# sourceMappingURL=FeatureUtilityNetworkAssociationList-KXPSZ4LG.js.map
