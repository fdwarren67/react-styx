import {
  b as b2,
  c as c2
} from "./chunk-U5P7BTEH.js";
import {
  c
} from "./chunk-JLSSMIEO.js";
import "./chunk-R6B3KWCZ.js";
import "./chunk-3Y2XWHXG.js";
import "./chunk-QQGGEN5E.js";
import "./chunk-QEAQVAMR.js";
import "./chunk-I7JIAECC.js";
import "./chunk-ZXD5CGBL.js";
import "./chunk-F64YCQYI.js";
import "./chunk-3L7KPDW7.js";
import "./chunk-HHSHKUKB.js";
import "./chunk-OBRCQKKM.js";
import {
  a as a4
} from "./chunk-XOXXDYBM.js";
import "./chunk-T7CHWWE2.js";
import "./chunk-FWVSIQMR.js";
import "./chunk-ON7GWFUW.js";
import {
  b
} from "./chunk-C6YDI6QX.js";
import "./chunk-DJ5HVIE7.js";
import {
  S as S2
} from "./chunk-KPY4ZIC2.js";
import "./chunk-V3IZNRFE.js";
import "./chunk-D7XVYH42.js";
import {
  Y
} from "./chunk-ZQMORW2K.js";
import "./chunk-OGPRAWXS.js";
import "./chunk-EGSJQZXU.js";
import "./chunk-RPPIM555.js";
import "./chunk-4FQDWSFN.js";
import "./chunk-JOQ2ZFQV.js";
import {
  f
} from "./chunk-3UBDE4PK.js";
import "./chunk-LILYILCM.js";
import "./chunk-OJGPUKVG.js";
import "./chunk-GFEMKR2U.js";
import "./chunk-G2OXL5Y3.js";
import "./chunk-B6ORYDBK.js";
import "./chunk-AYLNWVVJ.js";
import "./chunk-PQVKYMOX.js";
import "./chunk-DCSYHXZG.js";
import "./chunk-KSQSVLSQ.js";
import {
  a as a3
} from "./chunk-SPVEONZ2.js";
import "./chunk-BMNDO4JW.js";
import "./chunk-RAVPBO4Z.js";
import "./chunk-PHADC6NW.js";
import "./chunk-3ODJ3YKN.js";
import "./chunk-P6IUM5K3.js";
import {
  n,
  t
} from "./chunk-GY7XU54K.js";
import "./chunk-P4D4HTH2.js";
import "./chunk-Y4AQXF4J.js";
import "./chunk-D3P3E2RE.js";
import {
  A,
  d
} from "./chunk-UKY33OJN.js";
import "./chunk-HAWCNM3C.js";
import {
  V
} from "./chunk-BQYXRSVC.js";
import "./chunk-BJEQ2APY.js";
import "./chunk-WKNMEFRQ.js";
import "./chunk-Q7TEBZSN.js";
import "./chunk-CIALVDRG.js";
import "./chunk-N5E3DEQN.js";
import "./chunk-BDOGPNOY.js";
import "./chunk-552ZCNNH.js";
import "./chunk-XG7T2Y7N.js";
import "./chunk-SQOMDKJS.js";
import "./chunk-HB6TKF6E.js";
import "./chunk-OXPM753Y.js";
import {
  w
} from "./chunk-N4U5VIP2.js";
import {
  j2 as j
} from "./chunk-IVS2JCO6.js";
import "./chunk-4GOW35CM.js";
import "./chunk-TEJXT4W6.js";
import "./chunk-LW62SPEN.js";
import {
  s as s2
} from "./chunk-LSOJIRW6.js";
import "./chunk-FSFEOCO5.js";
import {
  r as r3
} from "./chunk-ZVIMKAJW.js";
import "./chunk-BIURGGHV.js";
import {
  r,
  s
} from "./chunk-VSLEAHOZ.js";
import "./chunk-6K2FAOQG.js";
import "./chunk-N5DN7S3H.js";
import "./chunk-BECTSF5P.js";
import "./chunk-FX46DC27.js";
import {
  S
} from "./chunk-2FUEBHWI.js";
import {
  m
} from "./chunk-VTWDBFQT.js";
import {
  a2
} from "./chunk-BM4B3CH5.js";
import "./chunk-G2YC5GCV.js";
import "./chunk-GD5AHXAI.js";
import "./chunk-YWGYHRSH.js";
import "./chunk-DP2IAJQN.js";
import "./chunk-EAFC6V23.js";
import {
  o
} from "./chunk-SMH2GUF6.js";
import "./chunk-AZP4AFW7.js";
import {
  r as r2
} from "./chunk-SCZRL2WP.js";
import "./chunk-OSHCNHH7.js";
import {
  a
} from "./chunk-7LCEUMDD.js";
import "./chunk-6II7WQ2F.js";
import "./chunk-L7QO6TDW.js";
import "./chunk-EWTE5DHJ.js";

// node_modules/@arcgis/core/analysis/Viewshed.js
var u = class extends S.JSONSupportMixin(a3) {
  constructor(e) {
    super(e), this.observer = null, this.farDistance = 1e3, this.heading = 0, this.tilt = 90, this.horizontalFieldOfView = 45, this.verticalFieldOfView = 45, this.feature = null;
  }
  isValid() {
    return null != this.observer && this.farDistance > 0;
  }
  equals(e) {
    return o(this.observer, e.observer) && this.farDistance === e.farDistance && this.heading === e.heading && this.tilt === e.tilt && this.horizontalFieldOfView === e.horizontalFieldOfView && this.verticalFieldOfView === e.verticalFieldOfView && c2(this.feature, e.feature);
  }
};
r2([m({ type: j, json: { write: { isRequired: true } } })], u.prototype, "observer", void 0), r2([m({ type: Number, nonNullable: true, range: { min: 0 }, json: { write: { isRequired: true } } })], u.prototype, "farDistance", void 0), r2([m({ type: Number, nonNullable: true, json: { write: { isRequired: true } } }), s2((e) => a4.normalize(a(e), void 0, true))], u.prototype, "heading", void 0), r2([m({ type: Number, nonNullable: true, range: { min: 0, max: 180 }, json: { write: { isRequired: true } } })], u.prototype, "tilt", void 0), r2([m({ type: Number, nonNullable: true, range: { min: 0, max: 360 }, json: { write: { isRequired: true } } })], u.prototype, "horizontalFieldOfView", void 0), r2([m({ type: Number, nonNullable: true, range: { min: 0, max: 180 }, json: { write: { isRequired: true } } })], u.prototype, "verticalFieldOfView", void 0), r2([m(b2)], u.prototype, "feature", void 0), r2([m({ json: { read: false } })], u.prototype, "isValid", null), u = r2([a2("esri.analysis.Viewshed")], u);
var d2 = u;

// node_modules/@arcgis/core/analysis/ViewshedAnalysis.js
var f2 = V.ofType(d2);
var x = class extends c {
  constructor(e) {
    super(e), this.type = "viewshed", this._extent = null;
  }
  initialize() {
    this.addHandles(d(() => this._computeExtent(), (e) => {
      null == e.pending && (this._extent = e.extent);
    }, A));
  }
  get viewsheds() {
    return this._get("viewsheds") || new f2();
  }
  set viewsheds(e) {
    this._set("viewsheds", n(e, this.viewsheds, f2));
  }
  get spatialReference() {
    for (const e of this.viewsheds) if (null != e.observer) return e.observer.spatialReference;
    return null;
  }
  get extent() {
    return this._extent;
  }
  get requiredPropertiesForEditing() {
    return this.viewsheds.items.map(({ observer: e }) => e);
  }
  async waitComputeExtent() {
    const e = this._computeExtent();
    null != e.pending && await e.pending;
  }
  _computeExtent() {
    const { spatialReference: e } = this;
    if (null == e) return { pending: null, extent: null };
    const t2 = this.viewsheds.filter((e2) => null != e2.observer), r4 = t2.map((e2) => e2.observer).toArray(), n2 = Y(r4, e);
    if (null != n2.pending) return { pending: n2.pending, extent: null };
    return { pending: null, extent: n2.geometries.map((e2, r5) => {
      const n3 = t2.at(r5);
      return null != e2 && null != n3 ? this._computeViewshedExtent(this.viewsheds.at(r5), e2) : null;
    }).filter((e2) => null != e2).reduce((e2, t3) => y(e2, t3), null) };
  }
  _computeViewshedExtent(e, t2) {
    const { farDistance: r4, heading: n2, tilt: s3, horizontalFieldOfView: i, verticalFieldOfView: p } = e, { spatialReference: c3 } = t2, u3 = i / 2, m2 = p / 2, h = r4 / c3.metersPerUnit, f3 = [a4.normalize(n2 - u3), n2, a4.normalize(n2 + u3)], x2 = w.fromPoint(t2), y3 = (e2) => {
      const t3 = f3.map((t4) => a4.normalize(t4 - e2));
      if (t3[0] > t3[2] || 360 === i) return h;
      const r5 = t3.map((e3) => Math.abs(e3 > 180 ? 360 - e3 : e3)).reduce((e3, t4) => e3 > t4 ? t4 : e3);
      return r5 > 90 ? 0 : h * Math.cos(s(r5));
    };
    x2.xmax += y3(90), x2.xmin -= y3(-90), x2.ymax += y3(0), x2.ymin -= y3(180);
    const w3 = t2.z;
    if (null != w3) {
      let e2 = w3, t3 = w3;
      const n3 = s3 - 90, i2 = r(n3 + m2, -90, 90), o2 = r(n3 - m2, -90, 90), l = (c3 == null ? void 0 : c3.isGeographic) ? r4 : h;
      e2 += l * g(i2), t3 += l * g(o2);
      const p2 = v(m2) * l, d3 = g(n3) * p2 * (1 - v(u3));
      s3 < 90 && (e2 -= d3), s3 > 90 && (t3 -= d3), x2.zmax = Math.max(e2, w3), x2.zmin = Math.min(t3, w3);
    }
    return x2;
  }
  clear() {
    this.viewsheds.removeAll();
  }
};
function y(e, t2) {
  return null == e ? t2 : null == t2 ? e : e.union(t2);
}
function v(e) {
  return Math.cos(s(e));
}
function g(e) {
  return Math.sin(s(e));
}
r2([m({ type: ["viewshed"] })], x.prototype, "type", void 0), r2([m({ cast: t, type: f2, nonNullable: true })], x.prototype, "viewsheds", null), r2([m({ readOnly: true })], x.prototype, "spatialReference", null), r2([m()], x.prototype, "_extent", void 0), r2([m({ readOnly: true })], x.prototype, "extent", null), r2([m({ readOnly: true })], x.prototype, "requiredPropertiesForEditing", null), x = r2([a2("esri.analysis.ViewshedAnalysis")], x);
var w2 = x;

// node_modules/@arcgis/core/layers/ViewshedLayer.js
var y2 = class extends b(S2(f)) {
  constructor(e) {
    super(e), this.type = "viewshed", this.operationalLayerType = "ViewshedLayer", this.source = new w2(), this.opacity = 1;
  }
  initialize() {
    this.addHandles(d(() => this.source, (e, r4) => {
      null != r4 && r4.parent === this && (r4.parent = null), null != e && (e.parent = this);
    }, A));
  }
  async load() {
    return this.addResolvingPromise(this.source.waitComputeExtent()), this;
  }
  get spatialReference() {
    return this.source.spatialReference;
  }
  get fullExtent() {
    return this.source.extent;
  }
  releaseAnalysis(e) {
    this.source === e && (this.source = new w2());
  }
  get analysis() {
    return this.source;
  }
  set analysis(e) {
    this.source = e;
  }
  get viewsheds() {
    return this.source.viewsheds;
  }
  set viewsheds(e) {
    this.source.viewsheds = e;
  }
  writeViewsheds(e, r4, s3, t2) {
    r4.viewsheds = e.filter((e2) => e2.isValid()).map((e2) => e2.toJSON(t2)).toJSON();
  }
};
r2([m({ json: { read: false }, readOnly: true })], y2.prototype, "type", void 0), r2([m({ type: ["ViewshedLayer"] })], y2.prototype, "operationalLayerType", void 0), r2([m({ type: w2, nonNullable: true })], y2.prototype, "source", void 0), r2([m({ readOnly: true })], y2.prototype, "spatialReference", null), r2([m({ readOnly: true })], y2.prototype, "fullExtent", null), r2([m({ readOnly: true, json: { read: false, write: false, origins: { service: { read: false, write: false }, "portal-item": { read: false, write: false }, "web-document": { read: false, write: false } } } })], y2.prototype, "opacity", void 0), r2([m({ type: ["show", "hide"] })], y2.prototype, "listMode", void 0), r2([m({ type: V.ofType(d2), json: { write: { ignoreOrigin: true }, origins: { "web-scene": { write: { ignoreOrigin: true } } } } })], y2.prototype, "viewsheds", null), r2([r3("web-scene", "viewsheds")], y2.prototype, "writeViewsheds", null), y2 = r2([a2("esri.layers.ViewshedLayer")], y2);
var u2 = y2;
export {
  u2 as default
};
//# sourceMappingURL=ViewshedLayer-PVESSY3J.js.map
