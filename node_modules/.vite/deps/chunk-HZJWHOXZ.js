import {
  T
} from "./chunk-TOKEYLZA.js";
import {
  _,
  i as i4
} from "./chunk-FHPPD5YQ.js";
import {
  r as r6
} from "./chunk-A4FY6ZIM.js";
import {
  x
} from "./chunk-6ZDD4C2B.js";
import {
  h as h2
} from "./chunk-GHPQVNNU.js";
import {
  s as s5
} from "./chunk-N7FB6BVA.js";
import {
  a as a3
} from "./chunk-6WGXL2U7.js";
import {
  C,
  D,
  E,
  J,
  K,
  L,
  M,
  O as O2,
  Q,
  R,
  Te,
  ae,
  de,
  ee,
  fe,
  he,
  ie,
  le,
  oe,
  pe,
  q,
  re,
  se,
  we,
  x as x2
} from "./chunk-FJBOCRBW.js";
import {
  o
} from "./chunk-NGATSB6R.js";
import {
  e as e4
} from "./chunk-ZKYO2ICX.js";
import {
  r as r5
} from "./chunk-4LJ2OSKC.js";
import {
  O,
  c as c3,
  e as e3
} from "./chunk-FLGJHA67.js";
import {
  n2
} from "./chunk-FJTIPVNU.js";
import {
  g as g2,
  v as v2,
  w as w2,
  y as y2
} from "./chunk-SXKP4T6J.js";
import {
  Ye
} from "./chunk-HPA5LQSZ.js";
import {
  l as l2
} from "./chunk-QAXPIBME.js";
import {
  c as c6
} from "./chunk-S4QLDBOB.js";
import {
  c as c4
} from "./chunk-XZDT5RTS.js";
import {
  d as d4
} from "./chunk-7DHQ2VMC.js";
import {
  b as b2
} from "./chunk-4JVIG75S.js";
import {
  m as m2
} from "./chunk-HZLSEOMW.js";
import {
  s as s3
} from "./chunk-PMTDIWAP.js";
import {
  l
} from "./chunk-ACBQ6NOA.js";
import {
  b as b3
} from "./chunk-BLF64HON.js";
import {
  I,
  c2 as c5,
  d as d5,
  i2,
  i3,
  n as n5,
  n3 as n6,
  p as p2
} from "./chunk-I3JB2EVB.js";
import {
  n as n4
} from "./chunk-AYLNWVVJ.js";
import {
  j
} from "./chunk-PQVKYMOX.js";
import {
  e as e2
} from "./chunk-DCSYHXZG.js";
import {
  a as a2
} from "./chunk-SPVEONZ2.js";
import {
  ge
} from "./chunk-BMNDO4JW.js";
import {
  P,
  d as d3,
  p,
  v,
  w
} from "./chunk-UKY33OJN.js";
import {
  d as d2
} from "./chunk-HAWCNM3C.js";
import {
  V
} from "./chunk-BQYXRSVC.js";
import {
  j2
} from "./chunk-IVS2JCO6.js";
import {
  g as g3
} from "./chunk-4GOW35CM.js";
import {
  s as s4
} from "./chunk-LSOJIRW6.js";
import {
  r
} from "./chunk-VSLEAHOZ.js";
import {
  n as n3
} from "./chunk-N5DN7S3H.js";
import {
  P2
} from "./chunk-BECTSF5P.js";
import {
  g,
  m
} from "./chunk-VTWDBFQT.js";
import {
  a2 as a
} from "./chunk-BM4B3CH5.js";
import {
  A,
  b,
  d,
  e,
  h,
  k,
  s as s2,
  u,
  y
} from "./chunk-SMH2GUF6.js";
import {
  r as r4
} from "./chunk-SCZRL2WP.js";
import {
  s
} from "./chunk-OSHCNHH7.js";
import {
  r as r3
} from "./chunk-7LCEUMDD.js";
import {
  c as c2,
  i2 as i,
  n2 as n,
  r as r2
} from "./chunk-6II7WQ2F.js";
import {
  G,
  c
} from "./chunk-L7QO6TDW.js";

// node_modules/@arcgis/core/widgets/Attachments/AttachmentsViewModel.js
var u2 = { editing: false, operations: { add: true, update: true, delete: true } };
var f = V.ofType(a3);
var y3 = class extends g {
  constructor(t5) {
    super(t5), this._getAttachmentsPromise = null, this._attachmentLayer = null, this.capabilities = { ...u2 }, this.activeAttachmentInfo = null, this.activeFileInfo = null, this.attachmentInfos = new f(), this.fileInfos = new V(), this.graphic = null, this.mode = "view", this.orderByFields = null, this.filesEnabled = false, this.addHandles(d3(() => this.graphic, () => this._graphicChanged(), P));
  }
  destroy() {
    this._attachmentLayer = null, this.graphic = null;
  }
  castCapabilities(t5) {
    return { ...u2, ...t5 };
  }
  get state() {
    return this._getAttachmentsPromise ? "loading" : this.graphic ? "ready" : "disabled";
  }
  get supportsResizeAttachments() {
    const { graphic: t5 } = this;
    if (!t5) return false;
    const e14 = t5.layer || t5.sourceLayer;
    return (e14 == null ? void 0 : e14.loaded) && "capabilities" in e14 && e14.capabilities && "attachment" in e14.capabilities && e14.capabilities.attachment && "supportsResize" in e14.capabilities.attachment && e14.capabilities.attachment.supportsResize || false;
  }
  async getAttachments() {
    const { _attachmentLayer: t5, attachmentInfos: e14, orderByFields: i9 } = this;
    if (!t5 || "function" != typeof t5.queryAttachments) throw new s("invalid-layer", "getAttachments(): A valid layer is required.");
    const a7 = this._getObjectId();
    if ("number" != typeof a7) throw new s("invalid-object-id", "getAttachments(): Numeric object id is required");
    const r10 = i9 == null ? void 0 : i9.map((t6) => `${t6.field} ${"descending" === t6.order ? "DESC" : "ASC"}`), s11 = new c4({ objectIds: [a7], returnMetadata: true, orderByFields: r10 }), o3 = [], c17 = t5.queryAttachments(s11).then((t6) => t6[a7] || o3).catch(() => o3);
    this._getAttachmentsPromise = c17, this.notifyChange("state");
    const h10 = await c17;
    return e14.destroyAll(), h10.length && e14.addMany(h10), this._getAttachmentsPromise = null, this.notifyChange("state"), h10;
  }
  async addAttachment(t5, e14 = this.graphic) {
    var _a;
    const { _attachmentLayer: i9, attachmentInfos: a7, capabilities: r10 } = this;
    if (!e14) throw new s("invalid-graphic", "addAttachment(): A valid graphic is required.", { graphic: e14 });
    if (!t5) throw new s("invalid-attachment", "addAttachment(): An attachment is required.", { attachment: t5 });
    if (!((_a = r10.operations) == null ? void 0 : _a.add)) throw new s("invalid-capabilities", "addAttachment(): add capabilities are required.");
    if (!i9 || "function" != typeof i9.addAttachment) throw new s("invalid-layer", "addAttachment(): A valid layer is required.");
    const s11 = i9.addAttachment(e14, t5).then((t6) => this._queryAttachment(t6.objectId, e14)), o3 = await s11;
    return a7.add(o3), o3;
  }
  async deleteAttachment(t5) {
    var _a;
    const { _attachmentLayer: e14, attachmentInfos: i9, graphic: a7, capabilities: r10 } = this;
    if (!t5) throw new s("invalid-attachment-info", "deleteAttachment(): An attachmentInfo is required.", { attachmentInfo: t5 });
    if (!((_a = r10.operations) == null ? void 0 : _a.delete)) throw new s("invalid-capabilities", "deleteAttachment(): delete capabilities are required.");
    if (!e14 || "function" != typeof e14.deleteAttachments) throw new s("invalid-layer", "deleteAttachment(): A valid layer is required.");
    if (!a7) throw new s("invalid-graphic", "deleteAttachment(): A graphic is required.");
    const s11 = e14.deleteAttachments(a7, [t5.id]).then(() => t5), o3 = await s11;
    return i9.remove(o3), o3.destroy(), o3;
  }
  async updateAttachment(t5, e14 = this.activeAttachmentInfo) {
    var _a;
    const { _attachmentLayer: i9, attachmentInfos: a7, graphic: r10, capabilities: s11 } = this;
    if (!t5) throw new s("invalid-attachment", "updateAttachment(): An attachment is required.", { attachment: t5 });
    if (!e14) throw new s("invalid-attachment-info", "updateAttachment(): An attachmentInfo is required.", { attachmentInfo: e14 });
    if (!((_a = s11.operations) == null ? void 0 : _a.update)) throw new s("invalid-capabilities", "updateAttachment(): Update capabilities are required.");
    const o3 = a7.indexOf(e14);
    if (!i9 || "function" != typeof i9.updateAttachment) throw new s("invalid-layer", "updateAttachment(): A valid layer is required.");
    if (!r10) throw new s("invalid-graphic", "updateAttachment(): A graphic is required.");
    const c17 = i9.updateAttachment(r10, e14.id, t5).then((t6) => this._queryAttachment(t6.objectId)), h10 = await c17;
    return a7.splice(o3, 1, h10), h10;
  }
  async commitFiles() {
    return await Promise.all(this.fileInfos.items.map((t5) => this.addAttachment(t5.form))), this.fileInfos.removeAll(), this.getAttachments();
  }
  addFile(t5, e14) {
    if (!t5 || !e14) return null;
    const i9 = { file: t5, form: e14 };
    return this.fileInfos.add(i9), i9;
  }
  updateFile(t5, e14, i9 = this.activeFileInfo) {
    if (!t5 || !e14 || !i9) return null;
    const a7 = this.fileInfos.indexOf(i9);
    return a7 > -1 && this.fileInfos.splice(a7, 1, { file: t5, form: e14 }), this.fileInfos.items[a7];
  }
  deleteFile(t5) {
    const e14 = this.fileInfos.find((e15) => e15.file === t5);
    return e14 ? (this.fileInfos.remove(e14), e14) : null;
  }
  async _queryAttachment(t5, e14) {
    const { _attachmentLayer: i9 } = this;
    if (!t5 || !(i9 == null ? void 0 : i9.queryAttachments)) throw new s("invalid-attachment-id", "Could not query attachment.");
    const a7 = this._getObjectId(e14);
    if ("number" != typeof a7) throw new s("invalid-object-id", "getAttachments(): Numeric object id is required");
    const r10 = new c4({ objectIds: [a7], attachmentsWhere: `AttachmentId=${t5}`, returnMetadata: true });
    return i9.queryAttachments(r10).then((t6) => t6[a7][0]);
  }
  _getObjectId(t5 = this.graphic) {
    return (t5 == null ? void 0 : t5.getObjectId()) ?? null;
  }
  _graphicChanged() {
    this.graphic && (this._setAttachmentLayer(), this.getAttachments().catch(() => this.attachmentInfos.destroyAll()));
  }
  _setAttachmentLayer() {
    const { graphic: t5 } = this, e14 = L(t5);
    this._attachmentLayer = e14 ? "scene" === e14.type && null != e14.associatedLayer ? e14.associatedLayer : e14 : null;
  }
};
r4([m()], y3.prototype, "capabilities", void 0), r4([s4("capabilities")], y3.prototype, "castCapabilities", null), r4([m()], y3.prototype, "activeAttachmentInfo", void 0), r4([m()], y3.prototype, "activeFileInfo", void 0), r4([m({ readOnly: true, type: f })], y3.prototype, "attachmentInfos", void 0), r4([m()], y3.prototype, "fileInfos", void 0), r4([m({ type: b3 })], y3.prototype, "graphic", void 0), r4([m()], y3.prototype, "mode", void 0), r4([m({ type: [n5] })], y3.prototype, "orderByFields", void 0), r4([m({ readOnly: true })], y3.prototype, "state", null), r4([m()], y3.prototype, "filesEnabled", void 0), r4([m({ readOnly: true })], y3.prototype, "supportsResizeAttachments", null), y3 = r4([a("esri.widgets.Attachments.AttachmentsViewModel")], y3);
var A2 = y3;

// node_modules/@arcgis/core/widgets/Attachments/support/attachmentUtils.js
function e5(i9) {
  const e14 = i9.toLowerCase();
  return "image/bmp" === e14 || "image/emf" === e14 || "image/exif" === e14 || "image/gif" === e14 || "image/x-icon" === e14 || "image/jpeg" === e14 || "image/png" === e14 || "image/tiff" === e14 || "image/x-wmf" === e14;
}
function p3(e14) {
  const p9 = n3("esri/themes/base/images/files/");
  return e14 ? "text/plain" === e14 ? `${p9}text-32.svg` : "application/pdf" === e14 ? `${p9}pdf-32.svg` : "text/csv" === e14 ? `${p9}csv-32.svg` : "application/gpx+xml" === e14 ? `${p9}gpx-32.svg` : "application/x-dwf" === e14 ? `${p9}cad-32.svg` : "application/postscript" === e14 || "application/json" === e14 || "text/xml" === e14 || "model/vrml" === e14 ? `${p9}code-32.svg` : "application/x-zip-compressed" === e14 || "application/x-7z-compressed" === e14 || "application/x-gzip" === e14 || "application/x-tar" === e14 || "application/x-gtar" === e14 || "application/x-bzip2" === e14 || "application/gzip" === e14 || "application/x-compress" === e14 || "application/x-apple-diskimage" === e14 || "application/x-rar-compressed" === e14 || "application/zip" === e14 ? `${p9}zip-32.svg` : e14.includes("image/") ? `${p9}image-32.svg` : e14.includes("audio/") ? `${p9}sound-32.svg` : e14.includes("video/") ? `${p9}video-32.svg` : e14.includes("msexcel") || e14.includes("ms-excel") || e14.includes("spreadsheetml") ? `${p9}excel-32.svg` : e14.includes("msword") || e14.includes("ms-word") || e14.includes("wordprocessingml") ? `${p9}word-32.svg` : e14.includes("powerpoint") || e14.includes("presentationml") ? `${p9}report-32.svg` : `${p9}generic-32.svg` : `${p9}generic-32.svg`;
}

// node_modules/@arcgis/core/widgets/support/legacyIcon.js
var i5 = { close: "esri-icon-close", collapse: "esri-icon-collapse", down: "esri-icon-down", downArrow: "esri-icon-down-arrow", dragHorizontal: "esri-icon-drag-horizontal", dragVertical: "esri-icon-drag-vertical", duplicate: "esri-icon-duplicate", expand: "esri-icon-expand", fontFallbackText: "esri-icon-font-fallback-text", forward: "esri-icon-forward", handleVertical: "esri-icon-handle-vertical", icon: "esri-icon", left: "esri-icon-left", locateCircled: "esri-icon-locate-circled", noticeTriangle: "esri-icon-notice-triangle", pause: "esri-icon-pause", play: "esri-icon-play", plus: "esri-icon-plus", radioChecked: "esri-icon-radio-checked", radioUnchecked: "esri-icon-radio-unchecked", refresh: "esri-icon-refresh", reverse: "esri-icon-reverse", right: "esri-icon-right", search: "esri-icon-search", swap: "esri-icon-swap", table: "esri-icon-table", trash: "esri-icon-trash", up: "esri-icon-up", upArrow: "esri-icon-up-arrow", upDownArrows: "esri-icon-up-down-arrows", urbanModel: "esri-icon-urban-model", zoomInMagnifyingGlass: "esri-icon-zoom-in-magnifying-glass", zoomToObject: "esri-icon-zoom-to-object" };

// node_modules/@arcgis/core/widgets/Attachments.js
var A3 = { addButton: true, addSubmitButton: true, cancelAddButton: true, cancelUpdateButton: true, deleteButton: true, errorMessage: true, progressBar: true, updateButton: true };
var w3 = "esri-attachments";
var F = { base: w3, loaderContainer: `${w3}__loader-container`, loader: `${w3}__loader`, fadeIn: `${w3}--fade-in`, container: `${w3}__container`, containerList: `${w3}__container--list`, containerPreview: `${w3}__container--preview`, actions: `${w3}__actions`, deleteButton: `${w3}__delete-button`, addAttachmentButton: `${w3}__add-attachment-button`, errorMessage: `${w3}__error-message`, items: `${w3}__items`, item: `${w3}__item`, itemButton: `${w3}__item-button`, itemMask: `${w3}__item-mask`, itemMaskIcon: `${w3}__item-mask--icon`, itemImage: `${w3}__image`, itemImageResizable: `${w3}__image--resizable`, itemLabel: `${w3}__label`, itemFilename: `${w3}__filename`, itemChevronIcon: `${w3}__item-chevron-icon`, itemLink: `${w3}__item-link`, itemLinkOverlay: `${w3}__item-link-overlay`, itemLinkOverlayIcon: `${w3}__item-link-overlay-icon`, itemEditIcon: `${w3}__item-edit-icon`, itemAddIcon: `${w3}__item-add-icon`, itemAddButton: `${w3}__item-add-button`, formNode: `${w3}__form-node`, fileFieldset: `${w3}__file-fieldset`, fileLabel: `${w3}__file-label`, fileName: `${w3}__file-name`, fileInput: `${w3}__file-input`, metadata: `${w3}__metadata`, metadataFieldset: `${w3}__metadata-fieldset`, progressBar: `${w3}__progress-bar` };
var k2 = window.CSS;
var M2 = class extends O {
  constructor(e14, t5) {
    super(e14, t5), this.displayType = "auto", this.messages = null, this.messagesUnits = null, this.selectedFile = null, this.submitting = false, this.viewModel = null, this.visibleElements = { ...A3 }, this._supportsImageOrientation = k2 && k2.supports && k2.supports("image-orientation", "from-image"), this._addAttachmentForm = null, this._updateAttachmentForm = null;
  }
  normalizeCtorArgs(e14) {
    return (e14 == null ? void 0 : e14.viewModel) || (e14 = { viewModel: new A2(), ...e14 }), e14;
  }
  initialize() {
    this.addHandles([v(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.attachmentInfos;
    }, "change", () => this.scheduleRender()), v(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.fileInfos;
    }, "change", () => this.scheduleRender()), d3(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.mode;
    }, () => this._modeChanged(), P)]);
  }
  loadDependencies() {
    return c3({ icon: () => import("./calcite-icon-IDR3G5OX.js") });
  }
  get capabilities() {
    return this.viewModel.capabilities;
  }
  set capabilities(e14) {
    this.viewModel.capabilities = e14;
  }
  get effectiveDisplayType() {
    const { displayType: e14 } = this;
    return e14 && "auto" !== e14 ? e14 : this.viewModel.supportsResizeAttachments ? "preview" : "list";
  }
  get graphic() {
    return this.viewModel.graphic;
  }
  set graphic(e14) {
    this.viewModel.graphic = e14;
  }
  get icon() {
    return "attachment";
  }
  set icon(e14) {
    this._overrideIfSome("icon", e14);
  }
  get label() {
    var _a;
    return ((_a = this.messages) == null ? void 0 : _a.widgetLabel) ?? "";
  }
  set label(e14) {
    this._overrideIfSome("label", e14);
  }
  castVisibleElements(e14) {
    return { ...A3, ...e14 };
  }
  addAttachment() {
    const { _addAttachmentForm: e14, viewModel: s11 } = this;
    return this._set("submitting", true), this._set("error", null), s11.addAttachment(e14).then((e15) => (this._set("submitting", false), this._set("error", null), s11.mode = "view", e15)).catch((e15) => {
      throw this._set("submitting", false), this._set("error", new s("attachments:add-attachment", this.messages.addErrorMessage, e15)), e15;
    });
  }
  deleteAttachment(e14) {
    const { viewModel: s11 } = this;
    return this._set("submitting", true), this._set("error", null), s11.deleteAttachment(e14).then((e15) => (this._set("submitting", false), this._set("error", null), s11.mode = "view", e15)).catch((e15) => {
      throw this._set("submitting", false), this._set("error", new s("attachments:delete-attachment", this.messages.deleteErrorMessage, e15)), e15;
    });
  }
  updateAttachment() {
    const { viewModel: e14 } = this, { _updateAttachmentForm: s11 } = this;
    return this._set("submitting", true), this._set("error", null), e14.updateAttachment(s11).then((t5) => (this._set("submitting", false), this._set("error", null), e14.mode = "view", t5)).catch((e15) => {
      throw this._set("submitting", false), this._set("error", new s("attachments:update-attachment", this.messages.updateErrorMessage, e15)), e15;
    });
  }
  addFile() {
    const e14 = this.viewModel.addFile(this.selectedFile, this._addAttachmentForm);
    return this.viewModel.mode = "view", e14;
  }
  updateFile() {
    const { viewModel: e14 } = this, t5 = e14.updateFile(this.selectedFile, this._updateAttachmentForm, e14.activeFileInfo);
    return e14.mode = "view", t5;
  }
  deleteFile(e14) {
    var _a;
    const t5 = this.viewModel.deleteFile(e14 || ((_a = this.viewModel.activeFileInfo) == null ? void 0 : _a.file));
    return this.viewModel.mode = "view", t5;
  }
  render() {
    const { submitting: e14, viewModel: t5 } = this, { state: s11 } = t5;
    return n2("div", { class: this.classes(F.base, e4.widget) }, e14 ? this._renderProgressBar() : null, "loading" === s11 ? this._renderLoading() : this._renderAttachments(), this._renderErrorMessage());
  }
  _renderErrorMessage() {
    const { error: e14, visibleElements: t5 } = this;
    return e14 && t5.errorMessage ? n2("div", { class: F.errorMessage, key: "error-message" }, e14.message) : null;
  }
  _renderAttachments() {
    const { activeFileInfo: e14, mode: t5, activeAttachmentInfo: s11 } = this.viewModel;
    return "add" === t5 ? this._renderAddForm() : "edit" === t5 ? this._renderDetailsForm(s11 || e14) : this._renderAttachmentContainer();
  }
  _renderLoading() {
    return n2("div", { class: F.loaderContainer, key: "loader" }, n2("div", { class: F.loader }));
  }
  _renderProgressBar() {
    return this.visibleElements.progressBar ? n2("div", { class: F.progressBar, key: "progress-bar" }) : null;
  }
  _renderAddForm() {
    const { submitting: e14, selectedFile: t5 } = this, s11 = e14 || !t5, i9 = this.visibleElements.cancelAddButton ? n2("button", { bind: this, class: this.classes(e4.button, e4.buttonTertiary, e4.buttonSmall, e4.buttonHalf, e14 && e4.buttonDisabled), disabled: e14, onclick: this._cancelForm, type: "button" }, this.messages.cancel) : null, a7 = this.visibleElements.addSubmitButton ? n2("button", { class: this.classes(e4.button, e4.buttonSecondary, e4.buttonSmall, e4.buttonHalf, { [e4.buttonDisabled]: s11 }), disabled: s11, type: "submit" }, this.messages.add) : null, n15 = t5 ? n2("span", { class: F.fileName, key: "file-name" }, t5.name) : null, l9 = n2("form", { afterCreate: y2, afterRemoved: w2, bind: this, "data-node-ref": "_addAttachmentForm", onsubmit: this._submitAddAttachment }, n2("fieldset", { class: F.fileFieldset }, n15, n2("label", { class: this.classes(F.fileLabel, e4.button, e4.buttonSecondary) }, t5 ? this.messages.changeFile : this.messages.selectFile, n2("input", { bind: this, class: F.fileInput, name: "attachment", onchange: this._handleFileInputChange, type: "file" }))), a7, i9);
    return n2("div", { class: F.formNode, key: "add-form-container" }, l9);
  }
  _renderDetailsForm(e14) {
    var _a, _b, _c;
    const { visibleElements: t5, viewModel: s11, selectedFile: i9, submitting: a7 } = this, { capabilities: l9 } = s11, r10 = a7 || !i9;
    let o3, d10, c17, m8;
    i9 ? (o3 = i9.type, d10 = i9.name, c17 = i9.size) : e14 && "file" in e14 ? (o3 = e14.file.type, d10 = e14.file.name, c17 = e14.file.size) : e14 && "contentType" in e14 && (o3 = e14.contentType, d10 = e14.name, c17 = e14.size, m8 = e14.url);
    const h10 = l9.editing && ((_a = l9.operations) == null ? void 0 : _a.delete) && t5.deleteButton ? n2("button", { bind: this, class: this.classes(e4.button, e4.buttonSmall, e4.buttonTertiary, F.deleteButton, { [e4.buttonDisabled]: a7 }), disabled: a7, key: "delete-button", onclick: (t6) => this._submitDeleteAttachment(t6, e14), type: "button" }, this.messages.delete) : void 0, u9 = l9.editing && ((_b = l9.operations) == null ? void 0 : _b.update) && t5.updateButton ? n2("button", { class: this.classes(e4.button, e4.buttonSmall, e4.buttonThird, { [e4.buttonDisabled]: r10 }), disabled: r10, key: "update-button", type: "submit" }, this.messages.update) : void 0, b10 = this.visibleElements.cancelUpdateButton ? n2("button", { bind: this, class: this.classes(e4.button, e4.buttonSmall, e4.buttonTertiary, e4.buttonThird, { [e4.buttonDisabled]: a7 }), disabled: a7, key: "cancel-button", onclick: this._cancelForm, type: "button" }, this.messages.cancel) : void 0, f6 = l9.editing && ((_c = l9.operations) == null ? void 0 : _c.update) ? n2("fieldset", { class: F.fileFieldset, key: "file" }, n2("span", { class: F.fileName, key: "file-name" }, d10), n2("label", { class: this.classes(F.fileLabel, e4.button, e4.buttonSecondary) }, this.messages.changeFile, n2("input", { bind: this, class: F.fileInput, name: "attachment", onchange: this._handleFileInputChange, type: "file" }))) : void 0, v9 = n2("fieldset", { class: F.metadataFieldset, key: "size" }, n2("label", null, T(this.messagesUnits, c17 ?? 0))), A6 = n2("fieldset", { class: F.metadataFieldset, key: "content-type" }, n2("label", null, o3)), w9 = null != m8 ? n2("a", { class: F.itemLink, href: m8, rel: "noreferrer", target: "_blank" }, this._renderImageMask(e14, 400), n2("div", { class: F.itemLinkOverlay }, n2("span", { class: F.itemLinkOverlayIcon }, n2("calcite-icon", { icon: "launch" })))) : this._renderImageMask(e14, 400), k6 = n2("form", { afterCreate: y2, afterRemoved: w2, bind: this, "data-node-ref": "_updateAttachmentForm", onsubmit: (t6) => this._submitUpdateAttachment(t6, e14) }, n2("div", { class: F.metadata }, v9, A6), f6, n2("div", { class: F.actions }, h10, b10, u9));
    return n2("div", { class: F.formNode, key: "edit-form-container" }, w9, k6);
  }
  _renderImageMask(e14, t5) {
    return e14 ? "file" in e14 ? this._renderGenericImageMask(e14.file.name, e14.file.type) : this._renderImageMaskForAttachment(e14, t5) : null;
  }
  _renderGenericImageMask(e14, t5) {
    const { supportsResizeAttachments: s11 } = this.viewModel, i9 = p3(t5), a7 = { [F.itemImageResizable]: s11 };
    return n2("div", { class: this.classes(F.itemMaskIcon, F.itemMask), key: i9 }, n2("img", { alt: e14, class: this.classes(a7, F.itemImage), src: i9, title: e14 }));
  }
  _renderImageMaskForAttachment(e14, t5) {
    const { supportsResizeAttachments: s11 } = this.viewModel;
    if (!e14) return null;
    const { contentType: i9, name: a7, url: n15 } = e14;
    if (!s11 || !e5(i9)) return this._renderGenericImageMask(a7, i9);
    const l9 = this._getCSSTransform(e14), r10 = l9 ? { transform: l9, "image-orientation": "none" } : {}, o3 = `${n15}${(n15 == null ? void 0 : n15.includes("?")) ? "&" : "?"}w=${t5}`, d10 = { [F.itemImageResizable]: s11 };
    return n2("div", { class: this.classes(F.itemMask), key: o3 }, n2("img", { alt: a7, class: this.classes(d10, F.itemImage), src: o3, styles: r10, title: a7 }));
  }
  _renderFile(e14) {
    const { file: t5 } = e14;
    return n2("li", { class: F.item, key: t5 }, n2("button", { "aria-label": this.messages.attachmentDetails, bind: this, class: F.itemButton, key: "details-button", onclick: () => this._startEditFile(e14), title: this.messages.attachmentDetails, type: "button" }, this._renderImageMask(e14), n2("label", { class: F.itemLabel }, n2("span", { class: F.itemFilename }, t5.name || this.messages.noTitle), n2("span", { "aria-hidden": "true", class: this.classes(F.itemChevronIcon, g2(this.container) ? i5.left : i5.right) }))));
  }
  _renderAttachmentInfo({ attachmentInfo: e14, displayType: t5 }) {
    const { viewModel: s11, effectiveDisplayType: i9 } = this, { capabilities: a7, supportsResizeAttachments: n15 } = s11, { contentType: l9, name: r10, url: o3 } = e14, d10 = this._renderImageMask(e14, "list" === t5 ? 48 : 400), c17 = a7.editing ? n2("span", { "aria-hidden": "true", class: this.classes(F.itemChevronIcon, g2(this.container) ? i5.left : i5.right) }) : null, m8 = [d10, "preview" === i9 && n15 && e5(l9) ? null : n2("label", { class: F.itemLabel }, n2("span", { class: F.itemFilename }, r10 || this.messages.noTitle), c17)], u9 = a7.editing ? n2("button", { "aria-label": this.messages.attachmentDetails, bind: this, class: F.itemButton, "data-attachment-info-id": e14.id, key: "details-button", onclick: () => this._startEditAttachment(e14), title: this.messages.attachmentDetails, type: "button" }, m8) : n2("a", { class: F.itemButton, href: o3 ?? void 0, key: "details-link", rel: "noreferrer", target: "_blank" }, m8);
    return n2("li", { class: F.item, key: e14 }, u9);
  }
  _renderAttachmentContainer() {
    var _a;
    const { effectiveDisplayType: e14, viewModel: t5, visibleElements: s11 } = this, { attachmentInfos: i9, capabilities: a7, fileInfos: n15 } = t5, l9 = !!(i9 == null ? void 0 : i9.length), r10 = !!(n15 == null ? void 0 : n15.length), o3 = { [F.containerList]: "preview" !== e14, [F.containerPreview]: "preview" === e14 }, d10 = a7.editing && ((_a = a7.operations) == null ? void 0 : _a.add) && s11.addButton ? n2("button", { bind: this, class: this.classes(e4.button, e4.buttonTertiary, F.addAttachmentButton), onclick: () => this._startAddAttachment(), type: "button" }, n2("span", { "aria-hidden": "true", class: this.classes(F.itemAddIcon, i5.plus) }), this.messages.add) : void 0, c17 = l9 ? n2("ul", { class: F.items, key: "attachments-list" }, i9.toArray().map((t6) => this._renderAttachmentInfo({ attachmentInfo: t6, displayType: e14 }))) : void 0, m8 = r10 ? n2("ul", { class: F.items, key: "file-list" }, n15.toArray().map((e15) => this._renderFile(e15))) : void 0, h10 = r10 || l9 ? void 0 : n2("div", { class: e4.empty }, this.messages.noAttachments);
    return n2("div", { class: this.classes(F.container, o3), key: "attachments-container" }, c17, m8, h10, d10);
  }
  _modeChanged() {
    this._set("error", null), this._set("selectedFile", null);
  }
  _handleFileInputChange(e14) {
    var _a;
    const t5 = e14.target, s11 = (_a = t5.files) == null ? void 0 : _a.item(0);
    this._set("selectedFile", s11);
  }
  _submitDeleteAttachment(e14, t5) {
    e14.preventDefault(), t5 && ("file" in t5 ? this.deleteFile(t5.file) : t5 && this.deleteAttachment(t5));
  }
  _submitAddAttachment(e14) {
    e14.preventDefault(), this.viewModel.filesEnabled ? this.addFile() : this.addAttachment();
  }
  _submitUpdateAttachment(e14, t5) {
    e14.preventDefault(), t5 && "file" in t5 ? this.updateFile() : this.updateAttachment();
  }
  _startEditAttachment(e14) {
    const { viewModel: t5 } = this;
    t5.activeFileInfo = null, t5.activeAttachmentInfo = e14, t5.mode = "edit";
  }
  _startEditFile(e14) {
    const { viewModel: t5 } = this;
    t5.activeAttachmentInfo = null, t5.activeFileInfo = e14, t5.mode = "edit";
  }
  _startAddAttachment() {
    this.viewModel.mode = "add";
  }
  _cancelForm(e14) {
    e14.preventDefault(), this.viewModel.mode = "view";
  }
  _getCSSTransform(e14) {
    const { orientationInfo: t5 } = e14;
    return !this._supportsImageOrientation && t5 ? [t5.rotation ? `rotate(${t5.rotation}deg)` : "", t5.mirrored ? "scaleX(-1)" : ""].join(" ") : "";
  }
};
r4([m()], M2.prototype, "capabilities", null), r4([m()], M2.prototype, "displayType", void 0), r4([m({ readOnly: true })], M2.prototype, "effectiveDisplayType", null), r4([m()], M2.prototype, "graphic", null), r4([m()], M2.prototype, "icon", null), r4([m()], M2.prototype, "label", null), r4([m(), e3("esri/widgets/Attachments/t9n/Attachments")], M2.prototype, "messages", void 0), r4([m(), e3("esri/core/t9n/Units")], M2.prototype, "messagesUnits", void 0), r4([m({ readOnly: true })], M2.prototype, "selectedFile", void 0), r4([m({ readOnly: true })], M2.prototype, "submitting", void 0), r4([m({ readOnly: true })], M2.prototype, "error", void 0), r4([m({ type: A2 })], M2.prototype, "viewModel", void 0), r4([m()], M2.prototype, "visibleElements", void 0), r4([s4("visibleElements")], M2.prototype, "castVisibleElements", null), M2 = r4([a("esri.widgets.Attachments")], M2);
var I2 = M2;

// node_modules/@arcgis/core/widgets/Feature/FeatureAttachments/FeatureAttachmentsViewModel.js
var s6 = class extends A2 {
  constructor(t5) {
    super(t5), this.description = null, this.title = null;
  }
};
r4([m()], s6.prototype, "description", void 0), r4([m()], s6.prototype, "title", void 0), s6 = r4([a("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")], s6);
var c7 = s6;

// node_modules/@arcgis/core/widgets/support/Heading.js
function e6({ level: r10, class: e14, ...n15 }, l9) {
  const a7 = s7(r10);
  return n2(`h${a7}`, { ...n15, "aria-level": String(a7), class: v2(e4.heading, e14), role: "heading" }, l9);
}
function s7(t5) {
  return r(Math.ceil(t5), 1, 6);
}

// node_modules/@arcgis/core/widgets/Feature/support/FeatureElementInfo.js
var n7 = "esri-feature-element-info";
var p4 = { base: n7, title: `${n7}__title`, description: `${n7}__description` };
var c8 = class extends O {
  constructor(e14, t5) {
    super(e14, t5), this.description = null, this.headingLevel = 2, this.title = null;
  }
  render() {
    return n2("div", { class: p4.base }, this._renderTitle(), this._renderDescription());
  }
  _renderTitle() {
    const { title: e14 } = this;
    return e14 ? n2(e6, { class: p4.title, innerHTML: e14, level: this.headingLevel }) : null;
  }
  _renderDescription() {
    const { description: e14 } = this;
    return e14 ? n2("div", { class: p4.description, innerHTML: e14, key: "description" }) : null;
  }
};
r4([m()], c8.prototype, "description", void 0), r4([m()], c8.prototype, "headingLevel", void 0), r4([m()], c8.prototype, "title", void 0), c8 = r4([a("esri.widgets.Feature.support.FeatureElementInfo")], c8);
var l3 = c8;

// node_modules/@arcgis/core/widgets/Feature/FeatureAttachments.js
var d6 = { base: "esri-feature-attachments" };
var h3 = class extends O {
  constructor(e14, t5) {
    super(e14, t5), this._featureElementInfo = null, this.attachmentsWidget = new I2(), this.headingLevel = 2, this.viewModel = new c7();
  }
  initialize() {
    this._featureElementInfo = new l3(), this.addHandles([d3(() => {
      var _a, _b;
      return [(_a = this.viewModel) == null ? void 0 : _a.description, (_b = this.viewModel) == null ? void 0 : _b.title, this.headingLevel];
    }, () => this._setupFeatureElementInfo(), P), d3(() => this.viewModel, (e14) => this.attachmentsWidget.viewModel = e14, P)]);
  }
  destroy() {
    var _a;
    this.attachmentsWidget.viewModel = null, this.attachmentsWidget.destroy(), (_a = this._featureElementInfo) == null ? void 0 : _a.destroy();
  }
  get description() {
    return this.viewModel.description;
  }
  set description(e14) {
    this.viewModel.description = e14;
  }
  get displayType() {
    return this.attachmentsWidget.displayType;
  }
  set displayType(e14) {
    this.attachmentsWidget.displayType = e14;
  }
  get graphic() {
    return this.viewModel.graphic;
  }
  set graphic(e14) {
    this.viewModel.graphic = e14;
  }
  get title() {
    return this.viewModel.title;
  }
  set title(e14) {
    this.viewModel.title = e14;
  }
  render() {
    var _a;
    const { attachmentsWidget: e14 } = this;
    return n2("div", { class: d6.base }, (_a = this._featureElementInfo) == null ? void 0 : _a.render(), e14 == null ? void 0 : e14.render());
  }
  _setupFeatureElementInfo() {
    var _a;
    const { description: e14, title: t5, headingLevel: i9 } = this;
    (_a = this._featureElementInfo) == null ? void 0 : _a.set({ description: e14, title: t5, headingLevel: i9 });
  }
};
r4([m({ readOnly: true })], h3.prototype, "attachmentsWidget", void 0), r4([m()], h3.prototype, "description", null), r4([m()], h3.prototype, "displayType", null), r4([m()], h3.prototype, "graphic", null), r4([m()], h3.prototype, "headingLevel", void 0), r4([m()], h3.prototype, "title", null), r4([m({ type: c7 })], h3.prototype, "viewModel", void 0), h3 = r4([a("esri.widgets.Feature.FeatureAttachments")], h3);
var c9 = h3;

// node_modules/@arcgis/core/widgets/Feature/FeatureContent/FeatureContentViewModel.js
var c10 = class extends g {
  constructor(t5) {
    super(t5), this._loadingPromise = null, this.created = null, this.creator = null, this.destroyer = null, this.graphic = null, this.addHandles(d3(() => this.creator, (t6) => {
      this._destroyContent(), this._createContent(t6);
    }, P));
  }
  destroy() {
    this._destroyContent();
  }
  get state() {
    return this._loadingPromise ? "loading" : "ready";
  }
  _destroyContent() {
    const { created: t5, graphic: e14, destroyer: r10 } = this;
    t5 && e14 && (q({ type: "content", value: r10, event: { graphic: e14 } }), this._set("created", null));
  }
  async _createContent(t5) {
    const e14 = this.graphic;
    if (!e14 || !t5) return;
    const r10 = q({ type: "content", value: t5, event: { graphic: e14 } });
    this._loadingPromise = r10, this.notifyChange("state");
    const o3 = await r10;
    r10 === this._loadingPromise && (this._loadingPromise = null, this.notifyChange("state"), this._set("created", o3));
  }
};
r4([m({ readOnly: true })], c10.prototype, "created", void 0), r4([m()], c10.prototype, "creator", void 0), r4([m()], c10.prototype, "destroyer", void 0), r4([m({ type: b3 })], c10.prototype, "graphic", void 0), r4([m({ readOnly: true })], c10.prototype, "state", null), c10 = r4([a("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")], c10);
var p5 = c10;

// node_modules/@arcgis/core/widgets/support/decorators/vmEvent.js
function e7(e14) {
  return (a7) => {
    a7.hasOwnProperty("_delegatedEventNames") || (a7._delegatedEventNames = a7._delegatedEventNames ? a7._delegatedEventNames.slice() : []);
    const n15 = a7._delegatedEventNames, r10 = Array.isArray(e14) ? e14 : t(e14);
    n15.push(...r10);
  };
}
function t(e14) {
  return e14.split(",").map((e15) => e15.trim());
}

// node_modules/@arcgis/core/widgets/support/widget.js
function e8(e14) {
  return e14 && "function" == typeof e14.render;
}
function t3(e14) {
  return e14 && "function" == typeof e14.postMixInProperties && "function" == typeof e14.buildRendering && "function" == typeof e14.postCreate && "function" == typeof e14.startup;
}

// node_modules/@arcgis/core/widgets/Feature/FeatureContent.js
var n9 = "esri-feature-content";
var c12 = { base: n9, loaderContainer: `${n9}__loader-container`, loader: `${n9}__loader` };
var l4 = class extends O {
  constructor(e14, r10) {
    super(e14, r10), this.viewModel = null, this._addTargetToAnchors = (e15) => {
      Array.from(e15.querySelectorAll("a")).forEach((e16) => {
        x2(e16.href) && !e16.hasAttribute("target") && e16.setAttribute("target", "_blank");
      });
    };
  }
  get creator() {
    var _a;
    return (_a = this.viewModel) == null ? void 0 : _a.creator;
  }
  set creator(e14) {
    this.viewModel && (this.viewModel.creator = e14);
  }
  get graphic() {
    var _a;
    return (_a = this.viewModel) == null ? void 0 : _a.graphic;
  }
  set graphic(e14) {
    this.viewModel && (this.viewModel.graphic = e14);
  }
  render() {
    var _a;
    const e14 = (_a = this.viewModel) == null ? void 0 : _a.state;
    return n2("div", { class: c12.base }, "loading" === e14 ? this._renderLoading() : this._renderCreated());
  }
  _renderLoading() {
    return n2("div", { class: c12.loaderContainer, key: "loader" }, n2("div", { class: c12.loader }));
  }
  _renderCreated() {
    var _a;
    const e14 = (_a = this.viewModel) == null ? void 0 : _a.created;
    return e14 ? e14 instanceof HTMLElement ? n2("div", { afterCreate: this._attachToNode, bind: e14, key: e14 }) : e8(e14) ? n2("div", { key: e14 }, !e14.destroyed && e14.render()) : n2("div", { afterCreate: this._addTargetToAnchors, innerHTML: e14, key: e14 }) : null;
  }
  _attachToNode(e14) {
    const r10 = this;
    e14.appendChild(r10);
  }
};
r4([m()], l4.prototype, "creator", null), r4([m()], l4.prototype, "graphic", null), r4([m({ type: p5 })], l4.prototype, "viewModel", void 0), l4 = r4([a("esri.widgets.Feature.FeatureContent")], l4);
var p6 = l4;

// node_modules/@arcgis/core/widgets/Feature/FeatureFields/FeatureFieldsViewModel.js
var l5 = class extends g {
  constructor(o3) {
    super(o3), this.attributes = null, this.expressionInfos = null, this.description = null, this.fieldInfos = null, this.title = null;
  }
  get formattedFieldInfos() {
    const { expressionInfos: o3, fieldInfos: e14 } = this, t5 = [];
    return e14 == null ? void 0 : e14.forEach((e15) => {
      if (!(!e15.hasOwnProperty("visible") || e15.visible)) return;
      const s11 = e15.clone();
      s11.label = C(s11, o3), t5.push(s11);
    }), t5;
  }
};
r4([m()], l5.prototype, "attributes", void 0), r4([m({ type: [i3] })], l5.prototype, "expressionInfos", void 0), r4([m()], l5.prototype, "description", void 0), r4([m({ type: [n6] })], l5.prototype, "fieldInfos", void 0), r4([m({ readOnly: true })], l5.prototype, "formattedFieldInfos", null), r4([m()], l5.prototype, "title", void 0), l5 = r4([a("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")], l5);
var n10 = l5;

// node_modules/@arcgis/core/widgets/support/uriUtils.js
var s8 = [{ pattern: /^\s*(https?:\/\/([^\s]+))\s*$/i, target: "_blank", label: "{messages.view}" }, { pattern: /^\s*(tel:([^\s]+))\s*$/i, label: "{hierPart}" }, { pattern: /^\s*(mailto:([^\s]+))\s*$/i, label: "{hierPart}" }, { pattern: /^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "App Studio Player" }, { pattern: /^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Collector" }, { pattern: /^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Explorer" }, { pattern: /^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Navigator" }, { pattern: /^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Survey123" }, { pattern: /^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Trek2There" }, { pattern: /^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Workforce" }, { pattern: /^\s*(iform:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "iForm" }, { pattern: /^\s*(flow:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "FlowFinity" }, { pattern: /^\s*(lfmobile:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Laserfische" }, { pattern: /^\s*(mspbi:\/\/([^\s]+))\s*$/i, label: "{messages.openInApp}", appName: "Microsoft Power Bi" }];
function a4(a7, p9) {
  if ("string" != typeof p9 || !p9) return p9;
  const r10 = s8.find((e14) => e14.pattern.test(p9));
  if (!r10) return p9;
  const t5 = p9.match(r10.pattern), n15 = t5 == null ? void 0 : t5[2], l9 = r2(r2(r10.label, { messages: a7, hierPart: n15 }), { appName: r10.appName }), i9 = r10.target ? ` target="${r10.target}"` : "", o3 = "_blank" === r10.target ? ' rel="noreferrer"' : "";
  return p9.replace(r10.pattern, `<a${i9} href="$1"${o3}>${l9}</a>`);
}

// node_modules/@arcgis/core/widgets/Feature/FeatureFields.js
var u3 = "esri-feature-fields";
var m3 = { base: u3, fieldHeader: `${u3}__field-header`, fieldData: `${u3}__field-data`, fieldDataDate: `${u3}__field-data--date` };
var c13 = class extends O {
  constructor(e14, t5) {
    super(e14, t5), this._featureElementInfo = null, this.viewModel = new n10(), this.messages = null, this.messagesURIUtils = null;
  }
  initialize() {
    this._featureElementInfo = new l3(), this.addHandles(d3(() => {
      var _a, _b;
      return [(_a = this.viewModel) == null ? void 0 : _a.description, (_b = this.viewModel) == null ? void 0 : _b.title];
    }, () => this._setupFeatureElementInfo(), P));
  }
  destroy() {
    var _a;
    (_a = this._featureElementInfo) == null ? void 0 : _a.destroy();
  }
  get attributes() {
    return this.viewModel.attributes;
  }
  set attributes(e14) {
    this.viewModel.attributes = e14;
  }
  get description() {
    return this.viewModel.description;
  }
  set description(e14) {
    this.viewModel.description = e14;
  }
  get expressionInfos() {
    return this.viewModel.expressionInfos;
  }
  set expressionInfos(e14) {
    this.viewModel.expressionInfos = e14;
  }
  get fieldInfos() {
    return this.viewModel.fieldInfos;
  }
  set fieldInfos(e14) {
    this.viewModel.fieldInfos = e14;
  }
  get title() {
    return this.viewModel.title;
  }
  set title(e14) {
    this.viewModel.title = e14;
  }
  render() {
    var _a;
    return n2("div", { class: m3.base }, (_a = this._featureElementInfo) == null ? void 0 : _a.render(), this._renderFields());
  }
  _renderFieldInfo(e14, t5) {
    var _a;
    const { attributes: s11 } = this.viewModel, i9 = e14.fieldName || "", r10 = e14.label || i9, o3 = s11 ? null == s11[i9] ? "" : s11[i9] : "", l9 = !!((_a = e14.format) == null ? void 0 : _a.dateFormat), n15 = "number" == typeof o3 && !l9 ? this._forceLTR(o3) : a4(this.messagesURIUtils, o3), d10 = { [m3.fieldDataDate]: l9 };
    return n2("tr", { key: `fields-element-info-row-${i9}-${t5}` }, n2("th", { class: m3.fieldHeader, innerHTML: r10, key: `fields-element-info-row-header-${i9}-${t5}` }), n2("td", { class: this.classes(m3.fieldData, d10), innerHTML: n15, key: `fields-element-info-row-data-${i9}-${t5}` }));
  }
  _renderFields() {
    const { formattedFieldInfos: e14 } = this.viewModel;
    return (e14 == null ? void 0 : e14.length) ? n2("table", { class: e4.table, summary: this.messages.fieldsSummary }, n2("tbody", null, e14.map((e15, t5) => this._renderFieldInfo(e15, t5)))) : null;
  }
  _setupFeatureElementInfo() {
    var _a;
    const { description: e14, title: t5 } = this;
    (_a = this._featureElementInfo) == null ? void 0 : _a.set({ description: e14, title: t5 });
  }
  _forceLTR(e14) {
    return `&lrm;${e14}`;
  }
};
r4([m()], c13.prototype, "attributes", null), r4([m()], c13.prototype, "description", null), r4([m()], c13.prototype, "expressionInfos", null), r4([m()], c13.prototype, "fieldInfos", null), r4([m()], c13.prototype, "title", null), r4([m({ type: n10, nonNullable: true })], c13.prototype, "viewModel", void 0), r4([m(), e3("esri/widgets/Feature/t9n/Feature")], c13.prototype, "messages", void 0), r4([m(), e3("esri/widgets/support/t9n/uriUtils")], c13.prototype, "messagesURIUtils", void 0), c13 = r4([a("esri.widgets.Feature.FeatureFields")], c13);
var h5 = c13;

// node_modules/@arcgis/core/widgets/Legend/support/heatmapRampUtils.js
function r7(r10) {
  if (!r10.colorStops) return [];
  const e14 = [...r10.colorStops].filter((o3) => {
    var _a;
    return ((_a = o3.color) == null ? void 0 : _a.a) > 0;
  });
  let t5 = e14.length - 1;
  if (e14[0]) {
    const r11 = e14[t5];
    r11 && 1 !== r11.ratio && (e14.push(new l2({ ratio: 1, color: r11.color })), t5++);
  }
  return e14.map((o3, e15) => {
    var _a, _b;
    let l9 = "";
    return 0 === e15 ? l9 = ((_a = r10.legendOptions) == null ? void 0 : _a.minLabel) || "low" : e15 === t5 && (l9 = ((_b = r10.legendOptions) == null ? void 0 : _b.maxLabel) || "high"), { color: o3.color, label: l9, ratio: o3.ratio };
  }).reverse();
}

// node_modules/@arcgis/core/renderers/support/utils.js
var v3 = j("short-date");
async function w4(e14, l9, t5) {
  r3(e14, l9, () => []).push(...t5);
}
async function x3(l9) {
  var _a, _b;
  const t5 = /* @__PURE__ */ new Map();
  if (!l9) return t5;
  if ("visualVariables" in l9 && l9.visualVariables) {
    for (const e14 of l9.visualVariables) if (D2(e14)) {
      const l10 = (await r6(e14) ?? []).map((e15) => e15.color);
      await w4(t5, e14.field || e14.valueExpression, l10);
    }
  }
  if ("heatmap" === l9.type) {
    const e14 = r7(l9).map((e15) => e15.color);
    await w4(t5, l9.field || l9.valueExpression, e14);
  } else if ("pie-chart" === l9.type) {
    for (const e14 of l9.attributes) await w4(t5, e14.field || e14.valueExpression, [e14.color]);
    await w4(t5, "default", [(_a = l9 == null ? void 0 : l9.othersCategory) == null ? void 0 : _a.color, h2(l9.backgroundFillSymbol, null)]);
  } else if ("dot-density" === l9.type) {
    for (const e14 of l9.attributes) await w4(t5, e14.field || e14.valueExpression, [e14.color]);
    await w4(t5, "default", [l9.backgroundColor]);
  } else if ("unique-value" === l9.type) if ("predominance" === ((_b = l9.authoringInfo) == null ? void 0 : _b.type)) for (const e14 of l9.uniqueValueInfos ?? []) await w4(t5, e14.value.toString(), [h2(e14.symbol, null)]);
  else {
    const e14 = (l9.uniqueValueInfos ?? []).map((e15) => h2(e15.symbol, null)), { field: i9, field2: o3, field3: a7, valueExpression: n15 } = l9;
    (i9 || n15) && await w4(t5, i9 || n15, e14), o3 && await w4(t5, o3, e14), a7 && await w4(t5, a7, e14);
  }
  else if ("class-breaks" === l9.type) {
    const e14 = l9.classBreakInfos.map((e15) => h2(e15.symbol, null)), { field: i9, valueExpression: o3 } = l9;
    await w4(t5, i9 ?? o3, e14);
  } else "simple" === l9.type && await w4(t5, "default", [h2(l9.symbol, null)]);
  return "defaultSymbol" in l9 && l9.defaultSymbol && await w4(t5, "default", [h2(l9.defaultSymbol, null)]), t5.forEach((l10, i9) => {
    const o3 = c(l10.filter(Boolean), (e14, l11) => JSON.stringify(e14) === JSON.stringify(l11));
    t5.set(i9, o3);
  }), t5;
}
function D2(e14) {
  return "color" === e14.type;
}

// node_modules/@arcgis/core/widgets/Feature/support/relatedFeatureUtils.js
var d7 = "esri.widgets.Feature.support.relatedFeatureUtils";
var p7 = () => n.getLogger(d7);
var m4 = /* @__PURE__ */ new Map();
function h6(e14) {
  if (!pe(e14)) return null;
  const [t5, r10] = e14.split("/").slice(1);
  return { layerId: t5, fieldName: r10 };
}
function y4(e14, t5) {
  if (!t5.relationships) return null;
  let r10 = null;
  const { relationships: i9 } = t5;
  return i9.some((t6) => t6.id === parseInt(e14, 10) && (r10 = t6, true)), r10;
}
function I3({ originRelationship: e14, relationships: t5, layerId: r10 }) {
  return t5.find(({ relatedTableId: t6, id: i9 }) => `${t6}` === r10 && i9 === (e14 == null ? void 0 : e14.id)) ?? null;
}
function F2(e14, t5) {
  const r10 = t5.toLowerCase();
  for (const i9 in e14) if (i9.toLowerCase() === r10) return e14[i9];
  return null;
}
function g4(e14, t5) {
  const r10 = y4(e14, t5);
  if (!r10) return;
  return { url: `${t5.url}/${r10.relatedTableId}`, sourceSpatialReference: t5.spatialReference, relation: r10, relatedFields: [], outStatistics: [] };
}
function S(e14, t5) {
  if (!t5) return;
  if (!e14) return;
  const { features: r10, statsFeatures: i9 } = e14, o3 = r10 == null ? void 0 : r10.value;
  t5.relatedFeatures = o3 ? o3.features : [];
  const s11 = i9 == null ? void 0 : i9.value;
  t5.relatedStatsFeatures = s11 ? s11.features : [];
}
function b5(e14, t5, r10, i9) {
  var _a;
  const o3 = new d4();
  return o3.outFields = ["*"], o3.relationshipId = "number" == typeof t5.id ? t5.id : parseInt(t5.id, 10), o3.objectIds = [e14.attributes[r10.objectIdField]], o3.gdbVersion = r10.gdbVersion ?? null, o3.historicMoment = r10.historicMoment ?? null, ((_a = r10.queryRelatedFeatures) == null ? void 0 : _a.call(r10, o3, i9)) ?? Promise.resolve({});
}
function w5(e14, t5, r10) {
  let i9 = 0;
  const o3 = [];
  for (; i9 < t5.length; ) o3.push(`${e14} IN (${t5.slice(i9, r10 + i9)})`), i9 += r10;
  return o3.join(" OR ");
}
function j4(e14) {
  return e14 ? c(e14) : void 0;
}
function R2(e14) {
  return e14 ? c(e14, (e15, t5) => JSON.stringify(e15.toJSON()) === JSON.stringify(t5.toJSON())) : void 0;
}
async function $2(e14, t5, r10, i9) {
  const o3 = r10.layerId.toString(), { layerInfo: u9, relation: c17, relatedFields: f6, outStatistics: d10, url: p9, sourceSpatialReference: m8 } = t5, h10 = j4(f6), y10 = R2(d10);
  if (!u9 || !c17) return null;
  const g11 = I3({ originRelationship: c17, relationships: u9.relationships, layerId: o3 });
  if ((g11 == null ? void 0 : g11.relationshipTableId) && g11.keyFieldInRelationshipTable) {
    const t6 = (await b5(e14, g11, r10, i9))[e14.attributes[r10.objectIdField]];
    if (!t6) return null;
    const o4 = t6.features.map((e15) => e15.attributes[u9.objectIdField]);
    if ((y10 == null ? void 0 : y10.length) && u9.supportsStatistics) {
      const e15 = new b2();
      e15.where = w5(u9.objectIdField, o4, 1e3), e15.outFields = h10, e15.outStatistics = y10, e15.sourceSpatialReference = m8;
      const r11 = { features: Promise.resolve(t6), statsFeatures: s5(p9, e15) };
      return y(r11);
    }
  }
  const S2 = g11 == null ? void 0 : g11.keyField;
  if (S2) {
    const t6 = ge(L3(u9.fields, S2)), o4 = F2(e14.attributes, c17.keyField), f7 = t6 ? `${S2}=${o4}` : `${S2}='${o4}'`, d11 = r10.historicMoment, I8 = r10.gdbVersion, g12 = s5(p9, new b2({ where: f7, outFields: h10, sourceSpatialReference: m8, historicMoment: d11, gdbVersion: I8 }), i9), b10 = !!(y10 == null ? void 0 : y10.length) && u9.supportsStatistics ? s5(p9, new b2({ where: f7, outFields: h10, outStatistics: y10, sourceSpatialReference: m8 }), i9) : null, w9 = { features: g12 };
    return b10 && (w9.statsFeatures = b10), y(w9);
  }
  return null;
}
function N2(t5, r10) {
  return P2(t5, { query: { f: "json" }, signal: r10 == null ? void 0 : r10.signal });
}
function v4({ relatedInfos: e14, layer: t5 }, i9) {
  const n15 = {};
  return e14.forEach((e15, i10) => {
    const { relation: o3 } = e15;
    if (!o3) {
      const e16 = new s("relation-required", "A relation is required on a layer to retrieve related records.");
      throw p7().error(e16), e16;
    }
    const { relatedTableId: s11 } = o3;
    if ("number" != typeof s11) {
      const e16 = new s("A related table ID is required on a layer to retrieve related records.");
      throw p7().error(e16), e16;
    }
    const l9 = `${t5.url}/${s11}`, a7 = m4.get(l9), u9 = a7 ?? N2(l9);
    a7 || m4.set(l9, u9), n15[i10] = u9;
  }), h(y(n15), i9);
}
function T3({ graphic: e14, relatedInfos: t5, layer: r10 }, i9) {
  const o3 = {};
  return t5.forEach((t6, s11) => {
    t6.layerInfo && (o3[s11] = $2(e14, t6, r10, i9));
  }), y(o3);
}
function q2({ relatedInfo: e14, fieldName: t5, fieldInfo: r10 }) {
  var _a, _b;
  if ((_a = e14.relatedFields) == null ? void 0 : _a.push(t5), r10.statisticType) {
    const i9 = new m2({ statisticType: r10.statisticType, onStatisticField: t5, outStatisticFieldName: t5 });
    (_b = e14.outStatistics) == null ? void 0 : _b.push(i9);
  }
}
function L3(e14, t5) {
  if (null != e14) {
    t5 = t5.toLowerCase();
    for (const r10 of e14) if (r10 && r10.name.toLowerCase() === t5) return r10;
  }
  return null;
}

// node_modules/@arcgis/core/widgets/Feature/FeatureMedia/FeatureMediaViewModel.js
var I4 = { chartAnimation: true };
var v5 = class extends g {
  constructor(t5) {
    super(t5), this.abilities = { ...I4 }, this.activeMediaInfoIndex = 0, this.attributes = null, this.description = null, this.fieldInfoMap = null, this.formattedAttributes = null, this.expressionAttributes = null, this.isAggregate = false, this.layer = null, this.mediaInfos = null, this.popupTemplate = null, this.relatedInfos = null, this.title = null;
  }
  castAbilities(t5) {
    return { ...I4, ...t5 };
  }
  get activeMediaInfo() {
    return this.formattedMediaInfos[this.activeMediaInfoIndex] || null;
  }
  get formattedMediaInfos() {
    return this._formatMediaInfos() || [];
  }
  get formattedMediaInfoCount() {
    return this.formattedMediaInfos.length;
  }
  setActiveMedia(t5) {
    this._setContentElementMedia(t5);
  }
  next() {
    this._pageContentElementMedia(1);
  }
  previous() {
    this._pageContentElementMedia(-1);
  }
  _setContentElementMedia(t5) {
    const { formattedMediaInfoCount: e14 } = this, i9 = (t5 + e14) % e14;
    this.activeMediaInfoIndex = i9;
  }
  _pageContentElementMedia(t5) {
    const { activeMediaInfoIndex: e14 } = this, i9 = e14 + t5;
    this._setContentElementMedia(i9);
  }
  _formatMediaInfos() {
    const { mediaInfos: t5, layer: e14 } = this, o3 = this.attributes ?? {}, r10 = this.formattedAttributes ?? {}, a7 = this.expressionAttributes ?? {}, s11 = this.fieldInfoMap ?? /* @__PURE__ */ new Map();
    return (t5 == null ? void 0 : t5.map((t6) => {
      const i9 = t6 == null ? void 0 : t6.clone();
      if (!i9) return null;
      if (i9.title = D({ attributes: o3, fieldInfoMap: s11, globalAttributes: r10, expressionAttributes: a7, layer: e14, text: i9.title }), i9.caption = D({ attributes: o3, fieldInfoMap: s11, globalAttributes: r10, expressionAttributes: a7, layer: e14, text: i9.caption }), i9.altText = D({ attributes: o3, fieldInfoMap: s11, globalAttributes: r10, expressionAttributes: a7, layer: e14, text: i9.altText }), "image" === i9.type) {
        if (!i9.value) return;
        return this._setImageValue({ value: i9.value, formattedAttributes: r10, layer: e14 }), i9.value.sourceURL ? i9 : void 0;
      }
      if ("pie-chart" === i9.type || "line-chart" === i9.type || "column-chart" === i9.type || "bar-chart" === i9.type) {
        if (!i9.value) return;
        return this._setChartValue({ value: i9.value, chartType: i9.type, attributes: o3, formattedAttributes: r10, layer: e14, expressionAttributes: a7 }), i9;
      }
      return null;
    }).filter(G)) ?? [];
  }
  _setImageValue(t5) {
    const e14 = this.fieldInfoMap ?? /* @__PURE__ */ new Map(), { value: i9, formattedAttributes: o3, layer: r10 } = t5, { linkURL: a7, sourceURL: s11 } = i9;
    if (s11) {
      const t6 = Q(s11, r10);
      i9.sourceURL = O2({ formattedAttributes: o3, template: t6, fieldInfoMap: e14 });
    }
    if (a7) {
      const t6 = Q(a7, r10);
      i9.linkURL = O2({ formattedAttributes: o3, template: t6, fieldInfoMap: e14 });
    }
  }
  _setChartValue(t5) {
    const { value: e14, attributes: i9, formattedAttributes: o3, chartType: r10, layer: a7, expressionAttributes: s11 } = t5, { popupTemplate: l9, relatedInfos: n15 } = this, { fields: p9, normalizeField: d10 } = e14, m8 = a7;
    e14.fields = R(p9, m8), d10 && (e14.normalizeField = M(d10, m8));
    if (!p9.some((t6) => !!(null != o3[t6] || pe(t6) && (n15 == null ? void 0 : n15.size)))) return;
    const h10 = (l9 == null ? void 0 : l9.fieldInfos) ?? [];
    p9.forEach((t6, a8) => {
      var _a;
      const l10 = (_a = e14.colors) == null ? void 0 : _a[a8];
      if (pe(t6)) return void (e14.series = [...e14.series, ...this._getRelatedChartInfos({ fieldInfos: h10, fieldName: t6, formattedAttributes: o3, chartType: r10, value: e14, color: l10 })]);
      const n16 = this._getChartOption({ value: e14, attributes: i9, chartType: r10, formattedAttributes: o3, expressionAttributes: s11, fieldName: t6, fieldInfos: h10, color: l10 });
      e14.series.push(n16);
    });
  }
  _getRelatedChartInfos(t5) {
    var _a;
    const { fieldInfos: e14, fieldName: i9, formattedAttributes: o3, chartType: r10, value: a7, color: s11 } = t5, l9 = [], n15 = h6(i9), p9 = n15 && ((_a = this.relatedInfos) == null ? void 0 : _a.get(n15.layerId.toString()));
    if (!p9) return l9;
    const { relatedFeatures: d10, relation: u9 } = p9;
    if (!u9 || !d10) return l9;
    const { cardinality: f6 } = u9;
    d10.forEach((t6) => {
      const { attributes: p10 } = t6;
      p10 && Object.keys(p10).forEach((t7) => {
        t7 === n15.fieldName && l9.push(this._getChartOption({ value: a7, attributes: p10, formattedAttributes: o3, fieldName: i9, chartType: r10, relatedFieldName: t7, hasMultipleRelatedFeatures: (d10 == null ? void 0 : d10.length) > 1, fieldInfos: e14, color: s11 }));
      });
    });
    return "one-to-many" === f6 || "many-to-many" === f6 ? l9 : [l9[0]];
  }
  _getTooltip({ label: t5, value: e14, chartType: i9 }) {
    return "pie-chart" === i9 ? `${t5}` : `${t5}: ${e14}`;
  }
  _getChartOption(t5) {
    var _a;
    const { value: e14, attributes: i9, formattedAttributes: o3, expressionAttributes: r10, fieldName: a7, relatedFieldName: n15, fieldInfos: p9, chartType: d10, hasMultipleRelatedFeatures: u9, color: I8 } = t5, v9 = this.layer, M6 = this.fieldInfoMap ?? /* @__PURE__ */ new Map(), { normalizeField: A6, tooltipField: g11 } = e14, x7 = A6 ? pe(A6) ? i9[h6(A6).fieldName] : i9[A6] : null, _3 = E(a7) && r10 && void 0 !== r10[a7] ? r10[a7] : n15 && void 0 !== i9[n15] ? i9[n15] : void 0 !== i9[a7] ? i9[a7] : o3[a7], C4 = new p2({ fieldName: a7, color: I8, value: void 0 === _3 ? null : _3 && x7 ? _3 / x7 : _3 });
    if (pe(a7)) {
      const t6 = M6.get(a7.toLowerCase()), e15 = g11 && M6.get(g11.toLowerCase()), r11 = (t6 == null ? void 0 : t6.fieldName) ?? a7, s11 = u9 && g11 ? h6(g11).fieldName : (e15 == null ? void 0 : e15.fieldName) ?? g11, l9 = u9 && s11 ? i9[s11] : o3[s11] ?? (t6 == null ? void 0 : t6.label) ?? (t6 == null ? void 0 : t6.fieldName) ?? n15, p10 = u9 && n15 ? i9[n15] : o3[r11];
      return C4.tooltip = this._getTooltip({ label: l9, value: p10, chartType: d10 }), C4;
    }
    const T7 = ee(p9, a7), N3 = M(a7, v9), F7 = g11 && void 0 !== o3[g11] ? o3[g11] : C(T7 || new n6({ fieldName: N3 }), (_a = this.popupTemplate) == null ? void 0 : _a.expressionInfos), j6 = o3[N3];
    return C4.tooltip = this._getTooltip({ label: F7, value: j6, chartType: d10 }), C4;
  }
};
r4([m()], v5.prototype, "abilities", void 0), r4([s4("abilities")], v5.prototype, "castAbilities", null), r4([m()], v5.prototype, "activeMediaInfoIndex", void 0), r4([m({ readOnly: true })], v5.prototype, "activeMediaInfo", null), r4([m()], v5.prototype, "attributes", void 0), r4([m()], v5.prototype, "description", void 0), r4([m()], v5.prototype, "fieldInfoMap", void 0), r4([m()], v5.prototype, "formattedAttributes", void 0), r4([m()], v5.prototype, "expressionAttributes", void 0), r4([m({ readOnly: true })], v5.prototype, "formattedMediaInfos", null), r4([m()], v5.prototype, "isAggregate", void 0), r4([m()], v5.prototype, "layer", void 0), r4([m({ readOnly: true })], v5.prototype, "formattedMediaInfoCount", null), r4([m()], v5.prototype, "mediaInfos", void 0), r4([m()], v5.prototype, "popupTemplate", void 0), r4([m()], v5.prototype, "relatedInfos", void 0), r4([m()], v5.prototype, "title", void 0), v5 = r4([a("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")], v5);
var M3 = v5;

// node_modules/@arcgis/core/widgets/Feature/FeatureMedia.js
var g5 = "esri-feature-media";
var v6 = { base: g5, mediaContainer: `${g5}__container`, mediaItemContainer: `${g5}__item-container`, mediaItem: `${g5}__item`, mediaItemText: `${g5}__item-text`, mediaItemTitle: `${g5}__item-title`, mediaItemCaption: `${g5}__item-caption`, mediaNavigation: `${g5}__item-navigation`, mediaPagination: `${g5}__pagination`, mediaPaginationText: `${g5}__pagination-text`, mediaPrevious: `${g5}__previous`, mediaPreviousIconLTR: `${g5}__previous-icon`, mediaPreviousIconRTL: `${g5}__previous-icon--rtl`, mediaNext: `${g5}__next`, mediaNextIconLTR: `${g5}__next-icon`, mediaNextIconRTL: `${g5}__next-icon--rtl`, mediaChart: `${g5}__chart`, mediaPaginationButton: `${g5}__pagination-button`, mediaPaginationIcon: `${g5}__pagination-icon`, mediaChartRendered: `${g5}__chart--rendered` };
var M4 = 15;
var w6 = "category";
var A5 = "value";
var I5 = "rgba(50, 50, 50, 1)";
var C2 = 250;
var y5 = 500;
var x4 = 200;
var T4 = class extends O {
  constructor(e14, t5) {
    super(e14, t5), this._refreshTimer = null, this._refreshIntervalInfo = null, this._featureElementInfo = null, this._chartRootMap = /* @__PURE__ */ new WeakMap(), this.viewModel = new M3(), this.messages = null, this._disposeChart = (e15) => {
      var _a;
      (_a = this._chartRootMap.get(e15)) == null ? void 0 : _a.dispose(), this._chartRootMap.delete(e15);
    }, this._createChart = async (e15) => {
      const { destroyed: t6, viewModel: i9 } = this;
      if (t6 || !i9 || !e15) return;
      const { createRoot: r10 } = await import("./chartUtilsAm5-R4LTGWSI.js"), a7 = await r10(e15);
      this._chartRootMap.set(e15, a7), this._renderChart({ mediaInfo: i9.activeMediaInfo, root: a7 });
    };
  }
  initialize() {
    this._featureElementInfo = new l3(), this.addHandles([d3(() => {
      var _a, _b;
      return [(_a = this.viewModel) == null ? void 0 : _a.activeMediaInfo, (_b = this.viewModel) == null ? void 0 : _b.activeMediaInfoIndex];
    }, () => this._setupMediaRefreshTimer(), P), d3(() => {
      var _a, _b;
      return [(_a = this.viewModel) == null ? void 0 : _a.description, (_b = this.viewModel) == null ? void 0 : _b.title];
    }, () => this._setupFeatureElementInfo(), P)]);
  }
  loadDependencies() {
    return c3({ icon: () => import("./calcite-icon-IDR3G5OX.js") });
  }
  destroy() {
    var _a;
    this._clearMediaRefreshTimer(), (_a = this._featureElementInfo) == null ? void 0 : _a.destroy();
  }
  get attributes() {
    return this.viewModel.attributes;
  }
  set attributes(e14) {
    this.viewModel.attributes = e14;
  }
  get activeMediaInfoIndex() {
    return this.viewModel.activeMediaInfoIndex;
  }
  set activeMediaInfoIndex(e14) {
    this.viewModel.activeMediaInfoIndex = e14;
  }
  get description() {
    return this.viewModel.description;
  }
  set description(e14) {
    this.viewModel.description = e14;
  }
  get fieldInfoMap() {
    return this.viewModel.fieldInfoMap;
  }
  set fieldInfoMap(e14) {
    this.viewModel.fieldInfoMap = e14;
  }
  get layer() {
    return this.viewModel.layer;
  }
  set layer(e14) {
    this.viewModel.layer = e14;
  }
  get mediaInfos() {
    return this.viewModel.mediaInfos;
  }
  set mediaInfos(e14) {
    this.viewModel.mediaInfos = e14;
  }
  get popupTemplate() {
    return this.viewModel.popupTemplate;
  }
  set popupTemplate(e14) {
    this.viewModel.popupTemplate = e14;
  }
  get relatedInfos() {
    return this.viewModel.relatedInfos;
  }
  set relatedInfos(e14) {
    this.viewModel.relatedInfos = e14;
  }
  get title() {
    return this.viewModel.title;
  }
  set title(e14) {
    this.viewModel.title = e14;
  }
  render() {
    var _a;
    return n2("div", { bind: this, class: v6.base, onkeyup: this._handleMediaKeyup }, (_a = this._featureElementInfo) == null ? void 0 : _a.render(), this._renderMedia());
  }
  _renderMedia() {
    const { formattedMediaInfoCount: e14, activeMediaInfoIndex: t5 } = this.viewModel, i9 = this._renderMediaText();
    return e14 ? n2("div", { class: v6.mediaContainer, key: "media-element-container" }, this._renderMediaInfo(), n2("div", { class: v6.mediaNavigation }, i9, e14 > 1 ? n2("div", { class: v6.mediaPagination }, this._renderMediaPageButton("previous"), n2("span", { class: v6.mediaPaginationText }, s3(this.messages.pageText, { index: t5 + 1, total: e14 })), this._renderMediaPageButton("next")) : null)) : null;
  }
  _renderMediaText() {
    const { activeMediaInfo: e14 } = this.viewModel;
    if (!e14) return null;
    const t5 = e14 && e14.title ? n2("div", { class: v6.mediaItemTitle, innerHTML: e14.title, key: "media-title" }) : null, i9 = e14 && e14.caption ? n2("div", { class: v6.mediaItemCaption, innerHTML: e14.caption, key: "media-caption" }) : null;
    return t5 || i9 ? n2("div", { class: v6.mediaItemText, key: "media-text" }, t5, i9) : null;
  }
  _renderImageMediaInfo(e14) {
    if (!e14.value) return null;
    const { _refreshIntervalInfo: t5 } = this, { activeMediaInfoIndex: i9, formattedMediaInfoCount: r10 } = this.viewModel, { value: a7, refreshInterval: o3, altText: s11, title: n15, type: l9 } = e14, { sourceURL: d10, linkURL: c17 } = a7, p9 = x2(c17 ?? void 0) ? "_blank" : "_self", h10 = "_blank" === p9 ? "noreferrer" : "", f6 = o3 ? t5 : null, _3 = f6 ? f6.timestamp : 0, g11 = f6 ? f6.sourceURL : d10, v9 = n2("img", { alt: s11 || n15, key: `media-${l9}-${i9}-${r10}-${_3}`, src: g11 ?? void 0 });
    return (c17 ? n2("a", { href: c17, rel: h10, target: p9, title: n15 }, v9) : null) ?? v9;
  }
  _renderChartMediaInfo(e14) {
    const { activeMediaInfoIndex: t5, formattedMediaInfoCount: i9 } = this.viewModel;
    return n2("div", { afterCreate: this._createChart, afterRemoved: this._disposeChart, bind: this, class: v6.mediaChart, key: `media-${e14.type}-${t5}-${i9}` });
  }
  _renderMediaInfoType() {
    const { activeMediaInfo: e14 } = this.viewModel;
    return e14 ? "image" === e14.type ? this._renderImageMediaInfo(e14) : e14.type.includes("chart") ? this._renderChartMediaInfo(e14) : null : null;
  }
  _renderMediaInfo() {
    const { activeMediaInfo: e14 } = this.viewModel;
    return e14 ? n2("div", { class: v6.mediaItemContainer, key: "media-container" }, n2("div", { class: v6.mediaItem, key: "media-item-container" }, this._renderMediaInfoType())) : null;
  }
  _renderMediaPageButton(e14) {
    if (this.viewModel.formattedMediaInfoCount < 2) return null;
    const t5 = "previous" === e14, i9 = t5 ? this.messages.previous : this.messages.next, r10 = t5 ? "chevron-left" : "chevron-right", a7 = t5 ? "media-previous" : "media-next", o3 = t5 ? this._previous : this._next;
    return n2("button", { "aria-label": i9, bind: this, class: v6.mediaPaginationButton, key: a7, onclick: o3, tabIndex: 0, title: i9, type: "button" }, n2("calcite-icon", { class: v6.mediaPaginationIcon, icon: r10, scale: "s" }));
  }
  _setupFeatureElementInfo() {
    var _a;
    const { description: e14, title: t5 } = this;
    (_a = this._featureElementInfo) == null ? void 0 : _a.set({ description: e14, title: t5 });
  }
  _next() {
    this.viewModel.next();
  }
  _previous() {
    this.viewModel.previous();
  }
  _getRenderer() {
    if (!this.viewModel) return;
    const { isAggregate: e14, layer: t5 } = this.viewModel;
    return e14 && (t5 == null ? void 0 : t5.featureReduction) && "renderer" in t5.featureReduction ? t5.featureReduction.renderer : t5 == null ? void 0 : t5.renderer;
  }
  async _getSeriesColors(e14) {
    const { colorAm5: t5 } = await import("./chartCommon-YIPBR3ID.js"), i9 = /* @__PURE__ */ new Map();
    return e14.forEach((e15) => {
      e15.color && i9.set(e15, t5(e15.color.toCss(true)));
    }), i9;
  }
  async _getRendererColors() {
    const { colorAm5: e14 } = await import("./chartCommon-YIPBR3ID.js"), t5 = /* @__PURE__ */ new Map(), i9 = this._getRenderer(), r10 = "default";
    if (!i9) return t5;
    const a7 = await x3(i9);
    a7.delete(r10);
    return Array.from(a7.values()).every((e15) => 1 === (e15 == null ? void 0 : e15.length)) ? (Array.from(a7.keys()).forEach((i10) => {
      var _a, _b;
      const r11 = (_b = (_a = a7.get(i10)) == null ? void 0 : _a[0]) == null ? void 0 : _b.toCss(true);
      r11 && t5.set(i10, e14(r11));
    }), t5) : t5;
  }
  _handleMediaKeyup(e14) {
    const { key: t5 } = e14;
    "ArrowLeft" === t5 && (e14.stopPropagation(), this.viewModel.previous()), "ArrowRight" === t5 && (e14.stopPropagation(), this.viewModel.next());
  }
  _canAnimateChart() {
    return !!this.viewModel && (!!this.viewModel.abilities.chartAnimation && !o());
  }
  _getChartAnimationMS() {
    return this._canAnimateChart() ? C2 : 0;
  }
  _getChartSeriesAnimationMS() {
    return this._canAnimateChart() ? y5 : 0;
  }
  async _renderChart(e14) {
    const { root: t5, mediaInfo: i9 } = e14, { value: r10, type: a7 } = i9, { ResponsiveThemeAm5: o3, DarkThemeAm5: s11, AnimatedThemeAm5: n15, ColorSetAm5: l9, ThemeAm5: d10, esriChartColorSet: m8 } = await import("./chartCommon-YIPBR3ID.js"), c17 = d10.new(t5);
    c17.rule("ColorSet").set("colors", m8), c17.rule("ColorSet").set("reuse", true);
    const p9 = [o3.new(t5), c17];
    r5() && p9.push(s11.new(t5)), this._canAnimateChart() && p9.push(n15.new(t5)), t5.setThemes(p9);
    const h10 = await this._getRendererColors(), u9 = await this._getSeriesColors(r10.series), _3 = l9.new(t5, {}), g11 = u9.get(r10.series[0]), v9 = g11 ? { lineSettings: { stroke: g11 } } : void 0, M6 = r10.series.map((e15, t6) => {
      const i10 = u9.get(e15) || h10.get(e15.fieldName) || _3.getIndex(t6);
      return { [w6]: e15.tooltip, [A5]: e15.value, columnSettings: { fill: i10, stroke: i10 }, ...v9 };
    }).filter((e15) => "pie-chart" !== a7 || null != e15.value && e15.value > 0);
    "pie-chart" === a7 ? this._createPieChart(e14, M6) : this._createXYChart(e14, M6);
  }
  _getDirection() {
    return g2(this.container) ? "rtl" : "ltr";
  }
  async _customizeChartTooltip(e14, t5 = "horizontal") {
    var _a;
    const { colorAm5: i9 } = await import("./chartCommon-YIPBR3ID.js");
    e14.setAll({ pointerOrientation: t5 }), (_a = e14.get("background")) == null ? void 0 : _a.setAll({ stroke: i9(I5) }), e14.label.setAll({ direction: this._getDirection(), oversizedBehavior: "wrap", maxWidth: x4 });
  }
  async _createPieChart(e14, t5) {
    const { TooltipAm5: i9 } = await import("./chartCommon-YIPBR3ID.js"), { PieChartAm5: r10, PieSeriesAm5: a7 } = await import("./pieChart-E23BXCUJ.js"), { mediaInfo: o3, root: s11 } = e14, { title: n15 } = o3, l9 = 5, d10 = (o3 == null ? void 0 : o3.altText) || (o3 == null ? void 0 : o3.title) || "", m8 = s11.container.children.push(r10.new(s11, { ariaLabel: d10, focusable: true, paddingBottom: l9, paddingTop: l9, paddingLeft: l9, paddingRight: l9 })), c17 = "{category}: {valuePercentTotal.formatNumber('0.00')}%\n ({value})", p9 = i9.new(s11, { labelText: c17 }), h10 = m8.series.push(a7.new(s11, { name: n15, valueField: A5, categoryField: w6, tooltip: p9 }));
    h10.ticks.template.set("forceHidden", true), h10.labels.template.set("forceHidden", true), h10.slices.template.states.create("active", { shiftRadius: l9 }), this._customizeChartTooltip(p9), h10.slices.template.setAll({ ariaLabel: c17, focusable: true, templateField: "columnSettings" }), h10.data.setAll(t5), h10.appear(this._getChartSeriesAnimationMS()), m8.appear(this._getChartAnimationMS()), m8.root.dom.classList.toggle(v6.mediaChartRendered, true);
  }
  _getMinSeriesValue(e14) {
    let t5 = 0;
    return e14.forEach((e15) => t5 = Math.min(e15.value, t5)), t5;
  }
  async _createColumnChart(e14, t5, i9) {
    const { TooltipAm5: r10, ScrollbarAm5: a7 } = await import("./chartCommon-YIPBR3ID.js"), { CategoryAxisAm5: o3, AxisRendererXAm5: s11, ValueAxisAm5: n15, AxisRendererYAm5: l9, ColumnSeriesAm5: d10 } = await import("./xyChart-XMTSMX2Q.js"), { mediaInfo: m8, root: c17 } = t5, { value: h10, title: u9 } = m8;
    e14.setAll({ wheelX: "panX", wheelY: "zoomX" });
    const f6 = e14.xAxes.push(o3.new(c17, { renderer: s11.new(c17, { inversed: g2(this.container) }), categoryField: w6 }));
    f6.get("renderer").labels.template.setAll({ forceHidden: true });
    const _3 = e14.yAxes.push(n15.new(c17, { renderer: l9.new(c17, { inside: false }), min: this._getMinSeriesValue(h10.series) }));
    _3.get("renderer").labels.template.setAll({ direction: this._getDirection() });
    const g11 = "{categoryX}", v9 = r10.new(c17, { labelText: g11 }), I8 = e14.series.push(d10.new(c17, { name: u9, xAxis: f6, yAxis: _3, valueYField: A5, categoryXField: w6, tooltip: v9 }));
    this._customizeChartTooltip(v9), I8.columns.template.setAll({ ariaLabel: g11, focusable: true, templateField: "columnSettings" }), h10.series.length > M4 && e14.set("scrollbarX", a7.new(c17, { orientation: "horizontal" })), f6.data.setAll(i9), I8.data.setAll(i9), I8.appear(this._getChartSeriesAnimationMS()), e14.appear(this._getChartAnimationMS());
  }
  async _createBarChart(e14, t5, i9) {
    const { TooltipAm5: r10, ScrollbarAm5: a7 } = await import("./chartCommon-YIPBR3ID.js"), { CategoryAxisAm5: o3, AxisRendererXAm5: s11, ValueAxisAm5: n15, AxisRendererYAm5: l9, ColumnSeriesAm5: d10 } = await import("./xyChart-XMTSMX2Q.js"), { mediaInfo: m8, root: c17 } = t5, { value: h10, title: u9 } = m8;
    e14.setAll({ wheelX: "panY", wheelY: "zoomY" });
    const f6 = e14.yAxes.push(o3.new(c17, { renderer: l9.new(c17, { inversed: true }), categoryField: w6 }));
    f6.get("renderer").labels.template.setAll({ forceHidden: true });
    const _3 = e14.xAxes.push(n15.new(c17, { renderer: s11.new(c17, { inside: false, inversed: g2(this.container) }), min: this._getMinSeriesValue(h10.series) }));
    _3.get("renderer").labels.template.setAll({ direction: this._getDirection() });
    const g11 = "{categoryY}", v9 = r10.new(c17, { labelText: g11 }), I8 = e14.series.push(d10.new(c17, { name: u9, xAxis: _3, yAxis: f6, valueXField: A5, categoryYField: w6, tooltip: v9 }));
    this._customizeChartTooltip(v9, "vertical"), I8.columns.template.setAll({ ariaLabel: g11, focusable: true, templateField: "columnSettings" }), h10.series.length > M4 && e14.set("scrollbarY", a7.new(c17, { orientation: "vertical" })), f6.data.setAll(i9), I8.data.setAll(i9), I8.appear(this._getChartSeriesAnimationMS()), e14.appear(this._getChartAnimationMS());
  }
  async _createLineChart(e14, t5, i9) {
    var _a, _b, _c;
    const { TooltipAm5: r10, ScrollbarAm5: a7 } = await import("./chartCommon-YIPBR3ID.js"), { CategoryAxisAm5: o3, AxisRendererXAm5: s11, ValueAxisAm5: n15, AxisRendererYAm5: l9, LineSeriesAm5: d10 } = await import("./xyChart-XMTSMX2Q.js"), { root: m8, mediaInfo: c17 } = t5, { value: h10, title: u9 } = c17;
    e14.setAll({ wheelX: "panX", wheelY: "zoomX" });
    const f6 = e14.xAxes.push(o3.new(m8, { renderer: s11.new(m8, { inversed: g2(this.container) }), categoryField: w6 }));
    f6.get("renderer").labels.template.setAll({ forceHidden: true });
    const _3 = e14.yAxes.push(n15.new(m8, { renderer: l9.new(m8, { inside: false }), min: this._getMinSeriesValue(h10.series) }));
    _3.get("renderer").labels.template.setAll({ direction: this._getDirection() });
    const g11 = "{categoryX}", v9 = (_b = (_a = i9[0]) == null ? void 0 : _a.lineSettings) == null ? void 0 : _b.stroke, I8 = r10.new(m8, { getFillFromSprite: !v9, labelText: g11 });
    v9 && ((_c = I8.get("background")) == null ? void 0 : _c.setAll({ fill: v9 }));
    const C4 = e14.series.push(d10.new(m8, { name: u9, xAxis: f6, yAxis: _3, valueYField: A5, categoryXField: w6, tooltip: I8 }));
    C4.strokes.template.setAll({ templateField: "lineSettings" }), this._customizeChartTooltip(I8, "vertical"), h10.series.length > M4 && e14.set("scrollbarX", a7.new(m8, { orientation: "horizontal" })), f6.data.setAll(i9), C4.data.setAll(i9), C4.appear(this._getChartSeriesAnimationMS()), e14.appear(this._getChartAnimationMS());
  }
  async _createXYChart(e14, t5) {
    const { XYChartAm5: i9, XYCursorAm5: r10 } = await import("./xyChart-XMTSMX2Q.js"), { root: a7, mediaInfo: o3 } = e14, { type: s11 } = o3, n15 = (o3 == null ? void 0 : o3.altText) || (o3 == null ? void 0 : o3.title) || "", l9 = a7.container.children.push(i9.new(a7, { ariaLabel: n15, focusable: true, panX: true, panY: true }));
    l9.set("cursor", r10.new(a7, {})), "column-chart" === s11 && await this._createColumnChart(l9, e14, t5), "bar-chart" === s11 && await this._createBarChart(l9, e14, t5), "line-chart" === s11 && await this._createLineChart(l9, e14, t5), l9.root.dom.classList.toggle(v6.mediaChartRendered, true);
  }
  _clearMediaRefreshTimer() {
    const { _refreshTimer: e14 } = this;
    e14 && (clearTimeout(e14), this._refreshTimer = null);
  }
  _updateMediaInfoTimestamp(e14) {
    const t5 = Date.now();
    this._refreshIntervalInfo = { timestamp: t5, sourceURL: e14 && this._getImageSource(e14, t5) };
  }
  _setupMediaRefreshTimer() {
    this._clearMediaRefreshTimer();
    const { activeMediaInfo: e14 } = this.viewModel;
    "image" === (e14 == null ? void 0 : e14.type) && (e14 == null ? void 0 : e14.refreshInterval) > 0 && this._setRefreshTimeout(e14);
  }
  _setRefreshTimeout(e14) {
    const { refreshInterval: t5, value: i9 } = e14, r10 = 6e4 * t5;
    this._updateMediaInfoTimestamp(i9.sourceURL);
    const a7 = setInterval(() => {
      this._updateMediaInfoTimestamp(i9.sourceURL);
    }, r10);
    this._refreshTimer = a7;
  }
  _getImageSource(e14, t5) {
    const i9 = e14.includes("?") ? "&" : "?", [r10, a7 = ""] = e14.split("#");
    return `${r10}${i9}timestamp=${t5}${a7 ? "#" : ""}${a7}`;
  }
};
r4([m()], T4.prototype, "_refreshIntervalInfo", void 0), r4([m()], T4.prototype, "attributes", null), r4([m()], T4.prototype, "activeMediaInfoIndex", null), r4([m()], T4.prototype, "description", null), r4([m()], T4.prototype, "fieldInfoMap", null), r4([m()], T4.prototype, "layer", null), r4([m()], T4.prototype, "mediaInfos", null), r4([m()], T4.prototype, "popupTemplate", null), r4([m()], T4.prototype, "relatedInfos", null), r4([m()], T4.prototype, "title", null), r4([m({ type: M3 })], T4.prototype, "viewModel", void 0), r4([m(), e3("esri/widgets/Feature/t9n/Feature")], T4.prototype, "messages", void 0), T4 = r4([a("esri.widgets.Feature.FeatureMedia")], T4);
var b6 = T4;

// node_modules/@arcgis/core/core/throttle.js
function e9(e14, t5, l9, n15) {
  let o3 = null, p9 = 1e3;
  "number" == typeof t5 ? (p9 = t5, n15 = l9) : (o3 = t5 ?? null, p9 = l9);
  let r10, u9 = 0;
  const a7 = () => {
    u9 = 0, e14.apply(n15, r10);
  }, c17 = (...e15) => {
    o3 && o3.apply(n15, e15), r10 = e15, p9 ? u9 || (u9 = setTimeout(a7, p9)) : a7();
  };
  return c17.remove = () => {
    u9 && (clearTimeout(u9), u9 = 0);
  }, c17.forceUpdate = () => {
    u9 && (clearTimeout(u9), a7());
  }, c17.hasPendingUpdates = () => !!u9, c17;
}

// node_modules/@arcgis/core/widgets/Feature/support/arcadeFeatureUtils.js
var o2 = "esri.widgets.Feature.support.arcadeFeatureUtils";
var i7 = () => n.getLogger(o2);
function c15(e14) {
  return "string" == typeof e14 ? le(ae(e14)) : Array.isArray(e14) ? p8(e14) : "esri.arcade.Dictionary" === (e14 == null ? void 0 : e14.declaredClass) ? u5(e14) : e14;
}
function p8(e14) {
  return `<ul class="esri-widget__list">${e14.map((e15) => `<li>${"string" == typeof e15 ? le(ae(e15)) : e15}</li>`).join("")}</ul>`;
}
function u5(e14) {
  const r10 = e14.keys().map((r11) => {
    const t5 = e14.field(r11);
    return `<tr><th>${r11}</th><td>${"string" == typeof t5 ? le(ae(t5)) : t5}</td></tr>`;
  }).join("");
  return `<table class="${e4.table}">${r10}</table>`;
}
async function l6() {
  const [e14, r10] = await Promise.all([import("./arcade-TSPLVDUI.js"), import("./arcade-GYMZPEV4.js")]);
  return { executor: e14, syntaxUtils: r10 };
}
function d8(e14) {
  return "createQuery" in e14 && "queryFeatures" in e14;
}
async function y6({ graphic: e14, view: r10, options: t5 }) {
  const { isAggregate: a7, layer: n15 } = e14;
  if (!a7 || !n15 || "2d" !== (r10 == null ? void 0 : r10.type)) return [];
  const s11 = await r10.whenLayerView(n15);
  if (!d8(s11)) return [];
  const o3 = s11.createQuery(), i9 = e14.getObjectId();
  o3.aggregateIds = null != i9 ? [i9] : [];
  const { features: c17 } = await s11.queryFeatures(o3, t5);
  return c17;
}
function f2({ layer: e14, aggregatedFeatures: r10, interceptor: a7 }) {
  const { fields: n15, objectIdField: s11, geometryType: o3, spatialReference: i9, displayField: c17 } = e14;
  return new Ye({ fields: n15, objectIdField: s11, geometryType: o3, spatialReference: i9, displayField: c17, interceptor: a7, ..."feature" === e14.type ? { templates: e14.templates, typeIdField: e14.typeIdField, types: e14.types } : null, source: r10 });
}
function g6(e14) {
  const r10 = "esri.views.3d.layers.VoxelGraphic" === e14.declaredClass;
  return e14.isAggregate ? "popup-feature-reduction" : r10 ? "popup-voxel" : "popup";
}
function w7(e14) {
  var _a, _b;
  return { scale: e14 == null ? void 0 : e14.scale, timeProperties: { currentStart: (_a = e14 == null ? void 0 : e14.timeExtent) == null ? void 0 : _a.start, currentEnd: (_b = e14 == null ? void 0 : e14.timeExtent) == null ? void 0 : _b.end, startIncluded: true, endIncluded: true } };
}
function m5(e14) {
  return { $voxel: e14 };
}
async function x5(e14, r10, t5, a7, n15) {
  let s11 = null;
  if (n15.has("$aggregatedfeatures")) {
    const n16 = await y6({ graphic: e14, view: r10, options: t5 }), o3 = e14.sourceLayer || e14.layer;
    s11 = f2({ layer: o3, aggregatedFeatures: n16, interceptor: a7 });
  }
  return { vars: { $feature: e14, $aggregatedFeatures: s11, $view: w7(r10) }, [Symbol.dispose]: () => s11 == null ? void 0 : s11[Symbol.dispose]() };
}
function v7(r10, t5, a7, n15) {
  var _a;
  const s11 = (r10.sourceLayer || r10.layer) ?? void 0;
  return { $feature: r10, $layer: null != s11 && x(s11) ? s11 : "scene" === (s11 == null ? void 0 : s11.type) && null != s11.associatedLayer ? s11.associatedLayer : void 0, $map: t5, $datastore: s11 == null ? void 0 : s11.url, $userInput: a7, $graph: "knowledge-graph-sublayer" === (s11 == null ? void 0 : s11.type) ? (_a = s11 == null ? void 0 : s11.parentCompositeLayer) == null ? void 0 : _a.knowledgeGraph : void 0, $view: w7(n15) };
}
async function h7(e14, { graphic: r10, map: t5, location: a7, view: n15, options: s11, interceptor: o3, arcadeExecutor: i9 }) {
  switch (e14) {
    case "popup":
      return { vars: v7(r10, t5, a7, n15), [Symbol.dispose]() {
      } };
    case "popup-feature-reduction": {
      const e15 = new Set(i9.variablesUsed);
      return await x5(r10, n15, s11, o3, e15);
    }
    case "popup-voxel":
      return { vars: m5(r10), [Symbol.dispose]() {
      } };
    default:
      throw new Error(`Unexpected profile name ${e14}`);
  }
}
async function $3({ expressionInfo: e14, arcade: { executor: r10, syntaxUtils: t5 }, graphic: a7 }) {
  const n15 = e14 == null ? void 0 : e14.expression;
  if (!n15) return null;
  const s11 = g6(a7), o3 = r10.createArcadeProfile(s11);
  let c17;
  try {
    c17 = await r10.createArcadeExecutor(n15, o3);
  } catch (u9) {
    return i7().error("arcade-executor-error", { error: u9, expressionInfo: e14 }), null;
  }
  const p9 = /* @__PURE__ */ new Set();
  return c17.variablesUsed.includes("$view") && (t5.scriptUsesViewProperties(c17.syntaxTree, ["scale"]) && p9.add("view-scale"), t5.scriptUsesViewProperties(c17.syntaxTree, ["timeProperties"]) && p9.add("view-time-extent")), { dependencies: p9, async evaluate({ graphic: r11, interceptor: t6, location: a8, map: n16, options: o4, spatialReference: p10, view: l9 }) {
    const d10 = await h7(s11, { graphic: r11, map: n16, location: a8, view: l9, options: o4, interceptor: t6, arcadeExecutor: c17 }), y10 = { abortSignal: (o4 == null ? void 0 : o4.signal) ?? void 0, interceptor: t6 ?? void 0, rawOutput: true, spatialReference: p10 ?? void 0, timeZone: l9 == null ? void 0 : l9.timeZone, console(...e15) {
      i7().info(...e15);
    } };
    try {
      return await c17.executeAsync(d10.vars, y10);
    } catch (u9) {
      return void i7().error("arcade-execution-error", { error: u9, graphic: r11, expressionInfo: e14 });
    } finally {
      d10[Symbol.dispose]();
    }
  } };
}
async function b7(e14, r10) {
  if (!(e14 == null ? void 0 : e14.length)) return { dependencies: /* @__PURE__ */ new Set(), expressions: /* @__PURE__ */ new Map() };
  const t5 = await l6(), a7 = /* @__PURE__ */ new Set(), n15 = /* @__PURE__ */ new Map();
  for (const s11 of e14) {
    const e15 = await $3({ expressionInfo: s11, arcade: t5, graphic: r10 });
    n15.set(`expression/${s11.name}`, e15), e15 == null ? void 0 : e15.dependencies.forEach((e16) => a7.add(e16));
  }
  return { dependencies: a7, expressions: n15 };
}

// node_modules/@arcgis/core/widgets/Feature/FeatureExpression/FeatureExpressionViewModel.js
var k4 = 1;
var g7 = class extends g {
  constructor(t5) {
    super(t5), this._compileTask = null, this._evaluateTask = null, this.expressionInfo = null, this.graphic = null, this.contentElementViewModel = null, this.interceptor = null, this.location = null, this.view = null, this._createVM = () => {
      var _a, _b;
      const t6 = (_a = this.contentElement) == null ? void 0 : _a.type;
      (_b = this.contentElementViewModel) == null ? void 0 : _b.destroy();
      const e14 = "fields" === t6 ? new n10() : "media" === t6 ? new M3() : "text" === t6 ? new p5() : null;
      this._set("contentElementViewModel", e14);
    }, this._compileThrottled = e9(this._startCompile, () => this.notifyChange("state"), k4, this), this._evaluateThrottled = e9(this._startEvaluate, () => this.notifyChange("state"), k4, this), this.addHandles([d3(() => [this.expressionInfo, this.graphic], () => this._compileThrottled(), P), d3(() => [this.contentElement], () => this._createVM(), P), p(() => {
      var _a, _b, _c, _d, _e2, _f;
      if (!((_a = this._compileTask) == null ? void 0 : _a.finished)) return null;
      const t6 = this._compileTask.value, e14 = t6 == null ? void 0 : t6.dependencies;
      return [t6, this.spatialReference, this.map, this.view, (e14 == null ? void 0 : e14.has("view-scale")) ? (_b = this.view) == null ? void 0 : _b.scale : null, (e14 == null ? void 0 : e14.has("view-time-extent")) ? (_d = (_c = this.view) == null ? void 0 : _c.timeExtent) == null ? void 0 : _d.start : null, (e14 == null ? void 0 : e14.has("view-time-extent")) ? (_f = (_e2 = this.view) == null ? void 0 : _e2.timeExtent) == null ? void 0 : _f.end : null];
    }, ([t6]) => this._evaluateThrottled(t6))]);
  }
  initialize() {
    this.addHandles([this._compileThrottled, this._evaluateThrottled]);
  }
  destroy() {
    var _a;
    this._compileTask = e(this._compileTask), this._evaluateTask = e(this._evaluateTask), (_a = this.contentElementViewModel) == null ? void 0 : _a.destroy(), this._set("contentElementViewModel", null);
  }
  get contentElement() {
    var _a;
    return (_a = this._evaluateTask) == null ? void 0 : _a.value;
  }
  get spatialReference() {
    var _a;
    return ((_a = this.view) == null ? void 0 : _a.spatialReference) ?? null;
  }
  set spatialReference(t5) {
    this._override("spatialReference", t5);
  }
  get state() {
    var _a, _b;
    const { contentElement: t5, contentElementViewModel: e14 } = this;
    return this._compileThrottled.hasPendingUpdates() || this._evaluateThrottled.hasPendingUpdates() || !((_a = this._compileTask) == null ? void 0 : _a.finished) || !((_b = this._evaluateTask) == null ? void 0 : _b.finished) ? "loading" : t5 || e14 ? "ready" : "disabled";
  }
  get map() {
    var _a;
    return ((_a = this.view) == null ? void 0 : _a.map) ?? null;
  }
  set map(t5) {
    this._override("map", t5);
  }
  _startCompile() {
    this._evaluateTask = e(this._evaluateTask), this._compileTask = e(this._compileTask), this._compileTask = d2(async (t5) => {
      const { expressionInfo: e14, graphic: o3 } = this;
      if (!e14 || !o3) return null;
      const s11 = await l6();
      s2(t5);
      const i9 = await $3({ expressionInfo: e14, arcade: s11, graphic: o3 });
      return s2(t5), i9;
    });
  }
  _startEvaluate(t5) {
    this._evaluateTask = e(this._evaluateTask), this._evaluateTask = d2(async (e14) => {
      const { graphic: o3 } = this;
      if (!t5 || !o3) return null;
      const { interceptor: s11, spatialReference: i9, map: r10, location: a7, view: l9 } = this, p9 = await t5.evaluate({ graphic: o3, interceptor: s11, location: a7, map: r10, options: { signal: e14 }, spatialReference: i9, view: l9 });
      s2(e14);
      const c17 = p9;
      if (!c17 || "esri.arcade.Dictionary" !== c17.declaredClass) return null;
      const m8 = await c17.castAsJsonAsync(e14);
      s2(e14);
      const h10 = m8 == null ? void 0 : m8.type, v9 = "media" === h10 ? I.fromJSON(m8) : "text" === h10 ? c5.fromJSON(m8) : "fields" === h10 ? d5.fromJSON(m8) : null;
      return "media" === v9.type && !v9.mediaInfos || "fields" === v9.type && !v9.fieldInfos || "text" === v9.type && !v9.text ? null : v9;
    });
  }
};
r4([m()], g7.prototype, "_compileTask", void 0), r4([m()], g7.prototype, "_evaluateTask", void 0), r4([m({ type: i2 })], g7.prototype, "expressionInfo", void 0), r4([m({ type: b3 })], g7.prototype, "graphic", void 0), r4([m({ readOnly: true })], g7.prototype, "contentElement", null), r4([m({ readOnly: true })], g7.prototype, "contentElementViewModel", void 0), r4([m()], g7.prototype, "interceptor", void 0), r4([m({ type: j2 })], g7.prototype, "location", void 0), r4([m()], g7.prototype, "spatialReference", null), r4([m({ readOnly: true })], g7.prototype, "state", null), r4([m()], g7.prototype, "map", null), r4([m()], g7.prototype, "view", void 0), g7 = r4([a("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")], g7);
var E3 = g7;

// node_modules/@arcgis/core/widgets/Feature/FeatureExpression.js
var m6 = "esri-feature";
var u6 = { base: `${m6}-expression`, loadingSpinnerContainer: `${m6}__loading-container` };
var g8 = class extends O {
  constructor(e14, t5) {
    super(e14, t5), this._contentWidget = null, this.viewModel = new E3();
  }
  initialize() {
    this.addHandles(d3(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.contentElementViewModel;
    }, () => this._setupExpressionWidget(), P));
  }
  loadDependencies() {
    return c3({ loader: () => import("./calcite-loader-JLWU6EVT.js") });
  }
  destroy() {
    this._destroyContentWidget();
  }
  render() {
    var _a;
    const { state: e14 } = this.viewModel;
    return n2("div", { class: u6.base }, "loading" === e14 ? this._renderLoading() : "disabled" === e14 ? null : (_a = this._contentWidget) == null ? void 0 : _a.render());
  }
  _renderLoading() {
    return n2("div", { class: u6.loadingSpinnerContainer, key: "loading-container" }, n2("calcite-loader", { inline: true, label: "" }));
  }
  _destroyContentWidget() {
    const { _contentWidget: e14 } = this;
    e14 && (e14.viewModel = null, e14.destroy()), this._contentWidget = null;
  }
  _setupExpressionWidget() {
    const { contentElementViewModel: e14, contentElement: t5 } = this.viewModel, o3 = t5 == null ? void 0 : t5.type;
    this._destroyContentWidget();
    const s11 = e14 ? "fields" === o3 ? new h5({ viewModel: e14 }) : "media" === o3 ? new b6({ viewModel: e14 }) : "text" === o3 ? new p6({ viewModel: e14 }) : null : null;
    this._contentWidget = s11, this.scheduleRender();
  }
};
r4([m({ type: E3 })], g8.prototype, "viewModel", void 0), g8 = r4([a("esri.widgets.Feature.FeatureExpression")], g8);
var h8 = g8;

// node_modules/@arcgis/core/widgets/support/forms/formUtils.js
var i8;
var u8;
!function(t5) {
  t5.Text = "text", t5.Number = "number", t5.Date = "date", t5.Unsupported = "unsupported";
}(i8 || (i8 = {})), function(t5) {
  t5.CANNOT_BE_EMPTY = "input-validation-error::cannot-be-empty", t5.TOO_SHORT = "length-validation-error::too-short", t5.TOO_LONG = "length-validation-error::too-long";
}(u8 || (u8 = {}));

// node_modules/@arcgis/core/widgets/FeatureForm/featureFormUtils.js
var K2 = (e14) => {
  var _a;
  const t5 = [];
  if (e14.formTemplate) {
    const { description: r10, title: n15 } = e14.formTemplate;
    (_a = e14.fields) == null ? void 0 : _a.forEach((e15) => {
      const i9 = n15 && i(n15, e15.name), s11 = r10 && i(r10, e15.name);
      (i9 || s11) && t5.push(e15.name);
    });
  }
  return t5;
};

// node_modules/@arcgis/core/widgets/Feature/FeatureRelationship/FeatureRelationshipViewModel.js
var F4 = 100;
var _2 = class extends a2.ClonableMixin(n4.IdentifiableMixin(g)) {
  constructor(e14) {
    super(e14), this._loaded = false, this._queryAbortController = null, this._queryPageAbortController = null, this._queryFeatureCountAbortController = null, this.featuresPerPage = 10, this.activeCategory = null, this.allCategories = null, this.description = null, this.graphic = null, this.layer = null, this.map = null, this.orderByFields = null, this.featureCount = 0, this.relationshipId = null, this.showAllEnabled = false, this.title = null, this._cancelQuery = () => {
      const { _queryAbortController: e15 } = this;
      e15 && e15.abort(), this._queryAbortController = null;
    }, this._cancelQueryFeatureCount = () => {
      const { _queryFeatureCountAbortController: e15 } = this;
      e15 && e15.abort(), this._queryFeatureCountAbortController = null;
    }, this._cancelQueryPage = () => {
      const { _queryPageAbortController: e15 } = this;
      e15 && e15.abort(), this._queryPageAbortController = null;
    }, this._queryController = async () => {
      this._cancelQuery();
      const e15 = new AbortController();
      this._queryAbortController = e15, await d(this._query()), this._queryAbortController === e15 && (this._queryAbortController = null);
    }, this._queryFeatureCountController = async () => {
      this._loaded = false, this._cancelQueryFeatureCount();
      const e15 = new AbortController();
      this._queryFeatureCountAbortController = e15, await d(this._queryFeatureCount()), this._queryFeatureCountAbortController === e15 && (this._queryFeatureCountAbortController = null), this._loaded = true;
    }, this._queryPageController = async () => {
      const e15 = new AbortController();
      this._queryPageAbortController = e15, await d(this._queryPage()), this._queryPageAbortController === e15 && (this._queryPageAbortController = null);
    }, this._queryDebounced = k(this._queryController, F4), this._queryFeatureCountDebounced = k(this._queryFeatureCountController, F4), this._queryPageDebounced = k(this._queryPageController, F4), this._query = async () => {
      var _a;
      const { _queryAbortController: e15, relatedFeatures: t5 } = this;
      this.featureCount && ("subtype-group" !== ((_a = this.relatedLayer) == null ? void 0 : _a.type) || this.activeCategory) && (this._destroyRelatedFeatureViewModels(), this.featurePage = 1, t5.destroyAll(), this.destroyed || t5.addMany(this._sliceFeatures(await this._queryRelatedFeatures({ signal: e15 == null ? void 0 : e15.signal }))));
    }, this.addHandles([d3(() => {
      var _a;
      return [this.displayCount, this.graphic, this.layer, (_a = this.layer) == null ? void 0 : _a.loaded, this.map, this.orderByFields, this.relationshipId, this.featuresPerPage, this.showAllEnabled, this.canQuery, this.featureCount, this.activeCategory];
    }, () => this._queryDebounced(), P), d3(() => [this.featurePage, this.showAllEnabled], () => this._queryPageDebounced()), d3(() => [this.layer, this.relationshipId, this.objectId, this.canQuery, this.activeCategory], () => this._queryFeatureCountDebounced())]);
  }
  destroy() {
    this._destroyRelatedFeatureViewModels(), this.relatedFeatures.destroyAll(), this._cancelQuery(), this._cancelQueryFeatureCount(), this._cancelQueryPage();
  }
  set featurePage(e14) {
    const { featuresPerPage: t5, featureCount: r10 } = this, o3 = 1, l9 = Math.ceil(r10 / t5) || 1;
    this._set("featurePage", Math.min(Math.max(e14, o3), l9));
  }
  get featurePage() {
    return this._get("featurePage");
  }
  get orderByFieldsFixedCasing() {
    const { orderByFields: e14, relatedLayer: t5 } = this;
    return e14 && (t5 == null ? void 0 : t5.loaded) ? e14.map((e15) => {
      const r10 = e15.clone();
      return r10.field = M(e15.field, t5), r10;
    }) : e14 ?? [];
  }
  get supportsCacheHint() {
    var _a, _b, _c;
    return !!((_c = (_b = (_a = this.layer) == null ? void 0 : _a.capabilities) == null ? void 0 : _b.queryRelated) == null ? void 0 : _c.supportsCacheHint);
  }
  get canLoad() {
    return !!this.map && null != this.relationshipId && "number" == typeof this.objectId;
  }
  get canQuery() {
    var _a, _b;
    const e14 = (_b = (_a = this.layer) == null ? void 0 : _a.capabilities) == null ? void 0 : _b.queryRelated;
    return !!(this.relatedLayer && this.relationship && null != this.relationshipId && null != this.objectId && (e14 == null ? void 0 : e14.supportsCount) && (e14 == null ? void 0 : e14.supportsPagination));
  }
  get allCategoriesCount() {
    var _a;
    return ((_a = this.allCategories) == null ? void 0 : _a.length) ?? 0;
  }
  get categories() {
    const { allCategories: e14 } = this;
    return this.showAllEnabled ? e14 : (e14 == null ? void 0 : e14.slice(0, this.displayCount)) ?? null;
  }
  set displayCount(e14) {
    const t5 = 0, r10 = 10, o3 = 3;
    this._set("displayCount", Math.min(Math.max(e14 ?? o3, t5), r10));
  }
  get displayCount() {
    return this._get("displayCount");
  }
  get itemDescriptionFieldName() {
    var _a;
    return ((_a = this.orderByFieldsFixedCasing[0]) == null ? void 0 : _a.field) || null;
  }
  get objectId() {
    var _a, _b;
    return (this.objectIdField && ((_b = (_a = this.graphic) == null ? void 0 : _a.attributes) == null ? void 0 : _b[this.objectIdField])) ?? null;
  }
  get objectIdField() {
    var _a;
    return ((_a = this.layer) == null ? void 0 : _a.objectIdField) || null;
  }
  get relatedFeatures() {
    return this._get("relatedFeatures") || new V();
  }
  get relatedLayer() {
    const { layer: e14, map: t5, relationship: r10 } = this;
    if (!(e14 == null ? void 0 : e14.loaded) || !t5 || !r10) return null;
    const o3 = "subtype-sublayer" === e14.type && e14.parent && J(e14.parent) ? e14.parent : e14;
    return Te(t5, o3, r10) ?? null;
  }
  get relatedLayerKeyField() {
    var _a, _b;
    const { relatedLayer: e14, relationshipId: t5 } = this;
    return (e14 == null ? void 0 : e14.loaded) && null != t5 ? (_b = (_a = e14.relationships) == null ? void 0 : _a.find((e15) => e15.id === t5)) == null ? void 0 : _b.keyField : null;
  }
  get relatedLayerKeyFields() {
    var _a;
    const { relatedLayer: e14 } = this;
    return (e14 == null ? void 0 : e14.loaded) ? ((_a = e14.relationships) == null ? void 0 : _a.map((e15) => e15.keyField).filter(G)) ?? [] : [];
  }
  get relationship() {
    var _a;
    const { relationshipId: e14, layer: t5 } = this;
    return null != e14 && (t5 == null ? void 0 : t5.loaded) ? ((_a = t5.relationships) == null ? void 0 : _a.find(({ id: t6 }) => t6 === e14)) ?? null : null;
  }
  get relationshipKey() {
    var _a, _b;
    const { relationshipKeyField: e14 } = this;
    return (e14 && ((_b = (_a = this.graphic) == null ? void 0 : _a.attributes) == null ? void 0 : _b[e14])) ?? null;
  }
  get relationshipKeyField() {
    var _a;
    return ((_a = this.relationship) == null ? void 0 : _a.keyField) || null;
  }
  get relatedFeatureViewModels() {
    return this._get("relatedFeatureViewModels") || new V();
  }
  get state() {
    const { _queryAbortController: e14, _queryFeatureCountAbortController: t5, _queryPageAbortController: r10, canQuery: o3, _loaded: l9, canLoad: a7 } = this;
    return t5 || a7 && !l9 ? "loading" : e14 || r10 ? "querying" : o3 ? "ready" : "disabled";
  }
  getRelatedFeatureByObjectId(e14) {
    return this.relatedFeatures.find((t5) => t5.getObjectId() === e14);
  }
  refresh() {
    this._queryFeatureCountDebounced();
  }
  _destroyRelatedFeatureViewModels() {
    var _a;
    (_a = this.relatedFeatureViewModels) == null ? void 0 : _a.destroyAll();
  }
  async _queryFeatureCount() {
    const { layer: e14, relatedLayer: t5 } = this;
    await (e14 == null ? void 0 : e14.load()), await (t5 == null ? void 0 : t5.load());
    const { _queryFeatureCountAbortController: r10, activeCategory: l9, canQuery: a7, objectId: i9, relatedLayerKeyField: s11, relationshipId: n15, relationshipKey: u9, supportsCacheHint: d10 } = this;
    if (!a7 || !e14 || !t5 || null == i9) return this._set("featureCount", 0), void this._set("allCategories", null);
    if ("subtype-group" === (t5 == null ? void 0 : t5.type) && !l9) {
      if (this._set("featureCount", 0), this._destroyRelatedFeatureViewModels(), this.featurePage = 1, this.relatedFeatures.destroyAll(), s11 && null != u9) {
        const { default: e15 } = await import("./uniqueValues-WXFI7TSR.js"), { uniqueValueInfos: l10 } = await e15({ layer: t5, sqlWhere: `${s11} = '${u9}'`, field: t5.subtypeField, signal: r10 == null ? void 0 : r10.signal }), a8 = l10.map(({ count: e16, value: r11 }) => {
          var _a, _b;
          const o3 = (_b = (_a = t5.subtypes) == null ? void 0 : _a.find((e17) => e17.code === r11)) == null ? void 0 : _b.name;
          return null != r11 && o3 ? { count: e16, value: r11, name: o3 } : void 0;
        }).filter(G);
        this._set("allCategories", a8);
      }
      return;
    }
    const { historicMoment: y10, gdbVersion: h10 } = e14, c17 = new d4({ cacheHint: d10, gdbVersion: h10, historicMoment: y10, relationshipId: n15, returnGeometry: false, objectIds: [i9], where: this._getRelationshipWhereClause(t5) }), g11 = await e14.queryRelatedFeaturesCount(c17, { signal: r10 == null ? void 0 : r10.signal });
    this._set("allCategories", null), this._set("featureCount", g11[i9] || 0);
  }
  _getRelationshipWhereClause(e14) {
    const { activeCategory: t5 } = this, r10 = e14.createQuery(), o3 = "subtypeField" in e14 ? e14.subtypeField : void 0, l9 = t5 && o3 ? `${o3} = ${t5.value}` : void 0, a7 = r10.where;
    return a7 && l9 ? `(${a7}) AND (${l9})` : a7 ?? l9;
  }
  _sliceFeatures(e14) {
    const { showAllEnabled: t5, displayCount: r10 } = this;
    return t5 ? e14 : r10 ? e14.slice(0, r10) : [];
  }
  async _queryPage() {
    var _a;
    const { relatedFeatures: e14, featurePage: t5, showAllEnabled: r10, _queryPageAbortController: o3, featureCount: l9 } = this;
    !r10 || t5 < 2 || !l9 || "subtype-group" === ((_a = this.relatedLayer) == null ? void 0 : _a.type) && !this.activeCategory || e14.addMany(await this._queryRelatedFeatures({ signal: o3 == null ? void 0 : o3.signal }));
  }
  async _queryRelatedFeatures(e14) {
    var _a;
    const { displayCount: t5, featureCount: r10, featurePage: o3, featuresPerPage: l9, layer: a7, orderByFieldsFixedCasing: i9, relatedLayer: s11, relatedLayerKeyFields: n15, relationshipId: u9, showAllEnabled: d10, supportsCacheHint: y10 } = this, { canQuery: h10, objectId: c17 } = this;
    if (!h10 || !a7 || !s11 || null == c17) return [];
    const g11 = d10 ? ((o3 - 1) * l9 + r10) % r10 : 0, C4 = d10 ? l9 : t5, F7 = s11.objectIdField, _3 = "subtypeField" in s11 ? s11.subtypeField : void 0, m8 = [...i9.map((e15) => e15.field), ...K2(s11), ...n15, F7, _3].filter(f4), q3 = i9.map((e15) => `${e15.field} ${e15.order}`), { historicMoment: A6, gdbVersion: w9 } = a7, P4 = new d4({ orderByFields: q3, start: g11, num: C4, outFields: m8, cacheHint: y10, historicMoment: A6, gdbVersion: w9, relationshipId: u9, returnGeometry: false, objectIds: [c17], where: this._getRelationshipWhereClause(s11) }), v9 = await a7.queryRelatedFeatures(P4, { signal: e14 == null ? void 0 : e14.signal }), j6 = ((_a = v9[c17]) == null ? void 0 : _a.features) || [];
    return "subtype-group" === s11.type && _3 ? j6.forEach((e15) => {
      var _a2;
      const t6 = e15.attributes[_3], r11 = (_a2 = s11.findSublayerForSubtypeCode) == null ? void 0 : _a2.call(s11, t6);
      e15.sourceLayer = r11, e15.layer = r11;
    }) : j6.forEach((e15) => {
      e15.sourceLayer = s11, e15.layer = s11;
    }), j6;
  }
};
function f4(e14) {
  return null != e14 && "" !== e14;
}
r4([m()], _2.prototype, "_loaded", void 0), r4([m()], _2.prototype, "_queryAbortController", void 0), r4([m()], _2.prototype, "_queryPageAbortController", void 0), r4([m()], _2.prototype, "_queryFeatureCountAbortController", void 0), r4([m({ value: 1 })], _2.prototype, "featurePage", null), r4([m()], _2.prototype, "featuresPerPage", void 0), r4([m({ readOnly: true })], _2.prototype, "orderByFieldsFixedCasing", null), r4([m({ readOnly: true })], _2.prototype, "supportsCacheHint", null), r4([m({ readOnly: true })], _2.prototype, "canLoad", null), r4([m({ readOnly: true })], _2.prototype, "canQuery", null), r4([m()], _2.prototype, "activeCategory", void 0), r4([m({ readOnly: true })], _2.prototype, "allCategories", void 0), r4([m({ readOnly: true })], _2.prototype, "allCategoriesCount", null), r4([m({ readOnly: true })], _2.prototype, "categories", null), r4([m()], _2.prototype, "description", void 0), r4([m({ value: 3 })], _2.prototype, "displayCount", null), r4([m({ type: b3 })], _2.prototype, "graphic", void 0), r4([m({ readOnly: true })], _2.prototype, "itemDescriptionFieldName", null), r4([m()], _2.prototype, "layer", void 0), r4([m()], _2.prototype, "map", void 0), r4([m({ readOnly: true })], _2.prototype, "objectId", null), r4([m({ readOnly: true })], _2.prototype, "objectIdField", null), r4([m()], _2.prototype, "orderByFields", void 0), r4([m({ readOnly: true })], _2.prototype, "relatedFeatures", null), r4([m({ readOnly: true })], _2.prototype, "relatedLayer", null), r4([m({ readOnly: true })], _2.prototype, "relatedLayerKeyField", null), r4([m({ readOnly: true })], _2.prototype, "relatedLayerKeyFields", null), r4([m({ readOnly: true })], _2.prototype, "relationship", null), r4([m({ readOnly: true })], _2.prototype, "relationshipKey", null), r4([m({ readOnly: true })], _2.prototype, "relationshipKeyField", null), r4([m({ readOnly: true })], _2.prototype, "featureCount", void 0), r4([m({ readOnly: true })], _2.prototype, "relatedFeatureViewModels", null), r4([m()], _2.prototype, "relationshipId", void 0), r4([m()], _2.prototype, "showAllEnabled", void 0), r4([m()], _2.prototype, "state", null), r4([m()], _2.prototype, "title", void 0), _2 = r4([a("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")], _2);
var m7 = _2;

// node_modules/@arcgis/core/widgets/Feature/FeatureRelationship.js
var b8;
var y8 = "esri-feature";
var I7 = `${y8}-relationship`;
var F5 = { base: I7, listContainer: `${I7}__list`, listItem: `${I7}__list-item`, listItemHidden: `${I7}__list-item--hidden`, listContainerQuerying: `${I7}__list--querying`, featureObserver: `${y8}__feature-observer`, stickySpinnerContainer: `${y8}__sticky-loading-container`, loadingSpinnerContainer: `${y8}__loading-container` };
var C3 = { title: true, description: true };
var M5 = b8 = class extends O {
  constructor(e14, t5) {
    super(e14, t5), this._featureElementInfo = null, this._relatedFeatureIntersectionObserverNode = null, this._relatedFeatureIntersectionObserver = new IntersectionObserver(([e15]) => {
      (e15 == null ? void 0 : e15.isIntersecting) && this._increaseFeaturePage();
    }, { root: window.document }), this.flowItems = null, this.flowType = "feature-relationship", this.headingLevel = 2, this.viewModel = new m7(), this.messages = null, this.messagesCommon = null, this.visibleElements = { ...C3 }, this._increaseFeaturePage = () => {
      const { state: e15, showAllEnabled: t6, relatedFeatures: s11, featuresPerPage: i9, featurePage: r10 } = this.viewModel;
      "ready" === e15 && t6 && s11.length >= i9 * r10 && this.viewModel.featurePage++;
    };
  }
  initialize() {
    this._featureElementInfo = new l3(), this.addHandles([d3(() => [this.viewModel.description, this.viewModel.title, this.headingLevel], () => this._setupFeatureElementInfo(), P), d3(() => [this.viewModel.state, this.viewModel.showAllEnabled, this._relatedFeatureIntersectionObserverNode], () => this._handleRelatedFeatureObserverChange()), v(() => this.viewModel.relatedFeatureViewModels, "change", () => this._setupRelatedFeatureViewModels())]);
  }
  loadDependencies() {
    return c3({ chip: () => import("./calcite-chip-WK7WESLT.js"), icon: () => import("./calcite-icon-IDR3G5OX.js"), list: () => import("./calcite-list-ZW5MU5XE.js"), "list-item": () => import("./calcite-list-item-G27TAKVG.js"), loader: () => import("./calcite-loader-JLWU6EVT.js"), notice: () => import("./calcite-notice-ZJGBVXUG.js") });
  }
  destroy() {
    this._unobserveRelatedFeatureObserver(), this._featureElementInfo = u(this._featureElementInfo);
  }
  get displayShowAllButton() {
    const { showAllEnabled: e14, featureCount: t5, displayCount: s11, state: i9, allCategoriesCount: r10 } = this.viewModel;
    return !e14 && "ready" === i9 && (!!r10 && (r10 > s11 || 0 === s11) || !!t5 && (t5 > s11 || 0 === s11));
  }
  get displayListItems() {
    const { relatedFeatureViewModels: e14, allCategoriesCount: t5 } = this.viewModel;
    return this.displayShowAllButton || !!e14.length || !!t5;
  }
  get allItemsDescription() {
    const { messages: e14 } = this, { featureCount: t5, allCategories: s11, allCategoriesCount: i9 } = this.viewModel;
    return s3(e14 == null ? void 0 : e14.numberRecords, { number: l(s11 ? i9 : t5) });
  }
  get description() {
    return this.viewModel.description;
  }
  set description(e14) {
    this.viewModel.description = e14;
  }
  get title() {
    const { activeCategory: e14, title: t5 } = this.viewModel;
    return (e14 == null ? void 0 : e14.name) ?? t5;
  }
  set title(e14) {
    this.viewModel.title = e14;
  }
  castVisibleElements(e14) {
    return { ...C3, ...e14 };
  }
  render() {
    var _a;
    const { state: e14 } = this.viewModel;
    return n2("div", { class: this.classes(F5.base, e4.widget) }, (_a = this._featureElementInfo) == null ? void 0 : _a.render(), "loading" === e14 ? this._renderLoading() : "disabled" === e14 ? this._renderRelationshipNotFound() : this._renderRelatedFeatures());
  }
  async _selectCategory(e14) {
    const { flowItems: t5, featureVisibleElements: s11, viewModel: i9 } = this;
    t5 && (i9.activeCategory = e14, i9.showAllEnabled = true, t5.push(new b8({ flowItems: t5, featureVisibleElements: s11, visibleElements: { title: false, description: false }, viewModel: i9 })));
  }
  async _selectRecord(e14) {
    const { flowItems: t5, featureVisibleElements: s11 } = this;
    if (!t5) return;
    e14.abilities = { relationshipContent: true };
    const { default: i9 } = await import("./Feature-Z57LO3EX.js");
    t5.push(new i9({ flowItems: t5, flowType: this.flowType, viewModel: e14, visibleElements: s11 }));
  }
  _showAllRecords() {
    const { flowItems: e14 } = this;
    if (!e14) return;
    const { viewModel: t5, featureVisibleElements: s11 } = this;
    t5.showAllEnabled = true;
    const i9 = new b8({ flowItems: e14, featureVisibleElements: s11, visibleElements: { title: false, description: false }, viewModel: t5 });
    e14.push(i9);
  }
  _renderStickyLoading() {
    return "querying" === this.viewModel.state ? n2("div", { class: F5.stickySpinnerContainer, key: "sticky-loader" }, this._renderLoadingIcon()) : null;
  }
  _renderLoadingIcon() {
    return n2("calcite-loader", { inline: true, label: "" });
  }
  _renderLoading() {
    return n2("div", { class: F5.loadingSpinnerContainer, key: "loading-container" }, this._renderLoadingIcon());
  }
  _renderShowAllIconNode() {
    return n2("calcite-icon", { icon: "list", scale: "s", slot: "content-end" });
  }
  _renderChevronIconNode() {
    const e14 = g2(this.container) ? "chevron-left" : "chevron-right";
    return n2("calcite-icon", { icon: e14, scale: "s", slot: "content-end" });
  }
  _renderCategory(e14) {
    const { count: t5, name: s11, value: i9 } = e14, r10 = l(t5);
    return n2("calcite-list-item", { class: F5.listItem, disabled: !t5, key: i9, label: s11, onCalciteListItemSelect: () => this._selectCategory(e14) }, n2("calcite-chip", { label: r10, scale: "s", slot: "content-end" }, r10), this._renderChevronIconNode());
  }
  _renderRelatedFeature(e14) {
    var _a;
    const { itemDescriptionFieldName: t5 } = this.viewModel, s11 = e14.title;
    e14.description = t5 && ((_a = e14.formattedAttributes) == null ? void 0 : _a.global[t5]);
    const i9 = "loading" === e14.state;
    return n2("calcite-list-item", { class: this.classes(F5.listItem, { [F5.listItemHidden]: i9 }), description: c2(e14.description ?? ""), key: e14.uid, label: c2(s11), onCalciteListItemSelect: () => this._selectRecord(e14) }, this._renderChevronIconNode());
  }
  _renderShowAllListItem() {
    var _a;
    return this.displayShowAllButton ? n2("calcite-list-item", { description: this.allItemsDescription, key: "show-all-item", label: (_a = this.messages) == null ? void 0 : _a.showAll, onCalciteListItemSelect: () => this._showAllRecords() }, this._renderShowAllIconNode()) : null;
  }
  _renderNoRelatedFeaturesMessage() {
    var _a;
    return n2("calcite-notice", { icon: "information", key: "no-related-features-message", kind: "brand", open: true, scale: "s", width: "full" }, n2("div", { slot: "message" }, (_a = this.messages) == null ? void 0 : _a.noRelatedFeatures));
  }
  _renderFeatureObserver() {
    return n2("div", { afterCreate: this._relatedFeatureIntersectionObserverCreated, bind: this, class: F5.featureObserver, key: "feature-observer" });
  }
  _renderList() {
    var _a;
    const { relatedFeatureViewModels: e14, categories: t5 } = this.viewModel;
    return n2("calcite-list", { displayMode: "flat", label: (_a = this.messages) == null ? void 0 : _a.relatedFeaturesList }, (t5 == null ? void 0 : t5.map((e15) => this._renderCategory(e15))) ?? e14.toArray().map((e15) => this._renderRelatedFeature(e15)), this._renderShowAllListItem());
  }
  _renderRelatedFeatures() {
    const { displayListItems: e14 } = this, { state: t5 } = this.viewModel;
    return n2("div", { class: this.classes(F5.listContainer, { [F5.listContainerQuerying]: "querying" === t5 }), key: "list-container" }, e14 ? this._renderList() : "ready" === t5 ? this._renderNoRelatedFeaturesMessage() : null, this._renderStickyLoading(), this._renderFeatureObserver());
  }
  _renderRelationshipNotFound() {
    var _a;
    return n2("calcite-notice", { icon: "exclamation-mark-triangle", key: "relationship-not-found", kind: "danger", open: true, scale: "s", width: "full" }, n2("div", { slot: "message" }, (_a = this.messages) == null ? void 0 : _a.relationshipNotFound));
  }
  _setupRelatedFeatureViewModels() {
    const { relatedFeatureViewModels: e14 } = this.viewModel, t5 = "related-feature-viewmodels";
    this.removeHandles(t5), e14 == null ? void 0 : e14.forEach((e15) => {
      this.addHandles(d3(() => [e15.title, e15.state], () => this.scheduleRender(), P), t5);
    }), this.scheduleRender();
  }
  _setupFeatureElementInfo() {
    var _a;
    const { headingLevel: e14, visibleElements: t5 } = this, s11 = t5.description && this.description, i9 = t5.title && this.title;
    (_a = this._featureElementInfo) == null ? void 0 : _a.set({ description: s11, title: i9, headingLevel: e14 });
  }
  async _handleRelatedFeatureObserverChange() {
    this._unobserveRelatedFeatureObserver();
    const { state: e14, showAllEnabled: t5 } = this.viewModel;
    await A(0), this._relatedFeatureIntersectionObserverNode && "ready" === e14 && t5 && this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode);
  }
  _relatedFeatureIntersectionObserverCreated(e14) {
    this._relatedFeatureIntersectionObserverNode = e14;
  }
  _unobserveRelatedFeatureObserver() {
    this._relatedFeatureIntersectionObserverNode && this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode);
  }
};
r4([m()], M5.prototype, "_relatedFeatureIntersectionObserverNode", void 0), r4([m({ readOnly: true })], M5.prototype, "displayShowAllButton", null), r4([m({ readOnly: true })], M5.prototype, "displayListItems", null), r4([m({ readOnly: true })], M5.prototype, "allItemsDescription", null), r4([m()], M5.prototype, "description", null), r4([m()], M5.prototype, "featureVisibleElements", void 0), r4([m()], M5.prototype, "flowItems", void 0), r4([m()], M5.prototype, "flowType", void 0), r4([m()], M5.prototype, "headingLevel", void 0), r4([m()], M5.prototype, "title", null), r4([m({ type: m7 })], M5.prototype, "viewModel", void 0), r4([m(), e3("esri/widgets/Feature/t9n/Feature")], M5.prototype, "messages", void 0), r4([m(), e3("esri/t9n/common")], M5.prototype, "messagesCommon", void 0), r4([m()], M5.prototype, "visibleElements", void 0), r4([s4("visibleElements")], M5.prototype, "castVisibleElements", null), M5 = b8 = r4([a("esri.widgets.Feature.FeatureRelationship")], M5);
var E4 = M5;

// node_modules/@arcgis/core/widgets/Feature/FeatureUtilityNetworkAssociations.js
var y9 = "esri-feature-utility-network-associations";
var g10 = `${y9}__loading-container`;
var v8 = { base: y9, listContainer: `${y9}__list`, loadingContainer: g10, loadingContainerSticky: `${g10}--sticky` };
var f5 = class extends O {
  constructor(e14, t5) {
    super(e14, t5), this._featureElementInfo = null, this.onSelectAssociationType = () => {
    }, this.flowType = "feature-utility-network-associations", this.flowItems = null, this.parentFeatureViewModel = null, this.headingLevel = 5, this.viewModel = new _(), this.messages = null, this.messagesCommon = null, this.visibleElements = new i4();
  }
  initialize() {
    this._featureElementInfo = new l3(), this.addHandles([d3(() => [this.viewModel.description, this.viewModel.title, this.headingLevel], () => this._setupFeatureElementInfo(), P)]);
  }
  loadDependencies() {
    return c3({ icon: () => import("./calcite-icon-IDR3G5OX.js"), list: () => import("./calcite-list-ZW5MU5XE.js"), "list-item": () => import("./calcite-list-item-G27TAKVG.js"), loader: () => import("./calcite-loader-JLWU6EVT.js"), notice: () => import("./calcite-notice-ZJGBVXUG.js") });
  }
  destroy() {
    this._featureElementInfo = u(this._featureElementInfo);
  }
  get description() {
    return this.viewModel.description;
  }
  set description(e14) {
    this.viewModel.description = e14;
  }
  get title() {
    return this.viewModel.title;
  }
  set title(e14) {
    this.viewModel.title = e14;
  }
  render() {
    var _a;
    const { state: e14 } = this.viewModel;
    return n2("div", { class: this.classes(v8.base, e4.widget) }, (_a = this._featureElementInfo) == null ? void 0 : _a.render(), "loading" === e14 ? this._renderLoading() : "disabled" === e14 ? this._renderAssociationNotFound() : this._renderContent());
  }
  _renderStickyLoading() {
    return "querying" === this.viewModel.state ? n2("div", { class: v8.loadingContainerSticky, key: "sticky-loader" }, this._renderLoadingIcon()) : null;
  }
  _renderLoadingIcon() {
    return n2("calcite-loader", { inline: true, label: this.messagesCommon.loading });
  }
  _renderLoading() {
    return n2("div", { class: v8.loadingContainer, key: "loading-container" }, this._renderLoadingIcon());
  }
  _renderAssociationNotFound() {
    var _a;
    return n2("calcite-notice", { icon: "exclamation-mark-triangle", key: "association-not-found", kind: "danger", open: true, scale: "s", width: "full" }, n2("div", { slot: "message" }, (_a = this.messages) == null ? void 0 : _a.noAssociations));
  }
  _renderAssociationType(e14) {
    const { viewModel: t5 } = this, i9 = this._getAssociationTypeTitle(e14);
    return n2("calcite-list-item", { description: c2(e14.description), key: `association-type-${e14.type}`, label: c2(i9), value: e14.type, onCalciteListItemSelect: () => this.onSelectAssociationType({ viewModel: t5, listType: e14, title: i9 }) }, n2("calcite-icon", { flipRtl: true, icon: "chevron-right", scale: "s", slot: "content-end" }));
  }
  _renderAssociations(e14) {
    const { viewModel: t5 } = this;
    return "featureForm" === t5.source || t5.getFeatureCountForAssociationType(e14.type) > 0 ? this._renderAssociationType(e14) : void 0;
  }
  _renderContent() {
    const { messages: e14, viewModel: t5 } = this, { state: i9, associationTypes: o3 } = t5;
    return n2("div", { class: v8.listContainer, key: "list-container" }, "ready" === i9 ? n2("div", null, n2("calcite-list", { displayMode: "flat", label: e14 == null ? void 0 : e14.associationsList }, o3.map((e15) => this._renderAssociations(e15)))) : null, this._renderStickyLoading());
  }
  _getAssociationTypeTitle(e14) {
    const { messages: t5 } = this;
    if (e14.title) return e14.title;
    switch (e14.type) {
      case "attachment":
        return t5.associationsAttachments;
      case "connectivity":
        return t5.associationsConnectivity;
      case "structure":
        return t5.associationsStructure;
      case "content":
        return t5.associationsContents;
      case "container":
        return t5.associationsContainer;
    }
  }
  _setupFeatureElementInfo() {
    var _a;
    const { headingLevel: e14, visibleElements: t5 } = this, i9 = t5.description && this.description, o3 = t5.title && this.title;
    (_a = this._featureElementInfo) == null ? void 0 : _a.set({ description: i9, title: o3, headingLevel: e14 });
  }
};
r4([m({ constructOnly: true })], f5.prototype, "onSelectAssociationType", void 0), r4([m()], f5.prototype, "flowType", void 0), r4([m()], f5.prototype, "flowItems", void 0), r4([m()], f5.prototype, "parentFeatureViewModel", void 0), r4([m()], f5.prototype, "featureVisibleElements", void 0), r4([m()], f5.prototype, "description", null), r4([m()], f5.prototype, "headingLevel", void 0), r4([m()], f5.prototype, "title", null), r4([m({ type: _ })], f5.prototype, "viewModel", void 0), r4([m(), e3("esri/widgets/Feature/t9n/Feature")], f5.prototype, "messages", void 0), r4([m(), e3("esri/t9n/common")], f5.prototype, "messagesCommon", void 0), r4([m({ type: i4, nonNullable: true })], f5.prototype, "visibleElements", void 0), f5 = r4([a("esri.widgets.Feature.FeatureUtilityNetworkAssociations")], f5);
var w8 = f5;

// node_modules/@arcgis/core/arcade/featureset/support/FeatureSetQueryInterceptor.js
var e12 = class {
  constructor(e14, a7) {
    this.preLayerQueryCallback = e14, this.preRequestCallback = a7, this.preLayerQueryCallback || (this.preLayerQueryCallback = (e15) => {
    }), this.preRequestCallback || (this.preLayerQueryCallback = (e15) => {
    });
  }
};

// node_modules/@arcgis/core/widgets/Feature/FeatureViewModel.js
var se2;
var oe2 = 1;
var re2 = "content-view-models";
var ae2 = "relationship-view-models";
var ne = "association-view-models";
var le2 = { attachmentsContent: true, chartAnimation: true, customContent: true, expressionContent: true, fieldsContent: true, mediaContent: true, textContent: true, relationshipContent: true, utilityNetworkAssociationsContent: true };
var pe2 = se2 = class extends n4.IdentifiableMixin(g) {
  constructor(e14) {
    super(e14), this._error = null, this._graphicChangedTask = null, this._evaluateExpressionAttributesTask = null, this._associationVMAbortController = null, this._expressionAttributes = null, this._graphicExpressionAttributes = null, this.abilities = { ...le2 }, this.content = null, this.contentViewModels = [], this.description = null, this.defaultPopupTemplateEnabled = false, this.formattedAttributes = null, this.lastEditInfo = null, this.location = null, this.relatedInfos = /* @__PURE__ */ new Map(), this.title = "", this.view = null, this._graphicChangedThrottled = e9(this._graphicChanged, () => this.notifyChange("waitingForContent"), oe2, this), this._isAllowedContentType = (e15) => {
      const { abilities: t5 } = this;
      return "attachments" === e15.type && !!t5.attachmentsContent || "custom" === e15.type && !!t5.customContent || "fields" === e15.type && !!t5.fieldsContent || "media" === e15.type && !!t5.mediaContent || "text" === e15.type && !!t5.textContent || "expression" === e15.type && !!t5.expressionContent || "relationship" === e15.type && !!t5.relationshipContent || "utility-network-associations" === e15.type && !!t5.utilityNetworkAssociationsContent;
    }, this._evaluateExpressionAttributesThrottled = e9(this._evaluateExpressionAttributes, () => this.notifyChange("waitingForContent"), oe2, this), this.addHandles([d3(() => [this.graphic, this._effectivePopupTemplate, this.abilities, this.timeZone], () => this._graphicChangedThrottled(), P), p(() => {
      var _a, _b, _c, _d, _e2, _f, _g;
      if (!((_a = this._graphicChangedTask) == null ? void 0 : _a.finished) || null == this._graphicChangedTask.value) return null;
      const e15 = this._graphicChangedTask.value, t5 = (_b = e15 == null ? void 0 : e15.expressionInfos) == null ? void 0 : _b.dependencies;
      return [e15, (t5 == null ? void 0 : t5.has("view-scale")) ? (_c = this.view) == null ? void 0 : _c.scale : null, (t5 == null ? void 0 : t5.has("view-time-extent")) ? (_e2 = (_d = this.view) == null ? void 0 : _d.timeExtent) == null ? void 0 : _e2.start : null, (t5 == null ? void 0 : t5.has("view-time-extent")) ? (_g = (_f = this.view) == null ? void 0 : _f.timeExtent) == null ? void 0 : _g.end : null];
    }, ([e15]) => this._evaluateExpressionAttributesThrottled(e15))]);
  }
  initialize() {
    this.addHandles([this._graphicChangedThrottled, this._evaluateExpressionAttributesThrottled]);
  }
  destroy() {
    this._clear(), this._graphicChangedTask = e(this._graphicChangedTask), this._evaluateExpressionAttributesTask = e(this._evaluateExpressionAttributesTask), this._error = null, this.graphic = null, this._destroyContentViewModels(), this.relatedInfos.clear();
  }
  get _effectivePopupTemplate() {
    return null != this.graphic ? this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled) : null;
  }
  get _fieldInfoMap() {
    return ie(oe(this._effectivePopupTemplate), this._sourceLayer);
  }
  get _sourceLayer() {
    return L(this.graphic);
  }
  castAbilities(e14) {
    return { ...le2, ...e14 };
  }
  get isTable() {
    var _a;
    return ((_a = this._sourceLayer) == null ? void 0 : _a.isTable) || false;
  }
  get state() {
    return this.graphic ? this._error ? "error" : this.waitingForContent ? "loading" : "ready" : "disabled";
  }
  set graphic(e14) {
    this._set("graphic", (e14 == null ? void 0 : e14.clone()) ?? null);
  }
  get spatialReference() {
    var _a;
    return ((_a = this.view) == null ? void 0 : _a.spatialReference) ?? null;
  }
  set spatialReference(e14) {
    this._override("spatialReference", e14);
  }
  get timeZone() {
    var _a;
    return ((_a = this.view) == null ? void 0 : _a.timeZone) ?? e2;
  }
  set timeZone(e14) {
    this._overrideIfSome("timeZone", e14);
  }
  get map() {
    var _a;
    return ((_a = this.view) == null ? void 0 : _a.map) || null;
  }
  set map(e14) {
    this._override("map", e14);
  }
  get waitingForContent() {
    const { _graphicChangedThrottled: e14, _evaluateExpressionAttributesThrottled: t5, _graphicChangedTask: i9, _evaluateExpressionAttributesTask: s11, _associationVMAbortController: o3 } = this;
    return e14.hasPendingUpdates() || t5.hasPendingUpdates() || null != i9 && !i9.finished || null != s11 && !s11.finished || !!o3;
  }
  setActiveMedia(e14, t5) {
    const i9 = this.contentViewModels[e14];
    i9 instanceof M3 && i9.setActiveMedia(t5);
  }
  nextMedia(e14) {
    const t5 = this.contentViewModels[e14];
    t5 instanceof M3 && t5.next();
  }
  previousMedia(e14) {
    const t5 = this.contentViewModels[e14];
    t5 instanceof M3 && t5.previous();
  }
  async updateGeometry() {
    var _a;
    const { graphic: e14, spatialReference: t5, _sourceLayer: i9 } = this;
    await (i9 == null ? void 0 : i9.load());
    const s11 = i9 == null ? void 0 : i9.objectIdField;
    if (!s11 || !e14 || !i9) return;
    const o3 = (_a = e14 == null ? void 0 : e14.attributes) == null ? void 0 : _a[s11];
    if (null == o3) return;
    const r10 = [o3];
    if (!e14.geometry) {
      const s12 = await fe({ layer: i9, graphic: e14, outFields: [], objectIds: r10, returnGeometry: true, spatialReference: t5 }), o4 = s12 == null ? void 0 : s12.geometry;
      o4 && (e14.geometry = o4);
    }
  }
  _clear() {
    this._set("title", ""), this._set("content", null), this._set("formattedAttributes", null);
  }
  _graphicChanged() {
    this._evaluateExpressionAttributesTask = e(this._evaluateExpressionAttributesTask), this._graphicChangedTask = e(this._graphicChangedTask), this._graphicChangedTask = d2(async (e14) => {
      this._error = null, this._clear();
      const { graphic: t5 } = this;
      try {
        if (!t5) return null;
        const { _sourceLayer: i9, _effectivePopupTemplate: s11 } = this, o3 = this.spatialReference;
        await de({ graphic: t5, popupTemplate: s11, layer: i9, spatialReference: o3 }, { signal: e14 });
        const [{ value: r10 }, { value: a7 }] = await y([this._getContent(), this._getTitle()]), [, { value: n15 }] = await y([this._checkForRelatedFeatures({ signal: e14 }), b7(s11 == null ? void 0 : s11.expressionInfos, t5)]);
        return { expressionInfos: n15, content: r10, title: a7 };
      } catch (i9) {
        throw b(i9) || (this._error = i9, n.getLogger(this).error("error", "The popupTemplate could not be displayed for this feature.", { error: i9, graphic: t5, popupTemplate: this._effectivePopupTemplate })), i9;
      }
    });
  }
  _compileContentElement(e14, t5) {
    return "attachments" === e14.type ? this._compileAttachments(e14, t5) : "custom" === e14.type ? this._compileCustom(e14, t5) : "fields" === e14.type ? this._compileFields(e14, t5) : "media" === e14.type ? this._compileMedia(e14, t5) : "text" === e14.type ? this._compileText(e14, t5) : "expression" === e14.type ? this._compileExpression(e14, t5) : "relationship" === e14.type ? this._compileRelationship(e14, t5) : "utility-network-associations" === e14.type ? this._compileUtilityNetworkAssociation(e14, t5) : void 0;
  }
  _compileContent(e14) {
    if (this._destroyContentViewModels(), this.graphic) return Array.isArray(e14) ? e14.filter(this._isAllowedContentType).map((e15, t5) => this._compileContentElement(e15, t5)).filter(G) : "string" == typeof e14 ? this._compileText(new c5({ text: e14 }), 0).text : e14;
  }
  _destroyContentViewModels() {
    this.removeHandles(ae2), this.removeHandles(re2), this.contentViewModels.forEach((e14) => e14 && !e14.destroyed && e14.destroy()), this._set("contentViewModels", []);
  }
  _matchesFeature(e14, t5) {
    var _a;
    const i9 = (_a = e14 == null ? void 0 : e14.graphic) == null ? void 0 : _a.getObjectId(), s11 = t5 == null ? void 0 : t5.getObjectId();
    return null != i9 && null != s11 && i9 === s11;
  }
  _setRelatedFeaturesViewModels({ relatedFeatureViewModels: e14, relatedFeatures: t5, map: i9 }) {
    const { view: s11, spatialReference: o3, timeZone: r10 } = this;
    t5 == null ? void 0 : t5.filter(Boolean).forEach((t6) => {
      e14.some((e15) => this._matchesFeature(e15, t6)) || e14.add(new se2({ abilities: { relationshipContent: false }, map: i9, view: s11, spatialReference: o3, timeZone: r10, graphic: t6 }));
    }), e14.forEach((i10) => {
      const s12 = t5 == null ? void 0 : t5.find((e15) => this._matchesFeature(i10, e15));
      s12 || e14.remove(i10);
    });
  }
  _setExpressionContentVM(e14, t5) {
    const i9 = this.formattedAttributes, { contentElement: s11, contentElementViewModel: o3 } = e14, r10 = s11 == null ? void 0 : s11.type;
    o3 && r10 && ("fields" === r10 && (this._createFieldsFormattedAttributes({ contentElement: s11, contentElementIndex: t5, formattedAttributes: i9 }), o3.set(this._createFieldsVMParams(s11, t5))), "media" === r10 && (this._createMediaFormattedAttributes({ contentElement: s11, contentElementIndex: t5, formattedAttributes: i9 }), o3.set(this._createMediaVMParams(s11, t5))), "text" === r10 && o3.set(this._createTextVMParams(s11)));
  }
  _compileRelationship(e14, t5) {
    const { displayCount: i9, orderByFields: s11, relationshipId: o3, title: r10, description: a7 } = e14, { _sourceLayer: n15, graphic: l9, map: p9 } = this;
    if (!J(n15)) return;
    const c17 = new m7({ displayCount: i9, graphic: l9, orderByFields: s11, relationshipId: o3, layer: n15, map: p9, ...this._compileTitleAndDesc({ title: r10, description: a7 }) });
    return this.contentViewModels[t5] = c17, this.addHandles(v(() => c17.relatedFeatures, "change", () => this._setRelatedFeaturesViewModels(c17)), ae2), e14;
  }
  _matchesGlobalFeature(e14, t5) {
    const i9 = e14 == null ? void 0 : e14.association.globalId, s11 = t5 == null ? void 0 : t5.association.globalId;
    return null != i9 && null != s11 && i9 === s11;
  }
  async _setUpUtilityNetworkAssociationsViewModels(e14, t5, i9) {
    const { view: s11, spatialReference: o3, timeZone: r10 } = this;
    e14.forEach((i10, s12) => {
      const o4 = t5.get(s12);
      o4 ? i10.forEach((t6) => {
        o4.find((e15) => this._matchesGlobalFeature(t6, e15)) || (i10.remove(t6), 0 === i10.length && e14.delete(s12));
      }) : (i10.removeAll(), e14.delete(s12));
    }), t5.forEach((t6, n16) => {
      const l9 = e14.get(n16) || new V();
      t6 == null ? void 0 : t6.filter(Boolean).forEach((e15) => {
        l9.some((t7) => this._matchesGlobalFeature(t7, e15)) || l9.add({ association: e15.association, featureViewModel: new se2({ abilities: { utilityNetworkAssociationsContent: false }, map: i9, view: s11, spatialReference: o3, timeZone: r10, graphic: e15.feature }), terminalName: e15.terminalName });
      }), e14.set(n16, l9);
    });
    const n15 = new AbortController();
    this._associationVMAbortController = n15, await this._sortListObjectsByTitle(e14, { signal: n15.signal }), this._associationVMAbortController === n15 && (this._associationVMAbortController = null);
  }
  async _sortListObjectsByTitle(e14, t5) {
    for (const i9 of e14.values()) {
      const e15 = i9.map((e16) => w(() => "ready" === e16.featureViewModel.state, t5 == null ? void 0 : t5.signal));
      await Promise.all(e15), i9.sort(this._compareByFeatureTitle);
    }
  }
  _compareByFeatureTitle(e14, t5) {
    const i9 = c6(e14.featureViewModel), s11 = c6(t5.featureViewModel);
    return i9.localeCompare(s11, void 0, { numeric: true });
  }
  _compileUtilityNetworkAssociation(e14, t5) {
    const { displayCount: i9, title: s11, description: o3, associationTypes: r10 } = e14, { _sourceLayer: a7, graphic: n15, map: l9 } = this;
    if (!K(a7)) return;
    const p9 = new _({ graphic: n15, displayCount: i9, associationTypes: r10, layer: a7, map: l9, ...this._compileTitleAndDesc({ title: s11, description: o3 }) });
    return this.contentViewModels[t5] = p9, this.addHandles([d3(() => p9.associationFeatures.values(), () => this._setUpUtilityNetworkAssociationsViewModels(p9.associationViewModels, p9.associationFeatures, p9.map))], ne), e14;
  }
  _compileExpression(e14, t5) {
    const { expressionInfo: i9 } = e14, { graphic: s11, map: o3, spatialReference: r10, view: a7, location: n15 } = this, l9 = new E3({ expressionInfo: i9, graphic: s11, interceptor: se2.interceptor, map: o3, spatialReference: r10, view: a7, location: n15 });
    return this.contentViewModels[t5] = l9, this.addHandles(d3(() => l9.contentElementViewModel, () => this._setExpressionContentVM(l9, t5), P), re2), e14;
  }
  _compileAttachments(e14, t5) {
    const { graphic: i9 } = this, { description: s11, title: o3, orderByFields: r10 } = e14;
    return this.contentViewModels[t5] = new c7({ graphic: i9, orderByFields: r10, ...this._compileTitleAndDesc({ title: o3, description: s11 }) }), e14;
  }
  _compileCustom(e14, t5) {
    const { graphic: i9 } = this, { creator: s11, destroyer: o3 } = e14;
    return this.contentViewModels[t5] = new p5({ graphic: i9, creator: s11, destroyer: o3 }), e14;
  }
  _compileTitleAndDesc({ title: e14, description: t5 }) {
    const { _fieldInfoMap: i9, _sourceLayer: s11, graphic: o3, formattedAttributes: r10 } = this, a7 = o3 == null ? void 0 : o3.attributes, n15 = this._expressionAttributes, l9 = r10.global;
    return { title: D({ attributes: a7, fieldInfoMap: i9, globalAttributes: l9, expressionAttributes: n15, layer: s11, text: e14 }), description: D({ attributes: a7, fieldInfoMap: i9, globalAttributes: l9, expressionAttributes: n15, layer: s11, text: t5 }) };
  }
  _createFieldsVMParams(e14, t5) {
    const i9 = this._effectivePopupTemplate, s11 = this.formattedAttributes, o3 = { ...s11 == null ? void 0 : s11.global, ...s11 == null ? void 0 : s11.content[t5] }, r10 = (e14 == null ? void 0 : e14.fieldInfos) || (i9 == null ? void 0 : i9.fieldInfos), a7 = r10 == null ? void 0 : r10.filter(({ fieldName: e15 }) => !!e15 && (E(e15) || pe(e15) || o3.hasOwnProperty(e15))), n15 = i9 == null ? void 0 : i9.expressionInfos, { description: l9, title: p9 } = e14;
    return { attributes: o3, expressionInfos: n15, fieldInfos: a7, ...this._compileTitleAndDesc({ title: p9, description: l9 }) };
  }
  _compileFields(e14, t5) {
    const i9 = e14.clone(), s11 = new n10(this._createFieldsVMParams(e14, t5));
    return this.contentViewModels[t5] = s11, i9.fieldInfos = s11.formattedFieldInfos.slice(), i9;
  }
  _createMediaVMParams(e14, t5) {
    const { abilities: i9, graphic: s11, _fieldInfoMap: o3, _effectivePopupTemplate: r10, relatedInfos: a7, _sourceLayer: n15, _expressionAttributes: l9 } = this, p9 = this.formattedAttributes, c17 = (s11 == null ? void 0 : s11.attributes) ?? {}, { description: d10, mediaInfos: h10, title: u9 } = e14;
    return { abilities: { chartAnimation: i9.chartAnimation }, activeMediaInfoIndex: e14.activeMediaInfoIndex || 0, attributes: c17, isAggregate: s11 == null ? void 0 : s11.isAggregate, layer: n15, fieldInfoMap: o3, formattedAttributes: { ...p9 == null ? void 0 : p9.global, ...p9 == null ? void 0 : p9.content[t5] }, expressionAttributes: l9, mediaInfos: h10, popupTemplate: r10, relatedInfos: a7, ...this._compileTitleAndDesc({ title: u9, description: d10 }) };
  }
  _compileMedia(e14, t5) {
    const i9 = e14.clone(), s11 = new M3(this._createMediaVMParams(e14, t5));
    return i9.mediaInfos = s11.formattedMediaInfos.slice(), this.contentViewModels[t5] = s11, i9;
  }
  _createTextVMParams(e14) {
    var _a;
    const { graphic: t5, _fieldInfoMap: i9, _sourceLayer: s11, _expressionAttributes: o3 } = this;
    if (e14 && e14.text) {
      const r10 = (t5 == null ? void 0 : t5.attributes) ?? {}, a7 = ((_a = this.formattedAttributes) == null ? void 0 : _a.global) ?? {};
      e14.text = D({ attributes: r10, fieldInfoMap: i9, globalAttributes: a7, expressionAttributes: o3, layer: s11, text: e14.text });
    }
    return { graphic: t5, creator: e14.text };
  }
  _compileText(e14, t5) {
    const i9 = e14.clone();
    return this.contentViewModels[t5] = new p5(this._createTextVMParams(i9)), i9;
  }
  _compileLastEditInfo() {
    const { _effectivePopupTemplate: e14, _sourceLayer: t5, graphic: i9, timeZone: s11 } = this;
    if (!e14) return;
    const { lastEditInfoEnabled: o3 } = e14, r10 = t5 == null ? void 0 : t5.editFieldsInfo;
    return o3 && r10 ? re(r10, i9 == null ? void 0 : i9.attributes, s11, t5) : void 0;
  }
  _compileTitle(e14) {
    var _a;
    const { _fieldInfoMap: t5, _sourceLayer: i9, graphic: s11, _expressionAttributes: o3 } = this, r10 = (s11 == null ? void 0 : s11.attributes) ?? {}, a7 = ((_a = this.formattedAttributes) == null ? void 0 : _a.global) ?? {};
    return D({ attributes: r10, fieldInfoMap: t5, globalAttributes: a7, expressionAttributes: o3, layer: i9, text: e14 });
  }
  async _getTitle() {
    const { _effectivePopupTemplate: e14, graphic: t5 } = this;
    return t5 ? q({ type: "title", value: e14 == null ? void 0 : e14.title, event: { graphic: t5 } }) : null;
  }
  async _getContent() {
    const { _effectivePopupTemplate: e14, graphic: t5 } = this;
    return t5 ? q({ type: "content", value: e14 == null ? void 0 : e14.content, event: { graphic: t5 } }) : null;
  }
  _evaluateExpressionAttributes({ title: e14, content: t5, expressionInfos: i9 }) {
    this._evaluateExpressionAttributesTask = e(this._evaluateExpressionAttributesTask), this._evaluateExpressionAttributesTask = d2(async (s11) => {
      const { graphic: o3, map: r10, view: a7, spatialReference: n15, location: p9 } = this;
      try {
        if (!o3) return;
        let l9;
        if (null != i9) {
          const e15 = [];
          for (const [t6, l10] of i9.expressions.entries()) null != l10 ? e15.push(l10.evaluate({ graphic: o3, interceptor: se2.interceptor, location: p9, map: r10, options: { signal: s11 }, spatialReference: n15, view: a7 }).then((e16) => [t6, c15(e16)]).catch(() => [t6, void 0])) : e15.push(Promise.resolve([t6, void 0]));
          l9 = Object.fromEntries(await Promise.all(e15)), s2(s11);
        }
        this._expressionAttributes = l9, this._graphicExpressionAttributes = { ...o3.attributes, ...l9 }, this._set("formattedAttributes", this._createFormattedAttributes(t5)), this._set("title", this._compileTitle(e14)), this._set("lastEditInfo", this._compileLastEditInfo() || null), this._set("content", this._compileContent(t5) || null);
      } catch (c17) {
        b(c17) || (this._error = c17, n.getLogger(this).error("error", "The popupTemplate could not be displayed for this feature.", { error: c17, graphic: o3, popupTemplate: this._effectivePopupTemplate }));
      }
    });
  }
  _createMediaFormattedAttributes({ contentElement: e14, contentElementIndex: t5, formattedAttributes: i9 }) {
    const { _effectivePopupTemplate: s11, graphic: o3, relatedInfos: r10, _sourceLayer: a7, _fieldInfoMap: n15, _graphicExpressionAttributes: l9, timeZone: p9 } = this;
    i9.content[t5] = se({ fieldInfos: s11 == null ? void 0 : s11.fieldInfos, graphic: o3, attributes: { ...l9, ...e14.attributes }, layer: a7, fieldInfoMap: n15, relatedInfos: r10, timeZone: p9 });
  }
  _createFieldsFormattedAttributes({ contentElement: e14, contentElementIndex: t5, formattedAttributes: i9 }) {
    if (e14.fieldInfos) {
      const { graphic: s11, relatedInfos: o3, _sourceLayer: r10, _fieldInfoMap: a7, _graphicExpressionAttributes: n15, timeZone: l9 } = this;
      i9.content[t5] = se({ fieldInfos: e14.fieldInfos, graphic: s11, attributes: { ...n15, ...e14.attributes }, layer: r10, fieldInfoMap: a7, relatedInfos: o3, timeZone: l9 });
    }
  }
  _createFormattedAttributes(e14) {
    const { _effectivePopupTemplate: t5, graphic: i9, relatedInfos: s11, _sourceLayer: o3, _fieldInfoMap: r10, _graphicExpressionAttributes: a7, timeZone: n15 } = this, l9 = t5 == null ? void 0 : t5.fieldInfos, p9 = { global: se({ fieldInfos: l9, graphic: i9, attributes: a7, layer: o3, fieldInfoMap: r10, relatedInfos: s11, timeZone: n15 }), content: [] };
    return Array.isArray(e14) && e14.forEach((e15, t6) => {
      "fields" === e15.type && this._createFieldsFormattedAttributes({ contentElement: e15, contentElementIndex: t6, formattedAttributes: p9 }), "media" === e15.type && this._createMediaFormattedAttributes({ contentElement: e15, contentElementIndex: t6, formattedAttributes: p9 });
    }), p9;
  }
  _checkForRelatedFeatures(e14) {
    const { graphic: t5, _effectivePopupTemplate: i9 } = this;
    return this._queryRelatedInfos(t5, oe(i9), e14);
  }
  async _queryRelatedInfos(e14, t5, i9) {
    const { relatedInfos: s11, _sourceLayer: o3 } = this;
    s11.clear();
    const r10 = null != (o3 == null ? void 0 : o3.associatedLayer) ? await (o3 == null ? void 0 : o3.associatedLayer.load(i9)) : o3;
    if (!r10 || !e14) return;
    const a7 = t5.filter((e15) => !!e15.fieldName && pe(e15.fieldName));
    if (!(a7 == null ? void 0 : a7.length)) return;
    t5.forEach((e15) => this._configureRelatedInfo(e15, r10));
    const n15 = await v4({ relatedInfos: s11, layer: r10 }, i9);
    Object.keys(n15).forEach((e15) => {
      var _a;
      const t6 = s11.get(e15.toString()), i10 = (_a = n15[e15]) == null ? void 0 : _a.value;
      t6 && i10 && (t6.layerInfo = i10.data);
    });
    const l9 = await T3({ graphic: e14, relatedInfos: s11, layer: r10 }, i9);
    Object.keys(l9).forEach((e15) => {
      var _a;
      S((_a = l9[e15]) == null ? void 0 : _a.value, s11.get(e15.toString()));
    });
  }
  _configureRelatedInfo(e14, t5) {
    const { relatedInfos: i9 } = this, s11 = h6(e14.fieldName || "");
    if (!s11) return;
    const { layerId: o3, fieldName: r10 } = s11;
    if (!o3) return;
    const a7 = i9.get(o3.toString()) || g4(o3, t5);
    a7 && (q2({ relatedInfo: a7, fieldName: r10, fieldInfo: e14 }), this.relatedInfos.set(o3, a7));
  }
};
pe2.interceptor = new e12(he, we), r4([m()], pe2.prototype, "_error", void 0), r4([m()], pe2.prototype, "_graphicChangedTask", void 0), r4([m()], pe2.prototype, "_evaluateExpressionAttributesTask", void 0), r4([m()], pe2.prototype, "_associationVMAbortController", void 0), r4([m({ readOnly: true })], pe2.prototype, "_effectivePopupTemplate", null), r4([m({ readOnly: true })], pe2.prototype, "_fieldInfoMap", null), r4([m({ readOnly: true })], pe2.prototype, "_sourceLayer", null), r4([m()], pe2.prototype, "abilities", void 0), r4([s4("abilities")], pe2.prototype, "castAbilities", null), r4([m({ readOnly: true })], pe2.prototype, "content", void 0), r4([m({ readOnly: true })], pe2.prototype, "contentViewModels", void 0), r4([m()], pe2.prototype, "description", void 0), r4([m({ type: Boolean })], pe2.prototype, "defaultPopupTemplateEnabled", void 0), r4([m({ readOnly: true })], pe2.prototype, "isTable", null), r4([m({ readOnly: true })], pe2.prototype, "state", null), r4([m({ readOnly: true })], pe2.prototype, "formattedAttributes", void 0), r4([m({ type: b3, value: null })], pe2.prototype, "graphic", null), r4([m({ readOnly: true })], pe2.prototype, "lastEditInfo", void 0), r4([m({ type: j2 })], pe2.prototype, "location", void 0), r4([m({ readOnly: true })], pe2.prototype, "relatedInfos", void 0), r4([m({ type: g3 })], pe2.prototype, "spatialReference", null), r4([m()], pe2.prototype, "timeZone", null), r4([m({ readOnly: true })], pe2.prototype, "title", void 0), r4([m()], pe2.prototype, "map", null), r4([m({ readOnly: true })], pe2.prototype, "waitingForContent", null), r4([m()], pe2.prototype, "view", void 0), pe2 = se2 = r4([a("esri.widgets.Feature.FeatureViewModel")], pe2);
var ce = pe2;

// node_modules/@arcgis/core/widgets/Feature/resources.js
var e13 = "esri-feature";
var t4 = { base: e13, container: `${e13}__size-container`, title: `${e13}__title`, main: `${e13}__main-container`, btn: `${e13}__button`, icon: `${e13}__icon`, content: `${e13}__content`, contentNode: `${e13}__content-node`, contentNodeText: `${e13}__content-node--text`, contentElement: `${e13}__content-element`, text: `${e13}__text`, lastEditedInfo: `${e13}__last-edited-info`, fields: `${e13}__fields`, fieldHeader: `${e13}__field-header`, fieldData: `${e13}__field-data`, fieldDataDate: `${e13}__field-data--date`, loadingSpinnerContainer: `${e13}__loading-container` };

// node_modules/@arcgis/core/widgets/Feature/support/FeatureContentMixin.js
var n14 = (n15) => {
  let i9 = class extends n15 {
    constructor() {
      super(...arguments), this.renderNodeContent = (e14) => e8(e14) && !e14.destroyed ? n2("div", { class: t4.contentNode, key: e14 }, e14.render()) : e14 instanceof HTMLElement ? n2("div", { afterCreate: this._attachToNode, bind: e14, class: t4.contentNode, key: e14 }) : t3(e14) ? n2("div", { afterCreate: this._attachToNode, bind: e14.domNode, class: t4.contentNode, key: e14 }) : null;
    }
    _attachToNode(e14) {
      const o3 = this;
      e14.appendChild(o3);
    }
  };
  return i9 = r4([a("esri.widgets.Feature.support.FeatureContentMixin")], i9), i9;
};

// node_modules/@arcgis/core/widgets/Feature.js
var b9 = { title: true, content: true, lastEditedInfo: true };
var F6 = class extends n14(O) {
  constructor(e14, t5) {
    super(e14, t5), this._contentWidgets = [], this.flowType = "feature", this.flowItems = null, this.headingLevel = 2, this.messages = null, this.messagesCommon = null, this.visibleElements = { ...b9 }, this.viewModel = new ce();
  }
  initialize() {
    this.addHandles(d3(() => {
      var _a;
      return (_a = this.viewModel) == null ? void 0 : _a.contentViewModels;
    }, () => this._setupContentWidgets(), P));
  }
  loadDependencies() {
    return c3({ notice: () => import("./calcite-notice-ZJGBVXUG.js"), loader: () => import("./calcite-loader-JLWU6EVT.js") });
  }
  destroy() {
    this._destroyContentWidgets();
  }
  get graphic() {
    return this.viewModel.graphic;
  }
  set graphic(e14) {
    this.viewModel.graphic = e14;
  }
  get defaultPopupTemplateEnabled() {
    return this.viewModel.defaultPopupTemplateEnabled;
  }
  set defaultPopupTemplateEnabled(e14) {
    this.viewModel.defaultPopupTemplateEnabled = e14;
  }
  get isTable() {
    return this.viewModel.isTable;
  }
  get icon() {
    return "polygon";
  }
  set icon(e14) {
    this._overrideIfSome("icon", e14);
  }
  get label() {
    var _a;
    return ((_a = this.messages) == null ? void 0 : _a.widgetLabel) ?? "";
  }
  set label(e14) {
    this._overrideIfSome("label", e14);
  }
  get location() {
    return this.viewModel.location;
  }
  set location(e14) {
    this.viewModel.location = e14;
  }
  get spatialReference() {
    return this.viewModel.spatialReference;
  }
  set spatialReference(e14) {
    this.viewModel.spatialReference = e14;
  }
  get timeZone() {
    return this.viewModel.timeZone;
  }
  set timeZone(e14) {
    this.viewModel.timeZone = e14;
  }
  get title() {
    return this.viewModel.title;
  }
  castVisibleElements(e14) {
    return { ...b9, ...e14 };
  }
  get map() {
    return this.viewModel.map;
  }
  set map(e14) {
    this.viewModel.map = e14;
  }
  get view() {
    return this.viewModel.view;
  }
  set view(e14) {
    this.viewModel.view = e14;
  }
  setActiveMedia(e14, t5) {
    return this.viewModel.setActiveMedia(e14, t5);
  }
  nextMedia(e14) {
    return this.viewModel.nextMedia(e14);
  }
  previousMedia(e14) {
    return this.viewModel.previousMedia(e14);
  }
  render() {
    const { state: e14 } = this.viewModel, t5 = n2("div", { class: t4.container, key: "container" }, this._renderTitle(), "error" === e14 ? this._renderError() : "loading" === e14 ? this._renderLoading() : this._renderContentContainer());
    return n2("div", { class: this.classes(t4.base, e4.widget) }, t5);
  }
  _renderError() {
    const { messagesCommon: e14, messages: t5, visibleElements: s11 } = this;
    return n2("calcite-notice", { icon: "exclamation-mark-circle", kind: "danger", open: true, scale: "s" }, s11.title ? n2("div", { key: "error-title", slot: "title" }, e14.errorMessage) : null, n2("div", { key: "error-message", slot: "message" }, t5.loadingError));
  }
  _renderLoading() {
    return n2("div", { class: t4.loadingSpinnerContainer, key: "loading-container" }, n2("calcite-loader", { inline: true, label: "" }));
  }
  _renderContentContainer() {
    const { visibleElements: e14 } = this;
    return e14.content ? n2("div", { class: t4.main }, [this._renderContent(), this._renderLastEditInfo()]) : null;
  }
  _renderTitle() {
    const { visibleElements: e14, title: t5 } = this;
    return e14.title ? n2(e6, { class: t4.title, innerHTML: t5, level: this.headingLevel }) : null;
  }
  _renderContent() {
    const e14 = this.viewModel.content, t5 = "content";
    if (!e14) return null;
    if (Array.isArray(e14)) return e14.length ? n2("div", { class: t4.contentNode, key: `${t5}-content-elements` }, e14.map(this._renderContentElement, this)) : null;
    if ("string" == typeof e14) {
      const e15 = this._contentWidgets[0];
      return !e15 || e15.destroyed ? null : n2("div", { class: this.classes(t4.contentNode, t4.contentNodeText), key: `${t5}-content` }, e15.render());
    }
    return this.renderNodeContent(e14);
  }
  _renderContentElement(e14, t5) {
    var _a;
    const { visibleElements: s11 } = this;
    if ("boolean" != typeof s11.content && !((_a = s11.content) == null ? void 0 : _a[e14.type])) return null;
    switch (e14.type) {
      case "attachments":
        return this._renderAttachments(t5);
      case "custom":
        return this._renderCustom(e14, t5);
      case "fields":
        return this._renderFields(t5);
      case "media":
        return this._renderMedia(t5);
      case "text":
        return this._renderText(e14, t5);
      case "expression":
        return this._renderExpression(t5);
      case "relationship":
        return this._renderRelationship(t5);
      case "utility-network-associations":
        return this._renderAssociation(t5);
      default:
        return null;
    }
  }
  _renderAttachments(e14) {
    const t5 = this._contentWidgets[e14];
    if (!t5 || t5.destroyed) return null;
    const { state: s11, attachmentInfos: i9 } = t5.viewModel;
    return "loading" === s11 || i9.length > 0 ? n2("div", { class: this.classes(t4.contentElement), key: this._buildKey("attachments-element", e14) }, t5.render()) : null;
  }
  _renderRelationship(e14) {
    const t5 = this._contentWidgets[e14];
    return t5 && !t5.destroyed && this.flowItems ? n2("div", { class: t4.contentElement, key: this._buildKey("relationship-element", e14) }, t5.render()) : null;
  }
  _renderAssociation(e14) {
    const t5 = this._contentWidgets[e14];
    return t5 && !t5.destroyed && this.flowItems ? n2("div", { class: t4.contentElement, key: this._buildKey("utility-network-association-element", e14) }, t5.render()) : null;
  }
  _renderExpression(e14) {
    const t5 = this._contentWidgets[e14];
    return t5 && !t5.destroyed && t5.viewModel.contentElement ? n2("div", { class: t4.contentElement, key: this._buildKey("expression-element", e14) }, t5.render()) : null;
  }
  _renderCustom(e14, t5) {
    const { creator: s11 } = e14, i9 = this._contentWidgets[t5];
    return !i9 || i9.destroyed ? null : s11 ? n2("div", { class: t4.contentElement, key: this._buildKey("custom-element", t5) }, i9.render()) : null;
  }
  _renderFields(e14) {
    const t5 = this._contentWidgets[e14];
    return !t5 || t5.destroyed ? null : n2("div", { class: t4.contentElement, key: this._buildKey("fields-element", e14) }, t5.render());
  }
  _renderMedia(e14) {
    const t5 = this._contentWidgets[e14];
    return !t5 || t5.destroyed ? null : n2("div", { class: t4.contentElement, key: this._buildKey("media-element", e14) }, t5.render());
  }
  _renderLastEditInfo() {
    const { visibleElements: e14, messages: t5 } = this, { lastEditInfo: s11 } = this.viewModel;
    if (!s11 || !e14.lastEditedInfo) return null;
    const { date: i9, user: n15 } = s11, o3 = "edit" === s11.type ? n15 ? t5.lastEditedByUser : t5.lastEdited : n15 ? t5.lastCreatedByUser : t5.lastCreated, r10 = s3(o3, { date: i9, user: n15 });
    return n2("div", { class: this.classes(t4.lastEditedInfo, t4.contentElement), key: "edit-info-element" }, r10);
  }
  _renderText(e14, t5) {
    const s11 = e14.text, i9 = this._contentWidgets[t5];
    return !i9 || i9.destroyed ? null : s11 ? n2("div", { class: this.classes(t4.contentElement, t4.text), key: this._buildKey("text-element", t5) }, i9.render()) : null;
  }
  _buildKey(e14, ...t5) {
    var _a, _b;
    return `${e14}__${((_b = (_a = this.viewModel) == null ? void 0 : _a.graphic) == null ? void 0 : _b.uid) || "0"}-${t5.join("-")}`;
  }
  _destroyContentWidget(e14) {
    e14 && (e14.viewModel = null, !e14.destroyed && e14.destroy());
  }
  _destroyContentWidgets() {
    this._contentWidgets.forEach((e14) => this._destroyContentWidget(e14)), this._contentWidgets = [];
  }
  _setupContentWidgets() {
    this._destroyContentWidgets();
    const { headingLevel: e14, visibleElements: t5, flowItems: s11, viewModel: i9 } = this, n15 = i9 == null ? void 0 : i9.content, { contentViewModels: o3 } = i9;
    if (Array.isArray(n15)) n15.forEach((n16, r10) => {
      if ("attachments" === n16.type && (this._contentWidgets[r10] = new c9({ displayType: n16.displayType, headingLevel: t5.title && e14 < 6 ? e14 + 1 : e14, viewModel: o3[r10] })), "fields" === n16.type && (this._contentWidgets[r10] = new h5({ viewModel: o3[r10] })), "media" === n16.type && (this._contentWidgets[r10] = new b6({ viewModel: o3[r10] })), "text" === n16.type && (this._contentWidgets[r10] = new p6({ viewModel: o3[r10] })), "custom" === n16.type && (this._contentWidgets[r10] = new p6({ viewModel: o3[r10] })), "expression" === n16.type && (this._contentWidgets[r10] = new h8({ viewModel: o3[r10] })), "relationship" === n16.type) {
        const e15 = new E4({ flowItems: s11, featureVisibleElements: t5, viewModel: o3[r10] });
        this._contentWidgets[r10] = e15;
      }
      if ("utility-network-associations" === n16.type) {
        const e15 = async (e16) => {
          const { viewModel: n18, listType: o4, title: r11 } = e16;
          if (!s11) return;
          n18.activeAssociationType = o4;
          const { default: l9 } = await import("./FeatureUtilityNetworkAssociationList-KXPSZ4LG.js"), d10 = new l9({ viewModel: n18, parentFeatureViewModel: i9, listType: o4, title: r11, featureVisibleElements: t5, description: i9.title, flowItems: s11 });
          s11.push(d10);
        }, n17 = new w8({ flowItems: s11, onSelectAssociationType: e15, parentFeatureViewModel: i9, featureVisibleElements: t5, viewModel: o3[r10] });
        this._contentWidgets[r10] = n17;
      }
    }, this);
    else {
      const e15 = o3[0];
      e15 && !e15.destroyed && (this._contentWidgets[0] = new p6({ viewModel: e15 }));
    }
    this.scheduleRender();
  }
};
r4([m()], F6.prototype, "flowType", void 0), r4([m()], F6.prototype, "graphic", null), r4([m()], F6.prototype, "defaultPopupTemplateEnabled", null), r4([m()], F6.prototype, "flowItems", void 0), r4([m()], F6.prototype, "headingLevel", void 0), r4([m({ readOnly: true })], F6.prototype, "isTable", null), r4([m()], F6.prototype, "icon", null), r4([m()], F6.prototype, "label", null), r4([m()], F6.prototype, "location", null), r4([m(), e3("esri/widgets/Feature/t9n/Feature")], F6.prototype, "messages", void 0), r4([m(), e3("esri/t9n/common")], F6.prototype, "messagesCommon", void 0), r4([m()], F6.prototype, "spatialReference", null), r4([m()], F6.prototype, "timeZone", null), r4([m({ readOnly: true })], F6.prototype, "title", null), r4([m()], F6.prototype, "visibleElements", void 0), r4([s4("visibleElements")], F6.prototype, "castVisibleElements", null), r4([m()], F6.prototype, "map", null), r4([m()], F6.prototype, "view", null), r4([m({ type: ce })], F6.prototype, "viewModel", void 0), F6 = r4([a("esri.widgets.Feature")], F6);
var j5 = F6;

export {
  e9 as e,
  i5 as i,
  e6 as e2,
  e7 as e3,
  ce,
  t4 as t,
  n14 as n,
  j5 as j
};
//# sourceMappingURL=chunk-HZJWHOXZ.js.map
