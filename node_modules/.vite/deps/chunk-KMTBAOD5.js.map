{
  "version": 3,
  "sources": ["../../@arcgis/core/views/3d/webgl-engine/lib/lodRendering/LodResources.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport{unique as e}from\"../../../../../core/arrayUtils.js\";import{baseTypedArrayMemory as t,estimateNumberArrayMemory as r}from\"../../../../../core/memoryEstimations.js\";import{newIntersectorResult as s}from\"../Intersector.js\";import{IntersectorType as n,StoreResults as i}from\"../IntersectorInterfaces.js\";import{VertexAttribute as o}from\"../VertexAttribute.js\";import{LodTarget as u}from\"./Intersector.js\";class m{constructor(e,t,r,s){this.material=e,this.bufferWriter=e.createBufferWriter(),this.vertexBufferLayout=this.bufferWriter.vertexBufferLayout,this.buffer=t,this.elementCount=r,this.boundingInfo=s}get numTriangles(){return this.elementCount/3}get numVertices(){return this.elementCount}computeUsedMemory(){return this.buffer.byteLength+t}getRenderGeometry(){return this}intersect(e,t,r,s,n,i,o,u){const m=this.bufferWriter,a=this.buffer;m.intersect(a,e,r,s,((r,s,m,a,l)=>c(r,s,m,l,e,t,i,o,n,u)))}}class a{constructor(e){this.engineGeometry=e}get material(){return this.engineGeometry.material}get numVertices(){return this.engineGeometry.attributes.get(o.POSITION).indices.length}get numTriangles(){return this.engineGeometry.indexCount/3}get boundingInfo(){return this.engineGeometry.boundingInfo}computeUsedMemory(){return Array.from(this.engineGeometry.attributes.values()).reduce(((e,t)=>e+r(t.data,t.indices)),0)}getRenderGeometry(){const e=this.material,t=this.engineGeometry,r=t.attributes,s=t.boundingInfo,n=e.createBufferWriter(),i=n.vertexBufferLayout,o=n.elementCount(r),u=i.createBuffer(o);return n.write(null,null,r,null,u,0),new m(e,u.buffer,o,s)}intersect(e,t,r,s,n,i,o,u){const m=this.engineGeometry;this.material.intersect(m,e.transform.transform,e,r,s,((r,s,m,a,l)=>c(r,s,m,l,e,t,i,o,n,u)))}}function c(e,t,r,o,m,a,c,l,f,h){if(e<0)return;if(a&&!a(m.rayBegin,m.rayEnd,e))return;const g=new u(c.layerUid,c.graphicUid(f),r,l,h);if((null==m.results.min.drapedLayerOrder||o>=m.results.min.drapedLayerOrder)&&(null==m.results.min.dist||e<m.results.min.dist)&&m.results.min.set(n.LOD,g,e,t,m.transform.transform,o),m.options.store!==i.MIN&&(null==m.results.max.drapedLayerOrder||o>=m.results.max.drapedLayerOrder)&&(null==m.results.max.dist||e>m.results.max.dist)&&m.results.max.set(n.LOD,g,e,t,m.transform.transform,o),m.options.store===i.ALL){const r=s(m.results.min.ray);r.set(n.LOD,g,e,t,m.transform.transform,o),m.results.all.push(r)}}class l{constructor(e,t=null){this.geometry=e,this.textures=t}get material(){return this.geometry.material}get numTriangles(){return this.geometry.numTriangles}}class f{constructor(t,r,s){this.components=t,this.minScreenSpaceRadius=r,this.pivotOffset=s;const n=e(this.components.map((e=>e.geometry)));this.numVertices=n.reduce(((e,t)=>e+t.numVertices),0)}}class h{constructor(e){this.levels=e,this.levels.sort(((e,t)=>e.minScreenSpaceRadius===t.minScreenSpaceRadius?e.numVertices-t.numVertices:e.minScreenSpaceRadius-t.minScreenSpaceRadius))}getMaterials(){const t=[];return this.levels.forEach((e=>e.components.forEach((e=>t.push(e.geometry.material))))),e(t)}getTextures(){const t=new Array;return this.levels.forEach((e=>e.components.forEach((e=>{null!=e.textures&&t.push(...e.textures)})))),e(t)}getGeometries(){const t=new Array;return this.levels.forEach((e=>e.components.forEach((e=>{t.push(e.geometry)})))),e(t)}getEngineGeometries(){return this.getGeometries().map((e=>e.engineGeometry)).filter((e=>null!=e))}computeUsedMemory(){const e=this.getGeometries(),t=this.getTextures(),r=e.reduce(((e,t)=>e+t.computeUsedMemory()),0);return t.reduce(((e,t)=>e+t.memoryEstimate),0)+r}}export{a as LodComponentEngineGeometry,m as LodComponentRenderGeometry,l as LodComponentResources,f as LodLevelResources,h as LodResources};\n"],
  "mappings": "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",
  "names": ["e", "s", "i", "m", "a", "r", "l", "c", "f", "h", "t"]
}
