{
  "version": 3,
  "sources": ["../../@arcgis/core/portal/support/portalLayers.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";import{findAssociatedFeatureService as a}from\"../../layers/support/associatedFeatureServiceUtils.js\";import{getLayerModuleType as r}from\"../../layers/support/fetchService.js\";import{LayerLoadContext as t}from\"../../layers/support/LayerLoadContext.js\";import{sceneServiceLayerTypeToClassName as s}from\"../../layers/support/layerUtils.js\";import{layerLookupMap as n}from\"../../layers/support/lazyLayerLoader.js\";import c from\"../PortalItem.js\";import{getFirstLayerOrTable as o,getNumLayersAndTables as i,preprocessFSItemData as u,getLayerOrTable as l,layerTypeToLayerModuleType as m,populateSceneServiceItemData as y}from\"./loadUtils.js\";import{hasTypeKeyword as f}from\"./portalItemUtils.js\";async function p(e){let{portalItem:a}=e;!a||a instanceof c||(a=new c(a));const r=await d(a);return new(0,r.constructor)({portalItem:a,...r.properties})}async function d(e){await e.load();const a=new t;return w(await L(e,a))}async function L(a,r){switch(a.type){case\"3DTiles Service\":return a.typeKeywords.includes(\"3DObject\")?C():T();case\"CSV\":return G();case\"Feature Collection\":return v(a);case\"Feature Service\":return S(a,r);case\"Feed\":return D();case\"GeoJson\":return j();case\"Group Layer\":return O();case\"Image Service\":return I(a,r);case\"KML\":return P();case\"Knowledge Graph Layer\":return F();case\"Map Service\":return N(a,r);case\"Media Layer\":return V();case\"Scene Service\":return h(a,r);case\"Stream Service\":return M();case\"Vector Tile Service\":return g();case\"WCS\":return b();case\"WFS\":return K();case\"WMS\":return W();case\"WMTS\":return U();default:throw new e(\"portal:unknown-item-type\",\"Unknown item type '${type}'\",{type:a.type})}}async function w(e){const a=e.className,r=n[a];return{constructor:await r(),properties:e.properties}}async function N(e,a){return await x(e,a)?{className:\"TileLayer\"}:{className:\"MapImageLayer\"}}async function S(e,a){const r=await J(e,a);if(\"object\"==typeof r){const{sourceJSON:e,className:a}=r,t={sourceJSON:e};return null!=r.id&&(t.layerId=r.id),{className:a||\"FeatureLayer\",properties:t}}return{className:\"GroupLayer\"}}async function h(e,r){const t=await J(e,r,(async()=>{try{if(!e.url)return[];const{serverUrl:t}=await a(e.url,{sceneLayerItem:e}),s=await r.fetchServiceMetadata(t);return s?.tables??[]}catch{return[]}}));if(\"object\"==typeof t){const a={};let n;if(null!=t.id?(a.layerId=t.id,n=`${e.url}/layers/${t.id}`):n=e.url,e.typeKeywords?.length)for(const r of Object.keys(s))if(e.typeKeywords.includes(r))return{className:s[r]};const c=await r.fetchServiceMetadata(n,{customParameters:await r.fetchCustomParameters(e,(e=>o(e)?.customParameters))});return{className:s[c?.layerType]||\"SceneLayer\",properties:a}}if(!1===t){const a=await r.fetchServiceMetadata(e.url);if(\"Voxel\"===a?.layerType)return{className:\"VoxelLayer\"}}return{className:\"GroupLayer\"}}async function v(e){await e.load();const a=f(e,\"Map Notes\"),r=f(e,\"Markup\");if(a||r)return{className:\"MapNotesLayer\"};if(f(e,\"Route Layer\"))return{className:\"RouteLayer\"};const t=await e.fetchData();return 1===i(t)?{className:\"FeatureLayer\"}:{className:\"GroupLayer\"}}async function I(e,a){await e.load();const r=e.typeKeywords?.map((e=>e.toLowerCase()))??[];if(r.includes(\"elevation 3d layer\"))return{className:\"ElevationLayer\"};if(r.includes(\"tiled imagery\"))return{className:\"ImageryTileLayer\"};const t=await a.fetchItemData(e),s=t?.layerType;if(\"ArcGISTiledImageServiceLayer\"===s)return{className:\"ImageryTileLayer\"};if(\"ArcGISImageServiceLayer\"===s)return{className:\"ImageryLayer\"};const n=await a.fetchServiceMetadata(e.url,{customParameters:await a.fetchCustomParameters(e)}),c=n.cacheType?.toLowerCase(),o=n.capabilities?.toLowerCase().includes(\"tilesonly\"),i=n.tileInfo?.format?.toLowerCase()??\"\",u=null==c&&[\"jpg\",\"jpeg\",\"png\",\"png8\",\"png24\",\"png32\",\"mixed\"].includes(i);return\"map\"===c||u||o?{className:\"ImageryTileLayer\"}:{className:\"ImageryLayer\"}}function M(){return{className:\"StreamLayer\"}}function g(){return{className:\"VectorTileLayer\"}}function j(){return{className:\"GeoJSONLayer\"}}function T(){return{className:\"IntegratedMesh3DTilesLayer\"}}function C(){return{className:\"UnsupportedLayer\"}}function G(){return{className:\"CSVLayer\"}}function P(){return{className:\"KMLLayer\"}}function F(){return{className:\"KnowledgeGraphLayer\"}}function b(){return{className:\"WCSLayer\"}}function K(){return{className:\"WFSLayer\"}}function W(){return{className:\"WMSLayer\"}}function U(){return{className:\"WMTSLayer\"}}function D(){return{className:\"StreamLayer\"}}function O(){return{className:\"GroupLayer\"}}function V(){return{className:\"MediaLayer\"}}async function x(e,a){const{tileInfo:r}=await a.fetchServiceMetadata(e.url,{customParameters:await a.fetchCustomParameters(e)});return r}async function J(e,a,t){const{url:s,type:n}=e,c=\"Feature Service\"===n;if(!s)return{};if(/\\/\\d+$/.test(s)){if(c){const t=await a.fetchServiceMetadata(s,{customParameters:await a.fetchCustomParameters(e,(e=>o(e)?.customParameters))});return{id:t.id,className:r(t.type),sourceJSON:t}}return{}}await e.load();let f=await a.fetchItemData(e);if(c){const e=await u(f,s,a),r=k(e);if(\"object\"==typeof r){const a=l(e,r.id);r.className=m(a?.layerType)}return r}\"Scene Service\"===n&&(f=await y(e,f,a));if(i(f)>0)return k(f);const p=await a.fetchServiceMetadata(s);return t&&(p.tables=await t()),k(p)}function k(e){return 1===i(e)&&{id:o(e)?.id}}export{p as fromItem,L as selectLayerClassPath};\n"],
  "mappings": "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",
  "names": ["e", "a", "S", "g", "t", "s", "r", "_a", "o", "i", "u", "p"]
}
