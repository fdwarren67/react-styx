{
  "version": 3,
  "sources": ["../../@arcgis/core/rest/support/meshFeatureSet.js"],
  "sourcesContent": ["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.32/esri/copyright.txt for details.\n*/\nimport e from\"../../Graphic.js\";import t from\"../../core/Logger.js\";import{getOrCreateMapValue as r}from\"../../core/MapUtils.js\";import s from\"../../geometry/Extent.js\";import o from\"../../geometry/Mesh.js\";import n from\"../../geometry/SpatialReference.js\";import{ServiceAssetPart as a,ServiceAsset as u}from\"../../geometry/support/meshUtils/External.js\";import{getFormatIdMimeType as i}from\"../../layers/support/infoFor3D.js\";import f from\"./FeatureSet.js\";import{extractMeshFeatureOrigin as m,extractMeshFeatureTransform as c}from\"./meshFeatureAttributes.js\";const p=()=>t.getLogger(\"esri.rest.support.meshFeatureSet\");function l(t,r,s){const o=s.features;s.features=[],delete s.geometryType;const a=f.fromJSON(s);if(a.geometryType=\"mesh\",!s.assetMaps)return a;const u=g(r,s.assetMaps),i=t.sourceSpatialReference??n.WGS84,m=s.globalIdFieldName,{outFields:c}=t,p=null!=c&&c.length>0?y(c.includes(\"*\")?null:new Set(c)):()=>({});for(const n of o){const t=E(n,m,i,r,u);a.features.push(new e({geometry:t,attributes:p(n)}))}return a}function y(e){return({attributes:t})=>{if(!t)return{};if(!e)return t;for(const r in t)e.has(r)||delete t[r];return t}}function E(e,t,r,n,a){const u=e.attributes[t],i=a.get(u);if(null==i||!e.geometry)return null;const f=m(e.attributes,r,n.transformFieldRoles),p=s.fromJSON(e.geometry);p.spatialReference=r;const l=c(e.attributes,n.transformFieldRoles),y=r.isGeographic?\"local\":\"georeferenced\",E=d(i);return E?o.createWithExternalSource(f,E,{extent:p,transform:l,vertexSpace:y,unitConversionDisabled:!0}):o.createIncomplete(f,{extent:p,transform:l,vertexSpace:y})}var h;function g(e,t){const s=new Map;for(const o of t){const t=o.parentGlobalId;if(null==t)continue;const n=o.assetName,a=o.assetType,u=o.assetHash,f=o.assetURL,m=o.conversionStatus,c=o.seqNo,l=i(a,e.supportedFormats);if(!l){p().error(\"mesh-feature-set:unknown-format\",`Service returned an asset of type ${a}, but it does not list it as a supported type`);continue}const y=r(s,t,(()=>({files:new Map})));r(y.files,n,(()=>({name:n,type:a,mimeType:l,status:S(m),parts:[]}))).parts[c]={hash:u,url:f}}return s}function d(e){const t=Array.from(e.files.values()),r=new Array;for(const s of t){if(s.status!==h.COMPLETED)return null;const e=new Array;for(const t of s.parts){if(!t)return null;e.push(new a(t.url,t.hash))}r.push(new u(s.name,s.mimeType,e))}return r}function S(e){switch(e){case\"COMPLETED\":case\"SUBMITTED\":return h.COMPLETED;case\"INPROGRESS\":return h.PENDING;default:return h.FAILED}}!function(e){e[e.FAILED=0]=\"FAILED\",e[e.PENDING=1]=\"PENDING\",e[e.COMPLETED=2]=\"COMPLETED\"}(h||(h={}));export{g as assetMapFromAssetMapsJSON,E as extractMesh,l as meshFeatureSetFromJSON};\n"],
  "mappings": "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",
  "names": ["r", "s", "a", "g", "i", "p", "n", "t", "l", "y", "E", "d", "e"]
}
